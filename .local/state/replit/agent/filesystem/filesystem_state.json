{"file_contents":{"ios/App/App/public/cordova_plugins.js":{"content":"","size_bytes":0},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":5742},"client/src/pages/LandingPage.tsx":{"content":"import { Link } from \"wouter\";\nimport { Camera, BookOpen, Brain, Sparkles, Zap, Shield, LogIn, Calculator, Syringe, Target, Mic, Volume2, ChefHat, Scale, Award } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { launchSignup, launchLogin } from \"@/lib/auth-launcher\";\n\nexport default function LandingPage() {\n  const { isAuthenticated, isLoading } = useAuth();\n\n  return (\n    <div className=\"text-foreground min-h-screen relative overflow-hidden\" style={{background: 'var(--bg-gradient)'}}>\n      {/* Animated Background Elements */}\n      <div className=\"fixed inset-0 pointer-events-none\">\n        <div className=\"absolute top-10 left-10 w-20 h-20 bg-purple-200/30 rounded-full blur-xl animate-pulse\"></div>\n        <div className=\"absolute top-1/4 right-20 w-32 h-32 bg-pink-200/20 rounded-full blur-2xl animate-bounce\"></div>\n        <div className=\"absolute bottom-1/4 left-1/4 w-24 h-24 bg-blue-200/25 rounded-full blur-xl animate-ping\"></div>\n        <div className=\"absolute bottom-10 right-10 w-16 h-16 bg-yellow-200/30 rounded-full blur-lg animate-pulse delay-1000\"></div>\n      </div>\n\n      {/* Header */}\n      <header className=\"bg-gradient-to-r from-purple-600 via-purple-500 to-pink-600 text-white relative overflow-hidden\">\n        {/* Animated gradient overlay */}\n        <div className=\"absolute inset-0 bg-gradient-to-r from-purple-400/50 via-pink-400/50 to-purple-600/50 animate-pulse\"></div>\n        \n        <div className=\"max-w-4xl mx-auto px-4 py-8 text-center relative z-10\">\n          <div className=\"flex items-center justify-center space-x-3 mb-4 animate-fade-in-up\">\n            <div className=\"bg-white/20 p-3 rounded-full animate-float shadow-lg\">\n              <Sparkles className=\"h-8 w-8 animate-spin-slow\" />\n            </div>\n            <h1 className=\"text-4xl font-bold animate-fade-in-right\">PlateMate</h1>\n          </div>\n          <p className=\"text-xl opacity-90 mb-6 animate-fade-in-up animation-delay-300\">\n            Your voice-powered AI nutrition companion\n          </p>\n          <p className=\"text-lg opacity-80 max-w-2xl mx-auto mb-8 animate-fade-in-up animation-delay-600\">\n            Just speak your meals aloud and watch them automatically appear in your food diary! \n            Or snap photos for instant AI analysis. Get personalized nutrition guidance with the power of your voice.\n          </p>\n          \n          {/* Top CTA Buttons */}\n          {!isAuthenticated && (\n            <div className=\"flex flex-col sm:flex-row gap-4 justify-center items-center animate-fade-in-up animation-delay-900\">\n              <Button \n                size=\"lg\" \n                variant=\"secondary\"\n                className=\"bg-white text-purple-600 hover:bg-gray-100 px-8 py-4 text-lg font-semibold rounded-lg shadow-lg transform hover:scale-110 transition-all duration-300 relative z-20 cursor-pointer\"\n                data-testid=\"button-signup-header\"\n                onClick={launchSignup}\n              >\n                <Sparkles className=\"h-6 w-6 mr-2\" />\n                Create Account\n              </Button>\n              <span className=\"text-white/60 text-sm\">or</span>\n              <Button \n                size=\"lg\" \n                variant=\"outline\"\n                className=\"bg-transparent border-2 border-white text-white hover:bg-white hover:text-purple-600 px-6 py-4 text-lg font-semibold rounded-lg shadow-lg transform hover:scale-110 transition-all duration-300 relative z-20 cursor-pointer\"\n                data-testid=\"button-signin-header\"\n                onClick={launchLogin}\n              >\n                <LogIn className=\"h-6 w-6 mr-2\" />\n                Sign In\n              </Button>\n            </div>\n          )}\n        </div>\n      </header>\n\n      {/* Main Content */}\n      <main className=\"max-w-4xl mx-auto px-4 py-12\">\n        {/* Get Started Button - Only for authenticated users */}\n        {isAuthenticated && (\n          <div className=\"text-center mb-16 animate-fade-in-up animation-delay-900\">\n            <div className=\"space-y-4\">\n              <div className=\"inline-flex items-center px-4 py-2 bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200 rounded-full text-sm font-medium\">\n                <Shield className=\"h-4 w-4 mr-2\" />\n                âœ… Signed in and ready!\n              </div>\n              <Link href=\"/scan\">\n                <Button \n                  size=\"lg\" \n                  className=\"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white px-8 py-6 text-lg font-semibold rounded-lg shadow-lg transform hover:scale-105 transition-all duration-300 relative z-20 cursor-pointer\"\n                  data-testid=\"button-get-started\"\n                >\n                  <Camera className=\"h-6 w-6 mr-2\" />\n                  Start Using PlateMate\n                </Button>\n              </Link>\n            </div>\n            <p className=\"text-sm text-gray-600 dark:text-gray-300 mt-3 animate-fade-in animation-delay-1200\">\n              Say \"100g salmon\" or \"one apple\" - your voice becomes your food diary\n            </p>\n          </div>\n        )}\n\n        {/* Features Grid */}\n        <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-16\">\n          <Card className=\"border-blue-200 dark:border-blue-800 hover:shadow-2xl hover:shadow-blue-500/25 transition-all duration-500 hover:scale-105 animate-fade-in-left animation-delay-1200 group\">\n            <CardHeader className=\"text-center\">\n              <div className=\"bg-blue-100 dark:bg-blue-900 p-3 rounded-full w-fit mx-auto mb-4 animate-float group-hover:animate-bounce\">\n                <Mic className=\"h-8 w-8 text-blue-600 dark:text-blue-400 group-hover:animate-pulse\" />\n              </div>\n              <CardTitle className=\"text-xl group-hover:text-blue-600 transition-colors\">Enhanced Voice Input</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <CardDescription className=\"text-center\">\n                Beautiful voice capture with large, bold text display. Simply speak your meals and see them highlighted prominently before adding to your diary.\n              </CardDescription>\n            </CardContent>\n          </Card>\n          <Card className=\"border-purple-200 dark:border-purple-800 hover:shadow-2xl hover:shadow-purple-500/25 transition-all duration-500 hover:scale-105 hover:-rotate-1 animate-fade-in-left animation-delay-1500 group\">\n            <CardHeader className=\"text-center\">\n              <div className=\"bg-purple-100 dark:bg-purple-900 p-3 rounded-full w-fit mx-auto mb-4 animate-float group-hover:animate-bounce\">\n                <Camera className=\"h-8 w-8 text-purple-600 dark:text-purple-400 group-hover:animate-pulse\" />\n              </div>\n              <CardTitle className=\"text-xl group-hover:text-purple-600 transition-colors\">Smart Food Recognition</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <CardDescription className=\"text-center\">\n                Our advanced AI instantly identifies food items and estimates portion sizes from your photos with remarkable accuracy.\n              </CardDescription>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-pink-200 dark:border-pink-800 hover:shadow-2xl hover:shadow-pink-500/25 transition-all duration-500 hover:scale-105 animate-fade-in-up animation-delay-1800 group\">\n            <CardHeader className=\"text-center\">\n              <div className=\"bg-pink-100 dark:bg-pink-900 p-3 rounded-full w-fit mx-auto mb-4 animate-float animation-delay-500 group-hover:animate-bounce\">\n                <BookOpen className=\"h-8 w-8 text-pink-600 dark:text-pink-400 group-hover:animate-pulse\" />\n              </div>\n              <CardTitle className=\"text-xl group-hover:text-pink-600 transition-colors\">Food Diary</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <CardDescription className=\"text-center\">\n                Keep track of all your meals with our intuitive food diary. Monitor your eating patterns and nutritional trends over time.\n              </CardDescription>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-blue-200 dark:border-blue-800 hover:shadow-2xl hover:shadow-blue-500/25 transition-all duration-500 hover:scale-105 animate-fade-in-right animation-delay-2100 group\">\n            <CardHeader className=\"text-center\">\n              <div className=\"bg-blue-100 dark:bg-blue-900 p-3 rounded-full w-fit mx-auto mb-4 animate-float animation-delay-1000 group-hover:animate-bounce\">\n                <Calculator className=\"h-8 w-8 text-blue-600 dark:text-blue-400 group-hover:animate-pulse\" />\n              </div>\n              <CardTitle className=\"text-xl group-hover:text-blue-600 transition-colors\">Smart Calculator & Goals</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <CardDescription className=\"text-center\">\n                Calculate personalized daily calories and set nutrition goals based on your profile, age, and activity level.\n              </CardDescription>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-orange-200 dark:border-orange-800 hover:shadow-2xl hover:shadow-orange-500/25 transition-all duration-500 hover:scale-105 hover:rotate-1 animate-fade-in-up animation-delay-2400 group\">\n            <CardHeader className=\"text-center\">\n              <div className=\"bg-orange-100 dark:bg-orange-900 p-3 rounded-full w-fit mx-auto mb-4 animate-float animation-delay-1500 group-hover:animate-bounce\">\n                <Scale className=\"h-8 w-8 text-orange-600 dark:text-orange-400 group-hover:animate-pulse\" />\n              </div>\n              <CardTitle className=\"text-xl group-hover:text-orange-600 transition-colors\">Weight Tracking</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <CardDescription className=\"text-center\">\n                Track your weight progress with visual charts and analytics. Monitor trends over time and celebrate your achievements.\n              </CardDescription>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-yellow-200 dark:border-yellow-800 hover:shadow-2xl hover:shadow-yellow-500/25 transition-all duration-500 hover:scale-105 hover:rotate-1 animate-fade-in-up animation-delay-2700 group\">\n            <CardHeader className=\"text-center\">\n              <div className=\"bg-gradient-to-r from-yellow-100 to-orange-100 dark:from-yellow-900 dark:to-orange-900 p-3 rounded-full w-fit mx-auto mb-4 animate-float animation-delay-2000 group-hover:animate-bounce\">\n                <Award className=\"h-8 w-8 text-yellow-600 dark:text-yellow-400 group-hover:animate-pulse\" />\n              </div>\n              <CardTitle className=\"text-xl group-hover:text-yellow-600 transition-colors\">Steps Rewards</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <CardDescription className=\"text-center\">\n                Turn your daily steps into earned calories! Our smart calculator converts your physical activity into food rewards with personalized suggestions.\n              </CardDescription>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-red-200 dark:border-red-800 hover:shadow-2xl hover:shadow-red-500/25 transition-all duration-500 hover:scale-105 hover:rotate-1 animate-fade-in-up animation-delay-3000 group\">\n            <CardHeader className=\"text-center\">\n              <div className=\"bg-red-100 dark:bg-red-900 p-3 rounded-full w-fit mx-auto mb-4 animate-float animation-delay-2300 group-hover:animate-bounce\">\n                <ChefHat className=\"h-8 w-8 text-red-600 dark:text-red-400 group-hover:animate-pulse\" />\n              </div>\n              <CardTitle className=\"text-xl group-hover:text-red-600 transition-colors\">Tailored Recipes</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <CardDescription className=\"text-center\">\n                AI-generated healthy recipes filtered by your dietary requirements - Keto, Vegan, High Protein, Gluten Free, and more.\n              </CardDescription>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-indigo-200 dark:border-indigo-800 hover:shadow-2xl hover:shadow-indigo-500/25 transition-all duration-500 hover:scale-105 hover:rotate-1 animate-fade-in-up animation-delay-3000 group\">\n            <CardHeader className=\"text-center\">\n              <div className=\"bg-indigo-100 dark:bg-indigo-900 p-3 rounded-full w-fit mx-auto mb-4 animate-float animation-delay-2300 group-hover:animate-bounce\">\n                <Syringe className=\"h-8 w-8 text-indigo-600 dark:text-indigo-400 group-hover:animate-pulse\" />\n              </div>\n              <CardTitle className=\"text-xl group-hover:text-indigo-600 transition-colors\">Injection Support</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <CardDescription className=\"text-center\">\n                Specialized guidance for people using weight loss medications like Ozempic, Wegovy, and Mounjaro.\n              </CardDescription>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* How It Works */}\n        <section className=\"mb-16 animate-fade-in-up animation-delay-2400\">\n          <h2 className=\"text-3xl font-bold text-center mb-8 animate-fade-in-up animation-delay-2700\">How It Works</h2>\n          <div className=\"grid md:grid-cols-3 gap-8\">\n            <div className=\"text-center animate-fade-in-left animation-delay-3000 hover:scale-105 transition-transform duration-300 group\">\n              <div className=\"bg-gradient-to-r from-blue-100 to-purple-100 dark:from-blue-900 dark:to-purple-900 p-6 rounded-full w-20 h-20 mx-auto mb-4 flex items-center justify-center animate-bounce hover:animate-spin group-hover:shadow-lg\">\n                <Mic className=\"h-8 w-8 text-blue-600 dark:text-blue-400 group-hover:scale-110 transition-transform\" />\n              </div>\n              <h3 className=\"text-xl font-semibold mb-2 group-hover:text-blue-600 transition-colors\">Speak Your Meal</h3>\n              <p className=\"text-gray-700 dark:text-gray-200\">\n                Just say what you ate! \"Two slices of pizza\" or \"100g salmon\" - your voice becomes your food diary.\n              </p>\n            </div>\n            \n            <div className=\"text-center animate-fade-in-up animation-delay-3300 hover:scale-105 transition-transform duration-300 group\">\n              <div className=\"bg-gradient-to-r from-purple-100 to-pink-100 dark:from-purple-900 dark:to-pink-900 p-6 rounded-full w-20 h-20 mx-auto mb-4 flex items-center justify-center animate-bounce animation-delay-500 hover:animate-spin group-hover:shadow-lg\">\n                <Brain className=\"h-8 w-8 text-purple-600 dark:text-purple-400 group-hover:scale-110 transition-transform\" />\n              </div>\n              <h3 className=\"text-xl font-semibold mb-2 group-hover:text-pink-600 transition-colors\">Smart AI Analysis</h3>\n              <p className=\"text-gray-700 dark:text-gray-200\">\n                Our AI understands your voice and instantly calculates calories, protein, carbs, and fat from what you said.\n              </p>\n            </div>\n            \n            <div className=\"text-center animate-fade-in-right animation-delay-3600 hover:scale-105 transition-transform duration-300 group\">\n              <div className=\"bg-gradient-to-r from-blue-100 to-purple-100 dark:from-blue-900 dark:to-purple-900 p-6 rounded-full w-20 h-20 mx-auto mb-4 flex items-center justify-center animate-bounce animation-delay-1000 hover:animate-spin group-hover:shadow-lg\">\n                <BookOpen className=\"h-8 w-8 text-blue-600 dark:text-blue-400 group-hover:scale-110 transition-transform\" />\n              </div>\n              <h3 className=\"text-xl font-semibold mb-2 group-hover:text-blue-600 transition-colors\">Auto-Track & Improve</h3>\n              <p className=\"text-gray-700 dark:text-gray-200\">\n                Meals are automatically saved to your diary with beautiful voice thumbnails. Track progress effortlessly.\n              </p>\n            </div>\n          </div>\n        </section>\n\n        {/* Advanced Features */}\n        <section className=\"mb-16\">\n          <h2 className=\"text-3xl font-bold text-center mb-8 animate-fade-in-up\">Advanced Nutrition Tools</h2>\n          <div className=\"grid md:grid-cols-3 gap-6 mb-12\">\n            <Card className=\"border-orange-200 dark:border-orange-800 hover:shadow-xl transition-all duration-300 group\">\n              <CardHeader className=\"text-center\">\n                <div className=\"bg-orange-100 dark:bg-orange-900 p-3 rounded-full w-fit mx-auto mb-4 group-hover:animate-bounce\">\n                  <Target className=\"h-8 w-8 text-orange-600 dark:text-orange-400\" />\n                </div>\n                <CardTitle className=\"text-lg group-hover:text-orange-600 transition-colors\">Smart Goals & Analytics</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <CardDescription className=\"text-center text-sm\">\n                  Set personalized nutrition goals and track your progress with detailed analytics based on your age, activity level, and health goals.\n                </CardDescription>\n              </CardContent>\n            </Card>\n\n            <Card className=\"border-purple-200 dark:border-purple-800 hover:shadow-xl transition-all duration-300 group\">\n              <CardHeader className=\"text-center\">\n                <div className=\"bg-purple-100 dark:bg-purple-900 p-3 rounded-full w-fit mx-auto mb-4 group-hover:animate-bounce\">\n                  <Target className=\"h-8 w-8 text-purple-600 dark:text-purple-400\" />\n                </div>\n                <CardTitle className=\"text-lg group-hover:text-purple-600 transition-colors\">Medication-Aware</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <CardDescription className=\"text-center text-sm\">\n                  Specialized calorie calculations that account for appetite suppression from GLP-1 medications.\n                </CardDescription>\n              </CardContent>\n            </Card>\n\n            <Card className=\"border-red-200 dark:border-red-800 hover:shadow-xl transition-all duration-300 group\">\n              <CardHeader className=\"text-center\">\n                <div className=\"bg-red-100 dark:bg-red-900 p-3 rounded-full w-fit mx-auto mb-4 group-hover:animate-bounce\">\n                  <ChefHat className=\"h-8 w-8 text-red-600 dark:text-red-400\" />\n                </div>\n                <CardTitle className=\"text-lg group-hover:text-red-600 transition-colors\">Smart Recipe Engine</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <CardDescription className=\"text-center text-sm\">\n                  AI-powered recipe recommendations with dietary filters. Get personalized meal ideas that match your nutrition goals.\n                </CardDescription>\n              </CardContent>\n            </Card>\n\n            <Card className=\"border-blue-200 dark:border-blue-800 hover:shadow-xl transition-all duration-300 group\">\n              <CardHeader className=\"text-center\">\n                <div className=\"bg-blue-100 dark:bg-blue-900 p-3 rounded-full w-fit mx-auto mb-4 group-hover:animate-bounce\">\n                  <Brain className=\"h-8 w-8 text-blue-600 dark:text-blue-400\" />\n                </div>\n                <CardTitle className=\"text-lg group-hover:text-blue-600 transition-colors\">AI Advice</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <CardDescription className=\"text-center text-sm\">\n                  Personalized diet recommendations based on your eating patterns, health goals, and preferences.\n                </CardDescription>\n              </CardContent>\n            </Card>\n          </div>\n        </section>\n\n        {/* Key Features */}\n        <section className=\"bg-muted/50 rounded-lg p-8 mb-16\">\n          <h2 className=\"text-3xl font-bold text-center mb-8\">Why Choose PlateMate?</h2>\n          <div className=\"grid md:grid-cols-2 gap-6\">\n            <div className=\"flex items-start space-x-3\">\n              <Volume2 className=\"h-6 w-6 text-purple-500 mt-1 flex-shrink-0\" />\n              <div>\n                <h3 className=\"text-lg font-semibold mb-1\">Voice-Powered Logging</h3>\n                <p className=\"text-muted-foreground\">Speak your meals naturally - \"100g salmon\" or \"one apple\" - and watch them appear instantly in your diary.</p>\n              </div>\n            </div>\n            \n            <div className=\"flex items-start space-x-3\">\n              <Shield className=\"h-6 w-6 text-purple-500 mt-1 flex-shrink-0\" />\n              <div>\n                <h3 className=\"text-lg font-semibold mb-1\">Reliable & Accurate</h3>\n                <p className=\"text-muted-foreground\">Enterprise-grade AI with multiple backup systems ensures consistent results.</p>\n              </div>\n            </div>\n            \n            <div className=\"flex items-start space-x-3\">\n              <Calculator className=\"h-6 w-6 text-purple-500 mt-1 flex-shrink-0\" />\n              <div>\n                <h3 className=\"text-lg font-semibold mb-1\">Personalized Calculations</h3>\n                <p className=\"text-muted-foreground\">Get precise BMR and TDEE calculations with medication-aware adjustments for safe weight management.</p>\n              </div>\n            </div>\n            \n            <div className=\"flex items-start space-x-3\">\n              <Scale className=\"h-6 w-6 text-orange-500 mt-1 flex-shrink-0\" />\n              <div>\n                <h3 className=\"text-lg font-semibold mb-1\">Weight Progress Tracking</h3>\n                <p className=\"text-muted-foreground\">Monitor your weight journey with beautiful charts and progress analytics. Celebrate milestones and stay motivated.</p>\n              </div>\n            </div>\n            \n            <div className=\"flex items-start space-x-3\">\n              <ChefHat className=\"h-6 w-6 text-red-500 mt-1 flex-shrink-0\" />\n              <div>\n                <h3 className=\"text-lg font-semibold mb-1\">AI Recipe Generator</h3>\n                <p className=\"text-muted-foreground\">Get personalized healthy recipes filtered by dietary requirements like Keto, Vegan, High Protein, and Gluten Free.</p>\n              </div>\n            </div>\n            \n            <div className=\"flex items-start space-x-3\">\n              <Award className=\"h-6 w-6 text-yellow-500 mt-1 flex-shrink-0\" />\n              <div>\n                <h3 className=\"text-lg font-semibold mb-1\">Steps Rewards System</h3>\n                <p className=\"text-muted-foreground\">Convert your daily steps into earned calories with our smart calculator. Get personalized food reward suggestions based on your activity level.</p>\n              </div>\n            </div>\n            \n            <div className=\"flex items-start space-x-3\">\n              <Syringe className=\"h-6 w-6 text-purple-500 mt-1 flex-shrink-0\" />\n              <div>\n                <h3 className=\"text-lg font-semibold mb-1\">Injection Medicine Support</h3>\n                <p className=\"text-muted-foreground\">Specialized guidance and safety tips for users of GLP-1 weight loss medications like Ozempic and Wegovy.</p>\n              </div>\n            </div>\n          </div>\n        </section>\n\n        {/* Call to Action */}\n        <div className=\"text-center bg-gradient-to-r from-purple-600 via-pink-600 to-purple-600 text-white rounded-lg p-8 animate-fade-in-up animation-delay-4500 relative overflow-hidden group\">\n          {/* Animated background gradient */}\n          <div className=\"absolute inset-0 bg-gradient-to-r from-pink-400/50 via-purple-400/50 to-pink-600/50 animate-pulse opacity-0 group-hover:opacity-100 transition-opacity duration-1000\"></div>\n          \n          <h2 className=\"text-3xl font-bold mb-4 animate-fade-in-up animation-delay-4800 relative z-10\">Ready to Speak Your Way to Better Nutrition?</h2>\n          <p className=\"text-xl opacity-90 mb-6 animate-fade-in-up animation-delay-5100 relative z-10\">\n            Join users who are effortlessly tracking meals with voice input and achieving their weight goals with hands-free food logging.\n          </p>\n          {isAuthenticated ? (\n            <Link href=\"/scan\">\n              <Button \n                size=\"lg\" \n                variant=\"secondary\"\n                className=\"bg-white text-purple-600 hover:bg-gray-100 px-8 py-6 text-lg font-semibold rounded-lg shadow-lg transform hover:scale-105 transition-all duration-300 relative z-20 cursor-pointer\"\n                data-testid=\"button-start-now\"\n              >\n                <Mic className=\"h-6 w-6 mr-2\" />\n                Start Voice Logging Now\n              </Button>\n            </Link>\n          ) : (\n            <div className=\"flex flex-col sm:flex-row gap-4 justify-center items-center\">\n              <Button \n                size=\"lg\" \n                variant=\"secondary\"\n                className=\"bg-white text-purple-600 hover:bg-gray-100 px-8 py-6 text-lg font-semibold rounded-lg shadow-lg transform hover:scale-105 transition-all duration-300 relative z-20 cursor-pointer\"\n                data-testid=\"button-sign-in\"\n                onClick={launchLogin}\n              >\n                <LogIn className=\"h-6 w-6 mr-2\" />\n                Sign In to Start\n              </Button>\n              <span className=\"text-white/80 text-sm\">or</span>\n              <Button \n                size=\"lg\" \n                variant=\"outline\"\n                className=\"bg-transparent border-2 border-white text-white hover:bg-white hover:text-purple-600 px-8 py-6 text-lg font-semibold rounded-lg shadow-lg transform hover:scale-105 transition-all duration-300 relative z-20 cursor-pointer\"\n                data-testid=\"button-sign-up\"\n                onClick={launchSignup}\n              >\n                <Sparkles className=\"h-6 w-6 mr-2\" />\n                Create Account\n              </Button>\n            </div>\n          )}\n        </div>\n      </main>\n\n      {/* Footer */}\n      <footer className=\"bg-muted/30 py-8 mt-16 animate-fade-in animation-delay-5700\">\n        <div className=\"max-w-4xl mx-auto px-4 text-center\">\n          <div className=\"flex items-center justify-center space-x-2 mb-4 animate-fade-in-up animation-delay-6000\">\n            <Sparkles className=\"h-5 w-5 text-purple-600 animate-spin-slow\" />\n            <span className=\"font-semibold hover:text-purple-600 transition-colors cursor-default\">PlateMate</span>\n          </div>\n          <p className=\"text-sm text-muted-foreground animate-fade-in animation-delay-6300\">\n            Your voice-powered AI nutrition companion for effortless meal tracking.\n          </p>\n        </div>\n      </footer>\n    </div>\n  );\n}","size_bytes":27095},"client/src/pages/HelpPage.tsx":{"content":"import React from \"react\";\nimport { ArrowLeft, Camera, Droplets, Target, TrendingUp, Book, Lightbulb, ChevronDown, ChevronRight } from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Collapsible, CollapsibleContent, CollapsibleTrigger } from \"@/components/ui/collapsible\";\nimport { useState } from \"react\";\nimport { DropdownNavigation } from \"@/components/dropdown-navigation\";\n\nexport function HelpPage() {\n  const [openSections, setOpenSections] = useState<Record<string, boolean>>({});\n\n  const toggleSection = (section: string) => {\n    setOpenSections(prev => ({\n      ...prev,\n      [section]: !prev[section]\n    }));\n  };\n\n  return (\n    <div className=\"min-h-screen text-foreground\" style={{background: 'var(--bg-gradient)'}}>\n      {/* Header */}\n      <div className=\"bg-card border-b\">\n        <div className=\"max-w-2xl mx-auto px-4 py-4\">\n          <div className=\"flex items-center space-x-3\">\n            <Link href=\"/\">\n              <button \n                className=\"p-2 hover:bg-muted rounded-lg transition-colors\"\n                data-testid=\"button-back-to-home\"\n              >\n                <ArrowLeft className=\"h-5 w-5\" />\n              </button>\n            </Link>\n            <h1 className=\"text-xl font-bold\">Help & Support</h1>\n          </div>\n        </div>\n      </div>\n\n      {/* Content */}\n      <div className=\"max-w-2xl mx-auto p-4 space-y-6\">\n        {/* Quick Start Guide */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center space-x-2\">\n              <Book className=\"h-5 w-5 text-primary\" />\n              <span>Quick Start Guide</span>\n            </CardTitle>\n            <CardDescription>Get started with PlateMate in 4 easy steps</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-4\">\n              <div className=\"flex items-start space-x-3\">\n                <div className=\"bg-primary text-primary-foreground rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold\">1</div>\n                <div>\n                  <h4 className=\"font-medium\">Take a Photo</h4>\n                  <p className=\"text-sm text-muted-foreground\">Snap a picture of your food using your camera or upload an existing image.</p>\n                </div>\n              </div>\n              <div className=\"flex items-start space-x-3\">\n                <div className=\"bg-primary text-primary-foreground rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold\">2</div>\n                <div>\n                  <h4 className=\"font-medium\">AI Analysis</h4>\n                  <p className=\"text-sm text-muted-foreground\">Our AI identifies food items and calculates nutritional information automatically.</p>\n                </div>\n              </div>\n              <div className=\"flex items-start space-x-3\">\n                <div className=\"bg-primary text-primary-foreground rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold\">3</div>\n                <div>\n                  <h4 className=\"font-medium\">Log Your Drinks</h4>\n                  <p className=\"text-sm text-muted-foreground\">Track your hydration and beverage calories using the drinks logging feature.</p>\n                </div>\n              </div>\n              <div className=\"flex items-start space-x-3\">\n                <div className=\"bg-primary text-primary-foreground rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold\">4</div>\n                <div>\n                  <h4 className=\"font-medium\">Monitor Your Progress</h4>\n                  <p className=\"text-sm text-muted-foreground\">Check your diary to see daily progress and analytics for weekly trends.</p>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Feature Explanations */}\n        <Card>\n          <CardHeader>\n            <CardTitle>How to Use PlateMate Features</CardTitle>\n            <CardDescription>Detailed guides for each feature</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            \n            {/* Food Scanning */}\n            <Collapsible open={openSections.scanning} onOpenChange={() => toggleSection('scanning')}>\n              <CollapsibleTrigger className=\"flex items-center justify-between w-full p-3 bg-muted rounded-lg hover:bg-muted/80 transition-colors\" data-testid=\"help-food-scanning\">\n                <div className=\"flex items-center space-x-2\">\n                  <Camera className=\"h-4 w-4\" />\n                  <span className=\"font-medium\">Food Scanning & Analysis</span>\n                </div>\n                {openSections.scanning ? <ChevronDown className=\"h-4 w-4\" /> : <ChevronRight className=\"h-4 w-4\" />}\n              </CollapsibleTrigger>\n              <CollapsibleContent className=\"pt-3\">\n                <div className=\"space-y-3 text-sm\">\n                  <p><strong>How it works:</strong> Take a photo of your meal and our AI analyzes the food items, estimating portions and nutrition content.</p>\n                  \n                  <div className=\"space-y-2\">\n                    <p><strong>Tips for better results:</strong></p>\n                    <ul className=\"list-disc pl-4 space-y-1 text-muted-foreground\">\n                      <li>Ensure good lighting when taking photos</li>\n                      <li>Include a reference object (like a coin) for size estimation</li>\n                      <li>Capture the entire meal in one photo</li>\n                      <li>Avoid blurry or distant shots</li>\n                      <li>Try to separate different food items visually</li>\n                    </ul>\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    <p><strong>What you get:</strong></p>\n                    <ul className=\"list-disc pl-4 space-y-1 text-muted-foreground\">\n                      <li>Identified food items with portion estimates</li>\n                      <li>Total calories for the meal</li>\n                      <li>Breakdown of protein, carbs, and fat</li>\n                      <li>Confidence score for the analysis</li>\n                    </ul>\n                  </div>\n                </div>\n              </CollapsibleContent>\n            </Collapsible>\n\n            {/* Drinks Logging */}\n            <Collapsible open={openSections.drinks} onOpenChange={() => toggleSection('drinks')}>\n              <CollapsibleTrigger className=\"flex items-center justify-between w-full p-3 bg-muted rounded-lg hover:bg-muted/80 transition-colors\" data-testid=\"help-drinks-logging\">\n                <div className=\"flex items-center space-x-2\">\n                  <Droplets className=\"h-4 w-4\" />\n                  <span className=\"font-medium\">Drinks & Hydration Tracking</span>\n                </div>\n                {openSections.drinks ? <ChevronDown className=\"h-4 w-4\" /> : <ChevronRight className=\"h-4 w-4\" />}\n              </CollapsibleTrigger>\n              <CollapsibleContent className=\"pt-3\">\n                <div className=\"space-y-3 text-sm\">\n                  <p><strong>Track all beverages:</strong> Log water, coffee, tea, juices, and alcoholic drinks to monitor hydration and calorie intake.</p>\n                  \n                  <div className=\"space-y-2\">\n                    <p><strong>Features:</strong></p>\n                    <ul className=\"list-disc pl-4 space-y-1 text-muted-foreground\">\n                      <li>Quick logging with preset amounts (250ml, 500ml, etc.)</li>\n                      <li>Custom drink types and volumes</li>\n                      <li>Automatic calorie and caffeine tracking</li>\n                      <li>Daily hydration goals and progress</li>\n                      <li>Alcohol units calculation for alcoholic beverages</li>\n                    </ul>\n                  </div>\n                </div>\n              </CollapsibleContent>\n            </Collapsible>\n\n            {/* Goals Setting */}\n            <Collapsible open={openSections.goals} onOpenChange={() => toggleSection('goals')}>\n              <CollapsibleTrigger className=\"flex items-center justify-between w-full p-3 bg-muted rounded-lg hover:bg-muted/80 transition-colors\" data-testid=\"help-goals-setting\">\n                <div className=\"flex items-center space-x-2\">\n                  <Target className=\"h-4 w-4\" />\n                  <span className=\"font-medium\">Setting Nutrition Goals</span>\n                </div>\n                {openSections.goals ? <ChevronDown className=\"h-4 w-4\" /> : <ChevronRight className=\"h-4 w-4\" />}\n              </CollapsibleTrigger>\n              <CollapsibleContent className=\"pt-3\">\n                <div className=\"space-y-3 text-sm\">\n                  <p><strong>Personalized targets:</strong> Set daily calorie and macronutrient goals based on your lifestyle and objectives.</p>\n                  \n                  <div className=\"space-y-2\">\n                    <p><strong>Goal types:</strong></p>\n                    <ul className=\"list-disc pl-4 space-y-1 text-muted-foreground\">\n                      <li>Daily calorie targets</li>\n                      <li>Protein intake goals (great for fitness)</li>\n                      <li>Carbohydrate limits</li>\n                      <li>Fat intake monitoring</li>\n                      <li>Hydration targets</li>\n                    </ul>\n                  </div>\n                  \n                  <p><strong>Progress tracking:</strong> See how close you are to meeting your daily goals with visual progress bars and weekly summaries.</p>\n                </div>\n              </CollapsibleContent>\n            </Collapsible>\n\n            {/* Progress Tracking */}\n            <Collapsible open={openSections.progress} onOpenChange={() => toggleSection('progress')}>\n              <CollapsibleTrigger className=\"flex items-center justify-between w-full p-3 bg-muted rounded-lg hover:bg-muted/80 transition-colors\" data-testid=\"help-progress-tracking\">\n                <div className=\"flex items-center space-x-2\">\n                  <TrendingUp className=\"h-4 w-4\" />\n                  <span className=\"font-medium\">Progress Tracking & Analytics</span>\n                </div>\n                {openSections.progress ? <ChevronDown className=\"h-4 w-4\" /> : <ChevronRight className=\"h-4 w-4\" />}\n              </CollapsibleTrigger>\n              <CollapsibleContent className=\"pt-3\">\n                <div className=\"space-y-3 text-sm\">\n                  <p><strong>Comprehensive insights:</strong> View your nutrition patterns and progress over time with detailed analytics.</p>\n                  \n                  <div className=\"space-y-2\">\n                    <p><strong>Available analytics:</strong></p>\n                    <ul className=\"list-disc pl-4 space-y-1 text-muted-foreground\">\n                      <li>Daily nutrition summaries</li>\n                      <li>Weekly trend analysis</li>\n                      <li>Food frequency tracking</li>\n                      <li>Goal achievement rates</li>\n                      <li>Calorie intake patterns</li>\n                    </ul>\n                  </div>\n                </div>\n              </CollapsibleContent>\n            </Collapsible>\n\n          </CardContent>\n        </Card>\n\n        {/* Tips & Best Practices */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center space-x-2\">\n              <Lightbulb className=\"h-5 w-5 text-primary\" />\n              <span>Tips & Best Practices</span>\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3 text-sm\">\n            <div className=\"space-y-2\">\n              <h4 className=\"font-medium\">For accurate tracking:</h4>\n              <ul className=\"list-disc pl-4 space-y-1 text-muted-foreground\">\n                <li>Log your meals as soon as possible after eating</li>\n                <li>Include snacks and small bites in your tracking</li>\n                <li>Use consistent portion sizes when possible</li>\n                <li>Don't forget to log beverages, especially those with calories</li>\n              </ul>\n            </div>\n            \n            <div className=\"space-y-2\">\n              <h4 className=\"font-medium\">For better results:</h4>\n              <ul className=\"list-disc pl-4 space-y-1 text-muted-foreground\">\n                <li>Review your weekly patterns to identify trends</li>\n                <li>Adjust your goals based on your progress and how you feel</li>\n                <li>Use the coaching feature for personalized advice</li>\n                <li>Take photos from multiple angles for complex meals</li>\n              </ul>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Contact & Support */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Need More Help?</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3 text-sm\">\n            <p>If you're experiencing issues or have questions not covered here:</p>\n            <ul className=\"list-disc pl-4 space-y-1 text-muted-foreground\">\n              <li>Check that your device camera permissions are enabled</li>\n              <li>Ensure you have a stable internet connection for AI analysis</li>\n              <li>Try restarting the app if features aren't working properly</li>\n              <li>Clear your browser cache if using the web version</li>\n            </ul>\n            \n            <div className=\"mt-4 p-3 bg-muted rounded-lg\">\n              <p className=\"font-medium text-center\">PlateMate - Your AI-Powered Nutrition Companion</p>\n              <p className=\"text-center text-muted-foreground text-xs mt-1\">Making healthy eating easier with intelligent food recognition</p>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Suggestions and Comments */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Suggestions and Comments</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3 text-sm\">\n            <p>We value your feedback and suggestions to help improve PlateMate!</p>\n            <div className=\"mt-4 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg\">\n              <p className=\"font-medium text-blue-900 dark:text-blue-100 mb-3\">Send us your thoughts:</p>\n              <a \n                href=\"mailto:georgebrennan0811.suggestions@outlook.com\" \n                className=\"block text-lg font-medium text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 transition-colors break-all\"\n                data-testid=\"email-suggestions\"\n              >\n                georgebrennan0811.suggestions@outlook.com\n              </a>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Bottom Navigation */}\n      <DropdownNavigation />\n    </div>\n  );\n}\n\nexport default HelpPage;","size_bytes":15065},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"client/src/components/speech-navigation.tsx":{"content":"import { useEffect, useRef } from 'react';\nimport { useLocation } from 'wouter';\nimport { speechService, type VoiceCommand, type SpeechEvent } from '@/lib/speech-service';\nimport { soundService } from '@/lib/sound-service';\n\nexport function SpeechNavigation() {\n  const [location, setLocation] = useLocation();\n  const hasInitialized = useRef(false);\n\n  useEffect(() => {\n    if (hasInitialized.current) return;\n    hasInitialized.current = true;\n\n    const initializeSpeech = async () => {\n      const success = await speechService.initialize();\n      if (!success) {\n        console.warn('Speech navigation could not be initialized');\n        return;\n      }\n\n      // Register navigation commands\n      registerNavigationCommands();\n      \n      // Register action commands\n      registerActionCommands();\n      \n      // Set up event handler\n      speechService.on(handleSpeechEvent);\n    };\n\n    initializeSpeech();\n\n    return () => {\n      speechService.stopListening();\n    };\n  }, []);\n\n  const registerNavigationCommands = () => {\n    // Home/Scan page\n    speechService.registerCommand('navigate-home', {\n      command: 'navigate-home',\n      phrases: [\n        'home',\n        'go home',\n        'go to home',\n        'home page',\n        'take me home',\n        'scan',\n        'scan food',\n        'go to scan',\n        'scan page'\n      ],\n      action: () => {\n        setLocation('/');\n        showSpeechFeedback('Navigating to home');\n        soundService.playSuccess();\n      },\n      description: 'Navigate to the home/scan page',\n      category: 'navigation'\n    });\n\n    // Diary page\n    speechService.registerCommand('navigate-diary', {\n      command: 'navigate-diary',\n      phrases: [\n        'diary',\n        'go to diary',\n        'open diary',\n        'show diary',\n        'diary page',\n        'food diary',\n        'my meals'\n      ],\n      action: () => {\n        setLocation('/diary');\n        showSpeechFeedback('Opening diary');\n        soundService.playSuccess();\n      },\n      description: 'Navigate to the meal diary',\n      category: 'navigation'\n    });\n\n    // Calculator page\n    speechService.registerCommand('navigate-calculator', {\n      command: 'navigate-calculator',\n      phrases: [\n        'calculator',\n        'go to calculator',\n        'open calculator',\n        'nutrition calculator',\n        'calorie calculator',\n        'calculator page'\n      ],\n      action: () => {\n        setLocation('/calculator');\n        showSpeechFeedback('Opening calculator');\n        soundService.playSuccess();\n      },\n      description: 'Navigate to the nutrition calculator',\n      category: 'navigation'\n    });\n\n    // Goals page\n    speechService.registerCommand('navigate-goals', {\n      command: 'navigate-goals',\n      phrases: [\n        'goals',\n        'go to goals',\n        'open goals',\n        'nutrition goals',\n        'my goals',\n        'goals page',\n        'set goals'\n      ],\n      action: () => {\n        setLocation('/goals');\n        showSpeechFeedback('Opening goals');\n        soundService.playSuccess();\n      },\n      description: 'Navigate to nutrition goals',\n      category: 'navigation'\n    });\n\n    // Coaching page\n    speechService.registerCommand('navigate-coaching', {\n      command: 'navigate-coaching',\n      phrases: [\n        'coaching',\n        'coach',\n        'go to coaching',\n        'open coaching',\n        'coach me',\n        'coaching page',\n        'ai coach',\n        'daily coaching'\n      ],\n      action: () => {\n        setLocation('/coaching');\n        showSpeechFeedback('Opening AI coaching');\n        soundService.playSuccess();\n      },\n      description: 'Navigate to AI coaching',\n      category: 'navigation'\n    });\n\n    // Help page\n    speechService.registerCommand('navigate-help', {\n      command: 'navigate-help',\n      phrases: [\n        'help',\n        'go to help',\n        'open help',\n        'help page',\n        'get help',\n        'need help',\n        'how to use'\n      ],\n      action: () => {\n        setLocation('/help');\n        showSpeechFeedback('Opening help');\n        soundService.playSuccess();\n      },\n      description: 'Navigate to help and support',\n      category: 'navigation'\n    });\n\n    // AI Advice page\n    speechService.registerCommand('navigate-advice', {\n      command: 'navigate-advice',\n      phrases: [\n        'advice',\n        'ai advice',\n        'get advice',\n        'diet advice',\n        'nutrition advice',\n        'ask ai',\n        'advice page'\n      ],\n      action: () => {\n        setLocation('/advice');\n        showSpeechFeedback('Opening AI advice');\n        soundService.playSuccess();\n      },\n      description: 'Get AI diet advice',\n      category: 'navigation'\n    });\n\n    // Injection advice page\n    speechService.registerCommand('navigate-meds', {\n      command: 'navigate-meds',\n      phrases: [\n        'injection advice',\n        'medication advice',\n        'weight loss meds',\n        'ozempic advice',\n        'meds page'\n      ],\n      action: () => {\n        setLocation('/injection-advice');\n        showSpeechFeedback('Opening medication advice');\n        soundService.playSuccess();\n      },\n      description: 'Get weight loss medication advice',\n      category: 'navigation'\n    });\n  };\n\n  const registerActionCommands = () => {\n    // Scroll to top\n    speechService.registerCommand('scroll-top', {\n      command: 'scroll-top',\n      phrases: [\n        'scroll to top',\n        'go to top',\n        'scroll up',\n        'top of page'\n      ],\n      action: () => {\n        window.scrollTo({ top: 0, behavior: 'smooth' });\n        showSpeechFeedback('Scrolling to top');\n        soundService.playScan();\n      },\n      description: 'Scroll to top of page',\n      category: 'action'\n    });\n\n    // Refresh page\n    speechService.registerCommand('refresh-page', {\n      command: 'refresh-page',\n      phrases: [\n        'refresh page',\n        'reload page',\n        'refresh',\n        'reload'\n      ],\n      action: () => {\n        showSpeechFeedback('Refreshing page');\n        soundService.playNotification();\n        setTimeout(() => window.location.reload(), 1000);\n      },\n      description: 'Refresh the current page',\n      category: 'action'\n    });\n\n    // Go back\n    speechService.registerCommand('go-back', {\n      command: 'go-back',\n      phrases: [\n        'go back',\n        'navigate back',\n        'previous page',\n        'back',\n        'return'\n      ],\n      action: () => {\n        if (location !== '/') {\n          window.history.back();\n          showSpeechFeedback('Going back');\n          soundService.playSuccess();\n        }\n      },\n      description: 'Navigate to previous page',\n      category: 'action'\n    });\n\n    // Open profile\n    speechService.registerCommand('open-profile', {\n      command: 'open-profile',\n      phrases: [\n        'open profile',\n        'show profile',\n        'user profile',\n        'my profile',\n        'profile menu'\n      ],\n      action: () => {\n        const profileButton = document.querySelector('[data-testid=\"button-profile\"]') as HTMLButtonElement;\n        if (profileButton) {\n          profileButton.click();\n          showSpeechFeedback('Opening profile');\n          soundService.playSuccess();\n        }\n      },\n      description: 'Open user profile menu',\n      category: 'action'\n    });\n\n    // Start/stop speech listening\n    speechService.registerCommand('toggle-listening', {\n      command: 'toggle-listening',\n      phrases: [\n        'stop listening',\n        'start listening',\n        'toggle voice',\n        'voice off',\n        'voice on'\n      ],\n      action: () => {\n        if (speechService.isCurrentlyListening()) {\n          speechService.stopListening();\n          showSpeechFeedback('Voice control disabled');\n        } else {\n          speechService.startListening(true);\n          showSpeechFeedback('Voice control enabled');\n        }\n        soundService.playNotification();\n      },\n      description: 'Toggle voice listening on/off',\n      category: 'control'\n    });\n  };\n\n  const handleSpeechEvent = (event: SpeechEvent) => {\n    switch (event.type) {\n      case 'listening-start':\n        showSpeechIndicator(true);\n        break;\n      case 'listening-end':\n        showSpeechIndicator(false);\n        break;\n      case 'command-recognized':\n        showCommandRecognized(event.command || '', event.confidence || 0);\n        break;\n      case 'no-match':\n        showSpeechFeedback('Command not recognized');\n        soundService.playError();\n        break;\n      case 'error':\n        showSpeechFeedback(`Speech error: ${event.error}`);\n        soundService.playError();\n        break;\n    }\n  };\n\n  const showSpeechFeedback = (message: string) => {\n    // Show toast notification\n    if ((window as any).showToast) {\n      (window as any).showToast({\n        title: 'Voice Command',\n        description: message,\n        duration: 2000\n      });\n    }\n  };\n\n  const showSpeechIndicator = (isListening: boolean) => {\n    // Update global speech indicator\n    if ((window as any).setSpeechListening) {\n      (window as any).setSpeechListening(isListening);\n    }\n  };\n\n  const showCommandRecognized = (command: string, confidence: number) => {\n    // Show command recognition feedback\n    if ((window as any).showSpeechCommand) {\n      (window as any).showSpeechCommand(command, confidence);\n    }\n  };\n\n  // Component doesn't render anything - it's just for speech handling\n  return null;\n}","size_bytes":9491},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7609},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"border-2 border-blue-300 bg-blue-50 dark:bg-blue-950/50 text-blue-900 dark:text-blue-100 [&>svg]:text-blue-600 dark:[&>svg]:text-blue-400\",\n        destructive:\n          \"border-2 border-red-300 bg-red-50 dark:bg-red-950/50 text-red-900 dark:text-red-100 [&>svg]:text-red-600 dark:[&>svg]:text-red-400\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","size_bytes":1735},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border-2 border-gray-300 bg-white dark:bg-gray-800 text-gray-900 dark:text-white shadow-2xl backdrop-blur-sm\",\n        destructive:\n          \"destructive group border-2 border-red-500 bg-red-100 dark:bg-red-900 text-red-900 dark:text-red-100 shadow-2xl backdrop-blur-sm\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-gray-600 dark:text-gray-300 opacity-80 transition-opacity hover:text-gray-900 dark:hover:text-white hover:opacity-100 focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-600 dark:group-[.destructive]:text-red-400 group-[.destructive]:hover:text-red-800 dark:group-[.destructive]:hover:text-red-200 group-[.destructive]:focus:ring-red-400\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-bold text-gray-900 dark:text-white\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm font-medium opacity-100\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","size_bytes":5095},"client/src/components/bottom-navigation.tsx":{"content":"import { Link, useLocation } from \"wouter\";\nimport { Camera, Book, Activity, Target, ChefHat, Brain, Trophy, Lightbulb } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\n\nexport function BottomNavigation() {\n  const [location] = useLocation();\n\n  const navItems = [\n    {\n      href: \"/\",\n      icon: Camera,\n      label: \"Home\",\n      isActive: location === \"/\" || location === \"/home\"\n    },\n    {\n      href: \"/diary\",\n      icon: Book,\n      label: \"Diary\",\n      isActive: location === \"/diary\"\n    },\n    {\n      href: \"/insights\",\n      icon: Lightbulb,\n      label: \"Insights\",\n      isActive: location === \"/insights\"\n    },\n    {\n      href: \"/activity\",\n      icon: Activity,\n      label: \"Activity\",\n      isActive: location === \"/activity\"\n    },\n    {\n      href: \"/coaching\",\n      icon: Brain,\n      label: \"Coach\",\n      isActive: location === \"/coaching\"\n    },\n    {\n      href: \"/goals\",\n      icon: Target,\n      label: \"Goals\",\n      isActive: location === \"/goals\"\n    },\n    {\n      href: \"/recipes\",\n      icon: ChefHat,\n      label: \"Recipes\",\n      isActive: location === \"/recipes\"\n    },\n    {\n      href: \"/challenges\",\n      icon: Trophy,\n      label: \"Challenges\",\n      isActive: location === \"/challenges\"\n    }\n  ];\n\n  return (\n    <nav className=\"fixed bottom-0 left-0 right-0 bg-white/95 dark:bg-gray-900/95 backdrop-blur-md border-t border-border/50 z-40 w-full overflow-x-auto\">\n      {/* Add safe area padding for mobile devices */}\n      <div className=\"max-w-md mx-auto px-2 py-3 pb-6 w-full\">\n        <div className=\"flex justify-around items-center w-full min-w-fit gap-1\">\n          {navItems.map((item) => {\n            const Icon = item.icon;\n            return (\n              <Link key={item.href} href={item.href}>\n                <button\n                  className={cn(\n                    \"flex flex-col items-center justify-center px-3 py-2.5 rounded-xl transition-all duration-200 min-w-[44px] min-h-[44px] text-center touch-manipulation\",\n                    \"hover:bg-primary/10 hover:scale-105 active:scale-95\",\n                    item.isActive \n                      ? \"text-primary bg-primary/10 scale-105\" \n                      : \"text-black dark:text-white hover:text-foreground\"\n                  )}\n                  data-testid={`nav-${item.label.toLowerCase()}`}\n                  aria-label={`Navigate to ${item.label}`}\n                  aria-current={item.isActive ? 'page' : undefined}\n                >\n                  <Icon className=\"h-5 w-5 mb-1\" aria-hidden=\"true\" />\n                  <span className=\"text-[10px] font-medium whitespace-nowrap leading-tight\">{item.label}</span>\n                </button>\n              </Link>\n            );\n          })}\n        </div>\n      </div>\n    </nav>\n  );\n}","size_bytes":2787},"client/src/pages/CameraPage.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useMutation, useQuery, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest, getQueryFn } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { AppHeader } from \"@/components/app-header\";\nimport { soundService } from \"@/lib/sound-service\";\nimport { CameraInterface } from \"@/components/camera-interface\";\nimport { ProcessingState } from \"@/components/processing-state\";\nimport { ResultsDisplay } from \"@/components/results-display\";\nimport { ErrorState } from \"@/components/error-state\";\nimport { DrinksBar } from \"@/components/drinks-bar\";\nimport { Link } from \"wouter\";\nimport { Book, Utensils, Lightbulb, Target, HelpCircle, Calculator, Syringe, Zap, TrendingUp, Mic, MicOff, Plus, Keyboard, Scale } from \"lucide-react\";\n// Confetti disabled: import { ConfettiCelebration } from \"@/components/confetti-celebration\";\nimport type { FoodAnalysis, NutritionGoals, DiaryEntry, DiaryEntryWithAnalysis } from \"@shared/schema\";\nimport { DropdownNavigation } from \"@/components/dropdown-navigation\";\nimport { BottomHelpSection } from \"@/components/bottom-help-section\";\nimport { getPortionOptions, portionToGrams } from \"@/lib/portionHelpers\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\n\ntype AppState = 'camera' | 'processing' | 'results' | 'error';\n\nexport function CameraPage() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const { isAuthenticated } = useAuth();\n  const [currentState, setCurrentState] = useState<AppState>('camera');\n  const [analysisData, setAnalysisData] = useState<FoodAnalysis | null>(null);\n  const [errorMessage, setErrorMessage] = useState<string>('');\n  const [errorType, setErrorType] = useState<'food' | 'barcode'>('food');\n  \n  // Voice input state\n  const [isListening, setIsListening] = useState(false);\n  const [speechSupported, setSpeechSupported] = useState(false);\n  const [voiceInput, setVoiceInput] = useState('');\n  const [showVoiceMealDialog, setShowVoiceMealDialog] = useState(false);\n  const [textInput, setTextInput] = useState('');\n  const [showTextMealDialog, setShowTextMealDialog] = useState(false);\n  const [selectedMealType, setSelectedMealType] = useState<'breakfast' | 'lunch' | 'dinner' | 'snack'>('breakfast');\n  \n  // Review state for voice/type entries\n  const [showReviewDialog, setShowReviewDialog] = useState(false);\n  const [reviewAnalysis, setReviewAnalysis] = useState<FoodAnalysis | null>(null);\n  const [reviewDescription, setReviewDescription] = useState('');\n  const [editingFoodIndex, setEditingFoodIndex] = useState<number | null>(null);\n  \n  \n  // Confetti disabled per user request\n  // const [showPersistentConfetti, setShowPersistentConfetti] = useState(false);\n  \n  \n  // Fetch nutrition goals and diary entries to check for achievements\n  // Only fetch if authenticated\n  const { data: nutritionGoals } = useQuery<NutritionGoals>({\n    queryKey: ['/api/nutrition-goals'],\n    queryFn: getQueryFn({ on401: \"returnNull\" }),\n    retry: false,\n    enabled: isAuthenticated,\n  });\n\n  const { data: diaryEntries } = useQuery<DiaryEntryWithAnalysis[]>({\n    queryKey: ['/api/diary'],\n    queryFn: getQueryFn({ on401: \"returnNull\" }),\n    retry: false,\n    enabled: isAuthenticated,\n  });\n  \n  // Initialize speech recognition\n  useEffect(() => {\n    const checkSpeechSupport = () => {\n      const supported = 'SpeechRecognition' in window || 'webkitSpeechRecognition' in window;\n      setSpeechSupported(supported);\n    };\n    checkSpeechSupport();\n  }, []);\n\n  const handleAnalysisStart = () => {\n    soundService.playScan();\n    setCurrentState('processing');\n  };\n\n  const handleAnalysisSuccess = (data: FoodAnalysis) => {\n    soundService.playSuccess();\n    setAnalysisData(data);\n    setCurrentState('results');\n  };\n\n  const handleAnalysisError = (error: string, errorType: 'food' | 'barcode' = 'food') => {\n    soundService.playError();\n    setErrorMessage(error);\n    setErrorType(errorType);\n    setCurrentState('error');\n  };\n\n  const handleRetry = () => {\n    setCurrentState('camera');\n    setAnalysisData(null);\n    setErrorMessage('');\n    setErrorType('food');\n  };\n\n  const handleScanAnother = () => {\n    setCurrentState('camera');\n    setAnalysisData(null);\n  };\n\n  const handleVoiceInput = async () => {\n    if (!speechSupported) {\n      toast({\n        title: \"Speech Not Supported\",\n        description: \"Speech recognition is not supported in this browser\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (isListening) {\n      setIsListening(false);\n      return;\n    }\n\n    try {\n      const recognition = new (window.SpeechRecognition || (window as any).webkitSpeechRecognition)();\n      recognition.continuous = false;\n      recognition.interimResults = false;\n      recognition.lang = 'en-US';\n\n      recognition.onstart = () => {\n        setIsListening(true);\n        toast({\n          title: \"Listening...\",\n          description: \"Say your food item and quantity (e.g., '100g salmon')\",\n        });\n      };\n\n      recognition.onresult = (event: any) => {\n        const transcript = event.results[0][0].transcript;\n        setVoiceInput(transcript);\n        setShowVoiceMealDialog(true);\n        toast({\n          title: \"Voice captured!\",\n          description: `Heard: \"${transcript}\"`,\n        });\n      };\n\n      recognition.onerror = (event: any) => {\n        console.error('Speech recognition error:', event.error);\n        toast({\n          title: \"Speech Error\",\n          description: \"Could not recognize speech. Please try again.\",\n          variant: \"destructive\",\n        });\n        setIsListening(false);\n      };\n\n      recognition.onend = () => {\n        setIsListening(false);\n      };\n\n      recognition.start();\n    } catch (error) {\n      toast({\n        title: \"Speech Error\",\n        description: \"Failed to start speech recognition\",\n        variant: \"destructive\",\n      });\n      setIsListening(false);\n    }\n  };\n\n  const handleConfirmVoiceMeal = () => {\n    if (!voiceInput.trim()) return;\n    analyzeTextMutation.mutate({\n      foodDescription: voiceInput.trim(),\n      source: 'voice'\n    });\n  };\n\n  const handleConfirmTextMeal = () => {\n    if (!textInput.trim()) return;\n    analyzeTextMutation.mutate({\n      foodDescription: textInput.trim(),\n      source: 'text'\n    });\n  };\n\n  // Step 1: Analyze text (voice or typed) - doesn't save to diary yet\n  const analyzeTextMutation = useMutation({\n    mutationFn: async ({ foodDescription }: { foodDescription: string, source: string }) => {\n      if (!isAuthenticated) {\n        throw new Error(\"Please log in to add meals to your diary\");\n      }\n      \n      // Analyze the text-based food description\n      const analysisResponse = await apiRequest('POST', '/api/analyze-text', { foodDescription });\n      const analysis = await analysisResponse.json();\n      return { analysis, foodDescription };\n    },\n    onSuccess: ({ analysis, foodDescription }) => {\n      // Close input dialogs\n      setShowVoiceMealDialog(false);\n      setShowTextMealDialog(false);\n      \n      // Show review dialog with analysis\n      setReviewAnalysis(analysis);\n      setReviewDescription(foodDescription);\n      setShowReviewDialog(true);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Analysis Error\",\n        description: error.message || \"Failed to analyze food. Please try again.\",\n        variant: \"destructive\",\n      });\n      console.error(\"Error analyzing text:\", error);\n    },\n  });\n\n  // Step 2: Save to diary after user reviews and confirms\n  const saveToDiaryMutation = useMutation({\n    mutationFn: async ({ analysisId, mealType, notes, updatedFoods }: { \n      analysisId: string, \n      mealType: string, \n      notes: string,\n      updatedFoods?: any[]\n    }) => {\n      // If foods were edited, update the analysis first\n      if (updatedFoods) {\n        await apiRequest('PATCH', `/api/analyses/${analysisId}`, {\n          detectedFoods: updatedFoods\n        });\n      }\n      \n      // Then create diary entry with updated analysis\n      const now = new Date();\n      const diaryResponse = await apiRequest('POST', '/api/diary', {\n        analysisId,\n        mealType,\n        mealDate: now.toISOString(),\n        notes\n      });\n      return await diaryResponse.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Meal Added!\",\n        description: \"Your meal has been added to your diary.\",\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/diary'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges/points'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges/streak'] });\n      setShowReviewDialog(false);\n      setReviewAnalysis(null);\n      setVoiceInput('');\n      setTextInput('');\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to add meal to diary. Please try again.\",\n        variant: \"destructive\",\n      });\n      console.error(\"Error saving to diary:\", error);\n    },\n  });\n\n  return (\n    <div className=\"text-foreground min-h-screen\" style={{background: 'var(--bg-gradient)'}}>\n      <AppHeader />\n      \n      {/* Voice and Type Add Buttons - Only show if authenticated */}\n      {currentState === 'camera' && isAuthenticated && (\n        <div className=\"max-w-md mx-auto px-4 mb-4\">\n          <div className=\"grid grid-cols-2 gap-3 mb-4\">\n            <button\n              onClick={handleVoiceInput}\n              disabled={!speechSupported}\n              className={`py-3 px-4 rounded-xl font-medium flex items-center justify-center space-x-2 transition-all duration-200 ${\n                isListening\n                  ? 'bg-red-500 text-white'\n                  : speechSupported\n                  ? 'bg-slate-700 text-white hover:bg-slate-600'\n                  : 'bg-gray-400 text-gray-600 cursor-not-allowed'\n              }`}\n              data-testid=\"button-add-voice\"\n            >\n              {isListening ? (\n                <MicOff className=\"h-4 w-4\" />\n              ) : (\n                <Mic className=\"h-4 w-4\" />\n              )}\n              <span className=\"text-sm\">\n                {isListening ? 'Listening...' : 'Voice Add'}\n              </span>\n            </button>\n            \n            <button\n              onClick={() => setShowTextMealDialog(true)}\n              className=\"py-3 px-4 rounded-xl font-medium flex items-center justify-center space-x-2 transition-all duration-200 bg-blue-600 text-white hover:bg-blue-500\"\n              data-testid=\"button-add-type\"\n            >\n              <Plus className=\"h-4 w-4\" />\n              <span className=\"text-sm\">Type</span>\n            </button>\n          </div>\n\n          {/* Quick Actions */}\n          <div className=\"grid grid-cols-2 gap-3\">\n            <Link \n              href=\"/diary?tab=weight\"\n              className=\"py-3 px-4 rounded-xl font-medium flex items-center justify-center space-x-2 transition-all duration-200 bg-orange-500 text-white hover:bg-orange-600 hover:scale-[1.02] no-underline\"\n              data-testid=\"button-weigh-in\"\n            >\n              <Scale className=\"h-4 w-4\" />\n              <span className=\"text-sm\">Weigh In</span>\n            </Link>\n\n            <Link href=\"/advice\">\n              <button \n                className=\"w-full vibrant-button hover:scale-[1.02] py-3 px-4 rounded-xl font-medium flex items-center justify-center space-x-2 text-white\"\n                data-testid=\"button-diet-advice\"\n              >\n                <Lightbulb className=\"h-4 w-4\" />\n                <span className=\"text-sm\">AI Advice</span>\n              </button>\n            </Link>\n          </div>\n        </div>\n      )}\n\n      {/* Persistent Quick Actions Bar */}\n      {(currentState === 'processing' || currentState === 'results' || currentState === 'error') && (\n        <div className=\"max-w-md mx-auto px-4 py-2 mb-4\">\n          <div className=\"flex justify-center space-x-4\">\n            <Link href=\"/diary\">\n              <button className=\"flex items-center space-x-2 px-4 py-2 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded-lg hover:bg-blue-200 dark:hover:bg-blue-900/50 transition-colors\" data-testid=\"quick-diary\">\n                <Book className=\"h-4 w-4\" />\n                <span className=\"text-sm font-medium\">Diary</span>\n              </button>\n            </Link>\n            <Link href=\"/advice\">\n              <button className=\"flex items-center space-x-2 px-4 py-2 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 rounded-lg hover:bg-purple-200 dark:hover:bg-purple-900/50 transition-colors\" data-testid=\"quick-advice\">\n                <Lightbulb className=\"h-4 w-4\" />\n                <span className=\"text-sm font-medium\">Advice</span>\n              </button>\n            </Link>\n          </div>\n        </div>\n      )}\n\n      <div className=\"max-w-md mx-auto\">\n        {currentState === 'camera' && (\n          <CameraInterface\n            onAnalysisStart={handleAnalysisStart}\n            onAnalysisSuccess={handleAnalysisSuccess}\n            onAnalysisError={handleAnalysisError}\n          />\n        )}\n        \n        {currentState === 'processing' && <ProcessingState />}\n        \n        {currentState === 'results' && analysisData && (\n          <ResultsDisplay \n            data={analysisData} \n            onScanAnother={handleScanAnother}\n          />\n        )}\n        \n        {currentState === 'error' && (\n          <ErrorState \n            message={errorMessage}\n            onRetry={handleRetry}\n            type={errorType}\n          />\n        )}\n      </div>\n\n      {/* Drinks Bar - Moved to bottom */}\n      {currentState === 'camera' && (\n        <div className=\"max-w-md mx-auto\">\n          <DrinksBar />\n        </div>\n      )}\n      \n      {/* Voice Meal Confirmation Dialog */}\n      {showVoiceMealDialog && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4 backdrop-blur-sm\">\n          <div className=\"bg-card rounded-2xl p-6 w-full max-w-md shadow-2xl border border-border/20\">\n            <h3 className=\"text-xl font-bold mb-6 flex items-center gap-3\">\n              <div className=\"p-2 bg-primary/10 rounded-lg\">\n                <Mic className=\"h-6 w-6 text-primary\" />\n              </div>\n              Add Voice Meal\n            </h3>\n            \n            <div className=\"space-y-6\">\n              {/* Voice Input Display */}\n              <div className=\"bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-950/30 dark:to-indigo-950/30 rounded-xl p-4 border border-blue-200/30 dark:border-blue-700/30\">\n                <label className=\"block text-sm font-semibold mb-3 text-blue-700 dark:text-blue-300\">What you said:</label>\n                <div className=\"bg-gradient-to-r from-white to-blue-50 dark:from-gray-900 dark:to-blue-950/50 p-6 rounded-xl border-3 border-blue-300 dark:border-blue-600 shadow-lg\">\n                  <p className=\"text-2xl font-black text-blue-900 dark:text-blue-100 leading-relaxed text-center tracking-wide\">\n                    \"{voiceInput}\"\n                  </p>\n                </div>\n              </div>\n\n              {/* Meal Type Selection */}\n              <div>\n                <label className=\"block text-sm font-semibold mb-3 text-gray-700 dark:text-gray-300\">Meal Type</label>\n                <div className=\"grid grid-cols-2 gap-3\">\n                  {(['breakfast', 'lunch', 'dinner', 'snack'] as const).map((meal) => (\n                    <button\n                      key={meal}\n                      onClick={() => setSelectedMealType(meal)}\n                      className={`py-3 px-4 rounded-xl text-sm font-bold transition-all duration-200 ${\n                        selectedMealType === meal\n                          ? 'bg-gradient-to-r from-green-500 to-emerald-500 text-white shadow-lg transform scale-105 border-2 border-green-400'\n                          : 'bg-gradient-to-r from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-600 text-gray-700 dark:text-gray-200 hover:from-gray-200 hover:to-gray-300 dark:hover:from-gray-600 dark:hover:to-gray-500 border-2 border-transparent hover:border-gray-300 dark:hover:border-gray-500'\n                      }`}\n                      data-testid={`button-voice-meal-${meal}`}\n                    >\n                      {meal.charAt(0).toUpperCase() + meal.slice(1)}\n                    </button>\n                  ))}\n                </div>\n              </div>\n            </div>\n\n            {/* Dialog Actions */}\n            <div className=\"flex space-x-4 mt-6\">\n              <button\n                onClick={() => setShowVoiceMealDialog(false)}\n                disabled={analyzeTextMutation.isPending}\n                className=\"flex-1 py-3 px-6 border-2 border-gray-300 dark:border-gray-600 rounded-xl font-bold text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-all duration-200 disabled:opacity-50\"\n                data-testid=\"button-cancel-voice-meal\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleConfirmVoiceMeal}\n                disabled={analyzeTextMutation.isPending}\n                className=\"flex-1 py-3 px-6 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-xl font-bold hover:from-green-600 hover:to-emerald-600 disabled:opacity-50 transition-all duration-200 shadow-lg\"\n                data-testid=\"button-confirm-voice-meal\"\n              >\n                {analyzeTextMutation.isPending ? 'Analyzing...' : 'Analyze Meal'}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Text Meal Dialog */}\n      {showTextMealDialog && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4 backdrop-blur-sm\">\n          <div className=\"bg-card rounded-2xl p-6 w-full max-w-md shadow-2xl border border-border/20\">\n            <h3 className=\"text-xl font-bold mb-6 flex items-center gap-3\">\n              <div className=\"p-2 bg-primary/10 rounded-lg\">\n                <Keyboard className=\"h-6 w-6 text-primary\" />\n              </div>\n              Add Text Meal\n            </h3>\n            \n            <div className=\"space-y-6\">\n              {/* Text Input */}\n              <div>\n                <label className=\"block text-sm font-semibold mb-3 text-gray-700 dark:text-gray-300\">Describe your meal:</label>\n                <textarea\n                  value={textInput}\n                  onChange={(e) => setTextInput(e.target.value)}\n                  placeholder=\"e.g., 200g grilled chicken breast with rice\"\n                  className=\"w-full p-4 border rounded-xl resize-none h-24 text-sm focus:ring-2 focus:ring-primary focus:border-primary\"\n                  data-testid=\"textarea-text-meal\"\n                />\n              </div>\n\n              {/* Meal Type Selection */}\n              <div>\n                <label className=\"block text-sm font-semibold mb-3 text-gray-700 dark:text-gray-300\">Meal Type</label>\n                <div className=\"grid grid-cols-2 gap-3\">\n                  {(['breakfast', 'lunch', 'dinner', 'snack'] as const).map((meal) => (\n                    <button\n                      key={meal}\n                      onClick={() => setSelectedMealType(meal)}\n                      className={`py-3 px-4 rounded-xl text-sm font-bold transition-all duration-200 ${\n                        selectedMealType === meal\n                          ? 'bg-gradient-to-r from-green-500 to-emerald-500 text-white shadow-lg transform scale-105 border-2 border-green-400'\n                          : 'bg-gradient-to-r from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-600 text-gray-700 dark:text-gray-200 hover:from-gray-200 hover:to-gray-300 dark:hover:from-gray-600 dark:hover:to-gray-500 border-2 border-transparent hover:border-gray-300 dark:hover:border-gray-500'\n                      }`}\n                      data-testid={`button-text-meal-${meal}`}\n                    >\n                      {meal.charAt(0).toUpperCase() + meal.slice(1)}\n                    </button>\n                  ))}\n                </div>\n              </div>\n            </div>\n\n            {/* Dialog Actions */}\n            <div className=\"flex space-x-4 mt-6\">\n              <button\n                onClick={() => setShowTextMealDialog(false)}\n                disabled={analyzeTextMutation.isPending}\n                className=\"flex-1 py-3 px-6 border-2 border-gray-300 dark:border-gray-600 rounded-xl font-bold text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-all duration-200 disabled:opacity-50\"\n                data-testid=\"button-cancel-text-meal\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleConfirmTextMeal}\n                disabled={analyzeTextMutation.isPending || !textInput.trim()}\n                className=\"flex-1 py-3 px-6 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-xl font-bold hover:from-green-600 hover:to-emerald-600 disabled:opacity-50 transition-all duration-200 shadow-lg\"\n                data-testid=\"button-confirm-text-meal\"\n              >\n                {analyzeTextMutation.isPending ? 'Analyzing...' : 'Analyze Meal'}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Review Dialog - Shows AI analysis before saving to diary */}\n      {showReviewDialog && reviewAnalysis && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4 backdrop-blur-sm overflow-y-auto\">\n          <div className=\"bg-card rounded-2xl p-5 w-full max-w-md shadow-2xl border border-border/20 my-8\">\n            <h3 className=\"text-lg font-bold mb-3 flex items-center gap-2\">\n              <Utensils className=\"h-5 w-5 text-primary\" />\n              Review & Edit\n            </h3>\n            <p className=\"text-xs text-muted-foreground mb-4\">\n              \"{reviewDescription}\"\n            </p>\n            \n            {/* Detected Foods - Editable */}\n            <div className=\"space-y-3 mb-5\">\n              {reviewAnalysis.detectedFoods.map((food, index) => {\n                const isEditing = editingFoodIndex === index;\n                \n                return (\n                  <div \n                    key={index}\n                    className=\"bg-gradient-to-r from-purple-50 to-white dark:from-purple-900/20 dark:to-gray-800 rounded-xl p-3 border border-purple-200/50 dark:border-purple-700/30\"\n                  >\n                    <div className=\"flex items-start justify-between mb-2\">\n                      <div className=\"flex-1\">\n                        {isEditing ? (\n                          <input\n                            type=\"text\"\n                            value={food.name}\n                            onChange={(e) => {\n                              setReviewAnalysis(prev => prev ? {\n                                ...prev,\n                                detectedFoods: prev.detectedFoods.map((f, i) => \n                                  i === index ? { ...f, name: e.target.value } : f\n                                )\n                              } : null);\n                            }}\n                            className=\"font-bold text-sm w-full px-2 py-1 border rounded dark:bg-gray-700 dark:border-gray-600\"\n                            placeholder=\"Food name\"\n                          />\n                        ) : (\n                          <p className=\"font-bold text-sm text-gray-900 dark:text-white\">{food.name}</p>\n                        )}\n                        <Select\n                          value={food.portion}\n                          onValueChange={(newPortion) => {\n                            if (!reviewAnalysis) return;\n                            \n                            const currentFood = reviewAnalysis.detectedFoods[index];\n                            const oldGrams = portionToGrams(currentFood.portion);\n                            const newGrams = portionToGrams(newPortion);\n                            const scaleFactor = newGrams / oldGrams;\n                            \n                            const updatedFoods = reviewAnalysis.detectedFoods.map((f, i) => {\n                              if (i !== index) return f;\n                              return {\n                                ...f,\n                                portion: newPortion,\n                                calories: Math.round(f.calories * scaleFactor),\n                                protein: Math.round(f.protein * scaleFactor),\n                                carbs: Math.round(f.carbs * scaleFactor),\n                                fat: Math.round(f.fat * scaleFactor)\n                              };\n                            });\n                            \n                            setReviewAnalysis({\n                              ...reviewAnalysis,\n                              detectedFoods: updatedFoods,\n                              totalCalories: updatedFoods.reduce((sum, f) => sum + f.calories, 0),\n                              totalProtein: updatedFoods.reduce((sum, f) => sum + f.protein, 0),\n                              totalCarbs: updatedFoods.reduce((sum, f) => sum + f.carbs, 0),\n                              totalFat: updatedFoods.reduce((sum, f) => sum + f.fat, 0)\n                            });\n                          }}\n                        >\n                          <SelectTrigger className=\"w-full mt-1 text-xs\" data-testid={`select-portion-${index}`}>\n                            <SelectValue placeholder=\"Select portion\" />\n                          </SelectTrigger>\n                          <SelectContent>\n                            {getPortionOptions(food.name, food.portion).map((option) => (\n                              <SelectItem key={option} value={option} data-testid={`option-portion-${option}`}>\n                                {option}\n                              </SelectItem>\n                            ))}\n                          </SelectContent>\n                        </Select>\n                      </div>\n                      {isEditing ? (\n                        <button\n                          onClick={() => {\n                            if (!reviewAnalysis) return;\n                            // Recalculate totals immutably\n                            setReviewAnalysis({\n                              ...reviewAnalysis,\n                              totalCalories: reviewAnalysis.detectedFoods.reduce((sum, f) => sum + f.calories, 0),\n                              totalProtein: reviewAnalysis.detectedFoods.reduce((sum, f) => sum + f.protein, 0),\n                              totalCarbs: reviewAnalysis.detectedFoods.reduce((sum, f) => sum + f.carbs, 0),\n                              totalFat: reviewAnalysis.detectedFoods.reduce((sum, f) => sum + f.fat, 0)\n                            });\n                            setEditingFoodIndex(null);\n                          }}\n                          className=\"text-xs px-2 py-1 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 rounded hover:bg-green-200 dark:hover:bg-green-900/50\"\n                        >\n                          Done\n                        </button>\n                      ) : (\n                        <button\n                          onClick={() => setEditingFoodIndex(index)}\n                          className=\"text-xs px-2 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-900/50\"\n                        >\n                          Edit\n                        </button>\n                      )}\n                    </div>\n                    \n                    {/* Nutrition Values - Editable when editing */}\n                    {isEditing ? (\n                      <div className=\"grid grid-cols-4 gap-2\">\n                        <div>\n                          <label className=\"text-[10px] text-muted-foreground block mb-1\">cal</label>\n                          <input\n                            type=\"number\"\n                            value={food.calories}\n                            onChange={(e) => {\n                              setReviewAnalysis(prev => prev ? {\n                                ...prev,\n                                detectedFoods: prev.detectedFoods.map((f, i) => \n                                  i === index ? { ...f, calories: parseInt(e.target.value) || 0 } : f\n                                )\n                              } : null);\n                            }}\n                            className=\"w-full px-1 py-1 text-xs border rounded text-center dark:bg-gray-700 dark:border-gray-600\"\n                          />\n                        </div>\n                        <div>\n                          <label className=\"text-[10px] text-muted-foreground block mb-1\">protein</label>\n                          <input\n                            type=\"number\"\n                            value={food.protein}\n                            onChange={(e) => {\n                              setReviewAnalysis(prev => prev ? {\n                                ...prev,\n                                detectedFoods: prev.detectedFoods.map((f, i) => \n                                  i === index ? { ...f, protein: parseInt(e.target.value) || 0 } : f\n                                )\n                              } : null);\n                            }}\n                            className=\"w-full px-1 py-1 text-xs border rounded text-center dark:bg-gray-700 dark:border-gray-600\"\n                          />\n                        </div>\n                        <div>\n                          <label className=\"text-[10px] text-muted-foreground block mb-1\">carbs</label>\n                          <input\n                            type=\"number\"\n                            value={food.carbs}\n                            onChange={(e) => {\n                              setReviewAnalysis(prev => prev ? {\n                                ...prev,\n                                detectedFoods: prev.detectedFoods.map((f, i) => \n                                  i === index ? { ...f, carbs: parseInt(e.target.value) || 0 } : f\n                                )\n                              } : null);\n                            }}\n                            className=\"w-full px-1 py-1 text-xs border rounded text-center dark:bg-gray-700 dark:border-gray-600\"\n                          />\n                        </div>\n                        <div>\n                          <label className=\"text-[10px] text-muted-foreground block mb-1\">fat</label>\n                          <input\n                            type=\"number\"\n                            value={food.fat}\n                            onChange={(e) => {\n                              setReviewAnalysis(prev => prev ? {\n                                ...prev,\n                                detectedFoods: prev.detectedFoods.map((f, i) => \n                                  i === index ? { ...f, fat: parseInt(e.target.value) || 0 } : f\n                                )\n                              } : null);\n                            }}\n                            className=\"w-full px-1 py-1 text-xs border rounded text-center dark:bg-gray-700 dark:border-gray-600\"\n                          />\n                        </div>\n                      </div>\n                    ) : (\n                      <div className=\"grid grid-cols-4 gap-2 text-center\">\n                        <div>\n                          <div className=\"text-sm font-bold text-orange-600\">{food.calories}</div>\n                          <div className=\"text-[10px] text-muted-foreground\">cal</div>\n                        </div>\n                        <div>\n                          <div className=\"text-sm font-bold text-blue-600\">{food.protein}g</div>\n                          <div className=\"text-[10px] text-muted-foreground\">protein</div>\n                        </div>\n                        <div>\n                          <div className=\"text-sm font-bold text-yellow-600\">{food.carbs}g</div>\n                          <div className=\"text-[10px] text-muted-foreground\">carbs</div>\n                        </div>\n                        <div>\n                          <div className=\"text-sm font-bold text-green-600\">{food.fat}g</div>\n                          <div className=\"text-[10px] text-muted-foreground\">fat</div>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                );\n              })}\n            </div>\n\n            {/* Total Nutrition Summary */}\n            <div className=\"bg-gradient-to-r from-purple-100 to-pink-100 dark:from-purple-900/40 dark:to-pink-900/40 rounded-xl p-3 mb-4\">\n              <p className=\"text-xs font-semibold mb-2 text-gray-700 dark:text-gray-300\">Total Nutrition:</p>\n              <div className=\"grid grid-cols-4 gap-2 text-center\">\n                <div>\n                  <div className=\"text-base font-bold text-orange-600\">{reviewAnalysis.totalCalories}</div>\n                  <div className=\"text-[10px] text-muted-foreground\">cal</div>\n                </div>\n                <div>\n                  <div className=\"text-base font-bold text-blue-600\">{reviewAnalysis.totalProtein}g</div>\n                  <div className=\"text-[10px] text-muted-foreground\">protein</div>\n                </div>\n                <div>\n                  <div className=\"text-base font-bold text-yellow-600\">{reviewAnalysis.totalCarbs}g</div>\n                  <div className=\"text-[10px] text-muted-foreground\">carbs</div>\n                </div>\n                <div>\n                  <div className=\"text-base font-bold text-green-600\">{reviewAnalysis.totalFat}g</div>\n                  <div className=\"text-[10px] text-muted-foreground\">fat</div>\n                </div>\n              </div>\n            </div>\n\n            {/* Meal Type Selection */}\n            <div className=\"mb-4\">\n              <label className=\"block text-sm font-semibold mb-2 text-gray-700 dark:text-gray-300\">Meal Type</label>\n              <div className=\"grid grid-cols-2 gap-2\">\n                {(['breakfast', 'lunch', 'dinner', 'snack'] as const).map((meal) => (\n                  <button\n                    key={meal}\n                    onClick={() => setSelectedMealType(meal)}\n                    className={`py-2 px-3 rounded-lg text-xs font-bold transition-all duration-200 ${\n                      selectedMealType === meal\n                        ? 'bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-md transform scale-105'\n                        : 'bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-600'\n                    }`}\n                    data-testid={`button-review-meal-${meal}`}\n                  >\n                    {meal.charAt(0).toUpperCase() + meal.slice(1)}\n                  </button>\n                ))}\n              </div>\n            </div>\n\n            {/* Action Buttons */}\n            <div className=\"flex space-x-3\">\n              <button\n                onClick={() => {\n                  setShowReviewDialog(false);\n                  setReviewAnalysis(null);\n                }}\n                disabled={saveToDiaryMutation.isPending}\n                className=\"flex-1 py-2.5 px-4 border-2 border-gray-300 dark:border-gray-600 rounded-xl font-bold text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-all duration-200 disabled:opacity-50\"\n                data-testid=\"button-cancel-review\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={() => {\n                  saveToDiaryMutation.mutate({\n                    analysisId: reviewAnalysis.id,\n                    mealType: selectedMealType,\n                    notes: `Added via text/voice: \"${reviewDescription}\"`,\n                    updatedFoods: reviewAnalysis.detectedFoods\n                  });\n                }}\n                disabled={saveToDiaryMutation.isPending}\n                className=\"flex-1 py-2.5 px-4 bg-gradient-to-r from-purple-600 to-pink-500 text-white rounded-xl font-bold text-sm hover:from-purple-700 hover:to-pink-600 disabled:opacity-50 transition-all duration-200 shadow-lg\"\n                data-testid=\"button-save-to-diary\"\n              >\n                {saveToDiaryMutation.isPending ? 'Saving...' : 'Save to Diary'}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n      \n      {/* Bottom Navigation */}\n      <DropdownNavigation />\n      \n      {/* Bottom Help Section */}\n      <BottomHelpSection />\n      \n      {/* Confetti celebration disabled per user request */}\n    </div>\n  );\n}\n\nexport default CameraPage;","size_bytes":37361},"android/app/src/main/assets/public/assets/index-Dg-kYJjB.css":{"content":"@import\"https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap\";@import\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\";*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }*,:before,:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:before,:after{--tw-content: \"\"}html,:host{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:var(--font-sans);font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:var(--font-mono);font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}ol,ul,menu{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}*{border-color:var(--border)}body{font-family:var(--font-sans);color:var(--foreground);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;background:var(--background);min-height:100vh}h1,h2,h3,h4,h5,h6{font-weight:500;letter-spacing:-.025em}.gradient-text{background:var(--primary);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.glass-card{background:#fffffff2;-webkit-backdrop-filter:blur(16px);backdrop-filter:blur(16px);border:1px solid rgba(255,255,255,.2);box-shadow:var(--shadow-soft)}.dark .glass-card{background:#1e1e32f2;border:1px solid rgba(255,255,255,.1)}.gradient-button{background:var(--primary);border:none;color:var(--primary-foreground);transition:all .3s cubic-bezier(.4,0,.2,1);transform:translateY(0);box-shadow:var(--shadow-soft)}.gradient-button:hover{transform:translateY(-2px);box-shadow:var(--shadow-medium)}.gradient-button:active{transform:translateY(0);box-shadow:var(--shadow-soft)}.modern-card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow-soft);transition:all .3s cubic-bezier(.4,0,.2,1)}.modern-card:hover{box-shadow:var(--shadow-medium);transform:translateY(-2px)}.smooth-transition{transition:all .3s cubic-bezier(.4,0,.2,1)}.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}.pointer-events-none{pointer-events:none}.pointer-events-auto{pointer-events:auto}.visible{visibility:visible}.invisible{visibility:hidden}.static{position:static}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.inset-0{top:0;right:0;bottom:0;left:0}.inset-16{top:4rem;right:4rem;bottom:4rem;left:4rem}.inset-x-0{left:0;right:0}.inset-y-0{top:0;bottom:0}.-bottom-1{bottom:-.25rem}.-bottom-12{bottom:-3rem}.-left-1{left:-.25rem}.-left-12{left:-3rem}.-right-1{right:-.25rem}.-right-12{right:-3rem}.-right-2{right:-.5rem}.-right-4{right:-1rem}.-top-1{top:-.25rem}.-top-12{top:-3rem}.-top-2{top:-.5rem}.-top-4{top:-1rem}.bottom-0{bottom:0}.bottom-1\\/4{bottom:25%}.bottom-10{bottom:2.5rem}.bottom-24{bottom:6rem}.left-0{left:0}.left-1{left:.25rem}.left-1\\/2{left:50%}.left-1\\/4{left:25%}.left-10{left:2.5rem}.left-2{left:.5rem}.left-3{left:.75rem}.left-\\[50\\%\\]{left:50%}.right-0{right:0}.right-1{right:.25rem}.right-10{right:2.5rem}.right-2{right:.5rem}.right-20{right:5rem}.right-3{right:.75rem}.right-4{right:1rem}.top-0{top:0}.top-1\\.5{top:.375rem}.top-1\\/2{top:50%}.top-1\\/4{top:25%}.top-10{top:2.5rem}.top-2{top:.5rem}.top-20{top:5rem}.top-3\\.5{top:.875rem}.top-4{top:1rem}.top-\\[1px\\]{top:1px}.top-\\[50\\%\\]{top:50%}.top-\\[60\\%\\]{top:60%}.top-full{top:100%}.z-10{z-index:10}.z-20{z-index:20}.z-40{z-index:40}.z-50{z-index:50}.z-\\[100\\]{z-index:100}.z-\\[1\\]{z-index:1}.z-\\[9999\\]{z-index:9999}.col-span-2{grid-column:span 2 / span 2}.-mx-1{margin-left:-.25rem;margin-right:-.25rem}.-mx-6{margin-left:-1.5rem;margin-right:-1.5rem}.mx-1{margin-left:.25rem;margin-right:.25rem}.mx-2{margin-left:.5rem;margin-right:.5rem}.mx-3\\.5{margin-left:.875rem;margin-right:.875rem}.mx-4{margin-left:1rem;margin-right:1rem}.mx-auto{margin-left:auto;margin-right:auto}.my-0\\.5{margin-top:.125rem;margin-bottom:.125rem}.my-1{margin-top:.25rem;margin-bottom:.25rem}.-mb-6{margin-bottom:-1.5rem}.-ml-4{margin-left:-1rem}.-mt-4{margin-top:-1rem}.mb-1{margin-bottom:.25rem}.mb-12{margin-bottom:3rem}.mb-16{margin-bottom:4rem}.mb-2{margin-bottom:.5rem}.mb-24{margin-bottom:6rem}.mb-3{margin-bottom:.75rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mb-8{margin-bottom:2rem}.ml-1{margin-left:.25rem}.ml-2{margin-left:.5rem}.ml-4{margin-left:1rem}.ml-6{margin-left:1.5rem}.ml-auto{margin-left:auto}.mr-1{margin-right:.25rem}.mr-2{margin-right:.5rem}.mt-0\\.5{margin-top:.125rem}.mt-1{margin-top:.25rem}.mt-1\\.5{margin-top:.375rem}.mt-16{margin-top:4rem}.mt-2{margin-top:.5rem}.mt-24{margin-top:6rem}.mt-3{margin-top:.75rem}.mt-4{margin-top:1rem}.mt-6{margin-top:1.5rem}.mt-8{margin-top:2rem}.mt-auto{margin-top:auto}.line-clamp-2{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2}.block{display:block}.inline-block{display:inline-block}.inline{display:inline}.flex{display:flex}.inline-flex{display:inline-flex}.table{display:table}.grid{display:grid}.hidden{display:none}.aspect-square{aspect-ratio:1 / 1}.aspect-video{aspect-ratio:16 / 9}.size-4{width:1rem;height:1rem}.h-1{height:.25rem}.h-1\\.5{height:.375rem}.h-10{height:2.5rem}.h-11{height:2.75rem}.h-12{height:3rem}.h-16{height:4rem}.h-2{height:.5rem}.h-2\\.5{height:.625rem}.h-20{height:5rem}.h-24{height:6rem}.h-3{height:.75rem}.h-3\\.5{height:.875rem}.h-32{height:8rem}.h-4{height:1rem}.h-48{height:12rem}.h-5{height:1.25rem}.h-6{height:1.5rem}.h-64{height:16rem}.h-7{height:1.75rem}.h-8{height:2rem}.h-9{height:2.25rem}.h-\\[1px\\]{height:1px}.h-\\[var\\(--radix-navigation-menu-viewport-height\\)\\]{height:var(--radix-navigation-menu-viewport-height)}.h-\\[var\\(--radix-select-trigger-height\\)\\]{height:var(--radix-select-trigger-height)}.h-auto{height:auto}.h-full{height:100%}.h-px{height:1px}.h-screen{height:100vh}.h-svh{height:100svh}.max-h-32{max-height:8rem}.max-h-48{max-height:12rem}.max-h-64{max-height:16rem}.max-h-96{max-height:24rem}.max-h-\\[--radix-context-menu-content-available-height\\]{max-height:var(--radix-context-menu-content-available-height)}.max-h-\\[--radix-select-content-available-height\\]{max-height:var(--radix-select-content-available-height)}.max-h-\\[300px\\]{max-height:300px}.max-h-\\[80vh\\]{max-height:80vh}.max-h-\\[90vh\\]{max-height:90vh}.max-h-\\[var\\(--radix-dropdown-menu-content-available-height\\)\\]{max-height:var(--radix-dropdown-menu-content-available-height)}.max-h-screen{max-height:100vh}.min-h-0{min-height:0px}.min-h-\\[44px\\]{min-height:44px}.min-h-\\[80px\\]{min-height:80px}.min-h-screen{min-height:100vh}.min-h-svh{min-height:100svh}.w-0{width:0px}.w-1{width:.25rem}.w-1\\/2{width:50%}.w-1\\/3{width:33.333333%}.w-10{width:2.5rem}.w-11{width:2.75rem}.w-12{width:3rem}.w-16{width:4rem}.w-2{width:.5rem}.w-2\\.5{width:.625rem}.w-2\\/3{width:66.666667%}.w-20{width:5rem}.w-24{width:6rem}.w-3{width:.75rem}.w-3\\.5{width:.875rem}.w-3\\/4{width:75%}.w-32{width:8rem}.w-4{width:1rem}.w-5{width:1.25rem}.w-6{width:1.5rem}.w-64{width:16rem}.w-7{width:1.75rem}.w-72{width:18rem}.w-8{width:2rem}.w-80{width:20rem}.w-9{width:2.25rem}.w-\\[--sidebar-width\\]{width:var(--sidebar-width)}.w-\\[100px\\]{width:100px}.w-\\[1px\\]{width:1px}.w-auto{width:auto}.w-fit{width:-moz-fit-content;width:fit-content}.w-full{width:100%}.w-max{width:-moz-max-content;width:max-content}.w-px{width:1px}.w-screen{width:100vw}.min-w-0{min-width:0px}.min-w-10{min-width:2.5rem}.min-w-11{min-width:2.75rem}.min-w-5{min-width:1.25rem}.min-w-9{min-width:2.25rem}.min-w-\\[12rem\\]{min-width:12rem}.min-w-\\[200px\\]{min-width:200px}.min-w-\\[44px\\]{min-width:44px}.min-w-\\[8rem\\]{min-width:8rem}.min-w-\\[var\\(--radix-select-trigger-width\\)\\]{min-width:var(--radix-select-trigger-width)}.min-w-fit{min-width:-moz-fit-content;min-width:fit-content}.max-w-2xl{max-width:42rem}.max-w-4xl{max-width:56rem}.max-w-6xl{max-width:72rem}.max-w-\\[--skeleton-width\\]{max-width:var(--skeleton-width)}.max-w-full{max-width:100%}.max-w-lg{max-width:32rem}.max-w-max{max-width:-moz-max-content;max-width:max-content}.max-w-md{max-width:28rem}.max-w-sm{max-width:24rem}.flex-1{flex:1 1 0%}.flex-shrink-0,.shrink-0{flex-shrink:0}.grow{flex-grow:1}.grow-0{flex-grow:0}.basis-full{flex-basis:100%}.caption-bottom{caption-side:bottom}.border-collapse{border-collapse:collapse}.origin-\\[--radix-context-menu-content-transform-origin\\]{transform-origin:var(--radix-context-menu-content-transform-origin)}.origin-\\[--radix-dropdown-menu-content-transform-origin\\]{transform-origin:var(--radix-dropdown-menu-content-transform-origin)}.origin-\\[--radix-hover-card-content-transform-origin\\]{transform-origin:var(--radix-hover-card-content-transform-origin)}.origin-\\[--radix-menubar-content-transform-origin\\]{transform-origin:var(--radix-menubar-content-transform-origin)}.origin-\\[--radix-popover-content-transform-origin\\]{transform-origin:var(--radix-popover-content-transform-origin)}.origin-\\[--radix-select-content-transform-origin\\]{transform-origin:var(--radix-select-content-transform-origin)}.origin-\\[--radix-tooltip-content-transform-origin\\]{transform-origin:var(--radix-tooltip-content-transform-origin)}.-translate-x-1\\/2{--tw-translate-x: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-x-px{--tw-translate-x: -1px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-y-1\\/2{--tw-translate-y: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-\\[-50\\%\\]{--tw-translate-x: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-px{--tw-translate-x: 1px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-y-\\[-50\\%\\]{--tw-translate-y: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-180{--tw-rotate: 180deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-45{--tw-rotate: 45deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-90{--tw-rotate: 90deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-\\[-90deg\\]{--tw-rotate: -90deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-105{--tw-scale-x: 1.05;--tw-scale-y: 1.05;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.animate-bounce{animation:bounce 1s infinite}@keyframes ping{75%,to{transform:scale(2);opacity:0}}.animate-ping{animation:ping 1s cubic-bezier(0,0,.2,1) infinite}.animate-pulse{animation:pulse 2s cubic-bezier(.4,0,.6,1) infinite}.animate-spin{animation:spin 1s linear infinite}.cursor-default{cursor:default}.cursor-not-allowed{cursor:not-allowed}.cursor-pointer{cursor:pointer}.touch-none{touch-action:none}.touch-manipulation{touch-action:manipulation}.select-none{-webkit-user-select:none;-moz-user-select:none;user-select:none}.resize-none{resize:none}.list-disc{list-style-type:disc}.list-none{list-style-type:none}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.grid-cols-7{grid-template-columns:repeat(7,minmax(0,1fr))}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.flex-col-reverse{flex-direction:column-reverse}.flex-wrap{flex-wrap:wrap}.items-start{align-items:flex-start}.items-end{align-items:flex-end}.items-center{align-items:center}.items-stretch{align-items:stretch}.justify-start{justify-content:flex-start}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.justify-around{justify-content:space-around}.gap-1{gap:.25rem}.gap-1\\.5{gap:.375rem}.gap-2{gap:.5rem}.gap-3{gap:.75rem}.gap-4{gap:1rem}.gap-6{gap:1.5rem}.gap-8{gap:2rem}.space-x-1>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(.25rem * var(--tw-space-x-reverse));margin-left:calc(.25rem * calc(1 - var(--tw-space-x-reverse)))}.space-x-1\\.5>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(.375rem * var(--tw-space-x-reverse));margin-left:calc(.375rem * calc(1 - var(--tw-space-x-reverse)))}.space-x-2>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(.5rem * var(--tw-space-x-reverse));margin-left:calc(.5rem * calc(1 - var(--tw-space-x-reverse)))}.space-x-3>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(.75rem * var(--tw-space-x-reverse));margin-left:calc(.75rem * calc(1 - var(--tw-space-x-reverse)))}.space-x-4>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(1rem * var(--tw-space-x-reverse));margin-left:calc(1rem * calc(1 - var(--tw-space-x-reverse)))}.space-x-6>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(1.5rem * var(--tw-space-x-reverse));margin-left:calc(1.5rem * calc(1 - var(--tw-space-x-reverse)))}.space-y-1>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.25rem * var(--tw-space-y-reverse))}.space-y-1\\.5>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.375rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.375rem * var(--tw-space-y-reverse))}.space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem * var(--tw-space-y-reverse))}.space-y-3>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.75rem * var(--tw-space-y-reverse))}.space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.space-y-5>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1.25rem * var(--tw-space-y-reverse))}.space-y-6>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1.5rem * var(--tw-space-y-reverse))}.space-y-8>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(2rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(2rem * var(--tw-space-y-reverse))}.overflow-auto{overflow:auto}.overflow-hidden{overflow:hidden}.overflow-x-auto{overflow-x:auto}.overflow-y-auto{overflow-y:auto}.overflow-x-hidden{overflow-x:hidden}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.whitespace-nowrap{white-space:nowrap}.break-words{overflow-wrap:break-word}.break-all{word-break:break-all}.rounded{border-radius:.25rem}.rounded-2xl{border-radius:1rem}.rounded-3xl{border-radius:1.5rem}.rounded-\\[2\\.5rem\\]{border-radius:2.5rem}.rounded-\\[2px\\]{border-radius:2px}.rounded-\\[inherit\\]{border-radius:inherit}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:var(--radius)}.rounded-md{border-radius:calc(var(--radius) - 2px)}.rounded-sm{border-radius:calc(var(--radius) - 4px)}.rounded-xl{border-radius:.75rem}.rounded-b-2xl{border-bottom-right-radius:1rem;border-bottom-left-radius:1rem}.rounded-t-\\[10px\\]{border-top-left-radius:10px;border-top-right-radius:10px}.rounded-t-lg{border-top-left-radius:var(--radius);border-top-right-radius:var(--radius)}.rounded-bl{border-bottom-left-radius:.25rem}.rounded-br{border-bottom-right-radius:.25rem}.rounded-tl{border-top-left-radius:.25rem}.rounded-tl-sm{border-top-left-radius:calc(var(--radius) - 4px)}.rounded-tr{border-top-right-radius:.25rem}.border{border-width:1px}.border-0{border-width:0px}.border-2{border-width:2px}.border-4{border-width:4px}.border-\\[1\\.5px\\]{border-width:1.5px}.border-y{border-top-width:1px;border-bottom-width:1px}.border-b{border-bottom-width:1px}.border-b-2{border-bottom-width:2px}.border-b-4{border-bottom-width:4px}.border-l{border-left-width:1px}.border-l-2{border-left-width:2px}.border-l-4{border-left-width:4px}.border-r{border-right-width:1px}.border-r-4{border-right-width:4px}.border-t{border-top-width:1px}.border-t-4{border-top-width:4px}.border-dashed{border-style:dashed}.border-\\[--color-border\\]{border-color:var(--color-border)}.border-amber-200{--tw-border-opacity: 1;border-color:rgb(253 230 138 / var(--tw-border-opacity, 1))}.border-amber-300{--tw-border-opacity: 1;border-color:rgb(252 211 77 / var(--tw-border-opacity, 1))}.border-amber-400\\/20{border-color:#fbbf2433}.border-blue-200{--tw-border-opacity: 1;border-color:rgb(191 219 254 / var(--tw-border-opacity, 1))}.border-blue-200\\/30{border-color:#bfdbfe4d}.border-blue-200\\/50{border-color:#bfdbfe80}.border-blue-300{--tw-border-opacity: 1;border-color:rgb(147 197 253 / var(--tw-border-opacity, 1))}.border-blue-400\\/20{border-color:#60a5fa33}.border-blue-400\\/30{border-color:#60a5fa4d}.border-blue-500{--tw-border-opacity: 1;border-color:rgb(59 130 246 / var(--tw-border-opacity, 1))}.border-blue-600\\/30{border-color:#2563eb4d}.border-gray-100{--tw-border-opacity: 1;border-color:rgb(243 244 246 / var(--tw-border-opacity, 1))}.border-gray-200{--tw-border-opacity: 1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1))}.border-gray-200\\/50{border-color:#e5e7eb80}.border-gray-300{--tw-border-opacity: 1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1))}.border-green-200{--tw-border-opacity: 1;border-color:rgb(187 247 208 / var(--tw-border-opacity, 1))}.border-green-200\\/50{border-color:#bbf7d080}.border-green-300{--tw-border-opacity: 1;border-color:rgb(134 239 172 / var(--tw-border-opacity, 1))}.border-green-400{--tw-border-opacity: 1;border-color:rgb(74 222 128 / var(--tw-border-opacity, 1))}.border-green-400\\/30{border-color:#4ade804d}.border-green-600\\/30{border-color:#16a34a4d}.border-indigo-200{--tw-border-opacity: 1;border-color:rgb(199 210 254 / var(--tw-border-opacity, 1))}.border-input{border-color:var(--input)}.border-orange-200{--tw-border-opacity: 1;border-color:rgb(254 215 170 / var(--tw-border-opacity, 1))}.border-orange-200\\/50{border-color:#fed7aa80}.border-orange-500\\/30{border-color:#f973164d}.border-orange-600\\/30{border-color:#ea580c4d}.border-pink-200{--tw-border-opacity: 1;border-color:rgb(251 207 232 / var(--tw-border-opacity, 1))}.border-pink-300{--tw-border-opacity: 1;border-color:rgb(249 168 212 / var(--tw-border-opacity, 1))}.border-primary{border-color:var(--primary)}.border-purple-100{--tw-border-opacity: 1;border-color:rgb(243 232 255 / var(--tw-border-opacity, 1))}.border-purple-200{--tw-border-opacity: 1;border-color:rgb(233 213 255 / var(--tw-border-opacity, 1))}.border-purple-200\\/30{border-color:#e9d5ff4d}.border-purple-200\\/50{border-color:#e9d5ff80}.border-purple-300{--tw-border-opacity: 1;border-color:rgb(216 180 254 / var(--tw-border-opacity, 1))}.border-purple-400\\/20{border-color:#c084fc33}.border-purple-500{--tw-border-opacity: 1;border-color:rgb(168 85 247 / var(--tw-border-opacity, 1))}.border-purple-600\\/30{border-color:#9333ea4d}.border-red-200{--tw-border-opacity: 1;border-color:rgb(254 202 202 / var(--tw-border-opacity, 1))}.border-red-200\\/30{border-color:#fecaca4d}.border-red-300{--tw-border-opacity: 1;border-color:rgb(252 165 165 / var(--tw-border-opacity, 1))}.border-red-400{--tw-border-opacity: 1;border-color:rgb(248 113 113 / var(--tw-border-opacity, 1))}.border-red-500{--tw-border-opacity: 1;border-color:rgb(239 68 68 / var(--tw-border-opacity, 1))}.border-sidebar-border{border-color:var(--sidebar-border)}.border-slate-200{--tw-border-opacity: 1;border-color:rgb(226 232 240 / var(--tw-border-opacity, 1))}.border-slate-300{--tw-border-opacity: 1;border-color:rgb(203 213 225 / var(--tw-border-opacity, 1))}.border-slate-600{--tw-border-opacity: 1;border-color:rgb(71 85 105 / var(--tw-border-opacity, 1))}.border-slate-600\\/30{border-color:#4755694d}.border-slate-600\\/50{border-color:#47556980}.border-slate-700\\/50{border-color:#33415580}.border-transparent{border-color:transparent}.border-white{--tw-border-opacity: 1;border-color:rgb(255 255 255 / var(--tw-border-opacity, 1))}.border-white\\/10{border-color:#ffffff1a}.border-white\\/20{border-color:#fff3}.border-white\\/30{border-color:#ffffff4d}.border-yellow-200{--tw-border-opacity: 1;border-color:rgb(254 240 138 / var(--tw-border-opacity, 1))}.border-yellow-300{--tw-border-opacity: 1;border-color:rgb(253 224 71 / var(--tw-border-opacity, 1))}.border-yellow-300\\/50{border-color:#fde04780}.border-yellow-400\\/20{border-color:#facc1533}.border-yellow-400\\/50{border-color:#facc1580}.border-l-green-500{--tw-border-opacity: 1;border-left-color:rgb(34 197 94 / var(--tw-border-opacity, 1))}.border-l-primary{border-left-color:var(--primary)}.border-l-red-500{--tw-border-opacity: 1;border-left-color:rgb(239 68 68 / var(--tw-border-opacity, 1))}.border-l-transparent{border-left-color:transparent}.border-t-transparent{border-top-color:transparent}.bg-\\[--color-bg\\]{background-color:var(--color-bg)}.bg-accent{background-color:var(--accent)}.bg-amber-100{--tw-bg-opacity: 1;background-color:rgb(254 243 199 / var(--tw-bg-opacity, 1))}.bg-amber-50{--tw-bg-opacity: 1;background-color:rgb(255 251 235 / var(--tw-bg-opacity, 1))}.bg-background{background-color:var(--background)}.bg-black{--tw-bg-opacity: 1;background-color:rgb(0 0 0 / var(--tw-bg-opacity, 1))}.bg-black\\/50{background-color:#00000080}.bg-black\\/60{background-color:#0009}.bg-black\\/70{background-color:#000000b3}.bg-black\\/80{background-color:#000c}.bg-blue-100{--tw-bg-opacity: 1;background-color:rgb(219 234 254 / var(--tw-bg-opacity, 1))}.bg-blue-200\\/20{background-color:#bfdbfe33}.bg-blue-200\\/25{background-color:#bfdbfe40}.bg-blue-50{--tw-bg-opacity: 1;background-color:rgb(239 246 255 / var(--tw-bg-opacity, 1))}.bg-blue-50\\/50{background-color:#eff6ff80}.bg-blue-500{--tw-bg-opacity: 1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.bg-blue-600{--tw-bg-opacity: 1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1))}.bg-blue-900\\/30{background-color:#1e3a8a4d}.bg-border{background-color:var(--border)}.bg-card{background-color:var(--card)}.bg-destructive{background-color:var(--destructive)}.bg-emerald-100{--tw-bg-opacity: 1;background-color:rgb(209 250 229 / var(--tw-bg-opacity, 1))}.bg-foreground{background-color:var(--foreground)}.bg-gray-100{--tw-bg-opacity: 1;background-color:rgb(243 244 246 / var(--tw-bg-opacity, 1))}.bg-gray-200{--tw-bg-opacity: 1;background-color:rgb(229 231 235 / var(--tw-bg-opacity, 1))}.bg-gray-300{--tw-bg-opacity: 1;background-color:rgb(209 213 219 / var(--tw-bg-opacity, 1))}.bg-gray-400{--tw-bg-opacity: 1;background-color:rgb(156 163 175 / var(--tw-bg-opacity, 1))}.bg-gray-50{--tw-bg-opacity: 1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.bg-gray-900{--tw-bg-opacity: 1;background-color:rgb(17 24 39 / var(--tw-bg-opacity, 1))}.bg-green-100{--tw-bg-opacity: 1;background-color:rgb(220 252 231 / var(--tw-bg-opacity, 1))}.bg-green-50{--tw-bg-opacity: 1;background-color:rgb(240 253 244 / var(--tw-bg-opacity, 1))}.bg-green-500{--tw-bg-opacity: 1;background-color:rgb(34 197 94 / var(--tw-bg-opacity, 1))}.bg-green-600{--tw-bg-opacity: 1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.bg-green-900\\/30{background-color:#14532d4d}.bg-indigo-100{--tw-bg-opacity: 1;background-color:rgb(224 231 255 / var(--tw-bg-opacity, 1))}.bg-muted{background-color:var(--muted)}.bg-orange-100{--tw-bg-opacity: 1;background-color:rgb(255 237 213 / var(--tw-bg-opacity, 1))}.bg-orange-200\\/20{background-color:#fed7aa33}.bg-orange-50{--tw-bg-opacity: 1;background-color:rgb(255 247 237 / var(--tw-bg-opacity, 1))}.bg-orange-500{--tw-bg-opacity: 1;background-color:rgb(249 115 22 / var(--tw-bg-opacity, 1))}.bg-orange-600{--tw-bg-opacity: 1;background-color:rgb(234 88 12 / var(--tw-bg-opacity, 1))}.bg-orange-900\\/30{background-color:#7c2d124d}.bg-pink-100{--tw-bg-opacity: 1;background-color:rgb(252 231 243 / var(--tw-bg-opacity, 1))}.bg-pink-200\\/20{background-color:#fbcfe833}.bg-popover{background-color:var(--popover)}.bg-primary{background-color:var(--primary)}.bg-purple-100{--tw-bg-opacity: 1;background-color:rgb(243 232 255 / var(--tw-bg-opacity, 1))}.bg-purple-200\\/30{background-color:#e9d5ff4d}.bg-purple-500{--tw-bg-opacity: 1;background-color:rgb(168 85 247 / var(--tw-bg-opacity, 1))}.bg-purple-900\\/30{background-color:#581c874d}.bg-red-100{--tw-bg-opacity: 1;background-color:rgb(254 226 226 / var(--tw-bg-opacity, 1))}.bg-red-200\\/20{background-color:#fecaca33}.bg-red-50{--tw-bg-opacity: 1;background-color:rgb(254 242 242 / var(--tw-bg-opacity, 1))}.bg-red-500{--tw-bg-opacity: 1;background-color:rgb(239 68 68 / var(--tw-bg-opacity, 1))}.bg-red-600{--tw-bg-opacity: 1;background-color:rgb(220 38 38 / var(--tw-bg-opacity, 1))}.bg-secondary{background-color:var(--secondary)}.bg-sidebar{background-color:var(--sidebar-background)}.bg-sidebar-border{background-color:var(--sidebar-border)}.bg-slate-700{--tw-bg-opacity: 1;background-color:rgb(51 65 85 / var(--tw-bg-opacity, 1))}.bg-slate-800{--tw-bg-opacity: 1;background-color:rgb(30 41 59 / var(--tw-bg-opacity, 1))}.bg-slate-800\\/80{background-color:#1e293bcc}.bg-teal-100{--tw-bg-opacity: 1;background-color:rgb(204 251 241 / var(--tw-bg-opacity, 1))}.bg-transparent{background-color:transparent}.bg-white{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-white\\/10{background-color:#ffffff1a}.bg-white\\/20{background-color:#fff3}.bg-white\\/30{background-color:#ffffff4d}.bg-white\\/50{background-color:#ffffff80}.bg-white\\/60{background-color:#fff9}.bg-white\\/80{background-color:#fffc}.bg-white\\/90{background-color:#ffffffe6}.bg-white\\/95{background-color:#fffffff2}.bg-yellow-100{--tw-bg-opacity: 1;background-color:rgb(254 249 195 / var(--tw-bg-opacity, 1))}.bg-yellow-200\\/20{background-color:#fef08a33}.bg-yellow-200\\/30{background-color:#fef08a4d}.bg-yellow-300\\/30{background-color:#fde0474d}.bg-yellow-50{--tw-bg-opacity: 1;background-color:rgb(254 252 232 / var(--tw-bg-opacity, 1))}.bg-yellow-500{--tw-bg-opacity: 1;background-color:rgb(234 179 8 / var(--tw-bg-opacity, 1))}.bg-opacity-50{--tw-bg-opacity: .5}.bg-opacity-60{--tw-bg-opacity: .6}.bg-opacity-90{--tw-bg-opacity: .9}.bg-gradient-to-br{background-image:linear-gradient(to bottom right,var(--tw-gradient-stops))}.bg-gradient-to-r{background-image:linear-gradient(to right,var(--tw-gradient-stops))}.bg-gradient-to-t{background-image:linear-gradient(to top,var(--tw-gradient-stops))}.from-amber-100{--tw-gradient-from: #fef3c7 var(--tw-gradient-from-position);--tw-gradient-to: rgb(254 243 199 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-amber-50{--tw-gradient-from: #fffbeb var(--tw-gradient-from-position);--tw-gradient-to: rgb(255 251 235 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-amber-600\\/90{--tw-gradient-from: rgb(217 119 6 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(217 119 6 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-black\\/20{--tw-gradient-from: rgb(0 0 0 / .2) var(--tw-gradient-from-position);--tw-gradient-to: rgb(0 0 0 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-blue-100{--tw-gradient-from: #dbeafe var(--tw-gradient-from-position);--tw-gradient-to: rgb(219 234 254 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-blue-50{--tw-gradient-from: #eff6ff var(--tw-gradient-from-position);--tw-gradient-to: rgb(239 246 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-blue-500{--tw-gradient-from: #3b82f6 var(--tw-gradient-from-position);--tw-gradient-to: rgb(59 130 246 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-blue-500\\/10{--tw-gradient-from: rgb(59 130 246 / .1) var(--tw-gradient-from-position);--tw-gradient-to: rgb(59 130 246 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-blue-600{--tw-gradient-from: #2563eb var(--tw-gradient-from-position);--tw-gradient-to: rgb(37 99 235 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-blue-600\\/90{--tw-gradient-from: rgb(37 99 235 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(37 99 235 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-gray-100{--tw-gradient-from: #f3f4f6 var(--tw-gradient-from-position);--tw-gradient-to: rgb(243 244 246 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-gray-50{--tw-gradient-from: #f9fafb var(--tw-gradient-from-position);--tw-gradient-to: rgb(249 250 251 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-gray-500{--tw-gradient-from: #6b7280 var(--tw-gradient-from-position);--tw-gradient-to: rgb(107 114 128 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-green-100{--tw-gradient-from: #dcfce7 var(--tw-gradient-from-position);--tw-gradient-to: rgb(220 252 231 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-green-400{--tw-gradient-from: #4ade80 var(--tw-gradient-from-position);--tw-gradient-to: rgb(74 222 128 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-green-50{--tw-gradient-from: #f0fdf4 var(--tw-gradient-from-position);--tw-gradient-to: rgb(240 253 244 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-green-500{--tw-gradient-from: #22c55e var(--tw-gradient-from-position);--tw-gradient-to: rgb(34 197 94 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-green-500\\/10{--tw-gradient-from: rgb(34 197 94 / .1) var(--tw-gradient-from-position);--tw-gradient-to: rgb(34 197 94 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-green-600{--tw-gradient-from: #16a34a var(--tw-gradient-from-position);--tw-gradient-to: rgb(22 163 74 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-indigo-600{--tw-gradient-from: #4f46e5 var(--tw-gradient-from-position);--tw-gradient-to: rgb(79 70 229 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-orange-100{--tw-gradient-from: #ffedd5 var(--tw-gradient-from-position);--tw-gradient-to: rgb(255 237 213 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-orange-400{--tw-gradient-from: #fb923c var(--tw-gradient-from-position);--tw-gradient-to: rgb(251 146 60 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-orange-50{--tw-gradient-from: #fff7ed var(--tw-gradient-from-position);--tw-gradient-to: rgb(255 247 237 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-orange-500{--tw-gradient-from: #f97316 var(--tw-gradient-from-position);--tw-gradient-to: rgb(249 115 22 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-orange-500\\/5{--tw-gradient-from: rgb(249 115 22 / .05) var(--tw-gradient-from-position);--tw-gradient-to: rgb(249 115 22 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-orange-600{--tw-gradient-from: #ea580c var(--tw-gradient-from-position);--tw-gradient-to: rgb(234 88 12 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-orange-600\\/20{--tw-gradient-from: rgb(234 88 12 / .2) var(--tw-gradient-from-position);--tw-gradient-to: rgb(234 88 12 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-pink-100{--tw-gradient-from: #fce7f3 var(--tw-gradient-from-position);--tw-gradient-to: rgb(252 231 243 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-pink-400{--tw-gradient-from: #f472b6 var(--tw-gradient-from-position);--tw-gradient-to: rgb(244 114 182 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-pink-400\\/50{--tw-gradient-from: rgb(244 114 182 / .5) var(--tw-gradient-from-position);--tw-gradient-to: rgb(244 114 182 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-primary{--tw-gradient-from: var(--primary) var(--tw-gradient-from-position);--tw-gradient-to: rgb(255 255 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-100{--tw-gradient-from: #f3e8ff var(--tw-gradient-from-position);--tw-gradient-to: rgb(243 232 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-400{--tw-gradient-from: #c084fc var(--tw-gradient-from-position);--tw-gradient-to: rgb(192 132 252 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-400\\/50{--tw-gradient-from: rgb(192 132 252 / .5) var(--tw-gradient-from-position);--tw-gradient-to: rgb(192 132 252 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-50{--tw-gradient-from: #faf5ff var(--tw-gradient-from-position);--tw-gradient-to: rgb(250 245 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-500{--tw-gradient-from: #a855f7 var(--tw-gradient-from-position);--tw-gradient-to: rgb(168 85 247 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-500\\/10{--tw-gradient-from: rgb(168 85 247 / .1) var(--tw-gradient-from-position);--tw-gradient-to: rgb(168 85 247 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-600{--tw-gradient-from: #9333ea var(--tw-gradient-from-position);--tw-gradient-to: rgb(147 51 234 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-600\\/90{--tw-gradient-from: rgb(147 51 234 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(147 51 234 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-red-100{--tw-gradient-from: #fee2e2 var(--tw-gradient-from-position);--tw-gradient-to: rgb(254 226 226 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-red-100\\/50{--tw-gradient-from: rgb(254 226 226 / .5) var(--tw-gradient-from-position);--tw-gradient-to: rgb(254 226 226 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-red-50{--tw-gradient-from: #fef2f2 var(--tw-gradient-from-position);--tw-gradient-to: rgb(254 242 242 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-red-500{--tw-gradient-from: #ef4444 var(--tw-gradient-from-position);--tw-gradient-to: rgb(239 68 68 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-slate-50{--tw-gradient-from: #f8fafc var(--tw-gradient-from-position);--tw-gradient-to: rgb(248 250 252 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-slate-700\\/90{--tw-gradient-from: rgb(51 65 85 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(51 65 85 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-slate-800{--tw-gradient-from: #1e293b var(--tw-gradient-from-position);--tw-gradient-to: rgb(30 41 59 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-slate-900{--tw-gradient-from: #0f172a var(--tw-gradient-from-position);--tw-gradient-to: rgb(15 23 42 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-white{--tw-gradient-from: #fff var(--tw-gradient-from-position);--tw-gradient-to: rgb(255 255 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-white\\/10{--tw-gradient-from: rgb(255 255 255 / .1) var(--tw-gradient-from-position);--tw-gradient-to: rgb(255 255 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-yellow-100{--tw-gradient-from: #fef9c3 var(--tw-gradient-from-position);--tw-gradient-to: rgb(254 249 195 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-yellow-400{--tw-gradient-from: #facc15 var(--tw-gradient-from-position);--tw-gradient-to: rgb(250 204 21 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-yellow-50{--tw-gradient-from: #fefce8 var(--tw-gradient-from-position);--tw-gradient-to: rgb(254 252 232 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-yellow-500{--tw-gradient-from: #eab308 var(--tw-gradient-from-position);--tw-gradient-to: rgb(234 179 8 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-yellow-600\\/90{--tw-gradient-from: rgb(202 138 4 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(202 138 4 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.via-emerald-50{--tw-gradient-to: rgb(236 253 245 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #ecfdf5 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-emerald-600{--tw-gradient-to: rgb(5 150 105 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #059669 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-gray-800{--tw-gradient-to: rgb(31 41 55 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #1f2937 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-indigo-50{--tw-gradient-to: rgb(238 242 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #eef2ff var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-indigo-600{--tw-gradient-to: rgb(79 70 229 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #4f46e5 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-orange-50{--tw-gradient-to: rgb(255 247 237 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #fff7ed var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-orange-500{--tw-gradient-to: rgb(249 115 22 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #f97316 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-pink-400\\/50{--tw-gradient-to: rgb(244 114 182 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(244 114 182 / .5) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-pink-600{--tw-gradient-to: rgb(219 39 119 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #db2777 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-purple-400\\/50{--tw-gradient-to: rgb(192 132 252 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(192 132 252 / .5) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-purple-500{--tw-gradient-to: rgb(168 85 247 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #a855f7 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-purple-600{--tw-gradient-to: rgb(147 51 234 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #9333ea var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-slate-50{--tw-gradient-to: rgb(248 250 252 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #f8fafc var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-slate-800{--tw-gradient-to: rgb(30 41 59 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #1e293b var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-transparent{--tw-gradient-to: rgb(0 0 0 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), transparent var(--tw-gradient-via-position), var(--tw-gradient-to)}.to-amber-100{--tw-gradient-to: #fef3c7 var(--tw-gradient-to-position)}.to-amber-50{--tw-gradient-to: #fffbeb var(--tw-gradient-to-position)}.to-amber-600\\/90{--tw-gradient-to: rgb(217 119 6 / .9) var(--tw-gradient-to-position)}.to-blue-100{--tw-gradient-to: #dbeafe var(--tw-gradient-to-position)}.to-blue-200{--tw-gradient-to: #bfdbfe var(--tw-gradient-to-position)}.to-blue-400{--tw-gradient-to: #60a5fa var(--tw-gradient-to-position)}.to-blue-50{--tw-gradient-to: #eff6ff var(--tw-gradient-to-position)}.to-blue-500\\/10{--tw-gradient-to: rgb(59 130 246 / .1) var(--tw-gradient-to-position)}.to-blue-600{--tw-gradient-to: #2563eb var(--tw-gradient-to-position)}.to-cyan-100{--tw-gradient-to: #cffafe var(--tw-gradient-to-position)}.to-cyan-50{--tw-gradient-to: #ecfeff var(--tw-gradient-to-position)}.to-cyan-500{--tw-gradient-to: #06b6d4 var(--tw-gradient-to-position)}.to-cyan-600{--tw-gradient-to: #0891b2 var(--tw-gradient-to-position)}.to-cyan-600\\/90{--tw-gradient-to: rgb(8 145 178 / .9) var(--tw-gradient-to-position)}.to-emerald-100{--tw-gradient-to: #d1fae5 var(--tw-gradient-to-position)}.to-emerald-50{--tw-gradient-to: #ecfdf5 var(--tw-gradient-to-position)}.to-emerald-500{--tw-gradient-to: #10b981 var(--tw-gradient-to-position)}.to-emerald-600{--tw-gradient-to: #059669 var(--tw-gradient-to-position)}.to-gray-100{--tw-gradient-to: #f3f4f6 var(--tw-gradient-to-position)}.to-gray-200{--tw-gradient-to: #e5e7eb var(--tw-gradient-to-position)}.to-gray-50{--tw-gradient-to: #f9fafb var(--tw-gradient-to-position)}.to-gray-600{--tw-gradient-to: #4b5563 var(--tw-gradient-to-position)}.to-green-200{--tw-gradient-to: #bbf7d0 var(--tw-gradient-to-position)}.to-green-50{--tw-gradient-to: #f0fdf4 var(--tw-gradient-to-position)}.to-green-600{--tw-gradient-to: #16a34a var(--tw-gradient-to-position)}.to-indigo-50{--tw-gradient-to: #eef2ff var(--tw-gradient-to-position)}.to-orange-100{--tw-gradient-to: #ffedd5 var(--tw-gradient-to-position)}.to-orange-200{--tw-gradient-to: #fed7aa var(--tw-gradient-to-position)}.to-orange-50{--tw-gradient-to: #fff7ed var(--tw-gradient-to-position)}.to-orange-500{--tw-gradient-to: #f97316 var(--tw-gradient-to-position)}.to-orange-600\\/90{--tw-gradient-to: rgb(234 88 12 / .9) var(--tw-gradient-to-position)}.to-pink-100{--tw-gradient-to: #fce7f3 var(--tw-gradient-to-position)}.to-pink-400{--tw-gradient-to: #f472b6 var(--tw-gradient-to-position)}.to-pink-50{--tw-gradient-to: #fdf2f8 var(--tw-gradient-to-position)}.to-pink-500{--tw-gradient-to: #ec4899 var(--tw-gradient-to-position)}.to-pink-500\\/10{--tw-gradient-to: rgb(236 72 153 / .1) var(--tw-gradient-to-position)}.to-pink-600{--tw-gradient-to: #db2777 var(--tw-gradient-to-position)}.to-pink-600\\/50{--tw-gradient-to: rgb(219 39 119 / .5) var(--tw-gradient-to-position)}.to-pink-600\\/90{--tw-gradient-to: rgb(219 39 119 / .9) var(--tw-gradient-to-position)}.to-purple-100{--tw-gradient-to: #f3e8ff var(--tw-gradient-to-position)}.to-purple-200{--tw-gradient-to: #e9d5ff var(--tw-gradient-to-position)}.to-purple-50{--tw-gradient-to: #faf5ff var(--tw-gradient-to-position)}.to-purple-500\\/10{--tw-gradient-to: rgb(168 85 247 / .1) var(--tw-gradient-to-position)}.to-purple-600{--tw-gradient-to: #9333ea var(--tw-gradient-to-position)}.to-purple-600\\/50{--tw-gradient-to: rgb(147 51 234 / .5) var(--tw-gradient-to-position)}.to-red-200\\/30{--tw-gradient-to: rgb(254 202 202 / .3) var(--tw-gradient-to-position)}.to-red-400{--tw-gradient-to: #f87171 var(--tw-gradient-to-position)}.to-red-50{--tw-gradient-to: #fef2f2 var(--tw-gradient-to-position)}.to-red-500{--tw-gradient-to: #ef4444 var(--tw-gradient-to-position)}.to-red-500\\/5{--tw-gradient-to: rgb(239 68 68 / .05) var(--tw-gradient-to-position)}.to-red-600{--tw-gradient-to: #dc2626 var(--tw-gradient-to-position)}.to-red-600\\/20{--tw-gradient-to: rgb(220 38 38 / .2) var(--tw-gradient-to-position)}.to-rose-100{--tw-gradient-to: #ffe4e6 var(--tw-gradient-to-position)}.to-slate-50{--tw-gradient-to: #f8fafc var(--tw-gradient-to-position)}.to-slate-800\\/90{--tw-gradient-to: rgb(30 41 59 / .9) var(--tw-gradient-to-position)}.to-slate-900{--tw-gradient-to: #0f172a var(--tw-gradient-to-position)}.to-slate-950{--tw-gradient-to: #020617 var(--tw-gradient-to-position)}.to-teal-50{--tw-gradient-to: #f0fdfa var(--tw-gradient-to-position)}.to-teal-600{--tw-gradient-to: #0d9488 var(--tw-gradient-to-position)}.to-transparent{--tw-gradient-to: transparent var(--tw-gradient-to-position)}.to-white\\/5{--tw-gradient-to: rgb(255 255 255 / .05) var(--tw-gradient-to-position)}.to-yellow-400{--tw-gradient-to: #facc15 var(--tw-gradient-to-position)}.bg-clip-text{-webkit-background-clip:text;background-clip:text}.fill-current{fill:currentColor}.stroke-muted{stroke:var(--muted)}.object-contain{-o-object-fit:contain;object-fit:contain}.object-cover{-o-object-fit:cover;object-fit:cover}.p-0{padding:0}.p-0\\.5{padding:.125rem}.p-1{padding:.25rem}.p-1\\.5{padding:.375rem}.p-2{padding:.5rem}.p-3{padding:.75rem}.p-4{padding:1rem}.p-5{padding:1.25rem}.p-6{padding:1.5rem}.p-8{padding:2rem}.p-\\[1px\\]{padding:1px}.px-1{padding-left:.25rem;padding-right:.25rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-2\\.5{padding-left:.625rem;padding-right:.625rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-4{padding-left:1rem;padding-right:1rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.px-8{padding-left:2rem;padding-right:2rem}.py-0\\.5{padding-top:.125rem;padding-bottom:.125rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-1\\.5{padding-top:.375rem;padding-bottom:.375rem}.py-12{padding-top:3rem;padding-bottom:3rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.py-2\\.5{padding-top:.625rem;padding-bottom:.625rem}.py-3{padding-top:.75rem;padding-bottom:.75rem}.py-4{padding-top:1rem;padding-bottom:1rem}.py-6{padding-top:1.5rem;padding-bottom:1.5rem}.py-8{padding-top:2rem;padding-bottom:2rem}.pb-2{padding-bottom:.5rem}.pb-20{padding-bottom:5rem}.pb-24{padding-bottom:6rem}.pb-3{padding-bottom:.75rem}.pb-32{padding-bottom:8rem}.pb-4{padding-bottom:1rem}.pb-6{padding-bottom:1.5rem}.pl-10{padding-left:2.5rem}.pl-11{padding-left:2.75rem}.pl-2\\.5{padding-left:.625rem}.pl-3{padding-left:.75rem}.pl-4{padding-left:1rem}.pl-8{padding-left:2rem}.pr-10{padding-right:2.5rem}.pr-12{padding-right:3rem}.pr-2{padding-right:.5rem}.pr-2\\.5{padding-right:.625rem}.pr-4{padding-right:1rem}.pr-8{padding-right:2rem}.pt-0{padding-top:0}.pt-1{padding-top:.25rem}.pt-2{padding-top:.5rem}.pt-3{padding-top:.75rem}.pt-4{padding-top:1rem}.pt-6{padding-top:1.5rem}.pt-8{padding-top:2rem}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.align-middle{vertical-align:middle}.font-mono{font-family:var(--font-mono)}.text-2xl{font-size:1.5rem;line-height:2rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-5xl{font-size:3rem;line-height:1}.text-6xl{font-size:3.75rem;line-height:1}.text-\\[0\\.8rem\\]{font-size:.8rem}.text-\\[10px\\]{font-size:10px}.text-base{font-size:1rem;line-height:1.5rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:.75rem;line-height:1rem}.font-black{font-weight:900}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-normal{font-weight:400}.font-semibold{font-weight:600}.capitalize{text-transform:capitalize}.italic{font-style:italic}.tabular-nums{--tw-numeric-spacing: tabular-nums;font-variant-numeric:var(--tw-ordinal) var(--tw-slashed-zero) var(--tw-numeric-figure) var(--tw-numeric-spacing) var(--tw-numeric-fraction)}.leading-none{line-height:1}.leading-relaxed{line-height:1.625}.leading-tight{line-height:1.25}.tracking-tight{letter-spacing:-.025em}.tracking-wide{letter-spacing:.025em}.tracking-widest{letter-spacing:.1em}.text-accent-foreground{color:var(--accent-foreground)}.text-amber-600{--tw-text-opacity: 1;color:rgb(217 119 6 / var(--tw-text-opacity, 1))}.text-amber-700{--tw-text-opacity: 1;color:rgb(180 83 9 / var(--tw-text-opacity, 1))}.text-black{--tw-text-opacity: 1;color:rgb(0 0 0 / var(--tw-text-opacity, 1))}.text-blue-100{--tw-text-opacity: 1;color:rgb(219 234 254 / var(--tw-text-opacity, 1))}.text-blue-200{--tw-text-opacity: 1;color:rgb(191 219 254 / var(--tw-text-opacity, 1))}.text-blue-300{--tw-text-opacity: 1;color:rgb(147 197 253 / var(--tw-text-opacity, 1))}.text-blue-400{--tw-text-opacity: 1;color:rgb(96 165 250 / var(--tw-text-opacity, 1))}.text-blue-500{--tw-text-opacity: 1;color:rgb(59 130 246 / var(--tw-text-opacity, 1))}.text-blue-600{--tw-text-opacity: 1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.text-blue-600\\/70{color:#2563ebb3}.text-blue-700{--tw-text-opacity: 1;color:rgb(29 78 216 / var(--tw-text-opacity, 1))}.text-blue-800{--tw-text-opacity: 1;color:rgb(30 64 175 / var(--tw-text-opacity, 1))}.text-blue-900{--tw-text-opacity: 1;color:rgb(30 58 138 / var(--tw-text-opacity, 1))}.text-card-foreground{color:var(--card-foreground)}.text-current{color:currentColor}.text-destructive{color:var(--destructive)}.text-destructive-foreground{color:var(--destructive-foreground)}.text-emerald-600{--tw-text-opacity: 1;color:rgb(5 150 105 / var(--tw-text-opacity, 1))}.text-foreground{color:var(--foreground)}.text-gray-200{--tw-text-opacity: 1;color:rgb(229 231 235 / var(--tw-text-opacity, 1))}.text-gray-300{--tw-text-opacity: 1;color:rgb(209 213 219 / var(--tw-text-opacity, 1))}.text-gray-400{--tw-text-opacity: 1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.text-gray-500{--tw-text-opacity: 1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.text-gray-600{--tw-text-opacity: 1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.text-gray-700{--tw-text-opacity: 1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.text-gray-800{--tw-text-opacity: 1;color:rgb(31 41 55 / var(--tw-text-opacity, 1))}.text-gray-900{--tw-text-opacity: 1;color:rgb(17 24 39 / var(--tw-text-opacity, 1))}.text-green-100{--tw-text-opacity: 1;color:rgb(220 252 231 / var(--tw-text-opacity, 1))}.text-green-300{--tw-text-opacity: 1;color:rgb(134 239 172 / var(--tw-text-opacity, 1))}.text-green-500{--tw-text-opacity: 1;color:rgb(34 197 94 / var(--tw-text-opacity, 1))}.text-green-600{--tw-text-opacity: 1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.text-green-600\\/70{color:#16a34ab3}.text-green-700{--tw-text-opacity: 1;color:rgb(21 128 61 / var(--tw-text-opacity, 1))}.text-green-800{--tw-text-opacity: 1;color:rgb(22 101 52 / var(--tw-text-opacity, 1))}.text-green-900{--tw-text-opacity: 1;color:rgb(20 83 45 / var(--tw-text-opacity, 1))}.text-indigo-100{--tw-text-opacity: 1;color:rgb(224 231 255 / var(--tw-text-opacity, 1))}.text-indigo-500{--tw-text-opacity: 1;color:rgb(99 102 241 / var(--tw-text-opacity, 1))}.text-indigo-600{--tw-text-opacity: 1;color:rgb(79 70 229 / var(--tw-text-opacity, 1))}.text-muted-foreground{color:var(--muted-foreground)}.text-orange-200{--tw-text-opacity: 1;color:rgb(254 215 170 / var(--tw-text-opacity, 1))}.text-orange-300{--tw-text-opacity: 1;color:rgb(253 186 116 / var(--tw-text-opacity, 1))}.text-orange-400{--tw-text-opacity: 1;color:rgb(251 146 60 / var(--tw-text-opacity, 1))}.text-orange-500{--tw-text-opacity: 1;color:rgb(249 115 22 / var(--tw-text-opacity, 1))}.text-orange-600{--tw-text-opacity: 1;color:rgb(234 88 12 / var(--tw-text-opacity, 1))}.text-orange-600\\/70{color:#ea580cb3}.text-orange-700{--tw-text-opacity: 1;color:rgb(194 65 12 / var(--tw-text-opacity, 1))}.text-orange-800{--tw-text-opacity: 1;color:rgb(154 52 18 / var(--tw-text-opacity, 1))}.text-orange-900{--tw-text-opacity: 1;color:rgb(124 45 18 / var(--tw-text-opacity, 1))}.text-pink-600{--tw-text-opacity: 1;color:rgb(219 39 119 / var(--tw-text-opacity, 1))}.text-pink-700{--tw-text-opacity: 1;color:rgb(190 24 93 / var(--tw-text-opacity, 1))}.text-popover-foreground{color:var(--popover-foreground)}.text-primary{color:var(--primary)}.text-primary-foreground{color:var(--primary-foreground)}.text-purple-300{--tw-text-opacity: 1;color:rgb(216 180 254 / var(--tw-text-opacity, 1))}.text-purple-400{--tw-text-opacity: 1;color:rgb(192 132 252 / var(--tw-text-opacity, 1))}.text-purple-500{--tw-text-opacity: 1;color:rgb(168 85 247 / var(--tw-text-opacity, 1))}.text-purple-600{--tw-text-opacity: 1;color:rgb(147 51 234 / var(--tw-text-opacity, 1))}.text-purple-700{--tw-text-opacity: 1;color:rgb(126 34 206 / var(--tw-text-opacity, 1))}.text-purple-800{--tw-text-opacity: 1;color:rgb(107 33 168 / var(--tw-text-opacity, 1))}.text-red-300{--tw-text-opacity: 1;color:rgb(252 165 165 / var(--tw-text-opacity, 1))}.text-red-500{--tw-text-opacity: 1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.text-red-600{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.text-red-600\\/70{color:#dc2626b3}.text-red-700{--tw-text-opacity: 1;color:rgb(185 28 28 / var(--tw-text-opacity, 1))}.text-red-900{--tw-text-opacity: 1;color:rgb(127 29 29 / var(--tw-text-opacity, 1))}.text-secondary-foreground{color:var(--secondary-foreground)}.text-sidebar-foreground{color:var(--sidebar-foreground)}.text-slate-700{--tw-text-opacity: 1;color:rgb(51 65 85 / var(--tw-text-opacity, 1))}.text-slate-800{--tw-text-opacity: 1;color:rgb(30 41 59 / var(--tw-text-opacity, 1))}.text-teal-600{--tw-text-opacity: 1;color:rgb(13 148 136 / var(--tw-text-opacity, 1))}.text-transparent{color:transparent}.text-white{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-white\\/60{color:#fff9}.text-white\\/70{color:#ffffffb3}.text-white\\/80{color:#fffc}.text-white\\/90{color:#ffffffe6}.text-yellow-300{--tw-text-opacity: 1;color:rgb(253 224 71 / var(--tw-text-opacity, 1))}.text-yellow-500{--tw-text-opacity: 1;color:rgb(234 179 8 / var(--tw-text-opacity, 1))}.text-yellow-600{--tw-text-opacity: 1;color:rgb(202 138 4 / var(--tw-text-opacity, 1))}.text-yellow-600\\/70{color:#ca8a04b3}.text-yellow-700{--tw-text-opacity: 1;color:rgb(161 98 7 / var(--tw-text-opacity, 1))}.text-yellow-800{--tw-text-opacity: 1;color:rgb(133 77 14 / var(--tw-text-opacity, 1))}.no-underline{text-decoration-line:none}.underline-offset-4{text-underline-offset:4px}.opacity-0{opacity:0}.opacity-100{opacity:1}.opacity-50{opacity:.5}.opacity-60{opacity:.6}.opacity-70{opacity:.7}.opacity-75{opacity:.75}.opacity-80{opacity:.8}.opacity-90{opacity:.9}.shadow-2xl{--tw-shadow: 0 25px 50px -12px rgb(0 0 0 / .25);--tw-shadow-colored: 0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\\[0_0_0_1px_hsl\\(var\\(--sidebar-border\\)\\)\\]{--tw-shadow: 0 0 0 1px hsl(var(--sidebar-border));--tw-shadow-colored: 0 0 0 1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\\[0_25px_60px_-12px_rgba\\(0\\,0\\,0\\,0\\.8\\)\\]{--tw-shadow: 0 25px 60px -12px rgba(0,0,0,.8);--tw-shadow-colored: 0 25px 60px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-inner{--tw-shadow: inset 0 2px 4px 0 rgb(0 0 0 / .05);--tw-shadow-colored: inset 0 2px 4px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-lg{--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-md{--tw-shadow: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1);--tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-none{--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-sm{--tw-shadow: 0 1px 2px 0 rgb(0 0 0 / .05);--tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-xl{--tw-shadow: 0 20px 25px -5px rgb(0 0 0 / .1), 0 8px 10px -6px rgb(0 0 0 / .1);--tw-shadow-colored: 0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-orange-500\\/25{--tw-shadow-color: rgb(249 115 22 / .25);--tw-shadow: var(--tw-shadow-colored)}.outline-none{outline:2px solid transparent;outline-offset:2px}.outline{outline-style:solid}.ring-0{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.ring-2{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.ring-ring{--tw-ring-color: var(--ring)}.ring-sidebar-ring{--tw-ring-color: var(--sidebar-ring)}.ring-white{--tw-ring-opacity: 1;--tw-ring-color: rgb(255 255 255 / var(--tw-ring-opacity, 1))}.ring-offset-2{--tw-ring-offset-width: 2px}.ring-offset-background{--tw-ring-offset-color: var(--background)}.ring-offset-transparent{--tw-ring-offset-color: transparent}.blur-2xl{--tw-blur: blur(40px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.blur-lg{--tw-blur: blur(16px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.blur-xl{--tw-blur: blur(24px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-2xl{--tw-drop-shadow: drop-shadow(0 25px 25px rgb(0 0 0 / .15));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-lg{--tw-drop-shadow: drop-shadow(0 10px 8px rgb(0 0 0 / .04)) drop-shadow(0 4px 3px rgb(0 0 0 / .1));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.backdrop-blur-md{--tw-backdrop-blur: blur(12px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-sm{--tw-backdrop-blur: blur(4px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-xl{--tw-backdrop-blur: blur(24px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-\\[left\\,right\\,width\\]{transition-property:left,right,width;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-\\[margin\\,opacity\\]{transition-property:margin,opacity;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-\\[width\\,height\\,padding\\]{transition-property:width,height,padding;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-\\[width\\]{transition-property:width;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-colors{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-opacity{transition-property:opacity;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-shadow{transition-property:box-shadow;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-transform{transition-property:transform;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.delay-1000{transition-delay:1s}.duration-100{transition-duration:.1s}.duration-1000{transition-duration:1s}.duration-200{transition-duration:.2s}.duration-300{transition-duration:.3s}.duration-500{transition-duration:.5s}.ease-in{transition-timing-function:cubic-bezier(.4,0,1,1)}.ease-in-out{transition-timing-function:cubic-bezier(.4,0,.2,1)}.ease-linear{transition-timing-function:linear}.ease-out{transition-timing-function:cubic-bezier(0,0,.2,1)}@keyframes enter{0%{opacity:var(--tw-enter-opacity, 1);transform:translate3d(var(--tw-enter-translate-x, 0),var(--tw-enter-translate-y, 0),0) scale3d(var(--tw-enter-scale, 1),var(--tw-enter-scale, 1),var(--tw-enter-scale, 1)) rotate(var(--tw-enter-rotate, 0))}}@keyframes exit{to{opacity:var(--tw-exit-opacity, 1);transform:translate3d(var(--tw-exit-translate-x, 0),var(--tw-exit-translate-y, 0),0) scale3d(var(--tw-exit-scale, 1),var(--tw-exit-scale, 1),var(--tw-exit-scale, 1)) rotate(var(--tw-exit-rotate, 0))}}.animate-in{animation-name:enter;animation-duration:.15s;--tw-enter-opacity: initial;--tw-enter-scale: initial;--tw-enter-rotate: initial;--tw-enter-translate-x: initial;--tw-enter-translate-y: initial}.fade-in,.fade-in-0{--tw-enter-opacity: 0}.fade-in-80{--tw-enter-opacity: .8}.zoom-in-95{--tw-enter-scale: .95}.slide-in-from-bottom-4{--tw-enter-translate-y: 1rem}.duration-100{animation-duration:.1s}.duration-1000{animation-duration:1s}.duration-200{animation-duration:.2s}.duration-300{animation-duration:.3s}.duration-500{animation-duration:.5s}.delay-1000{animation-delay:1s}.ease-in{animation-timing-function:cubic-bezier(.4,0,1,1)}.ease-in-out{animation-timing-function:cubic-bezier(.4,0,.2,1)}.ease-linear{animation-timing-function:linear}.ease-out{animation-timing-function:cubic-bezier(0,0,.2,1)}.running{animation-play-state:running}:root{--background: linear-gradient(135deg, hsl(110 60% 97%) 0%, hsl(180 50% 96%) 100%);--background-solid: hsl(110 60% 97%);--foreground: hsl(222.2 84% 4.9%);--card: hsl(0 0% 100%);--card-foreground: hsl(222.2 84% 4.9%);--popover: hsl(0 0% 100%);--popover-foreground: hsl(222.2 84% 4.9%);--primary: linear-gradient(135deg, hsl(160 84% 39%) 0%, hsl(200 100% 50%) 100%);--primary-solid: hsl(160 84% 39%);--primary-foreground: hsl(0 0% 98%);--secondary: hsl(110 50% 92%);--secondary-foreground: hsl(160 84% 39%);--muted: hsl(110 40% 94%);--muted-foreground: hsl(160 30% 45%);--accent: linear-gradient(135deg, hsl(110 50% 92%) 0%, hsl(140 60% 88%) 100%);--accent-solid: hsl(110 50% 92%);--accent-foreground: hsl(160 84% 39%);--destructive: hsl(0 84% 60%);--destructive-foreground: hsl(0 0% 98%);--border: hsl(110 40% 87%);--input: hsl(110 30% 90%);--ring: hsl(160 84% 39%);--chart-1: hsl(160 84% 39%);--chart-2: hsl(200 100% 50%);--chart-3: hsl(45 100% 60%);--chart-4: hsl(25 100% 65%);--chart-5: hsl(290 80% 58%);--sidebar: hsl(0 0% 100%);--sidebar-foreground: hsl(222.2 84% 4.9%);--sidebar-primary: hsl(160 84% 39%);--sidebar-primary-foreground: hsl(0 0% 98%);--sidebar-accent: hsl(110 50% 92%);--sidebar-accent-foreground: hsl(160 84% 39%);--sidebar-border: hsl(110 40% 87%);--sidebar-ring: hsl(160 84% 39%);--font-sans: \"Roboto\", sans-serif;--font-serif: Georgia, serif;--font-mono: \"Courier New\", monospace;--radius: .75rem;--shadow-soft: 0 4px 16px rgba(20, 184, 166, .12);--shadow-medium: 0 8px 32px rgba(20, 184, 166, .16);--shadow-strong: 0 16px 48px rgba(20, 184, 166, .2);--bg-gradient: linear-gradient(135deg, #8B5CF6 0%, #A855F7 100%)}.dark{--background: linear-gradient(135deg, hsl(222.2 84% 4.9%) 0%, hsl(180 30% 8%) 100%);--background-solid: hsl(222.2 84% 4.9%);--foreground: hsl(210 40% 98%);--card: linear-gradient(135deg, hsl(222.2 84% 4.9%) 0%, hsl(180 20% 8%) 100%);--card-foreground: hsl(210 40% 98%);--popover: hsl(222.2 84% 4.9%);--popover-foreground: hsl(210 40% 98%);--primary: linear-gradient(135deg, hsl(160 70% 45%) 0%, hsl(200 80% 55%) 100%);--primary-solid: hsl(160 70% 45%);--primary-foreground: hsl(0 0% 98%);--secondary: hsl(180 20% 20%);--secondary-foreground: hsl(160 60% 80%);--muted: hsl(180 15% 20%);--muted-foreground: hsl(180 10% 65%);--accent: linear-gradient(135deg, hsl(180 20% 20%) 0%, hsl(160 25% 18%) 100%);--accent-solid: hsl(180 20% 20%);--accent-foreground: hsl(160 60% 80%);--destructive: hsl(0 62.8% 30.6%);--destructive-foreground: hsl(210 40% 98%);--border: hsl(180 15% 20%);--input: hsl(180 15% 20%);--ring: hsl(160 70% 45%);--chart-1: hsl(160 70% 45%);--chart-2: hsl(200 80% 55%);--chart-3: hsl(45 90% 60%);--chart-4: hsl(25 90% 65%);--chart-5: hsl(290 70% 58%);--sidebar: hsl(222.2 84% 4.9%);--sidebar-foreground: hsl(210 40% 98%);--sidebar-primary: hsl(160 70% 45%);--sidebar-primary-foreground: hsl(0 0% 98%);--sidebar-accent: hsl(180 20% 20%);--sidebar-accent-foreground: hsl(160 60% 80%);--sidebar-border: hsl(180 15% 20%);--sidebar-ring: hsl(160 70% 45%);--shadow-soft: 0 4px 16px rgba(0, 0, 0, .25);--shadow-medium: 0 8px 32px rgba(0, 0, 0, .35);--shadow-strong: 0 16px 48px rgba(0, 0, 0, .45);--bg-gradient: linear-gradient(135deg, #2D1B69 0%, #5B21B6 100%)}.camera-viewfinder{background:linear-gradient(45deg,transparent 15px,rgba(20,184,166,.3) 15px,rgba(20,184,166,.3) 16px,transparent 16px),linear-gradient(-45deg,transparent 15px,rgba(20,184,166,.3) 15px,rgba(20,184,166,.3) 16px,transparent 16px);background-size:20px 20px;background-position:0 0,10px 10px}.pulse-green{animation:pulse-green 2s cubic-bezier(.4,0,.6,1) infinite}@keyframes pulse-green{0%,to{opacity:1}50%{opacity:.5}}@keyframes fadeInUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}@keyframes fadeInDown{0%{opacity:0;transform:translateY(-30px)}to{opacity:1;transform:translateY(0)}}@keyframes fadeInLeft{0%{opacity:0;transform:translate(-30px)}to{opacity:1;transform:translate(0)}}@keyframes fadeInRight{0%{opacity:0;transform:translate(30px)}to{opacity:1;transform:translate(0)}}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}@keyframes float{0%,to{transform:translateY(0)}50%{transform:translateY(-10px)}}@keyframes spinSlow{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes pulseGlow{0%,to{box-shadow:0 0 20px #14b8a680}50%{box-shadow:0 0 40px #14b8a6cc}}.animate-fade-in-up{animation:fadeInUp .8s ease-out forwards}.animate-fade-in-down{animation:fadeInDown .8s ease-out forwards}.animate-fade-in-left{animation:fadeInLeft .8s ease-out forwards}.animate-fade-in-right{animation:fadeInRight .8s ease-out forwards}.animate-fade-in{animation:fadeIn .8s ease-out forwards}.animate-float{animation:float 3s ease-in-out infinite}.animate-spin-slow{animation:spinSlow 8s linear infinite}.animate-pulse-glow{animation:pulseGlow 2s ease-in-out infinite}.animation-delay-300{animation-delay:.3s}.animation-delay-500{animation-delay:.5s}.animation-delay-600{animation-delay:.6s}.animation-delay-900{animation-delay:.9s}.animation-delay-1000{animation-delay:1s}.animation-delay-1200{animation-delay:1.2s}.animation-delay-1500{animation-delay:1.5s}.animation-delay-1800{animation-delay:1.8s}.animation-delay-2100{animation-delay:2.1s}.animation-delay-2400{animation-delay:2.4s}.animation-delay-2700{animation-delay:2.7s}.animation-delay-3000{animation-delay:3s}.animation-delay-3300{animation-delay:3.3s}.animation-delay-3600{animation-delay:3.6s}.animation-delay-4500{animation-delay:4.5s}.animation-delay-4800{animation-delay:4.8s}.animation-delay-5100{animation-delay:5.1s}.animation-delay-5700{animation-delay:5.7s}.animation-delay-6000{animation-delay:6s}.animation-delay-6300{animation-delay:6.3s}@keyframes shimmer{0%{background-position:-200% 0}to{background-position:200% 0}}@keyframes slideIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes scaleIn{0%{opacity:0;transform:scale(.9)}to{opacity:1;transform:scale(1)}}.animate-shimmer{background:linear-gradient(90deg,#fff0,#fff3,#fff0);background-size:200% 100%;animation:shimmer 2s ease-in-out infinite}.animate-slide-in{animation:slideIn .4s ease-out forwards}.animate-scale-in{animation:scaleIn .3s ease-out forwards}::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{background:var(--muted);border-radius:3px}::-webkit-scrollbar-thumb{background:var(--primary-solid);border-radius:3px}::-webkit-scrollbar-thumb:hover{background:var(--ring)}.enhanced-focus:focus-visible{outline:2px solid var(--ring);outline-offset:2px;border-radius:var(--radius)}.skeleton{background:linear-gradient(90deg,var(--muted) 25%,var(--muted)/50 50%,var(--muted) 75%);background-size:200% 100%;animation:shimmer 2s ease-in-out infinite}.button-glow:hover{box-shadow:0 0 20px var(--primary-solid) / 30}.text-responsive{font-size:clamp(.875rem,2.5vw,1rem)}.glass-enhanced{background:#ffffff1a;-webkit-backdrop-filter:blur(20px) saturate(1.8);backdrop-filter:blur(20px) saturate(1.8);border:1px solid rgba(255,255,255,.2)}.dark .glass-enhanced{background:#141428cc;border:1px solid rgba(255,255,255,.1)}.nutrition-gradient{background:linear-gradient(135deg,#10b77f,#3c3,#f5f53d,#f2a65a,#0af)}.health-card{background:linear-gradient(135deg,#ffffffe6,#f0fdf4f2);border:1px solid rgba(20,184,166,.2);box-shadow:0 4px 16px #14b8a61a,0 0 0 1px #14b8a60d}.dark .health-card{background:linear-gradient(135deg,#141e28e6,#0f2823f2);border:1px solid rgba(20,184,166,.3)}.vibrant-button{background:linear-gradient(135deg,#10b77f,#17cfcf,#0da6f2);border:none;color:#fff;transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden}.vibrant-button:before{content:\"\";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);transition:left .5s}.vibrant-button:hover:before{left:100%}.vibrant-button:hover{transform:translateY(-2px) scale(1.02);box-shadow:0 8px 25px #14b8a640,0 4px 15px #0096ff26}.success-accent{background:linear-gradient(135deg,#3c3,#28bd5a)}.warning-accent{background:linear-gradient(135deg,#fc3,#f6b355)}.info-accent{background:linear-gradient(135deg,#0af,#2b6cee)}@keyframes colorShift{0%{filter:hue-rotate(0deg)}25%{filter:hue-rotate(90deg)}50%{filter:hue-rotate(180deg)}75%{filter:hue-rotate(270deg)}to{filter:hue-rotate(360deg)}}@keyframes breathe{0%,to{transform:scale(1)}50%{transform:scale(1.05)}}.animate-color-shift{animation:colorShift 8s linear infinite}.animate-breathe{animation:breathe 3s ease-in-out infinite}@keyframes bulbFlicker{0%,20%{opacity:1;filter:brightness(1.2) saturate(1.1)}25%,30%{opacity:.3;filter:brightness(.7) saturate(.8)}35%,85%{opacity:1;filter:brightness(1.2) saturate(1.1)}90%,95%{opacity:.4;filter:brightness(.8) saturate(.9)}to{opacity:1;filter:brightness(1.2) saturate(1.1)}}.calorie-gradient{background:linear-gradient(45deg,#e05252,#eda65e,#f5f53d)}.protein-gradient{background:linear-gradient(45deg,#e05281,#e963bc)}.carbs-gradient{background:linear-gradient(45deg,#f0f042,#abe830)}.fat-gradient{background:linear-gradient(45deg,#b152e0,#8f63e9)}.file\\:border-0::file-selector-button{border-width:0px}.file\\:bg-transparent::file-selector-button{background-color:transparent}.file\\:text-sm::file-selector-button{font-size:.875rem;line-height:1.25rem}.file\\:font-medium::file-selector-button{font-weight:500}.file\\:text-foreground::file-selector-button{color:var(--foreground)}.placeholder\\:text-muted-foreground::-moz-placeholder{color:var(--muted-foreground)}.placeholder\\:text-muted-foreground::placeholder{color:var(--muted-foreground)}.after\\:absolute:after{content:var(--tw-content);position:absolute}.after\\:-inset-2:after{content:var(--tw-content);top:-.5rem;right:-.5rem;bottom:-.5rem;left:-.5rem}.after\\:inset-y-0:after{content:var(--tw-content);top:0;bottom:0}.after\\:left-1\\/2:after{content:var(--tw-content);left:50%}.after\\:w-1:after{content:var(--tw-content);width:.25rem}.after\\:w-\\[2px\\]:after{content:var(--tw-content);width:2px}.after\\:-translate-x-1\\/2:after{content:var(--tw-content);--tw-translate-x: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.first\\:rounded-l-md:first-child{border-top-left-radius:calc(var(--radius) - 2px);border-bottom-left-radius:calc(var(--radius) - 2px)}.first\\:border-l:first-child{border-left-width:1px}.last\\:rounded-r-md:last-child{border-top-right-radius:calc(var(--radius) - 2px);border-bottom-right-radius:calc(var(--radius) - 2px)}.focus-within\\:relative:focus-within{position:relative}.focus-within\\:z-20:focus-within{z-index:20}.hover\\:-rotate-1:hover{--tw-rotate: -1deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\\:rotate-1:hover{--tw-rotate: 1deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\\:scale-105:hover{--tw-scale-x: 1.05;--tw-scale-y: 1.05;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\\:scale-110:hover{--tw-scale-x: 1.1;--tw-scale-y: 1.1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\\:scale-\\[1\\.02\\]:hover{--tw-scale-x: 1.02;--tw-scale-y: 1.02;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes spin{to{transform:rotate(360deg)}}.hover\\:animate-spin:hover{animation:spin 1s linear infinite}.hover\\:border-blue-300:hover{--tw-border-opacity: 1;border-color:rgb(147 197 253 / var(--tw-border-opacity, 1))}.hover\\:border-blue-400:hover{--tw-border-opacity: 1;border-color:rgb(96 165 250 / var(--tw-border-opacity, 1))}.hover\\:border-emerald-300:hover{--tw-border-opacity: 1;border-color:rgb(110 231 183 / var(--tw-border-opacity, 1))}.hover\\:border-gray-300:hover{--tw-border-opacity: 1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1))}.hover\\:border-green-300:hover{--tw-border-opacity: 1;border-color:rgb(134 239 172 / var(--tw-border-opacity, 1))}.hover\\:border-indigo-300:hover{--tw-border-opacity: 1;border-color:rgb(165 180 252 / var(--tw-border-opacity, 1))}.hover\\:border-orange-300:hover{--tw-border-opacity: 1;border-color:rgb(253 186 116 / var(--tw-border-opacity, 1))}.hover\\:border-pink-300:hover{--tw-border-opacity: 1;border-color:rgb(249 168 212 / var(--tw-border-opacity, 1))}.hover\\:border-purple-300:hover{--tw-border-opacity: 1;border-color:rgb(216 180 254 / var(--tw-border-opacity, 1))}.hover\\:border-teal-300:hover{--tw-border-opacity: 1;border-color:rgb(94 234 212 / var(--tw-border-opacity, 1))}.hover\\:bg-accent:hover{background-color:var(--accent)}.hover\\:bg-background:hover{background-color:var(--background)}.hover\\:bg-blue-100:hover{--tw-bg-opacity: 1;background-color:rgb(219 234 254 / var(--tw-bg-opacity, 1))}.hover\\:bg-blue-200:hover{--tw-bg-opacity: 1;background-color:rgb(191 219 254 / var(--tw-bg-opacity, 1))}.hover\\:bg-blue-50:hover{--tw-bg-opacity: 1;background-color:rgb(239 246 255 / var(--tw-bg-opacity, 1))}.hover\\:bg-blue-500:hover{--tw-bg-opacity: 1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.hover\\:bg-blue-600:hover{--tw-bg-opacity: 1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1))}.hover\\:bg-blue-700:hover{--tw-bg-opacity: 1;background-color:rgb(29 78 216 / var(--tw-bg-opacity, 1))}.hover\\:bg-gray-100:hover{--tw-bg-opacity: 1;background-color:rgb(243 244 246 / var(--tw-bg-opacity, 1))}.hover\\:bg-gray-200:hover{--tw-bg-opacity: 1;background-color:rgb(229 231 235 / var(--tw-bg-opacity, 1))}.hover\\:bg-gray-50:hover{--tw-bg-opacity: 1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.hover\\:bg-green-100:hover{--tw-bg-opacity: 1;background-color:rgb(220 252 231 / var(--tw-bg-opacity, 1))}.hover\\:bg-green-50:hover{--tw-bg-opacity: 1;background-color:rgb(240 253 244 / var(--tw-bg-opacity, 1))}.hover\\:bg-green-500:hover{--tw-bg-opacity: 1;background-color:rgb(34 197 94 / var(--tw-bg-opacity, 1))}.hover\\:bg-green-700:hover{--tw-bg-opacity: 1;background-color:rgb(21 128 61 / var(--tw-bg-opacity, 1))}.hover\\:bg-muted:hover{background-color:var(--muted)}.hover\\:bg-orange-200:hover{--tw-bg-opacity: 1;background-color:rgb(254 215 170 / var(--tw-bg-opacity, 1))}.hover\\:bg-orange-600:hover{--tw-bg-opacity: 1;background-color:rgb(234 88 12 / var(--tw-bg-opacity, 1))}.hover\\:bg-orange-700:hover{--tw-bg-opacity: 1;background-color:rgb(194 65 12 / var(--tw-bg-opacity, 1))}.hover\\:bg-primary:hover{background-color:var(--primary)}.hover\\:bg-purple-200:hover{--tw-bg-opacity: 1;background-color:rgb(233 213 255 / var(--tw-bg-opacity, 1))}.hover\\:bg-purple-50:hover{--tw-bg-opacity: 1;background-color:rgb(250 245 255 / var(--tw-bg-opacity, 1))}.hover\\:bg-red-100:hover{--tw-bg-opacity: 1;background-color:rgb(254 226 226 / var(--tw-bg-opacity, 1))}.hover\\:bg-red-50:hover{--tw-bg-opacity: 1;background-color:rgb(254 242 242 / var(--tw-bg-opacity, 1))}.hover\\:bg-red-700:hover{--tw-bg-opacity: 1;background-color:rgb(185 28 28 / var(--tw-bg-opacity, 1))}.hover\\:bg-secondary:hover{background-color:var(--secondary)}.hover\\:bg-sidebar-accent:hover{background-color:var(--sidebar-accent)}.hover\\:bg-slate-600:hover{--tw-bg-opacity: 1;background-color:rgb(71 85 105 / var(--tw-bg-opacity, 1))}.hover\\:bg-slate-700:hover{--tw-bg-opacity: 1;background-color:rgb(51 65 85 / var(--tw-bg-opacity, 1))}.hover\\:bg-slate-700\\/80:hover{background-color:#334155cc}.hover\\:bg-slate-700\\/90:hover{background-color:#334155e6}.hover\\:bg-white:hover{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.hover\\:bg-white\\/10:hover{background-color:#ffffff1a}.hover\\:bg-white\\/20:hover{background-color:#fff3}.hover\\:bg-yellow-600:hover{--tw-bg-opacity: 1;background-color:rgb(202 138 4 / var(--tw-bg-opacity, 1))}.hover\\:from-amber-200:hover{--tw-gradient-from: #fde68a var(--tw-gradient-from-position);--tw-gradient-to: rgb(253 230 138 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-amber-500\\/90:hover{--tw-gradient-from: rgb(245 158 11 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(245 158 11 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-blue-200:hover{--tw-gradient-from: #bfdbfe var(--tw-gradient-from-position);--tw-gradient-to: rgb(191 219 254 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-blue-500\\/20:hover{--tw-gradient-from: rgb(59 130 246 / .2) var(--tw-gradient-from-position);--tw-gradient-to: rgb(59 130 246 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-blue-500\\/90:hover{--tw-gradient-from: rgb(59 130 246 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(59 130 246 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-blue-600:hover{--tw-gradient-from: #2563eb var(--tw-gradient-from-position);--tw-gradient-to: rgb(37 99 235 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-blue-700:hover{--tw-gradient-from: #1d4ed8 var(--tw-gradient-from-position);--tw-gradient-to: rgb(29 78 216 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-gray-200:hover{--tw-gradient-from: #e5e7eb var(--tw-gradient-from-position);--tw-gradient-to: rgb(229 231 235 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-gray-600:hover{--tw-gradient-from: #4b5563 var(--tw-gradient-from-position);--tw-gradient-to: rgb(75 85 99 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-green-200:hover{--tw-gradient-from: #bbf7d0 var(--tw-gradient-from-position);--tw-gradient-to: rgb(187 247 208 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-green-500\\/20:hover{--tw-gradient-from: rgb(34 197 94 / .2) var(--tw-gradient-from-position);--tw-gradient-to: rgb(34 197 94 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-green-600:hover{--tw-gradient-from: #16a34a var(--tw-gradient-from-position);--tw-gradient-to: rgb(22 163 74 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-green-700:hover{--tw-gradient-from: #15803d var(--tw-gradient-from-position);--tw-gradient-to: rgb(21 128 61 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-orange-600:hover{--tw-gradient-from: #ea580c var(--tw-gradient-from-position);--tw-gradient-to: rgb(234 88 12 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-pink-200:hover{--tw-gradient-from: #fbcfe8 var(--tw-gradient-from-position);--tw-gradient-to: rgb(251 207 232 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-purple-200:hover{--tw-gradient-from: #e9d5ff var(--tw-gradient-from-position);--tw-gradient-to: rgb(233 213 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-purple-500\\/20:hover{--tw-gradient-from: rgb(168 85 247 / .2) var(--tw-gradient-from-position);--tw-gradient-to: rgb(168 85 247 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-purple-500\\/90:hover{--tw-gradient-from: rgb(168 85 247 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(168 85 247 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-purple-600:hover{--tw-gradient-from: #9333ea var(--tw-gradient-from-position);--tw-gradient-to: rgb(147 51 234 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-purple-700:hover{--tw-gradient-from: #7e22ce var(--tw-gradient-from-position);--tw-gradient-to: rgb(126 34 206 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-red-200:hover{--tw-gradient-from: #fecaca var(--tw-gradient-from-position);--tw-gradient-to: rgb(254 202 202 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-red-200\\/70:hover{--tw-gradient-from: rgb(254 202 202 / .7) var(--tw-gradient-from-position);--tw-gradient-to: rgb(254 202 202 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-red-600:hover{--tw-gradient-from: #dc2626 var(--tw-gradient-from-position);--tw-gradient-to: rgb(220 38 38 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-slate-600\\/90:hover{--tw-gradient-from: rgb(71 85 105 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(71 85 105 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-yellow-200:hover{--tw-gradient-from: #fef08a var(--tw-gradient-from-position);--tw-gradient-to: rgb(254 240 138 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-yellow-500\\/90:hover{--tw-gradient-from: rgb(234 179 8 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(234 179 8 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-yellow-600:hover{--tw-gradient-from: #ca8a04 var(--tw-gradient-from-position);--tw-gradient-to: rgb(202 138 4 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:via-indigo-700:hover{--tw-gradient-to: rgb(67 56 202 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #4338ca var(--tw-gradient-via-position), var(--tw-gradient-to)}.hover\\:to-amber-200:hover{--tw-gradient-to: #fde68a var(--tw-gradient-to-position)}.hover\\:to-amber-500\\/90:hover{--tw-gradient-to: rgb(245 158 11 / .9) var(--tw-gradient-to-position)}.hover\\:to-blue-500\\/20:hover{--tw-gradient-to: rgb(59 130 246 / .2) var(--tw-gradient-to-position)}.hover\\:to-blue-700:hover{--tw-gradient-to: #1d4ed8 var(--tw-gradient-to-position)}.hover\\:to-cyan-200:hover{--tw-gradient-to: #a5f3fc var(--tw-gradient-to-position)}.hover\\:to-cyan-500\\/90:hover{--tw-gradient-to: rgb(6 182 212 / .9) var(--tw-gradient-to-position)}.hover\\:to-emerald-200:hover{--tw-gradient-to: #a7f3d0 var(--tw-gradient-to-position)}.hover\\:to-emerald-600:hover{--tw-gradient-to: #059669 var(--tw-gradient-to-position)}.hover\\:to-emerald-700:hover{--tw-gradient-to: #047857 var(--tw-gradient-to-position)}.hover\\:to-gray-300:hover{--tw-gradient-to: #d1d5db var(--tw-gradient-to-position)}.hover\\:to-gray-700:hover{--tw-gradient-to: #374151 var(--tw-gradient-to-position)}.hover\\:to-green-700:hover{--tw-gradient-to: #15803d var(--tw-gradient-to-position)}.hover\\:to-orange-200:hover{--tw-gradient-to: #fed7aa var(--tw-gradient-to-position)}.hover\\:to-orange-500\\/90:hover{--tw-gradient-to: rgb(249 115 22 / .9) var(--tw-gradient-to-position)}.hover\\:to-orange-600:hover{--tw-gradient-to: #ea580c var(--tw-gradient-to-position)}.hover\\:to-pink-200:hover{--tw-gradient-to: #fbcfe8 var(--tw-gradient-to-position)}.hover\\:to-pink-500\\/20:hover{--tw-gradient-to: rgb(236 72 153 / .2) var(--tw-gradient-to-position)}.hover\\:to-pink-500\\/90:hover{--tw-gradient-to: rgb(236 72 153 / .9) var(--tw-gradient-to-position)}.hover\\:to-pink-700:hover{--tw-gradient-to: #be185d var(--tw-gradient-to-position)}.hover\\:to-purple-500\\/20:hover{--tw-gradient-to: rgb(168 85 247 / .2) var(--tw-gradient-to-position)}.hover\\:to-purple-700:hover{--tw-gradient-to: #7e22ce var(--tw-gradient-to-position)}.hover\\:to-red-300\\/50:hover{--tw-gradient-to: rgb(252 165 165 / .5) var(--tw-gradient-to-position)}.hover\\:to-red-600:hover{--tw-gradient-to: #dc2626 var(--tw-gradient-to-position)}.hover\\:to-red-700:hover{--tw-gradient-to: #b91c1c var(--tw-gradient-to-position)}.hover\\:to-rose-200:hover{--tw-gradient-to: #fecdd3 var(--tw-gradient-to-position)}.hover\\:to-slate-700\\/90:hover{--tw-gradient-to: rgb(51 65 85 / .9) var(--tw-gradient-to-position)}.hover\\:text-accent-foreground:hover{color:var(--accent-foreground)}.hover\\:text-blue-600:hover{--tw-text-opacity: 1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.hover\\:text-blue-800:hover{--tw-text-opacity: 1;color:rgb(30 64 175 / var(--tw-text-opacity, 1))}.hover\\:text-destructive:hover{color:var(--destructive)}.hover\\:text-foreground:hover{color:var(--foreground)}.hover\\:text-gray-900:hover{--tw-text-opacity: 1;color:rgb(17 24 39 / var(--tw-text-opacity, 1))}.hover\\:text-muted-foreground:hover{color:var(--muted-foreground)}.hover\\:text-primary-foreground:hover{color:var(--primary-foreground)}.hover\\:text-purple-600:hover{--tw-text-opacity: 1;color:rgb(147 51 234 / var(--tw-text-opacity, 1))}.hover\\:text-red-600:hover{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.hover\\:text-sidebar-accent-foreground:hover{color:var(--sidebar-accent-foreground)}.hover\\:underline:hover{text-decoration-line:underline}.hover\\:opacity-100:hover{opacity:1}.hover\\:opacity-90:hover{opacity:.9}.hover\\:shadow-2xl:hover{--tw-shadow: 0 25px 50px -12px rgb(0 0 0 / .25);--tw-shadow-colored: 0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\\:shadow-\\[0_0_0_1px_hsl\\(var\\(--sidebar-accent\\)\\)\\]:hover{--tw-shadow: 0 0 0 1px hsl(var(--sidebar-accent));--tw-shadow-colored: 0 0 0 1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\\:shadow-lg:hover{--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\\:shadow-md:hover{--tw-shadow: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1);--tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\\:shadow-sm:hover{--tw-shadow: 0 1px 2px 0 rgb(0 0 0 / .05);--tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\\:shadow-xl:hover{--tw-shadow: 0 20px 25px -5px rgb(0 0 0 / .1), 0 8px 10px -6px rgb(0 0 0 / .1);--tw-shadow-colored: 0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\\:shadow-amber-500\\/25:hover{--tw-shadow-color: rgb(245 158 11 / .25);--tw-shadow: var(--tw-shadow-colored)}.hover\\:shadow-blue-500\\/25:hover{--tw-shadow-color: rgb(59 130 246 / .25);--tw-shadow: var(--tw-shadow-colored)}.hover\\:shadow-green-500\\/25:hover{--tw-shadow-color: rgb(34 197 94 / .25);--tw-shadow: var(--tw-shadow-colored)}.hover\\:shadow-indigo-500\\/25:hover{--tw-shadow-color: rgb(99 102 241 / .25);--tw-shadow: var(--tw-shadow-colored)}.hover\\:shadow-orange-500\\/25:hover{--tw-shadow-color: rgb(249 115 22 / .25);--tw-shadow: var(--tw-shadow-colored)}.hover\\:shadow-orange-500\\/40:hover{--tw-shadow-color: rgb(249 115 22 / .4);--tw-shadow: var(--tw-shadow-colored)}.hover\\:shadow-pink-500\\/25:hover{--tw-shadow-color: rgb(236 72 153 / .25);--tw-shadow: var(--tw-shadow-colored)}.hover\\:shadow-purple-500\\/25:hover{--tw-shadow-color: rgb(168 85 247 / .25);--tw-shadow: var(--tw-shadow-colored)}.hover\\:shadow-red-500\\/25:hover{--tw-shadow-color: rgb(239 68 68 / .25);--tw-shadow: var(--tw-shadow-colored)}.hover\\:shadow-slate-500\\/25:hover{--tw-shadow-color: rgb(100 116 139 / .25);--tw-shadow: var(--tw-shadow-colored)}.hover\\:shadow-yellow-500\\/25:hover{--tw-shadow-color: rgb(234 179 8 / .25);--tw-shadow: var(--tw-shadow-colored)}.hover\\:after\\:bg-sidebar-border:hover:after{content:var(--tw-content);background-color:var(--sidebar-border)}.focus\\:border-blue-500:focus{--tw-border-opacity: 1;border-color:rgb(59 130 246 / var(--tw-border-opacity, 1))}.focus\\:border-emerald-500:focus{--tw-border-opacity: 1;border-color:rgb(16 185 129 / var(--tw-border-opacity, 1))}.focus\\:border-green-500:focus{--tw-border-opacity: 1;border-color:rgb(34 197 94 / var(--tw-border-opacity, 1))}.focus\\:border-indigo-500:focus{--tw-border-opacity: 1;border-color:rgb(99 102 241 / var(--tw-border-opacity, 1))}.focus\\:border-orange-500:focus{--tw-border-opacity: 1;border-color:rgb(249 115 22 / var(--tw-border-opacity, 1))}.focus\\:border-pink-500:focus{--tw-border-opacity: 1;border-color:rgb(236 72 153 / var(--tw-border-opacity, 1))}.focus\\:border-primary:focus{border-color:var(--primary)}.focus\\:border-purple-500:focus{--tw-border-opacity: 1;border-color:rgb(168 85 247 / var(--tw-border-opacity, 1))}.focus\\:border-teal-500:focus{--tw-border-opacity: 1;border-color:rgb(20 184 166 / var(--tw-border-opacity, 1))}.focus\\:border-transparent:focus{border-color:transparent}.focus\\:bg-accent:focus{background-color:var(--accent)}.focus\\:bg-primary:focus{background-color:var(--primary)}.focus\\:bg-slate-700:focus{--tw-bg-opacity: 1;background-color:rgb(51 65 85 / var(--tw-bg-opacity, 1))}.focus\\:text-accent-foreground:focus{color:var(--accent-foreground)}.focus\\:text-primary-foreground:focus{color:var(--primary-foreground)}.focus\\:opacity-100:focus{opacity:1}.focus\\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.focus\\:ring-2:focus{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.focus\\:ring-blue-500:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(59 130 246 / var(--tw-ring-opacity, 1))}.focus\\:ring-primary:focus{--tw-ring-color: var(--primary)}.focus\\:ring-purple-500:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(168 85 247 / var(--tw-ring-opacity, 1))}.focus\\:ring-ring:focus{--tw-ring-color: var(--ring)}.focus\\:ring-offset-2:focus{--tw-ring-offset-width: 2px}.focus-visible\\:outline-none:focus-visible{outline:2px solid transparent;outline-offset:2px}.focus-visible\\:ring-1:focus-visible{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.focus-visible\\:ring-2:focus-visible{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.focus-visible\\:ring-ring:focus-visible{--tw-ring-color: var(--ring)}.focus-visible\\:ring-sidebar-ring:focus-visible{--tw-ring-color: var(--sidebar-ring)}.focus-visible\\:ring-offset-1:focus-visible{--tw-ring-offset-width: 1px}.focus-visible\\:ring-offset-2:focus-visible{--tw-ring-offset-width: 2px}.focus-visible\\:ring-offset-background:focus-visible{--tw-ring-offset-color: var(--background)}.active\\:scale-95:active{--tw-scale-x: .95;--tw-scale-y: .95;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.active\\:bg-sidebar-accent:active{background-color:var(--sidebar-accent)}.active\\:text-sidebar-accent-foreground:active{color:var(--sidebar-accent-foreground)}.disabled\\:pointer-events-none:disabled{pointer-events:none}.disabled\\:transform-none:disabled{transform:none}.disabled\\:cursor-not-allowed:disabled{cursor:not-allowed}.disabled\\:from-gray-400:disabled{--tw-gradient-from: #9ca3af var(--tw-gradient-from-position);--tw-gradient-to: rgb(156 163 175 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.disabled\\:to-gray-500:disabled{--tw-gradient-to: #6b7280 var(--tw-gradient-to-position)}.disabled\\:opacity-50:disabled{opacity:.5}.disabled\\:shadow-none:disabled{--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.group\\/menu-item:focus-within .group-focus-within\\/menu-item\\:opacity-100{opacity:1}.group:hover .group-hover\\:scale-110{--tw-scale-x: 1.1;--tw-scale-y: 1.1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes bounce{0%,to{transform:translateY(-25%);animation-timing-function:cubic-bezier(.8,0,1,1)}50%{transform:none;animation-timing-function:cubic-bezier(0,0,.2,1)}}.group:hover .group-hover\\:animate-bounce{animation:bounce 1s infinite}@keyframes pulse{50%{opacity:.5}}.group:hover .group-hover\\:animate-pulse{animation:pulse 2s cubic-bezier(.4,0,.6,1) infinite}.group:hover .group-hover\\:text-blue-600{--tw-text-opacity: 1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.group:hover .group-hover\\:text-green-600{--tw-text-opacity: 1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.group:hover .group-hover\\:text-indigo-600{--tw-text-opacity: 1;color:rgb(79 70 229 / var(--tw-text-opacity, 1))}.group:hover .group-hover\\:text-orange-600{--tw-text-opacity: 1;color:rgb(234 88 12 / var(--tw-text-opacity, 1))}.group:hover .group-hover\\:text-pink-600{--tw-text-opacity: 1;color:rgb(219 39 119 / var(--tw-text-opacity, 1))}.group:hover .group-hover\\:text-purple-600{--tw-text-opacity: 1;color:rgb(147 51 234 / var(--tw-text-opacity, 1))}.group:hover .group-hover\\:text-red-600{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.group:hover .group-hover\\:text-yellow-600{--tw-text-opacity: 1;color:rgb(202 138 4 / var(--tw-text-opacity, 1))}.group\\/menu-item:hover .group-hover\\/menu-item\\:opacity-100,.group:hover .group-hover\\:opacity-100{opacity:1}.group:hover .group-hover\\:shadow-lg{--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.group.destructive .group-\\[\\.destructive\\]\\:text-red-600{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.group.destructive .group-\\[\\.destructive\\]\\:hover\\:bg-destructive:hover{background-color:var(--destructive)}.group.destructive .group-\\[\\.destructive\\]\\:hover\\:text-destructive-foreground:hover{color:var(--destructive-foreground)}.group.destructive .group-\\[\\.destructive\\]\\:hover\\:text-red-800:hover{--tw-text-opacity: 1;color:rgb(153 27 27 / var(--tw-text-opacity, 1))}.group.destructive .group-\\[\\.destructive\\]\\:focus\\:ring-destructive:focus{--tw-ring-color: var(--destructive)}.group.destructive .group-\\[\\.destructive\\]\\:focus\\:ring-red-400:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(248 113 113 / var(--tw-ring-opacity, 1))}.peer\\/menu-button:hover~.peer-hover\\/menu-button\\:text-sidebar-accent-foreground{color:var(--sidebar-accent-foreground)}.peer:disabled~.peer-disabled\\:cursor-not-allowed{cursor:not-allowed}.peer:disabled~.peer-disabled\\:opacity-70{opacity:.7}.has-\\[\\[data-variant\\=inset\\]\\]\\:bg-sidebar:has([data-variant=inset]){background-color:var(--sidebar-background)}.has-\\[\\:disabled\\]\\:opacity-50:has(:disabled){opacity:.5}.group\\/menu-item:has([data-sidebar=menu-action]) .group-has-\\[\\[data-sidebar\\=menu-action\\]\\]\\/menu-item\\:pr-8{padding-right:2rem}.aria-disabled\\:pointer-events-none[aria-disabled=true]{pointer-events:none}.aria-disabled\\:opacity-50[aria-disabled=true]{opacity:.5}.aria-selected\\:bg-accent[aria-selected=true]{background-color:var(--accent)}.aria-selected\\:text-accent-foreground[aria-selected=true]{color:var(--accent-foreground)}.aria-selected\\:text-muted-foreground[aria-selected=true]{color:var(--muted-foreground)}.aria-selected\\:opacity-100[aria-selected=true]{opacity:1}.data-\\[disabled\\=true\\]\\:pointer-events-none[data-disabled=true],.data-\\[disabled\\]\\:pointer-events-none[data-disabled]{pointer-events:none}.data-\\[panel-group-direction\\=vertical\\]\\:h-px[data-panel-group-direction=vertical]{height:1px}.data-\\[panel-group-direction\\=vertical\\]\\:w-full[data-panel-group-direction=vertical]{width:100%}.data-\\[side\\=bottom\\]\\:translate-y-1[data-side=bottom]{--tw-translate-y: .25rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\\[side\\=left\\]\\:-translate-x-1[data-side=left]{--tw-translate-x: -.25rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\\[side\\=right\\]\\:translate-x-1[data-side=right]{--tw-translate-x: .25rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\\[side\\=top\\]\\:-translate-y-1[data-side=top]{--tw-translate-y: -.25rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\\[state\\=checked\\]\\:translate-x-5[data-state=checked]{--tw-translate-x: 1.25rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\\[state\\=unchecked\\]\\:translate-x-0[data-state=unchecked],.data-\\[swipe\\=cancel\\]\\:translate-x-0[data-swipe=cancel]{--tw-translate-x: 0px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\\[swipe\\=end\\]\\:translate-x-\\[var\\(--radix-toast-swipe-end-x\\)\\][data-swipe=end]{--tw-translate-x: var(--radix-toast-swipe-end-x);transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\\[swipe\\=move\\]\\:translate-x-\\[var\\(--radix-toast-swipe-move-x\\)\\][data-swipe=move]{--tw-translate-x: var(--radix-toast-swipe-move-x);transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes accordion-up{0%{height:var(--radix-accordion-content-height)}to{height:0}}.data-\\[state\\=closed\\]\\:animate-accordion-up[data-state=closed]{animation:accordion-up .2s ease-out}@keyframes accordion-down{0%{height:0}to{height:var(--radix-accordion-content-height)}}.data-\\[state\\=open\\]\\:animate-accordion-down[data-state=open]{animation:accordion-down .2s ease-out}.data-\\[panel-group-direction\\=vertical\\]\\:flex-col[data-panel-group-direction=vertical]{flex-direction:column}.data-\\[active\\=true\\]\\:bg-sidebar-accent[data-active=true]{background-color:var(--sidebar-accent)}.data-\\[selected\\=\\'true\\'\\]\\:bg-accent[data-selected=true]{background-color:var(--accent)}.data-\\[state\\=active\\]\\:bg-background[data-state=active]{background-color:var(--background)}.data-\\[state\\=checked\\]\\:bg-primary[data-state=checked]{background-color:var(--primary)}.data-\\[state\\=on\\]\\:bg-accent[data-state=on],.data-\\[state\\=open\\]\\:bg-accent[data-state=open]{background-color:var(--accent)}.data-\\[state\\=open\\]\\:bg-secondary[data-state=open]{background-color:var(--secondary)}.data-\\[state\\=selected\\]\\:bg-muted[data-state=selected]{background-color:var(--muted)}.data-\\[state\\=unchecked\\]\\:bg-input[data-state=unchecked]{background-color:var(--input)}.data-\\[state\\=active\\]\\:bg-gradient-to-r[data-state=active]{background-image:linear-gradient(to right,var(--tw-gradient-stops))}.data-\\[state\\=active\\]\\:from-blue-500[data-state=active]{--tw-gradient-from: #3b82f6 var(--tw-gradient-from-position);--tw-gradient-to: rgb(59 130 246 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.data-\\[state\\=active\\]\\:from-green-500[data-state=active]{--tw-gradient-from: #22c55e var(--tw-gradient-from-position);--tw-gradient-to: rgb(34 197 94 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.data-\\[state\\=active\\]\\:to-emerald-500[data-state=active]{--tw-gradient-to: #10b981 var(--tw-gradient-to-position)}.data-\\[state\\=active\\]\\:to-purple-500[data-state=active]{--tw-gradient-to: #a855f7 var(--tw-gradient-to-position)}.data-\\[active\\=true\\]\\:font-medium[data-active=true]{font-weight:500}.data-\\[active\\=true\\]\\:text-sidebar-accent-foreground[data-active=true]{color:var(--sidebar-accent-foreground)}.data-\\[placeholder\\]\\:text-muted-foreground[data-placeholder]{color:var(--muted-foreground)}.data-\\[selected\\=true\\]\\:text-accent-foreground[data-selected=true]{color:var(--accent-foreground)}.data-\\[state\\=active\\]\\:text-foreground[data-state=active]{color:var(--foreground)}.data-\\[state\\=active\\]\\:text-white[data-state=active]{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.data-\\[state\\=checked\\]\\:text-primary-foreground[data-state=checked]{color:var(--primary-foreground)}.data-\\[state\\=on\\]\\:text-accent-foreground[data-state=on],.data-\\[state\\=open\\]\\:text-accent-foreground[data-state=open]{color:var(--accent-foreground)}.data-\\[state\\=open\\]\\:text-muted-foreground[data-state=open]{color:var(--muted-foreground)}.data-\\[disabled\\=true\\]\\:opacity-50[data-disabled=true],.data-\\[disabled\\]\\:opacity-50[data-disabled]{opacity:.5}.data-\\[state\\=open\\]\\:opacity-100[data-state=open]{opacity:1}.data-\\[state\\=active\\]\\:shadow-lg[data-state=active]{--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.data-\\[state\\=active\\]\\:shadow-sm[data-state=active]{--tw-shadow: 0 1px 2px 0 rgb(0 0 0 / .05);--tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.data-\\[swipe\\=move\\]\\:transition-none[data-swipe=move]{transition-property:none}.data-\\[state\\=closed\\]\\:duration-300[data-state=closed]{transition-duration:.3s}.data-\\[state\\=open\\]\\:duration-500[data-state=open]{transition-duration:.5s}.data-\\[motion\\^\\=from-\\]\\:animate-in[data-motion^=from-],.data-\\[state\\=open\\]\\:animate-in[data-state=open],.data-\\[state\\=visible\\]\\:animate-in[data-state=visible]{animation-name:enter;animation-duration:.15s;--tw-enter-opacity: initial;--tw-enter-scale: initial;--tw-enter-rotate: initial;--tw-enter-translate-x: initial;--tw-enter-translate-y: initial}.data-\\[motion\\^\\=to-\\]\\:animate-out[data-motion^=to-],.data-\\[state\\=closed\\]\\:animate-out[data-state=closed],.data-\\[state\\=hidden\\]\\:animate-out[data-state=hidden],.data-\\[swipe\\=end\\]\\:animate-out[data-swipe=end]{animation-name:exit;animation-duration:.15s;--tw-exit-opacity: initial;--tw-exit-scale: initial;--tw-exit-rotate: initial;--tw-exit-translate-x: initial;--tw-exit-translate-y: initial}.data-\\[motion\\^\\=from-\\]\\:fade-in[data-motion^=from-]{--tw-enter-opacity: 0}.data-\\[motion\\^\\=to-\\]\\:fade-out[data-motion^=to-],.data-\\[state\\=closed\\]\\:fade-out-0[data-state=closed]{--tw-exit-opacity: 0}.data-\\[state\\=closed\\]\\:fade-out-80[data-state=closed]{--tw-exit-opacity: .8}.data-\\[state\\=hidden\\]\\:fade-out[data-state=hidden]{--tw-exit-opacity: 0}.data-\\[state\\=open\\]\\:fade-in-0[data-state=open],.data-\\[state\\=visible\\]\\:fade-in[data-state=visible]{--tw-enter-opacity: 0}.data-\\[state\\=closed\\]\\:zoom-out-95[data-state=closed]{--tw-exit-scale: .95}.data-\\[state\\=open\\]\\:zoom-in-90[data-state=open]{--tw-enter-scale: .9}.data-\\[state\\=open\\]\\:zoom-in-95[data-state=open]{--tw-enter-scale: .95}.data-\\[motion\\=from-end\\]\\:slide-in-from-right-52[data-motion=from-end]{--tw-enter-translate-x: 13rem}.data-\\[motion\\=from-start\\]\\:slide-in-from-left-52[data-motion=from-start]{--tw-enter-translate-x: -13rem}.data-\\[motion\\=to-end\\]\\:slide-out-to-right-52[data-motion=to-end]{--tw-exit-translate-x: 13rem}.data-\\[motion\\=to-start\\]\\:slide-out-to-left-52[data-motion=to-start]{--tw-exit-translate-x: -13rem}.data-\\[side\\=bottom\\]\\:slide-in-from-top-2[data-side=bottom]{--tw-enter-translate-y: -.5rem}.data-\\[side\\=left\\]\\:slide-in-from-right-2[data-side=left]{--tw-enter-translate-x: .5rem}.data-\\[side\\=right\\]\\:slide-in-from-left-2[data-side=right]{--tw-enter-translate-x: -.5rem}.data-\\[side\\=top\\]\\:slide-in-from-bottom-2[data-side=top]{--tw-enter-translate-y: .5rem}.data-\\[state\\=closed\\]\\:slide-out-to-bottom[data-state=closed]{--tw-exit-translate-y: 100%}.data-\\[state\\=closed\\]\\:slide-out-to-left[data-state=closed]{--tw-exit-translate-x: -100%}.data-\\[state\\=closed\\]\\:slide-out-to-left-1\\/2[data-state=closed]{--tw-exit-translate-x: -50%}.data-\\[state\\=closed\\]\\:slide-out-to-right[data-state=closed],.data-\\[state\\=closed\\]\\:slide-out-to-right-full[data-state=closed]{--tw-exit-translate-x: 100%}.data-\\[state\\=closed\\]\\:slide-out-to-top[data-state=closed]{--tw-exit-translate-y: -100%}.data-\\[state\\=closed\\]\\:slide-out-to-top-\\[48\\%\\][data-state=closed]{--tw-exit-translate-y: -48%}.data-\\[state\\=open\\]\\:slide-in-from-bottom[data-state=open]{--tw-enter-translate-y: 100%}.data-\\[state\\=open\\]\\:slide-in-from-left[data-state=open]{--tw-enter-translate-x: -100%}.data-\\[state\\=open\\]\\:slide-in-from-left-1\\/2[data-state=open]{--tw-enter-translate-x: -50%}.data-\\[state\\=open\\]\\:slide-in-from-right[data-state=open]{--tw-enter-translate-x: 100%}.data-\\[state\\=open\\]\\:slide-in-from-top[data-state=open]{--tw-enter-translate-y: -100%}.data-\\[state\\=open\\]\\:slide-in-from-top-\\[48\\%\\][data-state=open]{--tw-enter-translate-y: -48%}.data-\\[state\\=open\\]\\:slide-in-from-top-full[data-state=open]{--tw-enter-translate-y: -100%}.data-\\[state\\=closed\\]\\:duration-300[data-state=closed]{animation-duration:.3s}.data-\\[state\\=open\\]\\:duration-500[data-state=open]{animation-duration:.5s}.data-\\[panel-group-direction\\=vertical\\]\\:after\\:left-0[data-panel-group-direction=vertical]:after{content:var(--tw-content);left:0}.data-\\[panel-group-direction\\=vertical\\]\\:after\\:h-1[data-panel-group-direction=vertical]:after{content:var(--tw-content);height:.25rem}.data-\\[panel-group-direction\\=vertical\\]\\:after\\:w-full[data-panel-group-direction=vertical]:after{content:var(--tw-content);width:100%}.data-\\[panel-group-direction\\=vertical\\]\\:after\\:-translate-y-1\\/2[data-panel-group-direction=vertical]:after{content:var(--tw-content);--tw-translate-y: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\\[panel-group-direction\\=vertical\\]\\:after\\:translate-x-0[data-panel-group-direction=vertical]:after{content:var(--tw-content);--tw-translate-x: 0px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\\[state\\=open\\]\\:hover\\:bg-accent:hover[data-state=open]{background-color:var(--accent)}.data-\\[state\\=open\\]\\:hover\\:bg-sidebar-accent:hover[data-state=open]{background-color:var(--sidebar-accent)}.data-\\[state\\=open\\]\\:hover\\:text-sidebar-accent-foreground:hover[data-state=open]{color:var(--sidebar-accent-foreground)}.data-\\[state\\=open\\]\\:focus\\:bg-accent:focus[data-state=open]{background-color:var(--accent)}.group[data-collapsible=offcanvas] .group-data-\\[collapsible\\=offcanvas\\]\\:left-\\[calc\\(var\\(--sidebar-width\\)\\*-1\\)\\]{left:calc(var(--sidebar-width) * -1)}.group[data-collapsible=offcanvas] .group-data-\\[collapsible\\=offcanvas\\]\\:right-\\[calc\\(var\\(--sidebar-width\\)\\*-1\\)\\]{right:calc(var(--sidebar-width) * -1)}.group[data-side=left] .group-data-\\[side\\=left\\]\\:-right-4{right:-1rem}.group[data-side=right] .group-data-\\[side\\=right\\]\\:left-0{left:0}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:-mt-8{margin-top:-2rem}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:hidden{display:none}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:\\!size-8{width:2rem!important;height:2rem!important}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:w-\\[--sidebar-width-icon\\]{width:var(--sidebar-width-icon)}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:w-\\[calc\\(var\\(--sidebar-width-icon\\)_\\+_theme\\(spacing\\.4\\)\\)\\]{width:calc(var(--sidebar-width-icon) + 1rem)}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:w-\\[calc\\(var\\(--sidebar-width-icon\\)_\\+_theme\\(spacing\\.4\\)_\\+2px\\)\\]{width:calc(var(--sidebar-width-icon) + 1rem + 2px)}.group[data-collapsible=offcanvas] .group-data-\\[collapsible\\=offcanvas\\]\\:w-0{width:0px}.group[data-collapsible=offcanvas] .group-data-\\[collapsible\\=offcanvas\\]\\:translate-x-0{--tw-translate-x: 0px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.group[data-side=right] .group-data-\\[side\\=right\\]\\:rotate-180,.group[data-state=open] .group-data-\\[state\\=open\\]\\:rotate-180{--tw-rotate: 180deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:overflow-hidden{overflow:hidden}.group[data-variant=floating] .group-data-\\[variant\\=floating\\]\\:rounded-lg{border-radius:var(--radius)}.group[data-variant=floating] .group-data-\\[variant\\=floating\\]\\:border{border-width:1px}.group[data-side=left] .group-data-\\[side\\=left\\]\\:border-r{border-right-width:1px}.group[data-side=right] .group-data-\\[side\\=right\\]\\:border-l{border-left-width:1px}.group[data-variant=floating] .group-data-\\[variant\\=floating\\]\\:border-sidebar-border{border-color:var(--sidebar-border)}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:\\!p-0{padding:0!important}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:\\!p-2{padding:.5rem!important}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:opacity-0{opacity:0}.group[data-variant=floating] .group-data-\\[variant\\=floating\\]\\:shadow{--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.group[data-collapsible=offcanvas] .group-data-\\[collapsible\\=offcanvas\\]\\:after\\:left-full:after{content:var(--tw-content);left:100%}.group[data-collapsible=offcanvas] .group-data-\\[collapsible\\=offcanvas\\]\\:hover\\:bg-sidebar:hover{background-color:var(--sidebar-background)}.peer\\/menu-button[data-size=default]~.peer-data-\\[size\\=default\\]\\/menu-button\\:top-1\\.5{top:.375rem}.peer\\/menu-button[data-size=lg]~.peer-data-\\[size\\=lg\\]\\/menu-button\\:top-2\\.5{top:.625rem}.peer\\/menu-button[data-size=sm]~.peer-data-\\[size\\=sm\\]\\/menu-button\\:top-1{top:.25rem}.peer\\/menu-button[data-active=true]~.peer-data-\\[active\\=true\\]\\/menu-button\\:text-sidebar-accent-foreground{color:var(--sidebar-accent-foreground)}.dark\\:border-amber-800:is(.dark *){--tw-border-opacity: 1;border-color:rgb(146 64 14 / var(--tw-border-opacity, 1))}.dark\\:border-blue-600:is(.dark *){--tw-border-opacity: 1;border-color:rgb(37 99 235 / var(--tw-border-opacity, 1))}.dark\\:border-blue-700\\/30:is(.dark *){border-color:#1d4ed84d}.dark\\:border-blue-800:is(.dark *){--tw-border-opacity: 1;border-color:rgb(30 64 175 / var(--tw-border-opacity, 1))}.dark\\:border-blue-800\\/50:is(.dark *){border-color:#1e40af80}.dark\\:border-gray-600:is(.dark *){--tw-border-opacity: 1;border-color:rgb(75 85 99 / var(--tw-border-opacity, 1))}.dark\\:border-gray-600\\/30:is(.dark *){border-color:#4b55634d}.dark\\:border-gray-700:is(.dark *){--tw-border-opacity: 1;border-color:rgb(55 65 81 / var(--tw-border-opacity, 1))}.dark\\:border-gray-700\\/30:is(.dark *){border-color:#3741514d}.dark\\:border-gray-700\\/50:is(.dark *){border-color:#37415180}.dark\\:border-gray-800:is(.dark *){--tw-border-opacity: 1;border-color:rgb(31 41 55 / var(--tw-border-opacity, 1))}.dark\\:border-green-800:is(.dark *){--tw-border-opacity: 1;border-color:rgb(22 101 52 / var(--tw-border-opacity, 1))}.dark\\:border-indigo-800:is(.dark *){--tw-border-opacity: 1;border-color:rgb(55 48 163 / var(--tw-border-opacity, 1))}.dark\\:border-orange-700:is(.dark *){--tw-border-opacity: 1;border-color:rgb(194 65 12 / var(--tw-border-opacity, 1))}.dark\\:border-orange-700\\/50:is(.dark *){border-color:#c2410c80}.dark\\:border-orange-800:is(.dark *){--tw-border-opacity: 1;border-color:rgb(154 52 18 / var(--tw-border-opacity, 1))}.dark\\:border-orange-800\\/50:is(.dark *){border-color:#9a341280}.dark\\:border-pink-800:is(.dark *){--tw-border-opacity: 1;border-color:rgb(157 23 77 / var(--tw-border-opacity, 1))}.dark\\:border-purple-700:is(.dark *){--tw-border-opacity: 1;border-color:rgb(126 34 206 / var(--tw-border-opacity, 1))}.dark\\:border-purple-700\\/30:is(.dark *){border-color:#7e22ce4d}.dark\\:border-purple-800:is(.dark *){--tw-border-opacity: 1;border-color:rgb(107 33 168 / var(--tw-border-opacity, 1))}.dark\\:border-red-700:is(.dark *){--tw-border-opacity: 1;border-color:rgb(185 28 28 / var(--tw-border-opacity, 1))}.dark\\:border-red-700\\/20:is(.dark *){border-color:#b91c1c33}.dark\\:border-red-800:is(.dark *){--tw-border-opacity: 1;border-color:rgb(153 27 27 / var(--tw-border-opacity, 1))}.dark\\:border-red-900:is(.dark *){--tw-border-opacity: 1;border-color:rgb(127 29 29 / var(--tw-border-opacity, 1))}.dark\\:border-slate-700:is(.dark *){--tw-border-opacity: 1;border-color:rgb(51 65 85 / var(--tw-border-opacity, 1))}.dark\\:border-slate-800:is(.dark *){--tw-border-opacity: 1;border-color:rgb(30 41 59 / var(--tw-border-opacity, 1))}.dark\\:border-yellow-700:is(.dark *){--tw-border-opacity: 1;border-color:rgb(161 98 7 / var(--tw-border-opacity, 1))}.dark\\:border-yellow-800:is(.dark *){--tw-border-opacity: 1;border-color:rgb(133 77 14 / var(--tw-border-opacity, 1))}.dark\\:bg-amber-900\\/20:is(.dark *){background-color:#78350f33}.dark\\:bg-amber-950:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(69 26 3 / var(--tw-bg-opacity, 1))}.dark\\:bg-black\\/10:is(.dark *){background-color:#0000001a}.dark\\:bg-black\\/20:is(.dark *){background-color:#0003}.dark\\:bg-blue-800\\/20:is(.dark *){background-color:#1e40af33}.dark\\:bg-blue-900:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(30 58 138 / var(--tw-bg-opacity, 1))}.dark\\:bg-blue-900\\/20:is(.dark *){background-color:#1e3a8a33}.dark\\:bg-blue-900\\/30:is(.dark *){background-color:#1e3a8a4d}.dark\\:bg-blue-950:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(23 37 84 / var(--tw-bg-opacity, 1))}.dark\\:bg-blue-950\\/20:is(.dark *){background-color:#17255433}.dark\\:bg-blue-950\\/30:is(.dark *){background-color:#1725544d}.dark\\:bg-blue-950\\/50:is(.dark *){background-color:#17255480}.dark\\:bg-emerald-900\\/30:is(.dark *){background-color:#064e3b4d}.dark\\:bg-gray-100:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(243 244 246 / var(--tw-bg-opacity, 1))}.dark\\:bg-gray-700:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1))}.dark\\:bg-gray-800:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(31 41 55 / var(--tw-bg-opacity, 1))}.dark\\:bg-gray-800\\/50:is(.dark *){background-color:#1f293780}.dark\\:bg-gray-800\\/60:is(.dark *){background-color:#1f293799}.dark\\:bg-gray-800\\/90:is(.dark *){background-color:#1f2937e6}.dark\\:bg-gray-900:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(17 24 39 / var(--tw-bg-opacity, 1))}.dark\\:bg-gray-900\\/95:is(.dark *){background-color:#111827f2}.dark\\:bg-green-900:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(20 83 45 / var(--tw-bg-opacity, 1))}.dark\\:bg-green-900\\/20:is(.dark *){background-color:#14532d33}.dark\\:bg-green-900\\/30:is(.dark *){background-color:#14532d4d}.dark\\:bg-green-950\\/20:is(.dark *){background-color:#052e1633}.dark\\:bg-indigo-900:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(49 46 129 / var(--tw-bg-opacity, 1))}.dark\\:bg-indigo-900\\/30:is(.dark *){background-color:#312e814d}.dark\\:bg-orange-800\\/20:is(.dark *){background-color:#9a341233}.dark\\:bg-orange-900:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(124 45 18 / var(--tw-bg-opacity, 1))}.dark\\:bg-orange-900\\/20:is(.dark *){background-color:#7c2d1233}.dark\\:bg-orange-900\\/30:is(.dark *){background-color:#7c2d124d}.dark\\:bg-orange-950\\/30:is(.dark *){background-color:#4314074d}.dark\\:bg-pink-900:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(131 24 67 / var(--tw-bg-opacity, 1))}.dark\\:bg-purple-900:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(88 28 135 / var(--tw-bg-opacity, 1))}.dark\\:bg-purple-900\\/30:is(.dark *){background-color:#581c874d}.dark\\:bg-red-800\\/20:is(.dark *){background-color:#991b1b33}.dark\\:bg-red-900:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(127 29 29 / var(--tw-bg-opacity, 1))}.dark\\:bg-red-900\\/20:is(.dark *){background-color:#7f1d1d33}.dark\\:bg-red-900\\/30:is(.dark *){background-color:#7f1d1d4d}.dark\\:bg-red-950\\/50:is(.dark *){background-color:#450a0a80}.dark\\:bg-slate-900:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(15 23 42 / var(--tw-bg-opacity, 1))}.dark\\:bg-teal-900\\/30:is(.dark *){background-color:#134e4a4d}.dark\\:bg-yellow-800\\/20:is(.dark *){background-color:#854d0e33}.dark\\:bg-yellow-900:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(113 63 18 / var(--tw-bg-opacity, 1))}.dark\\:bg-yellow-900\\/20:is(.dark *){background-color:#713f1233}.dark\\:bg-yellow-900\\/30:is(.dark *){background-color:#713f124d}.dark\\:from-amber-900\\/30:is(.dark *){--tw-gradient-from: rgb(120 53 15 / .3) var(--tw-gradient-from-position);--tw-gradient-to: rgb(120 53 15 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-amber-950\\/50:is(.dark *){--tw-gradient-from: rgb(69 26 3 / .5) var(--tw-gradient-from-position);--tw-gradient-to: rgb(69 26 3 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-blue-400:is(.dark *){--tw-gradient-from: #60a5fa var(--tw-gradient-from-position);--tw-gradient-to: rgb(96 165 250 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-blue-900:is(.dark *){--tw-gradient-from: #1e3a8a var(--tw-gradient-from-position);--tw-gradient-to: rgb(30 58 138 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-blue-900\\/10:is(.dark *){--tw-gradient-from: rgb(30 58 138 / .1) var(--tw-gradient-from-position);--tw-gradient-to: rgb(30 58 138 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-blue-900\\/20:is(.dark *){--tw-gradient-from: rgb(30 58 138 / .2) var(--tw-gradient-from-position);--tw-gradient-to: rgb(30 58 138 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-blue-900\\/30:is(.dark *){--tw-gradient-from: rgb(30 58 138 / .3) var(--tw-gradient-from-position);--tw-gradient-to: rgb(30 58 138 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-blue-900\\/40:is(.dark *){--tw-gradient-from: rgb(30 58 138 / .4) var(--tw-gradient-from-position);--tw-gradient-to: rgb(30 58 138 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-blue-950:is(.dark *){--tw-gradient-from: #172554 var(--tw-gradient-from-position);--tw-gradient-to: rgb(23 37 84 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-blue-950\\/30:is(.dark *){--tw-gradient-from: rgb(23 37 84 / .3) var(--tw-gradient-from-position);--tw-gradient-to: rgb(23 37 84 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-blue-950\\/50:is(.dark *){--tw-gradient-from: rgb(23 37 84 / .5) var(--tw-gradient-from-position);--tw-gradient-to: rgb(23 37 84 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-gray-700:is(.dark *){--tw-gradient-from: #374151 var(--tw-gradient-from-position);--tw-gradient-to: rgb(55 65 81 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-gray-800:is(.dark *){--tw-gradient-from: #1f2937 var(--tw-gradient-from-position);--tw-gradient-to: rgb(31 41 55 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-gray-800\\/50:is(.dark *){--tw-gradient-from: rgb(31 41 55 / .5) var(--tw-gradient-from-position);--tw-gradient-to: rgb(31 41 55 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-gray-900:is(.dark *){--tw-gradient-from: #111827 var(--tw-gradient-from-position);--tw-gradient-to: rgb(17 24 39 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-green-900:is(.dark *){--tw-gradient-from: #14532d var(--tw-gradient-from-position);--tw-gradient-to: rgb(20 83 45 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-green-900\\/30:is(.dark *){--tw-gradient-from: rgb(20 83 45 / .3) var(--tw-gradient-from-position);--tw-gradient-to: rgb(20 83 45 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-green-900\\/40:is(.dark *){--tw-gradient-from: rgb(20 83 45 / .4) var(--tw-gradient-from-position);--tw-gradient-to: rgb(20 83 45 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-green-950:is(.dark *){--tw-gradient-from: #052e16 var(--tw-gradient-from-position);--tw-gradient-to: rgb(5 46 22 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-green-950\\/30:is(.dark *){--tw-gradient-from: rgb(5 46 22 / .3) var(--tw-gradient-from-position);--tw-gradient-to: rgb(5 46 22 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-orange-900\\/10:is(.dark *){--tw-gradient-from: rgb(124 45 18 / .1) var(--tw-gradient-from-position);--tw-gradient-to: rgb(124 45 18 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-orange-900\\/40:is(.dark *){--tw-gradient-from: rgb(124 45 18 / .4) var(--tw-gradient-from-position);--tw-gradient-to: rgb(124 45 18 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-pink-900\\/40:is(.dark *){--tw-gradient-from: rgb(131 24 67 / .4) var(--tw-gradient-from-position);--tw-gradient-to: rgb(131 24 67 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-purple-400:is(.dark *){--tw-gradient-from: #c084fc var(--tw-gradient-from-position);--tw-gradient-to: rgb(192 132 252 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-purple-900:is(.dark *){--tw-gradient-from: #581c87 var(--tw-gradient-from-position);--tw-gradient-to: rgb(88 28 135 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-purple-900\\/30:is(.dark *){--tw-gradient-from: rgb(88 28 135 / .3) var(--tw-gradient-from-position);--tw-gradient-to: rgb(88 28 135 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-purple-900\\/40:is(.dark *){--tw-gradient-from: rgb(88 28 135 / .4) var(--tw-gradient-from-position);--tw-gradient-to: rgb(88 28 135 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-purple-950\\/30:is(.dark *){--tw-gradient-from: rgb(59 7 100 / .3) var(--tw-gradient-from-position);--tw-gradient-to: rgb(59 7 100 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-red-900\\/10:is(.dark *){--tw-gradient-from: rgb(127 29 29 / .1) var(--tw-gradient-from-position);--tw-gradient-to: rgb(127 29 29 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-red-900\\/20:is(.dark *){--tw-gradient-from: rgb(127 29 29 / .2) var(--tw-gradient-from-position);--tw-gradient-to: rgb(127 29 29 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-red-900\\/30:is(.dark *){--tw-gradient-from: rgb(127 29 29 / .3) var(--tw-gradient-from-position);--tw-gradient-to: rgb(127 29 29 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-red-900\\/40:is(.dark *){--tw-gradient-from: rgb(127 29 29 / .4) var(--tw-gradient-from-position);--tw-gradient-to: rgb(127 29 29 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-slate-950\\/50:is(.dark *){--tw-gradient-from: rgb(2 6 23 / .5) var(--tw-gradient-from-position);--tw-gradient-to: rgb(2 6 23 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-yellow-900:is(.dark *){--tw-gradient-from: #713f12 var(--tw-gradient-from-position);--tw-gradient-to: rgb(113 63 18 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-yellow-900\\/10:is(.dark *){--tw-gradient-from: rgb(113 63 18 / .1) var(--tw-gradient-from-position);--tw-gradient-to: rgb(113 63 18 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-yellow-900\\/40:is(.dark *){--tw-gradient-from: rgb(113 63 18 / .4) var(--tw-gradient-from-position);--tw-gradient-to: rgb(113 63 18 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:via-emerald-950\\/30:is(.dark *){--tw-gradient-to: rgb(2 44 34 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(2 44 34 / .3) var(--tw-gradient-via-position), var(--tw-gradient-to)}.dark\\:via-gray-800:is(.dark *){--tw-gradient-to: rgb(31 41 55 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #1f2937 var(--tw-gradient-via-position), var(--tw-gradient-to)}.dark\\:via-indigo-900\\/20:is(.dark *){--tw-gradient-to: rgb(49 46 129 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(49 46 129 / .2) var(--tw-gradient-via-position), var(--tw-gradient-to)}.dark\\:via-indigo-950\\/30:is(.dark *){--tw-gradient-to: rgb(30 27 75 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(30 27 75 / .3) var(--tw-gradient-via-position), var(--tw-gradient-to)}.dark\\:via-orange-900\\/20:is(.dark *){--tw-gradient-to: rgb(124 45 18 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(124 45 18 / .2) var(--tw-gradient-via-position), var(--tw-gradient-to)}.dark\\:to-amber-900\\/10:is(.dark *){--tw-gradient-to: rgb(120 53 15 / .1) var(--tw-gradient-to-position)}.dark\\:to-amber-900\\/40:is(.dark *){--tw-gradient-to: rgb(120 53 15 / .4) var(--tw-gradient-to-position)}.dark\\:to-blue-800\\/30:is(.dark *){--tw-gradient-to: rgb(30 64 175 / .3) var(--tw-gradient-to-position)}.dark\\:to-blue-900:is(.dark *){--tw-gradient-to: #1e3a8a var(--tw-gradient-to-position)}.dark\\:to-blue-900\\/20:is(.dark *){--tw-gradient-to: rgb(30 58 138 / .2) var(--tw-gradient-to-position)}.dark\\:to-blue-950\\/50:is(.dark *){--tw-gradient-to: rgb(23 37 84 / .5) var(--tw-gradient-to-position)}.dark\\:to-cyan-900\\/30:is(.dark *){--tw-gradient-to: rgb(22 78 99 / .3) var(--tw-gradient-to-position)}.dark\\:to-cyan-950:is(.dark *){--tw-gradient-to: #083344 var(--tw-gradient-to-position)}.dark\\:to-cyan-950\\/50:is(.dark *){--tw-gradient-to: rgb(8 51 68 / .5) var(--tw-gradient-to-position)}.dark\\:to-emerald-900\\/30:is(.dark *){--tw-gradient-to: rgb(6 78 59 / .3) var(--tw-gradient-to-position)}.dark\\:to-emerald-950:is(.dark *){--tw-gradient-to: #022c22 var(--tw-gradient-to-position)}.dark\\:to-gray-600:is(.dark *){--tw-gradient-to: #4b5563 var(--tw-gradient-to-position)}.dark\\:to-gray-700:is(.dark *){--tw-gradient-to: #374151 var(--tw-gradient-to-position)}.dark\\:to-gray-700\\/30:is(.dark *){--tw-gradient-to: rgb(55 65 81 / .3) var(--tw-gradient-to-position)}.dark\\:to-gray-700\\/50:is(.dark *){--tw-gradient-to: rgb(55 65 81 / .5) var(--tw-gradient-to-position)}.dark\\:to-gray-950\\/50:is(.dark *){--tw-gradient-to: rgb(3 7 18 / .5) var(--tw-gradient-to-position)}.dark\\:to-green-800\\/30:is(.dark *){--tw-gradient-to: rgb(22 101 52 / .3) var(--tw-gradient-to-position)}.dark\\:to-green-900\\/20:is(.dark *){--tw-gradient-to: rgb(20 83 45 / .2) var(--tw-gradient-to-position)}.dark\\:to-indigo-900\\/10:is(.dark *){--tw-gradient-to: rgb(49 46 129 / .1) var(--tw-gradient-to-position)}.dark\\:to-indigo-950\\/30:is(.dark *){--tw-gradient-to: rgb(30 27 75 / .3) var(--tw-gradient-to-position)}.dark\\:to-orange-800\\/30:is(.dark *){--tw-gradient-to: rgb(154 52 18 / .3) var(--tw-gradient-to-position)}.dark\\:to-orange-900:is(.dark *){--tw-gradient-to: #7c2d12 var(--tw-gradient-to-position)}.dark\\:to-orange-900\\/10:is(.dark *){--tw-gradient-to: rgb(124 45 18 / .1) var(--tw-gradient-to-position)}.dark\\:to-orange-900\\/30:is(.dark *){--tw-gradient-to: rgb(124 45 18 / .3) var(--tw-gradient-to-position)}.dark\\:to-orange-950\\/50:is(.dark *){--tw-gradient-to: rgb(67 20 7 / .5) var(--tw-gradient-to-position)}.dark\\:to-pink-400:is(.dark *){--tw-gradient-to: #f472b6 var(--tw-gradient-to-position)}.dark\\:to-pink-900:is(.dark *){--tw-gradient-to: #831843 var(--tw-gradient-to-position)}.dark\\:to-pink-900\\/30:is(.dark *){--tw-gradient-to: rgb(131 24 67 / .3) var(--tw-gradient-to-position)}.dark\\:to-pink-900\\/40:is(.dark *){--tw-gradient-to: rgb(131 24 67 / .4) var(--tw-gradient-to-position)}.dark\\:to-pink-950\\/30:is(.dark *){--tw-gradient-to: rgb(80 7 36 / .3) var(--tw-gradient-to-position)}.dark\\:to-purple-400:is(.dark *){--tw-gradient-to: #c084fc var(--tw-gradient-to-position)}.dark\\:to-purple-800\\/30:is(.dark *){--tw-gradient-to: rgb(107 33 168 / .3) var(--tw-gradient-to-position)}.dark\\:to-purple-900:is(.dark *){--tw-gradient-to: #581c87 var(--tw-gradient-to-position)}.dark\\:to-purple-950\\/30:is(.dark *){--tw-gradient-to: rgb(59 7 100 / .3) var(--tw-gradient-to-position)}.dark\\:to-red-800\\/10:is(.dark *){--tw-gradient-to: rgb(153 27 27 / .1) var(--tw-gradient-to-position)}.dark\\:to-red-900\\/20:is(.dark *){--tw-gradient-to: rgb(127 29 29 / .2) var(--tw-gradient-to-position)}.dark\\:to-rose-900\\/40:is(.dark *){--tw-gradient-to: rgb(136 19 55 / .4) var(--tw-gradient-to-position)}.dark\\:to-slate-800\\/50:is(.dark *){--tw-gradient-to: rgb(30 41 59 / .5) var(--tw-gradient-to-position)}.dark\\:to-teal-950\\/30:is(.dark *){--tw-gradient-to: rgb(4 47 46 / .3) var(--tw-gradient-to-position)}.dark\\:text-amber-300:is(.dark *){--tw-text-opacity: 1;color:rgb(252 211 77 / var(--tw-text-opacity, 1))}.dark\\:text-amber-400:is(.dark *){--tw-text-opacity: 1;color:rgb(251 191 36 / var(--tw-text-opacity, 1))}.dark\\:text-blue-100:is(.dark *){--tw-text-opacity: 1;color:rgb(219 234 254 / var(--tw-text-opacity, 1))}.dark\\:text-blue-200:is(.dark *){--tw-text-opacity: 1;color:rgb(191 219 254 / var(--tw-text-opacity, 1))}.dark\\:text-blue-300:is(.dark *){--tw-text-opacity: 1;color:rgb(147 197 253 / var(--tw-text-opacity, 1))}.dark\\:text-blue-400:is(.dark *){--tw-text-opacity: 1;color:rgb(96 165 250 / var(--tw-text-opacity, 1))}.dark\\:text-blue-400\\/70:is(.dark *){color:#60a5fab3}.dark\\:text-blue-400\\/80:is(.dark *){color:#60a5facc}.dark\\:text-emerald-400:is(.dark *){--tw-text-opacity: 1;color:rgb(52 211 153 / var(--tw-text-opacity, 1))}.dark\\:text-gray-100:is(.dark *){--tw-text-opacity: 1;color:rgb(243 244 246 / var(--tw-text-opacity, 1))}.dark\\:text-gray-200:is(.dark *){--tw-text-opacity: 1;color:rgb(229 231 235 / var(--tw-text-opacity, 1))}.dark\\:text-gray-300:is(.dark *){--tw-text-opacity: 1;color:rgb(209 213 219 / var(--tw-text-opacity, 1))}.dark\\:text-gray-400:is(.dark *){--tw-text-opacity: 1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.dark\\:text-gray-900:is(.dark *){--tw-text-opacity: 1;color:rgb(17 24 39 / var(--tw-text-opacity, 1))}.dark\\:text-green-100:is(.dark *){--tw-text-opacity: 1;color:rgb(220 252 231 / var(--tw-text-opacity, 1))}.dark\\:text-green-200:is(.dark *){--tw-text-opacity: 1;color:rgb(187 247 208 / var(--tw-text-opacity, 1))}.dark\\:text-green-300:is(.dark *){--tw-text-opacity: 1;color:rgb(134 239 172 / var(--tw-text-opacity, 1))}.dark\\:text-green-400:is(.dark *){--tw-text-opacity: 1;color:rgb(74 222 128 / var(--tw-text-opacity, 1))}.dark\\:text-green-400\\/70:is(.dark *){color:#4ade80b3}.dark\\:text-green-400\\/80:is(.dark *){color:#4ade80cc}.dark\\:text-indigo-400:is(.dark *){--tw-text-opacity: 1;color:rgb(129 140 248 / var(--tw-text-opacity, 1))}.dark\\:text-orange-100:is(.dark *){--tw-text-opacity: 1;color:rgb(255 237 213 / var(--tw-text-opacity, 1))}.dark\\:text-orange-200:is(.dark *){--tw-text-opacity: 1;color:rgb(254 215 170 / var(--tw-text-opacity, 1))}.dark\\:text-orange-300:is(.dark *){--tw-text-opacity: 1;color:rgb(253 186 116 / var(--tw-text-opacity, 1))}.dark\\:text-orange-400:is(.dark *){--tw-text-opacity: 1;color:rgb(251 146 60 / var(--tw-text-opacity, 1))}.dark\\:text-orange-400\\/70:is(.dark *){color:#fb923cb3}.dark\\:text-orange-400\\/80:is(.dark *){color:#fb923ccc}.dark\\:text-pink-300:is(.dark *){--tw-text-opacity: 1;color:rgb(249 168 212 / var(--tw-text-opacity, 1))}.dark\\:text-pink-400:is(.dark *){--tw-text-opacity: 1;color:rgb(244 114 182 / var(--tw-text-opacity, 1))}.dark\\:text-purple-200:is(.dark *){--tw-text-opacity: 1;color:rgb(233 213 255 / var(--tw-text-opacity, 1))}.dark\\:text-purple-300:is(.dark *){--tw-text-opacity: 1;color:rgb(216 180 254 / var(--tw-text-opacity, 1))}.dark\\:text-purple-400:is(.dark *){--tw-text-opacity: 1;color:rgb(192 132 252 / var(--tw-text-opacity, 1))}.dark\\:text-purple-400\\/80:is(.dark *){color:#c084fccc}.dark\\:text-red-100:is(.dark *){--tw-text-opacity: 1;color:rgb(254 226 226 / var(--tw-text-opacity, 1))}.dark\\:text-red-300:is(.dark *){--tw-text-opacity: 1;color:rgb(252 165 165 / var(--tw-text-opacity, 1))}.dark\\:text-red-400:is(.dark *){--tw-text-opacity: 1;color:rgb(248 113 113 / var(--tw-text-opacity, 1))}.dark\\:text-red-400\\/70:is(.dark *){color:#f87171b3}.dark\\:text-slate-300:is(.dark *){--tw-text-opacity: 1;color:rgb(203 213 225 / var(--tw-text-opacity, 1))}.dark\\:text-teal-400:is(.dark *){--tw-text-opacity: 1;color:rgb(45 212 191 / var(--tw-text-opacity, 1))}.dark\\:text-white:is(.dark *){--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.dark\\:text-yellow-200:is(.dark *){--tw-text-opacity: 1;color:rgb(254 240 138 / var(--tw-text-opacity, 1))}.dark\\:text-yellow-300:is(.dark *){--tw-text-opacity: 1;color:rgb(253 224 71 / var(--tw-text-opacity, 1))}.dark\\:text-yellow-400:is(.dark *){--tw-text-opacity: 1;color:rgb(250 204 21 / var(--tw-text-opacity, 1))}.dark\\:text-yellow-400\\/70:is(.dark *){color:#facc15b3}.dark\\:hover\\:border-gray-500:hover:is(.dark *){--tw-border-opacity: 1;border-color:rgb(107 114 128 / var(--tw-border-opacity, 1))}.dark\\:hover\\:bg-blue-900\\/20:hover:is(.dark *){background-color:#1e3a8a33}.dark\\:hover\\:bg-blue-900\\/50:hover:is(.dark *){background-color:#1e3a8a80}.dark\\:hover\\:bg-blue-950:hover:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(23 37 84 / var(--tw-bg-opacity, 1))}.dark\\:hover\\:bg-blue-950\\/30:hover:is(.dark *){background-color:#1725544d}.dark\\:hover\\:bg-gray-600:hover:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(75 85 99 / var(--tw-bg-opacity, 1))}.dark\\:hover\\:bg-gray-700:hover:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1))}.dark\\:hover\\:bg-gray-800:hover:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(31 41 55 / var(--tw-bg-opacity, 1))}.dark\\:hover\\:bg-green-950:hover:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(5 46 22 / var(--tw-bg-opacity, 1))}.dark\\:hover\\:bg-orange-900\\/50:hover:is(.dark *){background-color:#7c2d1280}.dark\\:hover\\:bg-purple-900\\/20:hover:is(.dark *){background-color:#581c8733}.dark\\:hover\\:bg-purple-900\\/50:hover:is(.dark *){background-color:#581c8780}.dark\\:hover\\:bg-red-900\\/20:hover:is(.dark *){background-color:#7f1d1d33}.dark\\:hover\\:bg-red-900\\/30:hover:is(.dark *){background-color:#7f1d1d4d}.dark\\:hover\\:from-gray-600:hover:is(.dark *){--tw-gradient-from: #4b5563 var(--tw-gradient-from-position);--tw-gradient-to: rgb(75 85 99 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:hover\\:to-gray-500:hover:is(.dark *){--tw-gradient-to: #6b7280 var(--tw-gradient-to-position)}.dark\\:hover\\:text-blue-300:hover:is(.dark *){--tw-text-opacity: 1;color:rgb(147 197 253 / var(--tw-text-opacity, 1))}.dark\\:hover\\:text-white:hover:is(.dark *){--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.group.destructive .dark\\:group-\\[\\.destructive\\]\\:text-red-400:is(.dark *){--tw-text-opacity: 1;color:rgb(248 113 113 / var(--tw-text-opacity, 1))}.group.destructive .dark\\:group-\\[\\.destructive\\]\\:hover\\:text-red-200:hover:is(.dark *){--tw-text-opacity: 1;color:rgb(254 202 202 / var(--tw-text-opacity, 1))}@media (min-width: 640px){.sm\\:bottom-0{bottom:0}.sm\\:right-0{right:0}.sm\\:top-auto{top:auto}.sm\\:mt-0{margin-top:0}.sm\\:flex{display:flex}.sm\\:max-w-md{max-width:28rem}.sm\\:max-w-sm{max-width:24rem}.sm\\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.sm\\:flex-row{flex-direction:row}.sm\\:flex-col{flex-direction:column}.sm\\:justify-end{justify-content:flex-end}.sm\\:gap-2\\.5{gap:.625rem}.sm\\:space-x-2>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(.5rem * var(--tw-space-x-reverse));margin-left:calc(.5rem * calc(1 - var(--tw-space-x-reverse)))}.sm\\:space-x-4>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(1rem * var(--tw-space-x-reverse));margin-left:calc(1rem * calc(1 - var(--tw-space-x-reverse)))}.sm\\:space-y-0>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(0px * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0px * var(--tw-space-y-reverse))}.sm\\:rounded-lg{border-radius:var(--radius)}.sm\\:text-left{text-align:left}.data-\\[state\\=open\\]\\:sm\\:slide-in-from-bottom-full[data-state=open]{--tw-enter-translate-y: 100%}}@media (min-width: 768px){.md\\:absolute{position:absolute}.md\\:block{display:block}.md\\:flex{display:flex}.md\\:w-\\[var\\(--radix-navigation-menu-viewport-width\\)\\]{width:var(--radix-navigation-menu-viewport-width)}.md\\:w-auto{width:auto}.md\\:max-w-\\[420px\\]{max-width:420px}.md\\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.md\\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.md\\:grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.md\\:text-2xl{font-size:1.5rem;line-height:2rem}.md\\:text-6xl{font-size:3.75rem;line-height:1}.md\\:text-sm{font-size:.875rem;line-height:1.25rem}.md\\:opacity-0{opacity:0}.after\\:md\\:hidden:after{content:var(--tw-content);display:none}.peer[data-variant=inset]~.md\\:peer-data-\\[variant\\=inset\\]\\:m-2{margin:.5rem}.peer[data-state=collapsed][data-variant=inset]~.md\\:peer-data-\\[state\\=collapsed\\]\\:peer-data-\\[variant\\=inset\\]\\:ml-2{margin-left:.5rem}.peer[data-variant=inset]~.md\\:peer-data-\\[variant\\=inset\\]\\:ml-0{margin-left:0}.peer[data-variant=inset]~.md\\:peer-data-\\[variant\\=inset\\]\\:rounded-xl{border-radius:.75rem}.peer[data-variant=inset]~.md\\:peer-data-\\[variant\\=inset\\]\\:shadow{--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}}@media (min-width: 1024px){.lg\\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.lg\\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}}.\\[\\&\\:has\\(\\[aria-selected\\]\\)\\]\\:bg-accent:has([aria-selected]){background-color:var(--accent)}.first\\:\\[\\&\\:has\\(\\[aria-selected\\]\\)\\]\\:rounded-l-md:has([aria-selected]):first-child{border-top-left-radius:calc(var(--radius) - 2px);border-bottom-left-radius:calc(var(--radius) - 2px)}.last\\:\\[\\&\\:has\\(\\[aria-selected\\]\\)\\]\\:rounded-r-md:has([aria-selected]):last-child{border-top-right-radius:calc(var(--radius) - 2px);border-bottom-right-radius:calc(var(--radius) - 2px)}.\\[\\&\\:has\\(\\[aria-selected\\]\\.day-range-end\\)\\]\\:rounded-r-md:has([aria-selected].day-range-end){border-top-right-radius:calc(var(--radius) - 2px);border-bottom-right-radius:calc(var(--radius) - 2px)}.\\[\\&\\:has\\(\\[role\\=checkbox\\]\\)\\]\\:pr-0:has([role=checkbox]){padding-right:0}.\\[\\&\\>button\\]\\:hidden>button{display:none}.\\[\\&\\>span\\:last-child\\]\\:truncate>span:last-child{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.\\[\\&\\>span\\]\\:line-clamp-1>span{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.\\[\\&\\>svg\\+div\\]\\:translate-y-\\[-3px\\]>svg+div{--tw-translate-y: -3px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.\\[\\&\\>svg\\]\\:absolute>svg{position:absolute}.\\[\\&\\>svg\\]\\:left-4>svg{left:1rem}.\\[\\&\\>svg\\]\\:top-4>svg{top:1rem}.\\[\\&\\>svg\\]\\:size-4>svg{width:1rem;height:1rem}.\\[\\&\\>svg\\]\\:h-2\\.5>svg{height:.625rem}.\\[\\&\\>svg\\]\\:h-3>svg{height:.75rem}.\\[\\&\\>svg\\]\\:h-3\\.5>svg{height:.875rem}.\\[\\&\\>svg\\]\\:w-2\\.5>svg{width:.625rem}.\\[\\&\\>svg\\]\\:w-3>svg{width:.75rem}.\\[\\&\\>svg\\]\\:w-3\\.5>svg{width:.875rem}.\\[\\&\\>svg\\]\\:shrink-0>svg{flex-shrink:0}.\\[\\&\\>svg\\]\\:text-blue-600>svg{--tw-text-opacity: 1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.\\[\\&\\>svg\\]\\:text-foreground>svg{color:var(--foreground)}.\\[\\&\\>svg\\]\\:text-muted-foreground>svg{color:var(--muted-foreground)}.\\[\\&\\>svg\\]\\:text-red-600>svg{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.\\[\\&\\>svg\\]\\:text-sidebar-accent-foreground>svg{color:var(--sidebar-accent-foreground)}.dark\\:\\[\\&\\>svg\\]\\:text-blue-400>svg:is(.dark *){--tw-text-opacity: 1;color:rgb(96 165 250 / var(--tw-text-opacity, 1))}.dark\\:\\[\\&\\>svg\\]\\:text-red-400>svg:is(.dark *){--tw-text-opacity: 1;color:rgb(248 113 113 / var(--tw-text-opacity, 1))}.\\[\\&\\>svg\\~\\*\\]\\:pl-7>svg~*{padding-left:1.75rem}.\\[\\&\\>tr\\]\\:last\\:border-b-0:last-child>tr{border-bottom-width:0px}.\\[\\&\\[data-panel-group-direction\\=vertical\\]\\>div\\]\\:rotate-90[data-panel-group-direction=vertical]>div{--tw-rotate: 90deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.\\[\\&\\[data-state\\=open\\]\\>svg\\]\\:rotate-180[data-state=open]>svg{--tw-rotate: 180deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.\\[\\&_\\.recharts-cartesian-axis-tick_text\\]\\:fill-muted-foreground .recharts-cartesian-axis-tick text{fill:var(--muted-foreground)}.\\[\\&_\\.recharts-curve\\.recharts-tooltip-cursor\\]\\:stroke-border .recharts-curve.recharts-tooltip-cursor{stroke:var(--border)}.\\[\\&_\\.recharts-dot\\[stroke\\=\\'\\#fff\\'\\]\\]\\:stroke-transparent .recharts-dot[stroke=\"#fff\"]{stroke:transparent}.\\[\\&_\\.recharts-layer\\]\\:outline-none .recharts-layer{outline:2px solid transparent;outline-offset:2px}.\\[\\&_\\.recharts-polar-grid_\\[stroke\\=\\'\\#ccc\\'\\]\\]\\:stroke-border .recharts-polar-grid [stroke=\"#ccc\"]{stroke:var(--border)}.\\[\\&_\\.recharts-radial-bar-background-sector\\]\\:fill-muted .recharts-radial-bar-background-sector,.\\[\\&_\\.recharts-rectangle\\.recharts-tooltip-cursor\\]\\:fill-muted .recharts-rectangle.recharts-tooltip-cursor{fill:var(--muted)}.\\[\\&_\\.recharts-reference-line_\\[stroke\\=\\'\\#ccc\\'\\]\\]\\:stroke-border .recharts-reference-line [stroke=\"#ccc\"]{stroke:var(--border)}.\\[\\&_\\.recharts-sector\\[stroke\\=\\'\\#fff\\'\\]\\]\\:stroke-transparent .recharts-sector[stroke=\"#fff\"]{stroke:transparent}.\\[\\&_\\.recharts-sector\\]\\:outline-none .recharts-sector,.\\[\\&_\\.recharts-surface\\]\\:outline-none .recharts-surface{outline:2px solid transparent;outline-offset:2px}.\\[\\&_\\[cmdk-group-heading\\]\\]\\:px-2 [cmdk-group-heading]{padding-left:.5rem;padding-right:.5rem}.\\[\\&_\\[cmdk-group-heading\\]\\]\\:py-1\\.5 [cmdk-group-heading]{padding-top:.375rem;padding-bottom:.375rem}.\\[\\&_\\[cmdk-group-heading\\]\\]\\:text-xs [cmdk-group-heading]{font-size:.75rem;line-height:1rem}.\\[\\&_\\[cmdk-group-heading\\]\\]\\:font-medium [cmdk-group-heading]{font-weight:500}.\\[\\&_\\[cmdk-group-heading\\]\\]\\:text-muted-foreground [cmdk-group-heading]{color:var(--muted-foreground)}.\\[\\&_\\[cmdk-group\\]\\:not\\(\\[hidden\\]\\)_\\~\\[cmdk-group\\]\\]\\:pt-0 [cmdk-group]:not([hidden])~[cmdk-group]{padding-top:0}.\\[\\&_\\[cmdk-group\\]\\]\\:px-2 [cmdk-group]{padding-left:.5rem;padding-right:.5rem}.\\[\\&_\\[cmdk-input-wrapper\\]_svg\\]\\:h-5 [cmdk-input-wrapper] svg{height:1.25rem}.\\[\\&_\\[cmdk-input-wrapper\\]_svg\\]\\:w-5 [cmdk-input-wrapper] svg{width:1.25rem}.\\[\\&_\\[cmdk-input\\]\\]\\:h-12 [cmdk-input]{height:3rem}.\\[\\&_\\[cmdk-item\\]\\]\\:px-2 [cmdk-item]{padding-left:.5rem;padding-right:.5rem}.\\[\\&_\\[cmdk-item\\]\\]\\:py-3 [cmdk-item]{padding-top:.75rem;padding-bottom:.75rem}.\\[\\&_\\[cmdk-item\\]_svg\\]\\:h-5 [cmdk-item] svg{height:1.25rem}.\\[\\&_\\[cmdk-item\\]_svg\\]\\:w-5 [cmdk-item] svg{width:1.25rem}.\\[\\&_p\\]\\:leading-relaxed p{line-height:1.625}.\\[\\&_svg\\]\\:pointer-events-none svg{pointer-events:none}.\\[\\&_svg\\]\\:size-4 svg{width:1rem;height:1rem}.\\[\\&_svg\\]\\:shrink-0 svg{flex-shrink:0}.\\[\\&_tr\\:last-child\\]\\:border-0 tr:last-child{border-width:0px}.\\[\\&_tr\\]\\:border-b tr{border-bottom-width:1px}[data-side=left][data-collapsible=offcanvas] .\\[\\[data-side\\=left\\]\\[data-collapsible\\=offcanvas\\]_\\&\\]\\:-right-2{right:-.5rem}[data-side=left][data-state=collapsed] .\\[\\[data-side\\=left\\]\\[data-state\\=collapsed\\]_\\&\\]\\:cursor-e-resize{cursor:e-resize}[data-side=left] .\\[\\[data-side\\=left\\]_\\&\\]\\:cursor-w-resize{cursor:w-resize}[data-side=right][data-collapsible=offcanvas] .\\[\\[data-side\\=right\\]\\[data-collapsible\\=offcanvas\\]_\\&\\]\\:-left-2{left:-.5rem}[data-side=right][data-state=collapsed] .\\[\\[data-side\\=right\\]\\[data-state\\=collapsed\\]_\\&\\]\\:cursor-w-resize{cursor:w-resize}[data-side=right] .\\[\\[data-side\\=right\\]_\\&\\]\\:cursor-e-resize{cursor:e-resize}\n","size_bytes":160096},"client/src/components/bottom-help-section.tsx":{"content":"import { useState } from \"react\";\nimport { Link, useLocation } from \"wouter\";\nimport { ChefHat, Filter, ArrowRight, HelpCircle, MessageCircle, FileText, ExternalLink } from \"lucide-react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\n\nconst DIETARY_REQUIREMENTS = [\n  { value: \"all\", label: \"All Recipes\" },\n  { value: \"keto\", label: \"Keto\" },\n  { value: \"vegan\", label: \"Vegan\" },\n  { value: \"vegetarian\", label: \"Vegetarian\" },\n  { value: \"pescatarian\", label: \"Pescatarian\" },\n  { value: \"high-protein\", label: \"High Protein\" },\n  { value: \"high-fiber\", label: \"High Fiber\" },\n  { value: \"low-residue\", label: \"Low Residue\" },\n  { value: \"gluten-free\", label: \"Gluten Free\" },\n  { value: \"dairy-free\", label: \"Dairy Free\" },\n  { value: \"low-carb\", label: \"Low Carb\" },\n  { value: \"paleo\", label: \"Paleo\" },\n  { value: \"mediterranean\", label: \"Mediterranean\" }\n];\n\nexport function BottomHelpSection() {\n  const [selectedDiet, setSelectedDiet] = useState(\"all\");\n  const [, navigate] = useLocation();\n\n  const handleViewRecipes = () => {\n    const url = selectedDiet && selectedDiet !== 'all' ? `/recipes?diet=${selectedDiet}` : '/recipes';\n    console.log('Navigating to:', url);\n    // Use window.location for more reliable navigation\n    window.location.href = url;\n  };\n\n  return (\n    <div className=\"mt-8 mb-24 px-4 space-y-6\">\n      {/* Tailored Recipes Section */}\n      <div className=\"relative bg-gradient-to-br from-slate-900 via-slate-800 to-slate-950 rounded-[2.5rem] p-6 shadow-[0_25px_60px_-12px_rgba(0,0,0,0.8)] border border-slate-600/30 backdrop-blur-xl\">\n        {/* Subtle inner glow */}\n        <div className=\"absolute inset-0 rounded-[2.5rem] bg-gradient-to-br from-orange-500/5 via-transparent to-red-500/5\"></div>\n        \n        {/* Header */}\n        <div className=\"text-center mb-6 relative z-10\">\n          <div className=\"flex items-center justify-center space-x-3 mb-2\">\n            <div className=\"p-3 bg-gradient-to-br from-orange-500 to-red-500 rounded-2xl shadow-2xl shadow-orange-500/25 border border-white/10\">\n              <ChefHat className=\"h-6 w-6 text-white\" />\n            </div>\n            <h3 className=\"text-white text-xl font-bold\">Tailored Recipes for You</h3>\n          </div>\n          <p className=\"text-gray-300 text-sm\">\n            Discover healthy recipes perfectly matched to your dietary needs and preferences\n          </p>\n        </div>\n\n        {/* Dietary Requirements Dropdown */}\n        <div className=\"space-y-4 relative z-10\">\n          <div className=\"space-y-3\">\n            <label className=\"text-sm font-semibold text-gray-200 flex items-center gap-2\">\n              <Filter className=\"h-4 w-4 text-orange-400\" />\n              Choose Your Dietary Preference:\n            </label>\n            <Select value={selectedDiet} onValueChange={setSelectedDiet}>\n              <SelectTrigger \n                className=\"bg-slate-800/80 border-slate-600/50 text-white backdrop-blur-xl hover:bg-slate-700/80 transition-all duration-300\"\n                data-testid=\"select-bottom-dietary-filter\"\n              >\n                <SelectValue placeholder=\"Select dietary requirements\" />\n              </SelectTrigger>\n              <SelectContent className=\"bg-slate-800 border-slate-600 text-white\">\n                {DIETARY_REQUIREMENTS.map((diet) => (\n                  <SelectItem \n                    key={diet.value} \n                    value={diet.value}\n                    className=\"hover:bg-slate-700 focus:bg-slate-700\"\n                    data-testid={`option-bottom-diet-${diet.value || 'all'}`}\n                  >\n                    {diet.label}\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n          \n          <button\n            onClick={handleViewRecipes}\n            className=\"w-full bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white py-4 px-6 rounded-2xl font-semibold transition-all duration-300 shadow-2xl hover:scale-[1.02] hover:shadow-orange-500/40 border border-white/10 backdrop-blur-xl flex items-center justify-center space-x-3\"\n            data-testid=\"button-view-tailored-recipes\"\n            type=\"button\"\n          >\n            <ChefHat className=\"h-5 w-5\" />\n            <span>{selectedDiet && selectedDiet !== 'all' ? `View ${DIETARY_REQUIREMENTS.find(d => d.value === selectedDiet)?.label} Recipes` : 'Browse All Recipes'}</span>\n            <ArrowRight className=\"h-5 w-5\" />\n          </button>\n          \n          {selectedDiet && selectedDiet !== 'all' && (\n            <div className=\"text-xs text-orange-200 bg-gradient-to-r from-orange-600/20 to-red-600/20 rounded-2xl p-3 border border-orange-500/30 backdrop-blur-xl\">\n              <strong>Perfect match!</strong> We'll show you {selectedDiet.replace('-', ' ')} recipes tailored to your dietary needs.\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Help Section */}\n      <Card className=\"bg-muted/30 border-dashed\">\n        <CardHeader className=\"pb-3\">\n          <CardTitle className=\"flex items-center gap-2 text-sm font-medium text-black dark:text-white\">\n            <HelpCircle className=\"h-4 w-4\" />\n            Need Help?\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"pt-0\">\n          <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-3\">\n            <Link href=\"/help\">\n              <Button \n                variant=\"ghost\" \n                size=\"sm\" \n                className=\"w-full h-auto p-3 flex flex-col items-center gap-2 hover:bg-background\"\n                data-testid=\"button-help-guide\"\n              >\n                <FileText className=\"h-5 w-5\" />\n                <div className=\"text-center\">\n                  <div className=\"font-medium text-xs\">User Guide</div>\n                  <div className=\"text-xs text-black dark:text-white\">How to use PlateMate</div>\n                </div>\n              </Button>\n            </Link>\n            \n            <Button \n              variant=\"ghost\" \n              size=\"sm\" \n              className=\"w-full h-auto p-3 flex flex-col items-center gap-2 hover:bg-background\"\n              onClick={() => window.open('mailto:support@platemate.app', '_blank')}\n              data-testid=\"button-contact-support\"\n            >\n              <MessageCircle className=\"h-5 w-5\" />\n              <div className=\"text-center\">\n                <div className=\"font-medium text-xs\">Contact Support</div>\n                <div className=\"text-xs text-black dark:text-white\">Get personalized help</div>\n              </div>\n            </Button>\n            \n            <Link href=\"/injection-advice\">\n              <Button \n                variant=\"ghost\" \n                size=\"sm\" \n                className=\"w-full h-auto p-3 flex flex-col items-center gap-2 bg-slate-800/80 hover:bg-slate-700/90 border border-slate-600/50 backdrop-blur-xl rounded-2xl transition-all duration-300 hover:scale-[1.02]\"\n                data-testid=\"button-medication-help\"\n              >\n                <ExternalLink className=\"h-5 w-5 text-blue-400\" />\n                <div className=\"text-center\">\n                  <div className=\"font-medium text-xs text-white\">Medication Guide</div>\n                  <div className=\"text-xs text-blue-200\">Weight loss injections</div>\n                </div>\n              </Button>\n            </Link>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":7692},"client/src/components/weight-chart.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { format, subWeeks, startOfWeek, endOfWeek, parseISO, isWithinInterval } from \"date-fns\";\nimport { TrendingUp, TrendingDown, Minus } from \"lucide-react\";\nimport { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from \"recharts\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport type { WeightEntry } from \"@shared/schema\";\n\ninterface WeightChartProps {\n  className?: string;\n}\n\ninterface ChartDataPoint {\n  week: string;\n  weight: number;\n  weightKg: number;\n  weightLb: number;\n  date: string;\n  entryCount: number;\n}\n\nexport function WeightChart({ className }: WeightChartProps) {\n  // Fetch weight entries for the last 12 weeks\n  const { data: weightEntries, isLoading, error } = useQuery<WeightEntry[]>({\n    queryKey: ['/api/weights'],\n    select: (data) => {\n      const twelveWeeksAgo = subWeeks(new Date(), 12);\n      return data.filter((entry) => {\n        const entryDate = new Date(entry.loggedAt);\n        return entryDate >= twelveWeeksAgo;\n      });\n    },\n  });\n\n  // Process data for chart\n  const chartData: ChartDataPoint[] = [];\n  \n  if (weightEntries) {\n    // Group entries by week\n    const weeklyData: { [key: string]: WeightEntry[] } = {};\n    \n    for (let i = 11; i >= 0; i--) {\n      const weekStart = startOfWeek(subWeeks(new Date(), i));\n      const weekEnd = endOfWeek(weekStart);\n      const weekKey = format(weekStart, \"MMM d\");\n      \n      weeklyData[weekKey] = weightEntries.filter((entry) => {\n        const entryDate = new Date(entry.loggedAt);\n        return isWithinInterval(entryDate, { start: weekStart, end: weekEnd });\n      });\n    }\n\n    // Calculate average weight per week\n    Object.entries(weeklyData).forEach(([week, entries]) => {\n      if (entries.length > 0) {\n        const totalWeight = entries.reduce((sum, entry) => sum + entry.weightGrams, 0);\n        const avgWeightGrams = totalWeight / entries.length;\n        \n        chartData.push({\n          week,\n          weight: Math.round((avgWeightGrams / 1000) * 10) / 10, // Default to kg\n          weightKg: Math.round((avgWeightGrams / 1000) * 10) / 10,\n          weightLb: Math.round((avgWeightGrams / 453.592) * 10) / 10,\n          date: typeof entries[0].loggedAt === 'string' ? entries[0].loggedAt : entries[0].loggedAt.toISOString(),\n          entryCount: entries.length,\n        });\n      }\n    });\n  }\n\n  // Calculate trend\n  const getTrend = () => {\n    if (chartData.length < 2) return { type: \"neutral\", change: 0 };\n    \n    const firstWeight = chartData[0].weight;\n    const lastWeight = chartData[chartData.length - 1].weight;\n    const change = lastWeight - firstWeight;\n    \n    if (Math.abs(change) < 0.5) return { type: \"neutral\", change };\n    return { type: change > 0 ? \"up\" : \"down\", change };\n  };\n\n  const trend = getTrend();\n\n  const customTooltip = ({ active, payload, label }: any) => {\n    if (active && payload && payload.length > 0) {\n      const data = payload[0].payload;\n      return (\n        <div className=\"bg-background border rounded-lg p-3 shadow-lg\">\n          <p className=\"font-medium\">{`Week of ${label}`}</p>\n          <p className=\"text-primary\">\n            Weight: <span className=\"font-bold\">{data.weightKg}kg ({data.weightLb}lb)</span>\n          </p>\n          <p className=\"text-xs text-muted-foreground\">\n            {data.entryCount} entr{data.entryCount === 1 ? 'y' : 'ies'}\n          </p>\n        </div>\n      );\n    }\n    return null;\n  };\n\n  if (isLoading) {\n    return (\n      <Card className={className}>\n        <CardHeader>\n          <CardTitle className=\"flex items-center space-x-2\">\n            <TrendingUp className=\"h-5 w-5\" />\n            <span>12-Week Progress</span>\n          </CardTitle>\n          <CardDescription>Loading weight trend...</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"h-64 flex items-center justify-center\">\n            <div className=\"animate-pulse text-muted-foreground\">Loading chart data...</div>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  if (error) {\n    return (\n      <Card className={className}>\n        <CardHeader>\n          <CardTitle className=\"flex items-center space-x-2 text-destructive\">\n            <TrendingUp className=\"h-5 w-5\" />\n            <span>12-Week Progress</span>\n          </CardTitle>\n          <CardDescription>Failed to load weight data</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"h-64 flex items-center justify-center\">\n            <p className=\"text-muted-foreground\">Unable to load chart data</p>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  if (!chartData.length) {\n    return (\n      <Card className={className}>\n        <CardHeader>\n          <CardTitle className=\"flex items-center space-x-2\">\n            <TrendingUp className=\"h-5 w-5\" />\n            <span>12-Week Progress</span>\n          </CardTitle>\n          <CardDescription>Track your weight over time</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"h-64 flex flex-col items-center justify-center space-y-3\">\n            <div className=\"text-6xl\">ðŸ“Š</div>\n            <p className=\"text-muted-foreground text-center\">\n              No weight data yet.<br />\n              Start logging your weight to see your progress!\n            </p>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  const TrendIcon = trend.type === \"up\" ? TrendingUp : trend.type === \"down\" ? TrendingDown : Minus;\n  const trendColor = trend.type === \"up\" ? \"text-red-500\" : trend.type === \"down\" ? \"text-green-500\" : \"text-gray-500\";\n  const trendText = trend.type === \"up\" ? \"increased\" : trend.type === \"down\" ? \"decreased\" : \"stable\";\n\n  return (\n    <Card className={className} data-testid=\"weight-chart\">\n      <CardHeader>\n        <CardTitle className=\"flex items-center justify-between\">\n          <div className=\"flex items-center space-x-2\">\n            <TrendingUp className=\"h-5 w-5\" />\n            <span>12-Week Progress</span>\n          </div>\n          <div className={`flex items-center space-x-1 text-sm ${trendColor}`} data-testid=\"weight-trend\">\n            <TrendIcon className=\"h-4 w-4\" />\n            <span>\n              {Math.abs(trend.change).toFixed(1)}kg {trendText}\n            </span>\n          </div>\n        </CardTitle>\n        <CardDescription>\n          Your weight trend over the last 12 weeks\n        </CardDescription>\n      </CardHeader>\n      <CardContent>\n        <div className=\"h-64\" data-testid=\"chart-container\">\n          <ResponsiveContainer width=\"100%\" height=\"100%\">\n            <LineChart data={chartData} margin={{ top: 5, right: 30, left: 20, bottom: 5 }}>\n              <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-muted\" />\n              <XAxis \n                dataKey=\"week\" \n                className=\"text-xs text-muted-foreground\"\n                tick={{ fontSize: 12 }}\n              />\n              <YAxis \n                className=\"text-xs text-muted-foreground\"\n                tick={{ fontSize: 12 }}\n                domain={['dataMin - 2', 'dataMax + 2']}\n              />\n              <Tooltip content={customTooltip} />\n              <Line\n                type=\"monotone\"\n                dataKey=\"weight\"\n                stroke=\"hsl(var(--primary))\"\n                strokeWidth={3}\n                dot={{ fill: \"hsl(var(--primary))\", strokeWidth: 2, r: 4 }}\n                activeDot={{ r: 6, stroke: \"hsl(var(--primary))\", strokeWidth: 2, fill: \"hsl(var(--background))\" }}\n              />\n            </LineChart>\n          </ResponsiveContainer>\n        </div>\n        \n        {/* Summary Stats */}\n        <div className=\"grid grid-cols-3 gap-4 mt-4 pt-4 border-t\">\n          <div className=\"text-center\">\n            <div className=\"text-lg font-bold text-primary\" data-testid=\"chart-total-entries\">\n              {weightEntries?.length || 0}\n            </div>\n            <div className=\"text-xs text-muted-foreground\">Total Entries</div>\n          </div>\n          <div className=\"text-center\">\n            <div className=\"text-lg font-bold text-primary\" data-testid=\"chart-avg-weight\">\n              {chartData.length > 0 \n                ? (chartData.reduce((sum, d) => sum + d.weight, 0) / chartData.length).toFixed(1)\n                : \"0\"\n              }kg\n            </div>\n            <div className=\"text-xs text-muted-foreground\">Average Weight</div>\n          </div>\n          <div className=\"text-center\">\n            <div className={`text-lg font-bold ${trendColor}`} data-testid=\"chart-trend-change\">\n              {trend.change >= 0 ? \"+\" : \"\"}{trend.change.toFixed(1)}kg\n            </div>\n            <div className=\"text-xs text-muted-foreground\">12-Week Change</div>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":8945},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"client/src/components/progress-indicators.tsx":{"content":"import React, { useEffect, useRef, useState } from \"react\";\nimport { Flame, Beef, Wheat, Droplets, ChevronDown } from \"lucide-react\";\nimport { Progress } from \"@/components/ui/progress\";\nimport type { NutritionGoals } from \"@shared/schema\";\n// Confetti disabled: import { ConfettiCelebration, useConfetti } from \"@/components/confetti-celebration\";\nimport { motion } from \"framer-motion\";\n\ninterface ProgressIndicatorsProps {\n  goals: NutritionGoals | undefined;\n  consumed: {\n    calories: number;\n    protein: number;\n    carbs: number;\n    fat: number;\n    water: number;\n  };\n}\n\nexport function ProgressIndicators({ goals, consumed }: ProgressIndicatorsProps) {\n  const [isExpanded, setIsExpanded] = useState(false);\n  \n  // Use default values if goals are not set - ensure UI is always visible\n  const defaultGoals = {\n    dailyCalories: 2000,\n    dailyProtein: 150,\n    dailyCarbs: 250,\n    dailyFat: 65,\n    dailyWater: 2000\n  };\n  \n  const activeGoals = goals || defaultGoals;\n\n  // Confetti disabled per user request\n  // const previousAchievements = useRef<Record<string, boolean>>({});\n  // const { shouldTrigger, triggerConfetti, resetTrigger } = useConfetti();\n\n  const calculateProgress = (consumed: number, target: number) => {\n    return Math.min((consumed / target) * 100, 100);\n  };\n\n  const getProgressColor = (progress: number) => {\n    if (progress >= 90) return \"bg-green-500\";\n    if (progress >= 70) return \"bg-yellow-500\";\n    return \"bg-blue-500\";\n  };\n\n  const progressData = [\n    {\n      icon: Flame,\n      label: \"Calories\",\n      consumed: consumed.calories,\n      target: activeGoals.dailyCalories || 2000,\n      unit: \"\",\n      testId: \"progress-calories\"\n    },\n    {\n      icon: Beef,\n      label: \"Protein\",\n      consumed: consumed.protein,\n      target: activeGoals.dailyProtein || 150,\n      unit: \"g\",\n      testId: \"progress-protein\"\n    },\n    {\n      icon: Wheat,\n      label: \"Carbs\",\n      consumed: consumed.carbs,\n      target: activeGoals.dailyCarbs || 250,\n      unit: \"g\",\n      testId: \"progress-carbs\"\n    },\n    {\n      icon: Droplets,\n      label: \"Fat\",\n      consumed: consumed.fat,\n      target: activeGoals.dailyFat || 65,\n      unit: \"g\",\n      testId: \"progress-fat\"\n    }\n  ];\n\n  // Confetti celebration disabled per user request\n  // useEffect(() => {\n  //   progressData.forEach(({ label, consumed, target }) => {\n  //     const progress = calculateProgress(consumed, target);\n  //     const isAchieved = progress >= 100;\n  //     const wasAchieved = previousAchievements.current[label] || false;\n  //     \n  //     if (isAchieved && !wasAchieved) {\n  //       triggerConfetti();\n  //       console.log(`ðŸŽ‰ ${label} goal achieved! Triggering confetti celebration`);\n  //     }\n  //     \n  //     previousAchievements.current[label] = isAchieved;\n  //   });\n  // }, [progressData, triggerConfetti]);\n\n  return (\n    <div className=\"relative\">\n      {/* Tap indicator when collapsed */}\n      {!isExpanded && (\n        <motion.div \n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          className=\"absolute -top-3 left-1/2 transform -translate-x-1/2 z-20 bg-primary/90 text-primary-foreground px-4 py-2 rounded-full text-sm font-medium shadow-lg flex items-center gap-2\"\n        >\n          <span>Tap to expand</span>\n          <ChevronDown className=\"h-4 w-4 animate-bounce\" />\n        </motion.div>\n      )}\n      \n      <div \n        className={`relative ${isExpanded ? 'space-y-6' : ''} cursor-pointer`}\n        onClick={() => setIsExpanded(!isExpanded)}\n        onKeyDown={(e) => {\n          if (e.key === 'Enter' || e.key === ' ') {\n            e.preventDefault();\n            setIsExpanded(!isExpanded);\n          }\n        }}\n        role=\"button\"\n        tabIndex={0}\n        aria-expanded={isExpanded}\n        aria-label={isExpanded ? \"Collapse nutrition cards\" : \"Expand nutrition cards\"}\n      >\n        {progressData.map(({ icon: Icon, label, consumed, target, unit, testId }, index) => {\n          const progress = calculateProgress(consumed, target);\n          const progressColor = getProgressColor(progress);\n          const isAchieved = progress >= 100;\n          \n          // Define color schemes for each nutrient\n          const colorSchemes = {\n            'Calories': {\n              bg: 'from-red-50 to-orange-50 dark:from-red-900/10 dark:to-orange-900/10',\n              icon: 'bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400',\n              text: 'text-red-700 dark:text-red-300',\n              accent: 'text-red-600 dark:text-red-400'\n            },\n            'Protein': {\n              bg: 'from-blue-50 to-indigo-50 dark:from-blue-900/10 dark:to-indigo-900/10',\n              icon: 'bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400',\n              text: 'text-blue-700 dark:text-blue-300',\n              accent: 'text-blue-600 dark:text-blue-400'\n            },\n            'Carbs': {\n              bg: 'from-orange-50 to-amber-50 dark:from-orange-900/10 dark:to-amber-900/10',\n              icon: 'bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400',\n              text: 'text-orange-700 dark:text-orange-300',\n              accent: 'text-orange-600 dark:text-orange-400'\n            },\n            'Fat': {\n              bg: 'from-yellow-50 to-amber-50 dark:from-yellow-900/10 dark:to-amber-900/10',\n              icon: 'bg-yellow-100 dark:bg-yellow-900/30 text-yellow-600 dark:text-yellow-400',\n              text: 'text-yellow-700 dark:text-yellow-300',\n              accent: 'text-yellow-600 dark:text-yellow-400'\n            }\n          };\n          \n          const colors = colorSchemes[label as keyof typeof colorSchemes];\n          \n          // Calculate stacked position when collapsed - using negative margin instead of absolute positioning\n          const stackOffset = isExpanded ? 0 : index * 2;\n          const stackScale = isExpanded ? 1 : 1 - (index * 0.01);\n          const stackOpacity = isExpanded ? 1 : (index === 0 ? 1 : 0.9);\n          const stackZIndex = isExpanded ? 10 : (4 - index);\n          const negativeMargin = !isExpanded && index > 0 ? '-228px' : '0';\n          \n          return (\n            <motion.div \n              key={label}\n              initial={{ opacity: 0, scale: 0.8, y: 30 }}\n              animate={{ \n                opacity: stackOpacity,\n                scale: stackScale,\n                y: stackOffset,\n                zIndex: stackZIndex\n              }}\n              transition={{ \n                duration: 0.4,\n                ease: \"easeOut\",\n                type: \"spring\",\n                stiffness: 150,\n                damping: 20\n              }}\n              whileHover={isExpanded ? { scale: 1.03, transition: { duration: 0.2 } } : {}}\n              className={`relative bg-gradient-to-br ${colors.bg} rounded-2xl p-6 shadow-lg border border-white/20 dark:border-gray-700/50 overflow-hidden`}\n              style={{ \n                pointerEvents: isExpanded || index === 0 ? 'auto' : 'none',\n                marginTop: negativeMargin\n              }}\n              data-testid={testId}\n            >\n            {/* Decorative background element */}\n            <div className=\"absolute -top-4 -right-4 w-20 h-20 bg-white/10 dark:bg-black/10 rounded-full\"></div>\n            \n            {/* Header with icon and label */}\n            <div className=\"flex items-center justify-between mb-4 relative z-10\">\n              <div className=\"flex items-center space-x-3\">\n                <div \n                  className={`w-12 h-12 ${colors.icon} rounded-xl flex items-center justify-center shadow-md`}\n                  aria-hidden=\"true\"\n                >\n                  <Icon className=\"h-6 w-6\" />\n                </div>\n                <div>\n                  <h3 className={`text-lg font-bold ${colors.text}`}>{label}</h3>\n                  <p className=\"text-sm text-muted-foreground\">Daily Progress</p>\n                </div>\n              </div>\n              \n              {isAchieved && (\n                <div \n                  className=\"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 px-3 py-1 rounded-full text-sm font-semibold flex items-center space-x-1\"\n                  role=\"status\"\n                  aria-label={`${label} goal achieved`}\n                >\n                  <span aria-hidden=\"true\">ðŸŽ¯</span>\n                  <span>Goal achieved!</span>\n                </div>\n              )}\n            </div>\n            \n            {/* Large consumption numbers */}\n            <div className=\"mb-4 relative z-10\">\n              <div className={`text-4xl font-bold ${colors.accent} mb-1`}>\n                {Math.round(consumed)}{unit}\n                <span className=\"text-2xl text-muted-foreground font-normal\"> / {target}{unit}</span>\n              </div>\n              <div className={`text-lg font-semibold ${colors.text}`}>\n                {Math.round(progress)}% of goal\n              </div>\n            </div>\n            \n            {/* Enhanced progress bar */}\n            <div className=\"relative z-10 space-y-2\">\n              <div \n                className=\"w-full bg-white/30 dark:bg-black/20 rounded-full h-4 shadow-inner\"\n                role=\"progressbar\"\n                aria-label={`${label} progress`}\n                aria-valuenow={Math.round(consumed)}\n                aria-valuemin={0}\n                aria-valuemax={target}\n                aria-valuetext={`${Math.round(consumed)} of ${target} ${unit}`}\n              >\n                <div \n                  className={`h-4 rounded-full transition-all duration-1000 ease-out ${\n                    isAchieved \n                      ? 'bg-gradient-to-r from-green-400 to-emerald-500' \n                      : `${progressColor.replace('bg-', 'bg-gradient-to-r from-')} to-opacity-80`\n                  } shadow-lg`}\n                  style={{width: `${Math.min(progress, 100)}%`}}\n                  aria-hidden=\"true\"\n                />\n              </div>\n              \n              {/* Progress indicator */}\n              <div className=\"flex justify-between items-center\">\n                <div className={`text-sm font-medium ${colors.text}`} aria-live=\"polite\">\n                  {progress < 50 ? 'Keep going! ðŸ’ª' : \n                   progress < 90 ? 'Almost there! ðŸš€' : \n                   isAchieved ? 'Excellent! âœ¨' : 'So close! ðŸŽ¯'}\n                </div>\n                {!isAchieved && (\n                  <div className=\"text-sm text-muted-foreground\" aria-live=\"polite\">\n                    {Math.round(target - consumed)}{unit} remaining\n                  </div>\n                )}\n              </div>\n            </div>\n          </motion.div>\n        );\n      })}\n      </div>\n    </div>\n  );\n}","size_bytes":10795},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","size_bytes":1077},"client/src/components/weight-edit-dialog.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { format } from \"date-fns\";\nimport { Calendar, Scale } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { insertWeightEntrySchema, type WeightEntry } from \"@shared/schema\";\n\n// Form schema with unit-aware validation (omit server-side fields)\nconst weightFormSchema = insertWeightEntrySchema.extend({\n  weight: z.number().min(1, \"Weight must be greater than 0\"),\n  unit: z.enum([\"kg\", \"lb\"]).default(\"kg\"),\n}).omit({ \n  weightGrams: true, // Remove weightGrams since we'll calculate it\n  userId: true, // Remove userId since it's added server-side\n}).refine((data) => {\n  // Unit-aware validation\n  if (data.unit === \"kg\") {\n    return data.weight >= 20 && data.weight <= 300;\n  } else { // lb\n    return data.weight >= 44 && data.weight <= 660; // 20-300kg in lb\n  }\n}, {\n  message: \"Weight must be reasonable for the selected unit\",\n  path: [\"weight\"],\n});\n\ntype WeightFormData = z.infer<typeof weightFormSchema>;\n\ninterface WeightEditDialogProps {\n  entry: WeightEntry | null;\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  onSuccess?: () => void;\n}\n\nexport function WeightEditDialog({ entry, open, onOpenChange, onSuccess }: WeightEditDialogProps) {\n  const [unit, setUnit] = useState<\"kg\" | \"lb\">(\"kg\");\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  // Initialize form with current entry data\n  const form = useForm<WeightFormData>({\n    resolver: zodResolver(weightFormSchema),\n    defaultValues: {\n      weight: 0,\n      unit: \"kg\",\n      loggedAt: format(new Date(), \"yyyy-MM-dd\"),\n      notes: \"\",\n    },\n  });\n\n  // Update form when entry changes\n  useEffect(() => {\n    if (entry) {\n      // Default to kg display (could be made user preference later)\n      const displayWeight = Math.round((entry.weightGrams / 1000) * 10) / 10; // Convert to kg\n      const displayUnit = \"kg\";\n      \n      form.reset({\n        weight: displayWeight,\n        unit: displayUnit,\n        loggedAt: format(new Date(entry.loggedAt), \"yyyy-MM-dd\"),\n        notes: entry.notes || \"\",\n      });\n      setUnit(displayUnit);\n    }\n  }, [entry, form]);\n\n  const updateWeightMutation = useMutation({\n    mutationFn: async (data: WeightFormData) => {\n      if (!entry) throw new Error(\"No entry to update\");\n      \n      // Calculate weight in grams for storage\n      const weightGrams = data.unit === \"kg\" \n        ? Math.round(data.weight * 1000)\n        : Math.round(data.weight * 453.592);\n\n      const updateData = {\n        weightGrams,\n        loggedAt: data.loggedAt,\n        notes: data.notes || null,\n      };\n\n      return apiRequest(\"PATCH\", `/api/weights/${entry.id}`, updateData);\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Success\",\n        description: \"Weight entry updated successfully.\",\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/weights'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges/points'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges/streak'] });\n      onOpenChange(false);\n      onSuccess?.();\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update weight entry\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: WeightFormData) => {\n    updateWeightMutation.mutate(data);\n  };\n\n  const handleUnitChange = (newUnit: \"kg\" | \"lb\") => {\n    const currentWeight = form.getValues(\"weight\");\n    \n    // Only convert if units are actually different and weight is valid\n    if (currentWeight > 0 && unit !== newUnit) {\n      const convertedWeight = unit === \"kg\" && newUnit === \"lb\"\n        ? currentWeight * 2.20462 // kg to lb\n        : unit === \"lb\" && newUnit === \"kg\"\n        ? currentWeight * 0.453592 // lb to kg\n        : currentWeight; // fallback - no conversion\n      \n      form.setValue(\"weight\", Math.round(convertedWeight * 10) / 10);\n    }\n    \n    // Update unit state\n    setUnit(newUnit);\n    form.setValue(\"unit\", newUnit);\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-md\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center space-x-2\">\n            <Scale className=\"h-5 w-5 text-blue-600\" />\n            <span>Edit Weight Entry</span>\n          </DialogTitle>\n          <DialogDescription>\n            Update your weight entry details below.\n          </DialogDescription>\n        </DialogHeader>\n\n        <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n          {/* Date Input */}\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"loggedAt\" data-testid=\"label-edit-date\">Date</Label>\n            <div className=\"relative\">\n              <Input\n                id=\"loggedAt\"\n                type=\"date\"\n                {...form.register(\"loggedAt\")}\n                className=\"pr-10\"\n                data-testid=\"input-edit-date\"\n              />\n              <Calendar className=\"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground pointer-events-none\" />\n            </div>\n            {form.formState.errors.loggedAt && (\n              <p className=\"text-sm text-red-500\" data-testid=\"error-edit-date\">\n                {form.formState.errors.loggedAt.message}\n              </p>\n            )}\n          </div>\n\n          {/* Weight Input */}\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"weight\" data-testid=\"label-edit-weight\">Weight</Label>\n            <div className=\"flex space-x-2\">\n              <div className=\"flex-1 relative\">\n                <Input\n                  id=\"weight\"\n                  type=\"number\"\n                  step=\"0.1\"\n                  placeholder=\"Enter weight\"\n                  {...form.register(\"weight\", { valueAsNumber: true })}\n                  className=\"pr-12\"\n                  data-testid=\"input-edit-weight\"\n                />\n              </div>\n              <Select value={unit} onValueChange={handleUnitChange}>\n                <SelectTrigger className=\"w-20\" data-testid=\"select-edit-unit\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"kg\">kg</SelectItem>\n                  <SelectItem value=\"lb\">lb</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n            {form.formState.errors.weight && (\n              <p className=\"text-sm text-red-500\" data-testid=\"error-edit-weight\">\n                {form.formState.errors.weight.message}\n              </p>\n            )}\n          </div>\n\n          {/* Notes Input */}\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"notes\" data-testid=\"label-edit-notes\">Notes (Optional)</Label>\n            <Textarea\n              id=\"notes\"\n              placeholder=\"Add notes about your weigh-in...\"\n              {...form.register(\"notes\")}\n              rows={3}\n              data-testid=\"input-edit-notes\"\n            />\n          </div>\n\n          {/* Action Buttons */}\n          <div className=\"flex justify-end space-x-2\">\n            <Button \n              type=\"button\" \n              variant=\"outline\" \n              onClick={() => onOpenChange(false)}\n              data-testid=\"button-cancel-edit\"\n            >\n              Cancel\n            </Button>\n            <Button \n              type=\"submit\" \n              disabled={updateWeightMutation.isPending}\n              data-testid=\"button-save-edit\"\n            >\n              {updateWeightMutation.isPending ? \"Updating...\" : \"Update Entry\"}\n            </Button>\n          </div>\n        </form>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":8491},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":772},"ios/App/App/public/cordova.js":{"content":"","size_bytes":0},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { ErrorBoundary } from \"@/components/error-boundary\";\nimport { SubscriptionProvider } from \"@/contexts/SubscriptionContext\";\nimport { SubscriptionGate } from \"@/components/SubscriptionGate\";\nimport App from \"./App\";\nimport \"./index.css\";\n\n// CRITICAL: Override ResizeObserver to completely suppress benign loop errors\nconst OriginalResizeObserver = window.ResizeObserver;\nwindow.ResizeObserver = class SilentResizeObserver extends OriginalResizeObserver {\n  constructor(callback: ResizeObserverCallback) {\n    const wrappedCallback: ResizeObserverCallback = (entries, observer) => {\n      window.requestAnimationFrame(() => {\n        callback(entries, observer);\n      });\n    };\n    super(wrappedCallback);\n  }\n};\n\n// CRITICAL: Global error handlers to prevent Android WebView crashes\n// Android WebView crashes on uncaught promise rejections and JS errors\nwindow.addEventListener('unhandledrejection', (event) => {\n  console.error('ðŸš¨ Unhandled Promise Rejection (prevented WebView crash):', event.reason);\n  event.preventDefault(); // Prevent crash\n});\n\nwindow.addEventListener('error', (event) => {\n  // Ignore benign ResizeObserver errors that are common with UI libraries\n  if (event.message && (\n    event.message.includes('ResizeObserver loop') ||\n    event.message.includes('ResizeObserver loop completed with undelivered notifications')\n  )) {\n    event.stopImmediatePropagation();\n    event.preventDefault();\n    return false;\n  }\n  \n  console.error('ðŸš¨ Uncaught Error (prevented WebView crash):', event.error);\n  event.preventDefault(); // Prevent crash\n}, true); // Use capture phase to catch errors early\n\ncreateRoot(document.getElementById(\"root\")!).render(\n  <ErrorBoundary>\n    <QueryClientProvider client={queryClient}>\n      <SubscriptionProvider>\n        <SubscriptionGate>\n          <App />\n        </SubscriptionGate>\n      </SubscriptionProvider>\n    </QueryClientProvider>\n  </ErrorBoundary>\n);\n","size_bytes":2087},"client/src/lib/media-service.ts":{"content":"import { Camera, CameraResultType, CameraSource, Photo } from '@capacitor/camera';\nimport { Capacitor } from '@capacitor/core';\nimport { Device } from '@capacitor/device';\n\n// Enhanced media service for camera and microphone functionality\nexport interface MediaPermissions {\n  camera: boolean;\n  microphone: boolean;\n}\n\nexport interface CapacitorCameraOptions {\n  quality?: number;\n  allowEditing?: boolean;\n  resultType?: CameraResultType;\n  source?: CameraSource;\n}\n\nexport interface CameraConstraints {\n  width?: number;\n  height?: number;\n  facingMode?: 'user' | 'environment';\n  aspectRatio?: number;\n}\n\nexport interface AudioConstraints {\n  echoCancellation?: boolean;\n  noiseSuppression?: boolean;\n  autoGainControl?: boolean;\n  sampleRate?: number;\n}\n\nexport class MediaService {\n  private static instance: MediaService;\n  private cameraStream: MediaStream | null = null;\n  private microphoneStream: MediaStream | null = null;\n  private mediaRecorder: MediaRecorder | null = null;\n  private recordingChunks: Blob[] = [];\n  private audioContext: AudioContext | null = null;\n  private isMediaRecorderSupported: boolean = false;\n  private availableCameras: MediaDeviceInfo[] = [];\n  private currentCameraIndex: number = 0;\n\n  static getInstance(): MediaService {\n    if (!MediaService.instance) {\n      MediaService.instance = new MediaService();\n    }\n    return MediaService.instance;\n  }\n\n  constructor() {\n    // Feature detection on initialization\n    this.isMediaRecorderSupported = this.checkMediaRecorderSupport();\n  }\n\n  // Check if getUserMedia is supported\n  isMediaSupported(): boolean {\n    return !!(navigator.mediaDevices && navigator.mediaDevices.getUserMedia);\n  }\n\n  // Check if we're in a secure context (HTTPS or localhost)\n  isSecureContext(): boolean {\n    return window.isSecureContext || location.protocol === 'https:' || location.hostname === 'localhost';\n  }\n\n  // Check MediaRecorder support with detailed feature detection\n  checkMediaRecorderSupport(): boolean {\n    if (typeof MediaRecorder === 'undefined') {\n      console.warn('âš ï¸ MediaRecorder not available in this browser');\n      return false;\n    }\n\n    // Test if any supported MIME types are available\n    const testTypes = [\n      'audio/webm;codecs=opus',\n      'audio/webm',\n      'audio/mp4',\n      'audio/ogg;codecs=opus',\n      'audio/wav'\n    ];\n\n    const supportedType = testTypes.find(type => MediaRecorder.isTypeSupported(type));\n    if (!supportedType) {\n      console.warn('âš ï¸ No supported MediaRecorder MIME types found');\n      return false;\n    }\n\n    console.log('âœ… MediaRecorder supported with type:', supportedType);\n    return true;\n  }\n\n  // Get available cameras\n  async getAvailableCameras(): Promise<MediaDeviceInfo[]> {\n    if (!this.isMediaSupported()) {\n      return [];\n    }\n\n    try {\n      const devices = await navigator.mediaDevices.enumerateDevices();\n      this.availableCameras = devices.filter(device => device.kind === 'videoinput');\n      \n      console.log('ðŸ“¹ Available cameras:', this.availableCameras.map(cam => ({ \n        label: cam.label || 'Camera', \n        deviceId: cam.deviceId.substring(0, 8) + '...' \n      })));\n      \n      return this.availableCameras;\n    } catch (error) {\n      console.error('âŒ Failed to enumerate cameras:', error);\n      return [];\n    }\n  }\n\n  // Check current permissions\n  async checkPermissions(): Promise<MediaPermissions> {\n    const permissions: MediaPermissions = {\n      camera: false,\n      microphone: false\n    };\n\n    if (!this.isMediaSupported()) {\n      return permissions;\n    }\n\n    try {\n      // Check camera permission\n      const cameraPermission = await navigator.permissions.query({ name: 'camera' as PermissionName });\n      permissions.camera = cameraPermission.state === 'granted';\n    } catch (error) {\n      console.warn('Could not check camera permission:', error);\n    }\n\n    try {\n      // Check microphone permission\n      const microphonePermission = await navigator.permissions.query({ name: 'microphone' as PermissionName });\n      permissions.microphone = microphonePermission.state === 'granted';\n    } catch (error) {\n      console.warn('Could not check microphone permission:', error);\n    }\n\n    return permissions;\n  }\n\n  // Start camera stream with live preview\n  async startCamera(\n    videoElement: HTMLVideoElement, \n    constraints: CameraConstraints = {}\n  ): Promise<MediaStream> {\n    if (!this.isMediaSupported()) {\n      throw new Error('Camera not supported in this browser');\n    }\n\n    try {\n      // Stop existing camera stream\n      if (this.cameraStream) {\n        this.stopCamera();\n      }\n\n      // Default constraints optimized for mobile\n      const defaultConstraints: MediaStreamConstraints = {\n        video: {\n          width: { ideal: constraints.width || 1280, max: 1920 },\n          height: { ideal: constraints.height || 720, max: 1080 },\n          facingMode: constraints.facingMode || 'environment', // Back camera by default\n          aspectRatio: constraints.aspectRatio || 16/9\n        },\n        audio: false // Camera stream doesn't need audio\n      };\n\n      console.log('ðŸŽ¥ Requesting camera with constraints:', defaultConstraints);\n      \n      this.cameraStream = await navigator.mediaDevices.getUserMedia(defaultConstraints);\n      \n      console.log('ðŸ“¹ Camera stream started successfully:', {\n        tracks: this.cameraStream.getTracks().length,\n        videoTracks: this.cameraStream.getVideoTracks().length\n      });\n\n      // Set up video element\n      videoElement.srcObject = this.cameraStream;\n      videoElement.playsInline = true; // Important for iOS Safari\n      videoElement.muted = true; // Prevent audio feedback\n      \n      // Wait for video to be ready\n      await new Promise((resolve, reject) => {\n        videoElement.onloadedmetadata = () => {\n          console.log('ðŸ“ Video dimensions:', {\n            videoWidth: videoElement.videoWidth,\n            videoHeight: videoElement.videoHeight\n          });\n          resolve(void 0);\n        };\n        videoElement.onerror = reject;\n        videoElement.play().catch(reject);\n      });\n\n      return this.cameraStream;\n    } catch (error) {\n      console.error('âŒ Camera access failed:', error);\n      this.handleMediaError(error, 'camera');\n      throw error;\n    }\n  }\n\n  // Stop camera stream\n  stopCamera(): void {\n    if (this.cameraStream) {\n      console.log('â¹ï¸ Stopping camera stream');\n      this.cameraStream.getTracks().forEach(track => {\n        track.stop();\n        console.log(`ðŸ”´ Stopped ${track.kind} track`);\n      });\n      this.cameraStream = null;\n    }\n  }\n\n  // Capture photo from video stream (async)\n  async capturePhotoFromStream(videoElement: HTMLVideoElement, quality: number = 0.9): Promise<Blob> {\n    if (!this.cameraStream || !videoElement.videoWidth) {\n      console.error('âŒ No active camera stream or video not ready');\n      throw new Error('No active camera stream or video not ready');\n    }\n\n    try {\n      // Create canvas to capture the frame\n      const canvas = document.createElement('canvas');\n      const ctx = canvas.getContext('2d');\n      \n      if (!ctx) {\n        throw new Error('Could not get canvas context');\n      }\n\n      // Set canvas size to match video\n      canvas.width = videoElement.videoWidth;\n      canvas.height = videoElement.videoHeight;\n\n      // Draw current video frame to canvas\n      ctx.drawImage(videoElement, 0, 0, canvas.width, canvas.height);\n\n      console.log('ðŸ“¸ Photo captured from stream:', {\n        width: canvas.width,\n        height: canvas.height,\n        quality\n      });\n\n      // Convert to blob (properly async)\n      return new Promise<Blob>((resolve, reject) => {\n        canvas.toBlob((blob) => {\n          if (blob) {\n            resolve(blob);\n          } else {\n            reject(new Error('Failed to create photo blob'));\n          }\n        }, 'image/jpeg', quality);\n      });\n    } catch (error) {\n      console.error('âŒ Failed to capture photo:', error);\n      throw error;\n    }\n  }\n\n  // Switch camera using device enumeration (more reliable than facingMode)\n  async switchCamera(videoElement: HTMLVideoElement): Promise<void> {\n    if (!this.cameraStream) {\n      throw new Error('No active camera stream to switch');\n    }\n\n    try {\n      // Get available cameras if not already loaded\n      if (this.availableCameras.length === 0) {\n        await this.getAvailableCameras();\n      }\n\n      if (this.availableCameras.length < 2) {\n        throw new Error('Only one camera available, cannot switch');\n      }\n\n      // Switch to next camera\n      this.currentCameraIndex = (this.currentCameraIndex + 1) % this.availableCameras.length;\n      const nextCamera = this.availableCameras[this.currentCameraIndex];\n      \n      console.log('ðŸ”„ Switching to camera:', {\n        index: this.currentCameraIndex,\n        label: nextCamera.label || 'Unknown Camera',\n        deviceId: nextCamera.deviceId.substring(0, 8) + '...'\n      });\n\n      // Stop current stream and start new one with specific device\n      this.stopCamera();\n      await this.startCameraWithDeviceId(videoElement, nextCamera.deviceId);\n      \n    } catch (error) {\n      console.error('âŒ Failed to switch camera:', error);\n      // Fallback to facingMode switching for older browsers\n      await this.fallbackSwitchCamera(videoElement);\n    }\n  }\n\n  // Fallback camera switching using facingMode\n  private async fallbackSwitchCamera(videoElement: HTMLVideoElement): Promise<void> {\n    const videoTrack = this.cameraStream?.getVideoTracks()[0];\n    if (!videoTrack) {\n      throw new Error('No video track found for fallback switch');\n    }\n\n    const currentConstraints = videoTrack.getConstraints();\n    const currentFacingMode = currentConstraints.facingMode;\n    \n    // Toggle between front and back camera\n    const newFacingMode = currentFacingMode === 'user' ? 'environment' : 'user';\n    \n    console.log('ðŸ”„ Fallback camera switch from', currentFacingMode, 'to', newFacingMode);\n\n    this.stopCamera();\n    await this.startCamera(videoElement, { facingMode: newFacingMode });\n  }\n\n  // Start camera with specific device ID\n  private async startCameraWithDeviceId(\n    videoElement: HTMLVideoElement, \n    deviceId: string\n  ): Promise<MediaStream> {\n    const constraints: MediaStreamConstraints = {\n      video: {\n        deviceId: { exact: deviceId },\n        width: { ideal: 1280, max: 1920 },\n        height: { ideal: 720, max: 1080 }\n      },\n      audio: false\n    };\n\n    console.log('ðŸ“¹ Starting camera with device ID:', deviceId.substring(0, 8) + '...');\n    \n    this.cameraStream = await navigator.mediaDevices.getUserMedia(constraints);\n    \n    videoElement.srcObject = this.cameraStream;\n    videoElement.playsInline = true;\n    videoElement.muted = true;\n    \n    await new Promise((resolve, reject) => {\n      videoElement.onloadedmetadata = resolve;\n      videoElement.onerror = reject;\n      videoElement.play().catch(reject);\n    });\n\n    return this.cameraStream;\n  }\n\n  // Start microphone recording\n  async startMicrophoneRecording(constraints: AudioConstraints = {}): Promise<MediaStream> {\n    if (!this.isMediaSupported()) {\n      throw new Error('Microphone not supported in this browser');\n    }\n\n    try {\n      // Stop existing microphone stream\n      if (this.microphoneStream) {\n        this.stopMicrophone();\n      }\n\n      const defaultConstraints: MediaStreamConstraints = {\n        audio: {\n          echoCancellation: constraints.echoCancellation ?? true,\n          noiseSuppression: constraints.noiseSuppression ?? true,\n          autoGainControl: constraints.autoGainControl ?? true,\n          sampleRate: constraints.sampleRate || 44100\n        },\n        video: false\n      };\n\n      console.log('ðŸŽ¤ Requesting microphone with constraints:', defaultConstraints);\n      \n      this.microphoneStream = await navigator.mediaDevices.getUserMedia(defaultConstraints);\n      \n      console.log('ðŸŽ™ï¸ Microphone stream started successfully:', {\n        tracks: this.microphoneStream.getTracks().length,\n        audioTracks: this.microphoneStream.getAudioTracks().length\n      });\n\n      return this.microphoneStream;\n    } catch (error) {\n      console.error('âŒ Microphone access failed:', error);\n      this.handleMediaError(error, 'microphone');\n      throw error;\n    }\n  }\n\n  // Start recording audio with MediaRecorder fallback for iOS Safari\n  async startAudioRecording(): Promise<void> {\n    if (!this.microphoneStream) {\n      await this.startMicrophoneRecording();\n    }\n\n    if (!this.microphoneStream) {\n      throw new Error('No microphone stream available');\n    }\n\n    try {\n      // Clear previous recording\n      this.recordingChunks = [];\n\n      if (this.isMediaRecorderSupported) {\n        // Use MediaRecorder for supported browsers\n        await this.startMediaRecorderRecording();\n      } else {\n        // Use Web Audio API fallback for iOS Safari\n        await this.startWebAudioRecording();\n      }\n    } catch (error) {\n      console.error('âŒ Failed to start audio recording:', error);\n      throw error;\n    }\n  }\n\n  // MediaRecorder-based recording\n  private async startMediaRecorderRecording(): Promise<void> {\n    if (!this.microphoneStream) {\n      throw new Error('No microphone stream available');\n    }\n\n    this.mediaRecorder = new MediaRecorder(this.microphoneStream, {\n      mimeType: this.getSupportedMimeType()\n    });\n\n    console.log('ðŸŽ¬ Starting audio recording with MediaRecorder');\n\n    this.mediaRecorder.ondataavailable = (event) => {\n      if (event.data.size > 0) {\n        this.recordingChunks.push(event.data);\n        console.log('ðŸ“Š Audio chunk received:', event.data.size, 'bytes');\n      }\n    };\n\n    this.mediaRecorder.start(100); // Collect data every 100ms\n  }\n\n  // Web Audio API fallback for iOS Safari\n  private async startWebAudioRecording(): Promise<void> {\n    if (!this.microphoneStream) {\n      throw new Error('No microphone stream available');\n    }\n\n    try {\n      // Create AudioContext\n      this.audioContext = new (window.AudioContext || (window as any).webkitAudioContext)();\n      \n      console.log('ðŸŽ¤ Starting Web Audio API recording (iOS Safari fallback)');\n\n      // Create audio source from stream\n      const source = this.audioContext.createMediaStreamSource(this.microphoneStream);\n      \n      // Use ScriptProcessor for older browsers, AudioWorklet for newer ones\n      if (this.audioContext.audioWorklet) {\n        await this.setupAudioWorkletRecording(source);\n      } else {\n        this.setupScriptProcessorRecording(source);\n      }\n\n    } catch (error) {\n      console.error('âŒ Failed to start Web Audio recording:', error);\n      throw error;\n    }\n  }\n\n  // Modern AudioWorklet recording\n  private async setupAudioWorkletRecording(source: MediaStreamAudioSourceNode): Promise<void> {\n    // For now, fallback to ScriptProcessor as AudioWorklet requires separate files\n    // This would need a separate worklet file for production use\n    this.setupScriptProcessorRecording(source);\n  }\n\n  // Legacy ScriptProcessor recording for iOS Safari\n  private setupScriptProcessorRecording(source: MediaStreamAudioSourceNode): void {\n    if (!this.audioContext) return;\n\n    const bufferSize = 4096;\n    const sampleRate = this.audioContext.sampleRate;\n    \n    // Store samples for later conversion to WAV\n    const recordedSamples: number[] = [];\n\n    const scriptProcessor = this.audioContext.createScriptProcessor(bufferSize, 1, 1);\n    \n    scriptProcessor.onaudioprocess = (event) => {\n      const inputBuffer = event.inputBuffer;\n      const inputData = inputBuffer.getChannelData(0);\n      \n      // Store samples\n      for (let i = 0; i < inputData.length; i++) {\n        recordedSamples.push(inputData[i]);\n      }\n    };\n\n    // Connect the audio graph\n    source.connect(scriptProcessor);\n    scriptProcessor.connect(this.audioContext.destination);\n\n    // Store reference for stopping\n    (this as any).scriptProcessor = scriptProcessor;\n    (this as any).recordedSamples = recordedSamples;\n    (this as any).sampleRate = sampleRate;\n\n    console.log('ðŸŽ™ï¸ ScriptProcessor recording setup complete');\n  }\n\n  // Stop recording audio and return blob\n  async stopAudioRecording(): Promise<Blob> {\n    if (this.isMediaRecorderSupported && this.mediaRecorder) {\n      return this.stopMediaRecorderRecording();\n    } else if (this.audioContext) {\n      return this.stopWebAudioRecording();\n    } else {\n      throw new Error('No active recording to stop');\n    }\n  }\n\n  // Stop MediaRecorder recording\n  private stopMediaRecorderRecording(): Promise<Blob> {\n    return new Promise((resolve, reject) => {\n      if (!this.mediaRecorder) {\n        reject(new Error('No MediaRecorder active'));\n        return;\n      }\n\n      this.mediaRecorder.onstop = () => {\n        console.log('â¹ï¸ MediaRecorder recording stopped, combining chunks...');\n        const blob = new Blob(this.recordingChunks, { \n          type: this.getSupportedMimeType() \n        });\n        \n        console.log('ðŸŽµ Audio recording completed:', {\n          size: blob.size,\n          type: blob.type,\n          chunks: this.recordingChunks.length\n        });\n        \n        resolve(blob);\n      };\n\n      this.mediaRecorder.stop();\n    });\n  }\n\n  // Stop Web Audio recording and convert to WAV\n  private stopWebAudioRecording(): Promise<Blob> {\n    return new Promise((resolve, reject) => {\n      try {\n        const scriptProcessor = (this as any).scriptProcessor;\n        const recordedSamples = (this as any).recordedSamples as number[];\n        const sampleRate = (this as any).sampleRate as number;\n\n        if (!scriptProcessor || !recordedSamples || !sampleRate) {\n          reject(new Error('Web Audio recording data not found'));\n          return;\n        }\n\n        console.log('â¹ï¸ Web Audio recording stopped, converting to WAV...', {\n          samples: recordedSamples.length,\n          sampleRate\n        });\n\n        // Disconnect audio graph\n        scriptProcessor.disconnect();\n\n        // Convert samples to WAV blob\n        const wavBlob = this.convertSamplesToWAV(recordedSamples, sampleRate);\n        \n        console.log('ðŸŽµ Web Audio recording converted to WAV:', {\n          size: wavBlob.size,\n          type: wavBlob.type\n        });\n\n        // Cleanup\n        delete (this as any).scriptProcessor;\n        delete (this as any).recordedSamples;\n        delete (this as any).sampleRate;\n\n        resolve(wavBlob);\n      } catch (error) {\n        console.error('âŒ Failed to stop Web Audio recording:', error);\n        reject(error);\n      }\n    });\n  }\n\n  // Convert PCM samples to WAV format\n  private convertSamplesToWAV(samples: number[], sampleRate: number): Blob {\n    const length = samples.length;\n    const buffer = new ArrayBuffer(44 + length * 2);\n    const view = new DataView(buffer);\n\n    // WAV header\n    const writeString = (offset: number, string: string) => {\n      for (let i = 0; i < string.length; i++) {\n        view.setUint8(offset + i, string.charCodeAt(i));\n      }\n    };\n\n    writeString(0, 'RIFF');\n    view.setUint32(4, 36 + length * 2, true);\n    writeString(8, 'WAVE');\n    writeString(12, 'fmt ');\n    view.setUint32(16, 16, true);\n    view.setUint16(20, 1, true);\n    view.setUint16(22, 1, true);\n    view.setUint32(24, sampleRate, true);\n    view.setUint32(28, sampleRate * 2, true);\n    view.setUint16(32, 2, true);\n    view.setUint16(34, 16, true);\n    writeString(36, 'data');\n    view.setUint32(40, length * 2, true);\n\n    // Convert float samples to 16-bit PCM\n    let offset = 44;\n    for (let i = 0; i < length; i++) {\n      const sample = Math.max(-1, Math.min(1, samples[i]));\n      view.setInt16(offset, sample * 0x7FFF, true);\n      offset += 2;\n    }\n\n    return new Blob([buffer], { type: 'audio/wav' });\n  }\n\n  // Stop microphone\n  stopMicrophone(): void {\n    if (this.microphoneStream) {\n      console.log('â¹ï¸ Stopping microphone stream');\n      this.microphoneStream.getTracks().forEach(track => {\n        track.stop();\n        console.log(`ðŸ”´ Stopped ${track.kind} track`);\n      });\n      this.microphoneStream = null;\n    }\n\n    if (this.mediaRecorder && this.mediaRecorder.state !== 'inactive') {\n      this.mediaRecorder.stop();\n    }\n  }\n\n  // Play audio blob\n  playAudio(audioBlob: Blob): HTMLAudioElement {\n    const audioUrl = URL.createObjectURL(audioBlob);\n    const audio = new Audio(audioUrl);\n    \n    audio.play().catch(error => {\n      console.error('âŒ Failed to play audio:', error);\n    });\n\n    // Clean up URL after playing\n    audio.addEventListener('ended', () => {\n      URL.revokeObjectURL(audioUrl);\n    });\n\n    return audio;\n  }\n\n  // Get supported MIME type for recording\n  private getSupportedMimeType(): string {\n    const types = [\n      'audio/webm;codecs=opus',\n      'audio/webm',\n      'audio/mp4',\n      'audio/ogg;codecs=opus',\n      'audio/wav'\n    ];\n\n    for (const type of types) {\n      if (MediaRecorder.isTypeSupported(type)) {\n        console.log('ðŸŽ¯ Using MIME type:', type);\n        return type;\n      }\n    }\n\n    console.warn('âš ï¸ No supported MIME type found, using default');\n    return 'audio/webm';\n  }\n\n  // Handle media errors with user-friendly messages\n  private handleMediaError(error: any, mediaType: 'camera' | 'microphone'): void {\n    let message = `Unable to access ${mediaType}`;\n    \n    if (error.name === 'NotAllowedError') {\n      message = `${mediaType.charAt(0).toUpperCase() + mediaType.slice(1)} access was denied. Please allow ${mediaType} permissions in your browser settings.`;\n    } else if (error.name === 'NotFoundError') {\n      message = `No ${mediaType} found on this device.`;\n    } else if (error.name === 'NotSupportedError') {\n      message = `${mediaType.charAt(0).toUpperCase() + mediaType.slice(1)} is not supported in this browser.`;\n    } else if (error.name === 'NotReadableError') {\n      message = `${mediaType.charAt(0).toUpperCase() + mediaType.slice(1)} is being used by another application.`;\n    } else if (error.name === 'OverconstrainedError') {\n      message = `${mediaType.charAt(0).toUpperCase() + mediaType.slice(1)} settings are not supported on this device.`;\n    } else if (error.name === 'SecurityError') {\n      message = `${mediaType.charAt(0).toUpperCase() + mediaType.slice(1)} access blocked for security reasons. Please use HTTPS.`;\n    }\n\n    console.error(`âŒ ${mediaType} error:`, message, error);\n  }\n\n  // Capacitor Camera Methods\n  async takePhoto(options: CapacitorCameraOptions = {}): Promise<Photo> {\n    if (!Capacitor.isNativePlatform()) {\n      console.log('ðŸ“± Web platform - using Capacitor Camera for web');\n    } else {\n      console.log('ðŸ“± Native platform - using native camera');\n    }\n\n    const defaultOptions = {\n      quality: options.quality || 90,\n      allowEditing: options.allowEditing || false,\n      resultType: options.resultType || CameraResultType.Uri,\n      source: options.source || CameraSource.Camera,\n    };\n\n    try {\n      const image = await Camera.getPhoto(defaultOptions);\n      console.log('ðŸ“¸ Photo captured successfully:', {\n        format: image.format,\n        webPath: image.webPath ? 'available' : 'none'\n      });\n      return image;\n    } catch (error) {\n      console.error('âŒ Camera error:', error);\n      throw new Error(`Failed to take photo: ${error}`);\n    }\n  }\n\n  async selectFromGallery(options: CapacitorCameraOptions = {}): Promise<Photo> {\n    console.log('ðŸ–¼ï¸ Selecting from photo gallery...');\n\n    const galleryOptions = {\n      quality: options.quality || 90,\n      allowEditing: options.allowEditing || false,\n      resultType: options.resultType || CameraResultType.Uri,\n      source: CameraSource.Photos,\n    };\n\n    try {\n      const image = await Camera.getPhoto(galleryOptions);\n      console.log('ðŸ“· Gallery photo selected successfully');\n      return image;\n    } catch (error) {\n      console.error('âŒ Gallery selection error:', error);\n      throw new Error(`Failed to select from gallery: ${error}`);\n    }\n  }\n\n  async checkCameraPermissions(): Promise<boolean> {\n    try {\n      const permissions = await Camera.checkPermissions();\n      console.log('ðŸ“‹ Camera permissions status:', permissions);\n      \n      if (permissions.camera === 'granted' && permissions.photos === 'granted') {\n        return true;\n      }\n      \n      // Request permissions if not granted\n      const requestResult = await Camera.requestPermissions();\n      console.log('ðŸ“‹ Permission request result:', requestResult);\n      \n      return requestResult.camera === 'granted' && requestResult.photos === 'granted';\n    } catch (error) {\n      console.error('âŒ Permission check error:', error);\n      return false;\n    }\n  }\n\n  async getDeviceInfo() {\n    try {\n      const info = await Device.getInfo();\n      console.log('ðŸ“± Device info:', {\n        platform: info.platform,\n        isVirtual: info.isVirtual,\n        model: info.model\n      });\n      return info;\n    } catch (error) {\n      console.error('âŒ Device info error:', error);\n      return null;\n    }\n  }\n\n  isNativePlatform(): boolean {\n    return Capacitor.isNativePlatform();\n  }\n\n  isPlatform(platform: string): boolean {\n    return Capacitor.getPlatform() === platform;\n  }\n\n  // Clean up all media resources\n  cleanup(): void {\n    this.stopCamera();\n    this.stopMicrophone();\n    \n    // Clean up MediaRecorder\n    if (this.mediaRecorder) {\n      this.mediaRecorder = null;\n    }\n    \n    this.recordingChunks = [];\n    console.log('ðŸ§¹ Media service cleaned up');\n  }\n}\n\n// Export singleton instance\nexport const mediaService = MediaService.getInstance();","size_bytes":25693},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"server/services/usda-service.ts":{"content":"// Use Node.js built-in fetch (available in Node 18+)\n\nexport interface USDAFood {\n  fdcId: number;\n  description: string;\n  foodNutrients: {\n    nutrient: {\n      id: number;\n      number: string;\n      name: string;\n      rank: number;\n      unitName: string;\n    };\n    amount: number;\n  }[];\n  servingSize?: number;\n  servingSizeUnit?: string;\n  householdServingFullText?: string;\n}\n\nexport interface USDASearchResult {\n  foods: USDAFood[];\n  totalHits: number;\n  currentPage: number;\n  totalPages: number;\n}\n\nexport interface NutritionData {\n  calories: number;\n  protein: number; // grams\n  carbs: number;   // grams\n  fat: number;     // grams\n  fiber?: number;  // grams\n  sugar?: number;  // grams\n  sodium?: number; // mg\n}\n\nexport class USDAService {\n  private apiKey: string;\n  private baseUrl = 'https://api.nal.usda.gov/fdc/v1';\n  private cache = new Map<string, any>();\n  private cacheTimeout = 60 * 60 * 1000; // 1 hour\n\n  constructor() {\n    this.apiKey = process.env.USDA_API_KEY || '';\n    if (!this.apiKey) {\n      console.warn('USDA_API_KEY not found in environment variables');\n    }\n  }\n\n  /**\n   * Search for foods in the USDA database\n   */\n  async searchFoods(query: string, pageSize: number = 25): Promise<USDASearchResult> {\n    if (!this.apiKey) {\n      throw new Error('USDA API key not configured');\n    }\n\n    const cacheKey = `search:${query}:${pageSize}`;\n    const cached = this.getFromCache(cacheKey);\n    if (cached) {\n      console.log(`ðŸ“‹ USDA search cache hit for: ${query}`);\n      return cached;\n    }\n\n    try {\n      console.log(`ðŸ” Searching USDA database for: ${query}`);\n      \n      const url = `${this.baseUrl}/foods/search?api_key=${this.apiKey}&query=${encodeURIComponent(query)}&pageSize=${pageSize}&dataType=Foundation,SR%20Legacy,Survey%20%28FNDDS%29`;\n      \n      const response = await fetch(url);\n      \n      if (!response.ok) {\n        if (response.status === 429) {\n          throw new Error('USDA API rate limit exceeded');\n        }\n        throw new Error(`USDA API error: ${response.status} ${response.statusText}`);\n      }\n\n      const data = await response.json() as USDASearchResult;\n      \n      // Cache the result\n      this.setCache(cacheKey, data);\n      \n      console.log(`âœ… Found ${data.foods.length} foods in USDA database for: ${query}`);\n      return data;\n\n    } catch (error: any) {\n      console.error(`âŒ USDA search failed for \"${query}\":`, error.message);\n      throw error;\n    }\n  }\n\n  /**\n   * Get detailed nutrition information for a specific food\n   */\n  async getFoodDetails(fdcId: number): Promise<USDAFood> {\n    if (!this.apiKey) {\n      throw new Error('USDA API key not configured');\n    }\n\n    const cacheKey = `food:${fdcId}`;\n    const cached = this.getFromCache(cacheKey);\n    if (cached) {\n      console.log(`ðŸ“‹ USDA food cache hit for ID: ${fdcId}`);\n      return cached;\n    }\n\n    try {\n      console.log(`ðŸ“Š Getting USDA food details for ID: ${fdcId}`);\n      \n      const url = `${this.baseUrl}/food/${fdcId}?api_key=${this.apiKey}`;\n      const response = await fetch(url);\n      \n      if (!response.ok) {\n        if (response.status === 429) {\n          throw new Error('USDA API rate limit exceeded');\n        }\n        throw new Error(`USDA API error: ${response.status} ${response.statusText}`);\n      }\n\n      const data = await response.json() as USDAFood;\n      \n      // Cache the result\n      this.setCache(cacheKey, data);\n      \n      console.log(`âœ… Retrieved USDA food details for: ${data.description}`);\n      return data;\n\n    } catch (error: any) {\n      console.error(`âŒ USDA food details failed for ID ${fdcId}:`, error.message);\n      throw error;\n    }\n  }\n\n  /**\n   * Extract standard nutrition data from USDA food object\n   */\n  extractNutritionData(usdaFood: USDAFood, portionGrams: number = 100): NutritionData {\n    const nutrients = usdaFood.foodNutrients;\n    \n    // USDA nutrient IDs for key macronutrients\n    const findNutrient = (numbers: string[], label: string) => {\n      for (const number of numbers) {\n        const nutrient = nutrients.find(n => n.nutrient && n.nutrient.number === number);\n        if (nutrient) {\n          console.log(`  ${label} (${number}):`, nutrient.amount || 0, nutrient);\n          return nutrient.amount || 0;\n        }\n      }\n      console.log(`  ${label} NOT FOUND in numbers:`, numbers);\n      return 0;\n    };\n\n    console.log(`ðŸ§® Extracting nutrition for ${portionGrams}g from USDA food:`, usdaFood.description);\n    console.log(`  Total nutrients available:`, nutrients.length);\n    \n    // Extract key nutrients (per 100g in USDA database)\n    const calories = findNutrient(['208'], 'Calories'); // Energy\n    const protein = findNutrient(['203'], 'Protein'); // Protein\n    const carbs = findNutrient(['205'], 'Carbs'); // Carbohydrate, by difference\n    const fat = findNutrient(['204'], 'Fat'); // Total lipid (fat)\n    const fiber = findNutrient(['291'], 'Fiber'); // Fiber, total dietary\n    const sugar = findNutrient(['269'], 'Sugar'); // Sugars, total including NLEA\n    const sodium = findNutrient(['307'], 'Sodium'); // Sodium, Na\n\n    // Scale to requested portion size\n    const scaleFactor = portionGrams / 100;\n    console.log(`  Scale factor: ${portionGrams}g / 100g = ${scaleFactor}`);\n\n    return {\n      calories: Math.round(calories * scaleFactor),\n      protein: Math.round(protein * scaleFactor * 10) / 10, // 1 decimal\n      carbs: Math.round(carbs * scaleFactor * 10) / 10,\n      fat: Math.round(fat * scaleFactor * 10) / 10,\n      fiber: fiber > 0 ? Math.round(fiber * scaleFactor * 10) / 10 : undefined,\n      sugar: sugar > 0 ? Math.round(sugar * scaleFactor * 10) / 10 : undefined,\n      sodium: sodium > 0 ? Math.round(sodium * scaleFactor) : undefined, // mg\n    };\n  }\n\n  /**\n   * Preprocess food names for better USDA matching\n   */\n  private preprocessFoodName(foodName: string): string {\n    const name = foodName.toLowerCase().trim();\n    \n    // ===== FAST FOOD & RESTAURANT ITEMS =====\n    // Map branded restaurant items to generic USDA equivalents\n    if (name.includes('big mac')) {\n      return 'hamburger double patty cheese bun'; // Big Mac equivalent\n    }\n    if (name.includes('quarter pounder') || name.includes('quarterpounder')) {\n      return 'hamburger single patty cheese'; // Quarter Pounder equivalent\n    }\n    if (name.includes('whopper')) {\n      return 'hamburger single patty cheese bun'; // Whopper equivalent\n    }\n    if (name.includes('mcnuggets') || name.includes('chicken nugget')) {\n      return 'chicken nuggets breaded fried';\n    }\n    if (name.includes('happy meal')) {\n      return 'hamburger kids meal'; // Generic kids meal\n    }\n    \n    // ===== SNACK FOODS & CRISPS HANDLING =====\n    // Handle British \"crisps\" and American \"chips\" - focus on the snack food category\n    if (name.includes('crisps') || (name.includes('chips') && !name.includes('fish') && !name.includes('wood'))) {\n      // For compound crisp names like \"prawn cocktail crisps\", prioritize the snack type\n      // UK crisp flavors - all typically potato-based\n      if (name.includes('prawn cocktail')) {\n        return 'snacks potato chips plain salted'; // British crisps are typically potato-based\n      }\n      if (name.includes('salt') && name.includes('vinegar')) {\n        return 'snacks potato chips plain salted';\n      }\n      if (name.includes('cheese') && name.includes('onion')) {\n        return 'snacks potato chips plain salted'; // British cheese & onion crisps are potato-based\n      }\n      if (name.includes('ready salted') || name.includes('smoky bacon') || name.includes('roast chicken')) {\n        return 'snacks potato chips plain salted'; // Common UK crisp flavors are potato-based\n      }\n      // Generic crisp/chip fallback\n      if (name.includes('crisps')) {\n        return 'snacks potato chips plain salted';\n      }\n      if (name.includes('chips')) {\n        return 'snacks potato chips plain salted';\n      }\n    }\n    \n    // Handle British/International food terms\n    if (name.includes('back bacon') || name.includes('bacon back')) {\n      return 'pork bacon cured';\n    }\n    if (name.includes('black pudding')) {\n      return 'blood sausage';\n    }\n    if (name.includes('streaky bacon')) {\n      return 'pork bacon belly';\n    }\n    if (name.includes('rashers')) {\n      return 'bacon strips';\n    }\n    \n    // Force pork variants for generic meat terms to avoid meatless alternatives\n    if (name.includes('bacon') && !name.includes('turkey') && !name.includes('chicken') && !name.includes('beef') && !name.includes('meatless') && !name.includes('veggie')) {\n      if (name.includes('slice') || name.includes('rashers')) {\n        return 'pork bacon slice';\n      }\n      return 'pork bacon cured';\n    }\n    \n    if (name.includes('sausage') && !name.includes('chicken') && !name.includes('turkey') && !name.includes('meatless') && !name.includes('veggie')) {\n      if (name.includes('link')) {\n        return 'pork breakfast sausage link';\n      }\n      if (name.includes('patty')) {\n        return 'pork breakfast sausage patty';\n      }\n      return 'pork breakfast sausage';\n    }\n    \n    // Handle common modifiers that confuse USDA search\n    let processed = name\n      .replace(/^\\d+\\s+/, '') // CRITICAL: Remove leading numbers (e.g., \"4 Weetabix\" â†’ \"Weetabix\")\n      .replace(/^(one|two|three|four|five|six|seven|eight|nine|ten)\\s+/i, '') // Remove leading word numbers\n      .replace(/\\b(2|two|3|three|1|one)\\s+(slice|slices|piece|pieces|strip|strips)\\b/g, '') // Remove portion descriptors\n      .replace(/\\b(approx\\.?|approximately)\\s*\\d+g?\\b/g, '') // Remove weight estimates\n      .replace(/\\b\\d+g\\b/g, '') // Remove gram measurements\n      .replace(/\\s+/g, ' ') // Normalize whitespace\n      .trim();\n    \n    // If we removed too much, return the original (without numbers)\n    if (processed.length < 3) {\n      return foodName.replace(/^\\d+\\s+/, '').trim();\n    }\n    \n    return processed;\n  }\n\n  /**\n   * Find the best matching USDA food for a detected food name\n   */\n  async findBestMatch(foodName: string): Promise<{ usdaFood: USDAFood; nutrition: NutritionData } | null> {\n    try {\n      // Preprocess food names to improve USDA matching\n      const searchTerm = this.preprocessFoodName(foodName);\n      console.log(`ðŸ” Preprocessed \"${foodName}\" â†’ \"${searchTerm}\" for USDA search`);\n      \n      const searchResults = await this.searchFoods(searchTerm, 10);\n      \n      if (searchResults.foods.length === 0) {\n        console.log(`âŒ No USDA matches found for: ${foodName}`);\n        return null;\n      }\n\n      // Enhanced scoring: prefer generic/average entries over branded/extreme ones\n      const scoredFoods = searchResults.foods.map(food => {\n        const description = food.description.toLowerCase();\n        const nutrientCount = food.foodNutrients.length;\n        const hasBasicNutrients = ['203', '204', '205', '208'].every(id => \n          food.foodNutrients.some(n => n.nutrient && n.nutrient.number === id && n.amount > 0)\n        );\n        \n        let score = nutrientCount + (hasBasicNutrients ? 100 : 0);\n        \n        // Handle British/International food names\n        const searchName = foodName.toLowerCase();\n        \n        // Hard filter meatless alternatives when searching for real meat (unless explicitly requested)\n        const isMeatlessAlternative = /(meatless|vegetarian|veggie|plant[- ]based|meat substitute)/i.test(description);\n        const requestedMeatless = /(meatless|vegetarian|veggie|plant[- ]based)/i.test(searchName);\n        if (isMeatlessAlternative && !requestedMeatless) {\n          console.log(`ðŸš« Filtering meatless alternative: ${food.description}`);\n          score -= 1000; // Heavy penalty to ensure real meat products rank higher\n        }\n\n        // ===== FOOD CATEGORY COMPATIBILITY SCORING =====\n        // Prevent category mismatches (e.g., snacks matching with beverages)\n        const isSnackFood = /(crisps?|chips?|snacks?|crackers?)/i.test(searchName);\n        const isBeverage = /(cocktail|drink|beverage|juice|soda|beer|wine|alcohol)/i.test(description);\n        \n        if (isSnackFood && isBeverage) {\n          score -= 2000; // Massive penalty for category mismatch\n          console.log(`ðŸš« Category mismatch: snack food \"${searchName}\" matched with beverage \"${food.description}\" - penalty applied`);\n        }\n        \n        // Boost appropriate category matches\n        if (isSnackFood && /snacks?/i.test(description)) {\n          score += 300; // Strong boost for proper snack category match\n          console.log(`ðŸ“ˆ Snack category match boost: ${food.description}`);\n        }\n        \n        // Additional category compatibility checks\n        const isMeat = /(meat|beef|pork|chicken|turkey|lamb|bacon|sausage)/i.test(searchName);\n        const isDessert = /(cake|cookie|dessert|sweet|candy|chocolate)/i.test(description);\n        const isVegetable = /(vegetable|carrot|broccoli|lettuce|spinach)/i.test(searchName);\n        const isFruit = /(fruit|apple|banana|orange|berry)/i.test(searchName);\n        \n        if (isMeat && isDessert) {\n          score -= 1500; // Heavy penalty for meat vs dessert mismatch\n          console.log(`ðŸš« Meat-dessert mismatch: \"${searchName}\" vs \"${food.description}\"`);\n        }\n        \n        if ((isVegetable || isFruit) && isBeverage && !/(juice|smoothie)/i.test(description)) {\n          score -= 1000; // Penalty for produce vs non-juice beverage mismatch  \n          console.log(`ðŸš« Produce-beverage mismatch: \"${searchName}\" vs \"${food.description}\"`);\n        }\n\n        // ===== ENHANCED GENERIC/AVERAGE PREFERENCE LOGIC =====\n        \n        // Heavily penalize branded entries (identifiable by ALL CAPS brands)\n        const brandPatterns = [\n          /\\b[A-Z]{2,}\\s+[A-Z]{2,}/, // Multiple ALL CAPS words (test against original description)\n          /\\b(WENDY'S|MCDONALD'S|BURGER KING|KFC|TACO BELL|SUBWAY|DOMINO'S|PIZZA HUT)\\b/i,\n          /\\b(OSCAR MAYER|JOHNSONVILLE|HORMEL|TYSON|BUTTERBALL|HILLSHIRE FARM)\\b/i,\n          /\\b(KRAFT|HEINZ|CAMPBELL'S|NESTLE|KELLOGG'S|GENERAL MILLS)\\b/i,\n          /\\b(MALBRA|WARBURTONS|HOVIS|KINGSMILL|ALLINSON)\\b/i // UK bread brands\n        ];\n        \n        // Test ALL CAPS pattern against original description, others against lowercased\n        const isBranded = brandPatterns.some((pattern, index) => {\n          if (index === 0) { // First pattern checks ALL CAPS - test original description\n            return pattern.test(food.description);\n          }\n          return pattern.test(description); // Other patterns use /i flag - test lowercased\n        });\n        if (isBranded) {\n          score -= 200; // Heavy penalty for branded items\n          console.log(`ðŸ“‰ Branded entry penalty: ${food.description}`);\n        }\n        \n        // Boost generic/simple descriptions\n        // CRITICAL: Match preparation method in search to result\n        const searchHasCookingMethod = /(fried|battered|cooked|grilled|baked|roasted|steamed|boiled)/i.test(searchName);\n        const descriptionIsRaw = /, raw$/.test(description);\n        \n        const genericBoosts = [\n          { pattern: /^bread, white, toasted/, boost: 200, label: \"generic white toast\" },\n          { pattern: /^bread, wheat, toasted/, boost: 200, label: \"generic wheat toast\" },\n          { pattern: /^bread, (white|wheat|whole wheat|whole grain|multigrain), /, boost: 180, label: \"generic bread\" },\n          { pattern: /^[a-z\\s,]+, raw$/, boost: 150, label: \"raw generic\" },\n          { pattern: /^[a-z\\s,]+, cooked$/, boost: 140, label: \"cooked generic\" },\n          { pattern: /^[a-z\\s,]+, fried/, boost: 140, label: \"fried generic\" },\n          { pattern: /^[a-z\\s,]+, battered/, boost: 140, label: \"battered generic\" },\n          { pattern: /^[a-z\\s,]+, fresh$/, boost: 130, label: \"fresh generic\" },\n          { pattern: /^\\w+, \\w+$/, boost: 120, label: \"simple two-word\" }, // e.g., \"Bacon, pork\"\n          { pattern: /^(pork|beef|chicken|fish|turkey), /, boost: 110, label: \"generic meat\" },\n          { pattern: /, average/, boost: 100, label: \"average entry\" },\n          { pattern: /, typical/, boost: 95, label: \"typical entry\" },\n          { pattern: /, standard/, boost: 90, label: \"standard entry\" }\n        ];\n        \n        for (const { pattern, boost, label } of genericBoosts) {\n          if (pattern.test(description)) {\n            // If search wants fried/battered but result is raw, penalize instead of boost\n            if (searchHasCookingMethod && descriptionIsRaw) {\n              score -= 500; // Heavy penalty for raw when cooked method requested\n              console.log(`ðŸ“‰ Raw penalty (-500) when search wants cooked: ${food.description}`);\n            } else {\n              score += boost;\n              console.log(`ðŸ“ˆ Generic boost (+${boost}) for ${label}: ${food.description}`);\n            }\n            break; // Apply only the first matching boost\n          }\n        }\n        \n        // Penalize extreme/jumbo portions\n        const extremePatterns = [\n          { pattern: /\\b(jumbo|giant|super|mega|extra[\\s-]large|xl|xxl)\\b/i, penalty: 150, label: \"jumbo size\" },\n          { pattern: /\\b(double|triple|quad)\\b/i, penalty: 120, label: \"multiple portions\" },\n          { pattern: /\\b(premium|deluxe|gourmet|specialty)\\b/i, penalty: 80, label: \"premium variant\" },\n          { pattern: /\\b(loaded|stuffed|supreme)\\b/i, penalty: 100, label: \"loaded variant\" }\n        ];\n        \n        for (const { pattern, penalty, label } of extremePatterns) {\n          if (pattern.test(description)) {\n            score -= penalty;\n            console.log(`ðŸ“‰ Extreme penalty (-${penalty}) for ${label}: ${food.description}`);\n            break; // Apply only the first matching penalty\n          }\n        }\n        \n        // Handle NFS (Not Further Specified) with small genericity penalty\n        // NFS foods are less specific but shouldn't be treated as beverages\n        if (/\\bnfs\\b/i.test(description)) {\n          score -= 25; // Small penalty for being less specific\n          console.log(`ðŸ“‰ NFS genericity penalty (-25): ${food.description}`);\n        }\n        \n        // Boost USDA SR Legacy and Foundation data (more reliable)\n        if (description.includes('includes foods for usda')) {\n          score += 80;\n          console.log(`ðŸ“ˆ USDA reliable data boost: ${food.description}`);\n        }\n        \n        // Penalize overly specific preparations unless requested\n        const specificPreparations = [\n          'breaded and fried', 'with sauce', 'in gravy', 'with cheese sauce',\n          'honey glazed', 'teriyaki', 'bbq', 'buffalo', 'ranch'\n        ];\n        \n        const hasSpecificPrep = specificPreparations.some(prep => description.includes(prep));\n        if (hasSpecificPrep && !searchName.includes('sauce') && !searchName.includes('glazed')) {\n          score -= 60;\n          console.log(`ðŸ“‰ Specific preparation penalty: ${food.description}`);\n        }\n        \n        if (searchName.includes('back bacon') || searchName.includes('bacon')) {\n          if (description.includes('pork') && description.includes('bacon')) score += 150;\n          if (description.includes('chicken') || description.includes('turkey')) score -= 200; // Avoid poultry for bacon\n        }\n        if (searchName.includes('black pudding')) {\n          if (description.includes('sausage') || description.includes('blood')) score += 150;\n          if (description.includes('banana') || description.includes('chocolate')) score -= 200; // Avoid desserts\n        }\n        \n        // Boost breakfast sausage forms when searching for sausage\n        if (searchName.includes('sausage')) {\n          if (description.includes('pork') && (description.includes('breakfast') || description.includes('link') || description.includes('patty'))) {\n            score += 150;\n          }\n        }\n        \n        // ===== CRITICAL: PREVENT COMMON MISMATCHES =====\n        \n        // When searching for potato dishes, penalize bread and prefer actual potatoes\n        // Only trigger for actual potato queries (not just any \"baked\" item)\n        if (searchName.includes('potato') || searchName.includes('jacket')) {\n          // CRITICAL: \"Bread, potato\" is NOT a potato - it's potato bread!\n          // Use word boundary to avoid matching \"breaded\" or \"breadcrumb\"\n          if (/\\bbread\\b/i.test(description)) {\n            score -= 1000; // Massive penalty for potato bread when user wants potatoes\n            console.log(`ðŸš« Potato bread penalty (-1000): ${food.description}`);\n          }\n          \n          // CRITICAL: \"Potato chips\" are NOT a baked potato!\n          // Heavily penalize chips/crisps when user wants an actual potato\n          if (/(chips?|crisps?|fries|tots|wedges)/i.test(description) && !searchName.includes('chips') && !searchName.includes('fries') && !searchName.includes('crisps')) {\n            score -= 1500; // Massive penalty for chips when user wants whole potato\n            console.log(`ðŸš« Potato chips penalty (-1500): ${food.description}`);\n          }\n          \n          // Boost actual potato dishes (whole potatoes, not processed)\n          if (description.match(/potato(es)?(?!.*bread)/i) && (description.includes('baked') || description.includes('plain') || description.includes('white') || description.includes('nfs'))) {\n            score += 600; // Strong boost for actual potatoes\n            console.log(`ðŸ“ˆ Real potato boost (+600): ${food.description}`);\n          }\n          // Extra boost for baked/jacket potato specific matches\n          if (searchName.includes('jacket') || searchName.includes('baked potato')) {\n            if ((description.includes('baked') || description.includes('jacket')) && description.includes('potato') && !/(chips?|crisps?|fries)/i.test(description)) {\n              score += 700; // Huge boost for exact match (but not chips!)\n              console.log(`ðŸ“ˆ Baked/jacket potato exact match boost (+700): ${food.description}`);\n            }\n          }\n        }\n        \n        // When searching for \"rice\", prefer cooked rice over rice paper, rice cakes, etc.\n        if (searchName === 'rice' || searchName === 'white rice' || searchName === 'brown rice') {\n          if (description.includes('rice paper') || description.includes('rice cake') || description.includes('rice noodle')) {\n            score -= 500; // Heavy penalty for rice derivatives\n            console.log(`ðŸš« Rice derivative penalty (-500): ${food.description}`);\n          }\n          if (description.includes('cooked') || description.includes('boiled')) {\n            score += 400; // Strong boost for cooked rice\n            console.log(`ðŸ“ˆ Cooked rice boost (+400): ${food.description}`);\n          }\n          if (description.includes('white rice, cooked') || description.includes('brown rice, cooked')) {\n            score += 500; // Extra boost for exact cooked rice match\n            console.log(`ðŸ“ˆ Exact cooked rice boost (+500): ${food.description}`);\n          }\n        }\n        \n        // When searching for \"chicken\", prefer chicken breast over chicken back/tail/etc.\n        if (searchName === 'chicken' || searchName === 'grilled chicken' || searchName === 'baked chicken') {\n          if (description.includes('chicken breast') || description.includes('breast, meat only')) {\n            score += 400; // Strong boost for chicken breast\n            console.log(`ðŸ“ˆ Chicken breast boost (+400): ${food.description}`);\n          }\n          if (description.includes('back') || description.includes('tail') || description.includes('neck') || description.includes('giblet')) {\n            score -= 300; // Penalty for uncommon chicken parts\n            console.log(`ðŸ“‰ Uncommon chicken part penalty (-300): ${food.description}`);\n          }\n        }\n        \n        // Boost whole foods\n        if (description.includes('raw') || description.includes('fresh')) score += 50;\n        if (description.split(',').length <= 2) score += 30; // Prefer simple descriptions\n        \n        // Penalize processed foods\n        if (description.includes('croissant') || description.includes('cake') || description.includes('cookie')) score -= 100;\n        if (description.includes('canned') || description.includes('frozen prepared')) score -= 20;\n        if (description.includes('with ') || description.includes('sauce') || description.includes('dressing')) score -= 15;\n        \n        // CRITICAL: Heavy penalty for processed egg products when searching for simple eggs\n        if (searchName.includes('egg') && !searchName.includes('custard') && !searchName.includes('mix')) {\n          if (description.includes('custard') || description.includes('mix') || description.includes('prepared') || \n              description.includes('scrambled') || description.includes('deviled') || description.includes('salad')) {\n            score -= 300; // Heavy penalty for processed egg products\n            console.log(`ðŸ“‰ Processed egg penalty (-300): ${food.description}`);\n          }\n          \n          // Boost simple, raw eggs when searching for basic eggs\n          if ((description.includes('eggs, grade') || description.includes('egg, whole')) && \n              (description.includes('raw') || !description.includes('cooked'))) {\n            score += 200; // Huge boost for simple raw eggs\n            console.log(`ðŸ“ˆ Simple egg boost (+200): ${food.description}`);\n          }\n        }\n        \n        // Exact matches get huge boost\n        if (description.startsWith(foodName.toLowerCase())) score += 200;\n        \n        // Boost bacon-related foods when searching for bacon\n        if (searchName.includes('bacon')) {\n          if (description.includes('bacon') && description.includes('pork')) score += 100;\n          if (description.includes('cured') && description.includes('pork')) score += 75;\n        }\n        \n        return { food, score };\n      });\n\n      // Get the highest scoring food and fetch full details for accurate nutrition\n      const bestMatch = scoredFoods.sort((a, b) => b.score - a.score)[0];\n      \n      // Replace debug logs with compact summary\n      console.log(`ðŸ” Top candidates for \"${foodName}\":`, scoredFoods\n        .slice(0, 3)\n        .map(x => `${x.food.description} [${x.score}]`)\n        .join(' | '));\n      \n      // Fetch full food details for complete nutrition data\n      const fullFoodDetails = await this.getFoodDetails(bestMatch.food.fdcId);\n      const nutrition = this.extractNutritionData(fullFoodDetails);\n      \n      console.log(`ðŸ§ª Nutrient numbers present:`, fullFoodDetails.foodNutrients.map(n => n.nutrient?.number));\n      console.log(`âœ… Best USDA match for \"${foodName}\": ${fullFoodDetails.description}`);\n      \n      return {\n        usdaFood: bestMatch.food,\n        nutrition\n      };\n\n    } catch (error: any) {\n      console.error(`âŒ USDA lookup failed for \"${foodName}\":`, error.message);\n      return null;\n    }\n  }\n\n  /**\n   * Get multiple food matches efficiently\n   */\n  async findMultipleMatches(foodNames: string[]): Promise<Map<string, { usdaFood: USDAFood; nutrition: NutritionData }>> {\n    const results = new Map();\n    \n    // Process foods sequentially to avoid rate limiting\n    for (const foodName of foodNames) {\n      try {\n        const match = await this.findBestMatch(foodName);\n        if (match) {\n          results.set(foodName, match);\n        }\n        \n        // Small delay to respect rate limits\n        await new Promise(resolve => setTimeout(resolve, 100));\n        \n      } catch (error: any) {\n        console.error(`âŒ Failed to find USDA match for \"${foodName}\":`, error.message);\n        // Continue with other foods\n      }\n    }\n\n    return results;\n  }\n\n  /**\n   * Cache management\n   */\n  private getFromCache(key: string): any {\n    const cached = this.cache.get(key);\n    if (!cached) return null;\n\n    const { data, timestamp } = cached;\n    if (Date.now() - timestamp > this.cacheTimeout) {\n      this.cache.delete(key);\n      return null;\n    }\n\n    return data;\n  }\n\n  private setCache(key: string, data: any): void {\n    this.cache.set(key, {\n      data,\n      timestamp: Date.now()\n    });\n\n    // Simple cache cleanup - remove oldest entries if cache gets too large\n    if (this.cache.size > 1000) {\n      const entries = Array.from(this.cache.entries());\n      entries.sort((a, b) => a[1].timestamp - b[1].timestamp);\n      \n      // Remove oldest 200 entries\n      for (let i = 0; i < 200; i++) {\n        this.cache.delete(entries[i][0]);\n      }\n    }\n  }\n\n  /**\n   * Clear the entire cache to force fresh searches\n   */\n  clearCache(): void {\n    const cacheSize = this.cache.size;\n    this.cache.clear();\n    console.log(`ðŸ§¹ Cleared USDA cache (${cacheSize} entries removed)`);\n  }\n\n  /**\n   * Health check for USDA service\n   */\n  async healthCheck(): Promise<{ status: 'healthy' | 'unhealthy'; message: string }> {\n    if (!this.apiKey) {\n      return { status: 'unhealthy', message: 'USDA API key not configured' };\n    }\n\n    try {\n      // Simple test search\n      await this.searchFoods('apple', 1);\n      return { status: 'healthy', message: 'USDA API is responding normally' };\n    } catch (error: any) {\n      return { status: 'unhealthy', message: `USDA API error: ${error.message}` };\n    }\n  }\n}\n\n// Export singleton instance\nexport const usdaService = new USDAService();","size_bytes":29463},"android/app/src/main/assets/public/cordova_plugins.js":{"content":"","size_bytes":0},"client/src/components/nutrition-goals.tsx":{"content":"import React, { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Target, Flame, Beef, Wheat, Droplets, Save, Edit } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { insertNutritionGoalsSchema } from \"@shared/schema\";\nimport type { NutritionGoals } from \"@shared/schema\";\nimport { z } from \"zod\";\n\nconst formSchema = insertNutritionGoalsSchema.omit({ userId: true });\n\nexport function NutritionGoals() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isEditing, setIsEditing] = useState(false);\n\n  const { data: goals, isLoading } = useQuery<NutritionGoals>({\n    queryKey: ['/api/nutrition-goals'],\n    refetchOnMount: true, // Always refetch on mount to prevent stale data\n  });\n\n  const form = useForm<z.infer<typeof formSchema>>({\n    resolver: zodResolver(formSchema),\n    defaultValues: {\n      dailyCalories: goals?.dailyCalories || 2000,\n      dailyProtein: goals?.dailyProtein || 150,\n      dailyCarbs: goals?.dailyCarbs || 250,\n      dailyFat: goals?.dailyFat || 65,\n      dailyWater: goals?.dailyWater || 2000,\n    },\n  });\n\n  // Update form when goals data loads\n  React.useEffect(() => {\n    if (goals) {\n      form.reset({\n        dailyCalories: goals.dailyCalories || 2000,\n        dailyProtein: goals.dailyProtein || 150,\n        dailyCarbs: goals.dailyCarbs || 250,\n        dailyFat: goals.dailyFat || 65,\n        dailyWater: goals.dailyWater || 2000,\n      });\n    }\n  }, [goals, form]);\n\n  const updateGoalsMutation = useMutation({\n    mutationFn: async (data: z.infer<typeof formSchema>) => {\n      await apiRequest('POST', '/api/nutrition-goals', data);\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Goals Updated\",\n        description: \"Your nutrition goals have been saved successfully.\",\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/nutrition-goals'] });\n      setIsEditing(false);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to update goals. Please try again.\",\n        variant: \"destructive\",\n      });\n      console.error(\"Error updating goals:\", error);\n    },\n  });\n\n  const onSubmit = (data: z.infer<typeof formSchema>) => {\n    updateGoalsMutation.mutate(data);\n  };\n\n  if (isLoading) {\n    return (\n      <Card>\n        <CardContent className=\"p-6\">\n          <div className=\"animate-pulse space-y-4\">\n            <div className=\"h-4 bg-muted rounded w-1/3\"></div>\n            <div className=\"space-y-2\">\n              <div className=\"h-3 bg-muted rounded\"></div>\n              <div className=\"h-3 bg-muted rounded w-2/3\"></div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card>\n      <CardHeader>\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center space-x-2\">\n            <Target className=\"h-5 w-5 text-primary\" />\n            <CardTitle className=\"text-lg\">Daily Nutrition Goals</CardTitle>\n          </div>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => setIsEditing(!isEditing)}\n            data-testid=\"button-edit-goals\"\n          >\n            <Edit className=\"h-4 w-4 mr-1\" />\n            {isEditing ? 'Cancel' : 'Edit'}\n          </Button>\n        </div>\n        <CardDescription>\n          Set your daily nutrition targets to track your progress\n        </CardDescription>\n      </CardHeader>\n      <CardContent>\n        {isEditing ? (\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n              <div className=\"grid grid-cols-2 gap-4\">\n                <FormField\n                  control={form.control}\n                  name=\"dailyCalories\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel className=\"flex items-center space-x-1\">\n                        <Flame className=\"h-4 w-4\" />\n                        <span>Calories</span>\n                      </FormLabel>\n                      <FormControl>\n                        <Input \n                          type=\"number\" \n                          {...field} \n                          value={field.value || 0}\n                          onChange={(e) => field.onChange(parseInt(e.target.value) || 0)}\n                          data-testid=\"input-daily-calories\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"dailyProtein\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel className=\"flex items-center space-x-1\">\n                        <Beef className=\"h-4 w-4\" />\n                        <span>Protein (g)</span>\n                      </FormLabel>\n                      <FormControl>\n                        <Input \n                          type=\"number\" \n                          {...field} \n                          value={field.value || 0}\n                          onChange={(e) => field.onChange(parseInt(e.target.value) || 0)}\n                          data-testid=\"input-daily-protein\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"dailyCarbs\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel className=\"flex items-center space-x-1\">\n                        <Wheat className=\"h-4 w-4\" />\n                        <span>Carbs (g)</span>\n                      </FormLabel>\n                      <FormControl>\n                        <Input \n                          type=\"number\" \n                          {...field} \n                          value={field.value || 0}\n                          onChange={(e) => field.onChange(parseInt(e.target.value) || 0)}\n                          data-testid=\"input-daily-carbs\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"dailyFat\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Fat (g)</FormLabel>\n                      <FormControl>\n                        <Input \n                          type=\"number\" \n                          {...field} \n                          value={field.value || 0}\n                          onChange={(e) => field.onChange(parseInt(e.target.value) || 0)}\n                          data-testid=\"input-daily-fat\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"dailyWater\"\n                  render={({ field }) => (\n                    <FormItem className=\"col-span-2\">\n                      <FormLabel className=\"flex items-center space-x-1\">\n                        <Droplets className=\"h-4 w-4\" />\n                        <span>Water (ml)</span>\n                      </FormLabel>\n                      <FormControl>\n                        <Input \n                          type=\"number\" \n                          {...field} \n                          value={field.value || 0}\n                          onChange={(e) => field.onChange(parseInt(e.target.value) || 0)}\n                          data-testid=\"input-daily-water\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <Button \n                type=\"submit\" \n                disabled={updateGoalsMutation.isPending}\n                className=\"w-full\"\n                data-testid=\"button-save-goals\"\n              >\n                <Save className=\"h-4 w-4 mr-2\" />\n                {updateGoalsMutation.isPending ? 'Saving...' : 'Save Goals'}\n              </Button>\n            </form>\n          </Form>\n        ) : (\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-1\">\n              <div className=\"flex items-center space-x-2 text-sm text-muted-foreground\">\n                <Flame className=\"h-4 w-4\" />\n                <span>Calories</span>\n              </div>\n              <div className=\"text-2xl font-bold\" data-testid=\"display-daily-calories\">\n                {goals?.dailyCalories || 2000}\n              </div>\n            </div>\n\n            <div className=\"space-y-1\">\n              <div className=\"flex items-center space-x-2 text-sm text-muted-foreground\">\n                <Beef className=\"h-4 w-4\" />\n                <span>Protein</span>\n              </div>\n              <div className=\"text-2xl font-bold\" data-testid=\"display-daily-protein\">\n                {goals?.dailyProtein || 150}g\n              </div>\n            </div>\n\n            <div className=\"space-y-1\">\n              <div className=\"flex items-center space-x-2 text-sm text-muted-foreground\">\n                <Wheat className=\"h-4 w-4\" />\n                <span>Carbs</span>\n              </div>\n              <div className=\"text-2xl font-bold\" data-testid=\"display-daily-carbs\">\n                {goals?.dailyCarbs || 250}g\n              </div>\n            </div>\n\n            <div className=\"space-y-1\">\n              <div className=\"text-sm text-muted-foreground\">Fat</div>\n              <div className=\"text-2xl font-bold\" data-testid=\"display-daily-fat\">\n                {goals?.dailyFat || 65}g\n              </div>\n            </div>\n\n            <div className=\"space-y-1 col-span-2\">\n              <div className=\"flex items-center space-x-2 text-sm text-muted-foreground\">\n                <Droplets className=\"h-4 w-4\" />\n                <span>Water</span>\n              </div>\n              <div className=\"text-2xl font-bold\" data-testid=\"display-daily-water\">\n                {goals?.dailyWater || 2000}ml\n              </div>\n            </div>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":11051},"client/src/index.css":{"content":"@import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap');\n@import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css');\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n:root {\n  --background: linear-gradient(135deg, hsl(110 60% 97%) 0%, hsl(180 50% 96%) 100%);\n  --background-solid: hsl(110 60% 97%);\n  --foreground: hsl(222.2 84% 4.9%);\n  --card: hsl(0 0% 100%);\n  --card-foreground: hsl(222.2 84% 4.9%);\n  --popover: hsl(0 0% 100%);\n  --popover-foreground: hsl(222.2 84% 4.9%);\n  --primary: linear-gradient(135deg, hsl(160 84% 39%) 0%, hsl(200 100% 50%) 100%);\n  --primary-solid: hsl(160 84% 39%);\n  --primary-foreground: hsl(0 0% 98%);\n  --secondary: hsl(110 50% 92%);\n  --secondary-foreground: hsl(160 84% 39%);\n  --muted: hsl(110 40% 94%);\n  --muted-foreground: hsl(160 30% 45%);\n  --accent: linear-gradient(135deg, hsl(110 50% 92%) 0%, hsl(140 60% 88%) 100%);\n  --accent-solid: hsl(110 50% 92%);\n  --accent-foreground: hsl(160 84% 39%);\n  --destructive: hsl(0 84% 60%);\n  --destructive-foreground: hsl(0 0% 98%);\n  --border: hsl(110 40% 87%);\n  --input: hsl(110 30% 90%);\n  --ring: hsl(160 84% 39%);\n  --chart-1: hsl(160 84% 39%);\n  --chart-2: hsl(200 100% 50%);\n  --chart-3: hsl(45 100% 60%);\n  --chart-4: hsl(25 100% 65%);\n  --chart-5: hsl(290 80% 58%);\n  --sidebar: hsl(0 0% 100%);\n  --sidebar-foreground: hsl(222.2 84% 4.9%);\n  --sidebar-primary: hsl(160 84% 39%);\n  --sidebar-primary-foreground: hsl(0 0% 98%);\n  --sidebar-accent: hsl(110 50% 92%);\n  --sidebar-accent-foreground: hsl(160 84% 39%);\n  --sidebar-border: hsl(110 40% 87%);\n  --sidebar-ring: hsl(160 84% 39%);\n  --font-sans: 'Roboto', sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: 'Courier New', monospace;\n  --radius: 0.75rem;\n  --shadow-soft: 0 4px 16px rgba(20, 184, 166, 0.12);\n  --shadow-medium: 0 8px 32px rgba(20, 184, 166, 0.16);\n  --shadow-strong: 0 16px 48px rgba(20, 184, 166, 0.20);\n  --bg-gradient: #a855f7;\n}\n\n.dark {\n  --background: linear-gradient(135deg, hsl(222.2 84% 4.9%) 0%, hsl(180 30% 8%) 100%);\n  --background-solid: hsl(222.2 84% 4.9%);\n  --foreground: hsl(210 40% 98%);\n  --card: linear-gradient(135deg, hsl(222.2 84% 4.9%) 0%, hsl(180 20% 8%) 100%);\n  --card-foreground: hsl(210 40% 98%);\n  --popover: hsl(222.2 84% 4.9%);\n  --popover-foreground: hsl(210 40% 98%);\n  --primary: linear-gradient(135deg, hsl(160 70% 45%) 0%, hsl(200 80% 55%) 100%);\n  --primary-solid: hsl(160 70% 45%);\n  --primary-foreground: hsl(0 0% 98%);\n  --secondary: hsl(180 20% 20%);\n  --secondary-foreground: hsl(160 60% 80%);\n  --muted: hsl(180 15% 20%);\n  --muted-foreground: hsl(180 10% 65%);\n  --accent: linear-gradient(135deg, hsl(180 20% 20%) 0%, hsl(160 25% 18%) 100%);\n  --accent-solid: hsl(180 20% 20%);\n  --accent-foreground: hsl(160 60% 80%);\n  --destructive: hsl(0 62.8% 30.6%);\n  --destructive-foreground: hsl(210 40% 98%);\n  --border: hsl(180 15% 20%);\n  --input: hsl(180 15% 20%);\n  --ring: hsl(160 70% 45%);\n  --chart-1: hsl(160 70% 45%);\n  --chart-2: hsl(200 80% 55%);\n  --chart-3: hsl(45 90% 60%);\n  --chart-4: hsl(25 90% 65%);\n  --chart-5: hsl(290 70% 58%);\n  --sidebar: hsl(222.2 84% 4.9%);\n  --sidebar-foreground: hsl(210 40% 98%);\n  --sidebar-primary: hsl(160 70% 45%);\n  --sidebar-primary-foreground: hsl(0 0% 98%);\n  --sidebar-accent: hsl(180 20% 20%);\n  --sidebar-accent-foreground: hsl(160 60% 80%);\n  --sidebar-border: hsl(180 15% 20%);\n  --sidebar-ring: hsl(160 70% 45%);\n  --shadow-soft: 0 4px 16px rgba(0, 0, 0, 0.25);\n  --shadow-medium: 0 8px 32px rgba(0, 0, 0, 0.35);\n  --shadow-strong: 0 16px 48px rgba(0, 0, 0, 0.45);\n  --bg-gradient: linear-gradient(135deg, #2D1B69 0%, #5B21B6 100%);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased text-foreground;\n    background: var(--background);\n    min-height: 100vh;\n  }\n\n  h1, h2, h3, h4, h5, h6 {\n    @apply font-medium;\n    letter-spacing: -0.025em;\n  }\n\n  .gradient-text {\n    background: var(--primary);\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n  }\n\n  .glass-card {\n    background: rgba(255, 255, 255, 0.95);\n    backdrop-filter: blur(16px);\n    border: 1px solid rgba(255, 255, 255, 0.2);\n    box-shadow: var(--shadow-soft);\n  }\n\n  .dark .glass-card {\n    background: rgba(30, 30, 50, 0.95);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n  }\n\n  .gradient-button {\n    background: var(--primary);\n    border: none;\n    color: var(--primary-foreground);\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    transform: translateY(0);\n    box-shadow: var(--shadow-soft);\n  }\n\n  .gradient-button:hover {\n    transform: translateY(-2px);\n    box-shadow: var(--shadow-medium);\n  }\n\n  .gradient-button:active {\n    transform: translateY(0);\n    box-shadow: var(--shadow-soft);\n  }\n\n  .modern-card {\n    background: var(--card);\n    border: 1px solid var(--border);\n    border-radius: var(--radius);\n    box-shadow: var(--shadow-soft);\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  }\n\n  .modern-card:hover {\n    box-shadow: var(--shadow-medium);\n    transform: translateY(-2px);\n  }\n\n  .smooth-transition {\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  }\n}\n\n.camera-viewfinder {\n  background: linear-gradient(45deg, transparent 15px, rgba(20, 184, 166, 0.3) 15px, rgba(20, 184, 166, 0.3) 16px, transparent 16px),\n              linear-gradient(-45deg, transparent 15px, rgba(20, 184, 166, 0.3) 15px, rgba(20, 184, 166, 0.3) 16px, transparent 16px);\n  background-size: 20px 20px;\n  background-position: 0 0, 10px 10px;\n}\n\n.pulse-green {\n  animation: pulse-green 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;\n}\n\n@keyframes pulse-green {\n  0%, 100% {\n    opacity: 1;\n  }\n  50% {\n    opacity: .5;\n  }\n}\n\n/* Landing Page Animations */\n@keyframes fadeInUp {\n  from {\n    opacity: 0;\n    transform: translateY(30px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n@keyframes fadeInDown {\n  from {\n    opacity: 0;\n    transform: translateY(-30px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n@keyframes fadeInLeft {\n  from {\n    opacity: 0;\n    transform: translateX(-30px);\n  }\n  to {\n    opacity: 1;\n    transform: translateX(0);\n  }\n}\n\n@keyframes fadeInRight {\n  from {\n    opacity: 0;\n    transform: translateX(30px);\n  }\n  to {\n    opacity: 1;\n    transform: translateX(0);\n  }\n}\n\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n@keyframes float {\n  0%, 100% {\n    transform: translateY(0px);\n  }\n  50% {\n    transform: translateY(-10px);\n  }\n}\n\n@keyframes floatSlow {\n  0%, 100% {\n    transform: translate(0, 0);\n  }\n  25% {\n    transform: translate(10px, -15px);\n  }\n  50% {\n    transform: translate(-5px, -25px);\n  }\n  75% {\n    transform: translate(-10px, -10px);\n  }\n}\n\n@keyframes floatMedium {\n  0%, 100% {\n    transform: translate(0, 0);\n  }\n  33% {\n    transform: translate(-15px, -20px);\n  }\n  66% {\n    transform: translate(10px, -15px);\n  }\n}\n\n@keyframes floatFast {\n  0%, 100% {\n    transform: translate(0, 0);\n  }\n  20% {\n    transform: translate(8px, -12px);\n  }\n  40% {\n    transform: translate(-8px, -20px);\n  }\n  60% {\n    transform: translate(12px, -15px);\n  }\n  80% {\n    transform: translate(-5px, -8px);\n  }\n}\n\n@keyframes spinSlow {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n@keyframes pulseGlow {\n  0%, 100% {\n    box-shadow: 0 0 20px rgba(20, 184, 166, 0.5);\n  }\n  50% {\n    box-shadow: 0 0 40px rgba(20, 184, 166, 0.8);\n  }\n}\n\n/* Animation Classes */\n.animate-fade-in-up {\n  animation: fadeInUp 0.8s ease-out forwards;\n}\n\n.animate-fade-in-down {\n  animation: fadeInDown 0.8s ease-out forwards;\n}\n\n.animate-fade-in-left {\n  animation: fadeInLeft 0.8s ease-out forwards;\n}\n\n.animate-fade-in-right {\n  animation: fadeInRight 0.8s ease-out forwards;\n}\n\n.animate-fade-in {\n  animation: fadeIn 0.8s ease-out forwards;\n}\n\n.animate-float {\n  animation: float 3s ease-in-out infinite;\n}\n\n.animate-float-slow {\n  animation: floatSlow 8s ease-in-out infinite;\n}\n\n.animate-float-medium {\n  animation: floatMedium 6s ease-in-out infinite;\n}\n\n.animate-float-fast {\n  animation: floatFast 4s ease-in-out infinite;\n}\n\n.animate-spin-slow {\n  animation: spinSlow 8s linear infinite;\n}\n\n.animate-pulse-glow {\n  animation: pulseGlow 2s ease-in-out infinite;\n}\n\n/* Animation Delays */\n.animation-delay-300 {\n  animation-delay: 300ms;\n}\n\n.animation-delay-500 {\n  animation-delay: 500ms;\n}\n\n.animation-delay-600 {\n  animation-delay: 600ms;\n}\n\n.animation-delay-900 {\n  animation-delay: 900ms;\n}\n\n.animation-delay-1000 {\n  animation-delay: 1000ms;\n}\n\n.animation-delay-1200 {\n  animation-delay: 1200ms;\n}\n\n.animation-delay-1500 {\n  animation-delay: 1500ms;\n}\n\n.animation-delay-1800 {\n  animation-delay: 1800ms;\n}\n\n.animation-delay-2100 {\n  animation-delay: 2100ms;\n}\n\n.animation-delay-2400 {\n  animation-delay: 2400ms;\n}\n\n.animation-delay-2700 {\n  animation-delay: 2700ms;\n}\n\n.animation-delay-3000 {\n  animation-delay: 3000ms;\n}\n\n.animation-delay-3300 {\n  animation-delay: 3300ms;\n}\n\n.animation-delay-3600 {\n  animation-delay: 3600ms;\n}\n\n.animation-delay-4500 {\n  animation-delay: 4500ms;\n}\n\n.animation-delay-4800 {\n  animation-delay: 4800ms;\n}\n\n.animation-delay-5100 {\n  animation-delay: 5100ms;\n}\n\n.animation-delay-5700 {\n  animation-delay: 5700ms;\n}\n\n.animation-delay-6000 {\n  animation-delay: 6000ms;\n}\n\n.animation-delay-6300 {\n  animation-delay: 6300ms;\n}\n\n/* Modern UI Enhancements */\n@keyframes shimmer {\n  0% {\n    background-position: -200% 0;\n  }\n  100% {\n    background-position: 200% 0;\n  }\n}\n\n@keyframes slideIn {\n  from {\n    opacity: 0;\n    transform: translateY(20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n@keyframes scaleIn {\n  from {\n    opacity: 0;\n    transform: scale(0.9);\n  }\n  to {\n    opacity: 1;\n    transform: scale(1);\n  }\n}\n\n.animate-shimmer {\n  background: linear-gradient(\n    90deg,\n    rgba(255, 255, 255, 0) 0%,\n    rgba(255, 255, 255, 0.2) 50%,\n    rgba(255, 255, 255, 0) 100%\n  );\n  background-size: 200% 100%;\n  animation: shimmer 2s ease-in-out infinite;\n}\n\n.animate-slide-in {\n  animation: slideIn 0.4s ease-out forwards;\n}\n\n.animate-scale-in {\n  animation: scaleIn 0.3s ease-out forwards;\n}\n\n/* Enhanced scrollbar */\n::-webkit-scrollbar {\n  width: 6px;\n}\n\n::-webkit-scrollbar-track {\n  background: var(--muted);\n  border-radius: 3px;\n}\n\n::-webkit-scrollbar-thumb {\n  background: var(--primary-solid);\n  border-radius: 3px;\n}\n\n::-webkit-scrollbar-thumb:hover {\n  background: var(--ring);\n}\n\n/* Enhanced focus states */\n.enhanced-focus:focus-visible {\n  outline: 2px solid var(--ring);\n  outline-offset: 2px;\n  border-radius: var(--radius);\n}\n\n/* Loading skeleton */\n.skeleton {\n  background: linear-gradient(\n    90deg,\n    var(--muted) 25%,\n    var(--muted)/50 50%,\n    var(--muted) 75%\n  );\n  background-size: 200% 100%;\n  animation: shimmer 2s ease-in-out infinite;\n}\n\n/* Enhanced button effects */\n.button-glow:hover {\n  box-shadow: 0 0 20px var(--primary-solid)/30;\n}\n\n/* Responsive text sizing */\n.text-responsive {\n  font-size: clamp(0.875rem, 2.5vw, 1rem);\n}\n\n/* Enhanced glass effect */\n.glass-enhanced {\n  background: rgba(255, 255, 255, 0.1);\n  backdrop-filter: blur(20px) saturate(1.8);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n}\n\n.dark .glass-enhanced {\n  background: rgba(20, 20, 40, 0.8);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n/* Enhanced nutrition-themed styling */\n.nutrition-gradient {\n  background: linear-gradient(135deg, \n    hsl(160 84% 39%) 0%, \n    hsl(120 60% 50%) 25%, \n    hsl(60 90% 60%) 50%, \n    hsl(30 85% 65%) 75%, \n    hsl(200 100% 50%) 100%);\n}\n\n.health-card {\n  background: linear-gradient(135deg, \n    rgba(255, 255, 255, 0.9) 0%, \n    rgba(240, 253, 244, 0.95) 100%);\n  border: 1px solid rgba(20, 184, 166, 0.2);\n  box-shadow: \n    0 4px 16px rgba(20, 184, 166, 0.1),\n    0 0 0 1px rgba(20, 184, 166, 0.05);\n}\n\n.dark .health-card {\n  background: linear-gradient(135deg, \n    rgba(20, 30, 40, 0.9) 0%, \n    rgba(15, 40, 35, 0.95) 100%);\n  border: 1px solid rgba(20, 184, 166, 0.3);\n}\n\n.vibrant-button {\n  background: linear-gradient(135deg, \n    hsl(160 84% 39%) 0%, \n    hsl(180 80% 45%) 50%, \n    hsl(200 90% 50%) 100%);\n  border: none;\n  color: white;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  position: relative;\n  overflow: hidden;\n}\n\n.vibrant-button::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: -100%;\n  width: 100%;\n  height: 100%;\n  background: linear-gradient(90deg, \n    transparent, \n    rgba(255, 255, 255, 0.2), \n    transparent);\n  transition: left 0.5s;\n}\n\n.vibrant-button:hover::before {\n  left: 100%;\n}\n\n.vibrant-button:hover {\n  transform: translateY(-2px) scale(1.02);\n  box-shadow: \n    0 8px 25px rgba(20, 184, 166, 0.25),\n    0 4px 15px rgba(0, 150, 255, 0.15);\n}\n\n.success-accent {\n  background: linear-gradient(135deg, \n    hsl(120 60% 50%) 0%, \n    hsl(140 65% 45%) 100%);\n}\n\n.warning-accent {\n  background: linear-gradient(135deg, \n    hsl(45 100% 60%) 0%, \n    hsl(35 90% 65%) 100%);\n}\n\n.info-accent {\n  background: linear-gradient(135deg, \n    hsl(200 100% 50%) 0%, \n    hsl(220 85% 55%) 100%);\n}\n\n/* Enhanced animations */\n@keyframes colorShift {\n  0% { filter: hue-rotate(0deg); }\n  25% { filter: hue-rotate(90deg); }\n  50% { filter: hue-rotate(180deg); }\n  75% { filter: hue-rotate(270deg); }\n  100% { filter: hue-rotate(360deg); }\n}\n\n@keyframes breathe {\n  0%, 100% { transform: scale(1); }\n  50% { transform: scale(1.05); }\n}\n\n.animate-color-shift {\n  animation: colorShift 8s linear infinite;\n}\n\n.animate-breathe {\n  animation: breathe 3s ease-in-out infinite;\n}\n\n/* Lightbulb on/off animation */\n@keyframes bulbFlicker {\n  0%, 20% {\n    opacity: 1;\n    filter: brightness(1.2) saturate(1.1);\n  }\n  25%, 30% {\n    opacity: 0.3;\n    filter: brightness(0.7) saturate(0.8);\n  }\n  35%, 85% {\n    opacity: 1;\n    filter: brightness(1.2) saturate(1.1);\n  }\n  90%, 95% {\n    opacity: 0.4;\n    filter: brightness(0.8) saturate(0.9);\n  }\n  100% {\n    opacity: 1;\n    filter: brightness(1.2) saturate(1.1);\n  }\n}\n\n/* Nutrition-specific styling */\n.calorie-gradient {\n  background: linear-gradient(45deg, \n    hsl(0 70% 60%) 0%, \n    hsl(30 80% 65%) 50%, \n    hsl(60 90% 60%) 100%);\n}\n\n.protein-gradient {\n  background: linear-gradient(45deg, \n    hsl(340 70% 60%) 0%, \n    hsl(320 75% 65%) 100%);\n}\n\n.carbs-gradient {\n  background: linear-gradient(45deg, \n    hsl(60 85% 60%) 0%, \n    hsl(80 80% 55%) 100%);\n}\n\n.fat-gradient {\n  background: linear-gradient(45deg, \n    hsl(280 70% 60%) 0%, \n    hsl(260 75% 65%) 100%);\n}\n\n/* Native barcode scanner - hide webview when scanning */\nbody.barcode-scanner-active {\n  visibility: hidden;\n  --background: transparent !important;\n  --ion-background-color: transparent !important;\n}\n\nbody.barcode-scanner-active .barcode-scanner-modal {\n  visibility: visible;\n}\n","size_bytes":14861},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"ios/App/App/public/assets/speech-service-acJ2d5rg.js":{"content":"class h{constructor(){this.recognition=null,this.isListening=!1,this.isEnabled=!1,this.handlers=[],this.voiceCommands=new Map,this.continuousMode=!1,this.lastCommandTime=0,this.commandTimeout=5e3}async initialize(){try{const e=window.SpeechRecognition||window.webkitSpeechRecognition;return e?(this.recognition=new e,this.recognition.continuous=!1,this.recognition.interimResults=!1,this.recognition.lang=\"en-US\",this.recognition.maxAlternatives=3,this.recognition.onstart=()=>{this.isListening=!0,this.triggerEvent({type:\"listening-start\"}),console.log(\"ðŸŽ¤ Speech recognition started\")},this.recognition.onend=()=>{this.isListening=!1,this.triggerEvent({type:\"listening-end\"}),console.log(\"ðŸŽ¤ Speech recognition ended\"),this.continuousMode&&this.isEnabled&&setTimeout(()=>{this.isEnabled&&!this.isListening&&this.startListening()},1e3)},this.recognition.onresult=o=>{var r,a,c;const t=Array.from(o.results),i=t[t.length-1],n=((a=(r=i==null?void 0:i[0])==null?void 0:r.transcript)==null?void 0:a.toLowerCase())||\"\",s=((c=i==null?void 0:i[0])==null?void 0:c.confidence)||0;console.log(`ðŸŽ¤ Speech recognized: \"${n}\" (confidence: ${s.toFixed(2)})`),n&&this.processVoiceCommand(n,s)},this.recognition.onerror=o=>{if(console.error(\"Speech recognition error:\",o.error),o.error===\"aborted\"&&!this.isEnabled){console.log(\"ðŸŽ¤ Speech recognition properly stopped\");return}this.triggerEvent({type:\"error\",error:o.error})},this.recognition.onnomatch=()=>{console.log(\"ðŸŽ¤ No speech match found\"),this.triggerEvent({type:\"no-match\"})},console.log(\"âœ“ Speech recognition service initialized\"),!0):(console.warn(\"Speech recognition not supported in this browser\"),!1)}catch(e){return console.error(\"Failed to initialize speech recognition:\",e),!1}}processVoiceCommand(e,o){const t=Date.now();if(t-this.lastCommandTime<2e3){console.log(\"ðŸŽ¤ Command ignored - too soon after previous command\");return}for(const[i,n]of Array.from(this.voiceCommands.entries())){const s=n.phrases.find(r=>r.toLowerCase().split(\" \").every(c=>e.includes(c)));if(s&&o>.6){console.log(`ðŸŽ¤ Voice command matched: ${i} (\"${s}\")`),this.triggerEvent({type:\"command-recognized\",command:i,confidence:o,transcript:e});try{n.action(),this.lastCommandTime=t,this.continuousMode||setTimeout(()=>{this.stopListening()},100)}catch(r){console.error(`Error executing voice command ${i}:`,r)}return}}console.log(`ðŸŽ¤ No matching voice command for: \"${e}\"`),this.triggerEvent({type:\"no-match\",transcript:e})}registerCommand(e,o){this.voiceCommands.set(e,o),console.log(`ðŸŽ¤ Registered voice command: ${e} - ${o.phrases.join(\", \")}`)}unregisterCommand(e){this.voiceCommands.delete(e)}async startListening(e=!1){if(!this.recognition||this.isListening)return!1;try{return this.continuousMode=e,this.isEnabled=!0,this.recognition.start(),!0}catch(o){return console.error(\"Failed to start speech recognition:\",o),!1}}stopListening(){if(this.recognition){this.isEnabled=!1,this.continuousMode=!1;try{this.recognition.stop(),console.log(\"ðŸ›‘ Speech recognition stop requested\")}catch(e){console.warn(\"Speech recognition stop error (expected):\",e)}this.isListening=!1}}isCurrentlyListening(){return this.isListening}isSpeechEnabled(){return this.isEnabled}isSupported(){return!!(window.SpeechRecognition||window.webkitSpeechRecognition)}on(e){this.handlers.push(e)}off(e){const o=this.handlers.indexOf(e);o>-1&&this.handlers.splice(o,1)}triggerEvent(e){this.handlers.forEach(o=>{try{o(e)}catch(t){console.error(\"Error in speech event handler:\",t)}})}getSettings(){return{enabled:localStorage.getItem(\"platemate-speech-enabled\")===\"true\",continuous:localStorage.getItem(\"platemate-speech-continuous\")===\"true\",wakeWord:localStorage.getItem(\"platemate-wake-word\")||\"hey platemate\",voiceConfirmation:localStorage.getItem(\"platemate-voice-confirmation\")!==\"false\"}}updateSettings(e){Object.entries(e).forEach(([o,t])=>{t!==void 0&&localStorage.setItem(`platemate-${o.replace(/([A-Z])/g,\"-$1\").toLowerCase()}`,t.toString())})}getAvailableCommands(){return Array.from(this.voiceCommands.values())}}const g=new h;export{g as speechService};\n","size_bytes":4086},"client/src/components/search-filter-bar.tsx":{"content":"import { useState } from \"react\";\nimport { Search, Filter, Calendar, X } from \"lucide-react\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\nimport { format } from \"date-fns\";\n\ninterface SearchFilterBarProps {\n  searchQuery: string;\n  onSearchChange: (query: string) => void;\n  mealTypeFilter: string;\n  onMealTypeChange: (type: string) => void;\n  dateRange: { start?: Date; end?: Date };\n  onDateRangeChange: (range: { start?: Date; end?: Date }) => void;\n  calorieRange: { min?: number; max?: number };\n  onCalorieRangeChange: (range: { min?: number; max?: number }) => void;\n  onClearFilters: () => void;\n  hasActiveFilters: boolean;\n}\n\nexport function SearchFilterBar({\n  searchQuery,\n  onSearchChange,\n  mealTypeFilter,\n  onMealTypeChange,\n  dateRange,\n  onDateRangeChange,\n  calorieRange,\n  onCalorieRangeChange,\n  onClearFilters,\n  hasActiveFilters,\n}: SearchFilterBarProps) {\n  const [filterOpen, setFilterOpen] = useState(false);\n\n  return (\n    <div className=\"space-y-3 p-4 bg-card border rounded-lg\">\n      {/* Search Bar */}\n      <div className=\"relative\">\n        <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n        <Input\n          placeholder=\"Search your meals...\"\n          value={searchQuery}\n          onChange={(e) => onSearchChange(e.target.value)}\n          className=\"pl-10\"\n          data-testid=\"input-search\"\n        />\n      </div>\n\n      {/* Filter Controls */}\n      <div className=\"flex items-center gap-2 flex-wrap\">\n        <Popover open={filterOpen} onOpenChange={setFilterOpen}>\n          <PopoverTrigger asChild>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              className={hasActiveFilters ? \"border-primary bg-primary/10\" : \"\"}\n              data-testid=\"button-filters\"\n            >\n              <Filter className=\"h-4 w-4 mr-1\" />\n              Filters\n              {hasActiveFilters && (\n                <span className=\"ml-1 w-2 h-2 bg-primary rounded-full\"></span>\n              )}\n            </Button>\n          </PopoverTrigger>\n          <PopoverContent className=\"w-80\" align=\"start\">\n            <div className=\"space-y-4\">\n              <div>\n                <h4 className=\"font-medium mb-2\">Filters</h4>\n              </div>\n              \n              {/* Meal Type Filter */}\n              <div className=\"space-y-2\">\n                <label className=\"text-sm font-medium\">Meal Type</label>\n                <Select value={mealTypeFilter} onValueChange={onMealTypeChange}>\n                  <SelectTrigger data-testid=\"select-meal-type-filter\">\n                    <SelectValue placeholder=\"All meals\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">All meals</SelectItem>\n                    <SelectItem value=\"breakfast\">ðŸŒ… Breakfast</SelectItem>\n                    <SelectItem value=\"lunch\">ðŸŒž Lunch</SelectItem>\n                    <SelectItem value=\"dinner\">ðŸŒœ Dinner</SelectItem>\n                    <SelectItem value=\"snack\">ðŸŽ Snack</SelectItem>\n                    <SelectItem value=\"custom\">âœ¨ Custom</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n\n              {/* Date Range */}\n              <div className=\"space-y-2\">\n                <label className=\"text-sm font-medium\">Date Range</label>\n                <div className=\"grid grid-cols-2 gap-2\">\n                  <Input\n                    type=\"date\"\n                    value={dateRange.start ? format(dateRange.start, 'yyyy-MM-dd') : ''}\n                    onChange={(e) => onDateRangeChange({\n                      ...dateRange,\n                      start: e.target.value ? new Date(e.target.value) : undefined\n                    })}\n                    data-testid=\"input-date-start\"\n                  />\n                  <Input\n                    type=\"date\"\n                    value={dateRange.end ? format(dateRange.end, 'yyyy-MM-dd') : ''}\n                    onChange={(e) => onDateRangeChange({\n                      ...dateRange,\n                      end: e.target.value ? new Date(e.target.value) : undefined\n                    })}\n                    data-testid=\"input-date-end\"\n                  />\n                </div>\n              </div>\n\n              {/* Calorie Range */}\n              <div className=\"space-y-2\">\n                <label className=\"text-sm font-medium\">Calorie Range</label>\n                <div className=\"grid grid-cols-2 gap-2\">\n                  <Input\n                    type=\"number\"\n                    placeholder=\"Min\"\n                    value={calorieRange.min || ''}\n                    onChange={(e) => onCalorieRangeChange({\n                      ...calorieRange,\n                      min: e.target.value ? parseInt(e.target.value) : undefined\n                    })}\n                    data-testid=\"input-calorie-min\"\n                  />\n                  <Input\n                    type=\"number\"\n                    placeholder=\"Max\"\n                    value={calorieRange.max || ''}\n                    onChange={(e) => onCalorieRangeChange({\n                      ...calorieRange,\n                      max: e.target.value ? parseInt(e.target.value) : undefined\n                    })}\n                    data-testid=\"input-calorie-max\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"flex justify-between pt-2\">\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={onClearFilters}\n                  disabled={!hasActiveFilters}\n                  data-testid=\"button-clear-filters\"\n                >\n                  <X className=\"h-4 w-4 mr-1\" />\n                  Clear\n                </Button>\n                <Button\n                  size=\"sm\"\n                  onClick={() => setFilterOpen(false)}\n                  data-testid=\"button-apply-filters\"\n                >\n                  Apply\n                </Button>\n              </div>\n            </div>\n          </PopoverContent>\n        </Popover>\n\n        {hasActiveFilters && (\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={onClearFilters}\n            className=\"text-muted-foreground\"\n            data-testid=\"button-clear-all-filters\"\n          >\n            <X className=\"h-4 w-4\" />\n          </Button>\n        )}\n      </div>\n    </div>\n  );\n}","size_bytes":6748},"server/ai-providers/types.ts":{"content":"// AI Provider Types and Interfaces\n\nexport interface FoodAnalysisResult {\n  imageUrl: string;\n  confidence: number;\n  totalCalories: number;\n  totalProtein: number;\n  totalCarbs: number;\n  totalFat: number;\n  detectedFoods: DetectedFood[];\n  isAITemporarilyUnavailable?: boolean; // Flag for when AI services are down\n}\n\nexport interface DetectedFood {\n  name: string;\n  portion: string;\n  calories: number;\n  protein: number;\n  carbs: number;\n  fat: number;\n  icon: string;\n}\n\n// Interface for food detection - simple food name detection only\nexport interface FoodDetectionResult {\n  confidence: number; // 0-100\n  detectedFoodNames: string[]; // Simple array of food names for USDA lookup\n  referenceObjects?: string[]; // Optional reference objects for portion estimation\n}\n\nexport interface MealIdea {\n  mealType: 'breakfast' | 'lunch' | 'dinner' | 'snack';\n  name: string;\n  description: string;\n  calories: number;\n  protein: number;\n  carbs: number;\n  fat: number;\n  ingredients: string[];\n  benefits: string;\n  recipeLink?: string;\n  cookingInstructions?: string[];\n}\n\nexport interface DietAdviceResult {\n  personalizedAdvice: string[];\n  nutritionGoals: string[];\n  improvements: string[];\n  generalTips: string[];\n  mealIdeas: MealIdea[];\n}\n\nexport interface DiaryEntry {\n  id: string;\n  mealType: string;\n  analysis?: FoodAnalysisResult;\n  createdAt: Date;\n}\n\nexport interface DailyCoaching {\n  motivation: string;\n  nutritionTip: string;\n  medicationTip?: string;\n  encouragement: string;\n  todaysFocus: string;\n  streak: number;\n  achievement?: string;\n}\n\nexport interface EducationalTip {\n  id: string;\n  title: string;\n  content: string;\n  category: 'nutrition' | 'medication' | 'motivation';\n  importance: 'high' | 'medium' | 'low';\n}\n\nexport interface ProviderError {\n  code: string;\n  message: string;\n  isRateLimit: boolean;\n  isTemporary: boolean;\n  retryAfter?: number;\n}\n\nexport interface ProviderStatus {\n  name: string;\n  available: boolean;\n  lastError?: ProviderError;\n  lastSuccess?: Date;\n  requestCount: number;\n  errorCount: number;\n}\n\nexport interface HealthCheckResult {\n  providerName: string;\n  healthy: boolean;\n  responseTime: number;\n  error?: string;\n  timestamp: Date;\n  details?: {\n    model?: string;\n    apiVersion?: string;\n    rateLimit?: {\n      remaining: number;\n      resetTime: Date;\n    };\n  };\n}\n\nexport abstract class AIProvider {\n  public abstract readonly name: string;\n  public abstract readonly priority: number; // Lower number = higher priority\n  public abstract readonly maxRetries: number;\n\n  protected requestCount = 0;\n  protected errorCount = 0;\n  protected lastError?: ProviderError;\n  protected lastSuccess?: Date;\n\n  abstract analyzeFoodImage(imagePath: string): Promise<FoodAnalysisResult>;\n  abstract analyzeFoodText(foodDescription: string, clientTimeInfo?: { timeString: string, timeOfDay: string, hours: number, minutes: number }): Promise<FoodAnalysisResult>;\n  // New method for food detection only (no nutrition calculation)\n  abstract detectFoodNames(imagePath: string): Promise<FoodDetectionResult>;\n  abstract generateDietAdvice(entries: DiaryEntry[], userProfile?: any): Promise<DietAdviceResult>;\n  abstract answerNutritionQuestion(\n    question: string, \n    entries: DiaryEntry[], \n    userProfile?: any, \n    nutritionGoals?: any,\n    coachMemory?: any,\n    personality?: any,\n    clientTimeInfo?: { timeString: string, timeOfDay: string, hours: number, minutes: number }\n  ): Promise<string>;\n  abstract generateDailyCoaching(entries: DiaryEntry[], userProfile?: any): Promise<DailyCoaching>;\n  abstract generateEducationalTips(category: 'all' | 'nutrition' | 'medication' | 'motivation'): Promise<EducationalTip[]>;\n  \n  // Health check method for startup optimization\n  abstract performHealthCheck(): Promise<HealthCheckResult>;\n\n  public getStatus(): ProviderStatus {\n    return {\n      name: this.name,\n      available: this.isAvailable(),\n      lastError: this.lastError,\n      lastSuccess: this.lastSuccess,\n      requestCount: this.requestCount,\n      errorCount: this.errorCount\n    };\n  }\n\n  public isAvailable(): boolean {\n    // Provider is unavailable if it has recent rate limit errors\n    if (this.lastError?.isRateLimit) {\n      const retryAfter = this.lastError.retryAfter || 60;\n      const canRetryAt = new Date((this.lastError as any).timestamp + retryAfter * 1000);\n      return new Date() > canRetryAt;\n    }\n    \n    // Provider is unavailable if error rate is too high\n    const errorRate = this.requestCount > 0 ? this.errorCount / this.requestCount : 0;\n    return errorRate < 0.8; // Available if less than 80% error rate\n  }\n\n  protected recordSuccess() {\n    this.requestCount++;\n    this.lastSuccess = new Date();\n    this.lastError = undefined;\n  }\n\n  protected recordError(error: ProviderError) {\n    this.requestCount++;\n    this.errorCount++;\n    this.lastError = {\n      ...error,\n      timestamp: Date.now()\n    } as any;\n  }\n\n  protected createError(\n    code: string, \n    message: string, \n    isRateLimit: boolean = false,\n    isTemporary: boolean = true,\n    retryAfter?: number\n  ): ProviderError {\n    return {\n      code,\n      message,\n      isRateLimit,\n      isTemporary,\n      retryAfter\n    };\n  }\n}","size_bytes":5231},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","size_bytes":325},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2765},"client/src/components/calorie-calculator.tsx":{"content":"import React from 'react';\nimport { User, Scale, Target, Activity, Calculator } from 'lucide-react';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { useForm } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from '@/components/ui/form';\nimport { insertUserProfileSchema, type InsertUserProfile, type UserProfile } from '@shared/schema';\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\nimport { apiRequest } from '@/lib/queryClient';\nimport { useToast } from '@/hooks/use-toast';\nimport { useLocation } from 'wouter';\nimport { z } from 'zod';\nimport { \n  calculateNutritionTargets, \n  calculateMacroTargets, \n  getMedicationAdjustment,\n  type UserData\n} from '@/lib/nutrition-calculator';\n\ninterface CalorieCalculatorProps {\n  onCaloriesCalculated?: (calories: number) => void;\n}\n\n// Enhanced schema with all required fields for calculation\nconst profileFormSchema = insertUserProfileSchema.extend({\n  age: z.number().min(10).max(120),\n  sex: z.enum([\"male\", \"female\"]),\n  heightCm: z.number().min(100).max(250),\n  currentWeightKg: z.number().min(30).max(300),\n  goalWeightKg: z.number().min(30).max(300),\n  activityLevel: z.enum([\"sedentary\", \"lightly_active\", \"moderately_active\", \"very_active\", \"extra_active\"]),\n  weightGoal: z.enum([\"lose_weight\", \"maintain_weight\", \"gain_weight\"]),\n  medication: z.enum([\"none\", \"ozempic\", \"wegovy\", \"mounjaro\", \"other_glp1\"]).optional(),\n});\n\ntype ProfileFormData = z.infer<typeof profileFormSchema>;\n\nexport function CalorieCalculator({ onCaloriesCalculated }: CalorieCalculatorProps) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [, setLocation] = useLocation();\n  const [calculatedCalories, setCalculatedCalories] = React.useState<number | null>(null);\n  const [bmrData, setBmrData] = React.useState<any>(null);\n  const [currentWeightGoal, setCurrentWeightGoal] = React.useState<string>('maintain_weight');\n  \n  // Load form data from localStorage as fallback\n  const loadFormDataFromStorage = () => {\n    try {\n      const saved = localStorage.getItem('calculator-form-data');\n      return saved ? JSON.parse(saved) : null;\n    } catch {\n      return null;\n    }\n  };\n  \n  // Save form data to localStorage\n  const saveFormDataToStorage = (data: ProfileFormData) => {\n    try {\n      localStorage.setItem('calculator-form-data', JSON.stringify(data));\n    } catch (error) {\n      console.warn('Could not save form data to localStorage:', error);\n    }\n  };\n\n  // Fetch existing profile\n  const { data: profile, isLoading } = useQuery<UserProfile>({\n    queryKey: ['/api/user-profile'],\n    retry: false,\n  });\n\n  // Get initial form data from saved profile or localStorage\n  const getInitialFormData = () => {\n    const savedData = loadFormDataFromStorage();\n    return {\n      age: profile?.age || savedData?.age || 25,\n      sex: (profile?.sex as \"male\" | \"female\") || savedData?.sex || \"male\",\n      heightCm: profile?.heightCm || savedData?.heightCm || 170,\n      currentWeightKg: profile?.currentWeightKg || savedData?.currentWeightKg || 70,\n      goalWeightKg: profile?.goalWeightKg || savedData?.goalWeightKg || 65,\n      activityLevel: (profile?.activityLevel as any) || savedData?.activityLevel || \"moderately_active\",\n      weightGoal: (profile?.weightGoal as any) || savedData?.weightGoal || \"maintain_weight\",\n      weeklyWeightChangeKg: profile?.weeklyWeightChangeKg || savedData?.weeklyWeightChangeKg || 0.75,\n      medication: (profile?.medication as any) || savedData?.medication || \"none\",\n    };\n  };\n\n  const form = useForm<ProfileFormData>({\n    resolver: zodResolver(profileFormSchema),\n    defaultValues: getInitialFormData(),\n  });\n\n  // Update form when profile loads or save current form data\n  React.useEffect(() => {\n    console.log('Profile data loaded:', profile);\n    \n    if (profile) {\n      // If we have a saved profile, use it\n      const formData = {\n        age: profile.age && profile.age > 0 ? profile.age : 25,\n        sex: (profile.sex as \"male\" | \"female\") || \"male\",\n        heightCm: profile.heightCm && profile.heightCm > 0 ? profile.heightCm : 170,\n        currentWeightKg: profile.currentWeightKg && profile.currentWeightKg > 0 ? profile.currentWeightKg : 70,\n        goalWeightKg: profile.goalWeightKg && profile.goalWeightKg > 0 ? profile.goalWeightKg : 65,\n        activityLevel: (profile.activityLevel as any) || \"moderately_active\",\n        weightGoal: (profile.weightGoal as any) || \"maintain_weight\",\n        weeklyWeightChangeKg: profile.weeklyWeightChangeKg || 0,\n        medication: (profile.medication as any) || \"none\",\n      };\n      console.log('Setting form data from profile:', formData);\n      form.reset(formData);\n    } else {\n      // If no profile, try to restore from localStorage\n      const savedData = loadFormDataFromStorage();\n      if (savedData) {\n        console.log('Restoring form data from localStorage:', savedData);\n        form.reset(savedData);\n      }\n    }\n  }, [profile, form]);\n  \n  // Auto-save form data to localStorage when form changes\n  React.useEffect(() => {\n    const subscription = form.watch((data) => {\n      if (data.age && data.sex && data.heightCm && data.currentWeightKg) {\n        saveFormDataToStorage(data as ProfileFormData);\n      }\n    });\n    return () => subscription.unsubscribe();\n  }, [form]);\n\n  const saveProfileMutation = useMutation({\n    mutationFn: async (data: InsertUserProfile) => {\n      await apiRequest('POST', '/api/user-profile', data);\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Profile Saved\",\n        description: \"Your profile and calorie calculation has been saved.\",\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/user-profile'] });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to save profile. Please try again.\",\n        variant: \"destructive\",\n      });\n      console.error(\"Error saving profile:\", error);\n    },\n  });\n\n  const updateGoalsMutation = useMutation({\n    mutationFn: async (goals: { dailyCalories: number; dailyProtein: number; dailyCarbs: number; dailyFat: number; dailyWater: number }) => {\n      await apiRequest('POST', '/api/nutrition-goals', goals);\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Goals Saved! ðŸŽ¯\",\n        description: \"Redirecting to your goals page...\",\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/nutrition-goals'] });\n      \n      // Redirect to goals page after short delay\n      setTimeout(() => {\n        setLocation('/goals');\n      }, 1500);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to update goals. Please try again.\",\n        variant: \"destructive\",\n      });\n      console.error(\"Error updating goals:\", error);\n    },\n  });\n\n\n  const handleCalculate = (data: ProfileFormData) => {\n    // Convert form data to UserData format for shared calculator\n    const userData: UserData = {\n      age: data.age,\n      sex: data.sex,\n      heightCm: data.heightCm,\n      currentWeightKg: data.currentWeightKg,\n      goalWeightKg: data.goalWeightKg,\n      activityLevel: data.activityLevel,\n      weightGoal: data.weightGoal,\n      weeklyWeightChangeKg: data.weeklyWeightChangeKg || undefined,\n      medication: data.medication,\n    };\n    \n    // Use shared calculation function\n    const calculationData = calculateNutritionTargets(userData);\n    \n    setCalculatedCalories(calculationData.targetCalories);\n    setBmrData(calculationData);\n    setCurrentWeightGoal(data.weightGoal);\n    \n    // Automatically update nutrition goals with weight goal for science-based macros\n    const goals = calculateMacroTargets(calculationData.targetCalories, data.weightGoal);\n    updateGoalsMutation.mutate(goals);\n    \n    if (onCaloriesCalculated) {\n      onCaloriesCalculated(calculationData.targetCalories);\n    }\n  };\n\n\n  const onSubmit = (data: ProfileFormData) => {\n    console.log('Form submitted with data:', data);\n    console.log('Form errors:', form.formState.errors);\n    \n    // Validate required fields with better error messaging\n    if (!data.age || data.age < 10 || data.age > 120) {\n      toast({\n        title: \"Invalid Age\",\n        description: \"Please enter a valid age between 10 and 120 years.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    \n    if (!data.sex) {\n      toast({\n        title: \"Missing Information\",\n        description: \"Please select your sex.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    \n    if (!data.heightCm || data.heightCm < 100 || data.heightCm > 250) {\n      toast({\n        title: \"Invalid Height\",\n        description: \"Please enter a valid height between 100-250 cm.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    \n    if (!data.currentWeightKg || data.currentWeightKg < 30 || data.currentWeightKg > 300) {\n      toast({\n        title: \"Invalid Current Weight\",\n        description: \"Please enter a valid current weight between 30-300 kg.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    \n    if (!data.goalWeightKg || data.goalWeightKg < 30 || data.goalWeightKg > 300) {\n      toast({\n        title: \"Invalid Goal Weight\", \n        description: \"Please enter a valid goal weight between 30-300 kg.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    \n    if (!data.activityLevel) {\n      toast({\n        title: \"Missing Activity Level\",\n        description: \"Please select your activity level.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    \n    if (!data.weightGoal) {\n      toast({\n        title: \"Missing Weight Goal\",\n        description: \"Please select your weight goal.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    // Always calculate first\n    handleCalculate(data);\n    // Then save profile\n    saveProfileMutation.mutate(data);\n  };\n\n  // Add a calculate-only function that doesn't save profile\n  const handleCalculateOnly = () => {\n    const formData = form.getValues();\n    \n    // Validate required fields\n    if (!formData.age || !formData.sex || !formData.heightCm || !formData.currentWeightKg || \n        !formData.goalWeightKg || !formData.activityLevel || !formData.weightGoal || !formData.medication) {\n      toast({\n        title: \"Missing Information\",\n        description: \"Please fill in all required fields to calculate your calories.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    \n    handleCalculate(formData as ProfileFormData);\n  };\n\n  if (isLoading) {\n    return (\n      <Card>\n        <CardContent className=\"p-6\">\n          <div className=\"animate-pulse space-y-4\">\n            <div className=\"h-4 bg-muted rounded w-1/3\"></div>\n            <div className=\"space-y-2\">\n              <div className=\"h-3 bg-muted rounded\"></div>\n              <div className=\"h-3 bg-muted rounded w-2/3\"></div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6 pb-8\">\n      <Card className=\"bg-gradient-to-br from-white via-blue-50/30 to-purple-50/30 dark:from-gray-900 dark:via-blue-950/20 dark:to-purple-950/20 border border-border/50 shadow-2xl overflow-hidden\">\n        <CardHeader className=\"bg-gradient-to-r from-purple-600 via-purple-500 to-pink-500 text-white pb-8 pt-6 px-6\">\n          <CardTitle className=\"flex items-center gap-3 text-2xl font-bold\">\n            <div className=\"p-2.5 bg-white/20 rounded-xl backdrop-blur-sm\">\n              <Calculator className=\"h-7 w-7\" />\n            </div>\n            Personal Calorie Calculator\n          </CardTitle>\n          <CardDescription className=\"text-purple-50 text-base mt-2 leading-relaxed\">\n            Calculate your daily calorie and macro needs based on science-based formulas\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"p-6 md:p-8\">\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-5\">\n                {/* Basic Info */}\n                <FormField\n                  control={form.control}\n                  name=\"age\"\n                  render={({ field }) => (\n                    <FormItem className=\"space-y-3\">\n                      <FormLabel className=\"flex items-center gap-2 text-sm font-semibold text-foreground\">\n                        <div className=\"p-1.5 bg-blue-100 dark:bg-blue-900/30 rounded-lg\">\n                          <User className=\"h-4 w-4 text-blue-600 dark:text-blue-400\" />\n                        </div>\n                        Age (years)\n                      </FormLabel>\n                      <FormControl>\n                        <Input \n                          type=\"number\" \n                          onChange={(e) => {\n                            const value = e.target.value;\n                            // Allow user to clear field completely\n                            if (value === '') {\n                              field.onChange(0);\n                              return;\n                            }\n                            const parsed = parseInt(value);\n                            field.onChange(isNaN(parsed) ? 0 : parsed);\n                          }}\n                          value={field.value === 0 || field.value === null || field.value === undefined ? '' : field.value}\n                          data-testid=\"input-age\"\n                          className=\"border-2 border-border/40 hover:border-purple-300 focus:border-purple-500 transition-all duration-200 shadow-sm bg-background rounded-xl px-4 py-3 text-base h-12\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"sex\"\n                  render={({ field }) => (\n                    <FormItem className=\"space-y-3\">\n                      <FormLabel className=\"text-sm font-semibold text-foreground flex items-center gap-2\">\n                        <span>ðŸ‘¤</span> Sex\n                      </FormLabel>\n                      <Select onValueChange={field.onChange} defaultValue={field.value}>\n                        <FormControl>\n                          <SelectTrigger data-testid=\"select-sex\" className=\"border-2 border-border/40 hover:border-purple-300 focus:border-purple-500 transition-all duration-200 shadow-sm bg-background rounded-xl px-4 py-3 text-base h-12\">\n                            <SelectValue placeholder=\"Select sex\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          <SelectItem value=\"male\">Male</SelectItem>\n                          <SelectItem value=\"female\">Female</SelectItem>\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"heightCm\"\n                  render={({ field }) => (\n                    <FormItem className=\"space-y-3\">\n                      <FormLabel className=\"text-sm font-semibold text-foreground flex items-center gap-2\">\n                        <div className=\"p-1.5 bg-green-100 dark:bg-green-900/30 rounded-lg\">\n                          ðŸ“\n                        </div>\n                        Height (cm)\n                      </FormLabel>\n                      <FormControl>\n                        <Input \n                          type=\"number\" \n                          onChange={(e) => {\n                            const value = e.target.value;\n                            // Allow user to clear field completely\n                            if (value === '') {\n                              field.onChange(0);\n                              return;\n                            }\n                            const parsed = parseInt(value);\n                            field.onChange(isNaN(parsed) ? 0 : parsed);\n                          }}\n                          value={field.value === 0 || field.value === null || field.value === undefined ? '' : field.value}\n                          data-testid=\"input-height\"\n                          className=\"border-2 border-border/40 hover:border-purple-300 focus:border-purple-500 transition-all duration-200 shadow-sm bg-background rounded-xl px-4 py-3 text-base h-12\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"currentWeightKg\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel className=\"flex items-center gap-2 text-sm font-semibold text-foreground\">\n                        <div className=\"p-1.5 bg-orange-100 dark:bg-orange-900/30 rounded-lg\">\n                          <Scale className=\"h-4 w-4 text-orange-600 dark:text-orange-400\" />\n                        </div>\n                        Current Weight (kg)\n                      </FormLabel>\n                      <FormControl>\n                        <Input \n                          type=\"number\" \n                          onChange={(e) => {\n                            const value = e.target.value;\n                            // Allow user to clear field completely\n                            if (value === '') {\n                              field.onChange(0);\n                              return;\n                            }\n                            const parsed = parseInt(value);\n                            field.onChange(isNaN(parsed) ? 0 : parsed);\n                          }}\n                          value={field.value === 0 || field.value === null || field.value === undefined ? '' : field.value}\n                          data-testid=\"input-current-weight\"\n                          className=\"border-2 border-border/40 hover:border-purple-300 focus:border-purple-500 transition-all duration-200 shadow-sm bg-background rounded-xl px-4 py-3 text-base h-12\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"goalWeightKg\"\n                  render={({ field }) => (\n                    <FormItem className=\"space-y-3\">\n                      <FormLabel className=\"flex items-center gap-2 text-sm font-semibold text-foreground\">\n                        <div className=\"p-1.5 bg-purple-100 dark:bg-purple-900/30 rounded-lg\">\n                          <Target className=\"h-4 w-4 text-purple-600 dark:text-purple-400\" />\n                        </div>\n                        Goal Weight (kg)\n                      </FormLabel>\n                      <FormControl>\n                        <Input \n                          type=\"number\" \n                          onChange={(e) => {\n                            const value = e.target.value;\n                            // Allow user to clear field completely\n                            if (value === '') {\n                              field.onChange(0);\n                              return;\n                            }\n                            const parsed = parseInt(value);\n                            field.onChange(isNaN(parsed) ? 0 : parsed);\n                          }}\n                          value={field.value === 0 || field.value === null || field.value === undefined ? '' : field.value}\n                          data-testid=\"input-goal-weight\"\n                          className=\"border-2 border-border/40 hover:border-purple-300 focus:border-purple-500 transition-all duration-200 shadow-sm bg-background rounded-xl px-4 py-3 text-base h-12\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"activityLevel\"\n                  render={({ field }) => (\n                    <FormItem className=\"space-y-3\">\n                      <FormLabel className=\"flex items-center gap-2 text-sm font-semibold text-foreground\">\n                        <div className=\"p-1.5 bg-emerald-100 dark:bg-emerald-900/30 rounded-lg\">\n                          <Activity className=\"h-4 w-4 text-emerald-600 dark:text-emerald-400\" />\n                        </div>\n                        Activity Level\n                      </FormLabel>\n                      <Select onValueChange={field.onChange} defaultValue={field.value}>\n                        <FormControl>\n                          <SelectTrigger data-testid=\"select-activity\" className=\"border-2 border-border/40 hover:border-purple-300 focus:border-purple-500 transition-all duration-200 shadow-sm bg-background rounded-xl px-4 py-3 text-base h-12\">\n                            <SelectValue placeholder=\"Select activity level\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          <SelectItem value=\"sedentary\">Sedentary (desk job, no exercise)</SelectItem>\n                          <SelectItem value=\"lightly_active\">Lightly Active (light exercise 1-3 days/week)</SelectItem>\n                          <SelectItem value=\"moderately_active\">Moderately Active (moderate exercise 3-5 days/week)</SelectItem>\n                          <SelectItem value=\"very_active\">Very Active (heavy exercise 6-7 days/week)</SelectItem>\n                          <SelectItem value=\"extra_active\">Extra Active (very heavy exercise, physical job)</SelectItem>\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              {/* Weight Goal */}\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-5\">\n                <FormField\n                  control={form.control}\n                  name=\"weightGoal\"\n                  render={({ field }) => (\n                    <FormItem className=\"space-y-3\">\n                      <FormLabel className=\"text-sm font-semibold text-foreground flex items-center gap-2\">\n                        ðŸŽ¯ Weight Goal\n                      </FormLabel>\n                      <Select onValueChange={field.onChange} defaultValue={field.value}>\n                        <FormControl>\n                          <SelectTrigger data-testid=\"select-weight-goal\" className=\"border-2 border-border/40 hover:border-purple-300 focus:border-purple-500 transition-all duration-200 shadow-sm bg-background rounded-xl px-4 py-3 text-base h-12\">\n                            <SelectValue placeholder=\"Select weight goal\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          <SelectItem value=\"lose_weight\">Lose Weight</SelectItem>\n                          <SelectItem value=\"maintain_weight\">Maintain Weight</SelectItem>\n                          <SelectItem value=\"gain_weight\">Gain Weight</SelectItem>\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"weeklyWeightChangeKg\"\n                  render={({ field }) => (\n                    <FormItem className=\"space-y-3\">\n                      <FormLabel className=\"text-sm font-semibold text-foreground flex items-center gap-2\">\n                        <div className=\"p-1.5 bg-indigo-100 dark:bg-indigo-900/30 rounded-lg\">\n                          ðŸ“ˆ\n                        </div>\n                        Target Weekly Change (kg)\n                      </FormLabel>\n                      <FormControl>\n                        <Input \n                          type=\"number\" \n                          step=\"0.1\"\n                          onChange={(e) => {\n                            const value = e.target.value;\n                            // Allow user to clear field completely\n                            if (value === '') {\n                              field.onChange(0);\n                              return;\n                            }\n                            const parsed = parseFloat(value);\n                            field.onChange(isNaN(parsed) ? 0 : parsed);\n                          }}\n                          value={field.value === 0 || field.value === null || field.value === undefined ? '' : field.value}\n                          data-testid=\"input-weekly-change\"\n                          placeholder=\"0.5\"\n                          className=\"border-2 border-border/40 hover:border-purple-300 focus:border-purple-500 transition-all duration-200 shadow-sm bg-background rounded-xl px-4 py-3 text-base h-12\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              {/* Medication Field */}\n              <FormField\n                control={form.control}\n                name=\"medication\"\n                render={({ field }) => (\n                  <FormItem className=\"space-y-3\">\n                    <FormLabel className=\"flex items-center gap-2 text-sm font-semibold text-foreground\">\n                      <div className=\"p-1.5 bg-teal-100 dark:bg-teal-900/30 rounded-lg\">\n                        <Activity className=\"h-4 w-4 text-teal-600 dark:text-teal-400\" />\n                      </div>\n                      Weight Loss Medication\n                    </FormLabel>\n                    <Select onValueChange={field.onChange} defaultValue={field.value}>\n                      <FormControl>\n                        <SelectTrigger data-testid=\"select-medication\" className=\"border-2 border-border/40 hover:border-purple-300 focus:border-purple-500 transition-all duration-200 shadow-sm bg-background rounded-xl px-4 py-3 text-base h-12\">\n                          <SelectValue placeholder=\"Select medication (if any)\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        <SelectItem value=\"none\">No medication</SelectItem>\n                        <SelectItem value=\"ozempic\">Ozempic (Semaglutide)</SelectItem>\n                        <SelectItem value=\"wegovy\">Wegovy (Semaglutide)</SelectItem>\n                        <SelectItem value=\"mounjaro\">Mounjaro (Tirzepatide)</SelectItem>\n                        <SelectItem value=\"other_glp1\">Other GLP-1 medication</SelectItem>\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div className=\"space-y-3 pt-6\">\n                <Button \n                  type=\"button\"\n                  onClick={handleCalculateOnly}\n                  className=\"w-full bg-gradient-to-r from-purple-600 via-purple-500 to-pink-500 hover:from-purple-700 hover:via-purple-600 hover:to-pink-600 text-white font-bold py-6 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02] text-lg\"\n                  data-testid=\"button-calculate-only\"\n                >\n                  <Calculator className=\"h-5 w-5 mr-2\" />\n                  Calculate My Nutrition Goals\n                </Button>\n                \n                <Button \n                  type=\"submit\" \n                  variant=\"outline\"\n                  className=\"w-full border-2 border-purple-200 hover:border-purple-400 hover:bg-purple-50 dark:border-purple-800 dark:hover:bg-purple-950/30 font-semibold py-6 rounded-xl transition-all duration-300 text-base\" \n                  disabled={saveProfileMutation.isPending}\n                  data-testid=\"button-save-profile\"\n                >\n                  {saveProfileMutation.isPending ? 'Saving...' : 'Save Profile & Calculate'}\n                </Button>\n              </div>\n            </form>\n          </Form>\n        </CardContent>\n      </Card>\n\n      {/* Results */}\n      {calculatedCalories && bmrData && (\n        <Card className=\"bg-gradient-to-br from-white via-green-50/20 to-emerald-50/20 dark:from-gray-900 dark:via-green-950/10 dark:to-emerald-950/10 border border-border/50 shadow-2xl overflow-hidden\">\n          <CardHeader className=\"bg-gradient-to-r from-green-600 via-emerald-500 to-teal-500 text-white pb-8 pt-6 px-6\">\n            <CardTitle className=\"flex items-center gap-3 text-2xl font-bold\">\n              <div className=\"p-2.5 bg-white/20 rounded-xl backdrop-blur-sm\">\n                <Target className=\"h-7 w-7\" />\n              </div>\n              Your Personalized Nutrition Goals\n            </CardTitle>\n            <CardDescription className=\"text-green-50 text-base mt-2 leading-relaxed\">\n              Science-based targets calculated for your unique profile\n            </CardDescription>\n          </CardHeader>\n          <CardContent className=\"p-6 md:p-8\">\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n              {/* BMR Card */}\n              <div className=\"text-center p-6 bg-gradient-to-br from-blue-100 to-blue-200 dark:from-blue-900/40 dark:to-blue-800/30 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105 border border-blue-200/50\">\n                <div className=\"mb-3\">\n                  <div className=\"w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center mx-auto mb-2 shadow-md\">\n                    <span className=\"text-white text-xl\">âš¡</span>\n                  </div>\n                </div>\n                <div className=\"text-3xl font-bold text-blue-700 dark:text-blue-300 mb-1\">{bmrData.bmr}</div>\n                <div className=\"text-sm font-semibold text-blue-600 dark:text-blue-400\">BMR (calories/day)</div>\n                <div className=\"text-xs text-blue-500 dark:text-blue-400/80 mt-1\">Base metabolic rate</div>\n              </div>\n              \n              {/* TDEE Card */}\n              <div className=\"text-center p-6 bg-gradient-to-br from-green-100 to-green-200 dark:from-green-900/40 dark:to-green-800/30 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105 border border-green-200/50\">\n                <div className=\"mb-3\">\n                  <div className=\"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-2 shadow-md\">\n                    <span className=\"text-white text-xl\">ðŸƒ</span>\n                  </div>\n                </div>\n                <div className=\"text-3xl font-bold text-green-700 dark:text-green-300 mb-1\">{bmrData.tdee}</div>\n                <div className=\"text-sm font-semibold text-green-600 dark:text-green-400\">TDEE (calories/day)</div>\n                <div className=\"text-xs text-green-500 dark:text-green-400/80 mt-1\">Including activity</div>\n              </div>\n              \n              {/* Target Card */}\n              <div className=\"text-center p-6 bg-gradient-to-br from-orange-100 to-orange-200 dark:from-orange-900/40 dark:to-orange-800/30 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105 border border-orange-200/50\">\n                <div className=\"mb-3\">\n                  <div className=\"w-12 h-12 bg-orange-500 rounded-full flex items-center justify-center mx-auto mb-2 shadow-md\">\n                    <span className=\"text-white text-xl\">ðŸŽ¯</span>\n                  </div>\n                </div>\n                <div className=\"text-3xl font-bold text-orange-700 dark:text-orange-300 mb-1\">{calculatedCalories}</div>\n                <div className=\"text-sm font-semibold text-orange-600 dark:text-orange-400\">Target (calories/day)</div>\n                <div className=\"text-xs text-orange-500 dark:text-orange-400/80 mt-1\">To reach goal</div>\n              </div>\n              \n              {/* Weight Change Card */}\n              <div className=\"text-center p-6 bg-gradient-to-br from-purple-100 to-purple-200 dark:from-purple-900/40 dark:to-purple-800/30 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105 border border-purple-200/50\">\n                <div className=\"mb-3\">\n                  <div className=\"w-12 h-12 bg-purple-500 rounded-full flex items-center justify-center mx-auto mb-2 shadow-md\">\n                    <span className=\"text-white text-xl\">â±ï¸</span>\n                  </div>\n                </div>\n                <div className=\"text-3xl font-bold text-purple-700 dark:text-purple-300 mb-1\">\n                  {Math.round(Math.abs(bmrData.weightChange))}kg\n                </div>\n                <div className=\"text-sm font-semibold text-purple-600 dark:text-purple-400\">\n                  {bmrData.weightChange > 0 ? 'To gain' : bmrData.weightChange < 0 ? 'To lose' : 'Maintain'}\n                </div>\n                <div className=\"text-xs text-purple-500 dark:text-purple-400/80 mt-1\">\n                  {Math.round(bmrData.timeToGoal)} days to goal\n                </div>\n              </div>\n            </div>\n            \n            <div className=\"mt-6 p-5 bg-gradient-to-r from-purple-50/50 to-pink-50/50 dark:from-purple-950/20 dark:to-pink-950/20 rounded-xl border border-purple-200/50 dark:border-purple-800/30\">\n              <h4 className=\"font-semibold text-base mb-3 flex items-center gap-2 text-purple-900 dark:text-purple-100\">\n                <Calculator className=\"h-5 w-5\" /> Science-Based Calculation Method\n              </h4>\n              <ul className=\"text-sm text-foreground/80 space-y-2\">\n                <li className=\"flex items-start gap-2\">\n                  <span className=\"text-purple-500 mt-0.5\">â€¢</span>\n                  <span><strong>BMR:</strong> Mifflin-St Jeor equation based on your age, sex, height, and weight</span>\n                </li>\n                <li className=\"flex items-start gap-2\">\n                  <span className=\"text-purple-500 mt-0.5\">â€¢</span>\n                  <span><strong>TDEE:</strong> BMR Ã— activity level multiplier</span>\n                </li>\n                <li className=\"flex items-start gap-2\">\n                  <span className=\"text-purple-500 mt-0.5\">â€¢</span>\n                  <span><strong>Target:</strong> TDEE adjusted for your weight goal (Â±{Math.abs(form.getValues('weeklyWeightChangeKg') || 0.5)}kg/week)</span>\n                </li>\n                {bmrData.medicationAdjustment && (\n                  <li className=\"flex items-start gap-2\">\n                    <span className=\"text-purple-500 mt-0.5\">â€¢</span>\n                    <span><strong>Medication adjustment:</strong> Increased minimum calories for {bmrData.medicationAdjustment.name} to prevent malnutrition</span>\n                  </li>\n                )}\n                <li className=\"flex items-start gap-2\">\n                  <span className=\"text-purple-500 mt-0.5\">â€¢</span>\n                  <span><strong>Timeline:</strong> Based on safe weight change rate</span>\n                </li>\n              </ul>\n            </div>\n\n            {/* Medication-Specific Advice */}\n            {bmrData.medication && bmrData.medication !== 'none' && (\n              <div className=\"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg\">\n                <h4 className=\"font-semibold text-blue-900 dark:text-blue-100 mb-2 flex items-center gap-2\">\n                  <Activity className=\"h-4 w-4\" />\n                  GLP-1 Medication Considerations\n                </h4>\n                <div className=\"space-y-2 text-sm text-blue-800 dark:text-blue-200\">\n                  <p><strong>Higher calorie floor:</strong> Your minimum daily calories are set higher due to appetite suppression effects.</p>\n                  <p><strong>Slower weight loss:</strong> Calorie deficit is limited to prevent too rapid weight loss and nutrient deficiencies.</p>\n                  <p><strong>Important:</strong> Monitor your food intake closely and ensure you're getting adequate nutrition despite reduced appetite.</p>\n                  <div className=\"mt-3 p-2 bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-300 dark:border-yellow-700 rounded text-yellow-800 dark:text-yellow-200\">\n                    <strong>Medical reminder:</strong> Always follow your healthcare provider's guidance on diet and medication management.\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Automatic redirect - goals are updated automatically */}\n            <div className=\"mt-6 p-6 bg-gradient-to-r from-purple-100 via-pink-100 to-purple-100 dark:from-purple-900/30 dark:via-pink-900/30 dark:to-purple-900/30 border-2 border-purple-300 dark:border-purple-700 rounded-2xl shadow-lg\">\n              <div className=\"text-center\">\n                <div className=\"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-purple-600 to-pink-600 rounded-full mb-4\">\n                  <Target className=\"h-8 w-8 text-white\" />\n                </div>\n                <h4 className=\"font-bold text-xl text-purple-900 dark:text-purple-100 mb-2\">\n                  Goals Updated Successfully! \n                </h4>\n                <p className=\"text-purple-700 dark:text-purple-300 mb-4 text-base\">\n                  Your nutrition targets have been automatically set. You'll be redirected to your goals page shortly.\n                </p>\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4\">\n                  <div className=\"text-center p-4 bg-white/80 dark:bg-gray-900/50 rounded-xl border border-purple-200 dark:border-purple-800\">\n                    <div className=\"font-bold text-2xl text-purple-600 dark:text-purple-400\">{calculateMacroTargets(calculatedCalories, currentWeightGoal).dailyCalories}</div>\n                    <div className=\"text-xs text-purple-600/70 dark:text-purple-400/70 font-semibold mt-1\">Calories</div>\n                  </div>\n                  <div className=\"text-center p-4 bg-white/80 dark:bg-gray-900/50 rounded-xl border border-purple-200 dark:border-purple-800\">\n                    <div className=\"font-bold text-2xl text-purple-600 dark:text-purple-400\">{calculateMacroTargets(calculatedCalories, currentWeightGoal).dailyProtein}g</div>\n                    <div className=\"text-xs text-purple-600/70 dark:text-purple-400/70 font-semibold mt-1\">Protein</div>\n                  </div>\n                  <div className=\"text-center p-4 bg-white/80 dark:bg-gray-900/50 rounded-xl border border-purple-200 dark:border-purple-800\">\n                    <div className=\"font-bold text-2xl text-purple-600 dark:text-purple-400\">{calculateMacroTargets(calculatedCalories, currentWeightGoal).dailyCarbs}g</div>\n                    <div className=\"text-xs text-purple-600/70 dark:text-purple-400/70 font-semibold mt-1\">Carbs</div>\n                  </div>\n                  <div className=\"text-center p-4 bg-white/80 dark:bg-gray-900/50 rounded-xl border border-purple-200 dark:border-purple-800\">\n                    <div className=\"font-bold text-2xl text-purple-600 dark:text-purple-400\">{calculateMacroTargets(calculatedCalories, currentWeightGoal).dailyFat}g</div>\n                    <div className=\"text-xs text-purple-600/70 dark:text-purple-400/70 font-semibold mt-1\">Fat</div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  );\n}","size_bytes":40633},"client/src/components/calculator-test.tsx":{"content":"import React from 'react';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\n\n// Test data\nconst testInputs = {\n  age: 30,\n  sex: \"male\" as const,\n  heightCm: 180,\n  currentWeightKg: 80,\n  goalWeightKg: 75,\n  activityLevel: \"moderately_active\" as const,\n  weightGoal: \"lose_weight\" as const,\n  weeklyWeightChangeKg: 0.75,\n  medication: \"none\" as const,\n};\n\n// Extract calculation functions for testing\nconst calculateBMR = (data: typeof testInputs) => {\n  const { sex, heightCm, currentWeightKg, age } = data;\n  \n  let bmr;\n  if (sex === 'male') {\n    bmr = 10 * currentWeightKg + 6.25 * heightCm - 5 * age + 5;\n  } else {\n    bmr = 10 * currentWeightKg + 6.25 * heightCm - 5 * age - 161;\n  }\n  \n  return bmr;\n};\n\nconst calculateTDEE = (bmr: number, activityLevel: string) => {\n  const activityMultipliers = {\n    sedentary: 1.2,\n    lightly_active: 1.375,\n    moderately_active: 1.55,\n    very_active: 1.725,\n    extra_active: 1.9,\n  };\n  \n  return bmr * activityMultipliers[activityLevel as keyof typeof activityMultipliers];\n};\n\nconst calculateTargetCalories = (tdee: number, weightGoal: string, weeklyChange: number = 0.75, bmr: number, medication: string = 'none') => {\n  const caloriesPerKg = 7700;\n  const dailyCalorieChange = (weeklyChange * caloriesPerKg) / 7;\n  \n  let targetCalories: number;\n  switch (weightGoal) {\n    case 'lose_weight':\n      targetCalories = tdee - Math.abs(dailyCalorieChange);\n      break;\n    case 'gain_weight':\n      targetCalories = tdee + Math.abs(dailyCalorieChange);\n      break;\n    case 'maintain_weight':\n    default:\n      targetCalories = tdee;\n      break;\n  }\n  \n  // Apply safety minimums for weight loss\n  if (weightGoal === 'lose_weight') {\n    const safeMinimum = bmr < 1400 ? 1200 : 1500; // Gender-appropriate minimums\n    targetCalories = Math.max(targetCalories, safeMinimum);\n  }\n  \n  return Math.round(targetCalories);\n};\n\nconst calculateMacroTargets = (calories: number) => {\n  const proteinCaloriesPercent = 0.20; // 20% protein\n  const carbsCaloriesPercent = 0.40;   // 40% carbs  \n  const fatCaloriesPercent = 0.40;     // 40% fat\n  \n  const proteinGrams = Math.round((calories * proteinCaloriesPercent) / 4);\n  const carbsGrams = Math.round((calories * carbsCaloriesPercent) / 4);\n  const fatGrams = Math.round((calories * fatCaloriesPercent) / 9);\n  \n  return {\n    dailyCalories: calories,\n    dailyProtein: proteinGrams,\n    dailyCarbs: carbsGrams,\n    dailyFat: fatGrams,\n    dailyWater: 2500,\n  };\n};\n\ninterface TestResult {\n  step: string;\n  expected: number;\n  actual: number;\n  passed: boolean;\n  details?: string;\n}\n\nexport function CalculatorTest() {\n  const [testResults, setTestResults] = React.useState<TestResult[]>([]);\n  const [isRunning, setIsRunning] = React.useState(false);\n\n  const runTests = () => {\n    setIsRunning(true);\n    const results: TestResult[] = [];\n\n    // Step 1: Test BMR calculation\n    const expectedBMR = 10 * 80 + 6.25 * 180 - 5 * 30 + 5; // = 1780\n    const actualBMR = calculateBMR(testInputs);\n    results.push({\n      step: \"BMR Calculation (Mifflin-St Jeor)\",\n      expected: expectedBMR,\n      actual: actualBMR,\n      passed: Math.abs(actualBMR - expectedBMR) < 0.1,\n      details: `Formula: 10 Ã— ${testInputs.currentWeightKg} + 6.25 Ã— ${testInputs.heightCm} - 5 Ã— ${testInputs.age} + 5`\n    });\n\n    // Step 2: Test TDEE calculation\n    const expectedTDEE = expectedBMR * 1.55; // = 2759\n    const actualTDEE = calculateTDEE(actualBMR, testInputs.activityLevel);\n    results.push({\n      step: \"TDEE Calculation\",\n      expected: expectedTDEE,\n      actual: actualTDEE,\n      passed: Math.abs(actualTDEE - expectedTDEE) < 0.1,\n      details: `Formula: BMR (${actualBMR}) Ã— Activity Multiplier (1.55)`\n    });\n\n    // Step 3: Test daily calorie deficit\n    const expectedDeficit = (0.75 * 7700) / 7; // = 825\n    const actualDeficit = (testInputs.weeklyWeightChangeKg * 7700) / 7;\n    results.push({\n      step: \"Daily Calorie Deficit\",\n      expected: expectedDeficit,\n      actual: actualDeficit,\n      passed: Math.abs(actualDeficit - expectedDeficit) < 0.1,\n      details: `Formula: (${testInputs.weeklyWeightChangeKg} kg/week Ã— 7700 cal/kg) Ã· 7 days`\n    });\n\n    // Step 4: Test target calories (before safety minimum)\n    const expectedTargetBeforeSafety = expectedTDEE - expectedDeficit; // = 1934\n    const actualTargetCalories = calculateTargetCalories(actualTDEE, testInputs.weightGoal, testInputs.weeklyWeightChangeKg, actualBMR, testInputs.medication);\n    const targetBeforeSafety = actualTDEE - actualDeficit;\n    \n    results.push({\n      step: \"Target Calories (before safety min)\",\n      expected: expectedTargetBeforeSafety,\n      actual: targetBeforeSafety,\n      passed: Math.abs(targetBeforeSafety - expectedTargetBeforeSafety) < 0.1,\n      details: `Formula: TDEE (${Math.round(actualTDEE)}) - Daily Deficit (${Math.round(actualDeficit)})`\n    });\n\n    // Step 5: Test safety minimum application\n    const safetyMinimum = actualBMR < 1400 ? 1200 : 1500; // Should be 1500 for this male\n    const expectedFinalTarget = Math.max(expectedTargetBeforeSafety, safetyMinimum);\n    results.push({\n      step: \"Final Target Calories (with safety min)\",\n      expected: expectedFinalTarget,\n      actual: actualTargetCalories,\n      passed: actualTargetCalories === Math.round(expectedFinalTarget),\n      details: `Safety minimum: ${safetyMinimum} cal (BMR ${Math.round(actualBMR)} < 1400 ? 1200 : 1500)`\n    });\n\n    // Step 6: Test macro calculations\n    const expectedMacros = {\n      protein: Math.round((actualTargetCalories * 0.20) / 4), // 4 cal/g\n      carbs: Math.round((actualTargetCalories * 0.40) / 4),   // 4 cal/g\n      fat: Math.round((actualTargetCalories * 0.40) / 9),     // 9 cal/g\n    };\n    \n    const actualMacros = calculateMacroTargets(actualTargetCalories);\n    \n    results.push({\n      step: \"Protein Calculation (20%)\",\n      expected: expectedMacros.protein,\n      actual: actualMacros.dailyProtein,\n      passed: actualMacros.dailyProtein === expectedMacros.protein,\n      details: `Formula: (${actualTargetCalories} cal Ã— 0.20) Ã· 4 cal/g`\n    });\n    \n    results.push({\n      step: \"Carbs Calculation (40%)\",\n      expected: expectedMacros.carbs,\n      actual: actualMacros.dailyCarbs,\n      passed: actualMacros.dailyCarbs === expectedMacros.carbs,\n      details: `Formula: (${actualTargetCalories} cal Ã— 0.40) Ã· 4 cal/g`\n    });\n    \n    results.push({\n      step: \"Fat Calculation (40%)\",\n      expected: expectedMacros.fat,\n      actual: actualMacros.dailyFat,\n      passed: actualMacros.dailyFat === expectedMacros.fat,\n      details: `Formula: (${actualTargetCalories} cal Ã— 0.40) Ã· 9 cal/g`\n    });\n\n    setTestResults(results);\n    setIsRunning(false);\n  };\n\n  // Test edge cases\n  const runEdgeCaseTests = () => {\n    const edgeResults: TestResult[] = [];\n\n    // Test female calculation\n    const femaleInputs = { ...testInputs, sex: \"female\" as const };\n    const femaleBMR = calculateBMR(femaleInputs);\n    const expectedFemaleBMR = 10 * 80 + 6.25 * 180 - 5 * 30 - 161; // = 1614\n    edgeResults.push({\n      step: \"Female BMR Calculation\",\n      expected: expectedFemaleBMR,\n      actual: femaleBMR,\n      passed: Math.abs(femaleBMR - expectedFemaleBMR) < 0.1,\n      details: `Formula: 10 Ã— 80 + 6.25 Ã— 180 - 5 Ã— 30 - 161`\n    });\n\n    // Test different activity levels\n    const sedentaryTDEE = calculateTDEE(testInputs.currentWeightKg, \"sedentary\");\n    const expectedSedentaryTDEE = calculateBMR(testInputs) * 1.2;\n    edgeResults.push({\n      step: \"Sedentary Activity Level\",\n      expected: expectedSedentaryTDEE,\n      actual: sedentaryTDEE,\n      passed: Math.abs(sedentaryTDEE - expectedSedentaryTDEE) < 0.1,\n      details: `BMR Ã— 1.2 (sedentary multiplier)`\n    });\n\n    // Test safety minimum for very low calories\n    const lowCalorieInputs = { ...testInputs, weeklyWeightChangeKg: 2.0 }; // Very aggressive\n    const bmrForSafety = calculateBMR(lowCalorieInputs);\n    const tdeeForSafety = calculateTDEE(bmrForSafety, lowCalorieInputs.activityLevel);\n    const aggressiveTarget = calculateTargetCalories(tdeeForSafety, \"lose_weight\", 2.0, bmrForSafety);\n    const expectedMinimum = bmrForSafety < 1400 ? 1200 : 1500;\n    \n    edgeResults.push({\n      step: \"Safety Minimum Applied\",\n      expected: expectedMinimum,\n      actual: aggressiveTarget,\n      passed: aggressiveTarget >= expectedMinimum,\n      details: `Target should not go below ${expectedMinimum} cal safety minimum`\n    });\n\n    setTestResults([...testResults, ...edgeResults]);\n  };\n\n  const allPassed = testResults.length > 0 && testResults.every(r => r.passed);\n\n  return (\n    <Card className=\"max-w-4xl mx-auto\">\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2\">\n          ðŸ§® Calculator Mathematics Verification\n        </CardTitle>\n        <CardDescription>\n          Testing calculation logic with inputs: 30yo male, 180cm, 80kg â†’ 75kg goal, moderately active, lose weight\n        </CardDescription>\n      </CardHeader>\n      <CardContent className=\"space-y-6\">\n        <div className=\"flex gap-4\">\n          <Button \n            onClick={runTests} \n            disabled={isRunning}\n            data-testid=\"button-run-tests\"\n          >\n            {isRunning ? \"Running Tests...\" : \"Run Basic Tests\"}\n          </Button>\n          <Button \n            onClick={runEdgeCaseTests} \n            variant=\"outline\"\n            disabled={testResults.length === 0}\n            data-testid=\"button-run-edge-tests\"\n          >\n            Run Edge Case Tests\n          </Button>\n        </div>\n\n        {testResults.length > 0 && (\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center gap-2\">\n              <h3 className=\"text-lg font-semibold\">Test Results</h3>\n              <Badge variant={allPassed ? \"default\" : \"destructive\"}>\n                {testResults.filter(r => r.passed).length}/{testResults.length} Passed\n              </Badge>\n            </div>\n\n            <div className=\"grid gap-3\">\n              {testResults.map((result, index) => (\n                <Card key={index} className={`border-l-4 ${result.passed ? 'border-l-green-500' : 'border-l-red-500'}`}>\n                  <CardContent className=\"p-4\">\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <h4 className=\"font-medium\">{result.step}</h4>\n                      <Badge variant={result.passed ? \"default\" : \"destructive\"}>\n                        {result.passed ? \"âœ“ PASS\" : \"âœ— FAIL\"}\n                      </Badge>\n                    </div>\n                    <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                      <div>\n                        <span className=\"text-muted-foreground\">Expected:</span>\n                        <span className=\"ml-2 font-mono\">{result.expected.toFixed(1)}</span>\n                      </div>\n                      <div>\n                        <span className=\"text-muted-foreground\">Actual:</span>\n                        <span className=\"ml-2 font-mono\">{result.actual.toFixed(1)}</span>\n                      </div>\n                    </div>\n                    {result.details && (\n                      <div className=\"mt-2 text-sm text-muted-foreground\">\n                        {result.details}\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n\n            {allPassed && (\n              <div className=\"p-4 bg-green-50 dark:bg-green-950/20 border border-green-200 dark:border-green-800 rounded-lg\">\n                <div className=\"flex items-center gap-2\">\n                  <span className=\"text-green-600 dark:text-green-400\">âœ…</span>\n                  <span className=\"font-medium text-green-800 dark:text-green-200\">\n                    All calculations verified! The calculator produces mathematically correct results.\n                  </span>\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":12236},"client/src/lib/nutrition-calculator.ts":{"content":"/**\n * Nutrition Calculator - Shared calculation functions for BMR, TDEE, and calorie targets\n * \n * This module contains all the mathematical functions used for calculating:\n * - BMR (Basal Metabolic Rate) using Mifflin-St Jeor equation\n * - TDEE (Total Daily Energy Expenditure) \n * - Target calories with weight goals and medication considerations\n * - Macronutrient targets\n */\n\nimport { format } from 'date-fns';\n\nexport interface UserData {\n  age: number;\n  sex: \"male\" | \"female\";\n  heightCm: number;\n  currentWeightKg: number;\n  goalWeightKg: number;\n  activityLevel: \"sedentary\" | \"lightly_active\" | \"moderately_active\" | \"very_active\" | \"extra_active\";\n  weightGoal: \"lose_weight\" | \"maintain_weight\" | \"gain_weight\";\n  weeklyWeightChangeKg?: number;\n  medication?: \"none\" | \"ozempic\" | \"wegovy\" | \"mounjaro\" | \"other_glp1\";\n}\n\nexport interface CalculationResult {\n  bmr: number;\n  tdee: number;\n  targetCalories: number;\n  weightChange: number;\n  timeToGoal: number;\n  medication?: string;\n  medicationAdjustment?: MedicationAdjustment | null;\n}\n\nexport interface MedicationAdjustment {\n  minMultiplier: number;\n  maxDeficit: number;\n  name: string;\n}\n\nexport interface MacroTargets {\n  dailyCalories: number;\n  dailyProtein: number;\n  dailyCarbs: number;\n  dailyFat: number;\n  dailyWater: number;\n}\n\n/**\n * Calculate BMR using Mifflin-St Jeor Equation (more accurate than Harris-Benedict)\n * Men: BMR = 10 Ã— weight(kg) + 6.25 Ã— height(cm) - 5 Ã— age(years) + 5\n * Women: BMR = 10 Ã— weight(kg) + 6.25 Ã— height(cm) - 5 Ã— age(years) - 161\n */\nexport function calculateBMR(data: UserData): number {\n  const { sex, heightCm, currentWeightKg, age } = data;\n  \n  let bmr: number;\n  if (sex === 'male') {\n    bmr = 10 * currentWeightKg + 6.25 * heightCm - 5 * age + 5;\n  } else {\n    bmr = 10 * currentWeightKg + 6.25 * heightCm - 5 * age - 161;\n  }\n  \n  return bmr;\n}\n\n/**\n * Calculate TDEE (Total Daily Energy Expenditure) by applying activity multiplier to BMR\n */\nexport function calculateTDEE(bmr: number, activityLevel: string): number {\n  const activityMultipliers = {\n    sedentary: 1.2,           // Little to no exercise\n    lightly_active: 1.375,    // Light exercise 1-3 days/week\n    moderately_active: 1.55,  // Moderate exercise 3-5 days/week\n    very_active: 1.725,       // Heavy exercise 6-7 days/week\n    extra_active: 1.9,        // Very heavy exercise, physical job\n  };\n  \n  return bmr * activityMultipliers[activityLevel as keyof typeof activityMultipliers];\n}\n\n/**\n * Get medication-specific adjustments for GLP-1 medications\n */\nexport function getMedicationAdjustment(medication: string): MedicationAdjustment {\n  switch (medication) {\n    case 'ozempic':\n    case 'wegovy':\n      return {\n        minMultiplier: 1.1, // 110% of BMR minimum (less restrictive for better results)\n        maxDeficit: 800, // Max 800 calorie deficit per day (more effective weight loss)\n        name: 'Semaglutide (Ozempic/Wegovy)'\n      };\n    case 'mounjaro':\n      return {\n        minMultiplier: 1.1, // 110% of BMR minimum (more effective)\n        maxDeficit: 850, // Max 850 calorie deficit per day (better weight loss)\n        name: 'Tirzepatide (Mounjaro)'\n      };\n    case 'other_glp1':\n      return {\n        minMultiplier: 1.1, // 110% of BMR minimum (more effective)\n        maxDeficit: 800, // Max 800 calorie deficit per day (better results)\n        name: 'GLP-1 Medication'\n      };\n    default:\n      return {\n        minMultiplier: 1.2,\n        maxDeficit: 1000,\n        name: 'None'\n      };\n  }\n}\n\n/**\n * Calculate daily calories needed for weight goal with medication considerations\n */\nexport function calculateTargetCalories(\n  tdee: number, \n  weightGoal: string, \n  weeklyChange: number = 0.75, \n  bmr: number, \n  medication: string = 'none'\n): number {\n  // 1 kg of fat â‰ˆ 7700 calories (more effective default of 0.75kg/week for better weight loss)\n  const caloriesPerKg = 7700;\n  const dailyCalorieChange = (weeklyChange * caloriesPerKg) / 7;\n  \n  let targetCalories: number;\n  switch (weightGoal) {\n    case 'lose_weight':\n      targetCalories = tdee - Math.abs(dailyCalorieChange);\n      break;\n    case 'gain_weight':\n      targetCalories = tdee + Math.abs(dailyCalorieChange);\n      break;\n    case 'maintain_weight':\n    default:\n      targetCalories = tdee;\n      break;\n  }\n  \n  // Apply medication adjustments\n  if (medication && medication !== 'none' && weightGoal === 'lose_weight') {\n    const medicationAdjustment = getMedicationAdjustment(medication);\n    \n    // Higher minimum calories for people on GLP-1 medications\n    const minCalories = bmr * medicationAdjustment.minMultiplier;\n    \n    // Limit maximum deficit to prevent too rapid weight loss\n    const maxDeficit = medicationAdjustment.maxDeficit;\n    const actualDeficit = Math.min(tdee - targetCalories, maxDeficit);\n    \n    targetCalories = Math.max(tdee - actualDeficit, minCalories);\n  } else if (weightGoal === 'lose_weight') {\n    // More aggressive but safe floor for effective weight loss (1200 cal minimum for women, 1500 for men)\n    const safeMinimum = bmr < 1400 ? 1200 : 1500; // Gender-appropriate minimums\n    targetCalories = Math.max(targetCalories, safeMinimum);\n  }\n  \n  return Math.round(targetCalories);\n}\n\n/**\n * Calculate recommended macronutrient targets based on calculated calories and weight goal\n * Science-based approach with higher protein for weight loss/maintenance\n */\nexport function calculateMacroTargets(calories: number, weightGoal?: string): MacroTargets {\n  let proteinCaloriesPercent: number;\n  let carbsCaloriesPercent: number;\n  let fatCaloriesPercent: number;\n  \n  // Science-based macro distribution based on goals\n  if (weightGoal === 'lose_weight') {\n    // Higher protein for weight loss - preserves muscle mass, increases satiety\n    proteinCaloriesPercent = 0.30;  // 30% protein (optimal for fat loss)\n    carbsCaloriesPercent = 0.35;    // 35% carbs (moderate for energy)  \n    fatCaloriesPercent = 0.35;      // 35% fat (supports hormones and satiety)\n  } else if (weightGoal === 'gain_weight') {\n    // Moderate protein, higher carbs for muscle gain\n    proteinCaloriesPercent = 0.25;  // 25% protein (muscle building)\n    carbsCaloriesPercent = 0.45;    // 45% carbs (energy for training)\n    fatCaloriesPercent = 0.30;      // 30% fat (hormone support)\n  } else {\n    // Balanced macros for maintenance\n    proteinCaloriesPercent = 0.25;  // 25% protein (maintenance)\n    carbsCaloriesPercent = 0.40;    // 40% carbs (balanced energy)\n    fatCaloriesPercent = 0.35;      // 35% fat (satiety and health)\n  }\n  \n  const proteinGrams = Math.round((calories * proteinCaloriesPercent) / 4); // 4 calories per gram protein\n  const carbsGrams = Math.round((calories * carbsCaloriesPercent) / 4);     // 4 calories per gram carbs\n  const fatGrams = Math.round((calories * fatCaloriesPercent) / 9);         // 9 calories per gram fat\n  \n  return {\n    dailyCalories: calories,\n    dailyProtein: proteinGrams,\n    dailyCarbs: carbsGrams,\n    dailyFat: fatGrams,\n    dailyWater: 2500, // Standard 2.5L water recommendation\n  };\n}\n\n/**\n * Main calculation function that performs all calculations in sequence\n */\nexport function calculateNutritionTargets(data: UserData): CalculationResult {\n  const bmr = calculateBMR(data);\n  const tdee = calculateTDEE(bmr, data.activityLevel);\n  const targetCalories = calculateTargetCalories(\n    tdee, \n    data.weightGoal, \n    Math.abs(data.weeklyWeightChangeKg || 0.75), \n    bmr, \n    data.medication\n  );\n  \n  return {\n    bmr: Math.round(bmr),\n    tdee: Math.round(tdee),\n    targetCalories,\n    weightChange: data.goalWeightKg - data.currentWeightKg,\n    timeToGoal: Math.abs(data.goalWeightKg - data.currentWeightKg) / (Math.abs(data.weeklyWeightChangeKg || 0.75) / 7),\n    medication: data.medication,\n    medicationAdjustment: data.medication !== 'none' ? getMedicationAdjustment(data.medication || 'none') : null,\n  };\n}\n\n/**\n * Validate macronutrient calculations back-calculate to target calories correctly\n * Returns the actual calories from macro breakdown and variance from target\n */\nexport function validateMacroCalculations(macros: MacroTargets): { actualCalories: number; variance: number } {\n  const proteinCals = macros.dailyProtein * 4;\n  const carbsCals = macros.dailyCarbs * 4; \n  const fatCals = macros.dailyFat * 9;\n  \n  const actualCalories = proteinCals + carbsCals + fatCals;\n  const variance = actualCalories - macros.dailyCalories;\n  \n  return { actualCalories, variance };\n}\n\n/**\n * Calculate nutrition data for a specific date from diary and drink entries\n * Uses standardized date comparison logic to ensure consistency across the app\n */\nexport function calculateDailyNutrition(\n  diaryEntries: any[], \n  drinkEntries: any[] = [],\n  targetDate?: Date\n): { calories: number; protein: number; carbs: number; fat: number; water: number } {\n  const dateToCheck = targetDate || new Date();\n  const dateStr = format(dateToCheck, 'yyyy-MM-dd');\n  \n  // Filter entries for the target date using consistent date formatting\n  const targetDiaryEntries = diaryEntries.filter(entry => \n    entry.mealDate && format(new Date(entry.mealDate), 'yyyy-MM-dd') === dateStr\n  );\n  \n  const targetDrinkEntries = drinkEntries.filter(drink => \n    drink.loggedAt && format(new Date(drink.loggedAt), 'yyyy-MM-dd') === dateStr\n  );\n\n  // Calculate nutrition from food diary entries (with portion multiplier support)\n  const nutrition = targetDiaryEntries.reduce((total, entry) => {\n    // portionMultiplier is stored as integer (100 = 1.0x), default to 100 if not set\n    const multiplier = (entry.portionMultiplier || 100) / 100;\n    return {\n      calories: total.calories + Math.round((entry.analysis?.totalCalories || 0) * multiplier),\n      protein: total.protein + Math.round((entry.analysis?.totalProtein || 0) * multiplier),\n      carbs: total.carbs + Math.round((entry.analysis?.totalCarbs || 0) * multiplier),\n      fat: total.fat + Math.round((entry.analysis?.totalFat || 0) * multiplier),\n    };\n  }, { calories: 0, protein: 0, carbs: 0, fat: 0 });\n\n  // Add calories from drinks\n  const drinkCalories = targetDrinkEntries.reduce((total, drink) => total + (drink.calories || 0), 0);\n  \n  // Calculate water intake from specific drink types\n  const water = targetDrinkEntries\n    .filter(drink => ['water', 'tea', 'coffee'].includes(drink.drinkType))\n    .reduce((total, drink) => total + drink.amount, 0);\n\n  return {\n    calories: nutrition.calories + drinkCalories,\n    protein: nutrition.protein,\n    carbs: nutrition.carbs,\n    fat: nutrition.fat,\n    water,\n  };\n}\n\n/**\n * Calculate today's nutrition data from diary and drink entries\n * Uses the standardized daily calculation function\n */\nexport function calculateTodayNutrition(\n  diaryEntries: any[], \n  drinkEntries: any[] = []\n): { calories: number; protein: number; carbs: number; fat: number; water: number } {\n  return calculateDailyNutrition(diaryEntries, drinkEntries, new Date());\n}","size_bytes":10974},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n","size_bytes":1128},"client/src/lib/authUtils.ts":{"content":"export function isUnauthorizedError(error: Error): boolean {\n  return /^401: .*Unauthorized/.test(error.message);\n}","size_bytes":115},"client/src/lib/auth-launcher.ts":{"content":"import { Capacitor } from '@capacitor/core';\nimport { Browser } from '@capacitor/browser';\n\nexport interface AuthConfig {\n  isNative: boolean;\n  platform: string;\n  hasBrowser: boolean;\n}\n\nexport function getAuthConfig(): AuthConfig {\n  const isNative = Capacitor.isNativePlatform();\n  const platform = Capacitor.getPlatform();\n  const hasBrowser = typeof Browser !== 'undefined' && typeof Browser.open === 'function';\n  \n  return {\n    isNative,\n    platform,\n    hasBrowser\n  };\n}\n\n/**\n * Navigate to email/password registration page\n */\nexport async function launchSignup(): Promise<void> {\n  const config = getAuthConfig();\n  \n  console.log('ðŸ” Launch signup:', {\n    isNative: config.isNative,\n    platform: config.platform\n  });\n  \n  // Simply navigate to the register page within the app\n  window.location.href = '/register';\n}\n\n/**\n * Navigate to email/password login page\n */\nexport async function launchLogin(): Promise<void> {\n  const config = getAuthConfig();\n  \n  console.log('ðŸ” Launch login:', {\n    isNative: config.isNative,\n    platform: config.platform\n  });\n  \n  // Simply navigate to the login page within the app\n  window.location.href = '/login';\n}\n","size_bytes":1176},"client/src/lib/sound-service.ts":{"content":"export type SoundType = \n  | 'notification' \n  | 'success' \n  | 'error' \n  | 'click' \n  | 'scan' \n  | 'achievement'\n  | 'reminder';\n\nclass SoundService {\n  private audioContext: AudioContext | null = null;\n  private sounds: Map<SoundType, AudioBuffer> = new Map();\n  private enabled = true;\n\n  constructor() {\n    this.loadSoundSettings();\n  }\n\n  private loadSoundSettings() {\n    const soundEnabled = localStorage.getItem('platemate-sounds-enabled');\n    this.enabled = soundEnabled !== 'false'; // Default to enabled\n  }\n\n  async initialize(): Promise<void> {\n    try {\n      // Initialize Web Audio API\n      this.audioContext = new (window.AudioContext || (window as any).webkitAudioContext)();\n      \n      // Generate sounds programmatically\n      await this.generateSounds();\n    } catch (error) {\n      console.error('Sound initialization failed:', error);\n    }\n  }\n\n  private async generateSounds(): Promise<void> {\n    if (!this.audioContext) return;\n\n    // Generate different sounds programmatically\n    const sounds: Record<SoundType, () => AudioBuffer> = {\n      notification: () => this.generateTone(800, 0.3, 'sine'),\n      success: () => this.generateChord([523, 659, 784], 0.4), // C major chord\n      error: () => this.generateTone(200, 0.5, 'square'),\n      click: () => this.generateTone(1000, 0.1, 'sine'),\n      scan: () => this.generateSweep(600, 1200, 0.3),\n      achievement: () => this.generateMelody([523, 659, 784, 1047], 0.6), // C-E-G-C\n      reminder: () => this.generateGentleTone(440, 0.5)\n    };\n\n    for (const [type, generator] of Object.entries(sounds)) {\n      try {\n        const buffer = generator();\n        this.sounds.set(type as SoundType, buffer);\n      } catch (error) {\n        console.warn(`Failed to generate ${type} sound:`, error);\n      }\n    }\n  }\n\n  private generateTone(frequency: number, duration: number, type: OscillatorType = 'sine'): AudioBuffer {\n    if (!this.audioContext) throw new Error('Audio context not initialized');\n    \n    const sampleRate = this.audioContext.sampleRate;\n    const length = sampleRate * duration;\n    const buffer = this.audioContext.createBuffer(1, length, sampleRate);\n    const data = buffer.getChannelData(0);\n\n    for (let i = 0; i < length; i++) {\n      const t = i / sampleRate;\n      let sample = 0;\n      \n      switch (type) {\n        case 'sine':\n          sample = Math.sin(2 * Math.PI * frequency * t);\n          break;\n        case 'square':\n          sample = Math.sin(2 * Math.PI * frequency * t) > 0 ? 1 : -1;\n          break;\n        case 'triangle':\n          sample = (2 / Math.PI) * Math.asin(Math.sin(2 * Math.PI * frequency * t));\n          break;\n      }\n      \n      // Add envelope (fade in/out)\n      const envelope = Math.sin((Math.PI * i) / length);\n      data[i] = sample * envelope * 0.3;\n    }\n\n    return buffer;\n  }\n\n  private generateChord(frequencies: number[], duration: number): AudioBuffer {\n    if (!this.audioContext) throw new Error('Audio context not initialized');\n    \n    const sampleRate = this.audioContext.sampleRate;\n    const length = sampleRate * duration;\n    const buffer = this.audioContext.createBuffer(1, length, sampleRate);\n    const data = buffer.getChannelData(0);\n\n    for (let i = 0; i < length; i++) {\n      const t = i / sampleRate;\n      let sample = 0;\n      \n      // Add all frequencies together\n      for (const freq of frequencies) {\n        sample += Math.sin(2 * Math.PI * freq * t) / frequencies.length;\n      }\n      \n      // Add envelope\n      const envelope = Math.sin((Math.PI * i) / length);\n      data[i] = sample * envelope * 0.3;\n    }\n\n    return buffer;\n  }\n\n  private generateSweep(startFreq: number, endFreq: number, duration: number): AudioBuffer {\n    if (!this.audioContext) throw new Error('Audio context not initialized');\n    \n    const sampleRate = this.audioContext.sampleRate;\n    const length = sampleRate * duration;\n    const buffer = this.audioContext.createBuffer(1, length, sampleRate);\n    const data = buffer.getChannelData(0);\n\n    for (let i = 0; i < length; i++) {\n      const progress = i / length;\n      const frequency = startFreq + (endFreq - startFreq) * progress;\n      const t = i / sampleRate;\n      \n      const sample = Math.sin(2 * Math.PI * frequency * t);\n      \n      // Add envelope\n      const envelope = Math.sin((Math.PI * i) / length);\n      data[i] = sample * envelope * 0.2;\n    }\n\n    return buffer;\n  }\n\n  private generateMelody(frequencies: number[], duration: number): AudioBuffer {\n    if (!this.audioContext) throw new Error('Audio context not initialized');\n    \n    const sampleRate = this.audioContext.sampleRate;\n    const totalLength = sampleRate * duration;\n    const noteLength = totalLength / frequencies.length;\n    const buffer = this.audioContext.createBuffer(1, totalLength, sampleRate);\n    const data = buffer.getChannelData(0);\n\n    frequencies.forEach((freq, noteIndex) => {\n      const startSample = Math.floor(noteIndex * noteLength);\n      const endSample = Math.floor((noteIndex + 1) * noteLength);\n      \n      for (let i = startSample; i < endSample && i < totalLength; i++) {\n        const localI = i - startSample;\n        const localLength = endSample - startSample;\n        const t = localI / sampleRate;\n        \n        const sample = Math.sin(2 * Math.PI * freq * t);\n        \n        // Add envelope for each note\n        const envelope = Math.sin((Math.PI * localI) / localLength);\n        data[i] = sample * envelope * 0.25;\n      }\n    });\n\n    return buffer;\n  }\n\n  private generateGentleTone(frequency: number, duration: number): AudioBuffer {\n    if (!this.audioContext) throw new Error('Audio context not initialized');\n    \n    const sampleRate = this.audioContext.sampleRate;\n    const length = sampleRate * duration;\n    const buffer = this.audioContext.createBuffer(1, length, sampleRate);\n    const data = buffer.getChannelData(0);\n\n    for (let i = 0; i < length; i++) {\n      const t = i / sampleRate;\n      \n      // Create a gentle, warm sound with multiple harmonics\n      const fundamental = Math.sin(2 * Math.PI * frequency * t);\n      const harmonic2 = Math.sin(2 * Math.PI * frequency * 2 * t) * 0.3;\n      const harmonic3 = Math.sin(2 * Math.PI * frequency * 3 * t) * 0.1;\n      \n      let sample = fundamental + harmonic2 + harmonic3;\n      \n      // Smooth envelope\n      const envelope = Math.pow(Math.sin((Math.PI * i) / length), 2);\n      data[i] = sample * envelope * 0.2;\n    }\n\n    return buffer;\n  }\n\n  async play(soundType: SoundType, volume: number = 1): Promise<void> {\n    if (!this.enabled || !this.audioContext || !this.sounds.has(soundType)) {\n      return;\n    }\n\n    try {\n      // Resume audio context if suspended (required by browsers)\n      if (this.audioContext.state === 'suspended') {\n        await this.audioContext.resume();\n      }\n\n      const buffer = this.sounds.get(soundType)!;\n      const source = this.audioContext.createBufferSource();\n      const gainNode = this.audioContext.createGain();\n      \n      source.buffer = buffer;\n      gainNode.gain.value = Math.min(Math.max(volume, 0), 1) * 0.5; // Max volume 50%\n      \n      source.connect(gainNode);\n      gainNode.connect(this.audioContext.destination);\n      \n      source.start();\n    } catch (error) {\n      console.warn(`Failed to play ${soundType} sound:`, error);\n    }\n  }\n\n  setEnabled(enabled: boolean): void {\n    this.enabled = enabled;\n    localStorage.setItem('platemate-sounds-enabled', enabled.toString());\n  }\n\n  isEnabled(): boolean {\n    return this.enabled;\n  }\n\n  // Convenience methods for common actions\n  async playSuccess(): Promise<void> {\n    await this.play('success');\n  }\n\n  async playError(): Promise<void> {\n    await this.play('error');\n  }\n\n  async playClick(): Promise<void> {\n    await this.play('click', 0.3);\n  }\n\n  async playNotification(): Promise<void> {\n    await this.play('notification');\n  }\n\n  async playAchievement(): Promise<void> {\n    await this.play('achievement');\n  }\n\n  async playScan(): Promise<void> {\n    await this.play('scan');\n  }\n\n  async playReminder(): Promise<void> {\n    await this.play('reminder');\n  }\n}\n\nexport const soundService = new SoundService();","size_bytes":8185},"client/src/pages/DietAdvicePage.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Link } from \"wouter\";\nimport { ArrowLeft, Lightbulb, TrendingUp, Heart, Brain, Zap, RefreshCw, Utensils, Clock, Users, Send, Bot, ChefHat, ExternalLink, Mic, MicOff } from \"lucide-react\";\nimport { useState, useEffect } from \"react\";\nimport { DropdownNavigation } from \"@/components/dropdown-navigation\";\nimport { BottomHelpSection } from \"@/components/bottom-help-section\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\n\ninterface MealIdea {\n  mealType: 'breakfast' | 'lunch' | 'dinner' | 'snack';\n  name: string;\n  description: string;\n  calories: number;\n  protein: number;\n  carbs: number;\n  fat: number;\n  ingredients: string[];\n  benefits: string;\n  recipeLink?: string;\n  cookingInstructions?: string[];\n}\n\ninterface DietAdvice {\n  personalizedAdvice: string[];\n  nutritionGoals: string[];\n  improvements: string[];\n  generalTips: string[];\n  mealIdeas?: MealIdea[];\n}\n\ninterface ChatMessage {\n  id: string;\n  question: string;\n  answer: string;\n  timestamp: string;\n}\n\nexport function DietAdvicePage() {\n  const { toast } = useToast();\n  const [adviceType, setAdviceType] = useState<\"personalized\" | \"general\">(\"personalized\");\n  const [question, setQuestion] = useState(\"\");\n  const [chatHistory, setChatHistory] = useState<ChatMessage[]>([]);\n  const [isListening, setIsListening] = useState(false);\n  const [speechSupported, setSpeechSupported] = useState(false);\n  const [speechService, setSpeechService] = useState<any>(null);\n\n  // Initialize speech recognition\n  useEffect(() => {\n    const initSpeech = async () => {\n      try {\n        const { speechService: service } = await import('@/lib/speech-service');\n        setSpeechService(service);\n        setSpeechSupported(service.isSupported());\n        \n        // Register a temporary command for capturing questions\n        service.registerCommand('capture-question', {\n          command: 'capture-question',\n          phrases: [], // We'll use this differently\n          action: () => {}, // Won't be used\n          description: 'Capture nutrition question',\n          category: 'action' as any\n        });\n\n        // Set up speech event handler\n        const handleSpeechEvent = (event: any) => {\n          if (event.type === 'listening-start') {\n            setIsListening(true);\n          } else if (event.type === 'listening-end') {\n            setIsListening(false);\n          }\n        };\n\n        service.on(handleSpeechEvent);\n\n        return () => {\n          service.off(handleSpeechEvent);\n        };\n      } catch (error) {\n        console.log('Speech recognition not available');\n        setSpeechSupported(false);\n      }\n    };\n\n    initSpeech();\n  }, []);\n\n  const { data: advice, isLoading, refetch } = useQuery<DietAdvice>({\n    queryKey: ['/api/diet-advice'],\n    enabled: adviceType === \"personalized\",\n  });\n\n  const generateAdviceMutation = useMutation({\n    mutationFn: async () => {\n      const response = await apiRequest('POST', '/api/diet-advice/generate');\n      return await response.json();\n    },\n    onSuccess: (data) => {\n      toast({\n        title: \"New Advice Generated!\",\n        description: \"Your personalized diet recommendations have been updated.\",\n      });\n      refetch();\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to generate new advice. Please try again.\",\n        variant: \"destructive\",\n      });\n      console.error(\"Error generating advice:\", error);\n    },\n  });\n\n  const askAIMutation = useMutation({\n    mutationFn: async (question: string) => {\n      const response = await apiRequest('POST', '/api/ai/ask', { question });\n      return await response.json();\n    },\n    onSuccess: (data) => {\n      const newMessage: ChatMessage = {\n        id: Date.now().toString(),\n        question: data.question,\n        answer: data.answer,\n        timestamp: data.timestamp\n      };\n      setChatHistory(prev => [newMessage, ...prev]);\n      setQuestion(\"\");\n      toast({\n        title: \"AI Response Received!\",\n        description: \"Your nutrition question has been answered.\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to get AI response. Please try again.\",\n        variant: \"destructive\",\n      });\n      console.error(\"Error asking AI:\", error);\n    },\n  });\n\n  const handleAskAI = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!question.trim()) return;\n    askAIMutation.mutate(question.trim());\n  };\n\n  const handleVoiceInput = async () => {\n    if (!speechService || !speechSupported) return;\n\n    if (isListening) {\n      speechService.stopListening();\n      setIsListening(false);\n      return;\n    }\n\n    try {\n      // Create a custom recognition instance for question capture\n      const recognition = new (window.SpeechRecognition || (window as any).webkitSpeechRecognition)();\n      recognition.continuous = false;\n      recognition.interimResults = false;\n      recognition.lang = 'en-US';\n\n      recognition.onstart = () => {\n        setIsListening(true);\n        toast({\n          title: \"Listening...\",\n          description: \"Ask your nutrition question now\",\n        });\n      };\n\n      recognition.onresult = (event: any) => {\n        const transcript = event.results[0][0].transcript;\n        setQuestion(transcript);\n        toast({\n          title: \"Question captured!\",\n          description: \"Your voice question has been converted to text\",\n        });\n      };\n\n      recognition.onerror = (event: any) => {\n        console.error('Speech recognition error:', event.error);\n        toast({\n          title: \"Speech Error\",\n          description: \"Could not recognize speech. Please try again.\",\n          variant: \"destructive\",\n        });\n      };\n\n      recognition.onend = () => {\n        setIsListening(false);\n      };\n\n      recognition.start();\n    } catch (error) {\n      toast({\n        title: \"Speech Not Available\",\n        description: \"Speech recognition is not supported in this browser\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const generalTips = [\n    {\n      icon: <Heart className=\"h-5 w-5 text-red-500\" />,\n      title: \"Stay Hydrated\",\n      tip: \"Drink at least 8 glasses of water daily. Proper hydration supports metabolism and helps control appetite.\"\n    },\n    {\n      icon: <Zap className=\"h-5 w-5 text-yellow-500\" />,\n      title: \"Balanced Meals\",\n      tip: \"Include protein, healthy fats, and complex carbs in each meal for sustained energy and satiety.\"\n    },\n    {\n      icon: <Brain className=\"h-5 w-5 text-purple-500\" />,\n      title: \"Mindful Eating\",\n      tip: \"Eat slowly and pay attention to hunger cues. This helps prevent overeating and improves digestion.\"\n    },\n    {\n      icon: <TrendingUp className=\"h-5 w-5 text-green-500\" />,\n      title: \"Portion Control\",\n      tip: \"Use smaller plates and fill half with vegetables, quarter with protein, and quarter with whole grains.\"\n    }\n  ];\n\n  return (\n    <div className=\"min-h-screen text-foreground\" style={{background: 'var(--bg-gradient)'}}>\n      {/* Header */}\n      <div className=\"bg-card border-b\">\n        <div className=\"max-w-md mx-auto px-4 py-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-3\">\n              <Link href=\"/scan\">\n                <button \n                  className=\"p-2 hover:bg-muted rounded-lg transition-colors\"\n                  data-testid=\"button-back-to-home\"\n                >\n                  <ArrowLeft className=\"h-5 w-5\" />\n                </button>\n              </Link>\n              <h1 className=\"text-xl font-bold\">Diet Advice</h1>\n            </div>\n            <Lightbulb className=\"h-5 w-5 text-primary\" />\n          </div>\n        </div>\n      </div>\n\n      <div className=\"max-w-md mx-auto p-4\">\n        {/* Ask AI Section */}\n        <Card className=\"health-card mb-6\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Bot className=\"h-5 w-5 text-primary\" />\n              Ask AI Nutrition Assistant\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <form onSubmit={handleAskAI} className=\"flex gap-2\">\n              <Input\n                placeholder={isListening ? \"Listening...\" : \"Ask me anything about nutrition...\"}\n                value={question}\n                onChange={(e) => setQuestion(e.target.value)}\n                disabled={askAIMutation.isPending || isListening}\n                data-testid=\"input-ai-question\"\n                className=\"flex-1\"\n              />\n              \n              {speechSupported && (\n                <Button\n                  type=\"button\"\n                  onClick={handleVoiceInput}\n                  disabled={askAIMutation.isPending}\n                  variant={isListening ? \"destructive\" : \"outline\"}\n                  className={isListening ? \"animate-pulse\" : \"\"}\n                  data-testid=\"button-voice-input\"\n                >\n                  {isListening ? (\n                    <MicOff className=\"h-4 w-4\" />\n                  ) : (\n                    <Mic className=\"h-4 w-4\" />\n                  )}\n                </Button>\n              )}\n              \n              <Button \n                type=\"submit\" \n                disabled={askAIMutation.isPending || !question.trim()}\n                className=\"vibrant-button\"\n                data-testid=\"button-ask-ai\"\n              >\n                {askAIMutation.isPending ? (\n                  <RefreshCw className=\"h-4 w-4 animate-spin\" />\n                ) : (\n                  <Send className=\"h-4 w-4\" />\n                )}\n              </Button>\n            </form>\n\n            {/* Chat History */}\n            {chatHistory.length > 0 && (\n              <div className=\"space-y-3 max-h-64 overflow-y-auto\">\n                {chatHistory.map((message) => (\n                  <div key={message.id} className=\"space-y-2 p-3 bg-muted/50 rounded-lg\">\n                    <div className=\"flex items-start gap-2\">\n                      <div className=\"w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0 mt-0.5\">\n                        <Bot className=\"h-3 w-3 text-primary\" />\n                      </div>\n                      <div className=\"flex-1 space-y-2\">\n                        <div className=\"text-sm font-medium text-primary\">\n                          Q: {message.question}\n                        </div>\n                        <div className=\"text-sm text-muted-foreground leading-relaxed\">\n                          {message.answer}\n                        </div>\n                        <div className=\"text-xs text-muted-foreground\">\n                          {new Date(message.timestamp).toLocaleString()}\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Tab Navigation */}\n        <div className=\"flex space-x-2 mb-6\">\n          <button\n            onClick={() => setAdviceType(\"personalized\")}\n            className={`flex-1 py-2 px-4 rounded-lg font-medium transition-colors ${\n              adviceType === \"personalized\"\n                ? 'bg-primary text-primary-foreground'\n                : 'bg-secondary text-secondary-foreground hover:bg-secondary/80'\n            }`}\n            data-testid=\"button-personalized-advice\"\n          >\n            Personalized\n          </button>\n          <button\n            onClick={() => setAdviceType(\"general\")}\n            className={`flex-1 py-2 px-4 rounded-lg font-medium transition-colors ${\n              adviceType === \"general\"\n                ? 'bg-primary text-primary-foreground'\n                : 'bg-secondary text-secondary-foreground hover:bg-secondary/80'\n            }`}\n            data-testid=\"button-general-tips\"\n          >\n            General Tips\n          </button>\n        </div>\n\n        {adviceType === \"personalized\" ? (\n          <>\n            {/* Generate New Advice Button */}\n            <div className=\"mb-6\">\n              <button\n                onClick={() => generateAdviceMutation.mutate()}\n                disabled={generateAdviceMutation.isPending || isLoading}\n                className=\"w-full bg-primary text-primary-foreground py-3 px-4 rounded-lg font-medium hover:bg-primary/90 transition-colors disabled:opacity-50 flex items-center justify-center space-x-2\"\n                data-testid=\"button-generate-advice\"\n              >\n                <RefreshCw className={`h-4 w-4 ${generateAdviceMutation.isPending ? 'animate-spin' : ''}`} />\n                <span>{generateAdviceMutation.isPending ? 'Generating...' : 'Get New Advice'}</span>\n              </button>\n            </div>\n\n            {isLoading ? (\n              <div className=\"space-y-4\">\n                <div className=\"animate-pulse\">\n                  <div className=\"h-6 bg-muted rounded mb-2\"></div>\n                  <div className=\"h-20 bg-muted rounded mb-4\"></div>\n                  <div className=\"h-6 bg-muted rounded mb-2\"></div>\n                  <div className=\"h-20 bg-muted rounded\"></div>\n                </div>\n              </div>\n            ) : advice ? (\n              <div className=\"space-y-6\">\n                {advice.personalizedAdvice && advice.personalizedAdvice.length > 0 && (\n                  <div className=\"bg-card border rounded-lg p-4\">\n                    <h3 className=\"font-semibold text-primary mb-3 flex items-center\">\n                      <Brain className=\"h-4 w-4 mr-2\" />\n                      Personalized Recommendations\n                    </h3>\n                    <div className=\"space-y-2\">\n                      {advice.personalizedAdvice.map((tip, index) => (\n                        <div key={index} className=\"text-sm text-muted-foreground\">\n                          â€¢ {tip}\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                )}\n\n                {advice.nutritionGoals && advice.nutritionGoals.length > 0 && (\n                  <div className=\"bg-card border rounded-lg p-4\">\n                    <h3 className=\"font-semibold text-primary mb-3 flex items-center\">\n                      <TrendingUp className=\"h-4 w-4 mr-2\" />\n                      Nutrition Goals\n                    </h3>\n                    <div className=\"space-y-2\">\n                      {advice.nutritionGoals.map((goal, index) => (\n                        <div key={index} className=\"text-sm text-muted-foreground\">\n                          â€¢ {goal}\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                )}\n\n                {advice.improvements && advice.improvements.length > 0 && (\n                  <div className=\"bg-card border rounded-lg p-4\">\n                    <h3 className=\"font-semibold text-primary mb-3 flex items-center\">\n                      <Zap className=\"h-4 w-4 mr-2\" />\n                      Areas to Improve\n                    </h3>\n                    <div className=\"space-y-2\">\n                      {advice.improvements.map((improvement, index) => (\n                        <div key={index} className=\"text-sm text-muted-foreground\">\n                          â€¢ {improvement}\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                )}\n\n                {/* Recipe Browser - Always Visible */}\n                <div className=\"bg-card border rounded-lg p-4 mb-4\">\n                  <div className=\"flex items-center justify-between mb-3\">\n                    <h3 className=\"font-semibold text-primary flex items-center\">\n                      <ChefHat className=\"h-4 w-4 mr-2\" />\n                      Recipe Collection\n                    </h3>\n                    <Link href=\"/recipes\">\n                      <Button \n                        variant=\"default\" \n                        size=\"sm\" \n                        className=\"flex items-center gap-2\"\n                        data-testid=\"button-view-recipes\"\n                      >\n                        <Utensils className=\"h-4 w-4\" />\n                        Browse Recipes\n                      </Button>\n                    </Link>\n                  </div>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Discover healthy recipes filtered by your dietary requirements including Keto, Vegan, Vegetarian, High Protein, and more!\n                  </p>\n                </div>\n\n                {advice.mealIdeas && advice.mealIdeas.length > 0 && (\n                  <div className=\"bg-card border rounded-lg p-4\">\n                    <h3 className=\"font-semibold text-primary mb-3 flex items-center\">\n                      <Utensils className=\"h-4 w-4 mr-2\" />\n                      Personalized Meal Ideas\n                    </h3>\n                    <div className=\"space-y-4\">\n                      {advice.mealIdeas.map((meal, index) => (\n                        <div key={index} className=\"border rounded-lg p-4 bg-muted/30\" data-testid={`card-meal-${index}`}>\n                          <div className=\"flex items-start justify-between mb-3\">\n                            <div>\n                              <div className=\"flex items-center space-x-2 mb-1\">\n                                <span className={`px-2 py-1 rounded-full text-xs font-medium ${\n                                  meal.mealType === 'breakfast' ? 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200' :\n                                  meal.mealType === 'lunch' ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' :\n                                  meal.mealType === 'dinner' ? 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200' :\n                                  'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200'\n                                }`}>\n                                  {meal.mealType.charAt(0).toUpperCase() + meal.mealType.slice(1)}\n                                </span>\n                              </div>\n                              <h4 className=\"font-semibold\" data-testid={`text-meal-name-${index}`}>\n                                {meal.name}\n                              </h4>\n                              <p className=\"text-sm text-muted-foreground mt-1\">\n                                {meal.description}\n                              </p>\n                            </div>\n                            <div className=\"text-right\">\n                              <p className=\"text-sm font-medium\">\n                                {meal.calories} cal\n                              </p>\n                            </div>\n                          </div>\n                          \n                          <div className=\"flex justify-between items-center mb-3 text-xs text-muted-foreground\">\n                            <span>Protein: {meal.protein}g</span>\n                            <span>Carbs: {meal.carbs}g</span>\n                            <span>Fat: {meal.fat}g</span>\n                          </div>\n\n                          <div className=\"mb-3\">\n                            <h5 className=\"text-sm font-medium mb-1\">Ingredients:</h5>\n                            <div className=\"flex flex-wrap gap-1\">\n                              {meal.ingredients.map((ingredient, idx) => (\n                                <span key={idx} className=\"text-xs bg-secondary text-secondary-foreground px-2 py-1 rounded\">\n                                  {ingredient}\n                                </span>\n                              ))}\n                            </div>\n                          </div>\n\n                          <div className=\"bg-primary/10 rounded p-3 mb-3\">\n                            <h5 className=\"text-sm font-medium mb-1\">Why this meal?</h5>\n                            <p className=\"text-sm text-muted-foreground\">\n                              {meal.benefits}\n                            </p>\n                          </div>\n\n\n                          {meal.cookingInstructions && meal.cookingInstructions.length > 0 && (\n                            <div className=\"bg-muted/50 rounded p-3 mb-3\">\n                              <h5 className=\"text-sm font-medium mb-2 flex items-center\">\n                                <ChefHat className=\"h-4 w-4 mr-1\" />\n                                How to Make It:\n                              </h5>\n                              <ol className=\"text-sm text-muted-foreground space-y-1\">\n                                {meal.cookingInstructions.map((instruction, idx) => (\n                                  <li key={idx} className=\"flex items-start\">\n                                    <span className=\"text-primary font-medium mr-2 flex-shrink-0\">{idx + 1}.</span>\n                                    <span>{instruction}</span>\n                                  </li>\n                                ))}\n                              </ol>\n                            </div>\n                          )}\n\n                          {meal.recipeLink && (\n                            <div className=\"flex justify-center\">\n                              <a \n                                href={meal.recipeLink} \n                                target=\"_blank\" \n                                rel=\"noopener noreferrer\"\n                                className=\"inline-flex items-center px-4 py-2 bg-primary text-primary-foreground rounded-lg text-sm font-medium hover:bg-primary/90 transition-colors\"\n                                data-testid={`button-recipe-link-${index}`}\n                              >\n                                <ExternalLink className=\"h-4 w-4 mr-2\" />\n                                View Full Recipe\n                              </a>\n                            </div>\n                          )}\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                )}\n              </div>\n            ) : (\n              <div className=\"text-center py-12\">\n                <Lightbulb className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\n                <h3 className=\"text-lg font-medium text-muted-foreground mb-2\">No Advice Yet</h3>\n                <p className=\"text-sm text-muted-foreground mb-4\">\n                  Add some meals to your diary to get personalized recommendations\n                </p>\n                <Link href=\"/diary\">\n                  <button \n                    className=\"bg-primary text-primary-foreground px-6 py-2 rounded-lg font-medium hover:bg-primary/90 transition-colors\"\n                    data-testid=\"button-view-diary\"\n                  >\n                    View Diary\n                  </button>\n                </Link>\n              </div>\n            )}\n          </>\n        ) : (\n          /* General Tips */\n          <div className=\"space-y-4\">\n            {generalTips.map((tip, index) => (\n              <div key={index} className=\"bg-card border rounded-lg p-4\">\n                <div className=\"flex items-start space-x-3\">\n                  <div className=\"flex-shrink-0 mt-1\">\n                    {tip.icon}\n                  </div>\n                  <div>\n                    <h3 className=\"font-semibold mb-2\">{tip.title}</h3>\n                    <p className=\"text-sm text-muted-foreground\">{tip.tip}</p>\n                  </div>\n                </div>\n              </div>\n            ))}\n            \n            <div className=\"bg-primary/10 border border-primary/20 rounded-lg p-4 mt-6\">\n              <h3 className=\"font-semibold text-primary mb-2\">ðŸ’¡ Pro Tip</h3>\n              <p className=\"text-sm text-primary/80\">\n                Track your meals consistently with PlateMate to get personalized advice based on your eating patterns and nutrition goals!\n              </p>\n            </div>\n          </div>\n        )}\n      </div>\n      \n      {/* Bottom Navigation */}\n      <DropdownNavigation />\n      \n      {/* Bottom Help Section */}\n      <BottomHelpSection />\n    </div>\n  );\n}\n\nexport default DietAdvicePage;","size_bytes":24666},"client/src/lib/guest-storage.ts":{"content":"/**\n * Local storage service for guest user data\n * Stores diary entries, weights, and goals locally\n */\n\nimport type { DiaryEntry, WeightEntry, NutritionGoals } from \"@shared/schema\";\n\nconst GUEST_DIARY_KEY = 'platemate_guest_diary';\nconst GUEST_WEIGHTS_KEY = 'platemate_guest_weights';\nconst GUEST_GOALS_KEY = 'platemate_guest_goals';\n\n/**\n * Guest Diary Storage\n */\nexport const guestDiaryStorage = {\n  getAll(): DiaryEntry[] {\n    try {\n      const data = localStorage.getItem(GUEST_DIARY_KEY);\n      return data ? JSON.parse(data) : [];\n    } catch {\n      return [];\n    }\n  },\n\n  save(entry: DiaryEntry): void {\n    const entries = this.getAll();\n    entries.push(entry);\n    localStorage.setItem(GUEST_DIARY_KEY, JSON.stringify(entries));\n  },\n\n  update(id: string, updates: Partial<DiaryEntry>): void {\n    const entries = this.getAll();\n    const index = entries.findIndex(e => e.id === id);\n    if (index !== -1) {\n      entries[index] = { ...entries[index], ...updates };\n      localStorage.setItem(GUEST_DIARY_KEY, JSON.stringify(entries));\n    }\n  },\n\n  delete(id: string): void {\n    const entries = this.getAll().filter(e => e.id !== id);\n    localStorage.setItem(GUEST_DIARY_KEY, JSON.stringify(entries));\n  },\n\n  clear(): void {\n    localStorage.removeItem(GUEST_DIARY_KEY);\n  }\n};\n\n/**\n * Guest Weights Storage\n */\nexport const guestWeightsStorage = {\n  getAll(): WeightEntry[] {\n    try {\n      const data = localStorage.getItem(GUEST_WEIGHTS_KEY);\n      return data ? JSON.parse(data) : [];\n    } catch {\n      return [];\n    }\n  },\n\n  save(weight: WeightEntry): void {\n    const weights = this.getAll();\n    weights.push(weight);\n    localStorage.setItem(GUEST_WEIGHTS_KEY, JSON.stringify(weights));\n  },\n\n  update(id: string, updates: Partial<WeightEntry>): void {\n    const weights = this.getAll();\n    const index = weights.findIndex(w => w.id === id);\n    if (index !== -1) {\n      weights[index] = { ...weights[index], ...updates };\n      localStorage.setItem(GUEST_WEIGHTS_KEY, JSON.stringify(weights));\n    }\n  },\n\n  delete(id: string): void {\n    const weights = this.getAll().filter(w => w.id !== id);\n    localStorage.setItem(GUEST_WEIGHTS_KEY, JSON.stringify(weights));\n  },\n\n  clear(): void {\n    localStorage.removeItem(GUEST_WEIGHTS_KEY);\n  }\n};\n\n/**\n * Guest Goals Storage\n */\nexport const guestGoalsStorage = {\n  get(): NutritionGoals | null {\n    try {\n      const data = localStorage.getItem(GUEST_GOALS_KEY);\n      return data ? JSON.parse(data) : null;\n    } catch {\n      return null;\n    }\n  },\n\n  save(goal: NutritionGoals): void {\n    localStorage.setItem(GUEST_GOALS_KEY, JSON.stringify(goal));\n  },\n\n  clear(): void {\n    localStorage.removeItem(GUEST_GOALS_KEY);\n  }\n};\n\n/**\n * Get all guest data for migration\n */\nexport function getAllGuestData() {\n  return {\n    diary: guestDiaryStorage.getAll(),\n    weights: guestWeightsStorage.getAll(),\n    goals: guestGoalsStorage.get()\n  };\n}\n\n/**\n * Clear all guest storage\n */\nexport function clearAllGuestStorage(): void {\n  guestDiaryStorage.clear();\n  guestWeightsStorage.clear();\n  guestGoalsStorage.clear();\n}\n","size_bytes":3109},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","size_bytes":689},"client/src/components/barcode-scanner.tsx":{"content":"import { useState } from \"react\";\nimport type { KeyboardEvent } from \"react\";\n// Icons for the interface\nconst QrCode = ({ className }: { className?: string }) => <div className={`${className} inline-block`}>ðŸ·ï¸</div>;\nconst X = ({ className }: { className?: string }) => <div className={`${className} inline-block`}>âŒ</div>;\nconst Scan = ({ className }: { className?: string }) => <div className={`${className} inline-block`}>ðŸ”</div>;\nconst AlertCircle = ({ className }: { className?: string }) => <div className={`${className} inline-block`}>âš ï¸</div>;\nconst CheckCircle = ({ className }: { className?: string }) => <div className={`${className} inline-block`}>âœ…</div>;\n// Removed Button import to fix dependency issues\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface BarcodeScannerProps {\n  onScanSuccess: (result: string) => void;\n  onClose: () => void;\n  isOpen: boolean;\n}\n\nexport function BarcodeScanner({ onScanSuccess, onClose, isOpen }: BarcodeScannerProps) {\n  const { toast } = useToast();\n  const [scanError, setScanError] = useState<string | null>(null);\n  const [manualBarcode, setManualBarcode] = useState('');\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  const handleManualSubmit = async () => {\n    if (!manualBarcode.trim()) {\n      setScanError('Please enter a barcode number');\n      return;\n    }\n    \n    const barcodeValue = manualBarcode.trim();\n    \n    // Basic barcode validation (typically 12-14 digits)\n    if (!/^\\d{8,14}$/.test(barcodeValue)) {\n      setScanError('Please enter a valid barcode (8-14 digits)');\n      return;\n    }\n    \n    setIsSubmitting(true);\n    setScanError(null);\n    \n    try {\n      toast({\n        title: \"Looking up product...\",\n        description: `Searching for barcode: ${barcodeValue}`,\n      });\n      \n      onScanSuccess(barcodeValue);\n      // Keep isSubmitting true - parent will close modal on success/error\n    } catch (error: any) {\n      console.error('Error submitting barcode:', error);\n      setScanError('Failed to look up product. Please try again.');\n      setIsSubmitting(false);\n    }\n  };\n\n  const handleKeyPress = (e: KeyboardEvent<HTMLInputElement>) => {\n    if (e.key === 'Enter') {\n      handleManualSubmit();\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 p-4\">\n      <div className=\"bg-white dark:bg-gray-800 rounded-xl p-6 w-full max-w-md shadow-2xl border\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between mb-6\">\n          <div className=\"flex items-center space-x-2\">\n            <QrCode className=\"h-6 w-6 text-blue-600\" />\n            <h3 className=\"text-xl font-bold\">Enter Barcode</h3>\n          </div>\n          <button\n            className=\"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground h-9 px-3\"\n            onClick={onClose}\n            data-testid=\"button-close-scanner\"\n          >\n            <X className=\"h-5 w-5\" />\n          </button>\n        </div>\n\n        {/* Manual Entry */}\n        <div className=\"mb-6\">\n          <label className=\"block text-sm font-medium mb-3 text-gray-700 dark:text-gray-300\">\n            Product Barcode Number\n          </label>\n          <input\n            type=\"text\"\n            value={manualBarcode}\n            onChange={(e) => {\n              setManualBarcode(e.target.value.replace(/\\D/g, '')); // Only allow digits\n              setScanError(null);\n            }}\n            onKeyPress={handleKeyPress}\n            placeholder=\"Enter 12-14 digit barcode (e.g., 123456789012)\"\n            className=\"w-full p-4 border rounded-lg text-center font-mono text-lg bg-gray-50 dark:bg-gray-700 border-gray-300 dark:border-gray-600 focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            data-testid=\"input-manual-barcode\"\n            disabled={isSubmitting}\n            maxLength={14}\n            autoFocus\n          />\n        </div>\n\n        {/* Error display */}\n        {scanError && (\n          <div className=\"mb-4 p-3 bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-700 rounded-lg\">\n            <div className=\"flex items-center space-x-2\">\n              <AlertCircle className=\"h-4 w-4 text-red-600 dark:text-red-400\" />\n              <p className=\"text-sm text-red-700 dark:text-red-300\">{scanError}</p>\n            </div>\n          </div>\n        )}\n\n        {/* Instructions */}\n        <div className=\"text-center text-sm text-gray-600 dark:text-gray-400 mb-6\">\n          <div className=\"bg-blue-50 dark:bg-blue-900/30 p-4 rounded-lg\">\n            <QrCode className=\"h-8 w-8 mx-auto mb-2 text-blue-600\" />\n            <p className=\"font-medium mb-2\">How to find the barcode:</p>\n            <div className=\"text-left space-y-1\">\n              <p>â€¢ Look for black and white lines on the package</p>\n              <p>â€¢ The numbers are printed below the lines</p>\n              <p>â€¢ Usually 12-13 digits long</p>\n              <p>â€¢ Found on the back or bottom of products</p>\n            </div>\n          </div>\n        </div>\n\n        {/* Action buttons */}\n        <div className=\"flex space-x-3\">\n          <button\n            className=\"flex-1 inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2\"\n            onClick={onClose}\n            data-testid=\"button-cancel-scan\"\n            disabled={isSubmitting}\n          >\n            Cancel\n          </button>\n          <button\n            onClick={handleManualSubmit}\n            disabled={!manualBarcode.trim() || isSubmitting}\n            className=\"flex-1 inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-blue-600 text-white hover:bg-blue-500 h-10 px-4 py-2\"\n            data-testid=\"button-submit-barcode\"\n          >\n            {isSubmitting ? (\n              <div className=\"flex items-center space-x-2\">\n                <Scan className=\"h-4 w-4 animate-pulse\" />\n                <span>Looking up...</span>\n              </div>\n            ) : (\n              <div className=\"flex items-center space-x-2\">\n                <CheckCircle className=\"h-4 w-4\" />\n                <span>Look Up Product</span>\n              </div>\n            )}\n          </button>\n        </div>\n\n        {/* Sample barcodes for testing */}\n        <div className=\"mt-4 text-center\">\n          <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-2\">Test with sample barcodes:</p>\n          <div className=\"flex flex-wrap gap-2 justify-center\">\n            {['7622210951015', '3017624010701', '4902505109508'].map((sample) => (\n              <button\n                key={sample}\n                onClick={() => setManualBarcode(sample)}\n                className=\"text-xs bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded hover:bg-gray-200 dark:hover:bg-gray-600 font-mono\"\n                data-testid={`button-sample-${sample}`}\n              >\n                {sample}\n              </button>\n            ))}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":7753},"client/src/pages/VoicePage.tsx":{"content":"import { useState, useEffect, useRef } from \"react\";\nimport { mediaService } from '@/lib/media-service';\nimport { useToast } from \"@/hooks/use-toast\";\nimport { AppHeader } from \"@/components/app-header\";\nimport { \n  Mic, \n  MicOff, \n  Play, \n  Pause, \n  Square, \n  Download, \n  Volume2,\n  Info, \n  CheckCircle, \n  XCircle,\n  AudioLines,\n  RefreshCw,\n  MessageSquare\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Slider } from \"@/components/ui/slider\";\n\ninterface AudioRecording {\n  blob: Blob;\n  url: string;\n  duration: number;\n  timestamp: Date;\n}\n\ninterface RecordingState {\n  isRecording: boolean;\n  isPaused: boolean;\n  duration: number;\n  volume: number;\n}\n\ninterface VoiceInputState {\n  isListening: boolean;\n  transcript: string;\n  confidence: number;\n  language: string;\n}\n\nexport default function VoicePage() {\n  const { toast } = useToast();\n  const audioRef = useRef<HTMLAudioElement>(null);\n  const animationRef = useRef<number>();\n  \n  // Recording state\n  const [recordingState, setRecordingState] = useState<RecordingState>({\n    isRecording: false,\n    isPaused: false,\n    duration: 0,\n    volume: 0\n  });\n  \n  // Voice input state\n  const [voiceInput, setVoiceInput] = useState<VoiceInputState>({\n    isListening: false,\n    transcript: '',\n    confidence: 0,\n    language: 'en-US'\n  });\n  \n  // Audio recordings\n  const [recordings, setRecordings] = useState<AudioRecording[]>([]);\n  const [currentRecording, setCurrentRecording] = useState<AudioRecording | null>(null);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [playbackTime, setPlaybackTime] = useState(0);\n  const [playbackVolume, setPlaybackVolume] = useState([50]);\n  \n  // Permissions and capabilities\n  const [permissions, setPermissions] = useState({\n    microphone: false,\n    checked: false\n  });\n  const [capabilities, setCApabilities] = useState({\n    mediaSupported: false,\n    mediaRecorderSupported: false,\n    speechRecognitionSupported: false,\n    secureContext: false\n  });\n  \n  const [isLoading, setIsLoading] = useState(false);\n\n  // Initialize component\n  useEffect(() => {\n    const initialize = async () => {\n      // Check capabilities\n      setCApabilities({\n        mediaSupported: mediaService.isMediaSupported(),\n        mediaRecorderSupported: mediaService.checkMediaRecorderSupport(),\n        speechRecognitionSupported: 'SpeechRecognition' in window || 'webkitSpeechRecognition' in window,\n        secureContext: mediaService.isSecureContext()\n      });\n\n      // Check permissions\n      await checkPermissions();\n    };\n\n    initialize();\n\n    // Cleanup on unmount\n    return () => {\n      if (recordingState.isRecording) {\n        stopRecording();\n      }\n      if (voiceInput.isListening) {\n        stopVoiceInput();\n      }\n      if (animationRef.current) {\n        cancelAnimationFrame(animationRef.current);\n      }\n    };\n  }, []);\n\n  // Audio playback time update\n  useEffect(() => {\n    const audio = audioRef.current;\n    if (!audio) return;\n\n    const updateTime = () => {\n      setPlaybackTime(audio.currentTime);\n    };\n\n    const handleEnd = () => {\n      setIsPlaying(false);\n      setPlaybackTime(0);\n    };\n\n    audio.addEventListener('timeupdate', updateTime);\n    audio.addEventListener('ended', handleEnd);\n\n    return () => {\n      audio.removeEventListener('timeupdate', updateTime);\n      audio.removeEventListener('ended', handleEnd);\n    };\n  }, [currentRecording]);\n\n  // Update audio volume\n  useEffect(() => {\n    if (audioRef.current) {\n      audioRef.current.volume = playbackVolume[0] / 100;\n    }\n  }, [playbackVolume]);\n\n  const checkPermissions = async () => {\n    try {\n      const mediaPermissions = await mediaService.checkPermissions();\n      setPermissions({\n        microphone: mediaPermissions.microphone,\n        checked: true\n      });\n    } catch (error) {\n      console.error('Permission check failed:', error);\n      setPermissions({ microphone: false, checked: true });\n    }\n  };\n\n  const startRecording = async () => {\n    if (!capabilities.mediaSupported) {\n      toast({\n        title: \"Not Supported\",\n        description: \"Microphone recording is not supported in this browser\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    try {\n      setIsLoading(true);\n      \n      // Start microphone stream\n      await mediaService.startMicrophoneRecording();\n      \n      // Start audio recording\n      await mediaService.startAudioRecording();\n      \n      setRecordingState(prev => ({\n        ...prev,\n        isRecording: true,\n        duration: 0\n      }));\n\n      // Start duration timer and volume monitoring\n      const startTime = Date.now();\n      const updateRecordingState = () => {\n        if (recordingState.isRecording) {\n          const elapsed = (Date.now() - startTime) / 1000;\n          setRecordingState(prev => ({\n            ...prev,\n            duration: elapsed,\n            volume: Math.random() * 100 // Simulated volume - in real app would use actual audio analysis\n          }));\n          animationRef.current = requestAnimationFrame(updateRecordingState);\n        }\n      };\n      updateRecordingState();\n\n      toast({\n        title: \"Recording Started! ðŸŽ¤\",\n        description: \"Microphone is now recording audio\",\n      });\n    } catch (error) {\n      console.error('Failed to start recording:', error);\n      toast({\n        title: \"Recording Error\",\n        description: `Failed to start recording: ${error}`,\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const stopRecording = async () => {\n    try {\n      setIsLoading(true);\n      \n      // Stop animation\n      if (animationRef.current) {\n        cancelAnimationFrame(animationRef.current);\n      }\n\n      // Stop recording\n      const audioBlob = await mediaService.stopAudioRecording();\n      mediaService.stopMicrophone();\n\n      // Create recording object\n      const recording: AudioRecording = {\n        blob: audioBlob,\n        url: URL.createObjectURL(audioBlob),\n        duration: recordingState.duration,\n        timestamp: new Date()\n      };\n\n      setRecordings(prev => [recording, ...prev]);\n      setCurrentRecording(recording);\n      setRecordingState(prev => ({\n        ...prev,\n        isRecording: false,\n        isPaused: false,\n        duration: 0,\n        volume: 0\n      }));\n\n      toast({\n        title: \"Recording Saved! ðŸ’¾\",\n        description: `Recorded ${recording.duration.toFixed(1)} seconds of audio`,\n      });\n    } catch (error) {\n      console.error('Failed to stop recording:', error);\n      toast({\n        title: \"Stop Recording Error\",\n        description: `Failed to stop recording: ${error}`,\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const playRecording = (recording: AudioRecording) => {\n    if (!audioRef.current) return;\n\n    if (isPlaying && currentRecording === recording) {\n      audioRef.current.pause();\n      setIsPlaying(false);\n    } else {\n      setCurrentRecording(recording);\n      audioRef.current.src = recording.url;\n      audioRef.current.play();\n      setIsPlaying(true);\n    }\n  };\n\n  const downloadRecording = (recording: AudioRecording, index: number) => {\n    const link = document.createElement('a');\n    link.href = recording.url;\n    link.download = `platemate-recording-${index + 1}.webm`;\n    link.click();\n\n    toast({\n      title: \"Recording Downloaded! ðŸ’¾\",\n      description: \"Audio file has been saved to your downloads\",\n    });\n  };\n\n  const startVoiceInput = () => {\n    if (!capabilities.speechRecognitionSupported) {\n      toast({\n        title: \"Not Supported\",\n        description: \"Speech recognition is not supported in this browser\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    // Clean stop any existing recognition first\n    if ((window as any).currentRecognition) {\n      try {\n        (window as any).currentRecognition.abort();\n      } catch (e) {}\n      (window as any).currentRecognition = null;\n    }\n\n    try {\n      const SpeechRecognition = window.SpeechRecognition || (window as any).webkitSpeechRecognition;\n      const recognition = new SpeechRecognition();\n      \n      // Simple settings that work reliably\n      recognition.continuous = true; // Allow longer speech\n      recognition.interimResults = true; // Show progress\n      recognition.lang = voiceInput.language;\n      recognition.maxAlternatives = 1;\n\n      recognition.onstart = () => {\n        console.log('ðŸŽ¤ Voice recognition started');\n        setVoiceInput(prev => ({ ...prev, isListening: true, transcript: '' }));\n        toast({\n          title: \"Listening... ðŸ‘‚\",\n          description: \"Speak now - click stop when done\",\n        });\n      };\n\n      recognition.onresult = (event: any) => {\n        console.log('ðŸŽ¤ Voice recognition got result');\n        let finalTranscript = '';\n        let interimTranscript = '';\n\n        for (let i = event.resultIndex; i < event.results.length; i++) {\n          const transcript = event.results[i][0].transcript;\n          \n          if (event.results[i].isFinal) {\n            finalTranscript += transcript;\n          } else {\n            interimTranscript += transcript;\n          }\n        }\n\n        // Update transcript with final + interim\n        setVoiceInput(prev => ({\n          ...prev,\n          transcript: prev.transcript + finalTranscript + interimTranscript,\n          confidence: event.results[event.results.length - 1]?.[0]?.confidence || 0\n        }));\n\n        // Show success toast for final results\n        if (finalTranscript.trim()) {\n          toast({\n            title: \"Got it! âœ…\",\n            description: `Heard: \"${finalTranscript.trim()}\"`,\n          });\n        }\n      };\n\n      recognition.onerror = (event: any) => {\n        console.error('Speech recognition error:', event.error);\n        setVoiceInput(prev => ({ ...prev, isListening: false }));\n        (window as any).currentRecognition = null;\n        \n        if (event.error !== 'aborted' && event.error !== 'no-speech') {\n          toast({\n            title: \"Speech Error\", \n            description: `Error: ${event.error}`,\n            variant: \"destructive\",\n          });\n        }\n      };\n\n      recognition.onend = () => {\n        console.log('ðŸŽ¤ Voice recognition ended');\n        setVoiceInput(prev => ({ ...prev, isListening: false }));\n        (window as any).currentRecognition = null;\n      };\n\n      // Start recognition\n      recognition.start();\n      (window as any).currentRecognition = recognition;\n      \n    } catch (error) {\n      console.error('Failed to start voice input:', error);\n      setVoiceInput(prev => ({ ...prev, isListening: false }));\n      toast({\n        title: \"Voice Input Error\",\n        description: `Failed to start voice input`,\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const stopVoiceInput = () => {\n    console.log('ðŸ›‘ Stopping voice input');\n    \n    // Update state immediately\n    setVoiceInput(prev => ({ ...prev, isListening: false }));\n    \n    // Stop recognition cleanly\n    const recognition = (window as any).currentRecognition;\n    if (recognition) {\n      try {\n        recognition.stop(); // Use stop() instead of abort() for cleaner shutdown\n        console.log('ðŸ›‘ Recognition.stop() called');\n      } catch (error) {\n        console.warn('Error stopping recognition:', error);\n        try {\n          recognition.abort(); // Fallback to abort if stop fails\n        } catch (abortError) {\n          console.warn('Error aborting recognition:', abortError);\n        }\n      }\n      \n      // Clear reference\n      (window as any).currentRecognition = null;\n    }\n    \n    toast({\n      title: \"Voice Stopped âœ‹\",\n      description: \"Speech recognition has been stopped\",\n    });\n  };\n\n  const formatTime = (seconds: number) => {\n    const minutes = Math.floor(seconds / 60);\n    const remainingSeconds = Math.floor(seconds % 60);\n    return `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;\n  };\n\n  return (\n    <div className=\"min-h-screen text-foreground\" style={{background: 'var(--bg-gradient)'}}>\n      <AppHeader />\n      \n      <div className=\"max-w-4xl mx-auto px-4 py-6 space-y-6\">\n        {/* Header */}\n        <div className=\"text-center space-y-2\">\n          <h1 className=\"text-4xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 dark:from-purple-400 dark:to-pink-400 bg-clip-text text-transparent\">\n            Voice & Recording Test\n          </h1>\n          <p className=\"text-lg text-muted-foreground\">\n            Test microphone recording and voice input functionality\n          </p>\n        </div>\n\n        {/* Capabilities Card */}\n        <Card className=\"bg-white/60 dark:bg-gray-800/60 backdrop-blur-xl border-white/20 shadow-xl\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Info className=\"h-5 w-5\" />\n              Device Capabilities\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div className=\"space-y-3\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"font-medium\">Media API Support:</span>\n                  <Badge variant={capabilities.mediaSupported ? \"default\" : \"destructive\"} className=\"flex items-center gap-1\">\n                    {capabilities.mediaSupported ? <CheckCircle className=\"h-3 w-3\" /> : <XCircle className=\"h-3 w-3\" />}\n                    {capabilities.mediaSupported ? 'Supported' : 'Not Supported'}\n                  </Badge>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"font-medium\">MediaRecorder:</span>\n                  <Badge variant={capabilities.mediaRecorderSupported ? \"default\" : \"destructive\"} className=\"flex items-center gap-1\">\n                    {capabilities.mediaRecorderSupported ? <CheckCircle className=\"h-3 w-3\" /> : <XCircle className=\"h-3 w-3\" />}\n                    {capabilities.mediaRecorderSupported ? 'Supported' : 'Not Supported'}\n                  </Badge>\n                </div>\n              </div>\n              <div className=\"space-y-3\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"font-medium\">Speech Recognition:</span>\n                  <Badge variant={capabilities.speechRecognitionSupported ? \"default\" : \"destructive\"} className=\"flex items-center gap-1\">\n                    {capabilities.speechRecognitionSupported ? <CheckCircle className=\"h-3 w-3\" /> : <XCircle className=\"h-3 w-3\" />}\n                    {capabilities.speechRecognitionSupported ? 'Supported' : 'Not Supported'}\n                  </Badge>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"font-medium\">Microphone Permission:</span>\n                  <Badge variant={permissions.microphone ? \"default\" : \"destructive\"} className=\"flex items-center gap-1\">\n                    {permissions.microphone ? <CheckCircle className=\"h-3 w-3\" /> : <XCircle className=\"h-3 w-3\" />}\n                    {permissions.microphone ? 'Granted' : 'Denied'}\n                  </Badge>\n                </div>\n              </div>\n            </div>\n            <Button\n              onClick={checkPermissions}\n              disabled={isLoading}\n              variant=\"ghost\"\n              className=\"w-full mt-4\"\n              data-testid=\"button-refresh-permissions\"\n            >\n              <RefreshCw className=\"mr-2 h-4 w-4\" />\n              Refresh Permissions\n            </Button>\n          </CardContent>\n        </Card>\n\n        {/* Recording Controls */}\n        <Card className=\"bg-white/60 dark:bg-gray-800/60 backdrop-blur-xl border-white/20 shadow-xl\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Mic className=\"h-5 w-5\" />\n              Audio Recording\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-6\">\n            {/* Recording Button */}\n            <div className=\"flex justify-center\">\n              {!recordingState.isRecording ? (\n                <Button\n                  onClick={startRecording}\n                  disabled={isLoading || !capabilities.mediaSupported}\n                  size=\"lg\"\n                  className=\"h-20 w-20 rounded-full bg-gradient-to-r from-red-500 to-pink-600 hover:from-red-600 hover:to-pink-700 text-white shadow-lg\"\n                  data-testid=\"button-start-recording\"\n                >\n                  <Mic className=\"h-8 w-8\" />\n                </Button>\n              ) : (\n                <Button\n                  onClick={stopRecording}\n                  disabled={isLoading}\n                  size=\"lg\"\n                  className=\"h-20 w-20 rounded-full bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white shadow-lg animate-pulse\"\n                  data-testid=\"button-stop-recording\"\n                >\n                  <Square className=\"h-8 w-8\" />\n                </Button>\n              )}\n            </div>\n\n            {/* Recording Status */}\n            {recordingState.isRecording && (\n              <div className=\"space-y-3\">\n                <div className=\"text-center\">\n                  <p className=\"text-2xl font-mono font-bold text-red-600 dark:text-red-400\">\n                    {formatTime(recordingState.duration)}\n                  </p>\n                  <p className=\"text-sm text-muted-foreground\">Recording...</p>\n                </div>\n                \n                <div className=\"space-y-2\">\n                  <div className=\"flex justify-between text-sm\">\n                    <span>Volume Level</span>\n                    <span>{Math.round(recordingState.volume)}%</span>\n                  </div>\n                  <Progress value={recordingState.volume} className=\"h-2\" />\n                </div>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Voice Input */}\n        <Card className=\"bg-white/60 dark:bg-gray-800/60 backdrop-blur-xl border-white/20 shadow-xl\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <MessageSquare className=\"h-5 w-5\" />\n              Voice Input Test\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"flex justify-center\">\n              <Button\n                onClick={voiceInput.isListening ? stopVoiceInput : startVoiceInput}\n                disabled={!capabilities.speechRecognitionSupported}\n                className={`h-16 px-8 ${\n                  voiceInput.isListening \n                    ? 'bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 animate-pulse' \n                    : 'bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700'\n                } text-white font-semibold`}\n                data-testid=\"button-voice-input\"\n              >\n                {voiceInput.isListening ? (\n                  <>\n                    <MicOff className=\"mr-2 h-5 w-5\" />\n                    Stop Listening\n                  </>\n                ) : (\n                  <>\n                    <Mic className=\"mr-2 h-5 w-5\" />\n                    Start Voice Input\n                  </>\n                )}\n              </Button>\n            </div>\n\n            {voiceInput.transcript && (\n              <div className=\"bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-950/30 dark:to-pink-950/30 rounded-xl p-6 border border-purple-200/30 dark:border-purple-700/30\">\n                <h4 className=\"font-semibold mb-3 text-purple-700 dark:text-purple-300\">Transcript:</h4>\n                <p className=\"text-lg leading-relaxed\" data-testid=\"text-voice-transcript\">\n                  {voiceInput.transcript}\n                </p>\n                {voiceInput.confidence > 0 && (\n                  <div className=\"mt-4 flex items-center gap-2\">\n                    <span className=\"text-sm font-medium\">Confidence:</span>\n                    <Progress value={voiceInput.confidence * 100} className=\"flex-1 h-2\" />\n                    <span className=\"text-sm\">{Math.round(voiceInput.confidence * 100)}%</span>\n                  </div>\n                )}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Recordings List */}\n        {recordings.length > 0 && (\n          <Card className=\"bg-white/60 dark:bg-gray-800/60 backdrop-blur-xl border-white/20 shadow-xl\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <AudioLines className=\"h-5 w-5\" />\n                Recordings ({recordings.length})\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              {/* Audio Element */}\n              <audio ref={audioRef} style={{ display: 'none' }} />\n\n              {/* Volume Control */}\n              {currentRecording && (\n                <div className=\"flex items-center gap-4 p-4 bg-gradient-to-r from-purple-100 to-pink-100 dark:from-purple-900/30 dark:to-pink-900/30 rounded-xl\">\n                  <Volume2 className=\"h-4 w-4\" />\n                  <Slider\n                    value={playbackVolume}\n                    onValueChange={setPlaybackVolume}\n                    max={100}\n                    step={1}\n                    className=\"flex-1\"\n                    data-testid=\"slider-volume\"\n                  />\n                  <span className=\"text-sm w-10\">{playbackVolume[0]}%</span>\n                </div>\n              )}\n\n              {/* Recording Items */}\n              {recordings.map((recording, index) => (\n                <div\n                  key={index}\n                  className=\"flex items-center gap-4 p-4 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800/50 dark:to-gray-700/50 rounded-xl\"\n                  data-testid={`recording-item-${index}`}\n                >\n                  <Button\n                    onClick={() => playRecording(recording)}\n                    variant=\"outline\"\n                    size=\"sm\"\n                    className=\"h-10 w-10 rounded-full p-0\"\n                    data-testid={`button-play-recording-${index}`}\n                  >\n                    {isPlaying && currentRecording === recording ? (\n                      <Pause className=\"h-4 w-4\" />\n                    ) : (\n                      <Play className=\"h-4 w-4\" />\n                    )}\n                  </Button>\n                  \n                  <div className=\"flex-1\">\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"font-medium\">Recording #{recordings.length - index}</span>\n                      <span className=\"text-sm text-muted-foreground\">\n                        {formatTime(recording.duration)}\n                      </span>\n                    </div>\n                    <p className=\"text-xs text-muted-foreground\">\n                      {recording.timestamp.toLocaleString()}\n                    </p>\n                    \n                    {/* Playback Progress */}\n                    {isPlaying && currentRecording === recording && (\n                      <div className=\"mt-2\">\n                        <Progress \n                          value={(playbackTime / recording.duration) * 100} \n                          className=\"h-1\"\n                        />\n                        <div className=\"flex justify-between text-xs text-muted-foreground mt-1\">\n                          <span>{formatTime(playbackTime)}</span>\n                          <span>{formatTime(recording.duration)}</span>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                  \n                  <Button\n                    onClick={() => downloadRecording(recording, index)}\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    data-testid={`button-download-recording-${index}`}\n                  >\n                    <Download className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              ))}\n            </CardContent>\n          </Card>\n        )}\n      </div>\n    </div>\n  );\n}","size_bytes":24708},"client/src/components/scanner-modal.tsx":{"content":"import { useState, useRef, useEffect } from 'react';\nimport { useLocation } from 'wouter';\nimport { X, Zap, ZapOff, AlertCircle } from 'lucide-react';\nimport { Dialog, DialogContent, DialogTitle, DialogDescription } from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport { createBarcodeScanner, ScannerResult, ScannerError } from '@/services/scanner-service';\nimport { PermissionDebugger } from '@/components/permission-debugger';\nimport { Capacitor } from '@capacitor/core';\n\ninterface ScannerModalProps {\n  isOpen: boolean;\n  onScanSuccess: (barcode: string) => void;\n  onClose: () => void;\n  mode?: 'barcode' | 'menu'; // 'barcode' for product scanning, 'menu' for restaurant QR codes\n}\n\nexport function ScannerModal({ isOpen, onScanSuccess, onClose, mode = 'barcode' }: ScannerModalProps) {\n  const [, setLocation] = useLocation();\n  const [isScanning, setIsScanning] = useState(false);\n  const [torchEnabled, setTorchEnabled] = useState(false);\n  const [torchSupported, setTorchSupported] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [scannerReady, setScannerReady] = useState(false);\n  const [showDebugger, setShowDebugger] = useState(false);\n  \n  const videoRef = useRef<HTMLVideoElement>(null);\n  const scannerRef = useRef<ReturnType<typeof createBarcodeScanner> | null>(null);\n\n  // Create scanner instance\n  useEffect(() => {\n    if (!isOpen) return;\n\n    const handleScanResult = (result: ScannerResult) => {\n      // Vibrate on successful scan (if supported)\n      if ('vibrate' in navigator) {\n        navigator.vibrate(100);\n      }\n      \n      // Play success sound\n      try {\n        const audio = new Audio('/success-beep.mp3');\n        audio.volume = 0.3;\n        audio.play().catch(() => {});\n      } catch (error) {\n        // Sound playback failed, continue silently\n      }\n      \n      // Stop scanning and notify parent\n      stopScanning();\n      onScanSuccess(result.barcode);\n    };\n\n    const handleScanError = (scanError: ScannerError) => {\n      console.error('Scanner error:', scanError);\n      setError(scanError.message);\n      setIsScanning(false);\n      setScannerReady(false);\n      \n      // Keep error visible for user to see and manually choose manual entry if needed\n    };\n\n    scannerRef.current = createBarcodeScanner(handleScanResult, handleScanError);\n    \n    return () => {\n      if (scannerRef.current) {\n        scannerRef.current.stopScanning();\n        scannerRef.current = null;\n      }\n    };\n  }, [isOpen, onScanSuccess]);\n\n  const startScanning = async () => {\n    if (!scannerRef.current) return;\n    \n    try {\n      setError(null);\n      setIsScanning(true);\n      \n      // Native platforms handle their own camera UI\n      if (Capacitor.isNativePlatform()) {\n        console.log('ðŸ“± Starting native scanner (handles own UI)');\n        // Native scanner doesn't need video element or stream\n        await scannerRef.current.startScanning(videoRef.current!);\n        setScannerReady(true);\n      } else {\n        // Web platforms need getUserMedia and video element\n        if (!videoRef.current) return;\n        \n        console.log('ðŸŒ Starting web scanner with camera stream');\n        // CRITICAL: Request camera access SYNCHRONOUSLY before any state updates\n        // This ensures the browser considers it part of the user gesture\n        // Use back camera (environment) for scanning barcodes\n        const stream = await navigator.mediaDevices.getUserMedia({ \n          video: { facingMode: 'environment' } \n        });\n        \n        // Pass the stream to the scanner\n        await scannerRef.current.startScanning(videoRef.current, stream);\n        setScannerReady(true);\n        \n        // Check torch support\n        const supported = await scannerRef.current.isTorchSupported();\n        setTorchSupported(supported);\n      }\n    } catch (error) {\n      console.error('Failed to start scanning:', error);\n      const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n      setError(`Camera error: ${errorMessage}`);\n      setIsScanning(false);\n      setScannerReady(false);\n    }\n  };\n\n  const stopScanning = () => {\n    if (scannerRef.current) {\n      scannerRef.current.stopScanning();\n    }\n    setIsScanning(false);\n    setScannerReady(false);\n    setTorchEnabled(false);\n  };\n\n  const toggleTorch = async () => {\n    if (!scannerRef.current || !torchSupported) return;\n    \n    try {\n      const enabled = await scannerRef.current.toggleTorch();\n      setTorchEnabled(enabled);\n    } catch (error) {\n      // Torch toggle failed, continue silently\n    }\n  };\n\n  const handleClose = () => {\n    stopScanning();\n    onClose();\n  };\n\n  // Reset state when modal closes\n  useEffect(() => {\n    if (!isOpen) {\n      stopScanning();\n      setError(null);\n    }\n  }, [isOpen]);\n\n  const isMenuMode = mode === 'menu';\n  const headerGradient = isMenuMode \n    ? 'bg-gradient-to-r from-purple-600 via-pink-600 to-red-600' \n    : 'bg-black/80';\n  const accentColor = isMenuMode ? 'purple' : 'blue';\n\n  return (\n    <Dialog open={isOpen} onOpenChange={handleClose}>\n      <DialogContent className=\"max-w-full w-screen h-screen p-0 bg-black flex flex-col\" data-testid=\"modal-barcode-scanner\">\n        <DialogTitle className=\"sr-only\">{isMenuMode ? 'Menu QR Scanner' : 'Barcode Scanner'}</DialogTitle>\n        <DialogDescription className=\"sr-only\">\n          {isMenuMode \n            ? 'Use your camera to scan restaurant menu QR codes' \n            : 'Use your camera to scan product barcodes for nutrition information'}\n        </DialogDescription>\n        \n        {/* Header */}\n        <div className={`flex items-center justify-between p-4 backdrop-blur-sm border-b ${isMenuMode ? 'border-purple-300/20' : 'border-white/10'} ${headerGradient}`}>\n          <div>\n            <h2 className=\"text-white text-lg font-semibold\" data-testid=\"text-scanner-title\">\n              {isMenuMode ? 'ðŸ½ï¸ Scan Menu QR Code' : 'ðŸ“¦ Scan Barcode'}\n            </h2>\n            <p className=\"text-white/60 text-xs\">\n              {isMenuMode \n                ? 'Point camera at restaurant menu QR code' \n                : 'Allow camera access when prompted'}\n            </p>\n          </div>\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={handleClose}\n            className=\"text-white hover:bg-white/10\"\n            data-testid=\"button-close-scanner\"\n          >\n            <X className=\"h-5 w-5\" />\n          </Button>\n        </div>\n\n        {/* Video Container */}\n        <div className=\"flex-1 relative bg-black flex items-center justify-center\">\n          <video\n            ref={videoRef}\n            className=\"w-full h-full object-cover\"\n            playsInline\n            muted\n            autoPlay\n            data-testid=\"video-scanner\"\n          />\n          \n          {/* Initial State - Show Start Button */}\n          {!isScanning && !error && (\n            <div className={`absolute inset-0 flex items-center justify-center ${\n              isMenuMode \n                ? 'bg-gradient-to-br from-purple-600/90 via-pink-600/90 to-red-600/90' \n                : 'bg-gradient-to-br from-blue-600/90 to-purple-600/90'\n            }`}>\n              <div className=\"text-center max-w-sm mx-4\">\n                <div className=\"w-24 h-24 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-6\">\n                  {isMenuMode ? (\n                    <span className=\"text-5xl\">ðŸ½ï¸</span>\n                  ) : (\n                    <svg className=\"w-12 h-12 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z\" />\n                    </svg>\n                  )}\n                </div>\n                <h3 className=\"text-white text-2xl font-bold mb-2\">\n                  {isMenuMode ? 'Ready to Scan Menu' : 'Ready to Scan'}\n                </h3>\n                <p className=\"text-white/80 text-sm mb-8\">\n                  {isMenuMode \n                    ? 'Scan restaurant QR codes to get meal recommendations' \n                    : 'Tap the button below to start scanning barcodes'}\n                </p>\n                <div className=\"space-y-3\">\n                  <Button \n                    onClick={startScanning}\n                    size=\"lg\"\n                    className={`w-full text-lg font-bold py-6 ${\n                      isMenuMode \n                        ? 'bg-white text-purple-600 hover:bg-purple-50' \n                        : 'bg-white text-blue-600 hover:bg-blue-50'\n                    }`}\n                    data-testid=\"button-start-scan\"\n                  >\n                    ðŸ“· Start Scan\n                  </Button>\n                  <Button \n                    variant=\"outline\"\n                    onClick={() => {\n                      handleClose();\n                      if (isMenuMode) {\n                        // Navigate to menu analysis page for manual menu text entry\n                        setTimeout(() => {\n                          setLocation('/menu-analysis');\n                        }, 100);\n                      } else {\n                        // Open barcode manual entry dialog\n                        setTimeout(() => {\n                          const event = new CustomEvent('open-manual-barcode', { detail: { manual: true } });\n                          window.dispatchEvent(event);\n                        }, 100);\n                      }\n                    }}\n                    className=\"border-white/40 bg-white/10 hover:bg-white/20 text-white w-full\"\n                    data-testid=\"button-manual-entry-initial\"\n                  >\n                    âŒ¨ï¸ Enter Manually Instead\n                  </Button>\n                </div>\n              </div>\n            </div>\n          )}\n          \n          {/* Scan Guide Overlay - Only show when scanning */}\n          {scannerReady && (\n            <div className=\"absolute inset-0 flex items-center justify-center pointer-events-none\">\n              <div className=\"relative\">\n                {/* Scan Frame - Larger for QR codes */}\n                <div className={`border-2 border-white rounded-lg border-dashed opacity-80 ${\n                  isMenuMode ? 'w-64 h-64' : 'w-64 h-32'\n                }`}></div>\n                \n                {/* Corner markers */}\n                <div className={`absolute -top-1 -left-1 w-6 h-6 border-l-4 border-t-4 rounded-tl ${\n                  isMenuMode ? 'border-purple-500' : 'border-blue-500'\n                }`}></div>\n                <div className={`absolute -top-1 -right-1 w-6 h-6 border-r-4 border-t-4 rounded-tr ${\n                  isMenuMode ? 'border-purple-500' : 'border-blue-500'\n                }`}></div>\n                <div className={`absolute -bottom-1 -left-1 w-6 h-6 border-l-4 border-b-4 rounded-bl ${\n                  isMenuMode ? 'border-purple-500' : 'border-blue-500'\n                }`}></div>\n                <div className={`absolute -bottom-1 -right-1 w-6 h-6 border-r-4 border-b-4 rounded-br ${\n                  isMenuMode ? 'border-purple-500' : 'border-blue-500'\n                }`}></div>\n                \n                {/* Status Text */}\n                <div className=\"absolute -bottom-12 left-1/2 transform -translate-x-1/2 text-center\">\n                  <p className=\"text-white text-sm font-medium bg-black/60 px-3 py-1 rounded-full whitespace-nowrap\" data-testid=\"text-scan-status\">\n                    {isMenuMode ? 'Position QR code within frame' : 'Position barcode within frame'}\n                  </p>\n                </div>\n              </div>\n            </div>\n          )}\n          \n          {/* Loading State */}\n          {isScanning && !scannerReady && !error && (\n            <div className=\"absolute inset-0 bg-black/80 flex items-center justify-center\">\n              <div className=\"text-center\">\n                <div className=\"animate-spin rounded-full h-16 w-16 border-b-2 border-white mx-auto mb-4\"></div>\n                <p className=\"text-white text-lg\">Starting camera...</p>\n              </div>\n            </div>\n          )}\n\n          {/* Error State */}\n          {error && (\n            <div className=\"absolute inset-0 bg-black/80 flex items-center justify-center\">\n              <div className=\"text-center max-w-sm mx-4\">\n                <AlertCircle className=\"h-16 w-16 text-red-500 mx-auto mb-4\" />\n                <h3 className=\"text-white text-lg font-semibold mb-2\">Camera Permission Needed</h3>\n                <p className=\"text-white/80 text-sm mb-4\" data-testid=\"text-error-message\">\n                  {error}\n                </p>\n                <div className=\"bg-blue-900/30 border border-blue-600/30 rounded-lg p-4 mb-4\">\n                  <h4 className=\"text-blue-300 font-semibold text-sm mb-2\">ðŸ”§ Troubleshooting Steps:</h4>\n                  <div className=\"text-white/80 text-xs space-y-1 text-left\">\n                    <p>â€¢ <strong>Replit Mobile App:</strong> Try \"Open in Browser\" button</p>\n                    <p>â€¢ <strong>Chrome:</strong> Look for ðŸŽ¥ camera icon in address bar</p>\n                    <p>â€¢ <strong>Safari:</strong> Check Privacy & Security â†’ Camera</p>\n                    <p>â€¢ <strong>Firefox:</strong> Click shield icon â†’ Allow camera</p>\n                  </div>\n                </div>\n                \n                <div className=\"bg-orange-900/30 border border-orange-600/30 rounded-lg p-3 mb-6\">\n                  <h4 className=\"text-orange-300 font-semibold text-xs mb-1\">âš ï¸ Replit App Limitation</h4>\n                  <p className=\"text-white/70 text-xs\">Camera may be blocked in mobile app. Click \"Enter Manually\" below to continue.</p>\n                </div>\n                <div className=\"space-y-3\">\n                  <Button \n                    onClick={startScanning}\n                    className=\"bg-blue-600 hover:bg-blue-700 w-full\"\n                    data-testid=\"button-retry-camera\"\n                  >\n                    ðŸŽ¥ Allow Camera Access\n                  </Button>\n                  <div className=\"flex space-x-2\">\n                    <Button \n                      variant=\"outline\"\n                      onClick={() => setShowDebugger(true)}\n                      className=\"border-white/20 bg-white/10 hover:bg-white/20 text-white flex-1\"\n                    >\n                      ðŸ”§ Debug Issue\n                    </Button>\n                    <Button \n                      variant=\"outline\"\n                      onClick={() => {\n                        handleClose();\n                        if (isMenuMode) {\n                          // Navigate to menu analysis page for manual menu text entry\n                          setTimeout(() => {\n                            setLocation('/menu-analysis');\n                          }, 100);\n                        } else {\n                          // Trigger manual barcode entry\n                          setTimeout(() => {\n                            const event = new CustomEvent('open-manual-barcode', { detail: { manual: true } });\n                            window.dispatchEvent(event);\n                          }, 100);\n                        }\n                      }}\n                      className=\"border-white/20 bg-orange-600 hover:bg-orange-700 text-white flex-1 font-medium\"\n                      data-testid=\"button-enter-manually\"\n                    >\n                      ðŸ“ Enter Manually\n                    </Button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Controls - Only show when actively scanning */}\n        {scannerReady && (\n          <>\n            <div className=\"p-4 bg-black/80 backdrop-blur-sm border-t border-white/10 flex items-center justify-center space-x-6\">\n              {/* Torch Toggle */}\n              {torchSupported && (\n                <Button\n                  variant=\"outline\"\n                  size=\"lg\"\n                  onClick={toggleTorch}\n                  className={`border-white/20 ${torchEnabled ? 'bg-yellow-500 hover:bg-yellow-600' : 'bg-white/10 hover:bg-white/20'}`}\n                  data-testid=\"button-torch-toggle\"\n                >\n                  {torchEnabled ? <Zap className=\"h-5 w-5\" /> : <ZapOff className=\"h-5 w-5\" />}\n                </Button>\n              )}\n\n              {/* Stop Scan Button */}\n              <Button\n                onClick={stopScanning}\n                size=\"lg\"\n                className=\"bg-red-600 hover:bg-red-700 px-8\"\n                data-testid=\"button-stop-scan\"\n              >\n                Stop Scan\n              </Button>\n            </div>\n\n            {/* Instructions */}\n            <div className=\"p-4 bg-black/60 text-center border-t border-white/10\">\n              <p className=\"text-white/70 text-xs\" data-testid=\"text-scan-instructions\">\n                Hold steady and position the barcode within the frame. The scanner will automatically detect and process the code.\n              </p>\n            </div>\n          </>\n        )}\n      </DialogContent>\n      \n      {/* Debug Modal - render outside Dialog to avoid z-index conflicts */}\n      {showDebugger && (\n        <PermissionDebugger onClose={() => setShowDebugger(false)} />\n      )}\n    </Dialog>\n  );\n}","size_bytes":17718},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport { db } from \"./db\";\nimport { eq, and } from \"drizzle-orm\";\nimport { z } from \"zod\";\n// OAUTH DISABLED: import { setupAuth, isAuthenticated } from \"./replitAuth\";\nimport { insertFoodAnalysisSchema, insertDiaryEntrySchema, updateDiaryEntrySchema, insertWaterIntakeSchema, insertDrinkEntrySchema, insertWeightEntrySchema, updateWeightEntrySchema, insertNutritionGoalsSchema, insertUserProfileSchema, updateFoodAnalysisSchema, insertSimpleFoodEntrySchema, insertFoodConfirmationSchema, updateFoodConfirmationSchema, insertReflectionSchema, savedRecipes, insertShoppingListItemSchema, updateShoppingListItemSchema, insertShiftScheduleSchema } from \"@shared/schema\";\nimport multer from \"multer\";\nimport sharp from \"sharp\";\nimport { ObjectStorageService, ObjectNotFoundError } from \"./objectStorage\";\nimport { ObjectPermission } from \"./objectAcl\";\nimport { coachMemoryService } from \"./coach-memory-service\";\nimport { personalityManager } from \"./personality-manager\";\nimport { insertAiCoachMemorySchema, updateAiCoachMemorySchema, aiCoachMemory } from \"@shared/schema\";\nimport { promises as fs } from \"fs\";\nimport path from \"path\";\nimport express from \"express\";\nimport { aiManager } from \"./ai-providers/ai-manager\";\nimport { usdaService } from \"./services/usda-service\";\nimport { imageAnalysisCache } from \"./services/image-analysis-cache\";\nimport { openFoodFactsService } from \"./services/openfoodfacts-service\";\nimport { reflectionService } from \"./services/reflection-service\";\nimport { challengeService } from \"./services/challenge-service\";\nimport { consumeBridgeToken } from \"./bridgeTokens\";\nimport type { Session } from \"express-session\";\nimport { userContextService } from \"./services/user-context-service\";\n\n// Configure multer for image uploads with deployment-aware storage\nconst isDeployment = process.env.REPLIT_DEPLOYMENT === '1' || process.env.REPLIT_DEPLOYMENT === 'true';\nconst uploadDir = process.env.UPLOAD_DIR ?? (isDeployment ? '/tmp/uploads' : 'uploads');\n\nconst upload = multer({ \n  dest: uploadDir,\n  limits: { fileSize: 10 * 1024 * 1024 }, // 10MB limit\n  fileFilter: (req, file, cb) => {\n    if (file.mimetype.startsWith('image/')) {\n      cb(null, true);\n    } else {\n      cb(new Error('Only image files are allowed'));\n    }\n  }\n});\n\n// Separate multer instance for menu photo scanning (uses memory storage for base64 conversion)\nconst uploadMemory = multer({\n  storage: multer.memoryStorage(),\n  limits: { fileSize: 10 * 1024 * 1024 }, // 10MB limit\n  fileFilter: (req, file, cb) => {\n    if (file.mimetype.startsWith('image/')) {\n      cb(null, true);\n    } else {\n      cb(new Error('Only image files are allowed'));\n    }\n  }\n});\n\n// Request queue management for concurrent handling\nclass RequestQueue {\n  private activeRequests = 0;\n  private readonly maxConcurrent = 5; // Limit concurrent AI requests\n  private waitingQueue: Array<() => void> = [];\n\n  async acquire(): Promise<void> {\n    return new Promise((resolve) => {\n      if (this.activeRequests < this.maxConcurrent) {\n        this.activeRequests++;\n        resolve();\n      } else {\n        this.waitingQueue.push(() => {\n          this.activeRequests++;\n          resolve();\n        });\n      }\n    });\n  }\n\n  release(): void {\n    this.activeRequests--;\n    const next = this.waitingQueue.shift();\n    if (next) {\n      next();\n    }\n  }\n\n  getStats() {\n    return {\n      active: this.activeRequests,\n      waiting: this.waitingQueue.length,\n      maxConcurrent: this.maxConcurrent\n    };\n  }\n}\n\nconst analysisQueue = new RequestQueue();\n\n// Utility function to parse portion strings to grams\nfunction parsePortionToGrams(portion: string): number {\n  const portionLower = portion.toLowerCase().trim();\n  \n  // Extract numbers including fractions from the portion string\n  const fractionMatch = portionLower.match(/(\\d+)\\s*\\/\\s*(\\d+)/);\n  const decimalMatch = portionLower.match(/(\\d+(?:\\.\\d+)?)/);\n  \n  let amount = 100; // default\n  \n  if (fractionMatch) {\n    // Handle fractions like \"1/2 cup\", \"2 1/2 tbsp\"\n    const numerator = parseFloat(fractionMatch[1]);\n    const denominator = parseFloat(fractionMatch[2]);\n    const wholeNumberMatch = portionLower.match(/(\\d+)\\s+\\d+\\s*\\/\\s*\\d+/);\n    const wholeNumber = wholeNumberMatch ? parseFloat(wholeNumberMatch[1]) : 0;\n    amount = wholeNumber + (numerator / denominator);\n  } else if (decimalMatch) {\n    amount = parseFloat(decimalMatch[1]);\n  }\n  \n  // Handle different units using word boundaries to avoid false matches\n  if (/\\b(kg|kilograms?)\\b/.test(portionLower)) {\n    return amount * 1000;\n  }\n  if (/\\b(g|grams?)\\b/.test(portionLower)) {\n    return amount;\n  }\n  if (/\\b(oz|ounces?)\\b/.test(portionLower)) {\n    return amount * 28.35; // 1 oz = 28.35g\n  }\n  if (/\\b(lb|lbs|pounds?)\\b/.test(portionLower)) {\n    return amount * 453.592; // 1 lb = 453.592g\n  }\n  if (/\\b(cups?)\\b/.test(portionLower)) {\n    return amount * 240; // 1 cup â‰ˆ 240g (varies by food)\n  }\n  if (/\\b(tbsp|tablespoons?)\\b/.test(portionLower)) {\n    return amount * 15; // 1 tbsp â‰ˆ 15g\n  }\n  if (/\\b(tsp|teaspoons?)\\b/.test(portionLower)) {\n    return amount * 5; // 1 tsp â‰ˆ 5g\n  }\n  if (/\\b(ml|milliliters?)\\b/.test(portionLower)) {\n    return amount; // 1 ml â‰ˆ 1g for most liquids\n  }\n  if (/\\b(l|liters?)\\b/.test(portionLower)) {\n    return amount * 1000; // 1 L = 1000g for most liquids\n  }\n  if (/\\b(slices?)\\b/.test(portionLower)) {\n    return amount * 30; // 1 slice â‰ˆ 30g (bread)\n  }\n  if (/\\b(biscuits?|cookies?)\\b/.test(portionLower)) {\n    return amount * 37.5; // 1 Weetabix biscuit â‰ˆ 37.5g\n  }\n  if (/\\b(pieces?|items?)\\b/.test(portionLower)) {\n    return amount * 50; // 1 piece â‰ˆ 50g average\n  }\n  if (/\\b(servings?)\\b/.test(portionLower)) {\n    return amount * 100; // 1 serving â‰ˆ 100g\n  }\n  \n  // Default: if amount looks reasonable as grams use it, otherwise assume servings\n  if (amount >= 10) {\n    return amount; // Probably already in grams\n  }\n  return amount * 100; // Treat as servings (e.g., \"2\" = 200g)\n}\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  // Ensure upload directory exists\n  try {\n    await fs.mkdir(uploadDir, { recursive: true });\n  } catch (error) {\n    console.error(`Failed to create upload directory ${uploadDir}:`, error);\n  }\n\n  // Serve uploaded images as static files from the correct upload directory\n  app.use('/uploads', express.static(uploadDir));\n  \n  // Email/password authentication middleware\n  const { emailAuthMiddleware } = await import('./auth-middleware');\n  app.use(emailAuthMiddleware);\n\n  // OAUTH DISABLED: User authentication endpoint\n  // app.get('/api/user', async (req: any, res) => {\n  //   if (req.user && req.user.claims) {\n  //     // User is authenticated, return user info\n  //     const user = await storage.getUser(req.user.claims.sub);\n  //     if (user) {\n  //       res.json(user);\n  //     } else {\n  //       res.status(404).json({ error: 'User not found' });\n  //     }\n  //   } else {\n  //     // User not authenticated\n  //     res.status(401).json({ error: 'Not authenticated' });\n  //   }\n  // });\n\n  // Cache and monitoring endpoints (OAUTH DISABLED: removed isAuthenticated)\n  app.get('/api/cache/stats', async (req, res) => {\n    try {\n      const cacheStats = imageAnalysisCache.getStats();\n      const queueStats = analysisQueue.getStats();\n      \n      res.json({\n        cache: cacheStats,\n        queue: queueStats,\n        timestamp: new Date().toISOString()\n      });\n    } catch (error: any) {\n      console.error('Failed to get cache stats:', error);\n      res.status(500).json({ error: 'Failed to get cache statistics' });\n    }\n  });\n\n  app.post('/api/cache/clear', async (req, res) => {\n    try {\n      await imageAnalysisCache.clear();\n      res.json({ message: 'Cache cleared successfully' });\n    } catch (error: any) {\n      console.error('Failed to clear cache:', error);\n      res.status(500).json({ error: 'Failed to clear cache' });\n    }\n  });\n\n  // App token validation mode control endpoint\n  const { setTokenValidationMode, getTokenValidationMode, TokenValidationMode } = await import('./middleware/app-token-middleware');\n  \n  app.get('/api/token-mode', async (req, res) => {\n    const currentMode = getTokenValidationMode();\n    res.json({ mode: currentMode });\n  });\n\n  app.post('/api/token-mode', async (req: any, res) => {\n    const userId = req.user?.claims?.sub;\n    \n    if (!userId) {\n      return res.status(401).json({ error: \"Authentication required\" });\n    }\n\n    const { mode } = req.body;\n    \n    if (!Object.values(TokenValidationMode).includes(mode)) {\n      return res.status(400).json({ error: 'Invalid mode. Must be one of: permissive, blocking, disabled' });\n    }\n\n    setTokenValidationMode(mode);\n    res.json({ mode, message: `Token validation mode changed to ${mode}` });\n  });\n\n  // OAUTH DISABLED: Auth routes\n  // app.get('/api/auth/user',  async (req: any, res) => {\n  //   try {\n  //     const userId = req.user.claims.sub;\n  //     const user = await storage.getUser(userId);\n  //     res.json(user);\n  //   } catch (error) {\n  //     console.error(\"Error fetching user:\", error);\n  //     res.status(500).json({ message: \"Failed to fetch user\" });\n  //   }\n  // });\n\n  // OAUTH DISABLED: Mobile OAuth session bridge endpoint\n  // app.post('/api/session/consume', express.json(), async (req: any, res) => {\n  //   try {\n  //     const { token } = req.body;\n  //     \n  //     if (!token || typeof token !== 'string') {\n  //       console.log('âŒ Invalid bridge token request');\n  //       return res.status(400).json({ error: 'Invalid token' });\n  //     }\n  //     \n  //     console.log('ðŸ”‘ Attempting to consume bridge token...');\n  //     \n  //     // Exchange the bridge token for a session ID\n  //     const sessionId = consumeBridgeToken(token);\n  //     \n  //     if (!sessionId) {\n  //       console.log('âŒ Bridge token not found or expired');\n  //       return res.status(401).json({ error: 'Invalid or expired token' });\n  //     }\n  //     \n  //     console.log('âœ… Bridge token valid for session:', sessionId);\n  //     \n  //     // Load the session data from the session store\n  //     const sessionStore = req.sessionStore;\n  //     \n  //     sessionStore.get(sessionId, (err: any, sessionData: any) => {\n  //       if (err) {\n  //         console.error('âŒ Error loading session:', err);\n  //         return res.status(500).json({ error: 'Failed to load session' });\n  //       }\n  //       \n  //       if (!sessionData) {\n  //         console.log('âŒ Session not found:', sessionId);\n  //         return res.status(401).json({ error: 'Session not found' });\n  //       }\n  //       \n  //       console.log('âœ… Session data loaded, setting up new session...');\n  //       \n  //       // Copy only the authenticated passport data to the current request\n  //       req.session.passport = sessionData.passport;\n  //       \n  //       // Save the new session (don't copy cookie data, let it be generated fresh)\n  //       req.session.save((saveErr: any) => {\n  //         if (saveErr) {\n  //           console.error('âŒ Error saving session:', saveErr);\n  //           return res.status(500).json({ error: 'Failed to save session' });\n  //         }\n  //         \n  //         console.log('ðŸŽ‰ Session successfully bridged to mobile app');\n  //         res.json({ ok: true });\n  //       });\n  //     });\n  //     \n  //   } catch (error: any) {\n  //     console.error('âŒ Session consume error:', error);\n  //     res.status(500).json({ error: 'Internal server error' });\n  //   }\n  // });\n\n  // saveFood endpoint for mobile app compatibility - accepts simple food entries\n  app.post(\"/saveFood\", async (req, res) => {\n    try {\n      const { food, amount, userId } = req.body;\n      \n      // Validate required fields\n      if (!food || !amount || !userId) {\n        return res.status(400).json({\n          status: \"error\",\n          message: \"Missing required fields: food, amount, and userId are all required\"\n        });\n      }\n      \n      // Validate data types\n      if (typeof food !== 'string' || typeof amount !== 'string' || typeof userId !== 'string') {\n        return res.status(400).json({\n          status: \"error\",\n          message: \"Invalid data types: food, amount, and userId must be strings\"\n        });\n      }\n      \n      // Create the entry using validated schema\n      const validatedEntry = insertSimpleFoodEntrySchema.parse({\n        food: food.trim(),\n        amount: amount.trim(),\n        userId: userId.trim()\n      });\n      \n      // Save to database\n      const savedEntry = await storage.createSimpleFoodEntry(validatedEntry);\n      \n      // Return success response in the exact format requested\n      res.json({ status: \"ok\" });\n      \n    } catch (error: any) {\n      console.error(\"/saveFood error:\", error);\n      \n      // Handle validation errors specifically\n      if (error.name === 'ZodError') {\n        return res.status(400).json({\n          status: \"error\",\n          message: `Validation failed: ${error.errors.map((e: any) => e.message).join(', ')}`\n        });\n      }\n      \n      // Handle database errors\n      if (error.code === '23503') { // Foreign key constraint\n        return res.status(400).json({\n          status: \"error\",\n          message: \"Invalid userId: user not found in database\"\n        });\n      }\n      \n      // Generic error response\n      res.status(500).json({\n        status: \"error\",\n        message: \"Failed to save food entry to database\"\n      });\n    }\n  });\n\n  // OAUTH DISABLED: Enable Replit authentication for all routes\n  // const authMiddleware = isAuthenticated;\n  \n  // Allow analyze endpoint without auth for guest mode (results not saved to DB)\n  app.post(\"/api/analyze\", upload.single('image'), async (req: any, res) => {\n    const requestId = `req_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    const requestStartTime = Date.now();\n    \n    try {\n      if (!req.file) {\n        return res.status(400).json({ error: \"No image file provided\" });\n      }\n      \n      // Add cache and queue statistics to response headers for monitoring\n      const cacheStats = imageAnalysisCache.getStats();\n      const queueStats = analysisQueue.getStats();\n      \n      res.setHeader('X-Cache-Stats', JSON.stringify({\n        hitRate: cacheStats.hitRate,\n        size: cacheStats.currentSize,\n        maxSize: cacheStats.maxSize\n      }));\n      \n      res.setHeader('X-Queue-Stats', JSON.stringify(queueStats));\n      res.setHeader('X-Request-ID', requestId);\n\n      // Process image with Sharp for optimization (resilient processing)\n      const processedImagePath = path.join(uploadDir, `processed_${req.file.filename}.jpg`);\n      \n      try {\n        // Light processing since client already compressed\n        // Only auto-rotate and ensure JPEG format\n        await sharp(req.file.path)\n          .rotate() // Auto-rotate based on EXIF data (important for mobile)\n          .jpeg({ quality: 85, mozjpeg: true }) // Higher quality since already compressed\n          .toFile(processedImagePath);\n      } catch (sharpError: any) {\n        // Fallback: copy original file as processed image\n        try {\n          await fs.copyFile(req.file.path, processedImagePath);\n        } catch (copyError) {\n          console.error(\"Image processing failed:\", copyError);\n          \n          // Clean up the original file before returning error\n          try {\n            await fs.unlink(req.file.path);\n          } catch (unlinkError) {\n            console.error(\"Error cleaning up original file:\", unlinkError);\n          }\n          \n          return res.status(415).json({ \n            error: \"Unsupported image format. Please upload a valid JPEG or PNG image.\" \n          });\n        }\n      }\n\n      // Clean up original file after successful processing\n      try {\n        await fs.unlink(req.file.path);\n      } catch (unlinkError) {\n        console.error(\"Error cleaning up original file:\", unlinkError);\n        // Don't fail the request if cleanup fails\n      }\n\n      // Acquire queue slot for concurrent request management\n      await analysisQueue.acquire();\n      \n      // Variables to store response data and status - prevents early returns from bypassing finally\n      let responseData: any = null;\n      let responseStatus = 200;\n      let analysisError: any = null;\n      \n      try {\n        // Real food recognition and nutrition analysis using multi-AI provider system with timeout\n        const analysisStartTime = Date.now();\n        \n        const foodAnalysisData = await Promise.race([\n          aiManager.analyzeFoodImage(processedImagePath),\n          new Promise<never>((_, reject) => \n            setTimeout(() => reject(new Error('Analysis timeout after 60 seconds')), 60000)\n          )\n        ]);\n        \n        const analysisTime = Date.now() - analysisStartTime;\n        \n        // Add analysis timing to response headers\n        res.setHeader('X-Analysis-Time', analysisTime.toString());\n\n        // CONFIDENCE THRESHOLD CHECK: Apply to ALL analysis results (cached and fresh)\n        if (foodAnalysisData.confidence < 90) {\n          // In deployment without auth, skip confirmation and proceed with analysis\n          if (!req.user) {\n            const analysis = await storage.createFoodAnalysis(foodAnalysisData);\n            responseData = analysis;\n          } else {\n            // Create food confirmation for authenticated user review\n            const userId = req.user.claims.sub;\n          const confirmationData = {\n            userId,\n            imageUrl: `/uploads/processed_${req.file.filename}.jpg`, // Use processed image path\n            originalConfidence: foodAnalysisData.confidence,\n            suggestedFoods: foodAnalysisData.detectedFoods,\n            alternativeOptions: [], // Could be populated with USDA alternatives\n            status: 'pending' as const\n          };\n          \n          // Validate confirmation data with schema\n          try {\n            const validatedConfirmation = insertFoodConfirmationSchema.parse(confirmationData);\n            const confirmation = await storage.createFoodConfirmation(validatedConfirmation);\n            \n            responseStatus = 200;\n            responseData = {\n              type: 'confirmation_required',\n              confirmationId: confirmation.id,\n              confidence: foodAnalysisData.confidence,\n              message: 'Analysis requires confirmation due to low confidence',\n              suggestedFoods: foodAnalysisData.detectedFoods,\n              imageUrl: confirmationData.imageUrl\n            };\n          } catch (validationError: any) {\n            if (validationError.name === 'ZodError') {\n              console.error('Image analysis confirmation validation error:', validationError.errors);\n              responseStatus = 400;\n              responseData = {\n                error: 'Invalid confirmation data for image analysis',\n                details: validationError.errors\n              };\n            } else {\n              throw validationError; // Re-throw non-validation errors\n            }\n          }\n          }\n        } else {\n          // High confidence (â‰¥90%) - proceed with immediate analysis\n          // For authenticated users, save to database; for guests, return without saving\n          let analysis;\n          if (req.user) {\n            analysis = await storage.createFoodAnalysis(foodAnalysisData);\n          } else {\n            // Guest mode: return analysis without saving to database\n            analysis = { id: `guest_${Date.now()}`, ...foodAnalysisData };\n          }\n\n          // Optional: Auto-add to diary if user is authenticated and requests it\n          if (req.user && req.body.autoAddToDiary === 'true') {\n            try {\n              const userId = req.user.claims.sub;\n              const diaryData = {\n                userId,\n                analysisId: analysis.id,\n                mealType: req.body.mealType || 'snack',\n                mealDate: req.body.mealDate || new Date().toISOString().split('T')[0],\n                notes: req.body.notes || '',\n                customMealName: req.body.customMealName || null\n              };\n              \n              const validatedDiaryEntry = insertDiaryEntrySchema.parse(diaryData);\n              const diaryEntry = await storage.createDiaryEntry(validatedDiaryEntry);\n              \n              // Return both analysis and diary entry info\n              responseData = {\n                ...analysis,\n                diaryEntry: {\n                  id: diaryEntry.id,\n                  mealType: diaryEntry.mealType,\n                  mealDate: diaryEntry.mealDate\n                }\n              };\n            } catch (diaryError) {\n              console.error(\"Failed to auto-add to diary:\", diaryError);\n              // Still return the analysis even if diary add fails\n              responseData = analysis;\n            }\n          } else {\n            responseData = analysis;\n          }\n        }\n      } catch (error) {\n        analysisError = error;\n      } finally {\n        // Always release queue slot regardless of success or failure\n        analysisQueue.release();\n      }\n      \n      // Handle response after queue is properly released\n      if (analysisError) {\n        throw analysisError;\n      }\n      \n      if (responseData) {\n        return res.status(responseStatus).json(responseData);\n      }\n      \n    } catch (error) {\n      console.error(\"Image analysis error:\", error);\n      res.status(500).json({ error: \"Failed to analyze image\" });\n    }\n  });\n\n  // Test barcode lookup endpoint (for debugging)\n  app.get(\"/api/test-barcode/:barcode\", async (req, res) => {\n    try {\n      const barcode = req.params.barcode;\n      const productData = await openFoodFactsService.lookupByBarcode(barcode);\n      res.json({\n        barcode,\n        success: true,\n        data: productData\n      });\n    } catch (error) {\n      console.error(\"Test barcode error:\", error);\n      res.status(500).json({ \n        barcode: req.params.barcode,\n        success: false,\n        error: error instanceof Error ? error.message : \"Unknown error\" \n      });\n    }\n  });\n\n  // Barcode lookup endpoint - bypass auth in deployment like other food endpoints\n  app.post(\"/api/barcode\", async (req: any, res) => {\n    try {\n      const { barcode } = req.body;\n      \n      if (!barcode || typeof barcode !== 'string') {\n        return res.status(400).json({ error: \"Barcode is required\" });\n      }\n\n      // Look up product using OpenFoodFacts\n      const productData = await openFoodFactsService.lookupByBarcode(barcode);\n      \n      if (productData.nutrition_per_100g === \"not found\") {\n        return res.status(404).json({ \n          error: \"Product not found\",\n          barcode,\n          message: \"This barcode was not found in our food database\"\n        });\n      }\n\n      // Convert to standard food analysis format\n      const nutrition = productData.nutrition_per_100g as any;\n      const analysisData = {\n        imageUrl: productData.imageUrl || '/uploads/barcode-placeholder.jpg',\n        confidence: 95, // High confidence for barcode scans\n        totalCalories: Math.round(nutrition.calories),\n        totalProtein: Math.round(nutrition.protein),\n        totalCarbs: Math.round(nutrition.carbs),\n        totalFat: Math.round(nutrition.fat),\n        detectedFoods: [{\n          name: productData.food,\n          portion: \"100g\",\n          calories: Math.round(nutrition.calories),\n          protein: Math.round(nutrition.protein),\n          carbs: Math.round(nutrition.carbs),\n          fat: Math.round(nutrition.fat),\n          icon: \"package\"\n        }]\n      };\n\n      // Create food analysis entry\n      const analysis = await storage.createFoodAnalysis(analysisData);\n      \n      res.json(analysis);\n      \n    } catch (error) {\n      console.error(\"Barcode lookup error:\", error);\n      res.status(500).json({ error: \"Failed to lookup barcode\" });\n    }\n  });\n\n  // Text-based food analysis for voice input - bypass auth in deployment like image analysis\n  app.post(\"/api/analyze-text\", async (req: any, res) => {\n    try {\n      const { foodDescription, clientTimeInfo } = req.body;\n      \n      if (!foodDescription || typeof foodDescription !== 'string') {\n        return res.status(400).json({ error: \"Food description is required\" });\n      }\n\n      console.log('ðŸ• Server received clientTimeInfo:', clientTimeInfo);\n      \n      // Use AI manager to analyze text-based food description (with client time for timezone-aware context)\n      const foodAnalysisData = await aiManager.analyzeFoodText(foodDescription.trim(), clientTimeInfo);\n\n      // CONFIDENCE THRESHOLD CHECK: If confidence < 90%, create confirmation workflow\n      if (foodAnalysisData.confidence < 90) {\n        \n        // In deployment without auth, skip confirmation and proceed with analysis\n        if (!req.user) {\n          const analysis = await storage.createFoodAnalysis(foodAnalysisData);\n          return res.json(analysis);\n        } else {\n          // Create food confirmation for authenticated user review\n          const userId = req.user.claims.sub;\n        const confirmationData = {\n          userId,\n          imageUrl: 'text://analysis', // Placeholder for text-based analysis\n          originalConfidence: foodAnalysisData.confidence,\n          suggestedFoods: foodAnalysisData.detectedFoods,\n          alternativeOptions: [], // Could be populated with USDA alternatives\n          status: 'pending' as const\n        };\n        \n        // Validate confirmation data with schema\n        try {\n          const validatedConfirmation = insertFoodConfirmationSchema.parse(confirmationData);\n          const confirmation = await storage.createFoodConfirmation(validatedConfirmation);\n          \n          return res.status(200).json({\n            type: 'confirmation_required',\n            confirmationId: confirmation.id,\n            confidence: foodAnalysisData.confidence,\n            message: 'Analysis requires confirmation due to low confidence',\n            suggestedFoods: foodAnalysisData.detectedFoods\n          });\n        } catch (validationError: any) {\n          if (validationError.name === 'ZodError') {\n            console.error('Text analysis confirmation validation error:', validationError.errors);\n            return res.status(400).json({\n              error: 'Invalid confirmation data for text analysis',\n              details: validationError.errors\n            });\n          }\n          throw validationError; // Re-throw non-validation errors\n        }\n        }\n      }\n\n      // High confidence (â‰¥90%) - proceed with immediate analysis\n      const analysis = await storage.createFoodAnalysis(foodAnalysisData);\n      \n      console.log(`ðŸ“¤ Returning analysis with ${analysis.detectedFoods.length} foods:`, \n        analysis.detectedFoods.map((f: any) => `${f.name} (${f.calories} cal)`));\n\n      res.json(analysis);\n    } catch (error) {\n      console.error(\"Text analysis error:\", error);\n      res.status(500).json({ error: \"Failed to analyze food description\" });\n    }\n  });\n\n  // Fetch webpage content from URL (for menu QR codes) - with comprehensive SSRF protection\n  app.post(\"/api/fetch-webpage\", async (req: any, res) => {\n    try {\n      const { url } = req.body;\n      \n      if (!url || typeof url !== 'string') {\n        return res.status(400).json({ error: \"URL is required\" });\n      }\n\n      // Validate URL format\n      let urlObj: URL;\n      try {\n        urlObj = new URL(url);\n      } catch {\n        return res.status(400).json({ error: \"Invalid URL format\" });\n      }\n\n      // SSRF Protection: Only allow HTTP/HTTPS\n      if (urlObj.protocol !== 'http:' && urlObj.protocol !== 'https:') {\n        return res.status(400).json({ error: \"Only HTTP and HTTPS URLs are allowed\" });\n      }\n\n      // Helper function to check if an IP is private/internal\n      const isPrivateIP = (ip: string): boolean => {\n        // IPv4 private/internal ranges\n        const ipv4Patterns = [\n          /^127\\./,                    // Loopback\n          /^0\\./,                      // Current network\n          /^10\\./,                     // Private class A\n          /^172\\.(1[6-9]|2[0-9]|3[0-1])\\./,  // Private class B\n          /^192\\.168\\./,               // Private class C\n          /^169\\.254\\./,               // Link-local\n          /^224\\./,                    // Multicast\n          /^255\\.255\\.255\\.255$/,      // Broadcast\n        ];\n        \n        // IPv6 private/internal patterns\n        const ipv6Patterns = [\n          /^::1$/,                     // Loopback\n          /^fe80:/i,                   // Link-local\n          /^fc00:/i,                   // Unique local\n          /^fd00:/i,                   // Unique local\n        ];\n        \n        if (ipv4Patterns.some(pattern => pattern.test(ip))) return true;\n        if (ipv6Patterns.some(pattern => pattern.test(ip.toLowerCase()))) return true;\n        \n        return false;\n      };\n\n      // SSRF Protection: Block hostname-based checks\n      const hostname = urlObj.hostname.toLowerCase();\n      \n      // Block obvious local hostnames\n      if (hostname === 'localhost' || hostname.includes('metadata')) {\n        return res.status(400).json({ error: \"Access to internal/private networks is not allowed\" });\n      }\n      \n      // Block if hostname is an IP and it's private\n      if (isPrivateIP(hostname)) {\n        return res.status(400).json({ error: \"Access to internal/private networks is not allowed\" });\n      }\n\n      // SECURITY: Only fetch from allowlisted domains (common menu hosting platforms)\n      // This provides automatic value while limiting SSRF attack surface\n      const allowedDomains = [\n        'squarespace.com',\n        'wix.com',\n        'weebly.com',\n        'wordpress.com',\n        'shopify.com',\n        'godaddy.com',\n        'webflow.io',\n        'site123.com',\n        'jimdo.com',\n        'yola.com',\n        'menupages.com',\n        'allmenus.com',\n        'opentable.com',\n        'yelp.com',\n        'business.google.com' // Google My Business menus only\n      ];\n\n      // SECURITY: Proper domain matching to prevent bypass via lookalike domains\n      // Allow exact match OR subdomain (with preceding dot)\n      // This prevents \"evilsquarespace.com\" from passing the check\n      const isAllowedDomain = allowedDomains.some(domain => \n        hostname === domain || hostname.endsWith('.' + domain)\n      );\n\n      if (!isAllowedDomain) {\n        console.log(`ðŸ”’ Domain not in allowlist: ${hostname}`);\n        return res.status(403).json({ \n          error: \"For security, we can only automatically fetch menus from known restaurant website providers\",\n          suggestion: \"Please visit the URL, copy the menu text, and paste it manually into the app\",\n          detectedUrl: url\n        });\n      }\n\n      console.log(`ðŸ“„ Fetching menu from allowed domain: ${hostname}`);\n\n      try {\n        // Disable redirects to prevent SSRF bypass\n        const response = await fetch(url, {\n          method: 'GET',\n          headers: {\n            'User-Agent': 'PlateMate/1.0 (Menu Scanner Bot)',\n            'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'\n          },\n          redirect: 'manual', // SECURITY: Don't follow redirects\n          signal: AbortSignal.timeout(10000) // 10 second timeout\n        });\n\n        // Reject redirects\n        if (response.status >= 300 && response.status < 400) {\n          throw new Error('Redirects are not supported for security reasons');\n        }\n\n        if (!response.ok) {\n          throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n        }\n\n        const contentType = response.headers.get('content-type') || '';\n        if (!contentType.includes('text/html') && !contentType.includes('text/plain')) {\n          throw new Error('URL does not contain readable menu text');\n        }\n\n        const html = await response.text();\n        \n        // Extract text content from HTML (simple extraction)\n        let textContent = html\n          .replace(/<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi, '')\n          .replace(/<style\\b[^<]*(?:(?!<\\/style>)<[^<]*)*<\\/style>/gi, '')\n          .replace(/<[^>]+>/g, ' ')\n          .replace(/\\s+/g, ' ')\n          .trim();\n\n        console.log(`âœ… Fetched menu content from ${hostname} (${textContent.length} chars)`);\n\n        return res.json({\n          success: true,\n          content: textContent,\n          url\n        });\n      } catch (fetchError: any) {\n        console.error(`âŒ Failed to fetch URL: ${fetchError.message}`);\n        return res.status(400).json({ \n          error: `Failed to fetch menu: ${fetchError.message}`,\n          suggestion: \"Try copying and pasting the menu text manually instead\"\n        });\n      }\n\n    } catch (error) {\n      console.error(\"Webpage fetch error:\", error);\n      res.status(500).json({ error: \"Failed to fetch webpage content\" });\n    }\n  });\n\n  // Extract text from menu photos using AI vision\n  app.post(\"/api/extract-menu-text\", uploadMemory.array('images', 10), async (req: any, res) => {\n    try {\n      const files = req.files as Express.Multer.File[];\n      \n      if (!files || files.length === 0) {\n        return res.status(400).json({ error: \"No images provided\" });\n      }\n\n      console.log(`ðŸ“¸ Extracting text from ${files.length} menu photo(s)`);\n\n      // Process each image and extract text using AI vision\n      const extractedTexts: string[] = [];\n      \n      for (const file of files) {\n        try {\n          console.log(`ðŸ“¸ Processing image: ${file.originalname}, size: ${file.size} bytes, type: ${file.mimetype}`);\n          \n          // Resize large images to reduce data URI size (max 2000px width/height)\n          let imageBuffer = file.buffer;\n          if (file.size > 1024 * 1024) { // If > 1MB, resize\n            console.log(`ðŸ“¸ Resizing large image (${file.size} bytes)...`);\n            imageBuffer = await sharp(file.buffer)\n              .resize(2000, 2000, { fit: 'inside', withoutEnlargement: true })\n              .jpeg({ quality: 85 })\n              .toBuffer();\n            console.log(`ðŸ“¸ Resized to ${imageBuffer.length} bytes`);\n          }\n          \n          // Convert image to base64\n          const base64Image = imageBuffer.toString('base64');\n          const dataUri = `data:image/jpeg;base64,${base64Image}`;\n          \n          console.log(`ðŸ“¸ Converted to data URI, length: ${dataUri.length} chars`);\n\n          // Use AI vision to extract text from the image\n          const prompt = `Extract all visible text from this restaurant menu image. Include:\n- All dish names\n- All descriptions\n- All prices\n- All section headers (appetizers, mains, desserts, etc.)\n\nFormat the output as clean, readable text that preserves the menu structure.`;\n\n          console.log(`ðŸ“¸ Calling AI vision to extract text...`);\n          const extractedText = await aiManager.extractTextFromImage(dataUri, prompt);\n          extractedTexts.push(extractedText);\n          \n          console.log(`âœ… Extracted ${extractedText.length} chars from image ${extractedTexts.length}`);\n        } catch (error: any) {\n          console.error(`âŒ Failed to extract text from image:`, error.message);\n          console.error(`âŒ Full error stack:`, error.stack);\n          // Continue with other images even if one fails\n        }\n      }\n\n      if (extractedTexts.length === 0) {\n        return res.status(500).json({ error: \"Failed to extract text from any images\" });\n      }\n\n      // Combine all extracted text\n      const combinedText = extractedTexts.join('\\n\\n--- Next Page ---\\n\\n');\n\n      res.json({\n        success: true,\n        combinedText,\n        pagesProcessed: extractedTexts.length,\n        totalCharacters: combinedText.length\n      });\n    } catch (error) {\n      console.error(\"Text extraction error:\", error);\n      res.status(500).json({ error: \"Failed to extract text from menu photos\" });\n    }\n  });\n\n  // Analyze menu text and recommend meals based on user goals\n  app.post(\"/api/analyze-menu\", async (req: any, res) => {\n    try {\n      const { menuText, url } = req.body;\n      const userId = req.user?.claims?.sub;\n      \n      if (!menuText || typeof menuText !== 'string') {\n        return res.status(400).json({ error: \"Menu text is required\" });\n      }\n\n      // Get user's nutrition goals if authenticated\n      let nutritionGoals = null;\n      if (userId) {\n        nutritionGoals = await storage.getNutritionGoals(userId);\n      }\n\n      // Use AI to analyze menu and recommend meals\n      const goals = nutritionGoals ? {\n        dailyCalories: nutritionGoals.dailyCalories || 2000,\n        proteinGrams: nutritionGoals.dailyProtein || 150,\n        carbsGrams: nutritionGoals.dailyCarbs || 200,\n        fatGrams: nutritionGoals.dailyFat || 65\n      } : {\n        dailyCalories: 2000,\n        proteinGrams: 150,\n        carbsGrams: 200,\n        fatGrams: 65\n      };\n      \n      const menuAnalysis = await aiManager.analyzeMenu(menuText, goals);\n\n      res.json({\n        url,\n        recommendations: menuAnalysis.recommendations,\n        userGoals: nutritionGoals,\n        success: true\n      });\n    } catch (error) {\n      console.error(\"Menu analysis error:\", error);\n      res.status(500).json({ error: \"Failed to analyze menu\" });\n    }\n  });\n\n  // Update food analysis (for editing detected foods) - PROTECTED\n  app.patch(\"/api/analyses/:id\", async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      // Validate request body using zod schema (excludes client-side totals)\n      const validatedData = updateFoodAnalysisSchema.parse(req.body);\n\n      // Check if analysis exists\n      const existingAnalysis = await storage.getFoodAnalysis(id);\n      if (!existingAnalysis) {\n        return res.status(404).json({ error: \"Food analysis not found\" });\n      }\n\n      // Auto-repair legacy entries only if they have legacy placeholder characteristics\n      const isLegacyEntry = existingAnalysis.totalCalories === 0 && \n                           existingAnalysis.totalProtein === 0 && \n                           existingAnalysis.totalCarbs === 0 && \n                           existingAnalysis.totalFat === 0 &&\n                           existingAnalysis.detectedFoods.some((food: any) => \n                             food.name === \"Rate Limit Reached\" || \n                             food.portion === \"OpenAI API limit exceeded\"\n                           );\n\n      let processedFoods = validatedData.detectedFoods;\n      \n      if (isLegacyEntry) {\n        // Only repair foods from legacy entries that still have placeholder data\n        processedFoods = validatedData.detectedFoods.map((food) => {\n          if (food.name === \"Rate Limit Reached\" || food.portion === \"OpenAI API limit exceeded\") {\n            return {\n              name: \"Mixed Food\",\n              portion: \"1 serving\",\n              calories: 250,\n              protein: 12,\n              carbs: 25,\n              fat: 10,\n              icon: \"apple-alt\"\n            };\n          }\n          return food;\n        });\n      }\n\n      // Check ownership: user must have diary entries referencing this analysis OR be the creator\n      const userDiaryEntries = await storage.getDiaryEntries(userId);\n      const hasOwnership = userDiaryEntries.some(entry => entry.analysisId === id);\n      \n      // For deployment mode, allow editing of recent analyses even if not in diary yet\n      const isDeployment = process.env.REPLIT_DEPLOYMENT === '1' || process.env.REPLIT_DEPLOYMENT === 'true';\n      const isRecentAnalysis = Date.now() - new Date(existingAnalysis.createdAt).getTime() < 24 * 60 * 60 * 1000; // 24 hours\n      \n      if (!hasOwnership && !(isDeployment && isRecentAnalysis)) {\n        return res.status(403).json({ \n          error: \"Access denied. You can only edit food analyses from your own diary entries.\" \n        });\n      }\n\n      // Calculate nutrition totals server-side from processed foods (never trust client)\n      const serverTotals = processedFoods.reduce(\n        (totals, food) => ({\n          calories: totals.calories + food.calories,\n          protein: totals.protein + food.protein,\n          carbs: totals.carbs + food.carbs,\n          fat: totals.fat + food.fat,\n        }),\n        { calories: 0, protein: 0, carbs: 0, fat: 0 }\n      );\n\n      // Update with server-calculated totals\n      const updates = {\n        detectedFoods: processedFoods,\n        totalCalories: serverTotals.calories,\n        totalProtein: serverTotals.protein,\n        totalCarbs: serverTotals.carbs,\n        totalFat: serverTotals.fat\n      };\n\n      const updatedAnalysis = await storage.updateFoodAnalysis(id, updates);\n      \n      if (!updatedAnalysis) {\n        return res.status(500).json({ error: \"Failed to update food analysis\" });\n      }\n\n      res.json(updatedAnalysis);\n    } catch (error: any) {\n      if (error.name === 'ZodError') {\n        console.error(\"Validation error:\", error.errors);\n        return res.status(400).json({ \n          error: \"Invalid request data\", \n          details: error.errors \n        });\n      }\n      console.error(\"Update analysis error:\", error);\n      res.status(500).json({ error: \"Failed to update food analysis\" });\n    }\n  });\n\n  // Get analysis history\n  app.get(\"/api/analyses\", async (req, res) => {\n    try {\n      const analyses = await storage.getAllFoodAnalyses();\n      res.json(analyses);\n    } catch (error) {\n      console.error(\"Get analyses error:\", error);\n      res.status(500).json({ error: \"Failed to retrieve analyses\" });\n    }\n  });\n\n  // Get specific analysis\n  app.get(\"/api/analyses/:id\", async (req, res) => {\n    try {\n      const analysis = await storage.getFoodAnalysis(req.params.id);\n      if (!analysis) {\n        return res.status(404).json({ error: \"Analysis not found\" });\n      }\n      res.json(analysis);\n    } catch (error) {\n      console.error(\"Get analysis error:\", error);\n      res.status(500).json({ error: \"Failed to retrieve analysis\" });\n    }\n  });\n\n  // === FOOD CONFIRMATION API ENDPOINTS (for confidence threshold workflow) ===\n  \n  // Create food confirmation for low confidence analysis (<90%)\n  app.post(\"/api/food-confirmations\",  async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims || !req.user.claims.sub) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      \n      const userId = req.user.claims.sub;\n      const validatedData = insertFoodConfirmationSchema.parse({\n        ...req.body,\n        userId\n      });\n      \n      const confirmation = await storage.createFoodConfirmation(validatedData);\n      res.json(confirmation);\n    } catch (error: any) {\n      if (error.name === 'ZodError') {\n        return res.status(400).json({ \n          error: \"Invalid confirmation data\", \n          details: error.errors \n        });\n      }\n      console.error(\"Create food confirmation error:\", error);\n      res.status(500).json({ error: \"Failed to create food confirmation\" });\n    }\n  });\n\n  // Get pending food confirmations for user\n  app.get(\"/api/food-confirmations\",  async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims || !req.user.claims.sub) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      \n      const userId = req.user.claims.sub;\n      const status = req.query.status as string | undefined;\n      \n      const confirmations = await storage.getFoodConfirmationsByUser(userId, status);\n      res.json(confirmations);\n    } catch (error) {\n      console.error(\"Get food confirmations error:\", error);\n      res.status(500).json({ error: \"Failed to retrieve food confirmations\" });\n    }\n  });\n\n  // Get specific food confirmation\n  app.get(\"/api/food-confirmations/:id\",  async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims || !req.user.claims.sub) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      \n      const userId = req.user.claims.sub;\n      const confirmation = await storage.getFoodConfirmation(req.params.id);\n      \n      if (!confirmation) {\n        return res.status(404).json({ error: \"Food confirmation not found\" });\n      }\n      \n      // Verify ownership\n      if (confirmation.userId !== userId) {\n        return res.status(403).json({ error: \"Access denied\" });\n      }\n      \n      res.json(confirmation);\n    } catch (error) {\n      console.error(\"Get food confirmation error:\", error);\n      res.status(500).json({ error: \"Failed to retrieve food confirmation\" });\n    }\n  });\n\n  // Confirm or reject food analysis (user decision)\n  app.patch(\"/api/food-confirmations/:id\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      const { id } = req.params;\n      \n      // Verify ownership first\n      const existing = await storage.getFoodConfirmation(id);\n      if (!existing) {\n        return res.status(404).json({ error: \"Food confirmation not found\" });\n      }\n      if (existing.userId !== userId) {\n        return res.status(403).json({ error: \"Access denied\" });\n      }\n      \n      const validatedData = updateFoodConfirmationSchema.parse(req.body);\n      const confirmation = await storage.updateFoodConfirmation(id, validatedData);\n      \n      if (!confirmation) {\n        return res.status(500).json({ error: \"Failed to update food confirmation\" });\n      }\n\n      // If confirmed, create a new food analysis with final foods\n      if (validatedData.status === 'confirmed') {\n        const finalTotals = validatedData.finalFoods.reduce(\n          (totals, food) => ({\n            calories: totals.calories + food.calories,\n            protein: totals.protein + food.protein,\n            carbs: totals.carbs + food.carbs,\n            fat: totals.fat + food.fat,\n          }),\n          { calories: 0, protein: 0, carbs: 0, fat: 0 }\n        );\n\n        const finalAnalysis = await storage.createFoodAnalysis({\n          imageUrl: existing.imageUrl,\n          confidence: 95, // Set higher confidence after user confirmation\n          totalCalories: finalTotals.calories,\n          totalProtein: finalTotals.protein,\n          totalCarbs: finalTotals.carbs,\n          totalFat: finalTotals.fat,\n          detectedFoods: validatedData.finalFoods\n        });\n\n        res.json({ confirmation, finalAnalysis });\n      } else {\n        res.json(confirmation);\n      }\n      \n    } catch (error: any) {\n      if (error.name === 'ZodError') {\n        return res.status(400).json({ \n          error: \"Invalid confirmation data\", \n          details: error.errors \n        });\n      }\n      console.error(\"Update food confirmation error:\", error);\n      res.status(500).json({ error: \"Failed to update food confirmation\" });\n    }\n  });\n\n  // Refresh analysis - reanalyze the image with current AI providers\n  app.post(\"/api/analyses/:id/refresh\",  async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims || !req.user.claims.sub) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      \n      const { id } = req.params;\n      const userId = req.user.claims.sub;\n\n      // Check if analysis exists\n      const existingAnalysis = await storage.getFoodAnalysis(id);\n      if (!existingAnalysis) {\n        return res.status(404).json({ error: \"Food analysis not found\" });\n      }\n\n      // Check ownership: user must have diary entries referencing this analysis\n      const userDiaryEntries = await storage.getDiaryEntries(userId);\n      const hasOwnership = userDiaryEntries.some(entry => entry.analysisId === id);\n      \n      if (!hasOwnership) {\n        return res.status(403).json({ \n          error: \"Access denied. You can only refresh food analyses from your own diary entries.\" \n        });\n      }\n\n      // Re-analyze the image using current AI providers\n      let freshAnalysisData;\n      try {\n        // Normalize imageUrl to filesystem path if needed\n        let imagePath = existingAnalysis.imageUrl;\n        if (imagePath.startsWith('/uploads/') || imagePath.startsWith('uploads/')) {\n          imagePath = path.join(process.cwd(), imagePath.replace(/^\\//, ''));\n        }\n        \n        freshAnalysisData = await aiManager.analyzeFoodImage(imagePath);\n      } catch (error) {\n        console.error(\"Fresh analysis failed:\", error);\n        // If AI fails, use improved fallback data\n        freshAnalysisData = {\n          imageUrl: existingAnalysis.imageUrl,\n          confidence: 0,\n          totalCalories: 400,\n          totalProtein: 20,\n          totalCarbs: 40,\n          totalFat: 15,\n          detectedFoods: [\n            {\n              name: \"Mixed Food\",\n              portion: \"1 serving\",\n              calories: 250,\n              protein: 12,\n              carbs: 25,\n              fat: 10,\n              icon: \"apple-alt\"\n            },\n            {\n              name: \"Estimated Portion\",\n              portion: \"Medium size\", \n              calories: 150,\n              protein: 8,\n              carbs: 15,\n              fat: 5,\n              icon: \"apple-alt\"\n            }\n          ],\n          isAITemporarilyUnavailable: true\n        };\n      }\n\n      // Update the existing analysis with fresh data\n      const updates = {\n        detectedFoods: freshAnalysisData.detectedFoods,\n        totalCalories: freshAnalysisData.totalCalories,\n        totalProtein: freshAnalysisData.totalProtein,\n        totalCarbs: freshAnalysisData.totalCarbs,\n        totalFat: freshAnalysisData.totalFat,\n        confidence: freshAnalysisData.confidence\n      };\n\n      const updatedAnalysis = await storage.updateFoodAnalysis(id, updates);\n      \n      if (!updatedAnalysis) {\n        return res.status(500).json({ error: \"Failed to refresh food analysis\" });\n      }\n\n      res.json(updatedAnalysis);\n    } catch (error: any) {\n      console.error(\"Refresh analysis error:\", error);\n      res.status(500).json({ error: \"Failed to refresh food analysis\" });\n    }\n  });\n\n  // Diary routes - require authentication\n  app.post(\"/api/diary\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      let analysisId = req.body.analysisId;\n      \n      // If modifiedAnalysis is provided, create a new analysis with the edited foods\n      if (req.body.modifiedAnalysis) {\n        const modifiedAnalysis = await storage.createFoodAnalysis({\n          imageUrl: req.body.modifiedAnalysis.imageUrl,\n          confidence: req.body.modifiedAnalysis.confidence,\n          totalCalories: req.body.modifiedAnalysis.totalCalories,\n          totalProtein: req.body.modifiedAnalysis.totalProtein,\n          totalCarbs: req.body.modifiedAnalysis.totalCarbs,\n          totalFat: req.body.modifiedAnalysis.totalFat,\n          detectedFoods: req.body.modifiedAnalysis.detectedFoods\n        });\n        analysisId = modifiedAnalysis.id;\n      }\n      \n      const validatedEntry = insertDiaryEntrySchema.parse({\n        ...req.body,\n        analysisId,\n        userId\n      });\n      const diaryEntry = await storage.createDiaryEntry(validatedEntry);\n      \n      // Track meal logged challenges\n      try {\n        const completedChallenges = await challengeService.trackMealLogged(userId);\n        \n        // Also check streak challenges\n        const currentStreak = await challengeService.calculateCurrentStreak(userId);\n        const streakChallenges = await challengeService.checkStreakChallenge(userId, currentStreak);\n        \n        const allCompleted = [...completedChallenges, ...streakChallenges];\n        \n        // Return diary entry with completed challenges info\n        res.json({ \n          ...diaryEntry, \n          completedChallenges: allCompleted.length > 0 ? allCompleted : undefined \n        });\n      } catch (challengeError) {\n        console.error(\"Challenge tracking error:\", challengeError);\n        // Don't fail the diary entry creation if challenge tracking fails\n        res.json(diaryEntry);\n      }\n    } catch (error) {\n      console.error(\"Create diary entry error:\", error);\n      res.status(400).json({ error: \"Invalid diary entry data\" });\n    }\n  });\n\n  app.get(\"/api/diary\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      const limit = req.query.limit ? parseInt(req.query.limit as string) : 50;\n      // Disable caching for diary entries to ensure fresh data\n      res.set('Cache-Control', 'no-cache, no-store, must-revalidate');\n      res.set('Pragma', 'no-cache');\n      res.set('Expires', '0');\n      const entries = await storage.getDiaryEntries(userId, limit);\n      res.json(entries);\n    } catch (error) {\n      console.error(\"Get diary entries error:\", error);\n      res.status(500).json({ error: \"Failed to retrieve diary entries\" });\n    }\n  });\n\n  app.get(\"/api/diary/:id\", async (req: any, res) => {\n    try {\n      const entry = await storage.getDiaryEntry(req.params.id);\n      if (!entry) {\n        return res.status(404).json({ error: \"Diary entry not found\" });\n      }\n      \n      // Verify the entry belongs to the authenticated user\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      \n      if (entry.userId !== userId) {\n        return res.status(403).json({ error: \"Access denied\" });\n      }\n      \n      res.json(entry);\n    } catch (error) {\n      console.error(\"Get diary entry error:\", error);\n      res.status(500).json({ error: \"Failed to retrieve diary entry\" });\n    }\n  });\n\n  app.patch(\"/api/diary/:id\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      const entry = await storage.getDiaryEntry(req.params.id);\n      \n      if (!entry) {\n        return res.status(404).json({ error: \"Diary entry not found\" });\n      }\n      \n      // Verify the entry belongs to the authenticated user\n      if (entry.userId !== userId) {\n        return res.status(403).json({ error: \"Access denied\" });\n      }\n      \n      // Extract special fields for analysis swapping (not in schema)\n      const { analysisId, deleteOldAnalysisId, ...updateFields } = req.body;\n      \n      // If new analysis provided, swap it in\n      if (analysisId) {\n        updateFields.analysisId = analysisId;\n        // Note: Old analysis will remain in database but won't be linked to any diary entry\n      }\n      \n      const validatedUpdate = updateDiaryEntrySchema.parse(updateFields);\n      const updatedEntry = await storage.updateDiaryEntry(req.params.id, validatedUpdate);\n      \n      if (!updatedEntry) {\n        return res.status(404).json({ error: \"Diary entry not found\" });\n      }\n      \n      res.json(updatedEntry);\n    } catch (error) {\n      console.error(\"Update diary entry error:\", error);\n      res.status(400).json({ error: \"Invalid diary entry data\" });\n    }\n  });\n\n  app.delete(\"/api/diary/:id\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      const entry = await storage.getDiaryEntry(req.params.id);\n      \n      if (!entry) {\n        return res.status(404).json({ error: \"Diary entry not found\" });\n      }\n      \n      // Verify the entry belongs to the user\n      if (entry.userId !== userId) {\n        return res.status(403).json({ error: \"Access denied\" });\n      }\n      \n      const deleted = await storage.deleteDiaryEntry(req.params.id);\n      if (!deleted) {\n        return res.status(404).json({ error: \"Diary entry not found\" });\n      }\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Delete diary entry error:\", error);\n      res.status(500).json({ error: \"Failed to delete diary entry\" });\n    }\n  });\n\n  // === NUTRITION CALCULATION API ENDPOINTS ===\n  \n  app.post(\"/api/calculate-nutrition\", async (req: any, res) => {\n    try {\n      const { foods } = req.body;\n      \n      if (!foods || !Array.isArray(foods)) {\n        return res.status(400).json({ error: \"Foods array is required\" });\n      }\n\n      const calculatedFoods = [];\n\n      for (const food of foods) {\n        try {\n          // Find best match in USDA database\n          const match = await usdaService.findBestMatch(food.name);\n          \n          if (match) {\n            // Parse portion to extract grams for accurate calculation\n            const portionGrams = parsePortionToGrams(food.portion);\n            \n            // Scale the pre-calculated nutrition values (which are for 100g) to the requested portion\n            const scaleFactor = portionGrams / 100;\n            \n            const scaledNutrition = {\n              calories: Math.round(match.nutrition.calories * scaleFactor),\n              protein: Math.round(match.nutrition.protein * scaleFactor * 10) / 10,\n              carbs: Math.round(match.nutrition.carbs * scaleFactor * 10) / 10,\n              fat: Math.round(match.nutrition.fat * scaleFactor * 10) / 10\n            };\n            \n            calculatedFoods.push({\n              ...food,\n              ...scaledNutrition\n            });\n          } else {\n            // Fallback to original values if no match found\n            console.warn(`No USDA match found for: ${food.name}`);\n            calculatedFoods.push(food);\n          }\n        } catch (error) {\n          console.error(`Error calculating nutrition for ${food.name}:`, error);\n          // Keep original food data if calculation fails\n          calculatedFoods.push(food);\n        }\n      }\n\n      res.json({ foods: calculatedFoods });\n    } catch (error) {\n      console.error(\"Nutrition calculation error:\", error);\n      res.status(500).json({ error: \"Failed to calculate nutrition\" });\n    }\n  });\n\n  // Diet advice routes (protected)\n  app.get(\"/api/diet-advice\",  async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims || !req.user.claims.sub) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      \n      const userId = req.user.claims.sub;\n      const entries = await storage.getDiaryEntries(userId, 30); // Get last 30 entries for this user\n      if (!entries || entries.length === 0) {\n        return res.json({\n          personalizedAdvice: [],\n          nutritionGoals: [],\n          improvements: [],\n          generalTips: []\n        });\n      }\n\n      // Get user profile for enhanced personalization\n      const userProfile = await storage.getUserProfile(userId);\n      \n      // Analyze the data and provide advice using multi-AI provider system\n      const advice = await aiManager.generateDietAdvice(entries, userProfile);\n      res.json(advice);\n    } catch (error) {\n      console.error(\"Get diet advice error:\", error);\n      res.status(500).json({ error: \"Failed to retrieve diet advice\" });\n    }\n  });\n\n  app.post(\"/api/diet-advice/generate\",  async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims || !req.user.claims.sub) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      \n      const userId = req.user.claims.sub;\n      const entries = await storage.getDiaryEntries(userId, 30);\n      if (!entries || entries.length === 0) {\n        return res.json({\n          personalizedAdvice: [\"Start tracking your meals to get personalized advice!\"],\n          nutritionGoals: [\"Add meals to your diary to set nutrition goals\"],\n          improvements: [],\n          generalTips: []\n        });\n      }\n\n      // Get user profile for enhanced personalization\n      const userProfile = await storage.getUserProfile(userId);\n      \n      const advice = await aiManager.generateDietAdvice(entries, userProfile);\n      res.json(advice);\n    } catch (error) {\n      console.error(\"Generate diet advice error:\", error);\n      res.status(500).json({ error: \"Failed to generate diet advice\" });\n    }\n  });\n\n  // Custom AI question endpoint\n  app.post(\"/api/ai/ask\",  async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims || !req.user.claims.sub) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      \n      const userId = req.user.claims.sub;\n      const { question } = req.body;\n      \n      if (!question || typeof question !== 'string' || question.trim().length === 0) {\n        return res.status(400).json({ error: \"Question is required\" });\n      }\n\n      // Get user's recent diary entries for context\n      const entries = await storage.getDiaryEntries(userId, 14); // Last 2 weeks for context\n      \n      // Generate personalized response based on user's nutrition data\n      const response = await aiManager.answerNutritionQuestion(question, entries);\n      \n      res.json({ \n        question: question.trim(),\n        answer: response,\n        timestamp: new Date().toISOString()\n      });\n    } catch (error) {\n      console.error(\"AI question error:\", error);\n      res.status(500).json({ error: \"Failed to get AI response\" });\n    }\n  });\n\n  // AI Coach conversational endpoint with conversation history\n  app.post(\"/api/ai-coach\",  async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims || !req.user.claims.sub) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      \n      const userId = req.user.claims.sub;\n      const { prompt, conversationHistory, personality: selectedPersonality, clientTimeInfo } = req.body;\n      \n      console.log('ðŸ•ðŸ•ðŸ• AI COACH - Received time info:', clientTimeInfo);\n      \n      if (!prompt || typeof prompt !== 'string' || prompt.trim().length === 0) {\n        return res.status(400).json({ error: \"Prompt is required\" });\n      }\n\n      // Gather comprehensive user context for personalized coaching\n      const userContext = await userContextService.getUserContext(userId);\n      \n      // Get AI coach memory for personalized coaching\n      const coachMemory = await coachMemoryService.getOrCreateMemory(userId);\n      \n      // Use personality from request if provided, otherwise fall back to stored preference\n      const personalityType = selectedPersonality || coachMemory.selectedPersonality || 'gym_bro';\n      const personality = personalityManager.getPersonality(personalityType);\n      \n      // Update coach memory with the selected personality for persistence\n      if (selectedPersonality && selectedPersonality !== coachMemory.selectedPersonality) {\n        await coachMemoryService.updateMemory(userId, { selectedPersonality });\n      }\n      \n      // Build full context including conversation history for continuity\n      let contextualPrompt = prompt.trim();\n      if (conversationHistory && Array.isArray(conversationHistory) && conversationHistory.length > 0) {\n        // Include recent conversation turns for context (last 5 exchanges to keep prompt manageable)\n        const recentHistory = conversationHistory.slice(-10); // Last 10 messages (5 exchanges)\n        const historyText = recentHistory\n          .map(msg => `${msg.role === 'user' ? 'User' : 'Assistant'}: ${msg.content}`)\n          .join('\\n');\n        contextualPrompt = `Previous conversation:\\n${historyText}\\n\\nCurrent question: ${prompt.trim()}`;\n      }\n      \n      // Generate conversational response with full user context, coach memory, personality, and time awareness\n      const response = await aiManager.answerNutritionQuestionWithContext(\n        contextualPrompt, \n        userContext,\n        coachMemory, \n        personality,\n        clientTimeInfo\n      );\n      \n      res.json({ \n        response,\n        timestamp: new Date().toISOString()\n      });\n    } catch (error) {\n      console.error(\"AI Coach error:\", error);\n      res.status(500).json({ error: \"Failed to get AI Coach response\" });\n    }\n  });\n\n  // Coach Memory endpoints - require authentication\n  app.get(\"/api/coach-memory\",  async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims || !req.user.claims.sub) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      \n      const userId = req.user.claims.sub;\n      \n      // Get or create memory for the user (auto-creates default if doesn't exist)\n      const memory = await coachMemoryService.getOrCreateMemory(userId);\n      \n      res.json(memory);\n    } catch (error) {\n      console.error(\"Get coach memory error:\", error);\n      res.status(500).json({ error: \"Failed to retrieve coach memory\" });\n    }\n  });\n\n  app.patch(\"/api/coach-memory\",  async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims || !req.user.claims.sub) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      \n      const userId = req.user.claims.sub;\n      \n      // Validate the update data\n      const updateData = updateAiCoachMemorySchema.parse(req.body);\n      \n      // Ensure memory exists before updating\n      await coachMemoryService.getOrCreateMemory(userId);\n      \n      // Update memory\n      const updated = await coachMemoryService.updateMemory(userId, updateData);\n      \n      res.json(updated);\n    } catch (error) {\n      console.error(\"Update coach memory error:\", error);\n      res.status(500).json({ error: \"Failed to update coach memory\" });\n    }\n  });\n\n  // Personalities endpoint - returns available personality configurations\n  app.get(\"/api/coach-personalities\",  async (req: any, res) => {\n    try {\n      const personalities = personalityManager.getAllPersonalities();\n      res.json(personalities);\n    } catch (error) {\n      console.error(\"Get personalities error:\", error);\n      res.status(500).json({ error: \"Failed to retrieve personalities\" });\n    }\n  });\n\n  // Water intake routes - require authentication\n  app.post(\"/api/water\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      \n      const validatedEntry = insertWaterIntakeSchema.parse({\n        ...req.body,\n        userId,\n        drinkType: req.body.drinkType || \"water\",\n        drinkName: req.body.drinkName || \"Water\"\n      });\n      \n      const waterEntry = await storage.createWaterIntake(validatedEntry);\n      res.json(waterEntry);\n    } catch (error) {\n      console.error(\"Create water intake error:\", error);\n      res.status(400).json({ error: \"Invalid water intake data\" });\n    }\n  });\n\n  app.get(\"/api/water/:date\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      \n      const date = req.params.date; // YYYY-MM-DD format\n      const entries = await storage.getWaterIntakeByDate(userId, date);\n      res.json(entries);\n    } catch (error) {\n      console.error(\"Get water intake error:\", error);\n      res.status(500).json({ error: \"Failed to retrieve water intake\" });\n    }\n  });\n\n  app.delete(\"/api/water/:id\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      \n      const deleted = await storage.deleteWaterIntake(req.params.id, userId);\n      if (!deleted) {\n        return res.status(404).json({ error: \"Water entry not found\" });\n      }\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Delete water intake error:\", error);\n      res.status(500).json({ error: \"Failed to delete water intake\" });\n    }\n  });\n\n  // Drink routes - require authentication\n  app.post(\"/api/drinks\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      const validatedEntry = insertDrinkEntrySchema.parse({\n        ...req.body,\n        userId\n      });\n      const drinkEntry = await storage.createDrinkEntry(validatedEntry);\n      \n      // Also create a water intake entry for this drink (all drinks count as fluid intake)\n      try {\n        const loggedAt = drinkEntry.loggedAt || new Date();\n        const loggedDate = loggedAt instanceof Date \n          ? loggedAt.toISOString().split('T')[0] \n          : new Date(loggedAt).toISOString().split('T')[0];\n        \n        console.log(`ðŸ’§ Creating water intake: ${drinkEntry.amount}ml for user ${userId} on ${loggedDate}`);\n        \n        // Normalize drink type to supported values\n        const supportedTypes = [\"water\", \"coffee\", \"tea\", \"wine\", \"beer\"];\n        const normalizedDrinkType = supportedTypes.includes(drinkEntry.drinkType) \n          ? drinkEntry.drinkType as \"water\" | \"coffee\" | \"tea\" | \"wine\" | \"beer\" | \"custom\"\n          : \"custom\";\n        \n        const waterIntake = await storage.createWaterIntake({\n          userId,\n          amountMl: drinkEntry.amount,\n          drinkType: normalizedDrinkType,\n          drinkName: drinkEntry.drinkName,\n          loggedAt: loggedAt instanceof Date ? loggedAt.toISOString() : loggedAt,\n          loggedDate\n        });\n        \n        console.log(`âœ… Water intake created:`, waterIntake);\n      } catch (waterError) {\n        console.error(\"âŒ Failed to create water intake entry:\", waterError);\n        // Continue even if water intake creation fails\n      }\n      \n      res.json(drinkEntry);\n    } catch (error) {\n      console.error(\"Create drink entry error:\", error);\n      res.status(400).json({ error: \"Invalid drink entry data\" });\n    }\n  });\n\n  app.get(\"/api/drinks\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      const limit = req.query.limit ? parseInt(req.query.limit as string) : 50;\n      // Disable caching for drink entries to ensure fresh data\n      res.set('Cache-Control', 'no-cache, no-store, must-revalidate');\n      res.set('Pragma', 'no-cache');\n      res.set('Expires', '0');\n      const entries = await storage.getDrinkEntries(userId, limit);\n      res.json(entries);\n    } catch (error) {\n      console.error(\"Get drink entries error:\", error);\n      res.status(500).json({ error: \"Failed to retrieve drink entries\" });\n    }\n  });\n\n  app.get(\"/api/drinks/:id\", async (req: any, res) => {\n    try {\n      const entry = await storage.getDrinkEntry(req.params.id);\n      if (!entry) {\n        return res.status(404).json({ error: \"Drink entry not found\" });\n      }\n      \n      // Verify the entry belongs to the authenticated user\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      \n      if (entry.userId !== userId) {\n        return res.status(403).json({ error: \"Access denied\" });\n      }\n      \n      res.json(entry);\n    } catch (error) {\n      console.error(\"Get drink entry error:\", error);\n      res.status(500).json({ error: \"Failed to retrieve drink entry\" });\n    }\n  });\n\n  app.delete(\"/api/drinks/:id\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      const entry = await storage.getDrinkEntry(req.params.id);\n      \n      if (!entry) {\n        return res.status(404).json({ error: \"Drink entry not found\" });\n      }\n      \n      // Verify the entry belongs to the user (skip check for anonymous users in deployment)\n      if (req.user && entry.userId !== userId) {\n        return res.status(403).json({ error: \"Access denied\" });\n      }\n      \n      const deleted = await storage.deleteDrinkEntry(req.params.id);\n      if (!deleted) {\n        return res.status(404).json({ error: \"Drink entry not found\" });\n      }\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Delete drink entry error:\", error);\n      res.status(500).json({ error: \"Failed to delete drink entry\" });\n    }\n  });\n\n  // Endpoint for serving private objects (progress photos)\n  // Referenced from blueprint: javascript_object_storage\n  app.get(\"/objects/:objectPath(*)\", async (req: any, res) => {\n    const userId = req.user?.claims?.sub;\n    const objectStorageService = new ObjectStorageService();\n    try {\n      const objectFile = await objectStorageService.getObjectEntityFile(\n        req.path,\n      );\n      const canAccess = await objectStorageService.canAccessObjectEntity({\n        objectFile,\n        userId: userId,\n        requestedPermission: ObjectPermission.READ,\n      });\n      if (!canAccess) {\n        return res.sendStatus(401);\n      }\n      objectStorageService.downloadObject(objectFile, res);\n    } catch (error) {\n      console.error(\"Error checking object access:\", error);\n      if (error instanceof ObjectNotFoundError) {\n        return res.sendStatus(404);\n      }\n      return res.sendStatus(500);\n    }\n  });\n\n  // Weight entry routes - using object storage for progress photos\n  app.post(\"/api/weights\", upload.single('progressPhoto'), async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      let imageUrl: string | null = null;\n\n      // Process progress photo if uploaded and save to object storage\n      if (req.file) {\n        try {\n          // Process image: auto-rotate and optimize\n          const processedImageBuffer = await sharp(req.file.path)\n            .rotate() // Auto-rotate based on EXIF data\n            .jpeg({ quality: 85, mozjpeg: true })\n            .toBuffer();\n          \n          // Upload to object storage\n          const objectStorageService = new ObjectStorageService();\n          imageUrl = await objectStorageService.uploadProgressPhoto(processedImageBuffer, userId);\n          \n          console.log(`Progress photo uploaded to object storage: ${imageUrl}`);\n        } catch (sharpError) {\n          console.error(\"Image processing/upload error:\", sharpError);\n          // Continue without image if processing/upload fails\n        }\n\n        // Clean up original file\n        try {\n          await fs.unlink(req.file.path);\n        } catch (unlinkError) {\n          console.error(\"Error cleaning up original file:\", unlinkError);\n        }\n      }\n\n      // Parse weightGrams from string to number (FormData sends everything as strings)\n      const weightData = {\n        ...req.body,\n        weightGrams: parseInt(req.body.weightGrams, 10),\n        userId,\n        imageUrl\n      };\n      \n      const validatedEntry = insertWeightEntrySchema.parse(weightData);\n      const weightEntry = await storage.createWeightEntry(validatedEntry);\n      \n      // Track weight logged challenges\n      try {\n        const completedChallenges = await challengeService.trackWeightLogged(userId);\n        \n        // Return weight entry with completed challenges info\n        res.json({ \n          ...weightEntry, \n          completedChallenges: completedChallenges.length > 0 ? completedChallenges : undefined \n        });\n      } catch (challengeError) {\n        console.error(\"Challenge tracking error:\", challengeError);\n        // Don't fail the weight entry creation if challenge tracking fails\n        res.json(weightEntry);\n      }\n    } catch (error) {\n      console.error(\"Create weight entry error:\", error);\n      res.status(400).json({ error: \"Invalid weight entry data\" });\n    }\n  });\n\n  app.get(\"/api/weights\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      const limit = req.query.limit ? parseInt(req.query.limit as string) : 100;\n      const start = req.query.start ? new Date(req.query.start as string) : undefined;\n      const end = req.query.end ? new Date(req.query.end as string) : undefined;\n      \n      const entries = await storage.getWeightEntries(userId, { start, end, limit });\n      res.json(entries);\n    } catch (error) {\n      console.error(\"Get weight entries error:\", error);\n      res.status(500).json({ error: \"Failed to retrieve weight entries\" });\n    }\n  });\n\n  app.get(\"/api/weights/:id\", async (req: any, res) => {\n    try {\n      const entry = await storage.getWeightEntry(req.params.id);\n      if (!entry) {\n        return res.status(404).json({ error: \"Weight entry not found\" });\n      }\n      \n      // Verify the entry belongs to the authenticated user\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      \n      if (entry.userId !== userId) {\n        return res.status(403).json({ error: \"Access denied\" });\n      }\n      \n      res.json(entry);\n    } catch (error) {\n      console.error(\"Get weight entry error:\", error);\n      res.status(500).json({ error: \"Failed to retrieve weight entry\" });\n    }\n  });\n\n  app.patch(\"/api/weights/:id\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      const entry = await storage.getWeightEntry(req.params.id);\n      \n      if (!entry) {\n        return res.status(404).json({ error: \"Weight entry not found\" });\n      }\n      \n      // Verify the entry belongs to the user\n      if (entry.userId !== userId) {\n        return res.status(403).json({ error: \"Access denied\" });\n      }\n      \n      const validatedUpdate = updateWeightEntrySchema.parse(req.body);\n      const updatedEntry = await storage.updateWeightEntry(req.params.id, validatedUpdate);\n      \n      if (!updatedEntry) {\n        return res.status(404).json({ error: \"Weight entry not found\" });\n      }\n      \n      res.json(updatedEntry);\n    } catch (error) {\n      console.error(\"Update weight entry error:\", error);\n      res.status(400).json({ error: \"Invalid weight entry data\" });\n    }\n  });\n\n  app.delete(\"/api/weights/:id\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      const entry = await storage.getWeightEntry(req.params.id);\n      \n      if (!entry) {\n        return res.status(404).json({ error: \"Weight entry not found\" });\n      }\n      \n      // Verify the entry belongs to the user (skip check for anonymous users in deployment)\n      if (req.user && entry.userId !== userId) {\n        return res.status(403).json({ error: \"Access denied\" });\n      }\n      \n      const deleted = await storage.deleteWeightEntry(req.params.id);\n      if (!deleted) {\n        return res.status(404).json({ error: \"Weight entry not found\" });\n      }\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Delete weight entry error:\", error);\n      res.status(500).json({ error: \"Failed to delete weight entry\" });\n    }\n  });\n\n  // Step entry routes - activity tracking from device health data\n  app.get(\"/api/steps/today\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const todaySteps = await storage.getTodaySteps(userId);\n      res.json(todaySteps || { stepCount: 0 });\n    } catch (error) {\n      console.error(\"Get today's steps error:\", error);\n      res.status(500).json({ error: \"Failed to retrieve today's steps\" });\n    }\n  });\n\n  app.get(\"/api/steps\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const limit = req.query.limit ? parseInt(req.query.limit as string) : 30;\n      const stepEntries = await storage.getStepEntries(userId, { limit });\n      res.json(stepEntries);\n    } catch (error) {\n      console.error(\"Get step entries error:\", error);\n      res.status(500).json({ error: \"Failed to retrieve step entries\" });\n    }\n  });\n\n  app.post(\"/api/steps\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const { stepCount } = req.body;\n      \n      if (typeof stepCount !== 'number' || stepCount < 0) {\n        return res.status(400).json({ error: \"Invalid step count\" });\n      }\n\n      const stepEntry = await storage.updateTodaySteps(userId, stepCount);\n      res.json(stepEntry);\n    } catch (error) {\n      console.error(\"Create/update step entry error:\", error);\n      res.status(400).json({ error: \"Invalid step entry data\" });\n    }\n  });\n\n  // Reflection routes - AI-powered daily/weekly insights\n  app.get(\"/api/reflections\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const period = req.query.period as 'daily' | 'weekly' | undefined;\n      const reflections = await storage.getReflectionsByUser(userId, period);\n      res.json(reflections);\n    } catch (error) {\n      console.error(\"Get reflections error:\", error);\n      res.status(500).json({ error: \"Failed to retrieve reflections\" });\n    }\n  });\n\n  app.get(\"/api/reflections/latest\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const period = (req.query.period as 'daily' | 'weekly') || 'daily';\n      \n      // Get or generate reflection based on period\n      let reflection;\n      if (period === 'weekly') {\n        // For weekly, try to get latest or return null if none exists yet\n        reflection = await storage.getLatestReflection(userId, 'weekly');\n        if (!reflection) {\n          // No weekly reflection exists yet, return message\n          return res.status(404).json({ error: \"No weekly reflection available yet. Generate one first.\" });\n        }\n      } else {\n        // For daily, use the getOrGenerate method\n        reflection = await reflectionService.getOrGenerateDailyReflection(userId);\n      }\n      \n      res.json(reflection);\n    } catch (error) {\n      console.error(\"Get latest reflection error:\", error);\n      res.status(500).json({ error: \"Failed to retrieve latest reflection\" });\n    }\n  });\n\n  app.post(\"/api/reflections/generate\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const period = (req.query.period as 'daily' | 'weekly') || 'daily';\n      \n      // Currently only daily reflections are supported\n      if (period === 'weekly') {\n        return res.status(501).json({ error: \"Weekly reflections coming soon! For now, use daily reflections.\" });\n      }\n\n      const reflection = await reflectionService.generateDailyReflection(userId);\n      res.json(reflection);\n    } catch (error) {\n      console.error(\"Generate reflection error:\", error);\n      res.status(500).json({ error: \"Failed to generate reflection\" });\n    }\n  });\n\n  app.post(\"/api/reflections/refresh\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const period = (req.query.period as 'daily' | 'weekly') || 'daily';\n      \n      // Currently only daily reflections are supported\n      if (period === 'weekly') {\n        return res.status(501).json({ error: \"Weekly reflections coming soon! For now, use daily reflections.\" });\n      }\n\n      // Delete today's reflection if it exists\n      await storage.deleteTodayReflection(userId, period);\n\n      // Generate a fresh reflection with current diary data\n      const reflection = await reflectionService.generateDailyReflection(userId);\n      \n      res.json(reflection);\n    } catch (error) {\n      console.error(\"Refresh reflection error:\", error);\n      res.status(500).json({ error: \"Failed to refresh reflection\" });\n    }\n  });\n\n  app.patch(\"/api/reflections/:id/share\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const reflection = await storage.getReflection(req.params.id);\n      \n      if (!reflection) {\n        return res.status(404).json({ error: \"Reflection not found\" });\n      }\n\n      if (reflection.userId !== userId) {\n        return res.status(403).json({ error: \"Access denied\" });\n      }\n\n      const { shareChannel } = req.body;\n      const updatedReflection = await storage.updateReflectionShared(req.params.id, shareChannel);\n      res.json(updatedReflection);\n    } catch (error) {\n      console.error(\"Share reflection error:\", error);\n      res.status(500).json({ error: \"Failed to share reflection\" });\n    }\n  });\n\n  // Gamification: Challenge routes\n  app.get(\"/api/challenges\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const challengesWithProgress = await challengeService.getUserChallengesWithProgress(userId);\n      res.json(challengesWithProgress);\n    } catch (error) {\n      console.error(\"Get challenges error:\", error);\n      res.status(500).json({ error: \"Failed to retrieve challenges\" });\n    }\n  });\n\n  app.get(\"/api/challenges/completed\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const completedChallenges = await challengeService.getUserCompletedChallenges(userId);\n      res.json(completedChallenges);\n    } catch (error) {\n      console.error(\"Get completed challenges error:\", error);\n      res.status(500).json({ error: \"Failed to retrieve completed challenges\" });\n    }\n  });\n\n  app.get(\"/api/challenges/points\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const points = await challengeService.getUserTotalPoints(userId);\n      res.json({ points });\n    } catch (error) {\n      console.error(\"Get user points error:\", error);\n      res.status(500).json({ error: \"Failed to retrieve user points\" });\n    }\n  });\n\n  app.get(\"/api/challenges/streak\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const streak = await challengeService.calculateCurrentStreak(userId);\n      res.json({ streak });\n    } catch (error) {\n      console.error(\"Get streak error:\", error);\n      res.status(500).json({ error: \"Failed to calculate streak\" });\n    }\n  });\n\n  // Check daily goals and update goal-based challenges\n  app.post(\"/api/challenges/check-goals\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const completedChallenges = [];\n      \n      // Get today's totals (passed from client)\n      const { totalWater, totalCalories, totalProtein, dailyGoals } = req.body;\n      \n      // Check water goal\n      if (totalWater >= dailyGoals.water) {\n        const waterChallenges = await challengeService.checkGoalChallenge(userId, 'water');\n        completedChallenges.push(...waterChallenges);\n      }\n      \n      // Check calorie goal (within 10% range)\n      if (totalCalories >= dailyGoals.calories * 0.9 && totalCalories <= dailyGoals.calories * 1.1) {\n        const calorieChallenges = await challengeService.checkGoalChallenge(userId, 'calorie');\n        completedChallenges.push(...calorieChallenges);\n      }\n      \n      // Check protein goal\n      if (totalProtein >= dailyGoals.protein) {\n        const proteinChallenges = await challengeService.checkGoalChallenge(userId, 'protein');\n        completedChallenges.push(...proteinChallenges);\n      }\n      \n      res.json({ completedChallenges });\n    } catch (error) {\n      console.error(\"Check goals error:\", error);\n      res.status(500).json({ error: \"Failed to check goals\" });\n    }\n  });\n\n  // Nutrition goals routes (protected in dev, open in deployment)\n  app.get(\"/api/nutrition-goals\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      const goals = await storage.getNutritionGoals(userId);\n      res.json(goals);\n    } catch (error) {\n      console.error(\"Get nutrition goals error:\", error);\n      res.status(500).json({ error: \"Failed to retrieve nutrition goals\" });\n    }\n  });\n\n  app.post(\"/api/nutrition-goals\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      const validatedGoals = insertNutritionGoalsSchema.parse({\n        ...req.body,\n        userId\n      });\n      const goals = await storage.upsertNutritionGoals(validatedGoals);\n      res.json(goals);\n    } catch (error) {\n      console.error(\"Set nutrition goals error:\", error);\n      res.status(400).json({ error: \"Invalid nutrition goals data\" });\n    }\n  });\n\n  // User profile routes\n  app.get(\"/api/user-profile\",  async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      \n      const profile = await storage.getUserProfile(userId);\n      res.json(profile);\n    } catch (error) {\n      console.error(\"Get user profile error:\", error);\n      res.status(500).json({ error: \"Failed to fetch user profile\" });\n    }\n  });\n\n  app.post(\"/api/user-profile\",  async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      const validatedProfile = insertUserProfileSchema.parse({\n        ...req.body,\n        userId\n      });\n      const profile = await storage.upsertUserProfile(validatedProfile);\n      res.json(profile);\n    } catch (error) {\n      console.error(\"Set user profile error:\", error);\n      res.status(400).json({ error: \"Invalid user profile data\" });\n    }\n  });\n\n  // Shift Schedule endpoints for weekly meal planning\n  // GET shift schedule for a date range\n  app.get(\"/api/shift-schedule\",  async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const { startDate, endDate } = req.query;\n      \n      if (!startDate || !endDate) {\n        return res.status(400).json({ error: \"startDate and endDate are required\" });\n      }\n\n      const schedules = await storage.getShiftSchedules(userId, startDate as string, endDate as string);\n      res.json(schedules);\n    } catch (error) {\n      console.error(\"Get shift schedule error:\", error);\n      res.status(500).json({ error: \"Failed to fetch shift schedule\" });\n    }\n  });\n\n  // POST create or update shift schedule for a specific date\n  app.post(\"/api/shift-schedule\",  async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const validatedSchedule = insertShiftScheduleSchema.parse({\n        ...req.body,\n        userId\n      });\n\n      const schedule = await storage.upsertShiftSchedule(validatedSchedule);\n      res.json(schedule);\n    } catch (error) {\n      console.error(\"Create shift schedule error:\", error);\n      res.status(400).json({ error: \"Invalid shift schedule data\" });\n    }\n  });\n\n  // DELETE shift schedule by date\n  app.delete(\"/api/shift-schedule/:date\",  async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const { date } = req.params;\n      await storage.deleteShiftSchedule(userId, date);\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Delete shift schedule error:\", error);\n      res.status(500).json({ error: \"Failed to delete shift schedule\" });\n    }\n  });\n\n  // Daily coaching endpoints\n  app.get('/api/coaching/daily',  async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims || !req.user.claims.sub) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      \n      const userId = req.user.claims.sub;\n      \n      // Get user's diary entries for personalized coaching\n      const entries = await storage.getDiaryEntries(userId, 30);\n      \n      // Use AI manager to generate daily coaching\n      const coaching = await aiManager.generateDailyCoaching(entries);\n      \n      res.json(coaching);\n    } catch (error: any) {\n      console.error(\"Error generating daily coaching:\", error);\n      res.status(500).json({ \n        error: \"Failed to generate daily coaching\",\n        details: error.message \n      });\n    }\n  });\n\n  app.post('/api/coaching/generate',  async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims || !req.user.claims.sub) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      \n      const userId = req.user.claims.sub;\n      \n      // Get user's diary entries for personalized coaching\n      const entries = await storage.getDiaryEntries(userId, 30);\n      \n      // Use AI manager to generate fresh daily coaching\n      const coaching = await aiManager.generateDailyCoaching(entries);\n      \n      res.json(coaching);\n    } catch (error: any) {\n      console.error(\"Error generating fresh daily coaching:\", error);\n      res.status(500).json({ \n        error: \"Failed to generate fresh daily coaching\",\n        details: error.message \n      });\n    }\n  });\n\n  app.get('/api/coaching/tips', async (req, res) => {\n    try {\n      const { category = 'all' } = req.query;\n      \n      // Validate category\n      const validCategories = ['all', 'nutrition', 'medication', 'motivation'];\n      if (!validCategories.includes(category as string)) {\n        return res.status(400).json({ \n          error: 'Invalid category. Must be one of: all, nutrition, medication, motivation' \n        });\n      }\n\n      // Use AI manager to generate educational tips\n      const tips = await aiManager.generateEducationalTips(category as any);\n      \n      res.json(tips);\n    } catch (error: any) {\n      console.error(\"Error generating educational tips:\", error);\n      res.status(500).json({ \n        error: \"Failed to generate educational tips\",\n        details: error.message \n      });\n    }\n  });\n\n  // AI Provider monitoring routes\n  app.get(\"/api/ai/status\", async (req, res) => {\n    try {\n      const systemHealth = aiManager.getSystemHealth();\n      res.json(systemHealth);\n    } catch (error) {\n      console.error(\"Get AI status error:\", error);\n      res.status(500).json({ error: \"Failed to retrieve AI status\" });\n    }\n  });\n\n  app.post(\"/api/ai/reset\", async (req, res) => {\n    try {\n      aiManager.resetProviders();\n      res.json({ success: true, message: \"All providers reset successfully\" });\n    } catch (error) {\n      console.error(\"Reset AI providers error:\", error);\n      res.status(500).json({ error: \"Failed to reset providers\" });\n    }\n  });\n\n  // Clear USDA cache to force fresh searches\n  app.post(\"/api/clear-usda-cache\", async (req, res) => {\n    try {\n      usdaService.clearCache();\n      res.json({ success: true, message: \"USDA cache cleared successfully\" });\n    } catch (error) {\n      console.error(\"Clear USDA cache error:\", error);\n      res.status(500).json({ error: \"Failed to clear USDA cache\" });\n    }\n  });\n\n  // Fallback recipes when AI providers are unavailable\n  const fallbackRecipes = [\n    {\n      id: \"fallback-1\",\n      name: \"Grilled Chicken Salad\",\n      description: \"Fresh mixed greens with grilled chicken breast, cherry tomatoes, and olive oil dressing\",\n      calories: 320,\n      protein: 35,\n      carbs: 12,\n      fat: 15,\n      servings: 1,\n      prepTime: 15,\n      cookTime: 10,\n      difficulty: \"Easy\" as const,\n      ingredients: [\"Mixed greens\", \"Chicken breast\", \"Cherry tomatoes\", \"Olive oil\", \"Lemon juice\"],\n      instructions: [\"Grill chicken\", \"Mix greens\", \"Add toppings\", \"Dress salad\"],\n      tags: [\"healthy\", \"protein\"],\n      dietaryInfo: [\"high-protein\", \"gluten-free\"]\n    },\n    {\n      id: \"fallback-2\",\n      name: \"Quinoa Buddha Bowl\",\n      description: \"Nutritious bowl with quinoa, roasted vegetables, and tahini dressing\",\n      calories: 450,\n      protein: 15,\n      carbs: 65,\n      fat: 18,\n      servings: 1,\n      prepTime: 20,\n      cookTime: 25,\n      difficulty: \"Medium\" as const,\n      ingredients: [\"Quinoa\", \"Sweet potato\", \"Broccoli\", \"Chickpeas\", \"Tahini\"],\n      instructions: [\"Cook quinoa\", \"Roast vegetables\", \"Assemble bowl\", \"Add dressing\"],\n      tags: [\"vegan\", \"healthy\"],\n      dietaryInfo: [\"vegan\", \"vegetarian\", \"high-fiber\"]\n    },\n    {\n      id: \"fallback-3\",\n      name: \"Mediterranean Wrap\",\n      description: \"Whole wheat wrap with hummus, vegetables, and feta cheese\",\n      calories: 380,\n      protein: 12,\n      carbs: 45,\n      fat: 16,\n      servings: 1,\n      prepTime: 10,\n      cookTime: 0,\n      difficulty: \"Easy\" as const,\n      ingredients: [\"Whole wheat tortilla\", \"Hummus\", \"Cucumber\", \"Tomatoes\", \"Feta cheese\"],\n      instructions: [\"Spread hummus\", \"Add vegetables\", \"Add cheese\", \"Roll wrap\"],\n      tags: [\"vegetarian\", \"mediterranean\"],\n      dietaryInfo: [\"vegetarian\", \"mediterranean\"]\n    }\n  ];\n\n  // Recipe cache with 24-hour TTL\n  const recipeCache = new Map<string, { recipes: any[], timestamp: number }>();\n  const RECIPE_CACHE_TTL = 24 * 60 * 60 * 1000; // 24 hours\n\n  const getCachedRecipes = (dietaryFilter: string) => {\n    const cacheKey = dietaryFilter || 'all';\n    const cached = recipeCache.get(cacheKey);\n    \n    if (cached && Date.now() - cached.timestamp < RECIPE_CACHE_TTL) {\n      return cached.recipes;\n    }\n    \n    return null;\n  };\n\n  const setCachedRecipes = (dietaryFilter: string, recipes: any[]) => {\n    const cacheKey = dietaryFilter || 'all';\n    recipeCache.set(cacheKey, {\n      recipes,\n      timestamp: Date.now()\n    });\n  };\n\n  // Recipe routes\n  app.get(\"/api/recipes\", async (req: any, res) => {\n    try {\n      const dietaryFilter = req.query.diet as string || \"\";\n      const userId = req.user?.claims?.sub;\n      \n      // Fetch user profile for allergies and preferences\n      let userProfile = null;\n      if (userId) {\n        try {\n          userProfile = await storage.getUserProfile(userId);\n        } catch (profileError) {\n          console.log('Could not fetch user profile for recipes');\n        }\n      }\n      \n      // Check cache first\n      const cachedRecipes = getCachedRecipes(dietaryFilter);\n      if (cachedRecipes) {\n        return res.json(cachedRecipes);\n      }\n      \n      try {\n        const recipes = await aiManager.generateRecipes(dietaryFilter, userProfile);\n        setCachedRecipes(dietaryFilter, recipes);\n        res.json(recipes);\n      } catch (aiError) {\n        console.log('AI providers unavailable, serving fallback recipes');\n        \n        // Filter fallback recipes by diet if specified\n        let filteredRecipes = fallbackRecipes;\n        if (dietaryFilter && dietaryFilter !== 'all') {\n          filteredRecipes = fallbackRecipes.filter(recipe => \n            recipe.dietaryInfo.includes(dietaryFilter)\n          );\n        }\n        \n        // If no recipes match the diet, show all fallback recipes\n        if (filteredRecipes.length === 0) {\n          filteredRecipes = fallbackRecipes;\n        }\n        \n        res.json(filteredRecipes);\n      }\n    } catch (error) {\n      console.error(\"Error fetching recipes:\", error);\n      res.status(500).json({ message: \"Failed to fetch recipes\" });\n    }\n  });\n\n  // Get user's saved recipes (MUST be before dynamic route)\n  app.get(\"/api/recipes/saved\", async (req: any, res) => {\n    console.log(\"ðŸš¨ SAVED RECIPES ENDPOINT HIT - timestamp:\", Date.now());\n    console.log(\"ðŸš¨ req.user:\", JSON.stringify(req.user));\n    console.log(\"ðŸš¨ Authorization header:\", req.headers.authorization);\n    try {\n      const userId = req.user?.claims?.sub;\n      console.log(\"ðŸš¨ User ID:\", userId);\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      \n      // Disable all caching including ETag\n      res.set({\n        'Cache-Control': 'no-store, no-cache, must-revalidate, proxy-revalidate',\n        'Pragma': 'no-cache',\n        'Expires': '0',\n        'ETag': undefined // Explicitly disable ETag to prevent 304 responses\n      });\n      \n      console.log(\"ðŸ” Fetching saved recipes for user:\", userId);\n      const saved = await db.query.savedRecipes.findMany({\n        where: eq(savedRecipes.userId, userId),\n        orderBy: (savedRecipes, { desc }) => [desc(savedRecipes.savedAt)],\n      });\n      \n      console.log(\"ðŸ“¦ Found\", saved.length, \"saved recipes from DB\");\n      if (saved.length > 0) {\n        console.log(\"First recipe recipeId:\", saved[0].recipeId);\n      }\n      \n      // Return the recipe data from each saved recipe\n      const recipes = saved.map((s: any) => ({\n        ...s.recipeData,\n        id: s.recipeId, // Ensure the ID matches for UI consistency\n        isSaved: true,\n      }));\n      \n      console.log(\"âœ… Returning\", recipes.length, \"recipes, first ID:\", recipes[0]?.id);\n      res.json(recipes);\n    } catch (error) {\n      console.error(\"Error fetching saved recipes:\", error);\n      res.status(500).json({ message: \"Failed to fetch saved recipes\" });\n    }\n  });\n\n  // Dynamic recipe route for diet filtering\n  app.get(\"/api/recipes/:diet?/:search?\", async (req: any, res) => {\n    try {\n      const { diet, search } = req.params;\n      const dietaryFilter = diet || \"\";\n      const userId = req.user?.claims?.sub;\n      \n      // Fetch user profile for allergies and preferences\n      let userProfile = null;\n      if (userId) {\n        try {\n          userProfile = await storage.getUserProfile(userId);\n        } catch (profileError) {\n          console.log('Could not fetch user profile for recipes');\n        }\n      }\n      \n      // Check cache first\n      const cachedRecipes = getCachedRecipes(dietaryFilter);\n      if (cachedRecipes) {\n        return res.json(cachedRecipes);\n      }\n      \n      try {\n        const recipes = await aiManager.generateRecipes(dietaryFilter, userProfile);\n        setCachedRecipes(dietaryFilter, recipes);\n        res.json(recipes);\n      } catch (aiError) {\n        console.log('AI providers unavailable, serving fallback recipes');\n        \n        // Filter fallback recipes by diet if specified\n        let filteredRecipes = fallbackRecipes;\n        if (dietaryFilter && dietaryFilter !== 'all') {\n          filteredRecipes = fallbackRecipes.filter(recipe => \n            recipe.dietaryInfo.includes(dietaryFilter)\n          );\n        }\n        \n        // If no recipes match the diet, show all fallback recipes\n        if (filteredRecipes.length === 0) {\n          filteredRecipes = fallbackRecipes;\n        }\n        \n        res.json(filteredRecipes);\n      }\n    } catch (error) {\n      console.error(\"Error fetching dynamic recipes:\", error);\n      res.status(500).json({ message: \"Failed to fetch recipes\" });\n    }\n  });\n\n  // Refresh recipes - clear cache and get new ones\n  app.post(\"/api/recipes/refresh\", async (req: any, res) => {\n    try {\n      const dietaryFilter = req.body.dietaryFilter || \"\";\n      const userId = req.user?.claims?.sub;\n      \n      // Fetch user profile for allergies and preferences\n      let userProfile = null;\n      if (userId) {\n        try {\n          userProfile = await storage.getUserProfile(userId);\n        } catch (profileError) {\n          console.log('Could not fetch user profile for recipes');\n        }\n      }\n      \n      // Clear the cache for this dietary filter\n      const cacheKey = dietaryFilter || 'all';\n      recipeCache.delete(cacheKey);\n      \n      // Generate new recipes\n      try {\n        const recipes = await aiManager.generateRecipes(dietaryFilter, userProfile);\n        setCachedRecipes(dietaryFilter, recipes);\n        res.json(recipes);\n      } catch (aiError) {\n        console.log('AI providers unavailable, serving fallback recipes');\n        const filteredRecipes = fallbackRecipes.filter(recipe => \n          !dietaryFilter || dietaryFilter === 'all' || recipe.dietaryInfo.includes(dietaryFilter)\n        );\n        res.json(filteredRecipes.length > 0 ? filteredRecipes : fallbackRecipes);\n      }\n    } catch (error) {\n      console.error(\"Error refreshing recipes:\", error);\n      res.status(500).json({ message: \"Failed to refresh recipes\" });\n    }\n  });\n\n  // Save a recipe to favorites\n  app.post(\"/api/recipes/save\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      \n      const { recipeId, recipeName, recipeData } = req.body;\n      \n      if (!recipeId || !recipeName || !recipeData) {\n        return res.status(400).json({ message: \"Missing required fields\" });\n      }\n      \n      // Check if already saved\n      const existing = await db.query.savedRecipes.findFirst({\n        where: and(\n          eq(savedRecipes.userId, userId),\n          eq(savedRecipes.recipeId, recipeId)\n        ),\n      });\n      \n      if (existing) {\n        return res.status(400).json({ message: \"Recipe already saved\" });\n      }\n      \n      const [savedRecipe] = await db.insert(savedRecipes).values({\n        userId,\n        recipeId,\n        recipeName,\n        recipeData,\n      }).returning();\n      \n      res.json(savedRecipe);\n    } catch (error) {\n      console.error(\"Error saving recipe:\", error);\n      res.status(500).json({ message: \"Failed to save recipe\" });\n    }\n  });\n\n  // Unsave a recipe\n  app.delete(\"/api/recipes/save/:recipeId\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n      \n      const { recipeId } = req.params;\n      \n      await db.delete(savedRecipes).where(\n        and(\n          eq(savedRecipes.userId, userId),\n          eq(savedRecipes.recipeId, recipeId)\n        )\n      );\n      \n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error unsaving recipe:\", error);\n      res.status(500).json({ message: \"Failed to unsave recipe\" });\n    }\n  });\n\n  // === AI Coach Memory & Personality Endpoints ===\n\n  // Get coach memory for the current user\n  app.get(\"/api/coach-memory\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const memory = await coachMemoryService.getOrCreateMemory(userId);\n      res.json(memory);\n    } catch (error) {\n      console.error(\"Error fetching coach memory:\", error);\n      res.status(500).json({ error: \"Failed to fetch coach memory\" });\n    }\n  });\n\n  // Update coach memory\n  app.patch(\"/api/coach-memory\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const validatedData = updateAiCoachMemorySchema.parse(req.body);\n      const updated = await coachMemoryService.updateMemory(userId, validatedData);\n      \n      res.json(updated);\n    } catch (error) {\n      console.error(\"Error updating coach memory:\", error);\n      res.status(400).json({ error: \"Failed to update coach memory\" });\n    }\n  });\n\n  // Get all available personalities\n  app.get(\"/api/coach-personalities\", async (req: any, res) => {\n    try {\n      const personalities = personalityManager.getAllPersonalities();\n      res.json(personalities);\n    } catch (error) {\n      console.error(\"Error fetching personalities:\", error);\n      res.status(500).json({ error: \"Failed to fetch personalities\" });\n    }\n  });\n\n  // Get user context for AI (memory + profile combined)\n  app.get(\"/api/coach-context\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const context = await coachMemoryService.getUserContext(userId);\n      res.json(context);\n    } catch (error) {\n      console.error(\"Error fetching coach context:\", error);\n      res.status(500).json({ error: \"Failed to fetch coach context\" });\n    }\n  });\n\n  // Add a mood entry\n  app.post(\"/api/coach-memory/mood\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const { mood, sentiment } = req.body;\n      \n      if (!mood || typeof sentiment !== 'number') {\n        return res.status(400).json({ error: \"Mood and sentiment are required\" });\n      }\n\n      await coachMemoryService.addMoodEntry(userId, mood, sentiment);\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error adding mood entry:\", error);\n      res.status(500).json({ error: \"Failed to add mood entry\" });\n    }\n  });\n\n  // Shopping List routes\n  app.get(\"/api/shopping-list\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const items = await storage.getShoppingList(userId);\n      res.json(items);\n    } catch (error) {\n      console.error(\"Error fetching shopping list:\", error);\n      res.status(500).json({ error: \"Failed to fetch shopping list\" });\n    }\n  });\n\n  app.post(\"/api/shopping-list\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const validatedData = insertShoppingListItemSchema.parse({\n        ...req.body,\n        userId,\n      });\n\n      const item = await storage.addShoppingItem(validatedData);\n      res.json(item);\n    } catch (error) {\n      console.error(\"Error adding shopping item:\", error);\n      res.status(400).json({ error: \"Failed to add shopping item\" });\n    }\n  });\n\n  app.patch(\"/api/shopping-list/:id\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const validatedData = updateShoppingListItemSchema.parse(req.body);\n      const updated = await storage.updateShoppingItem(req.params.id, userId, validatedData);\n      if (!updated) {\n        return res.status(404).json({ error: \"Shopping item not found\" });\n      }\n      res.json(updated);\n    } catch (error) {\n      console.error(\"Error updating shopping item:\", error);\n      res.status(400).json({ error: \"Failed to update shopping item\" });\n    }\n  });\n\n  app.delete(\"/api/shopping-list/:id\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const deleted = await storage.deleteShoppingItem(req.params.id, userId);\n      if (!deleted) {\n        return res.status(404).json({ error: \"Shopping item not found\" });\n      }\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting shopping item:\", error);\n      res.status(500).json({ error: \"Failed to delete shopping item\" });\n    }\n  });\n\n  app.delete(\"/api/shopping-list\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      await storage.clearShoppingList(userId);\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error clearing shopping list:\", error);\n      res.status(500).json({ error: \"Failed to clear shopping list\" });\n    }\n  });\n\n  // Shift schedule routes for weekly meal planning\n  app.get(\"/api/shift-schedules\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const { startDate, endDate } = req.query;\n      \n      if (!startDate || !endDate) {\n        return res.status(400).json({ error: \"startDate and endDate are required\" });\n      }\n\n      const schedules = await storage.getShiftSchedules(userId, startDate as string, endDate as string);\n      res.json(schedules);\n    } catch (error) {\n      console.error(\"Error fetching shift schedules:\", error);\n      res.status(500).json({ error: \"Failed to fetch shift schedules\" });\n    }\n  });\n\n  app.post(\"/api/shift-schedules\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const scheduleData = insertShiftScheduleSchema.parse({\n        ...req.body,\n        userId\n      });\n\n      const schedule = await storage.upsertShiftSchedule(scheduleData);\n      res.json(schedule);\n    } catch (error) {\n      console.error(\"Error creating/updating shift schedule:\", error);\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: \"Invalid request data\", details: error.errors });\n      }\n      res.status(500).json({ error: \"Failed to save shift schedule\" });\n    }\n  });\n\n  app.delete(\"/api/shift-schedules/:date\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const { date } = req.params;\n      const success = await storage.deleteShiftSchedule(userId, date);\n      res.json({ success });\n    } catch (error) {\n      console.error(\"Error deleting shift schedule:\", error);\n      res.status(500).json({ error: \"Failed to delete shift schedule\" });\n    }\n  });\n\n  // Generate weekly meal plan based on shift schedules\n  app.post(\"/api/shift-schedules/generate-meal-plan\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const { startDate, endDate } = req.body;\n      \n      if (!startDate || !endDate) {\n        return res.status(400).json({ error: \"startDate and endDate are required\" });\n      }\n\n      // Get shift schedules for the specified date range\n      const shifts = await storage.getShiftSchedules(userId, startDate, endDate);\n      \n      if (shifts.length === 0) {\n        return res.status(400).json({ error: \"No shift schedules found for the specified date range\" });\n      }\n\n      // Get user profile for personalization\n      const userProfile = await storage.getUserProfile(userId);\n\n      // Generate weekly meal plan using AI\n      const { ShiftMealPlanService } = await import(\"./services/shift-meal-plan-service\");\n      const mealPlanService = new ShiftMealPlanService(storage);\n      const mealPlan = await mealPlanService.generateWeeklyMealPlan(userId, shifts, userProfile || undefined);\n\n      console.log(\"ðŸ›’ Meal plan shopping list check:\", {\n        hasShoppingList: !!mealPlan.shoppingList,\n        itemCount: mealPlan.shoppingList?.length || 0,\n        hasWeeklyNutrition: !!mealPlan.weeklyNutrition,\n        hasWeeklyTips: !!mealPlan.weeklyTips\n      });\n\n      // Update each shift schedule with the generated meal plan data\n      // For the first schedule, include weekly data (shoppingList, weeklyNutrition, weeklyTips)\n      for (let i = 0; i < mealPlan.dailyPlans.length; i++) {\n        const dailyPlan = mealPlan.dailyPlans[i];\n        const mealPlanData = i === 0 ? {\n          ...dailyPlan,\n          shoppingList: mealPlan.shoppingList,\n          weeklyNutrition: mealPlan.weeklyNutrition,\n          weeklyTips: mealPlan.weeklyTips\n        } : dailyPlan;\n\n        const existingShift = shifts.find(s => s.shiftDate === dailyPlan.date);\n        await storage.upsertShiftSchedule({\n          userId,\n          shiftDate: dailyPlan.date,\n          shiftType: (existingShift?.shiftType || 'regular') as 'custom' | 'day_off' | 'regular' | 'early_shift' | 'late_shift' | 'night_shift' | 'long_shift',\n          customShiftStart: dailyPlan.shiftStart || null,\n          customShiftEnd: dailyPlan.shiftEnd || null,\n          breakWindows: dailyPlan.breakWindows || null,\n          mealPlanGenerated: 1,\n          mealPlanData: mealPlanData as any\n        });\n      }\n\n      res.json(mealPlan);\n    } catch (error) {\n      console.error(\"Error generating meal plan:\", error);\n      res.status(500).json({ error: \"Failed to generate meal plan\" });\n    }\n  });\n\n  // Add meal plan shopping list to user's shopping list\n  app.post(\"/api/shift-schedules/add-to-shopping-list\", async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"Authentication required\" });\n      }\n\n      const { startDate, endDate } = req.body;\n      \n      if (!startDate || !endDate) {\n        return res.status(400).json({ error: \"startDate and endDate are required\" });\n      }\n\n      // Get shift schedules for the date range to extract meal plan shopping list\n      const shifts = await storage.getShiftSchedules(userId, startDate, endDate);\n      \n      // Find the first shift with meal plan data containing shopping list\n      let shoppingList: Array<{ ingredient: string; quantity: string; category: string }> = [];\n      for (const shift of shifts) {\n        if (shift.mealPlanData && (shift.mealPlanData as any).shoppingList) {\n          shoppingList = (shift.mealPlanData as any).shoppingList;\n          break;\n        }\n      }\n\n      if (shoppingList.length === 0) {\n        return res.status(400).json({ error: \"No shopping list found in meal plan\" });\n      }\n\n      // Get existing shopping list items\n      const existingItems = await storage.getShoppingList(userId);\n      const existingItemsMap = new Map(\n        existingItems.map(item => [item.itemName.toLowerCase(), item])\n      );\n\n      let addedCount = 0;\n      let updatedCount = 0;\n\n      // Add or update shopping list items\n      for (const mealPlanItem of shoppingList) {\n        const itemName = mealPlanItem.ingredient;\n        const existingItem = existingItemsMap.get(itemName.toLowerCase());\n\n        if (existingItem) {\n          // Item exists - combine quantities if possible\n          const combinedQuantity = existingItem.quantity \n            ? `${existingItem.quantity} + ${mealPlanItem.quantity}`\n            : mealPlanItem.quantity;\n          \n          await storage.updateShoppingItem(existingItem.id, userId, {\n            quantity: combinedQuantity\n          });\n          updatedCount++;\n        } else {\n          // Add new item\n          await storage.addShoppingItem({\n            userId,\n            itemName: itemName,\n            checked: 0,\n            source: \"custom\",\n            quantity: mealPlanItem.quantity,\n            unit: null\n          });\n          addedCount++;\n        }\n      }\n\n      res.json({ \n        success: true, \n        addedCount, \n        updatedCount,\n        totalItems: shoppingList.length \n      });\n    } catch (error) {\n      console.error(\"Error adding meal plan to shopping list:\", error);\n      res.status(500).json({ error: \"Failed to add items to shopping list\" });\n    }\n  });\n\n  const httpServer = createServer(app);\n  return httpServer;\n}\n","size_bytes":121856},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","size_bytes":971},"server/services/image-analysis-cache.ts":{"content":"import { createHash } from 'crypto';\nimport { promises as fs } from 'fs';\nimport path from 'path';\nimport { FoodAnalysisResult } from '../ai-providers/types';\n\n// Cache configuration interface\nexport interface CacheConfig {\n  maxSize: number;           // Maximum number of entries\n  ttlHours: number;          // Time to live in hours (24-48)\n  enableFilePersistence: boolean; // Whether to persist to disk\n  persistenceFile?: string;  // File path for persistence\n  cleanupIntervalMinutes: number; // How often to clean expired entries\n}\n\n// Cache entry interface\ninterface CacheEntry {\n  imageHash: string;\n  analysis: FoodAnalysisResult;\n  timestamp: number;\n  accessCount: number;\n  lastAccessed: number;\n}\n\n// Cache statistics interface\nexport interface CacheStats {\n  totalRequests: number;\n  cacheHits: number;\n  cacheMisses: number;\n  hitRate: number;\n  currentSize: number;\n  maxSize: number;\n  oldestEntry?: number;\n  newestEntry?: number;\n  totalEvictions: number;\n}\n\nexport class ImageAnalysisCache {\n  private cache: Map<string, CacheEntry> = new Map();\n  private config: CacheConfig;\n  private stats: CacheStats;\n  private cleanupTimer?: NodeJS.Timeout;\n  private accessLock: Promise<void> = Promise.resolve();\n\n  constructor(config: Partial<CacheConfig> = {}) {\n    // Default configuration\n    this.config = {\n      maxSize: 1000,\n      ttlHours: 36, // 36 hours default\n      enableFilePersistence: true,\n      persistenceFile: 'cache/image-analysis-cache.json',\n      cleanupIntervalMinutes: 60, // Clean up every hour\n      ...config\n    };\n\n    // Initialize statistics\n    this.stats = {\n      totalRequests: 0,\n      cacheHits: 0,\n      cacheMisses: 0,\n      hitRate: 0,\n      currentSize: 0,\n      maxSize: this.config.maxSize,\n      totalEvictions: 0\n    };\n\n    // Start periodic cleanup\n    this.startCleanupTimer();\n    \n    // Load cache from disk if persistence is enabled\n    if (this.config.enableFilePersistence) {\n      this.loadFromDisk().catch(error => {\n        console.warn('Failed to load cache from disk:', error.message);\n      });\n    }\n\n    console.log(`ðŸ“¦ ImageAnalysisCache initialized: maxSize=${this.config.maxSize}, ttl=${this.config.ttlHours}h, persistence=${this.config.enableFilePersistence}`);\n  }\n\n  /**\n   * Generate SHA-256 hash of image file content\n   */\n  async generateImageHash(imagePath: string): Promise<string> {\n    try {\n      const imageBuffer = await fs.readFile(imagePath);\n      const hash = createHash('sha256').update(imageBuffer).digest('hex');\n      return hash;\n    } catch (error: any) {\n      throw new Error(`Failed to generate image hash: ${error.message}`);\n    }\n  }\n\n  /**\n   * Get cached analysis result for an image\n   */\n  async get(imagePath: string): Promise<FoodAnalysisResult | null> {\n    return this.withLock(async () => {\n      this.stats.totalRequests++;\n\n      try {\n        const imageHash = await this.generateImageHash(imagePath);\n        const entry = this.cache.get(imageHash);\n\n        if (!entry) {\n          this.stats.cacheMisses++;\n          this.updateHitRate();\n          console.log(`ðŸ“¦ Cache MISS for hash: ${imageHash.substring(0, 12)}...`);\n          return null;\n        }\n\n        // Check if entry has expired\n        const now = Date.now();\n        const ttlMs = this.config.ttlHours * 60 * 60 * 1000;\n        if (now - entry.timestamp > ttlMs) {\n          console.log(`ðŸ“¦ Cache entry EXPIRED for hash: ${imageHash.substring(0, 12)}... (age: ${Math.round((now - entry.timestamp) / (60 * 60 * 1000))}h)`);\n          this.cache.delete(imageHash);\n          this.stats.cacheMisses++;\n          this.updateHitRate();\n          return null;\n        }\n\n        // Update access statistics\n        entry.accessCount++;\n        entry.lastAccessed = now;\n        this.stats.cacheHits++;\n        this.updateHitRate();\n\n        console.log(`ðŸ“¦ Cache HIT for hash: ${imageHash.substring(0, 12)}... (accessed ${entry.accessCount} times)`);\n        \n        // Create a copy of the analysis with the correct image path\n        const cachedAnalysis = {\n          ...entry.analysis,\n          imageUrl: imagePath // Update to current image path\n        };\n\n        return cachedAnalysis;\n      } catch (error: any) {\n        console.error('Cache get error:', error.message);\n        this.stats.cacheMisses++;\n        this.updateHitRate();\n        return null;\n      }\n    });\n  }\n\n  /**\n   * Store analysis result in cache\n   */\n  async set(imagePath: string, analysis: FoodAnalysisResult): Promise<void> {\n    return this.withLock(async () => {\n      try {\n        const imageHash = await this.generateImageHash(imagePath);\n        const now = Date.now();\n\n        const entry: CacheEntry = {\n          imageHash,\n          analysis: { ...analysis }, // Create a copy\n          timestamp: now,\n          accessCount: 1,\n          lastAccessed: now\n        };\n\n        // Check if we need to evict entries\n        if (this.cache.size >= this.config.maxSize) {\n          this.evictOldestEntries(1);\n        }\n\n        this.cache.set(imageHash, entry);\n        this.updateStats();\n\n        console.log(`ðŸ“¦ Cache SET for hash: ${imageHash.substring(0, 12)}... (size: ${this.cache.size}/${this.config.maxSize})`);\n\n        // Persist to disk if enabled\n        if (this.config.enableFilePersistence) {\n          await this.saveToDisk();\n        }\n      } catch (error: any) {\n        console.error('Cache set error:', error.message);\n        // Don't throw error to avoid breaking the analysis pipeline\n      }\n    });\n  }\n\n  /**\n   * Check if analysis exists in cache (without retrieving it)\n   */\n  async has(imagePath: string): Promise<boolean> {\n    return this.withLock(async () => {\n      try {\n        const imageHash = await this.generateImageHash(imagePath);\n        const entry = this.cache.get(imageHash);\n        \n        if (!entry) return false;\n\n        // Check if entry has expired\n        const now = Date.now();\n        const ttlMs = this.config.ttlHours * 60 * 60 * 1000;\n        if (now - entry.timestamp > ttlMs) {\n          this.cache.delete(imageHash);\n          return false;\n        }\n\n        return true;\n      } catch (error: any) {\n        console.error('Cache has error:', error.message);\n        return false;\n      }\n    });\n  }\n\n  /**\n   * Get cache statistics\n   */\n  getStats(): CacheStats {\n    this.updateStats();\n    return { ...this.stats };\n  }\n\n  /**\n   * Clear all cache entries\n   */\n  async clear(): Promise<void> {\n    return this.withLock(async () => {\n      this.cache.clear();\n      this.updateStats();\n      console.log('ðŸ“¦ Cache cleared');\n      \n      if (this.config.enableFilePersistence) {\n        await this.saveToDisk();\n      }\n    });\n  }\n\n  /**\n   * Manually clean up expired entries\n   */\n  async cleanup(): Promise<number> {\n    return this.withLock(async () => {\n      const now = Date.now();\n      const ttlMs = this.config.ttlHours * 60 * 60 * 1000;\n      let removedCount = 0;\n\n      for (const [hash, entry] of Array.from(this.cache.entries())) {\n        if (now - entry.timestamp > ttlMs) {\n          this.cache.delete(hash);\n          removedCount++;\n        }\n      }\n\n      if (removedCount > 0) {\n        this.updateStats();\n        console.log(`ðŸ“¦ Cache cleanup: removed ${removedCount} expired entries`);\n        \n        if (this.config.enableFilePersistence) {\n          await this.saveToDisk();\n        }\n      }\n\n      return removedCount;\n    });\n  }\n\n  /**\n   * Destroy cache and cleanup resources\n   */\n  destroy(): void {\n    if (this.cleanupTimer) {\n      clearInterval(this.cleanupTimer);\n      this.cleanupTimer = undefined;\n    }\n    this.cache.clear();\n    console.log('ðŸ“¦ Cache destroyed');\n  }\n\n  // --- Private Methods ---\n\n  /**\n   * Thread-safe access control\n   */\n  private async withLock<T>(operation: () => Promise<T>): Promise<T> {\n    const currentLock = this.accessLock;\n    let resolveLock: () => void;\n    \n    this.accessLock = new Promise(resolve => {\n      resolveLock = resolve;\n    });\n\n    try {\n      await currentLock;\n      return await operation();\n    } finally {\n      resolveLock!();\n    }\n  }\n\n  /**\n   * Update cache statistics\n   */\n  private updateStats(): void {\n    this.stats.currentSize = this.cache.size;\n    this.updateHitRate();\n    \n    if (this.cache.size > 0) {\n      const timestamps = Array.from(this.cache.values()).map(entry => entry.timestamp);\n      this.stats.oldestEntry = Math.min(...timestamps);\n      this.stats.newestEntry = Math.max(...timestamps);\n    } else {\n      this.stats.oldestEntry = undefined;\n      this.stats.newestEntry = undefined;\n    }\n  }\n\n  /**\n   * Update hit rate calculation\n   */\n  private updateHitRate(): void {\n    if (this.stats.totalRequests > 0) {\n      this.stats.hitRate = Math.round((this.stats.cacheHits / this.stats.totalRequests) * 100);\n    } else {\n      this.stats.hitRate = 0;\n    }\n  }\n\n  /**\n   * Evict oldest entries when cache is full\n   */\n  private evictOldestEntries(count: number): void {\n    const entries = Array.from(this.cache.entries());\n    \n    // Sort by last accessed time (oldest first)\n    entries.sort((a, b) => a[1].lastAccessed - b[1].lastAccessed);\n    \n    for (let i = 0; i < count && i < entries.length; i++) {\n      const [hash] = entries[i];\n      this.cache.delete(hash);\n      this.stats.totalEvictions++;\n    }\n\n    console.log(`ðŸ“¦ Cache evicted ${count} oldest entries`);\n  }\n\n  /**\n   * Start periodic cleanup timer\n   */\n  private startCleanupTimer(): void {\n    const intervalMs = this.config.cleanupIntervalMinutes * 60 * 1000;\n    \n    this.cleanupTimer = setInterval(async () => {\n      try {\n        await this.cleanup();\n      } catch (error: any) {\n        console.error('Periodic cache cleanup failed:', error.message);\n      }\n    }, intervalMs);\n  }\n\n  /**\n   * Save cache to disk for persistence\n   */\n  private async saveToDisk(): Promise<void> {\n    if (!this.config.persistenceFile) return;\n\n    try {\n      const cacheDir = path.dirname(this.config.persistenceFile);\n      await fs.mkdir(cacheDir, { recursive: true });\n\n      const cacheData = {\n        entries: Array.from(this.cache.entries()),\n        stats: this.stats,\n        timestamp: Date.now()\n      };\n\n      await fs.writeFile(this.config.persistenceFile, JSON.stringify(cacheData, null, 2));\n    } catch (error: any) {\n      console.error('Failed to save cache to disk:', error.message);\n    }\n  }\n\n  /**\n   * Load cache from disk\n   */\n  private async loadFromDisk(): Promise<void> {\n    if (!this.config.persistenceFile) return;\n\n    try {\n      const data = await fs.readFile(this.config.persistenceFile, 'utf-8');\n      const cacheData = JSON.parse(data);\n\n      // Restore cache entries\n      for (const [hash, entry] of cacheData.entries) {\n        // Check if entry is still valid\n        const now = Date.now();\n        const ttlMs = this.config.ttlHours * 60 * 60 * 1000;\n        \n        if (now - entry.timestamp <= ttlMs) {\n          this.cache.set(hash, entry);\n        }\n      }\n\n      // Restore relevant stats\n      this.stats.totalEvictions = cacheData.stats.totalEvictions || 0;\n      this.updateStats();\n\n      console.log(`ðŸ“¦ Cache loaded from disk: ${this.cache.size} entries restored`);\n    } catch (error: any) {\n      if (error.code !== 'ENOENT') {\n        console.error('Failed to load cache from disk:', error.message);\n      }\n    }\n  }\n}\n\n// Export singleton instance\nexport const imageAnalysisCache = new ImageAnalysisCache({\n  maxSize: 1000,\n  ttlHours: 36,\n  enableFilePersistence: true,\n  persistenceFile: path.join(process.cwd(), 'cache', 'image-analysis-cache.json'),\n  cleanupIntervalMinutes: 60\n});","size_bytes":11639},"client/src/components/edit-diary-entry-dialog.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { format } from \"date-fns\";\nimport { Edit2, Salad, Clock, FileText } from \"lucide-react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport type { DiaryEntryWithAnalysis } from \"@shared/schema\";\n\ninterface EditDiaryEntryDialogProps {\n  entry: DiaryEntryWithAnalysis;\n}\n\nexport function EditDiaryEntryDialog({ entry }: EditDiaryEntryDialogProps) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [open, setOpen] = useState(false);\n  \n  // Get first food item for display\n  const firstFood = entry.analysis?.detectedFoods?.[0];\n  const foodName = firstFood?.name || \"Food Item\";\n  \n  const [mealDate, setMealDate] = useState(\n    format(new Date(entry.mealDate), \"yyyy-MM-dd'T'HH:mm\")\n  );\n  const [notes, setNotes] = useState(entry.notes || \"\");\n\n  const updateMutation = useMutation({\n    mutationFn: async (updateData: any) => {\n      console.log(\"ðŸ”„ Attempting to update entry:\", {\n        entryId: entry.id,\n        updateData,\n        url: `/api/diary/${entry.id}`\n      });\n      \n      try {\n        const response = await apiRequest(\"PATCH\", `/api/diary/${entry.id}`, updateData);\n        const result = await response.json();\n        console.log(\"âœ… Update successful:\", result);\n        return result;\n      } catch (error) {\n        console.error(\"âŒ Update failed:\", error);\n        throw error;\n      }\n    },\n    onSuccess: (data) => {\n      console.log(\"ðŸŽ‰ Mutation success callback triggered\");\n      toast({\n        title: \"Entry Updated\",\n        description: \"Your meal entry has been updated successfully.\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/diary\"] });\n      setOpen(false);\n    },\n    onError: (error: Error) => {\n      console.error(\"ðŸ’¥ Mutation error callback triggered:\", error);\n      \n      // Extract more specific error information\n      let errorMessage = \"Failed to update entry. Please try again.\";\n      if (error.message) {\n        // Check if it's a network error or API error\n        if (error.message.includes(\"401\")) {\n          errorMessage = \"Please log in again to continue.\";\n        } else if (error.message.includes(\"403\")) {\n          errorMessage = \"You don't have permission to edit this entry.\";\n        } else if (error.message.includes(\"404\")) {\n          errorMessage = \"Entry not found. It may have been deleted.\";\n        } else if (error.message.includes(\"400\")) {\n          errorMessage = \"Invalid data. Please check your input.\";\n        } else {\n          errorMessage = `Update failed: ${error.message}`;\n        }\n      }\n      \n      toast({\n        title: \"Update Failed\",\n        description: errorMessage,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSave = () => {\n    // Only update date/notes (portion editing removed)\n    const updateData: any = {\n      mealType: entry.mealType,\n      mealDate: new Date(mealDate).toISOString(),\n      notes: notes.trim() || undefined,\n    };\n\n    updateMutation.mutate(updateData);\n  };\n\n  const resetForm = () => {\n    setMealDate(format(new Date(entry.mealDate), \"yyyy-MM-dd'T'HH:mm\"));\n    setNotes(entry.notes || \"\");\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={setOpen}>\n      <DialogTrigger asChild>\n        <Button\n          variant=\"outline\"\n          size=\"sm\"\n          className=\"bg-gradient-to-r from-blue-500/10 to-purple-500/10 hover:from-blue-500/20 hover:to-purple-500/20 border-blue-200 dark:border-blue-800\"\n          onClick={resetForm}\n          data-testid=\"button-edit-entry\"\n        >\n          <Edit2 className=\"h-4 w-4 mr-1\" />\n          Edit\n        </Button>\n      </DialogTrigger>\n      <DialogContent className=\"max-w-sm max-h-[90vh] flex flex-col bg-white dark:bg-gray-900\">\n        <DialogHeader>\n          <DialogTitle>Edit Meal Entry</DialogTitle>\n          <DialogDescription>Update the time or notes for this meal</DialogDescription>\n        </DialogHeader>\n        <div className=\"space-y-4 overflow-y-auto flex-1 pr-2\">\n          {/* Food Header */}\n          <div className=\"flex items-center gap-3\">\n            <div className=\"w-12 h-12 rounded-full bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center flex-shrink-0\">\n              <Salad className=\"w-6 h-6 text-purple-600 dark:text-purple-400\" />\n            </div>\n            <div className=\"flex-1 min-w-0\">\n              <h2 className=\"text-lg font-bold text-gray-900 dark:text-white truncate\">\n                {foodName}\n              </h2>\n              <p className=\"text-xs text-gray-500 dark:text-gray-400 truncate\">\n                {firstFood?.portion || \"Serving\"}\n              </p>\n            </div>\n          </div>\n\n          {/* Date & Time */}\n          <div className=\"space-y-1.5\">\n            <h3 className=\"text-base font-bold text-gray-900 dark:text-white flex items-center gap-2\">\n              <Clock className=\"w-4 h-4\" />\n              Date & Time\n            </h3>\n            <Input\n              id=\"meal-date\"\n              type=\"datetime-local\"\n              value={mealDate}\n              onChange={(e) => setMealDate(e.target.value)}\n              className=\"text-sm\"\n              data-testid=\"input-meal-date\"\n            />\n          </div>\n\n          {/* Notes */}\n          <div className=\"space-y-1.5\">\n            <h3 className=\"text-base font-bold text-gray-900 dark:text-white flex items-center gap-2\">\n              <FileText className=\"w-4 h-4\" />\n              Notes (Optional)\n            </h3>\n            <Textarea\n              id=\"notes\"\n              placeholder=\"Add any notes...\"\n              value={notes}\n              onChange={(e) => setNotes(e.target.value)}\n              rows={2}\n              className=\"text-sm\"\n              data-testid=\"input-notes\"\n            />\n          </div>\n        </div>\n\n        {/* Buttons - Fixed at bottom */}\n        <div className=\"flex gap-2 pt-4 border-t border-gray-200 dark:border-gray-700 mt-4\">\n          <Button\n            onClick={() => setOpen(false)}\n            variant=\"outline\"\n            className=\"flex-1\"\n            data-testid=\"button-cancel\"\n          >\n            Cancel\n          </Button>\n          <Button\n            onClick={handleSave}\n            disabled={updateMutation.isPending}\n            className=\"flex-1 bg-gradient-to-r from-purple-600 to-purple-500 hover:from-purple-700 hover:to-purple-600 text-white\"\n            data-testid=\"button-save\"\n          >\n            {updateMutation.isPending ? \"Saving...\" : \"Add to Diary\"}\n          </Button>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":7005},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","size_bytes":2263},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4281},"android/app/src/main/assets/public/cordova.js":{"content":"","size_bytes":0},"ios/App/App/public/assets/web-C186JTil.js":{"content":"import{W as s}from\"./index-BfQ6GJWf.js\";class c extends s{constructor(){super(...arguments),this.pending=[],this.deliveredNotifications=[],this.hasNotificationSupport=()=>{if(!(\"Notification\"in window)||!Notification.requestPermission)return!1;if(Notification.permission!==\"granted\")try{new Notification(\"\")}catch(i){if(i.name==\"TypeError\")return!1}return!0}}async getDeliveredNotifications(){const i=[];for(const t of this.deliveredNotifications){const e={title:t.title,id:parseInt(t.tag),body:t.body};i.push(e)}return{notifications:i}}async removeDeliveredNotifications(i){for(const t of i.notifications){const e=this.deliveredNotifications.find(n=>n.tag===String(t.id));e==null||e.close(),this.deliveredNotifications=this.deliveredNotifications.filter(()=>!e)}}async removeAllDeliveredNotifications(){for(const i of this.deliveredNotifications)i.close();this.deliveredNotifications=[]}async createChannel(){throw this.unimplemented(\"Not implemented on web.\")}async deleteChannel(){throw this.unimplemented(\"Not implemented on web.\")}async listChannels(){throw this.unimplemented(\"Not implemented on web.\")}async schedule(i){if(!this.hasNotificationSupport())throw this.unavailable(\"Notifications not supported in this browser.\");for(const t of i.notifications)this.sendNotification(t);return{notifications:i.notifications.map(t=>({id:t.id}))}}async getPending(){return{notifications:this.pending}}async registerActionTypes(){throw this.unimplemented(\"Not implemented on web.\")}async cancel(i){this.pending=this.pending.filter(t=>!i.notifications.find(e=>e.id===t.id))}async areEnabled(){const{display:i}=await this.checkPermissions();return{value:i===\"granted\"}}async changeExactNotificationSetting(){throw this.unimplemented(\"Not implemented on web.\")}async checkExactNotificationSetting(){throw this.unimplemented(\"Not implemented on web.\")}async requestPermissions(){if(!this.hasNotificationSupport())throw this.unavailable(\"Notifications not supported in this browser.\");return{display:this.transformNotificationPermission(await Notification.requestPermission())}}async checkPermissions(){if(!this.hasNotificationSupport())throw this.unavailable(\"Notifications not supported in this browser.\");return{display:this.transformNotificationPermission(Notification.permission)}}transformNotificationPermission(i){switch(i){case\"granted\":return\"granted\";case\"denied\":return\"denied\";default:return\"prompt\"}}sendPending(){var i;const t=[],e=new Date().getTime();for(const n of this.pending)!((i=n.schedule)===null||i===void 0)&&i.at&&n.schedule.at.getTime()<=e&&(this.buildNotification(n),t.push(n));this.pending=this.pending.filter(n=>!t.find(o=>o===n))}sendNotification(i){var t;if(!((t=i.schedule)===null||t===void 0)&&t.at){const e=i.schedule.at.getTime()-new Date().getTime();this.pending.push(i),setTimeout(()=>{this.sendPending()},e);return}this.buildNotification(i)}buildNotification(i){const t=new Notification(i.title,{body:i.body,tag:String(i.id)});return t.addEventListener(\"click\",this.onClick.bind(this,i),!1),t.addEventListener(\"show\",this.onShow.bind(this,i),!1),t.addEventListener(\"close\",()=>{this.deliveredNotifications=this.deliveredNotifications.filter(()=>!this)},!1),this.deliveredNotifications.push(t),t}onClick(i){const t={actionId:\"tap\",notification:i};this.notifyListeners(\"localNotificationActionPerformed\",t)}onShow(i){this.notifyListeners(\"localNotificationReceived\",i)}}export{c as LocalNotificationsWeb};\n","size_bytes":3435},"client/src/components/advanced-analytics.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { format, subDays, startOfDay, endOfDay, differenceInDays } from \"date-fns\";\nimport { TrendingUp, TrendingDown, Award, Target, Calendar, Flame, Activity, Coffee } from \"lucide-react\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Badge } from \"@/components/ui/badge\";\nimport type { DiaryEntryWithAnalysis, DrinkEntry, NutritionGoals } from \"@shared/schema\";\nimport { calculateDailyNutrition } from \"@/lib/nutrition-calculator\";\n\ninterface AdvancedAnalyticsProps {\n  goals: NutritionGoals | undefined;\n}\n\nexport function AdvancedAnalytics({ goals }: AdvancedAnalyticsProps) {\n  const { data: diaryEntries = [] } = useQuery<DiaryEntryWithAnalysis[]>({\n    queryKey: ['/api/diary'],\n  });\n\n  const { data: drinkEntries = [] } = useQuery<DrinkEntry[]>({\n    queryKey: ['/api/drinks'],\n  });\n\n  // Calculate streak data\n  const getStreakData = () => {\n    const today = startOfDay(new Date());\n    let currentStreak = 0;\n    let longestStreak = 0;\n    let tempStreak = 0;\n    let lastDate: Date | null = null;\n\n    // Sort entries by date descending\n    const uniqueDates = new Set(\n      diaryEntries.map(entry => format(new Date(entry.mealDate), 'yyyy-MM-dd'))\n    );\n    const sortedDates = Array.from(uniqueDates).sort().reverse();\n\n    // Calculate current streak (from today backwards)\n    for (const dateStr of sortedDates) {\n      const date = startOfDay(new Date(dateStr));\n      const expectedDate = lastDate ? subDays(lastDate, 1) : today;\n      \n      if (date.getTime() === expectedDate.getTime()) {\n        tempStreak++;\n        if (lastDate === null) currentStreak = tempStreak; // Only count current streak from today\n      } else if (lastDate !== null) {\n        break; // Streak broken\n      }\n      \n      lastDate = date;\n      longestStreak = Math.max(longestStreak, tempStreak);\n    }\n\n    return { currentStreak, longestStreak };\n  };\n\n  // Calculate nutrition trends over last 30 days\n  const getTrendData = () => {\n    const last30Days = Array.from({ length: 30 }, (_, i) => {\n      const targetDate = subDays(new Date(), i);\n      const nutrition = calculateDailyNutrition(diaryEntries, drinkEntries, targetDate);\n      \n      return {\n        date: format(targetDate, 'yyyy-MM-dd'),\n        calories: nutrition.calories,\n        protein: nutrition.protein,\n        carbs: nutrition.carbs,\n        fat: nutrition.fat,\n      };\n    });\n\n    // Calculate averages and trends\n    const recent7Days = last30Days.slice(0, 7);\n    const previous7Days = last30Days.slice(7, 14);\n\n    const recent7Avg = {\n      calories: recent7Days.reduce((sum, day) => sum + day.calories, 0) / 7,\n      protein: recent7Days.reduce((sum, day) => sum + day.protein, 0) / 7,\n    };\n\n    const previous7Avg = {\n      calories: previous7Days.reduce((sum, day) => sum + day.calories, 0) / 7,\n      protein: previous7Days.reduce((sum, day) => sum + day.protein, 0) / 7,\n    };\n\n    return {\n      caloriesTrend: recent7Avg.calories > previous7Avg.calories ? 'up' : 'down',\n      caloriesChange: Math.abs(recent7Avg.calories - previous7Avg.calories),\n      proteinTrend: recent7Avg.protein > previous7Avg.protein ? 'up' : 'down',\n      proteinChange: Math.abs(recent7Avg.protein - previous7Avg.protein),\n      averages: recent7Avg,\n    };\n  };\n\n  // Calculate goal achievement rates\n  const getGoalAchievement = () => {\n    if (!goals) return { caloriesRate: 0, proteinRate: 0, weeklyRate: 0 };\n\n    const last7Days = Array.from({ length: 7 }, (_, i) => {\n      const targetDate = subDays(new Date(), i);\n      const nutrition = calculateDailyNutrition(diaryEntries, drinkEntries, targetDate);\n      \n      return {\n        calories: nutrition.calories,\n        protein: nutrition.protein,\n        achievedCalories: nutrition.calories >= (goals.dailyCalories || 2000) * 0.9,\n        achievedProtein: nutrition.protein >= (goals.dailyProtein || 150) * 0.9,\n      };\n    });\n\n    const caloriesRate = (last7Days.filter(day => day.achievedCalories).length / 7) * 100;\n    const proteinRate = (last7Days.filter(day => day.achievedProtein).length / 7) * 100;\n    const weeklyRate = (caloriesRate + proteinRate) / 2;\n\n    return { caloriesRate, proteinRate, weeklyRate };\n  };\n\n  // Get eating pattern insights\n  const getEatingPatterns = () => {\n    const mealTimes = diaryEntries.map(entry => ({\n      hour: new Date(entry.mealDate).getHours(),\n      type: entry.mealType,\n    }));\n\n    const avgMealTimes = ['breakfast', 'lunch', 'dinner'].map(mealType => {\n      const times = mealTimes.filter(meal => meal.type === mealType).map(meal => meal.hour);\n      if (times.length === 0) return { type: mealType, avgHour: null };\n      \n      const avgHour = times.reduce((sum, hour) => sum + hour, 0) / times.length;\n      return { type: mealType, avgHour: Math.round(avgHour) };\n    });\n\n    const lateNightSnacks = mealTimes.filter(meal => meal.hour >= 22 || meal.hour <= 5).length;\n    \n    return { avgMealTimes, lateNightSnacks };\n  };\n\n  const streakData = getStreakData();\n  const trendData = getTrendData();\n  const goalAchievement = getGoalAchievement();\n  const eatingPatterns = getEatingPatterns();\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Streak & Achievement Cards */}\n      <div className=\"grid grid-cols-2 gap-4\">\n        <Card className=\"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-950 dark:to-emerald-950 border-green-200 dark:border-green-800\">\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-green-700 dark:text-green-300\">Current Streak</p>\n                <p className=\"text-2xl font-bold text-green-600 dark:text-green-400\">{streakData.currentStreak}</p>\n                <p className=\"text-xs text-green-600 dark:text-green-400\">days</p>\n              </div>\n              <Award className=\"h-8 w-8 text-green-500\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"bg-gradient-to-br from-blue-50 to-cyan-50 dark:from-blue-950 dark:to-cyan-950 border-blue-200 dark:border-blue-800\">\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-blue-700 dark:text-blue-300\">Goal Rate</p>\n                <p className=\"text-2xl font-bold text-blue-600 dark:text-blue-400\">{Math.round(goalAchievement.weeklyRate)}%</p>\n                <p className=\"text-xs text-blue-600 dark:text-blue-400\">this week</p>\n              </div>\n              <Target className=\"h-8 w-8 text-blue-500\" />\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Nutrition Trends */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <TrendingUp className=\"h-5 w-5\" />\n            Nutrition Trends (7-day average)\n          </CardTitle>\n          <CardDescription>\n            Comparing this week vs last week\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-2\">\n              <Flame className=\"h-4 w-4 text-orange-500\" />\n              <span className=\"font-medium\">Calories</span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              {trendData.caloriesTrend === 'up' ? (\n                <TrendingUp className=\"h-4 w-4 text-green-500\" />\n              ) : (\n                <TrendingDown className=\"h-4 w-4 text-red-500\" />\n              )}\n              <span className=\"text-sm font-medium\">\n                {Math.round(trendData.averages.calories)} cal/day\n              </span>\n              <Badge variant={trendData.caloriesTrend === 'up' ? 'default' : 'secondary'}>\n                {trendData.caloriesTrend === 'up' ? '+' : '-'}{Math.round(trendData.caloriesChange)}\n              </Badge>\n            </div>\n          </div>\n\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-2\">\n              <Activity className=\"h-4 w-4 text-red-500\" />\n              <span className=\"font-medium\">Protein</span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              {trendData.proteinTrend === 'up' ? (\n                <TrendingUp className=\"h-4 w-4 text-green-500\" />\n              ) : (\n                <TrendingDown className=\"h-4 w-4 text-red-500\" />\n              )}\n              <span className=\"text-sm font-medium\">\n                {Math.round(trendData.averages.protein)}g/day\n              </span>\n              <Badge variant={trendData.proteinTrend === 'up' ? 'default' : 'secondary'}>\n                {trendData.proteinTrend === 'up' ? '+' : '-'}{Math.round(trendData.proteinChange)}g\n              </Badge>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Goal Achievement Breakdown */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Weekly Goal Achievement</CardTitle>\n          <CardDescription>\n            Your consistency over the last 7 days\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"space-y-2\">\n            <div className=\"flex items-center justify-between text-sm\">\n              <span>Calorie Goals</span>\n              <span className=\"font-medium\">{Math.round(goalAchievement.caloriesRate)}%</span>\n            </div>\n            <Progress value={goalAchievement.caloriesRate} className=\"h-2\" />\n          </div>\n\n          <div className=\"space-y-2\">\n            <div className=\"flex items-center justify-between text-sm\">\n              <span>Protein Goals</span>\n              <span className=\"font-medium\">{Math.round(goalAchievement.proteinRate)}%</span>\n            </div>\n            <Progress value={goalAchievement.proteinRate} className=\"h-2\" />\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Eating Patterns */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Calendar className=\"h-5 w-5\" />\n            Eating Patterns\n          </CardTitle>\n          <CardDescription>\n            Insights about your meal timing\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"space-y-2\">\n            <h4 className=\"font-medium text-sm\">Average Meal Times</h4>\n            {eatingPatterns.avgMealTimes.map(({ type, avgHour }) => (\n              <div key={type} className=\"flex items-center justify-between\">\n                <span className=\"capitalize text-sm\">{type}</span>\n                <span className=\"text-sm font-medium\">\n                  {avgHour ? format(new Date().setHours(avgHour, 0), 'h:mm a') : 'No data'}\n                </span>\n              </div>\n            ))}\n          </div>\n\n          {eatingPatterns.lateNightSnacks > 0 && (\n            <div className=\"bg-amber-50 dark:bg-amber-950 border border-amber-200 dark:border-amber-800 rounded-lg p-3\">\n              <div className=\"flex items-center gap-2\">\n                <Coffee className=\"h-4 w-4 text-amber-600\" />\n                <span className=\"text-sm font-medium\">Late Night Pattern</span>\n              </div>\n              <p className=\"text-xs text-amber-700 dark:text-amber-300 mt-1\">\n                {eatingPatterns.lateNightSnacks} late night meals recorded (10 PM - 5 AM)\n              </p>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Best & Worst Days */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Performance Insights</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"text-center text-sm text-muted-foreground\">\n            <p>Longest streak: {streakData.longestStreak} days</p>\n            <p className=\"mt-2\">Keep up the great work! ðŸŽ‰</p>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":12212},"android/app/src/main/assets/public/assets/speech-service-acJ2d5rg.js":{"content":"class h{constructor(){this.recognition=null,this.isListening=!1,this.isEnabled=!1,this.handlers=[],this.voiceCommands=new Map,this.continuousMode=!1,this.lastCommandTime=0,this.commandTimeout=5e3}async initialize(){try{const e=window.SpeechRecognition||window.webkitSpeechRecognition;return e?(this.recognition=new e,this.recognition.continuous=!1,this.recognition.interimResults=!1,this.recognition.lang=\"en-US\",this.recognition.maxAlternatives=3,this.recognition.onstart=()=>{this.isListening=!0,this.triggerEvent({type:\"listening-start\"}),console.log(\"ðŸŽ¤ Speech recognition started\")},this.recognition.onend=()=>{this.isListening=!1,this.triggerEvent({type:\"listening-end\"}),console.log(\"ðŸŽ¤ Speech recognition ended\"),this.continuousMode&&this.isEnabled&&setTimeout(()=>{this.isEnabled&&!this.isListening&&this.startListening()},1e3)},this.recognition.onresult=o=>{var r,a,c;const t=Array.from(o.results),i=t[t.length-1],n=((a=(r=i==null?void 0:i[0])==null?void 0:r.transcript)==null?void 0:a.toLowerCase())||\"\",s=((c=i==null?void 0:i[0])==null?void 0:c.confidence)||0;console.log(`ðŸŽ¤ Speech recognized: \"${n}\" (confidence: ${s.toFixed(2)})`),n&&this.processVoiceCommand(n,s)},this.recognition.onerror=o=>{if(console.error(\"Speech recognition error:\",o.error),o.error===\"aborted\"&&!this.isEnabled){console.log(\"ðŸŽ¤ Speech recognition properly stopped\");return}this.triggerEvent({type:\"error\",error:o.error})},this.recognition.onnomatch=()=>{console.log(\"ðŸŽ¤ No speech match found\"),this.triggerEvent({type:\"no-match\"})},console.log(\"âœ“ Speech recognition service initialized\"),!0):(console.warn(\"Speech recognition not supported in this browser\"),!1)}catch(e){return console.error(\"Failed to initialize speech recognition:\",e),!1}}processVoiceCommand(e,o){const t=Date.now();if(t-this.lastCommandTime<2e3){console.log(\"ðŸŽ¤ Command ignored - too soon after previous command\");return}for(const[i,n]of Array.from(this.voiceCommands.entries())){const s=n.phrases.find(r=>r.toLowerCase().split(\" \").every(c=>e.includes(c)));if(s&&o>.6){console.log(`ðŸŽ¤ Voice command matched: ${i} (\"${s}\")`),this.triggerEvent({type:\"command-recognized\",command:i,confidence:o,transcript:e});try{n.action(),this.lastCommandTime=t,this.continuousMode||setTimeout(()=>{this.stopListening()},100)}catch(r){console.error(`Error executing voice command ${i}:`,r)}return}}console.log(`ðŸŽ¤ No matching voice command for: \"${e}\"`),this.triggerEvent({type:\"no-match\",transcript:e})}registerCommand(e,o){this.voiceCommands.set(e,o),console.log(`ðŸŽ¤ Registered voice command: ${e} - ${o.phrases.join(\", \")}`)}unregisterCommand(e){this.voiceCommands.delete(e)}async startListening(e=!1){if(!this.recognition||this.isListening)return!1;try{return this.continuousMode=e,this.isEnabled=!0,this.recognition.start(),!0}catch(o){return console.error(\"Failed to start speech recognition:\",o),!1}}stopListening(){if(this.recognition){this.isEnabled=!1,this.continuousMode=!1;try{this.recognition.stop(),console.log(\"ðŸ›‘ Speech recognition stop requested\")}catch(e){console.warn(\"Speech recognition stop error (expected):\",e)}this.isListening=!1}}isCurrentlyListening(){return this.isListening}isSpeechEnabled(){return this.isEnabled}isSupported(){return!!(window.SpeechRecognition||window.webkitSpeechRecognition)}on(e){this.handlers.push(e)}off(e){const o=this.handlers.indexOf(e);o>-1&&this.handlers.splice(o,1)}triggerEvent(e){this.handlers.forEach(o=>{try{o(e)}catch(t){console.error(\"Error in speech event handler:\",t)}})}getSettings(){return{enabled:localStorage.getItem(\"platemate-speech-enabled\")===\"true\",continuous:localStorage.getItem(\"platemate-speech-continuous\")===\"true\",wakeWord:localStorage.getItem(\"platemate-wake-word\")||\"hey platemate\",voiceConfirmation:localStorage.getItem(\"platemate-voice-confirmation\")!==\"false\"}}updateSettings(e){Object.entries(e).forEach(([o,t])=>{t!==void 0&&localStorage.setItem(`platemate-${o.replace(/([A-Z])/g,\"-$1\").toLowerCase()}`,t.toString())})}getAvailableCommands(){return Array.from(this.voiceCommands.values())}}const g=new h;export{g as speechService};\n","size_bytes":4086},"ios/App/App/AppDelegate.swift":{"content":"import UIKit\nimport Capacitor\n\n@UIApplicationMain\nclass AppDelegate: UIResponder, UIApplicationDelegate {\n\n    var window: UIWindow?\n\n    func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {\n        // Override point for customization after application launch.\n        return true\n    }\n\n    func applicationWillResignActive(_ application: UIApplication) {\n        // Sent when the application is about to move from active to inactive state. This can occur for certain types of temporary interruptions (such as an incoming phone call or SMS message) or when the user quits the application and it begins the transition to the background state.\n        // Use this method to pause ongoing tasks, disable timers, and invalidate graphics rendering callbacks. Games should use this method to pause the game.\n    }\n\n    func applicationDidEnterBackground(_ application: UIApplication) {\n        // Use this method to release shared resources, save user data, invalidate timers, and store enough application state information to restore your application to its current state in case it is terminated later.\n        // If your application supports background execution, this method is called instead of applicationWillTerminate: when the user quits.\n    }\n\n    func applicationWillEnterForeground(_ application: UIApplication) {\n        // Called as part of the transition from the background to the active state; here you can undo many of the changes made on entering the background.\n    }\n\n    func applicationDidBecomeActive(_ application: UIApplication) {\n        // Restart any tasks that were paused (or not yet started) while the application was inactive. If the application was previously in the background, optionally refresh the user interface.\n    }\n\n    func applicationWillTerminate(_ application: UIApplication) {\n        // Called when the application is about to terminate. Save data if appropriate. See also applicationDidEnterBackground:.\n    }\n\n    func application(_ app: UIApplication, open url: URL, options: [UIApplication.OpenURLOptionsKey: Any] = [:]) -> Bool {\n        // Called when the app was launched with a url. Feel free to add additional processing here,\n        // but if you want the App API to support tracking app url opens, make sure to keep this call\n        return ApplicationDelegateProxy.shared.application(app, open: url, options: options)\n    }\n\n    func application(_ application: UIApplication, continue userActivity: NSUserActivity, restorationHandler: @escaping ([UIUserActivityRestoring]?) -> Void) -> Bool {\n        // Called when the app was launched with an activity, including Universal Links.\n        // Feel free to add additional processing here, but if you want the App API to support\n        // tracking app url opens, make sure to keep this call\n        return ApplicationDelegateProxy.shared.application(application, continue: userActivity, restorationHandler: restorationHandler)\n    }\n\n}\n","size_bytes":3031},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10481},"server/services/openfoodfacts-service.ts":{"content":"interface NutritionData {\n  calories: number;\n  protein: number;\n  carbs: number;\n  fat: number;\n}\n\ninterface CachedFood {\n  food: string;\n  nutrition_per_100g: NutritionData | \"not found\";\n  cachedAt: number;\n}\n\ninterface OpenFoodFactsResponse {\n  products: Array<{\n    product_name: string;\n    nutriments: {\n      'energy-kcal_100g'?: number;\n      'proteins_100g'?: number;\n      'carbohydrates_100g'?: number;\n      'fat_100g'?: number;\n    };\n  }>;\n}\n\nexport class OpenFoodFactsService {\n  private cache = new Map<string, CachedFood>();\n  private barcodeCache = new Map<string, CachedFood>();\n  private readonly CACHE_DURATION = 24 * 60 * 60 * 1000; // 24 hours in milliseconds\n  private readonly BASE_URL = 'https://world.openfoodfacts.org/api/v2/search';\n  private readonly PRODUCT_URL = 'https://world.openfoodfacts.org/api/v0/product';\n  private readonly USER_AGENT = 'PlateMate/1.0 (platemate@replit.app)';\n\n  /**\n   * Get nutrition data for a list of food names\n   */\n  async getNutritionData(foodNames: string[]): Promise<Array<{ food: string; nutrition_per_100g: NutritionData | \"not found\" }>> {\n    const results = [];\n    \n    for (const foodName of foodNames) {\n      const nutrition = await this.getFoodNutrition(foodName.trim());\n      results.push({\n        food: foodName.trim(),\n        nutrition_per_100g: nutrition\n      });\n    }\n    \n    return results;\n  }\n\n  /**\n   * Get nutrition data for a single food item\n   */\n  private async getFoodNutrition(foodName: string): Promise<NutritionData | \"not found\"> {\n    // Check cache first\n    const cached = this.getCachedData(foodName);\n    if (cached) {\n      return cached.nutrition_per_100g;\n    }\n\n    try {\n      // Query Open Food Facts API\n      const url = `${this.BASE_URL}?search_terms=${encodeURIComponent(foodName)}&search_simple=1&action=process&json=1&page_size=1&fields=product_name,nutriments`;\n      \n      console.log(`ðŸŒ Querying Open Food Facts for: ${foodName}`);\n      \n      const response = await fetch(url, {\n        headers: {\n          'User-Agent': this.USER_AGENT\n        }\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data: OpenFoodFactsResponse = await response.json();\n      \n      if (!data.products || data.products.length === 0) {\n        console.log(`âŒ No data found for: ${foodName}`);\n        this.setCachedData(foodName, \"not found\");\n        return \"not found\";\n      }\n\n      const product = data.products[0];\n      const nutriments = product.nutriments;\n\n      // Extract nutrition data per 100g\n      const nutrition: NutritionData = {\n        calories: Math.round(nutriments['energy-kcal_100g'] || 0),\n        protein: Math.round((nutriments['proteins_100g'] || 0) * 10) / 10, // Round to 1 decimal\n        carbs: Math.round((nutriments['carbohydrates_100g'] || 0) * 10) / 10,\n        fat: Math.round((nutriments['fat_100g'] || 0) * 10) / 10\n      };\n\n      console.log(`âœ… Found nutrition data for ${foodName}:`, nutrition);\n      \n      // Cache the result\n      this.setCachedData(foodName, nutrition);\n      \n      return nutrition;\n      \n    } catch (error) {\n      console.error(`âŒ Error fetching nutrition data for ${foodName}:`, error);\n      this.setCachedData(foodName, \"not found\");\n      return \"not found\";\n    }\n  }\n\n  /**\n   * Get cached data if valid\n   */\n  private getCachedData(foodName: string): CachedFood | null {\n    const normalizedName = foodName.toLowerCase().trim();\n    const cached = this.cache.get(normalizedName);\n    \n    if (!cached) {\n      return null;\n    }\n\n    // Check if cache is still valid (24 hours)\n    const now = Date.now();\n    if (now - cached.cachedAt > this.CACHE_DURATION) {\n      console.log(`â° Cache expired for: ${foodName}`);\n      this.cache.delete(normalizedName);\n      return null;\n    }\n\n    console.log(`ðŸ’¾ Using cached data for: ${foodName}`);\n    return cached;\n  }\n\n  /**\n   * Cache nutrition data\n   */\n  private setCachedData(foodName: string, nutrition: NutritionData | \"not found\"): void {\n    const normalizedName = foodName.toLowerCase().trim();\n    this.cache.set(normalizedName, {\n      food: foodName,\n      nutrition_per_100g: nutrition,\n      cachedAt: Date.now()\n    });\n  }\n\n  /**\n   * Get cache statistics\n   */\n  getCacheStats() {\n    return {\n      totalEntries: this.cache.size,\n      entries: Array.from(this.cache.entries()).map(([key, value]) => ({\n        food: key,\n        hasData: value.nutrition_per_100g !== \"not found\",\n        cachedAt: new Date(value.cachedAt).toISOString()\n      }))\n    };\n  }\n\n  /**\n   * Lookup product by barcode\n   */\n  async lookupByBarcode(barcode: string): Promise<{ food: string; nutrition_per_100g: NutritionData | \"not found\"; brand?: string; imageUrl?: string }> {\n    // Check barcode cache first\n    const cached = this.getBarcodeCache(barcode);\n    if (cached) {\n      return {\n        food: cached.food,\n        nutrition_per_100g: cached.nutrition_per_100g,\n        brand: cached.food.split(' (')[1]?.replace(')', ''),\n        imageUrl: undefined // We don't cache images for now\n      };\n    }\n\n    try {\n      console.log(`ðŸ” Looking up barcode: ${barcode}`);\n      \n      const url = `${this.PRODUCT_URL}/${barcode}.json`;\n      const response = await fetch(url, {\n        headers: {\n          'User-Agent': this.USER_AGENT\n        }\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      \n      if (data.status === 0 || !data.product) {\n        console.log(`âŒ Product not found for barcode: ${barcode}`);\n        this.setBarcodeCache(barcode, `Unknown Product (${barcode})`, \"not found\");\n        return {\n          food: `Unknown Product (${barcode})`,\n          nutrition_per_100g: \"not found\"\n        };\n      }\n\n      const product = data.product;\n      const productName = product.product_name_en || product.product_name || `Product ${barcode}`;\n      const brand = product.brands?.split(',')[0]?.trim();\n      const nutriments = product.nutriments || {};\n      \n      // Extract nutrition data per 100g\n      const nutrition: NutritionData = {\n        calories: Math.round(nutriments['energy-kcal_100g'] || 0),\n        protein: Math.round((nutriments['proteins_100g'] || 0) * 10) / 10,\n        carbs: Math.round((nutriments['carbohydrates_100g'] || 0) * 10) / 10,\n        fat: Math.round((nutriments['fat_100g'] || 0) * 10) / 10\n      };\n\n      const displayName = brand ? `${productName} (${brand})` : productName;\n      \n      console.log(`âœ… Found product: ${displayName}`);\n      \n      // Cache the result\n      this.setBarcodeCache(barcode, displayName, nutrition);\n      \n      return {\n        food: displayName,\n        nutrition_per_100g: nutrition,\n        brand,\n        imageUrl: product.image_front_url || product.image_url\n      };\n      \n    } catch (error) {\n      console.error(`âŒ Error looking up barcode ${barcode}:`, error);\n      this.setBarcodeCache(barcode, `Unknown Product (${barcode})`, \"not found\");\n      return {\n        food: `Unknown Product (${barcode})`,\n        nutrition_per_100g: \"not found\"\n      };\n    }\n  }\n\n  /**\n   * Get cached barcode data if valid\n   */\n  private getBarcodeCache(barcode: string): CachedFood | null {\n    const cached = this.barcodeCache.get(barcode);\n    \n    if (!cached) {\n      return null;\n    }\n\n    // Check if cache is still valid (24 hours)\n    const now = Date.now();\n    if (now - cached.cachedAt > this.CACHE_DURATION) {\n      console.log(`â° Barcode cache expired for: ${barcode}`);\n      this.barcodeCache.delete(barcode);\n      return null;\n    }\n\n    console.log(`ðŸ’¾ Using cached barcode data for: ${barcode}`);\n    return cached;\n  }\n\n  /**\n   * Cache barcode data\n   */\n  private setBarcodeCache(barcode: string, productName: string, nutrition: NutritionData | \"not found\"): void {\n    this.barcodeCache.set(barcode, {\n      food: productName,\n      nutrition_per_100g: nutrition,\n      cachedAt: Date.now()\n    });\n  }\n\n  /**\n   * Clear expired cache entries\n   */\n  clearExpiredCache(): number {\n    const now = Date.now();\n    let cleared = 0;\n    \n    for (const [key, value] of Array.from(this.cache.entries())) {\n      if (now - value.cachedAt > this.CACHE_DURATION) {\n        this.cache.delete(key);\n        cleared++;\n      }\n    }\n    \n    // Clear barcode cache too\n    for (const [key, value] of Array.from(this.barcodeCache.entries())) {\n      if (now - value.cachedAt > this.CACHE_DURATION) {\n        this.barcodeCache.delete(key);\n        cleared++;\n      }\n    }\n    \n    console.log(`ðŸ§¹ Cleared ${cleared} expired cache entries`);\n    return cleared;\n  }\n}\n\n// Export singleton instance\nexport const openFoodFactsService = new OpenFoodFactsService();","size_bytes":8828},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"android/app/src/main/assets/public/assets/web-C5UGsvTp.js":{"content":"import{W as s}from\"./index-BQFIQdpH.js\";class c extends s{constructor(){super(...arguments),this.pending=[],this.deliveredNotifications=[],this.hasNotificationSupport=()=>{if(!(\"Notification\"in window)||!Notification.requestPermission)return!1;if(Notification.permission!==\"granted\")try{new Notification(\"\")}catch(i){if(i.name==\"TypeError\")return!1}return!0}}async getDeliveredNotifications(){const i=[];for(const t of this.deliveredNotifications){const e={title:t.title,id:parseInt(t.tag),body:t.body};i.push(e)}return{notifications:i}}async removeDeliveredNotifications(i){for(const t of i.notifications){const e=this.deliveredNotifications.find(n=>n.tag===String(t.id));e==null||e.close(),this.deliveredNotifications=this.deliveredNotifications.filter(()=>!e)}}async removeAllDeliveredNotifications(){for(const i of this.deliveredNotifications)i.close();this.deliveredNotifications=[]}async createChannel(){throw this.unimplemented(\"Not implemented on web.\")}async deleteChannel(){throw this.unimplemented(\"Not implemented on web.\")}async listChannels(){throw this.unimplemented(\"Not implemented on web.\")}async schedule(i){if(!this.hasNotificationSupport())throw this.unavailable(\"Notifications not supported in this browser.\");for(const t of i.notifications)this.sendNotification(t);return{notifications:i.notifications.map(t=>({id:t.id}))}}async getPending(){return{notifications:this.pending}}async registerActionTypes(){throw this.unimplemented(\"Not implemented on web.\")}async cancel(i){this.pending=this.pending.filter(t=>!i.notifications.find(e=>e.id===t.id))}async areEnabled(){const{display:i}=await this.checkPermissions();return{value:i===\"granted\"}}async changeExactNotificationSetting(){throw this.unimplemented(\"Not implemented on web.\")}async checkExactNotificationSetting(){throw this.unimplemented(\"Not implemented on web.\")}async requestPermissions(){if(!this.hasNotificationSupport())throw this.unavailable(\"Notifications not supported in this browser.\");return{display:this.transformNotificationPermission(await Notification.requestPermission())}}async checkPermissions(){if(!this.hasNotificationSupport())throw this.unavailable(\"Notifications not supported in this browser.\");return{display:this.transformNotificationPermission(Notification.permission)}}transformNotificationPermission(i){switch(i){case\"granted\":return\"granted\";case\"denied\":return\"denied\";default:return\"prompt\"}}sendPending(){var i;const t=[],e=new Date().getTime();for(const n of this.pending)!((i=n.schedule)===null||i===void 0)&&i.at&&n.schedule.at.getTime()<=e&&(this.buildNotification(n),t.push(n));this.pending=this.pending.filter(n=>!t.find(o=>o===n))}sendNotification(i){var t;if(!((t=i.schedule)===null||t===void 0)&&t.at){const e=i.schedule.at.getTime()-new Date().getTime();this.pending.push(i),setTimeout(()=>{this.sendPending()},e);return}this.buildNotification(i)}buildNotification(i){const t=new Notification(i.title,{body:i.body,tag:String(i.id)});return t.addEventListener(\"click\",this.onClick.bind(this,i),!1),t.addEventListener(\"show\",this.onShow.bind(this,i),!1),t.addEventListener(\"close\",()=>{this.deliveredNotifications=this.deliveredNotifications.filter(()=>!this)},!1),this.deliveredNotifications.push(t),t}onClick(i){const t={actionId:\"tap\",notification:i};this.notifyListeners(\"localNotificationActionPerformed\",t)}onShow(i){this.notifyListeners(\"localNotificationReceived\",i)}}export{c as LocalNotificationsWeb};\n","size_bytes":3435},"client/src/pages/GoalsPage.tsx":{"content":"import { ArrowLeft, HelpCircle } from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport { NutritionGoals } from \"@/components/nutrition-goals\";\nimport { DropdownNavigation } from \"@/components/dropdown-navigation\";\nimport { BottomHelpSection } from \"@/components/bottom-help-section\";\n\nexport function GoalsPage() {\n  return (\n    <div className=\"min-h-screen text-foreground\" style={{background: 'var(--bg-gradient)'}}>\n      {/* Header */}\n      <div className=\"bg-card border-b\">\n        <div className=\"max-w-md mx-auto px-4 py-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-3\">\n              <Link href=\"/\">\n                <button \n                  className=\"p-2 hover:bg-muted rounded-lg transition-colors\"\n                  data-testid=\"button-back-to-home\"\n                >\n                  <ArrowLeft className=\"h-5 w-5\" />\n                </button>\n              </Link>\n              <h1 className=\"text-xl font-bold\">Nutrition Goals</h1>\n            </div>\n            <Link href=\"/help\">\n              <button \n                className=\"p-2 hover:bg-muted rounded-lg transition-colors\"\n                data-testid=\"button-help-goals\"\n                title=\"Help & Support\"\n              >\n                <HelpCircle className=\"h-4 w-4 text-muted-foreground\" />\n              </button>\n            </Link>\n          </div>\n        </div>\n      </div>\n\n      {/* Content */}\n      <div className=\"max-w-md mx-auto p-4 space-y-6\">\n        <NutritionGoals />\n      </div>\n      \n      {/* Bottom Navigation */}\n      <DropdownNavigation />\n      \n      {/* Bottom Help Section */}\n      <BottomHelpSection />\n    </div>\n  );\n}\n\nexport default GoalsPage;","size_bytes":1746},"ios/App/App/public/assets/web-DaEeAdBX.js":{"content":"import{W as o}from\"./index-BfQ6GJWf.js\";class e extends o{constructor(){super(),this._lastWindow=null}async open(s){this._lastWindow=window.open(s.url,s.windowName||\"_blank\")}async close(){return new Promise((s,n)=>{this._lastWindow!=null?(this._lastWindow.close(),this._lastWindow=null,s()):n(\"No active window to close!\")})}}const i=new e;export{i as Browser,e as BrowserWeb};\n","size_bytes":379},"client/src/components/meal-templates-dialog.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation, useQuery, useQueryClient } from \"@tanstack/react-query\";\nimport { BookOpen, Star, Plus, Copy, Trash2, Save, X } from \"lucide-react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport type { DiaryEntryWithAnalysis } from \"@shared/schema\";\n\ninterface MealTemplate {\n  id: string;\n  name: string;\n  description?: string;\n  analysisId: string;\n  analysis: {\n    totalCalories: number;\n    totalProtein: number;\n    totalCarbs: number;\n    totalFat: number;\n    detectedFoods: any[];\n  };\n  usageCount: number;\n  isFavorite: boolean;\n  createdAt: string;\n}\n\ninterface MealTemplatesDialogProps {\n  onSelectTemplate: (template: MealTemplate) => void;\n}\n\nexport function MealTemplatesDialog({ onSelectTemplate }: MealTemplatesDialogProps) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [open, setOpen] = useState(false);\n  const [isCreating, setIsCreating] = useState(false);\n  const [templateName, setTemplateName] = useState(\"\");\n  const [templateDescription, setTemplateDescription] = useState(\"\");\n  const [selectedEntry, setSelectedEntry] = useState<DiaryEntryWithAnalysis | null>(null);\n\n  // Mock data - in real implementation this would come from API\n  const { data: templates = [] } = useQuery<MealTemplate[]>({\n    queryKey: ['/api/meal-templates'],\n    queryFn: () => {\n      // Mock templates for now\n      return Promise.resolve([]);\n    },\n    enabled: false, // Disable for now since we don't have the backend yet\n  });\n\n  const { data: recentEntries } = useQuery<DiaryEntryWithAnalysis[]>({\n    queryKey: ['/api/diary'],\n  });\n\n  const createTemplateMutation = useMutation({\n    mutationFn: async (templateData: any) => {\n      // Mock API call - would be: await apiRequest(\"POST\", \"/api/meal-templates\", templateData);\n      return Promise.resolve({ id: Date.now().toString(), ...templateData });\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Template Created\",\n        description: \"Your meal template has been saved successfully.\",\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/meal-templates'] });\n      setIsCreating(false);\n      setTemplateName(\"\");\n      setTemplateDescription(\"\");\n      setSelectedEntry(null);\n    },\n    onError: () => {\n      toast({\n        title: \"Creation Failed\",\n        description: \"Failed to create meal template. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const deleteTemplateMutation = useMutation({\n    mutationFn: async (templateId: string) => {\n      // Mock API call - would be: await apiRequest(\"DELETE\", `/api/meal-templates/${templateId}`);\n      return Promise.resolve();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Template Deleted\",\n        description: \"Meal template has been removed.\",\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/meal-templates'] });\n    },\n  });\n\n  const handleCreateTemplate = () => {\n    if (!selectedEntry || !templateName.trim()) return;\n\n    createTemplateMutation.mutate({\n      name: templateName.trim(),\n      description: templateDescription.trim() || undefined,\n      analysisId: selectedEntry.analysisId,\n      analysis: selectedEntry.analysis,\n      usageCount: 0,\n      isFavorite: false,\n    });\n  };\n\n  const handleUseTemplate = (template: MealTemplate) => {\n    onSelectTemplate(template);\n    setOpen(false);\n    toast({\n      title: \"Template Applied\",\n      description: `\"${template.name}\" has been added to your diary.`,\n    });\n  };\n\n  const topTemplates = templates\n    .sort((a, b) => (b.usageCount + (b.isFavorite ? 10 : 0)) - (a.usageCount + (a.isFavorite ? 10 : 0)))\n    .slice(0, 6);\n\n  return (\n    <Dialog open={open} onOpenChange={setOpen}>\n      <DialogTrigger asChild>\n        <Button\n          variant=\"outline\"\n          className=\"bg-gradient-to-r from-green-500/10 to-blue-500/10 hover:from-green-500/20 hover:to-blue-500/20 border-green-200 dark:border-green-800\"\n          data-testid=\"button-meal-templates\"\n        >\n          <BookOpen className=\"h-4 w-4 mr-2\" />\n          Meal Templates\n        </Button>\n      </DialogTrigger>\n      <DialogContent className=\"max-w-2xl max-h-[80vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <BookOpen className=\"h-5 w-5\" />\n            Meal Templates & Favorites\n          </DialogTitle>\n          <DialogDescription>\n            Save your favorite meals as templates for quick logging\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-6\">\n          {/* Quick Actions */}\n          <div className=\"flex gap-2\">\n            <Button\n              onClick={() => setIsCreating(true)}\n              size=\"sm\"\n              className=\"bg-gradient-to-r from-blue-500 to-purple-600\"\n              data-testid=\"button-create-template\"\n            >\n              <Plus className=\"h-4 w-4 mr-1\" />\n              Create Template\n            </Button>\n          </div>\n\n          {/* Create Template Form */}\n          {isCreating && (\n            <Card className=\"border-primary/20\">\n              <CardHeader>\n                <CardTitle className=\"text-lg\">Create New Template</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Select Recent Meal</Label>\n                  <div className=\"grid gap-2 max-h-32 overflow-y-auto\">\n                    {recentEntries?.slice(0, 5).map((entry) => (\n                      <div\n                        key={entry.id}\n                        className={`p-2 border rounded cursor-pointer transition-colors ${\n                          selectedEntry?.id === entry.id\n                            ? 'border-primary bg-primary/10'\n                            : 'hover:bg-muted'\n                        }`}\n                        onClick={() => setSelectedEntry(entry)}\n                        data-testid={`select-entry-${entry.id}`}\n                      >\n                        <div className=\"flex justify-between items-center\">\n                          <div>\n                            <div className=\"font-medium text-sm\">\n                              {entry.mealType === 'custom' && entry.customMealName \n                                ? entry.customMealName \n                                : entry.mealType\n                              }\n                            </div>\n                            <div className=\"text-xs text-muted-foreground\">\n                              {entry.analysis?.totalCalories || 0} calories\n                            </div>\n                          </div>\n                          <div className=\"text-xs text-muted-foreground\">\n                            {new Date(entry.mealDate).toLocaleDateString()}\n                          </div>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>Template Name</Label>\n                  <Input\n                    placeholder=\"e.g., Protein Smoothie Bowl\"\n                    value={templateName}\n                    onChange={(e) => setTemplateName(e.target.value)}\n                    data-testid=\"input-template-name\"\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>Description (Optional)</Label>\n                  <Textarea\n                    placeholder=\"Add notes about this meal template...\"\n                    value={templateDescription}\n                    onChange={(e) => setTemplateDescription(e.target.value)}\n                    rows={2}\n                    data-testid=\"input-template-description\"\n                  />\n                </div>\n\n                <div className=\"flex gap-2\">\n                  <Button\n                    onClick={handleCreateTemplate}\n                    disabled={!selectedEntry || !templateName.trim() || createTemplateMutation.isPending}\n                    className=\"flex-1\"\n                    data-testid=\"button-save-template\"\n                  >\n                    <Save className=\"h-4 w-4 mr-1\" />\n                    {createTemplateMutation.isPending ? \"Saving...\" : \"Save Template\"}\n                  </Button>\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => {\n                      setIsCreating(false);\n                      setTemplateName(\"\");\n                      setTemplateDescription(\"\");\n                      setSelectedEntry(null);\n                    }}\n                    data-testid=\"button-cancel-template\"\n                  >\n                    <X className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n          {/* Templates Grid */}\n          <div className=\"space-y-4\">\n            <h3 className=\"font-medium\">Your Templates</h3>\n            {templates.length === 0 ? (\n              <div className=\"text-center py-8 text-muted-foreground\">\n                <BookOpen className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n                <p>No templates yet</p>\n                <p className=\"text-sm\">Create templates from your favorite meals for quick logging</p>\n              </div>\n            ) : (\n              <div className=\"grid gap-3\">\n                {topTemplates.map((template) => (\n                  <Card key={template.id} className=\"hover:shadow-md transition-shadow\">\n                    <CardContent className=\"p-4\">\n                      <div className=\"flex justify-between items-start\">\n                        <div className=\"flex-1\">\n                          <div className=\"flex items-center gap-2 mb-2\">\n                            <h4 className=\"font-medium\">{template.name}</h4>\n                            {template.isFavorite && (\n                              <Star className=\"h-4 w-4 text-yellow-500 fill-current\" />\n                            )}\n                          </div>\n                          {template.description && (\n                            <p className=\"text-sm text-muted-foreground mb-2\">\n                              {template.description}\n                            </p>\n                          )}\n                          <div className=\"flex gap-4 text-xs text-muted-foreground\">\n                            <span>{template.analysis.totalCalories} cal</span>\n                            <span>{template.analysis.totalProtein}g protein</span>\n                            <span>Used {template.usageCount} times</span>\n                          </div>\n                        </div>\n                        <div className=\"flex gap-1 ml-2\">\n                          <Button\n                            size=\"sm\"\n                            variant=\"outline\"\n                            onClick={() => handleUseTemplate(template)}\n                            data-testid={`button-use-template-${template.id}`}\n                          >\n                            <Copy className=\"h-3 w-3 mr-1\" />\n                            Use\n                          </Button>\n                          <Button\n                            size=\"sm\"\n                            variant=\"ghost\"\n                            onClick={() => deleteTemplateMutation.mutate(template.id)}\n                            className=\"text-muted-foreground hover:text-destructive\"\n                            data-testid={`button-delete-template-${template.id}`}\n                          >\n                            <Trash2 className=\"h-3 w-3\" />\n                          </Button>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            )}\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":12461},"client/src/pages/RewardsPage.tsx":{"content":"import { useState } from \"react\";\nimport { DropdownNavigation } from \"@/components/dropdown-navigation\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Award, Trophy, Target, Utensils, Pizza, Salad, Cake, Coffee, Cookie } from \"lucide-react\";\n\ninterface FoodItem {\n  name: string;\n  emoji: string;\n  calories: number;\n}\n\ninterface Category {\n  name: string;\n  icon: string;\n  items: FoodItem[];\n}\n\n// Comprehensive food database organized by category\nconst FOOD_DATABASE: Category[] = [\n  {\n    name: \"Full Meals\",\n    icon: \"ðŸ½ï¸\",\n    items: [\n      { name: \"Full sandwich\", emoji: \"ðŸ¥ª\", calories: 400 },\n      { name: \"Pasta bowl\", emoji: \"ðŸ\", calories: 450 },\n      { name: \"Ramen bowl\", emoji: \"ðŸœ\", calories: 380 },\n      { name: \"Burrito bowl\", emoji: \"ðŸŒ¯\", calories: 420 },\n      { name: \"Large wrap\", emoji: \"ðŸŒ®\", calories: 450 },\n      { name: \"Chicken rice bowl\", emoji: \"ðŸš\", calories: 480 },\n      { name: \"Stir fry noodles\", emoji: \"ðŸ²\", calories: 520 },\n      { name: \"Fried rice plate\", emoji: \"ðŸ›\", calories: 550 },\n      { name: \"Beef bowl\", emoji: \"ðŸ¥©\", calories: 600 },\n      { name: \"Fried chicken meal\", emoji: \"ðŸ—\", calories: 1000 },\n    ]\n  },\n  {\n    name: \"Restaurant Options\",\n    icon: \"ðŸ•\",\n    items: [\n      { name: \"2 slices pizza\", emoji: \"ðŸ•\", calories: 500 },\n      { name: \"Small burger\", emoji: \"ðŸ”\", calories: 480 },\n      { name: \"3 tacos\", emoji: \"ðŸŒ®\", calories: 450 },\n      { name: \"Sushi rolls 8pc\", emoji: \"ðŸ±\", calories: 400 },\n      { name: \"Poke bowl\", emoji: \"ðŸ¥™\", calories: 420 },\n      { name: \"Pad Thai\", emoji: \"ðŸœ\", calories: 550 },\n      { name: \"Falafel wrap\", emoji: \"ðŸ¥™\", calories: 380 },\n      { name: \"Chicken wings 6pc\", emoji: \"ðŸ—\", calories: 540 },\n      { name: \"Fish & chips\", emoji: \"ðŸŸ\", calories: 650 },\n      { name: \"BBQ ribs\", emoji: \"ðŸ–\", calories: 700 },\n    ]\n  },\n  {\n    name: \"Healthy Plates\",\n    icon: \"ðŸ¥—\",\n    items: [\n      { name: \"Large Caesar salad\", emoji: \"ðŸ¥—\", calories: 400 },\n      { name: \"Grilled chicken + veggies\", emoji: \"ðŸ—\", calories: 380 },\n      { name: \"Salmon + quinoa\", emoji: \"ðŸŸ\", calories: 450 },\n      { name: \"Greek salad bowl\", emoji: \"ðŸ¥—\", calories: 320 },\n      { name: \"Turkey sandwich\", emoji: \"ðŸ¥ª\", calories: 350 },\n      { name: \"Veggie stir fry\", emoji: \"ðŸ¥˜\", calories: 300 },\n      { name: \"Egg white omelette\", emoji: \"ðŸ³\", calories: 280 },\n      { name: \"Tuna poke bowl\", emoji: \"ðŸ¥™\", calories: 390 },\n      { name: \"Chicken breast + rice\", emoji: \"ðŸš\", calories: 420 },\n      { name: \"Shrimp salad\", emoji: \"ðŸ¦\", calories: 310 },\n    ]\n  },\n  {\n    name: \"Special Treats\",\n    icon: \"ðŸ°\",\n    items: [\n      { name: \"Ice cream sundae\", emoji: \"ðŸ¨\", calories: 350 },\n      { name: \"Cheesecake slice\", emoji: \"ðŸ°\", calories: 700 },\n      { name: \"Milkshake\", emoji: \"ðŸ¥¤\", calories: 800 },\n      { name: \"2 cupcakes + coffee\", emoji: \"ðŸ§\", calories: 750 },\n      { name: \"3 donuts\", emoji: \"ðŸ©\", calories: 780 },\n      { name: \"Chocolate brownie\", emoji: \"ðŸ«\", calories: 450 },\n      { name: \"Cookie platter\", emoji: \"ðŸª\", calories: 600 },\n      { name: \"Cinnamon roll\", emoji: \"ðŸ¥\", calories: 420 },\n      { name: \"Fruit smoothie bowl\", emoji: \"ðŸ¥¤\", calories: 380 },\n      { name: \"Pancake stack\", emoji: \"ðŸ¥ž\", calories: 520 },\n    ]\n  },\n  {\n    name: \"Healthy Feasts\",\n    icon: \"ðŸ¥™\",\n    items: [\n      { name: \"Large protein bowl\", emoji: \"ðŸ¥—\", calories: 700 },\n      { name: \"Sushi platter\", emoji: \"ðŸ±\", calories: 750 },\n      { name: \"Grilled salmon meal\", emoji: \"ðŸŸ\", calories: 650 },\n      { name: \"Mediterranean plate\", emoji: \"ðŸ¥™\", calories: 680 },\n      { name: \"Buddha bowl\", emoji: \"ðŸ¥—\", calories: 620 },\n      { name: \"Chicken shawarma plate\", emoji: \"ðŸ—\", calories: 720 },\n      { name: \"Veggie curry + rice\", emoji: \"ðŸ›\", calories: 600 },\n      { name: \"Steak + veggies\", emoji: \"ðŸ¥©\", calories: 800 },\n      { name: \"Teriyaki bowl\", emoji: \"ðŸš\", calories: 640 },\n      { name: \"Fish tacos meal\", emoji: \"ðŸŸ\", calories: 580 },\n    ]\n  },\n  {\n    name: \"Snacks & Drinks\",\n    icon: \"ðŸ«\",\n    items: [\n      { name: \"Apple\", emoji: \"ðŸ\", calories: 95 },\n      { name: \"Banana\", emoji: \"ðŸŒ\", calories: 105 },\n      { name: \"Protein bar\", emoji: \"ðŸ«\", calories: 200 },\n      { name: \"Greek yogurt\", emoji: \"ðŸ¥›\", calories: 150 },\n      { name: \"Trail mix handful\", emoji: \"ðŸ¥œ\", calories: 180 },\n      { name: \"Granola bar\", emoji: \"ðŸª\", calories: 140 },\n      { name: \"Coffee + muffin\", emoji: \"â˜•\", calories: 320 },\n      { name: \"Latte + cookie\", emoji: \"â˜•\", calories: 280 },\n      { name: \"Fruit smoothie\", emoji: \"ðŸ¥¤\", calories: 250 },\n      { name: \"Avocado toast\", emoji: \"ðŸ¥‘\", calories: 300 },\n      { name: \"Hummus + pita\", emoji: \"ðŸ¥™\", calories: 220 },\n      { name: \"Cheese + crackers\", emoji: \"ðŸ§€\", calories: 240 },\n    ]\n  }\n];\n\ninterface RewardResult {\n  calories: number;\n  categories: {\n    name: string;\n    icon: string;\n    items: Array<{ name: string; emoji: string; calories: number }>;\n  }[];\n}\n\nexport default function RewardsPage() {\n  const [steps, setSteps] = useState<string>(\"\");\n  const [reward, setReward] = useState<RewardResult | null>(null);\n\n  const calculateReward = () => {\n    const stepsNum = parseInt(steps) || 0;\n    const earnedCalories = Math.round(stepsNum * 0.04); // approx kcal per step\n\n    // Filter items that are at or below earned calories and organize by category\n    const categorizedRewards = FOOD_DATABASE.map(category => ({\n      name: category.name,\n      icon: category.icon,\n      items: category.items.filter(item => item.calories <= earnedCalories)\n    })).filter(category => category.items.length > 0); // Only show categories with available items\n\n    setReward({\n      calories: earnedCalories,\n      categories: categorizedRewards\n    });\n  };\n\n  const handleKeyPress = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      calculateReward();\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen pb-20\" style={{background: 'var(--bg-gradient)'}}>\n      {/* Header */}\n      <div className=\"px-4 pt-8 pb-6 text-center\">\n        <div className=\"flex items-center justify-center space-x-3 mb-2\">\n          <Award className=\"h-8 w-8 text-white\" />\n          <h1 className=\"text-4xl font-bold text-white\">Rewards</h1>\n          <Trophy className=\"h-8 w-8 text-white\" />\n        </div>\n        <p className=\"text-lg text-white/90\">Convert your steps into earned calories!</p>\n      </div>\n\n      {/* Main Content */}\n      <div className=\"max-w-md mx-auto px-4 space-y-4\">\n        <Card className=\"bg-white/95 dark:bg-gray-900/95 backdrop-blur-md border-white/20 shadow-2xl\">\n          <CardHeader className=\"text-center pb-4\">\n            <CardTitle className=\"text-2xl font-bold bg-gradient-to-r from-purple-600 to-orange-500 bg-clip-text text-transparent\">\n              Steps Reward Calculator\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            {/* Steps Input */}\n            <div className=\"space-y-3\">\n              <label htmlFor=\"stepsInput\" className=\"block text-lg font-semibold text-foreground\">\n                Enter steps today:\n              </label>\n              <Input\n                id=\"stepsInput\"\n                type=\"number\"\n                placeholder=\"e.g. 12000\"\n                value={steps}\n                onChange={(e) => setSteps(e.target.value)}\n                onKeyPress={handleKeyPress}\n                className=\"text-lg py-3 px-4 border-2 focus:border-purple-500 focus:ring-purple-500\"\n                data-testid=\"input-steps\"\n              />\n            </div>\n\n            {/* Calculate Button */}\n            <Button\n              onClick={calculateReward}\n              className=\"w-full py-3 text-lg font-bold bg-gradient-to-r from-purple-600 to-orange-500 hover:from-purple-700 hover:to-orange-600 text-white border-0 shadow-lg\"\n              data-testid=\"button-calculate\"\n            >\n              <Target className=\"h-5 w-5 mr-2\" />\n              Calculate Reward\n            </Button>\n          </CardContent>\n        </Card>\n\n        {/* Results - Categorized Display */}\n        {reward && (\n          <div className=\"space-y-4\">\n            {/* Celebration Header */}\n            <Card className=\"bg-white/95 dark:bg-gray-900/95 backdrop-blur-md border-white/20 shadow-2xl\">\n              <CardContent className=\"pt-6\">\n                <div className=\"text-center\">\n                  <div className=\"text-3xl font-bold mb-2\">\n                    <span className=\"text-purple-600\">ðŸŽ‰ You earned</span>\n                    <div className=\"text-4xl text-orange-500 my-1\">{reward.calories} kcal!</div>\n                  </div>\n                  <p className=\"text-base text-muted-foreground\">\n                    Here are some reward ideas organized by category\n                  </p>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Category Sections - Scrollable */}\n            <div className=\"space-y-4 max-h-[500px] overflow-y-auto pr-1\" data-testid=\"reward-categories\">\n              {reward.categories.map((category, categoryIndex) => (\n                <div key={categoryIndex} className=\"space-y-2\">\n                  {/* Category Header */}\n                  <div className=\"flex items-center space-x-2 sticky top-0 bg-gradient-to-r from-purple-600/90 to-orange-500/90 backdrop-blur-sm px-4 py-2 rounded-lg shadow-md z-10\">\n                    <span className=\"text-2xl\">{category.icon}</span>\n                    <h3 className=\"text-lg font-bold text-white\">{category.name}</h3>\n                  </div>\n\n                  {/* Category Items */}\n                  <div className=\"space-y-2\">\n                    {category.items.map((item, itemIndex) => (\n                      <Card \n                        key={itemIndex}\n                        className=\"bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm border-purple-100 dark:border-purple-800 shadow-sm hover:shadow-md transition-shadow\"\n                        data-testid={`reward-item-${categoryIndex}-${itemIndex}`}\n                      >\n                        <CardContent className=\"p-3\">\n                          <div className=\"flex items-center justify-between\">\n                            <div className=\"flex items-center space-x-3\">\n                              <span className=\"text-2xl\">{item.emoji}</span>\n                              <span className=\"text-base font-medium text-foreground\">\n                                {item.name}\n                              </span>\n                            </div>\n                            <span className=\"text-sm font-semibold text-orange-600 dark:text-orange-400\">\n                              ({item.calories} kcal)\n                            </span>\n                          </div>\n                        </CardContent>\n                      </Card>\n                    ))}\n                  </div>\n                </div>\n              ))}\n            </div>\n\n            {reward.categories.length === 0 && (\n              <Card className=\"bg-white/95 dark:bg-gray-900/95 backdrop-blur-md border-white/20 shadow-xl\">\n                <CardContent className=\"pt-6\">\n                  <div className=\"text-center text-muted-foreground\">\n                    <p className=\"text-lg\">Take more steps to unlock rewards! ðŸš¶â€â™‚ï¸</p>\n                    <p className=\"text-sm mt-2\">Aim for at least 2,500 steps to see your first rewards.</p>\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n          </div>\n        )}\n      </div>\n\n      <DropdownNavigation />\n    </div>\n  );\n}","size_bytes":11888},"server/storage.ts":{"content":"import { type FoodAnalysis, type InsertFoodAnalysis, type DetectedFood, type DiaryEntry, type DiaryEntryWithAnalysis, type InsertDiaryEntry, type WaterIntake, type InsertWaterIntake, type DrinkEntry, type InsertDrinkEntry, type WeightEntry, type InsertWeightEntry, type StepEntry, type InsertStepEntry, type User, type UpsertUser, type NutritionGoals, type InsertNutritionGoals, type UserProfile, type InsertUserProfile, type SimpleFoodEntry, type InsertSimpleFoodEntry, type FoodConfirmation, type InsertFoodConfirmation, type UpdateFoodConfirmation, type Reflection, type InsertReflection, type Challenge, type InsertChallenge, type UserChallengeProgress, type InsertUserChallengeProgress, type ChallengeWithProgress, type ShoppingListItem, type InsertShoppingListItem, type UpdateShoppingListItem, type ShiftSchedule, type InsertShiftSchedule, foodAnalyses, diaryEntries, waterIntake, drinkEntries, weightEntries, stepEntries, users, nutritionGoals, userProfiles, simpleFoodEntries, foodConfirmations, reflections, challenges, userChallengeProgress, shoppingListItems, shiftSchedules } from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { eq, desc, and, gte, lt } from \"drizzle-orm\";\n\nexport interface IStorage {\n  getFoodAnalysis(id: string): Promise<FoodAnalysis | undefined>;\n  createFoodAnalysis(analysis: InsertFoodAnalysis): Promise<FoodAnalysis>;\n  updateFoodAnalysis(id: string, updates: Partial<InsertFoodAnalysis>): Promise<FoodAnalysis | undefined>;\n  getAllFoodAnalyses(): Promise<FoodAnalysis[]>;\n  \n  // User methods (for authentication)\n  getUser(id: string): Promise<User | undefined>;\n  upsertUser(user: UpsertUser): Promise<User>;\n  \n  // Diary methods\n  createDiaryEntry(entry: InsertDiaryEntry): Promise<DiaryEntry>;\n  getDiaryEntries(userId?: string, limit?: number): Promise<DiaryEntryWithAnalysis[]>;\n  getDiaryEntry(id: string): Promise<DiaryEntryWithAnalysis | undefined>;\n  updateDiaryEntry(id: string, entry: Partial<InsertDiaryEntry>): Promise<DiaryEntry | undefined>;\n  deleteDiaryEntry(id: string): Promise<boolean>;\n  \n  // Enhanced diary methods\n  searchDiaryEntries(userId: string, query: string): Promise<DiaryEntryWithAnalysis[]>;\n  getDiaryEntriesByDateRange(userId: string, startDate: Date, endDate: Date): Promise<DiaryEntryWithAnalysis[]>;\n  \n  // Water intake methods\n  createWaterIntake(entry: InsertWaterIntake): Promise<WaterIntake>;\n  getWaterIntakeByDate(userId: string, date: string): Promise<WaterIntake[]>;\n  deleteWaterIntake(id: string, userId: string): Promise<boolean>;\n  \n  // Drink methods\n  createDrinkEntry(entry: InsertDrinkEntry): Promise<DrinkEntry>;\n  getDrinkEntries(userId?: string, limit?: number): Promise<DrinkEntry[]>;\n  getDrinkEntry(id: string): Promise<DrinkEntry | undefined>;\n  deleteDrinkEntry(id: string): Promise<boolean>;\n  \n  // Weight methods\n  createWeightEntry(entry: InsertWeightEntry): Promise<WeightEntry>;\n  getWeightEntries(userId: string, options?: { start?: Date; end?: Date; limit?: number }): Promise<WeightEntry[]>;\n  getWeightEntry(id: string): Promise<WeightEntry | undefined>;\n  updateWeightEntry(id: string, entry: Partial<InsertWeightEntry>): Promise<WeightEntry | undefined>;\n  deleteWeightEntry(id: string): Promise<boolean>;\n  \n  // Step methods\n  createStepEntry(entry: InsertStepEntry): Promise<StepEntry>;\n  getTodaySteps(userId: string): Promise<StepEntry | undefined>;\n  getStepEntries(userId: string, options?: { start?: Date; end?: Date; limit?: number }): Promise<StepEntry[]>;\n  updateTodaySteps(userId: string, stepCount: number): Promise<StepEntry>;\n  \n  // Nutrition goals methods\n  getNutritionGoals(userId: string): Promise<NutritionGoals | undefined>;\n  upsertNutritionGoals(goals: InsertNutritionGoals): Promise<NutritionGoals>;\n  \n  // User profile methods\n  getUserProfile(userId: string): Promise<UserProfile | undefined>;\n  upsertUserProfile(profile: InsertUserProfile): Promise<UserProfile>;\n  \n  // Shift schedule methods for weekly meal planning\n  getShiftSchedules(userId: string, startDate: string, endDate: string): Promise<ShiftSchedule[]>;\n  getShiftSchedule(userId: string, date: string): Promise<ShiftSchedule | undefined>;\n  upsertShiftSchedule(schedule: InsertShiftSchedule): Promise<ShiftSchedule>;\n  deleteShiftSchedule(userId: string, date: string): Promise<boolean>;\n  \n  // Simple food entry methods (for mobile app compatibility)\n  createSimpleFoodEntry(entry: InsertSimpleFoodEntry): Promise<SimpleFoodEntry>;\n  getSimpleFoodEntries(userId: string, limit?: number): Promise<SimpleFoodEntry[]>;\n  \n  // Food confirmation methods (for confidence threshold workflow)\n  createFoodConfirmation(confirmation: InsertFoodConfirmation): Promise<FoodConfirmation>;\n  getFoodConfirmation(id: string): Promise<FoodConfirmation | undefined>;\n  getFoodConfirmationsByUser(userId: string, status?: string): Promise<FoodConfirmation[]>;\n  updateFoodConfirmation(id: string, updates: UpdateFoodConfirmation): Promise<FoodConfirmation | undefined>;\n  deleteFoodConfirmation(id: string): Promise<boolean>;\n  \n  // Reflection methods (for AI-powered daily/weekly insights)\n  createReflection(reflection: InsertReflection): Promise<Reflection>;\n  getReflection(id: string): Promise<Reflection | undefined>;\n  getReflectionsByUser(userId: string, period?: 'daily' | 'weekly'): Promise<Reflection[]>;\n  getLatestReflection(userId: string, period: 'daily' | 'weekly'): Promise<Reflection | undefined>;\n  updateReflectionShared(id: string, shareChannel: string): Promise<Reflection | undefined>;\n  deleteTodayReflection(userId: string, period: 'daily' | 'weekly'): Promise<boolean>;\n  \n  // Gamification methods (challenges and rewards)\n  getAllChallenges(): Promise<Challenge[]>;\n  getChallenge(id: string): Promise<Challenge | undefined>;\n  getChallengeByKey(challengeKey: string): Promise<Challenge | undefined>;\n  getUserChallengeProgress(userId: string, challengeId: string): Promise<UserChallengeProgress | undefined>;\n  getUserAllChallengesProgress(userId: string): Promise<ChallengeWithProgress[]>;\n  createOrUpdateProgress(userId: string, challengeId: string, increment: number): Promise<UserChallengeProgress>;\n  completeChallenge(userId: string, challengeId: string): Promise<UserChallengeProgress | undefined>;\n  getUserCompletedChallenges(userId: string): Promise<ChallengeWithProgress[]>;\n  getUserPoints(userId: string): Promise<number>;\n  \n  // Shopping list methods\n  getShoppingList(userId: string): Promise<ShoppingListItem[]>;\n  addShoppingItem(item: InsertShoppingListItem): Promise<ShoppingListItem>;\n  updateShoppingItem(id: string, userId: string, updates: UpdateShoppingListItem): Promise<ShoppingListItem | undefined>;\n  deleteShoppingItem(id: string, userId: string): Promise<boolean>;\n  clearShoppingList(userId: string): Promise<boolean>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  async getFoodAnalysis(id: string): Promise<FoodAnalysis | undefined> {\n    const [analysis] = await db.select().from(foodAnalyses).where(eq(foodAnalyses.id, id));\n    return analysis || undefined;\n  }\n\n  async createFoodAnalysis(insertAnalysis: InsertFoodAnalysis): Promise<FoodAnalysis> {\n    const [analysis] = await db\n      .insert(foodAnalyses)\n      .values({\n        imageUrl: insertAnalysis.imageUrl,\n        confidence: insertAnalysis.confidence,\n        totalCalories: insertAnalysis.totalCalories,\n        totalProtein: insertAnalysis.totalProtein,\n        totalCarbs: insertAnalysis.totalCarbs,\n        totalFat: insertAnalysis.totalFat,\n        detectedFoods: insertAnalysis.detectedFoods as DetectedFood[]\n      })\n      .returning();\n    return analysis;\n  }\n\n  async updateFoodAnalysis(id: string, updates: Partial<InsertFoodAnalysis>): Promise<FoodAnalysis | undefined> {\n    // Only set fields that are actually provided in updates to avoid nulling existing data\n    const setClause: any = {};\n    \n    if (updates.imageUrl !== undefined) setClause.imageUrl = updates.imageUrl;\n    if (updates.confidence !== undefined) setClause.confidence = updates.confidence;\n    if (updates.totalCalories !== undefined) setClause.totalCalories = updates.totalCalories;\n    if (updates.totalProtein !== undefined) setClause.totalProtein = updates.totalProtein;\n    if (updates.totalCarbs !== undefined) setClause.totalCarbs = updates.totalCarbs;\n    if (updates.totalFat !== undefined) setClause.totalFat = updates.totalFat;\n    if (updates.detectedFoods !== undefined) setClause.detectedFoods = updates.detectedFoods as DetectedFood[];\n\n    // If no fields to update, return existing analysis\n    if (Object.keys(setClause).length === 0) {\n      return await this.getFoodAnalysis(id);\n    }\n\n    const [analysis] = await db\n      .update(foodAnalyses)\n      .set(setClause)\n      .where(eq(foodAnalyses.id, id))\n      .returning();\n    return analysis || undefined;\n  }\n\n  async getAllFoodAnalyses(): Promise<FoodAnalysis[]> {\n    return await db\n      .select()\n      .from(foodAnalyses)\n      .orderBy(desc(foodAnalyses.createdAt));\n  }\n\n  // User methods for authentication\n  async getUser(id: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.id, id));\n    return user || undefined;\n  }\n\n  async upsertUser(userData: UpsertUser): Promise<User> {\n    // Check if user with this email already exists\n    const [existingUser] = await db\n      .select()\n      .from(users)\n      .where(eq(users.email, userData.email));\n\n    if (existingUser) {\n      // Update existing user\n      const [user] = await db\n        .update(users)\n        .set({\n          ...userData,\n          updatedAt: new Date(),\n        })\n        .where(eq(users.email, userData.email))\n        .returning();\n      return user;\n    } else {\n      // Insert new user\n      const [user] = await db\n        .insert(users)\n        .values(userData)\n        .returning();\n      return user;\n    }\n  }\n\n  async createDiaryEntry(entry: InsertDiaryEntry): Promise<DiaryEntry> {\n    const [diaryEntry] = await db\n      .insert(diaryEntries)\n      .values({\n        ...entry,\n        mealDate: typeof entry.mealDate === 'string' ? new Date(entry.mealDate) : entry.mealDate\n      })\n      .returning();\n    return diaryEntry;\n  }\n\n  async getDiaryEntries(userId?: string, limit = 50): Promise<DiaryEntryWithAnalysis[]> {\n    if (userId) {\n      return await db.query.diaryEntries.findMany({\n        where: eq(diaryEntries.userId, userId),\n        limit,\n        orderBy: desc(diaryEntries.mealDate),\n        with: {\n          analysis: true,\n        },\n      });\n    } else {\n      return await db.query.diaryEntries.findMany({\n        limit,\n        orderBy: desc(diaryEntries.mealDate),\n        with: {\n          analysis: true,\n        },\n      });\n    }\n  }\n\n  async getDiaryEntry(id: string): Promise<DiaryEntryWithAnalysis | undefined> {\n    return await db.query.diaryEntries.findFirst({\n      where: eq(diaryEntries.id, id),\n      with: {\n        analysis: true,\n      },\n    });\n  }\n\n  async updateDiaryEntry(id: string, entry: Partial<InsertDiaryEntry>): Promise<DiaryEntry | undefined> {\n    const updateData: any = { ...entry };\n    if (entry.mealDate) {\n      updateData.mealDate = typeof entry.mealDate === 'string' ? new Date(entry.mealDate) : entry.mealDate;\n    }\n    \n    const [updatedEntry] = await db\n      .update(diaryEntries)\n      .set(updateData)\n      .where(eq(diaryEntries.id, id))\n      .returning();\n    \n    return updatedEntry || undefined;\n  }\n\n  async deleteDiaryEntry(id: string): Promise<boolean> {\n    const result = await db.delete(diaryEntries).where(eq(diaryEntries.id, id));\n    return result.rowCount !== null && result.rowCount > 0;\n  }\n\n  async searchDiaryEntries(userId: string, query: string): Promise<DiaryEntryWithAnalysis[]> {\n    // Search through food analyses for matching food names\n    return await db.query.diaryEntries.findMany({\n      where: eq(diaryEntries.userId, userId),\n      orderBy: desc(diaryEntries.mealDate),\n      with: {\n        analysis: true,\n      },\n    });\n    // Note: Full text search would be implemented with proper database search capabilities\n  }\n\n  async getDiaryEntriesByDateRange(userId: string, startDate: Date, endDate: Date): Promise<DiaryEntryWithAnalysis[]> {\n    return await db.query.diaryEntries.findMany({\n      where: eq(diaryEntries.userId, userId),\n      orderBy: desc(diaryEntries.mealDate),\n      with: {\n        analysis: true,\n      },\n    });\n    // Note: Date range filtering would be implemented with proper where clauses\n  }\n\n  // Water intake methods\n  async createWaterIntake(entry: InsertWaterIntake): Promise<WaterIntake> {\n    const [waterEntry] = await db\n      .insert(waterIntake)\n      .values({\n        ...entry,\n        loggedAt: typeof entry.loggedAt === 'string' ? new Date(entry.loggedAt) : entry.loggedAt\n      })\n      .returning();\n    return waterEntry;\n  }\n\n  async getWaterIntakeByDate(userId: string, date: string): Promise<WaterIntake[]> {\n    return await db\n      .select()\n      .from(waterIntake)\n      .where(\n        and(\n          eq(waterIntake.userId, userId),\n          eq(waterIntake.loggedDate, date)\n        )\n      )\n      .orderBy(desc(waterIntake.loggedAt));\n  }\n\n  async deleteWaterIntake(id: string, userId: string): Promise<boolean> {\n    const result = await db\n      .delete(waterIntake)\n      .where(\n        and(\n          eq(waterIntake.id, id),\n          eq(waterIntake.userId, userId)\n        )\n      );\n    return result.rowCount !== null && result.rowCount > 0;\n  }\n\n  async createDrinkEntry(entry: InsertDrinkEntry): Promise<DrinkEntry> {\n    const [drinkEntry] = await db\n      .insert(drinkEntries)\n      .values({\n        ...entry,\n        loggedAt: typeof entry.loggedAt === 'string' ? new Date(entry.loggedAt) : entry.loggedAt\n      })\n      .returning();\n    return drinkEntry;\n  }\n\n  async getDrinkEntries(userId?: string, limit = 50): Promise<DrinkEntry[]> {\n    if (userId) {\n      return await db\n        .select()\n        .from(drinkEntries)\n        .where(eq(drinkEntries.userId, userId))\n        .orderBy(desc(drinkEntries.loggedAt))\n        .limit(limit);\n    } else {\n      return await db\n        .select()\n        .from(drinkEntries)\n        .orderBy(desc(drinkEntries.loggedAt))\n        .limit(limit);\n    }\n  }\n\n  async getDrinkEntry(id: string): Promise<DrinkEntry | undefined> {\n    const [drinkEntry] = await db.select().from(drinkEntries).where(eq(drinkEntries.id, id));\n    return drinkEntry || undefined;\n  }\n\n  async deleteDrinkEntry(id: string): Promise<boolean> {\n    const result = await db.delete(drinkEntries).where(eq(drinkEntries.id, id));\n    return result.rowCount !== null && result.rowCount > 0;\n  }\n\n  // Weight entry methods\n  async createWeightEntry(entry: InsertWeightEntry): Promise<WeightEntry> {\n    const [weightEntry] = await db\n      .insert(weightEntries)\n      .values({\n        ...entry,\n        loggedAt: typeof entry.loggedAt === 'string' ? new Date(entry.loggedAt) : entry.loggedAt\n      })\n      .returning();\n    return weightEntry;\n  }\n\n  async getWeightEntries(userId: string, options: { start?: Date; end?: Date; limit?: number } = {}): Promise<WeightEntry[]> {\n    const { limit = 100 } = options;\n    return await db\n      .select()\n      .from(weightEntries)\n      .where(eq(weightEntries.userId, userId))\n      .orderBy(desc(weightEntries.loggedAt))\n      .limit(limit);\n    // Note: Date range filtering would be implemented with proper where clauses when needed\n  }\n\n  async getWeightEntry(id: string): Promise<WeightEntry | undefined> {\n    const [weightEntry] = await db.select().from(weightEntries).where(eq(weightEntries.id, id));\n    return weightEntry || undefined;\n  }\n\n  async updateWeightEntry(id: string, updateData: Partial<InsertWeightEntry>): Promise<WeightEntry | undefined> {\n    const processedData: any = { ...updateData };\n    if (processedData.loggedAt && typeof processedData.loggedAt === 'string') {\n      processedData.loggedAt = new Date(processedData.loggedAt);\n    }\n    \n    const [weightEntry] = await db\n      .update(weightEntries)\n      .set(processedData)\n      .where(eq(weightEntries.id, id))\n      .returning();\n    return weightEntry || undefined;\n  }\n\n  async deleteWeightEntry(id: string): Promise<boolean> {\n    const result = await db.delete(weightEntries).where(eq(weightEntries.id, id));\n    return result.rowCount !== null && result.rowCount > 0;\n  }\n\n  // Step entry methods\n  async createStepEntry(entry: InsertStepEntry): Promise<StepEntry> {\n    const [stepEntry] = await db\n      .insert(stepEntries)\n      .values({\n        ...entry,\n        loggedDate: typeof entry.loggedDate === 'string' ? new Date(entry.loggedDate) : entry.loggedDate\n      })\n      .returning();\n    return stepEntry;\n  }\n\n  async getTodaySteps(userId: string): Promise<StepEntry | undefined> {\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    \n    const tomorrow = new Date(today);\n    tomorrow.setDate(tomorrow.getDate() + 1);\n\n    const [stepEntry] = await db\n      .select()\n      .from(stepEntries)\n      .where(\n        and(\n          eq(stepEntries.userId, userId),\n          gte(stepEntries.loggedDate, today),\n          lt(stepEntries.loggedDate, tomorrow\n          )\n        )\n      )\n      .limit(1);\n    \n    return stepEntry || undefined;\n  }\n\n  async getStepEntries(userId: string, options: { start?: Date; end?: Date; limit?: number } = {}): Promise<StepEntry[]> {\n    const { limit = 30 } = options;\n    return await db\n      .select()\n      .from(stepEntries)\n      .where(eq(stepEntries.userId, userId))\n      .orderBy(desc(stepEntries.loggedDate))\n      .limit(limit);\n  }\n\n  async updateTodaySteps(userId: string, stepCount: number): Promise<StepEntry> {\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n\n    // Try to find existing entry for today\n    const existingEntry = await this.getTodaySteps(userId);\n    \n    if (existingEntry) {\n      // Update existing entry\n      const [updated] = await db\n        .update(stepEntries)\n        .set({ \n          stepCount,\n          updatedAt: new Date()\n        })\n        .where(eq(stepEntries.id, existingEntry.id))\n        .returning();\n      return updated;\n    } else {\n      // Create new entry\n      return await this.createStepEntry({\n        userId,\n        stepCount,\n        loggedDate: today,\n        source: 'device'\n      });\n    }\n  }\n\n  // Nutrition goals methods\n  async getNutritionGoals(userId: string): Promise<NutritionGoals | undefined> {\n    const [goals] = await db.select().from(nutritionGoals).where(eq(nutritionGoals.userId, userId));\n    return goals || undefined;\n  }\n\n  async upsertNutritionGoals(goalsData: InsertNutritionGoals): Promise<NutritionGoals> {\n    const [goals] = await db\n      .insert(nutritionGoals)\n      .values(goalsData)\n      .onConflictDoUpdate({\n        target: nutritionGoals.userId,\n        set: {\n          ...goalsData,\n          updatedAt: new Date(),\n        },\n      })\n      .returning();\n    return goals;\n  }\n\n  // User profile methods\n  async getUserProfile(userId: string): Promise<UserProfile | undefined> {\n    const [profile] = await db.select().from(userProfiles).where(eq(userProfiles.userId, userId));\n    return profile || undefined;\n  }\n\n  async upsertUserProfile(profileData: InsertUserProfile): Promise<UserProfile> {\n    const [profile] = await db\n      .insert(userProfiles)\n      .values(profileData)\n      .onConflictDoUpdate({\n        target: userProfiles.userId,\n        set: {\n          ...profileData,\n          updatedAt: new Date(),\n        },\n      })\n      .returning();\n    return profile;\n  }\n\n  // Shift schedule methods for weekly meal planning\n  async getShiftSchedules(userId: string, startDate: string, endDate: string): Promise<ShiftSchedule[]> {\n    const schedules = await db\n      .select()\n      .from(shiftSchedules)\n      .where(\n        and(\n          eq(shiftSchedules.userId, userId),\n          gte(shiftSchedules.shiftDate, startDate),\n          lt(shiftSchedules.shiftDate, endDate)\n        )\n      )\n      .orderBy(shiftSchedules.shiftDate);\n    return schedules;\n  }\n\n  async getShiftSchedule(userId: string, date: string): Promise<ShiftSchedule | undefined> {\n    const [schedule] = await db\n      .select()\n      .from(shiftSchedules)\n      .where(\n        and(\n          eq(shiftSchedules.userId, userId),\n          eq(shiftSchedules.shiftDate, date)\n        )\n      );\n    return schedule || undefined;\n  }\n\n  async upsertShiftSchedule(scheduleData: InsertShiftSchedule): Promise<ShiftSchedule> {\n    // First, try to find an existing schedule for this user and date\n    const existing = await this.getShiftSchedule(scheduleData.userId, scheduleData.shiftDate);\n    \n    if (existing) {\n      // Update existing schedule\n      const [updated] = await db\n        .update(shiftSchedules)\n        .set({\n          ...scheduleData,\n          updatedAt: new Date(),\n        })\n        .where(\n          and(\n            eq(shiftSchedules.userId, scheduleData.userId),\n            eq(shiftSchedules.shiftDate, scheduleData.shiftDate)\n          )\n        )\n        .returning();\n      return updated;\n    } else {\n      // Insert new schedule\n      const [schedule] = await db\n        .insert(shiftSchedules)\n        .values(scheduleData)\n        .returning();\n      return schedule;\n    }\n  }\n\n  async deleteShiftSchedule(userId: string, date: string): Promise<boolean> {\n    const result = await db\n      .delete(shiftSchedules)\n      .where(\n        and(\n          eq(shiftSchedules.userId, userId),\n          eq(shiftSchedules.shiftDate, date)\n        )\n      );\n    return true;\n  }\n\n  // Simple food entry methods (for mobile app compatibility)\n  async createSimpleFoodEntry(entryData: InsertSimpleFoodEntry): Promise<SimpleFoodEntry> {\n    const [entry] = await db\n      .insert(simpleFoodEntries)\n      .values(entryData)\n      .returning();\n    return entry;\n  }\n\n  async getSimpleFoodEntries(userId: string, limit: number = 50): Promise<SimpleFoodEntry[]> {\n    const entries = await db\n      .select()\n      .from(simpleFoodEntries)\n      .where(eq(simpleFoodEntries.userId, userId))\n      .orderBy(desc(simpleFoodEntries.createdAt))\n      .limit(limit);\n    return entries;\n  }\n\n  // Food confirmation methods (for confidence threshold workflow)\n  async createFoodConfirmation(confirmationData: InsertFoodConfirmation): Promise<FoodConfirmation> {\n    const [confirmation] = await db\n      .insert(foodConfirmations)\n      .values({\n        userId: confirmationData.userId,\n        imageUrl: confirmationData.imageUrl,\n        originalConfidence: confirmationData.originalConfidence,\n        suggestedFoods: confirmationData.suggestedFoods as DetectedFood[],\n        alternativeOptions: confirmationData.alternativeOptions as DetectedFood[] | undefined,\n        status: confirmationData.status || 'pending',\n        userFeedback: confirmationData.userFeedback,\n      })\n      .returning();\n    return confirmation;\n  }\n\n  async getFoodConfirmation(id: string): Promise<FoodConfirmation | undefined> {\n    const [confirmation] = await db\n      .select()\n      .from(foodConfirmations)\n      .where(eq(foodConfirmations.id, id));\n    return confirmation || undefined;\n  }\n\n  async getFoodConfirmationsByUser(userId: string, status?: string): Promise<FoodConfirmation[]> {\n    const whereClause = status\n      ? and(eq(foodConfirmations.userId, userId), eq(foodConfirmations.status, status))\n      : eq(foodConfirmations.userId, userId);\n\n    const confirmations = await db\n      .select()\n      .from(foodConfirmations)\n      .where(whereClause)\n      .orderBy(desc(foodConfirmations.createdAt));\n    \n    return confirmations;\n  }\n\n  async updateFoodConfirmation(id: string, updates: UpdateFoodConfirmation): Promise<FoodConfirmation | undefined> {\n    const [confirmation] = await db\n      .update(foodConfirmations)\n      .set({\n        status: updates.status,\n        finalFoods: updates.finalFoods as DetectedFood[],\n        userFeedback: updates.userFeedback,\n        confirmedAt: new Date(),\n      })\n      .where(eq(foodConfirmations.id, id))\n      .returning();\n    return confirmation || undefined;\n  }\n\n  async deleteFoodConfirmation(id: string): Promise<boolean> {\n    const result = await db\n      .delete(foodConfirmations)\n      .where(eq(foodConfirmations.id, id));\n    return result.rowCount !== null && result.rowCount > 0;\n  }\n\n  // Reflection methods\n  async createReflection(reflectionData: InsertReflection): Promise<Reflection> {\n    const [reflection] = await db\n      .insert(reflections)\n      .values({\n        userId: reflectionData.userId,\n        reflectionPeriod: reflectionData.reflectionPeriod,\n        periodStart: typeof reflectionData.periodStart === 'string' ? new Date(reflectionData.periodStart) : reflectionData.periodStart,\n        periodEnd: typeof reflectionData.periodEnd === 'string' ? new Date(reflectionData.periodEnd) : reflectionData.periodEnd,\n        wentWell: reflectionData.wentWell,\n        couldImprove: reflectionData.couldImprove,\n        actionSteps: reflectionData.actionSteps,\n        sentimentScore: reflectionData.sentimentScore,\n        aiProvider: reflectionData.aiProvider,\n        aiModel: reflectionData.aiModel,\n        status: reflectionData.status || 'final',\n      } as any)\n      .returning();\n    return reflection;\n  }\n\n  async getReflection(id: string): Promise<Reflection | undefined> {\n    const [reflection] = await db\n      .select()\n      .from(reflections)\n      .where(eq(reflections.id, id));\n    return reflection || undefined;\n  }\n\n  async getReflectionsByUser(userId: string, period?: 'daily' | 'weekly'): Promise<Reflection[]> {\n    const whereClause = period\n      ? and(eq(reflections.userId, userId), eq(reflections.reflectionPeriod, period))\n      : eq(reflections.userId, userId);\n\n    const userReflections = await db\n      .select()\n      .from(reflections)\n      .where(whereClause)\n      .orderBy(desc(reflections.createdAt));\n    \n    return userReflections;\n  }\n\n  async getLatestReflection(userId: string, period: 'daily' | 'weekly'): Promise<Reflection | undefined> {\n    const [reflection] = await db\n      .select()\n      .from(reflections)\n      .where(and(eq(reflections.userId, userId), eq(reflections.reflectionPeriod, period)))\n      .orderBy(desc(reflections.createdAt))\n      .limit(1);\n    \n    return reflection || undefined;\n  }\n\n  async updateReflectionShared(id: string, shareChannel: string): Promise<Reflection | undefined> {\n    const [reflection] = await db\n      .update(reflections)\n      .set({\n        sharedAt: new Date(),\n        shareChannel: shareChannel,\n      })\n      .where(eq(reflections.id, id))\n      .returning();\n    return reflection || undefined;\n  }\n\n  async deleteTodayReflection(userId: string, period: 'daily' | 'weekly'): Promise<boolean> {\n    // Get today's date range\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    const endOfToday = new Date(today);\n    endOfToday.setHours(23, 59, 59, 999);\n\n    // Delete all reflections created today for this user and period\n    const result = await db\n      .delete(reflections)\n      .where(\n        and(\n          eq(reflections.userId, userId),\n          eq(reflections.reflectionPeriod, period),\n          gte(reflections.createdAt, today),\n          lt(reflections.createdAt, endOfToday)\n        )\n      );\n    \n    return result.rowCount !== null && result.rowCount > 0;\n  }\n\n  // Gamification methods\n  async getAllChallenges(): Promise<Challenge[]> {\n    const allChallenges = await db\n      .select()\n      .from(challenges)\n      .where(eq(challenges.isActive, 1))\n      .orderBy(challenges.difficulty, challenges.rewardPoints);\n    return allChallenges;\n  }\n\n  async getChallenge(id: string): Promise<Challenge | undefined> {\n    const [challenge] = await db\n      .select()\n      .from(challenges)\n      .where(eq(challenges.id, id));\n    return challenge || undefined;\n  }\n\n  async getChallengeByKey(challengeKey: string): Promise<Challenge | undefined> {\n    const [challenge] = await db\n      .select()\n      .from(challenges)\n      .where(eq(challenges.challengeKey, challengeKey));\n    return challenge || undefined;\n  }\n\n  async getUserChallengeProgress(userId: string, challengeId: string): Promise<UserChallengeProgress | undefined> {\n    const [progress] = await db\n      .select()\n      .from(userChallengeProgress)\n      .where(and(\n        eq(userChallengeProgress.userId, userId),\n        eq(userChallengeProgress.challengeId, challengeId)\n      ));\n    return progress || undefined;\n  }\n\n  async getUserAllChallengesProgress(userId: string): Promise<ChallengeWithProgress[]> {\n    const allChallenges = await this.getAllChallenges();\n    \n    const challengesWithProgress: ChallengeWithProgress[] = await Promise.all(\n      allChallenges.map(async (challenge) => {\n        const progress = await this.getUserChallengeProgress(userId, challenge.id);\n        return {\n          ...challenge,\n          progress: progress || undefined,\n        };\n      })\n    );\n    \n    return challengesWithProgress;\n  }\n\n  async createOrUpdateProgress(userId: string, challengeId: string, increment: number): Promise<UserChallengeProgress> {\n    const existingProgress = await this.getUserChallengeProgress(userId, challengeId);\n    \n    if (existingProgress) {\n      const newCount = existingProgress.currentCount + increment;\n      const [updated] = await db\n        .update(userChallengeProgress)\n        .set({\n          currentCount: newCount,\n          lastUpdatedAt: new Date(),\n        })\n        .where(eq(userChallengeProgress.id, existingProgress.id))\n        .returning();\n      return updated;\n    } else {\n      const [newProgress] = await db\n        .insert(userChallengeProgress)\n        .values({\n          userId,\n          challengeId,\n          currentCount: increment,\n          lastUpdatedAt: new Date(),\n        } as any)\n        .returning();\n      return newProgress;\n    }\n  }\n\n  async completeChallenge(userId: string, challengeId: string): Promise<UserChallengeProgress | undefined> {\n    const progress = await this.getUserChallengeProgress(userId, challengeId);\n    \n    if (!progress || progress.isCompleted === 1) {\n      return progress || undefined;\n    }\n\n    const [completed] = await db\n      .update(userChallengeProgress)\n      .set({\n        isCompleted: 1,\n        completedAt: new Date(),\n      })\n      .where(eq(userChallengeProgress.id, progress.id))\n      .returning();\n    \n    return completed || undefined;\n  }\n\n  async getUserCompletedChallenges(userId: string): Promise<ChallengeWithProgress[]> {\n    const completedProgress = await db\n      .select()\n      .from(userChallengeProgress)\n      .where(and(\n        eq(userChallengeProgress.userId, userId),\n        eq(userChallengeProgress.isCompleted, 1)\n      ))\n      .orderBy(desc(userChallengeProgress.completedAt));\n    \n    const challengesWithProgress: ChallengeWithProgress[] = await Promise.all(\n      completedProgress.map(async (progress) => {\n        const challenge = await this.getChallenge(progress.challengeId);\n        if (!challenge) return null;\n        return {\n          ...challenge,\n          progress,\n        };\n      })\n    );\n    \n    return challengesWithProgress.filter((c): c is ChallengeWithProgress => c !== null);\n  }\n\n  async getUserPoints(userId: string): Promise<number> {\n    const completedChallenges = await this.getUserCompletedChallenges(userId);\n    return completedChallenges.reduce((total, challenge) => total + challenge.rewardPoints, 0);\n  }\n\n  // Shopping list methods\n  async getShoppingList(userId: string): Promise<ShoppingListItem[]> {\n    const items = await db\n      .select()\n      .from(shoppingListItems)\n      .where(eq(shoppingListItems.userId, userId))\n      .orderBy(desc(shoppingListItems.createdAt));\n    return items;\n  }\n\n  async addShoppingItem(item: InsertShoppingListItem): Promise<ShoppingListItem> {\n    const [newItem] = await db\n      .insert(shoppingListItems)\n      .values(item)\n      .returning();\n    return newItem;\n  }\n\n  async updateShoppingItem(id: string, userId: string, updates: UpdateShoppingListItem): Promise<ShoppingListItem | undefined> {\n    const [updatedItem] = await db\n      .update(shoppingListItems)\n      .set(updates)\n      .where(and(eq(shoppingListItems.id, id), eq(shoppingListItems.userId, userId)))\n      .returning();\n    return updatedItem || undefined;\n  }\n\n  async deleteShoppingItem(id: string, userId: string): Promise<boolean> {\n    const result = await db\n      .delete(shoppingListItems)\n      .where(and(eq(shoppingListItems.id, id), eq(shoppingListItems.userId, userId)));\n    return result.rowCount !== null && result.rowCount > 0;\n  }\n\n  async clearShoppingList(userId: string): Promise<boolean> {\n    const result = await db\n      .delete(shoppingListItems)\n      .where(eq(shoppingListItems.userId, userId));\n    return result.rowCount !== null && result.rowCount > 0;\n  }\n}\n\nexport const storage = new DatabaseStorage();\n","size_bytes":32964},"client/src/components/comprehensive-calculator-test.tsx":{"content":"import React from 'react';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { CalorieCalculator } from './calorie-calculator';\nimport { \n  calculateNutritionTargets, \n  calculateMacroTargets, \n  validateMacroCalculations,\n  type UserData, \n  type CalculationResult,\n  type MacroTargets\n} from '@/lib/nutrition-calculator';\n\ninterface TestResult {\n  step: string;\n  expected: number | string | boolean;\n  actual: number | string | boolean;\n  passed: boolean;\n  details?: string;\n  category: 'calculation' | 'macro_validation' | 'edge_case' | 'medication';\n}\n\ninterface TestScenario {\n  name: string;\n  data: UserData;\n  expectedBMR?: number;\n  expectedTDEE?: number;\n  description: string;\n}\n\n// Comprehensive test scenarios covering all requirements\nconst testScenarios: TestScenario[] = [\n  {\n    name: \"Male Standard\",\n    data: {\n      age: 30,\n      sex: \"male\",\n      heightCm: 180,\n      currentWeightKg: 80,\n      goalWeightKg: 75,\n      activityLevel: \"moderately_active\",\n      weightGoal: \"lose_weight\",\n      weeklyWeightChangeKg: 0.75,\n      medication: \"none\",\n    },\n    expectedBMR: 1780, // 10*80 + 6.25*180 - 5*30 + 5\n    expectedTDEE: 2759, // 1780 * 1.55\n    description: \"30yo male, 180cm, 80kg â†’ 75kg, moderately active, lose weight\"\n  },\n  {\n    name: \"Female Standard\",\n    data: {\n      age: 25,\n      sex: \"female\",\n      heightCm: 165,\n      currentWeightKg: 65,\n      goalWeightKg: 60,\n      activityLevel: \"lightly_active\",\n      weightGoal: \"lose_weight\",\n      weeklyWeightChangeKg: 0.5,\n      medication: \"none\",\n    },\n    expectedBMR: 1454, // 10*65 + 6.25*165 - 5*25 - 161\n    expectedTDEE: 1999, // 1454 * 1.375\n    description: \"25yo female, 165cm, 65kg â†’ 60kg, lightly active, lose weight\"\n  },\n  {\n    name: \"Male Maintain Weight\",\n    data: {\n      age: 35,\n      sex: \"male\",\n      heightCm: 175,\n      currentWeightKg: 70,\n      goalWeightKg: 70,\n      activityLevel: \"very_active\",\n      weightGoal: \"maintain_weight\",\n      weeklyWeightChangeKg: 0,\n      medication: \"none\",\n    },\n    expectedBMR: 1670, // 10*70 + 6.25*175 - 5*35 + 5\n    expectedTDEE: 2881, // 1670 * 1.725\n    description: \"35yo male, 175cm, 70kg, very active, maintain weight\"\n  },\n  {\n    name: \"Female Gain Weight\",\n    data: {\n      age: 22,\n      sex: \"female\",\n      heightCm: 160,\n      currentWeightKg: 50,\n      goalWeightKg: 55,\n      activityLevel: \"sedentary\",\n      weightGoal: \"gain_weight\",\n      weeklyWeightChangeKg: 0.5,\n      medication: \"none\",\n    },\n    expectedBMR: 1239, // 10*50 + 6.25*160 - 5*22 - 161\n    expectedTDEE: 1487, // 1239 * 1.2\n    description: \"22yo female, 160cm, 50kg â†’ 55kg, sedentary, gain weight\"\n  },\n  {\n    name: \"Ozempic Medication\",\n    data: {\n      age: 45,\n      sex: \"female\",\n      heightCm: 170,\n      currentWeightKg: 90,\n      goalWeightKg: 75,\n      activityLevel: \"moderately_active\",\n      weightGoal: \"lose_weight\",\n      weeklyWeightChangeKg: 1.0,\n      medication: \"ozempic\",\n    },\n    expectedBMR: 1544, // 10*90 + 6.25*170 - 5*45 - 161\n    expectedTDEE: 2393, // 1544 * 1.55\n    description: \"45yo female, 170cm, 90kg â†’ 75kg, moderately active, lose weight, on Ozempic\"\n  },\n  {\n    name: \"Mounjaro Medication\",\n    data: {\n      age: 40,\n      sex: \"male\",\n      heightCm: 185,\n      currentWeightKg: 95,\n      goalWeightKg: 80,\n      activityLevel: \"lightly_active\",\n      weightGoal: \"lose_weight\",\n      weeklyWeightChangeKg: 1.0,\n      medication: \"mounjaro\",\n    },\n    expectedBMR: 1860, // 10*95 + 6.25*185 - 5*40 + 5\n    expectedTDEE: 2558, // 1860 * 1.375\n    description: \"40yo male, 185cm, 95kg â†’ 80kg, lightly active, lose weight, on Mounjaro\"\n  },\n  {\n    name: \"Safety Floor Edge Case\",\n    data: {\n      age: 20,\n      sex: \"female\",\n      heightCm: 150,\n      currentWeightKg: 45,\n      goalWeightKg: 40,\n      activityLevel: \"sedentary\",\n      weightGoal: \"lose_weight\",\n      weeklyWeightChangeKg: 1.0,\n      medication: \"none\",\n    },\n    expectedBMR: 1044, // 10*45 + 6.25*150 - 5*20 - 161\n    expectedTDEE: 1253, // 1044 * 1.2\n    description: \"20yo female, 150cm, 45kg â†’ 40kg, sedentary, aggressive weight loss (should hit safety minimum)\"\n  }\n];\n\nexport function ComprehensiveCalculatorTest() {\n  const [testResults, setTestResults] = React.useState<TestResult[]>([]);\n  const [isRunning, setIsRunning] = React.useState(false);\n  const [selectedScenario, setSelectedScenario] = React.useState<TestScenario>(testScenarios[0]);\n  const [liveCalculatorResults, setLiveCalculatorResults] = React.useState<CalculationResult | null>(null);\n\n  const runCalculationTests = () => {\n    setIsRunning(true);\n    const results: TestResult[] = [];\n\n    testScenarios.forEach((scenario) => {\n      const calculationData = calculateNutritionTargets(scenario.data);\n      \n      // Test BMR calculation\n      if (scenario.expectedBMR) {\n        results.push({\n          step: `${scenario.name} - BMR Calculation`,\n          expected: scenario.expectedBMR,\n          actual: calculationData.bmr,\n          passed: Math.abs(calculationData.bmr - scenario.expectedBMR) < 1,\n          details: `${scenario.description}`,\n          category: 'calculation'\n        });\n      }\n\n      // Test TDEE calculation\n      if (scenario.expectedTDEE) {\n        results.push({\n          step: `${scenario.name} - TDEE Calculation`,\n          expected: scenario.expectedTDEE,\n          actual: calculationData.tdee,\n          passed: Math.abs(calculationData.tdee - scenario.expectedTDEE) < 1,\n          details: `BMR ${calculationData.bmr} Ã— activity multiplier`,\n          category: 'calculation'\n        });\n      }\n\n      // Test target calories logic\n      const targetShouldBeValid = calculationData.targetCalories > 0 && \n                                  (scenario.data.weightGoal !== 'lose_weight' || calculationData.targetCalories >= 1200);\n      results.push({\n        step: `${scenario.name} - Target Calories Valid`,\n        expected: true,\n        actual: targetShouldBeValid,\n        passed: targetShouldBeValid,\n        details: `Target: ${calculationData.targetCalories} cal should be > 0 and >= 1200 for weight loss`,\n        category: 'calculation'\n      });\n\n      // Test medication adjustments specifically\n      if (scenario.data.medication && scenario.data.medication !== 'none' && scenario.data.weightGoal === 'lose_weight') {\n        const maxDeficitExpected = scenario.data.medication === 'mounjaro' ? 850 : 800;\n        const actualDeficit = calculationData.tdee - calculationData.targetCalories;\n        \n        results.push({\n          step: `${scenario.name} - Medication Deficit Cap`,\n          expected: `<= ${maxDeficitExpected}`,\n          actual: actualDeficit,\n          passed: actualDeficit <= maxDeficitExpected,\n          details: `Deficit should not exceed ${maxDeficitExpected} cal/day for ${scenario.data.medication}`,\n          category: 'medication'\n        });\n\n        const minCaloriesExpected = Math.round(calculationData.bmr * 1.1);\n        results.push({\n          step: `${scenario.name} - Medication Minimum Floor`,\n          expected: `>= ${minCaloriesExpected}`,\n          actual: calculationData.targetCalories,\n          passed: calculationData.targetCalories >= minCaloriesExpected,\n          details: `Target should be >= 110% of BMR (${minCaloriesExpected}) for GLP-1 meds`,\n          category: 'medication'\n        });\n      }\n\n      // Test safety minimums for aggressive weight loss\n      if (scenario.data.weightGoal === 'lose_weight') {\n        const expectedMinimum = calculationData.bmr < 1400 ? 1200 : 1500;\n        results.push({\n          step: `${scenario.name} - Safety Minimum`,\n          expected: `>= ${expectedMinimum}`,\n          actual: calculationData.targetCalories,\n          passed: calculationData.targetCalories >= expectedMinimum,\n          details: `Target should not go below ${expectedMinimum} cal safety minimum`,\n          category: 'edge_case'\n        });\n      }\n    });\n\n    setTestResults(results);\n    setIsRunning(false);\n  };\n\n  const runMacroValidationTests = () => {\n    const macroResults: TestResult[] = [];\n\n    testScenarios.forEach((scenario) => {\n      const calculationData = calculateNutritionTargets(scenario.data);\n      const macros = calculateMacroTargets(calculationData.targetCalories, scenario.data.weightGoal);\n      const validation = validateMacroCalculations(macros);\n\n      // Test that macros back-calculate to target calories correctly\n      macroResults.push({\n        step: `${scenario.name} - Macro Back-Calculation`,\n        expected: calculationData.targetCalories,\n        actual: validation.actualCalories,\n        passed: Math.abs(validation.variance) <= 5, // Allow 5 calorie variance for rounding\n        details: `Variance: ${validation.variance} cal (protein: ${macros.dailyProtein}g, carbs: ${macros.dailyCarbs}g, fat: ${macros.dailyFat}g)`,\n        category: 'macro_validation'\n      });\n\n      // Test macro percentages are correct based on weight goal\n      const proteinPercent = (macros.dailyProtein * 4) / macros.dailyCalories;\n      const carbsPercent = (macros.dailyCarbs * 4) / macros.dailyCalories;\n      const fatPercent = (macros.dailyFat * 9) / macros.dailyCalories;\n\n      // Expected percentages vary by weight goal (science-based approach)\n      let expectedProtein = 0.25;\n      let expectedCarbs = 0.40;\n      let expectedFat = 0.35;\n      \n      if (scenario.data.weightGoal === 'lose_weight') {\n        expectedProtein = 0.30;  // Higher protein for weight loss\n        expectedCarbs = 0.35;\n        expectedFat = 0.35;\n      } else if (scenario.data.weightGoal === 'gain_weight') {\n        expectedProtein = 0.25;\n        expectedCarbs = 0.45;\n        expectedFat = 0.30;\n      }\n\n      macroResults.push({\n        step: `${scenario.name} - Protein % (${(expectedProtein * 100).toFixed(0)}%)`,\n        expected: expectedProtein,\n        actual: Number(proteinPercent.toFixed(3)),\n        passed: Math.abs(proteinPercent - expectedProtein) < 0.05,\n        details: `Actual: ${(proteinPercent * 100).toFixed(1)}%, Goal: ${scenario.data.weightGoal}`,\n        category: 'macro_validation'\n      });\n\n      macroResults.push({\n        step: `${scenario.name} - Carbs % (${(expectedCarbs * 100).toFixed(0)}%)`,\n        expected: expectedCarbs,\n        actual: Number(carbsPercent.toFixed(3)),\n        passed: Math.abs(carbsPercent - expectedCarbs) < 0.05,\n        details: `Actual: ${(carbsPercent * 100).toFixed(1)}%, Goal: ${scenario.data.weightGoal}`,\n        category: 'macro_validation'\n      });\n\n      macroResults.push({\n        step: `${scenario.name} - Fat % (${(expectedFat * 100).toFixed(0)}%)`,\n        expected: expectedFat,\n        actual: Number(fatPercent.toFixed(3)),\n        passed: Math.abs(fatPercent - expectedFat) < 0.05,\n        details: `Actual: ${(fatPercent * 100).toFixed(1)}%, Goal: ${scenario.data.weightGoal}`,\n        category: 'macro_validation'\n      });\n    });\n\n    setTestResults([...testResults, ...macroResults]);\n  };\n\n  const handleLiveCalculatorTest = (calories: number) => {\n    console.log('Live calculator produced:', calories);\n    // This gets called when the live calculator completes\n    // We can use this to verify the live calculator matches our expected results\n    const expectedResult = calculateNutritionTargets(selectedScenario.data);\n    setLiveCalculatorResults(expectedResult);\n    \n    const liveResult: TestResult = {\n      step: `Live Calculator - ${selectedScenario.name}`,\n      expected: expectedResult.targetCalories,\n      actual: calories,\n      passed: calories === expectedResult.targetCalories,\n      details: `Live calculator should match shared function results`,\n      category: 'calculation'\n    };\n    \n    setTestResults([...testResults, liveResult]);\n  };\n\n  const getCategoryResults = (category: string) => {\n    return testResults.filter(r => r.category === category);\n  };\n\n  const getCategoryStats = (category: string) => {\n    const categoryResults = getCategoryResults(category);\n    const passed = categoryResults.filter(r => r.passed).length;\n    return { passed, total: categoryResults.length };\n  };\n\n  const allPassed = testResults.length > 0 && testResults.every(r => r.passed);\n\n  return (\n    <div className=\"space-y-6\">\n      <Card className=\"max-w-6xl mx-auto\">\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            ðŸ§® Comprehensive Nutrition Calculator Verification\n          </CardTitle>\n          <CardDescription>\n            End-to-end testing of calculation logic, macro validation, medication adjustments, and live calculator verification\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Tabs defaultValue=\"tests\" className=\"space-y-6\">\n            <TabsList className=\"grid w-full grid-cols-3\">\n              <TabsTrigger value=\"tests\">Test Results</TabsTrigger>\n              <TabsTrigger value=\"live\">Live Calculator Test</TabsTrigger>\n              <TabsTrigger value=\"scenarios\">Test Scenarios</TabsTrigger>\n            </TabsList>\n\n            <TabsContent value=\"tests\" className=\"space-y-6\">\n              <div className=\"flex gap-4 flex-wrap\">\n                <Button \n                  onClick={runCalculationTests} \n                  disabled={isRunning}\n                  data-testid=\"button-run-calculation-tests\"\n                >\n                  {isRunning ? \"Running Tests...\" : \"Run Calculation Tests\"}\n                </Button>\n                <Button \n                  onClick={runMacroValidationTests} \n                  variant=\"outline\"\n                  disabled={testResults.length === 0}\n                  data-testid=\"button-run-macro-tests\"\n                >\n                  Run Macro Validation Tests\n                </Button>\n                <Button \n                  onClick={() => setTestResults([])} \n                  variant=\"outline\"\n                  data-testid=\"button-clear-tests\"\n                >\n                  Clear Results\n                </Button>\n              </div>\n\n              {testResults.length > 0 && (\n                <div className=\"space-y-4\">\n                  <div className=\"grid grid-cols-4 gap-4\">\n                    {['calculation', 'macro_validation', 'medication', 'edge_case'].map(category => {\n                      const stats = getCategoryStats(category);\n                      return (\n                        <Card key={category} className=\"p-4\">\n                          <div className=\"text-center\">\n                            <div className=\"text-2xl font-bold\">\n                              {stats.passed}/{stats.total}\n                            </div>\n                            <div className=\"text-sm text-muted-foreground capitalize\">\n                              {category.replace('_', ' ')}\n                            </div>\n                            <Badge variant={stats.passed === stats.total ? \"default\" : \"destructive\"}>\n                              {stats.passed === stats.total ? \"âœ“ PASS\" : \"âœ— FAIL\"}\n                            </Badge>\n                          </div>\n                        </Card>\n                      );\n                    })}\n                  </div>\n\n                  <div className=\"grid gap-3 max-h-96 overflow-y-auto\">\n                    {testResults.map((result, index) => (\n                      <Card key={index} className={`border-l-4 ${result.passed ? 'border-l-green-500' : 'border-l-red-500'}`}>\n                        <CardContent className=\"p-4\">\n                          <div className=\"flex items-center justify-between mb-2\">\n                            <h4 className=\"font-medium\">{result.step}</h4>\n                            <div className=\"flex gap-2\">\n                              <Badge variant=\"outline\" className=\"text-xs\">\n                                {result.category}\n                              </Badge>\n                              <Badge variant={result.passed ? \"default\" : \"destructive\"}>\n                                {result.passed ? \"âœ“\" : \"âœ—\"}\n                              </Badge>\n                            </div>\n                          </div>\n                          <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                            <div>\n                              <span className=\"text-muted-foreground\">Expected:</span>\n                              <span className=\"ml-2 font-mono\">{String(result.expected)}</span>\n                            </div>\n                            <div>\n                              <span className=\"text-muted-foreground\">Actual:</span>\n                              <span className=\"ml-2 font-mono\">{String(result.actual)}</span>\n                            </div>\n                          </div>\n                          {result.details && (\n                            <div className=\"mt-2 text-sm text-muted-foreground\">\n                              {result.details}\n                            </div>\n                          )}\n                        </CardContent>\n                      </Card>\n                    ))}\n                  </div>\n\n                  {allPassed && (\n                    <div className=\"p-4 bg-green-50 dark:bg-green-950/20 border border-green-200 dark:border-green-800 rounded-lg\">\n                      <div className=\"flex items-center gap-2\">\n                        <span className=\"text-green-600 dark:text-green-400\">âœ…</span>\n                        <span className=\"font-medium text-green-800 dark:text-green-200\">\n                          All calculations verified! The calculator produces mathematically correct results across all scenarios.\n                        </span>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              )}\n            </TabsContent>\n\n            <TabsContent value=\"live\" className=\"space-y-6\">\n              <div className=\"space-y-4\">\n                <div>\n                  <label className=\"text-sm font-medium\">Test Scenario:</label>\n                  <select \n                    value={selectedScenario.name}\n                    onChange={(e) => setSelectedScenario(testScenarios.find(s => s.name === e.target.value) || testScenarios[0])}\n                    className=\"mt-1 block w-full p-2 border rounded-md\"\n                    data-testid=\"select-test-scenario\"\n                  >\n                    {testScenarios.map((scenario) => (\n                      <option key={scenario.name} value={scenario.name}>\n                        {scenario.name} - {scenario.description}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n                \n                <div className=\"p-4 bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 rounded-lg\">\n                  <h3 className=\"font-medium mb-2\">Live Calculator Test</h3>\n                  <p className=\"text-sm text-muted-foreground mb-4\">\n                    This will test the actual CalorieCalculator component with the selected scenario. \n                    Fill in the form with the values and click calculate to verify the live calculator matches our expected results.\n                  </p>\n                  \n                  {liveCalculatorResults && (\n                    <div className=\"mb-4 p-3 bg-white dark:bg-gray-800 rounded border\">\n                      <div className=\"text-sm font-medium\">Expected Results for {selectedScenario.name}:</div>\n                      <div className=\"text-sm text-muted-foreground\">\n                        BMR: {liveCalculatorResults.bmr} cal | TDEE: {liveCalculatorResults.tdee} cal | Target: {liveCalculatorResults.targetCalories} cal\n                      </div>\n                    </div>\n                  )}\n                </div>\n\n                <CalorieCalculator onCaloriesCalculated={handleLiveCalculatorTest} />\n              </div>\n            </TabsContent>\n\n            <TabsContent value=\"scenarios\" className=\"space-y-4\">\n              <div className=\"grid gap-4\">\n                {testScenarios.map((scenario, index) => (\n                  <Card key={index}>\n                    <CardHeader>\n                      <CardTitle className=\"text-lg\">{scenario.name}</CardTitle>\n                      <CardDescription>{scenario.description}</CardDescription>\n                    </CardHeader>\n                    <CardContent>\n                      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm\">\n                        <div><strong>Age:</strong> {scenario.data.age}</div>\n                        <div><strong>Sex:</strong> {scenario.data.sex}</div>\n                        <div><strong>Height:</strong> {scenario.data.heightCm}cm</div>\n                        <div><strong>Weight:</strong> {scenario.data.currentWeightKg}kg â†’ {scenario.data.goalWeightKg}kg</div>\n                        <div><strong>Activity:</strong> {scenario.data.activityLevel}</div>\n                        <div><strong>Goal:</strong> {scenario.data.weightGoal}</div>\n                        <div><strong>Rate:</strong> {scenario.data.weeklyWeightChangeKg}kg/week</div>\n                        <div><strong>Medication:</strong> {scenario.data.medication}</div>\n                      </div>\n                      {scenario.expectedBMR && (\n                        <div className=\"mt-2 text-sm text-muted-foreground\">\n                          Expected BMR: {scenario.expectedBMR} cal | Expected TDEE: {scenario.expectedTDEE} cal\n                        </div>\n                      )}\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            </TabsContent>\n          </Tabs>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":22014},"replit.md":{"content":"# Overview\n\nPlateMate is a full-stack web and native mobile application designed for AI-powered food image analysis. It identifies food items from user-uploaded photos, calculates nutritional information, and provides detailed breakdowns. The application aims to offer a mobile-first, intuitive experience for food scanning and nutrition tracking, available as both a Progressive Web App (PWA) and native iOS/Android applications.\n\n# User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n# System Architecture\n\n## Frontend\n- **Framework**: React 18 with TypeScript, Vite, Wouter for routing.\n- **UI**: Radix UI, shadcn/ui, Tailwind CSS.\n- **State Management**: TanStack Query (React Query).\n- **Form Handling**: React Hook Form with Zod validation.\n- **Mobile Integration**: Capacitor for native iOS/Android apps, camera access, file system access, deep-link handling for OAuth.\n- **Mobile API Configuration**: Dynamic API base URL detection (`client/src/lib/api-config.ts`) that automatically uses full backend URL when running in native Capacitor environment, while using relative URLs in browser. Configured via `VITE_API_BASE_URL` environment variable for production mobile builds.\n- **UI/UX**: Mobile-first responsive design, atomic component architecture, Framer Motion animations, modern aesthetics with gradients.\n\n## Backend\n- **Runtime**: Node.js with Express.js, TypeScript.\n- **API Design**: RESTful API with JSON responses.\n- **File Processing**: Multer for uploads, Sharp for image optimization.\n- **Error Handling**: Centralized middleware.\n\n## Data Storage\n- **Database**: PostgreSQL via Drizzle ORM and Drizzle Kit, integrated with Neon Database.\n- **Current Development**: In-memory storage for rapid prototyping.\n\n## Authentication and Authorization\n- **Method**: Email/Password authentication using @replit/database for user storage.\n- **Session Management**: In-memory session storage with bearer token authentication.\n- **Password Reset**: Security question-based reset with bcrypt-hashed answers and expiring tokens.\n- **User Isolation**: Strict data isolation for all user-specific data.\n- **Mobile OAuth**: Capacitor-compatible flow using system browser with deep-link callbacks and secure bridge tokens.\n\n## Monetization and Subscription\n- **Model**: Free-to-download app with mandatory subscription via Google Play Billing at Â£4.99/month.\n- **Subscription System**: Custom Capacitor plugin (BillingPlugin) using Google Play Billing Library 8.0.0 directly.\n- **Native Implementation**: BillingPlugin.kt handles billing client initialization, subscription checking, and purchase flows.\n- **Feature Gating**: All major features locked until active subscription confirmed via SubscriptionGate component.\n- **Free Trial**: 7-day free trial enabled through Google Play Console, automatically applied at checkout.\n- **Subscription Flow**: On first launch, users see subscription screen before accessing any features.\n- **Validation**: Subscription status checked by querying active purchases via Google Play Billing API.\n- **Frontend Integration**: React SubscriptionContext provides app-wide subscription state with automatic re-validation.\n- **Product ID**: platemate_pro_monthly (configured in Google Play Console).\n- **Purchase Handling**: Plugin properly handles all purchase states (purchased, pending, cancelled, errors) with proper promise resolution.\n\n## AI Services\n- **Multi-Provider System**: Supports OpenAI (GPT-4o-mini, GPT-5) and Google Gemini (Flash/Pro) with automatic failover, health monitoring, and load balancing.\n- **Core Functionality**: Food recognition, nutritional analysis, quantity detection, UK-to-US food term mapping.\n- **User Interaction**: Comprehensive food analysis editing with real-time nutrition recalculation.\n  - **Streamlined Save Flow**: Combined \"Save Changes\" and \"Add to Diary\" into a single \"Save to Diary\" action that saves analysis edits and creates diary entry in one click\n  - **Improved UI Contrast**: Food cards redesigned with lighter purple/white gradients for better text readability on mobile devices\n  - **Auto-save on Diary**: Edits to food items are automatically saved when adding to diary, eliminating confusion about unsaved changes\n- **AI Daily Reflections**: AI-powered daily nutrition insights based on user data.\n- **Scan-a-Menu Feature**: QR code scanning for restaurant menus with AI-powered meal recommendations.\n  - **Security**: Domain allowlist system prevents SSRF attacks while enabling automatic fetching from trusted platforms\n  - **Allowlisted Domains**: Squarespace, Wix, WordPress, Shopify, and 11 other common restaurant menu hosting platforms\n  - **Domain Validation**: Exact match or true subdomain matching (e.g., `menu.squarespace.com` allowed, `evilsquarespace.com` rejected)\n  - **Additional Protections**: No redirect following, private IP blocking, 10-second timeout, content-type validation\n  - **Fallback Workflow**: Non-allowlisted URLs gracefully fall back to manual text input with clear user guidance\n- **AI Coach Personalization**: User profile data used to tailor AI advice, respecting dietary restrictions and allergies.\n- **AI Coach Avatar System**: Visual avatar interface with 5 distinct personalities (Military Drill Sergeant, Friendly Gym Bro, Zen Wellness Coach, Clinical Expert, Dark Humour), featuring animated avatars with personality-specific color schemes, breathing animations, particle effects, and thinking indicators. Optimized WebP images (93% size reduction) with lazy loading for mobile performance.\n\n## Key Design Decisions\n- **Mobile-First**: Optimized for mobile food scanning.\n- **Type Safety**: End-to-end TypeScript.\n- **Image Handling**: Client-side compression and server-side optimization.\n- **Extensible AI**: Architecture supports various external food recognition APIs.\n- **Development Experience**: Hot reloading, TypeScript checking, integrated error overlays.\n- **Barcode Scanning**: Full-screen camera barcode scanning using BarcodeDetector API and ZXing fallback, integrated with OpenFoodFacts API.\n- **Gamification**: Challenges and rewards system for user engagement.\n- **Activity Tracking**: Integrated step counter with rewards, using Capacitor-health plugin.\n- **Unified Theme**: Consistent vibrant purple color scheme across the application.\n- **Weekly Shift Planner**: Advanced scheduling system for shift workers (especially NHS/frontline workers) that generates AI-optimized meal plans based on work schedules. Features include:\n  - Calendar view for 7-day shift scheduling (day/night/evening/rotating/custom shifts)\n  - Break window customization and custom shift timing support\n  - AI-powered meal plan generation with shift-specific optimization for timing, portability, and nutrition\n  - Meal strategies considering pre-shift energy, during-shift sustainability, and post-shift recovery\n  - Portability classifications (portable, meal-prep-friendly, home-only) for on-the-go workers\n  - Comprehensive meal cards with nutrition breakdown, ingredients, benefits, and shift-specific tips\n  - Database persistence using PostgreSQL (shiftSchedules table)\n  - Full test coverage with data-testid attributes on all interactive and dynamic elements\n- **Unified Fluid Tracking**: Comprehensive hydration monitoring system with drink-type tracking integrated into the diary page. Features include:\n  - Progress bar displaying consumed vs. daily goal (ml and percentage)\n  - Drink-type quick-add buttons: Water (250ml), Coffee (240ml), Tea (200ml), Wine (150ml), Beer (355ml) with color-coded icons\n  - Custom amount input with validation (1-5000ml range)\n  - Daily log showing all entries with drink type icons, names, amounts, timestamps, and delete functionality\n  - Editable daily fluid goal (1-10000ml range)\n  - Smart goal calculation: Default 2500ml, auto-adjusts to 1500ml for users with fluid-restricting medical conditions (kidney disease, heart failure, fluid retention)\n  - Drink type normalization: Legacy drink types (juice, soda, etc.) automatically mapped to \"custom\" for consistency\n  - Database table (waterIntake) with drinkType and drinkName fields for unified fluid tracking\n  - Complete authentication and user data isolation\n  - Full test coverage with data-testid attributes\n\n# External Dependencies\n\n- **AI Services**: OpenAI API, Google Gemini API\n- **Database**: Neon Database (PostgreSQL)\n- **Image Processing**: Sharp\n- **UI Icons**: Lucide React, Font Awesome\n- **Fonts**: Google Fonts\n- **Mobile Platform**: Capacitor (for iOS/Android native app deployment)\n- **Barcode Data**: OpenFoodFacts API\n- **Social Sharing**: `dom-to-image-more` library, Web Share API\n- **Health Tracking**: `capacitor-health` plugin\n- **Billing**: Custom Capacitor plugin using Google Play Billing Library 8.0.0 for subscription management\n\n# Android App Build & Deployment\n\n## Development vs Production Mode\n\n**Important:** Native plugins (BillingPlugin, Camera, etc.) ONLY work when the app loads **local bundled files** from `capacitor://localhost`.\n\n### Development Mode (Live Reload)\n- Clicking \"Run\" (â–¶ï¸) in Android Studio enables **live reload** which connects to Replit dev server\n- Logs show package: `com.replit.app` and `[vite] connecting`\n- Native plugins return `UNIMPLEMENTED` error\n- **Use for:** UI/frontend development with hot reload\n\n### Production Mode (Local Files)\n- App loads from `capacitor://localhost` using bundled assets\n- Logs show package: `com.georgebrennan.platemate3` and `BillingPlugin loaded`\n- Native plugins work correctly (billing, camera, etc.)\n- **Use for:** Testing native features, building releases\n\n## Building for Production\n\n### 1. Build Production Web Assets\n```bash\nnpm run build\n```\nThis creates optimized production files in `dist/public/`\n\n### 2. Configure Backend API URL\n**CRITICAL**: Before building, ensure the mobile app knows where to find your backend API:\n\n1. The app needs the full URL of your Replit backend server\n2. Set the `VITE_API_BASE_URL` environment variable in `.env` file:\n   ```bash\n   VITE_API_BASE_URL=https://your-actual-replit-url.repl.co\n   ```\n3. Replace `your-actual-replit-url` with your real Replit workspace URL\n4. This URL is embedded into the production build so the mobile app can reach your backend\n\n**Why this is needed:**\n- Web version: API calls use relative URLs like `/api/...` (works automatically)\n- Mobile version: Loads from `capacitor://localhost`, needs full backend URL\n- Without this configuration, all AI features will fail with \"high demand\" errors\n\n### 3. Sync to Android\n```bash\nnpx cap sync android\n```\n\nThis command:\n- Copies production build from `dist/public` to `android/app/src/main/assets/public`\n- Updates native plugin registrations\n- Generates `capacitor.config.json` in Android assets\n- **Ensures app loads local files instead of dev server**\n- **Includes the VITE_API_BASE_URL in the bundled code**\n\n### 4. Build the Android App\nThe Android app must be rebuilt using Android Studio to activate native plugins like Google Play Billing:\n\n1. **Open in Android Studio**:\n   - Open the `android/` folder in Android Studio\n   - Wait for Gradle sync to complete\n\n2. **Build APK** (for testing):\n   - Build â†’ Build Bundle(s) / APK(s) â†’ Build APK(s)\n   - APK will be in `android/app/build/outputs/apk/`\n\n3. **Build AAB** (for Google Play):\n   - Build â†’ Build Bundle(s) / APK(s) â†’ Build Bundle(s)\n   - AAB will be in `android/app/build/outputs/bundle/`\n\n4. **Run on Device**:\n   - Connect Android device via USB with debugging enabled\n   - Click Run (green play button) in Android Studio\n   - App will install and launch on device\n\n## Debugging Native Plugins\nView native Android logs using Android Studio's Logcat:\n- Filter by tag: `Purchases` for RevenueCat billing-related logs\n- JavaScript logs visible in browser console with emoji markers: ðŸš€ (loading), âœ… (success), âŒ (error)\n\n## Google Play Console Setup Required\nFor billing to work, the app must be:\n1. Uploaded to Google Play Console (Internal Testing or Production)\n2. Subscription product `platemate_pro_monthly` created with 7-day free trial\n3. Installed from Google Play (not sideloaded APK)\n4. Signed with the release keystore configured in Google Play\n\n**Note**: Billing will NOT work in development APKs or when sideloaded. Testing requires Google Play Internal Testing track.","size_bytes":12354},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border-2 border-gray-300 bg-white dark:bg-gray-800 text-gray-900 dark:text-white p-6 shadow-2xl backdrop-blur-sm duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4498},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3895},"client/src/components/error-boundary.tsx":{"content":"import { Component, ReactNode } from 'react';\n\ninterface Props {\n  children: ReactNode;\n  fallback?: ReactNode;\n}\n\ninterface State {\n  hasError: boolean;\n  error?: Error;\n}\n\nexport class ErrorBoundary extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError(error: Error): State {\n    console.error('ðŸš¨ React Error Boundary caught error:', error);\n    return { hasError: true, error };\n  }\n\n  componentDidCatch(error: Error, errorInfo: any) {\n    console.error('ðŸš¨ Error details:', error, errorInfo);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return this.props.fallback || (\n        <div className=\"min-h-screen flex items-center justify-center p-4\" style={{background: 'var(--bg-gradient)'}}>\n          <div className=\"bg-white/10 backdrop-blur-sm rounded-xl p-6 max-w-md text-center\">\n            <h2 className=\"text-xl font-bold text-white mb-2\">âš ï¸ Something went wrong</h2>\n            <p className=\"text-gray-300 mb-4\">The app encountered an error. Please refresh the page.</p>\n            <button\n              onClick={() => window.location.reload()}\n              className=\"bg-blue-600 hover:bg-blue-500 text-white px-6 py-2 rounded-lg font-medium\"\n            >\n              Reload App\n            </button>\n          </div>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n","size_bytes":1428},"client/src/pages/InjectionAdvicePage.tsx":{"content":"import { ArrowLeft, Syringe, AlertTriangle, Heart, Apple, Clock, Users, CheckCircle, Info, Shield } from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { DropdownNavigation } from \"@/components/dropdown-navigation\";\n\nexport default function InjectionAdvicePage() {\n  return (\n    <div className=\"min-h-screen bg-background p-4 space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center gap-4 mb-6\">\n        <Link href=\"/\">\n          <button \n            className=\"p-2 hover:bg-muted rounded-lg transition-colors\"\n            data-testid=\"button-back-home\"\n          >\n            <ArrowLeft className=\"h-5 w-5\" />\n          </button>\n        </Link>\n        <div>\n          <h1 className=\"text-2xl font-bold\">Weight Loss Injection Guide</h1>\n          <p className=\"text-muted-foreground\">Tips and advice for GLP-1 medications</p>\n        </div>\n      </div>\n\n      {/* Important Disclaimer */}\n      <Alert className=\"border-red-200 bg-red-50 dark:border-red-900 dark:bg-red-900/20\">\n        <AlertTriangle className=\"h-4 w-4 text-red-600\" />\n        <AlertDescription className=\"text-red-700 dark:text-red-300\">\n          <strong>Medical Disclaimer:</strong> This information is for educational purposes only. \n          Always consult your healthcare provider before starting, stopping, or changing any medication. \n          Never adjust dosages without medical supervision.\n        </AlertDescription>\n      </Alert>\n\n      {/* Common Medications */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Syringe className=\"h-5 w-5\" />\n            Common GLP-1 Medications\n          </CardTitle>\n          <CardDescription>\n            Popular prescription weight loss injection medications\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n            <div className=\"p-4 border rounded-lg\">\n              <h4 className=\"font-semibold text-blue-600\">OzempicÂ® (Semaglutide)</h4>\n              <p className=\"text-sm text-muted-foreground mt-1\">Weekly injection for diabetes and weight management</p>\n              <Badge variant=\"secondary\" className=\"mt-2\">0.25mg - 2mg</Badge>\n            </div>\n            <div className=\"p-4 border rounded-lg\">\n              <h4 className=\"font-semibold text-green-600\">WegovyÂ® (Semaglutide)</h4>\n              <p className=\"text-sm text-muted-foreground mt-1\">Higher dose specifically for weight management</p>\n              <Badge variant=\"secondary\" className=\"mt-2\">0.25mg - 2.4mg</Badge>\n            </div>\n            <div className=\"p-4 border rounded-lg\">\n              <h4 className=\"font-semibold text-purple-600\">MounjaroÂ® (Tirzepatide)</h4>\n              <p className=\"text-sm text-muted-foreground mt-1\">Dual-action diabetes and weight medication</p>\n              <Badge variant=\"secondary\" className=\"mt-2\">2.5mg - 15mg</Badge>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* How They Work */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Info className=\"h-5 w-5\" />\n            How GLP-1 Medications Work\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-4\">\n            <div className=\"flex items-start gap-3\">\n              <CheckCircle className=\"h-5 w-5 text-green-600 mt-0.5\" />\n              <div>\n                <h4 className=\"font-medium\">Appetite Suppression</h4>\n                <p className=\"text-sm text-muted-foreground\">Signals to your brain that you're full, reducing food cravings</p>\n              </div>\n            </div>\n            <div className=\"flex items-start gap-3\">\n              <CheckCircle className=\"h-5 w-5 text-green-600 mt-0.5\" />\n              <div>\n                <h4 className=\"font-medium\">Slower Gastric Emptying</h4>\n                <p className=\"text-sm text-muted-foreground\">Food stays in your stomach longer, keeping you satisfied</p>\n              </div>\n            </div>\n            <div className=\"flex items-start gap-3\">\n              <CheckCircle className=\"h-5 w-5 text-green-600 mt-0.5\" />\n              <div>\n                <h4 className=\"font-medium\">Blood Sugar Control</h4>\n                <p className=\"text-sm text-muted-foreground\">Helps regulate insulin and glucose levels</p>\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Nutrition Tips */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Apple className=\"h-5 w-5\" />\n            Nutrition Tips While on GLP-1s\n          </CardTitle>\n          <CardDescription>\n            Optimize your diet to work with your medication\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-6\">\n            <div>\n              <h4 className=\"font-semibold text-green-600 mb-3\">âœ… Foods to Emphasize</h4>\n              <ul className=\"space-y-2 text-sm\">\n                <li className=\"flex items-center gap-2\">\n                  <CheckCircle className=\"h-4 w-4 text-green-600\" />\n                  <span><strong>Lean proteins:</strong> Chicken, fish, tofu, legumes to maintain muscle mass</span>\n                </li>\n                <li className=\"flex items-center gap-2\">\n                  <CheckCircle className=\"h-4 w-4 text-green-600\" />\n                  <span><strong>Fiber-rich foods:</strong> Vegetables, fruits, whole grains for digestive health</span>\n                </li>\n                <li className=\"flex items-center gap-2\">\n                  <CheckCircle className=\"h-4 w-4 text-green-600\" />\n                  <span><strong>Hydrating foods:</strong> Soups, smoothies, water-rich fruits and vegetables</span>\n                </li>\n                <li className=\"flex items-center gap-2\">\n                  <CheckCircle className=\"h-4 w-4 text-green-600\" />\n                  <span><strong>Small, frequent meals:</strong> 4-6 smaller portions throughout the day</span>\n                </li>\n              </ul>\n            </div>\n\n            <Separator />\n\n            <div>\n              <h4 className=\"font-semibold text-red-600 mb-3\">âŒ Foods to Limit or Avoid</h4>\n              <ul className=\"space-y-2 text-sm\">\n                <li className=\"flex items-center gap-2\">\n                  <AlertTriangle className=\"h-4 w-4 text-red-600\" />\n                  <span><strong>High-fat foods:</strong> Can worsen nausea and slow digestion further</span>\n                </li>\n                <li className=\"flex items-center gap-2\">\n                  <AlertTriangle className=\"h-4 w-4 text-red-600\" />\n                  <span><strong>Sugary drinks:</strong> Can cause blood sugar spikes and GI upset</span>\n                </li>\n                <li className=\"flex items-center gap-2\">\n                  <AlertTriangle className=\"h-4 w-4 text-red-600\" />\n                  <span><strong>Large meals:</strong> May cause discomfort, nausea, or vomiting</span>\n                </li>\n                <li className=\"flex items-center gap-2\">\n                  <AlertTriangle className=\"h-4 w-4 text-red-600\" />\n                  <span><strong>Carbonated drinks:</strong> Can increase feelings of fullness and bloating</span>\n                </li>\n              </ul>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Managing Side Effects */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Heart className=\"h-5 w-5\" />\n            Managing Common Side Effects\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            <div>\n              <h4 className=\"font-semibold mb-3\">Nausea & Vomiting</h4>\n              <ul className=\"space-y-1 text-sm\">\n                <li>â€¢ Eat slowly and chew thoroughly</li>\n                <li>â€¢ Try ginger tea or ginger supplements</li>\n                <li>â€¢ Avoid lying down after eating</li>\n                <li>â€¢ Eat bland foods (crackers, toast)</li>\n                <li>â€¢ Stay hydrated with small sips</li>\n              </ul>\n            </div>\n\n            <div>\n              <h4 className=\"font-semibold mb-3\">Constipation</h4>\n              <ul className=\"space-y-1 text-sm\">\n                <li>â€¢ Increase fiber gradually</li>\n                <li>â€¢ Drink plenty of water</li>\n                <li>â€¢ Take gentle walks after meals</li>\n                <li>â€¢ Consider a fiber supplement</li>\n                <li>â€¢ Eat prunes or prune juice</li>\n              </ul>\n            </div>\n\n            <div>\n              <h4 className=\"font-semibold mb-3\">Fatigue</h4>\n              <ul className=\"space-y-1 text-sm\">\n                <li>â€¢ Ensure adequate protein intake</li>\n                <li>â€¢ Monitor for dehydration</li>\n                <li>â€¢ Maintain regular sleep schedule</li>\n                <li>â€¢ Consider B-vitamin complex</li>\n                <li>â€¢ Light exercise as tolerated</li>\n              </ul>\n            </div>\n\n            <div>\n              <h4 className=\"font-semibold mb-3\">Loss of Appetite</h4>\n              <ul className=\"space-y-1 text-sm\">\n                <li>â€¢ Focus on nutrient-dense foods</li>\n                <li>â€¢ Use liquid nutrition if needed</li>\n                <li>â€¢ Set eating reminders</li>\n                <li>â€¢ Make food more appealing</li>\n                <li>â€¢ Track your intake</li>\n              </ul>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Safety Guidelines */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Shield className=\"h-5 w-5\" />\n            Safety Guidelines & Best Practices\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-4\">\n            <div className=\"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg\">\n              <h4 className=\"font-semibold text-blue-900 dark:text-blue-100 mb-2\">Injection Safety</h4>\n              <ul className=\"space-y-1 text-sm text-blue-800 dark:text-blue-200\">\n                <li>â€¢ Rotate injection sites (thigh, stomach, upper arm)</li>\n                <li>â€¢ Use a new needle for each injection</li>\n                <li>â€¢ Store medication in refrigerator (not freezer)</li>\n                <li>â€¢ Check expiration dates before use</li>\n                <li>â€¢ Dispose of needles in a sharps container</li>\n              </ul>\n            </div>\n\n            <div className=\"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg\">\n              <h4 className=\"font-semibold text-green-900 dark:text-green-100 mb-2\">Monitoring & Check-ups</h4>\n              <ul className=\"space-y-1 text-sm text-green-800 dark:text-green-200\">\n                <li>â€¢ Regular blood work to monitor kidney function</li>\n                <li>â€¢ Track weight loss progress</li>\n                <li>â€¢ Monitor blood sugar if diabetic</li>\n                <li>â€¢ Report severe side effects immediately</li>\n                <li>â€¢ Keep follow-up appointments</li>\n              </ul>\n            </div>\n\n            <div className=\"p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg\">\n              <h4 className=\"font-semibold text-orange-900 dark:text-orange-100 mb-2\">When to Contact Your Doctor</h4>\n              <ul className=\"space-y-1 text-sm text-orange-800 dark:text-orange-200\">\n                <li>â€¢ Severe nausea or vomiting that prevents eating/drinking</li>\n                <li>â€¢ Signs of pancreatitis (severe stomach pain)</li>\n                <li>â€¢ Unusual changes in vision</li>\n                <li>â€¢ Signs of allergic reaction</li>\n                <li>â€¢ Persistent constipation or diarrhea</li>\n              </ul>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Success Tips */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Users className=\"h-5 w-5\" />\n            Tips for Long-term Success\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <div className=\"space-y-3\">\n              <div className=\"flex items-start gap-3\">\n                <Clock className=\"h-5 w-5 text-blue-600 mt-0.5\" />\n                <div>\n                  <h4 className=\"font-medium\">Build Sustainable Habits</h4>\n                  <p className=\"text-sm text-muted-foreground\">Focus on lifestyle changes that you can maintain long-term</p>\n                </div>\n              </div>\n              <div className=\"flex items-start gap-3\">\n                <Heart className=\"h-5 w-5 text-red-600 mt-0.5\" />\n                <div>\n                  <h4 className=\"font-medium\">Stay Active</h4>\n                  <p className=\"text-sm text-muted-foreground\">Regular exercise helps maintain muscle mass during weight loss</p>\n                </div>\n              </div>\n            </div>\n            <div className=\"space-y-3\">\n              <div className=\"flex items-start gap-3\">\n                <Users className=\"h-5 w-5 text-green-600 mt-0.5\" />\n                <div>\n                  <h4 className=\"font-medium\">Find Support</h4>\n                  <p className=\"text-sm text-muted-foreground\">Connect with others on similar journeys for motivation</p>\n                </div>\n              </div>\n              <div className=\"flex items-start gap-3\">\n                <Apple className=\"h-5 w-5 text-orange-600 mt-0.5\" />\n                <div>\n                  <h4 className=\"font-medium\">Track Your Progress</h4>\n                  <p className=\"text-sm text-muted-foreground\">Use apps like this one to monitor nutrition and health metrics</p>\n                </div>\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Bottom Navigation */}\n      <DropdownNavigation />\n      \n      {/* Bottom padding */}\n      <div className=\"h-20\"></div>\n    </div>\n  );\n}","size_bytes":14525},"client/src/pages/DiaryPage.tsx":{"content":"import React, { useState, useEffect } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { format } from \"date-fns\";\nimport { Utensils, Calendar, Clock, Trash2, ArrowLeft, Droplets, Wine, Flame, Target, TrendingUp, HelpCircle, Mic, MicOff, Plus } from \"lucide-react\";\nimport { WaterTracker } from \"@/components/water-tracker\";\nimport { motion } from \"framer-motion\";\nimport { Link } from \"wouter\";\nimport { ProgressIndicators } from \"@/components/progress-indicators\";\nimport { WeeklyAnalytics } from \"@/components/weekly-analytics\";\nimport { SearchFilterBar } from \"@/components/search-filter-bar\";\nimport { MealTemplatesDialog } from \"@/components/meal-templates-dialog\";\nimport { AdvancedAnalytics } from \"@/components/advanced-analytics\";\nimport { QuickActionsBar } from \"@/components/quick-actions-bar\";\nimport { DataManagementDialog } from \"@/components/data-management-dialog\";\nimport type { DiaryEntryWithAnalysis, DrinkEntry, NutritionGoals } from \"@shared/schema\";\nimport { DropdownNavigation } from \"@/components/dropdown-navigation\";\nimport { BottomHelpSection } from \"@/components/bottom-help-section\";\nimport { WeightForm } from \"@/components/weight-form\";\nimport { WeightList } from \"@/components/weight-list\";\nimport { WeightEditDialog } from \"@/components/weight-edit-dialog\";\nimport { WeightChart } from \"@/components/weight-chart\";\nimport type { WeightEntry } from \"@shared/schema\";\nimport { calculateDailyNutrition } from \"@/lib/nutrition-calculator\";\nimport { Dashboard } from \"@/components/dashboard\";\nimport { DiaryEditDialog } from \"@/components/diary-edit-dialog\";\nimport { soundService } from \"@/lib/sound-service\";\n\nexport function DiaryPage() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [activeTab, setActiveTab] = useState<'dashboard' | 'diary' | 'analytics' | 'weight'>('dashboard');\n  const [viewMode, setViewMode] = useState<'today' | 'history'>('today');\n\n  // Check URL parameters for tab switching\n  useEffect(() => {\n    const urlParams = new URLSearchParams(window.location.search);\n    const tabParam = urlParams.get('tab');\n    if (tabParam === 'weight') {\n      setActiveTab('weight');\n    } else if (tabParam === 'diary') {\n      setActiveTab('diary');\n    } else if (tabParam === 'analytics') {\n      setActiveTab('analytics');\n    }\n  }, []);\n\n  // Scroll to top instantly when switching to diary tab to see animations\n  useEffect(() => {\n    if (activeTab === 'diary') {\n      window.scrollTo({ top: 0, behavior: 'instant' });\n    }\n  }, [activeTab]);\n  \n  // Search and filter state\n  const [searchQuery, setSearchQuery] = useState('');\n  const [mealTypeFilter, setMealTypeFilter] = useState('all');\n  const [dateRange, setDateRange] = useState<{ start?: Date; end?: Date }>({});\n  const [calorieRange, setCalorieRange] = useState<{ min?: number; max?: number }>({});\n\n  // Weight edit dialog state\n  const [editingWeightEntry, setEditingWeightEntry] = useState<WeightEntry | null>(null);\n  const [isEditDialogOpen, setIsEditDialogOpen] = useState(false);\n\n  // Diary edit dialog state\n  const [editingDiaryEntry, setEditingDiaryEntry] = useState<DiaryEntryWithAnalysis | null>(null);\n  const [isDiaryEditDialogOpen, setIsDiaryEditDialogOpen] = useState(false);\n  \n  // Track which entries have expanded food lists\n  const [expandedEntries, setExpandedEntries] = useState<Set<string>>(new Set());\n\n  // Voice input state\n  const [isListening, setIsListening] = useState(false);\n  const [speechSupported, setSpeechSupported] = useState(false);\n  const [voiceInput, setVoiceInput] = useState('');\n  const [showVoiceMealDialog, setShowVoiceMealDialog] = useState(false);\n  const [selectedMealType, setSelectedMealType] = useState<'breakfast' | 'lunch' | 'dinner' | 'snack'>('breakfast');\n  \n  // Review state for voice entries\n  const [showReviewDialog, setShowReviewDialog] = useState(false);\n  const [reviewAnalysis, setReviewAnalysis] = useState<any | null>(null);\n  const [reviewDescription, setReviewDescription] = useState('');\n  const [editingFoodIndex, setEditingFoodIndex] = useState<number | null>(null);\n\n  // Initialize speech recognition\n  useEffect(() => {\n    const checkSpeechSupport = () => {\n      const supported = 'SpeechRecognition' in window || 'webkitSpeechRecognition' in window;\n      setSpeechSupported(supported);\n    };\n    checkSpeechSupport();\n  }, []);\n\n  const handleVoiceInput = async () => {\n    if (!speechSupported) {\n      toast({\n        title: \"Speech Not Supported\",\n        description: \"Speech recognition is not supported in this browser\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (isListening) {\n      setIsListening(false);\n      return;\n    }\n\n    try {\n      const recognition = new (window.SpeechRecognition || (window as any).webkitSpeechRecognition)();\n      recognition.continuous = false;\n      recognition.interimResults = false;\n      recognition.lang = 'en-US';\n\n      recognition.onstart = () => {\n        setIsListening(true);\n        toast({\n          title: \"Listening...\",\n          description: \"Say your food item and quantity (e.g., '100g salmon')\",\n        });\n      };\n\n      recognition.onresult = (event: any) => {\n        const transcript = event.results[0][0].transcript;\n        setVoiceInput(transcript);\n        setShowVoiceMealDialog(true);\n        toast({\n          title: \"Voice captured!\",\n          description: `Heard: \"${transcript}\"`,\n        });\n      };\n\n      recognition.onerror = (event: any) => {\n        console.error('Speech recognition error:', event.error);\n        toast({\n          title: \"Speech Error\",\n          description: \"Could not recognize speech. Please try again.\",\n          variant: \"destructive\",\n        });\n        setIsListening(false);\n      };\n\n      recognition.onend = () => {\n        setIsListening(false);\n      };\n\n      recognition.start();\n    } catch (error) {\n      toast({\n        title: \"Speech Error\",\n        description: \"Failed to start speech recognition\",\n        variant: \"destructive\",\n      });\n      setIsListening(false);\n    }\n  };\n\n  const handleConfirmVoiceMeal = () => {\n    if (!voiceInput.trim()) return;\n    analyzeVoiceMutation.mutate({\n      foodDescription: voiceInput.trim()\n    });\n  };\n\n  const { data: diaryEntries, isLoading } = useQuery<DiaryEntryWithAnalysis[]>({\n    queryKey: ['/api/diary'],\n  });\n\n  const { data: drinkEntries, isLoading: drinksLoading } = useQuery<DrinkEntry[]>({\n    queryKey: ['/api/drinks'],\n  });\n\n  const { data: nutritionGoals } = useQuery<NutritionGoals>({\n    queryKey: ['/api/nutrition-goals'],\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: async (entryId: string) => {\n      await apiRequest('DELETE', `/api/diary/${entryId}`);\n    },\n    onSuccess: () => {\n      soundService.playClick();\n      toast({\n        title: \"Entry Deleted\",\n        description: \"Meal has been removed from your diary.\",\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/diary'] });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to delete entry. Please try again.\",\n        variant: \"destructive\",\n      });\n      console.error(\"Error deleting diary entry:\", error);\n    },\n  });\n\n  const deleteDrinkMutation = useMutation({\n    mutationFn: async (drinkId: string) => {\n      await apiRequest('DELETE', `/api/drinks/${drinkId}`);\n    },\n    onSuccess: () => {\n      soundService.playClick();\n      toast({\n        title: \"Drink Deleted\",\n        description: \"Drink has been removed from your diary.\",\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/drinks'] });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to delete drink. Please try again.\",\n        variant: \"destructive\",\n      });\n      console.error(\"Error deleting drink entry:\", error);\n    },\n  });\n\n  // Step 1: Analyze voice input - doesn't save to diary yet\n  const analyzeVoiceMutation = useMutation({\n    mutationFn: async ({ foodDescription }: { foodDescription: string }) => {\n      const analysisResponse = await apiRequest('POST', '/api/analyze-text', { foodDescription });\n      const analysis = await analysisResponse.json();\n      return { analysis, foodDescription };\n    },\n    onSuccess: ({ analysis, foodDescription }) => {\n      // Close voice dialog\n      setShowVoiceMealDialog(false);\n      \n      // Show review dialog\n      setReviewAnalysis(analysis);\n      setReviewDescription(foodDescription);\n      setShowReviewDialog(true);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Analysis Error\",\n        description: error.message || \"Failed to analyze food. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Step 2: Save to diary after review\n  const saveToDiaryMutation = useMutation({\n    mutationFn: async ({ analysisId, mealType, notes, updatedFoods }: { \n      analysisId: string, \n      mealType: string, \n      notes: string,\n      updatedFoods?: any[]\n    }) => {\n      // If foods were edited, update the analysis first\n      if (updatedFoods) {\n        await apiRequest('PATCH', `/api/analyses/${analysisId}`, {\n          detectedFoods: updatedFoods\n        });\n      }\n      \n      // Then create diary entry\n      const now = new Date();\n      const diaryResponse = await apiRequest('POST', '/api/diary', {\n        analysisId,\n        mealType,\n        mealDate: now.toISOString(),\n        notes\n      });\n      return await diaryResponse.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Meal Added!\",\n        description: \"Your meal has been added to your diary.\",\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/diary'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges/points'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges/streak'] });\n      setShowReviewDialog(false);\n      setReviewAnalysis(null);\n      setVoiceInput('');\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to add meal from voice. Please try again.\",\n        variant: \"destructive\",\n      });\n      console.error(\"Error adding voice meal:\", error);\n    },\n  });\n\n  const groupedEntries = diaryEntries?.reduce((groups, entry) => {\n    const date = new Date(entry.mealDate).toDateString();\n    if (!groups[date]) {\n      groups[date] = [];\n    }\n    groups[date].push(entry);\n    return groups;\n  }, {} as Record<string, DiaryEntryWithAnalysis[]>) || {};\n\n  const groupedDrinks = drinkEntries?.reduce((groups, drink) => {\n    const date = new Date(drink.loggedAt).toDateString();\n    if (!groups[date]) {\n      groups[date] = [];\n    }\n    groups[date].push(drink);\n    return groups;\n  }, {} as Record<string, DrinkEntry[]>) || {};\n\n  // Calculate daily nutrition totals using standardized function\n  const getDailyNutrition = (date: string) => {\n    const targetDate = new Date(date);\n    return calculateDailyNutrition(diaryEntries || [], drinkEntries || [], targetDate);\n  };\n\n  // Get today's date string for filtering\n  const today = new Date().toDateString();\n  const todayNutrition = getDailyNutrition(today);\n  \n  // Calculate remaining to reach targets\n  const getRemainingNutrition = () => {\n    if (!nutritionGoals) return null;\n    return {\n      calories: Math.max(0, (nutritionGoals.dailyCalories || 0) - todayNutrition.calories),\n      protein: Math.max(0, (nutritionGoals.dailyProtein || 0) - todayNutrition.protein),\n      carbs: Math.max(0, (nutritionGoals.dailyCarbs || 0) - todayNutrition.carbs),\n      fat: Math.max(0, (nutritionGoals.dailyFat || 0) - todayNutrition.fat),\n    };\n  };\n  \n  const remainingNutrition = getRemainingNutrition();\n\n  const allDates = new Set([...Object.keys(groupedEntries), ...Object.keys(groupedDrinks)]);\n  \n  // Filter entries based on search and filters\n  const filteredEntries = diaryEntries?.filter(entry => {\n    // Text search\n    if (searchQuery) {\n      const searchLower = searchQuery.toLowerCase();\n      const matchesFood = entry.analysis?.detectedFoods?.some(food => \n        food.name.toLowerCase().includes(searchLower)\n      );\n      const matchesNotes = entry.notes?.toLowerCase().includes(searchLower);\n      const matchesMealType = entry.mealType.toLowerCase().includes(searchLower);\n      const matchesCustomName = entry.customMealName?.toLowerCase().includes(searchLower);\n      \n      if (!matchesFood && !matchesNotes && !matchesMealType && !matchesCustomName) {\n        return false;\n      }\n    }\n    \n    // Meal type filter\n    if (mealTypeFilter !== 'all' && entry.mealType !== mealTypeFilter) {\n      return false;\n    }\n    \n    // Date range filter\n    if (dateRange.start || dateRange.end) {\n      const entryDate = new Date(entry.mealDate);\n      if (dateRange.start && entryDate < dateRange.start) return false;\n      if (dateRange.end && entryDate > dateRange.end) return false;\n    }\n    \n    // Calorie range filter\n    if (calorieRange.min || calorieRange.max) {\n      const calories = entry.analysis?.totalCalories || 0;\n      if (calorieRange.min && calories < calorieRange.min) return false;\n      if (calorieRange.max && calories > calorieRange.max) return false;\n    }\n    \n    return true;\n  }) || [];\n  \n  const filteredGroupedEntries = filteredEntries.reduce((groups, entry) => {\n    const date = new Date(entry.mealDate).toDateString();\n    if (!groups[date]) {\n      groups[date] = [];\n    }\n    groups[date].push(entry);\n    return groups;\n  }, {} as Record<string, DiaryEntryWithAnalysis[]>);\n\n  const allFilteredDates = new Set([...Object.keys(filteredGroupedEntries), ...Object.keys(groupedDrinks)]);\n  \n  // Filter dates based on view mode\n  const filteredByViewMode = viewMode === 'today' \n    ? Array.from(allFilteredDates).filter(date => date === today)\n    : Array.from(allFilteredDates).filter(date => date !== today);\n    \n  const sortedDates = filteredByViewMode.sort((a, b) => \n    new Date(b).getTime() - new Date(a).getTime()\n  );\n\n  if (isLoading || drinksLoading) {\n    return (\n      <div className=\"min-h-screen bg-purple-500 dark:bg-gray-900 p-4\">\n        <div className=\"max-w-md mx-auto\">\n          <div className=\"animate-pulse space-y-4\">\n            <div className=\"h-8 bg-muted rounded\"></div>\n            <div className=\"space-y-3\">\n              <div className=\"h-32 bg-muted rounded-lg\"></div>\n              <div className=\"h-32 bg-muted rounded-lg\"></div>\n              <div className=\"h-32 bg-muted rounded-lg\"></div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <motion.div \n      initial={{ opacity: 0, scale: 0.95, y: 20 }}\n      animate={{ opacity: 1, scale: 1, y: 0 }}\n      transition={{ duration: 0.6, ease: \"easeOut\" }}\n      className=\"min-h-screen text-foreground\" \n      style={{background: 'var(--bg-gradient)'}}\n    >\n      {/* Header */}\n      <div className=\"bg-card border-b\">\n        <div className=\"max-w-md mx-auto px-4 py-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-3\">\n              <Link to=\"/\">\n                <button \n                  className=\"p-2 hover:bg-muted rounded-lg transition-colors\"\n                  data-testid=\"button-back\"\n                  onClick={() => {\n                    // Force refresh homepage data when navigating back\n                    queryClient.invalidateQueries({ queryKey: ['/api/diary'] });\n                    queryClient.invalidateQueries({ queryKey: ['/api/nutrition-goals'] });\n                    queryClient.invalidateQueries({ queryKey: ['/api/drinks'] });\n                  }}\n                >\n                  <ArrowLeft className=\"h-5 w-5\" />\n                </button>\n              </Link>\n              <h1 className=\"text-xl font-bold\">\n                {activeTab === 'weight' ? 'Weight Tracking' : 'Food Diary'}\n              </h1>\n              \n              {/* View Mode Toggle */}\n              <div className=\"flex bg-muted rounded-lg p-1 ml-2\">\n                <button\n                  onClick={() => setViewMode('today')}\n                  className={`px-2 py-1 rounded text-xs font-medium transition-colors ${\n                    viewMode === 'today' \n                      ? 'bg-background text-foreground shadow-sm' \n                      : 'text-muted-foreground hover:text-foreground'\n                  }`}\n                  data-testid=\"view-today\"\n                  aria-label=\"View today's meals\"\n                  aria-pressed={viewMode === 'today'}\n                >\n                  Today\n                </button>\n                <button\n                  onClick={() => setViewMode('history')}\n                  className={`px-2 py-1 rounded text-xs font-medium transition-colors ${\n                    viewMode === 'history' \n                      ? 'bg-background text-foreground shadow-sm' \n                      : 'text-muted-foreground hover:text-foreground'\n                  }`}\n                  data-testid=\"view-history\"\n                  aria-label=\"View meal history\"\n                  aria-pressed={viewMode === 'history'}\n                >\n                  History\n                </button>\n              </div>\n              \n              {/* Voice input button */}\n              {speechSupported && (\n                <button\n                  onClick={handleVoiceInput}\n                  disabled={isListening}\n                  className={`p-2 rounded-lg transition-all duration-200 ${\n                    isListening \n                      ? 'bg-red-500 text-white animate-pulse' \n                      : 'bg-primary text-primary-foreground hover:bg-primary/90'\n                  }`}\n                  data-testid=\"button-voice-meal\"\n                  aria-label={isListening ? 'Stop listening for voice meal input' : 'Add meal using voice input'}\n                >\n                  {isListening ? (\n                    <MicOff className=\"h-5 w-5\" aria-hidden=\"true\" />\n                  ) : (\n                    <Mic className=\"h-5 w-5\" aria-hidden=\"true\" />\n                  )}\n                </button>\n              )}\n            </div>\n            \n            {/* Tab Navigation */}\n            <div className=\"flex items-center space-x-2\">\n              <div className=\"flex bg-muted rounded-lg p-1\">\n                <button\n                  onClick={() => setActiveTab('dashboard')}\n                  className={`px-3 py-1 rounded-md text-sm font-medium transition-colors ${\n                    activeTab === 'dashboard' \n                      ? 'bg-background text-foreground shadow-sm' \n                      : 'text-muted-foreground hover:text-foreground'\n                  }`}\n                  data-testid=\"tab-dashboard\"\n                  aria-label=\"View dashboard tab\"\n                  aria-pressed={activeTab === 'dashboard'}\n                  role=\"tab\"\n                >\n                  <Target className=\"h-4 w-4\" aria-hidden=\"true\" />\n                </button>\n                <button\n                  onClick={() => setActiveTab('diary')}\n                  className={`px-3 py-1 rounded-md text-sm font-medium transition-colors ${\n                    activeTab === 'diary' \n                      ? 'bg-background text-foreground shadow-sm' \n                      : 'text-muted-foreground hover:text-foreground'\n                  }`}\n                  data-testid=\"tab-diary\"\n                  aria-label=\"View diary tab\"\n                  aria-pressed={activeTab === 'diary'}\n                  role=\"tab\"\n                >\n                  <Calendar className=\"h-4 w-4\" aria-hidden=\"true\" />\n                </button>\n                <button\n                  onClick={() => setActiveTab('analytics')}\n                  className={`px-3 py-1 rounded-md text-sm font-medium transition-colors ${\n                    activeTab === 'analytics' \n                      ? 'bg-background text-foreground shadow-sm' \n                      : 'text-muted-foreground hover:text-foreground'\n                  }`}\n                  data-testid=\"tab-analytics\"\n                  aria-label=\"View analytics tab\"\n                  aria-pressed={activeTab === 'analytics'}\n                  role=\"tab\"\n                >\n                  <TrendingUp className=\"h-4 w-4\" aria-hidden=\"true\" />\n                </button>\n                <button\n                  onClick={() => setActiveTab('weight')}\n                  className={`px-3 py-1 rounded-md text-sm font-medium transition-colors ${\n                    activeTab === 'weight' \n                      ? 'bg-background text-foreground shadow-sm' \n                      : 'text-muted-foreground hover:text-foreground'\n                  }`}\n                  data-testid=\"tab-weight\"\n                  aria-label=\"View weight tracking tab\"\n                  aria-pressed={activeTab === 'weight'}\n                  role=\"tab\"\n                >\n                  <TrendingUp className=\"h-4 w-4\" aria-hidden=\"true\" />\n                </button>\n              </div>\n              <Link href=\"/help\">\n                <button \n                  className=\"p-2 hover:bg-muted rounded-lg transition-colors\"\n                  data-testid=\"button-help-diary\"\n                  title=\"Help & Support\"\n                >\n                  <HelpCircle className=\"h-4 w-4 text-muted-foreground\" />\n                </button>\n              </Link>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Search and Filter Bar */}\n      {activeTab === 'diary' && viewMode === 'history' && (\n        <div className=\"max-w-md mx-auto px-4 pb-2\">\n          <SearchFilterBar\n            searchQuery={searchQuery}\n            onSearchChange={setSearchQuery}\n            mealTypeFilter={mealTypeFilter}\n            onMealTypeChange={setMealTypeFilter}\n            dateRange={dateRange}\n            onDateRangeChange={setDateRange}\n            calorieRange={calorieRange}\n            onCalorieRangeChange={setCalorieRange}\n            onClearFilters={() => {\n              setSearchQuery('');\n              setMealTypeFilter('all');\n              setDateRange({});\n              setCalorieRange({});\n            }}\n            hasActiveFilters={searchQuery !== '' || mealTypeFilter !== 'all' || !!dateRange.start || !!dateRange.end || !!calorieRange.min || !!calorieRange.max}\n          />\n        </div>\n      )}\n      \n      {/* Content */}\n      <div className=\"max-w-md mx-auto p-4 pb-32\">\n        {activeTab === 'dashboard' ? (\n          <Dashboard \n            onViewMeals={() => {\n              setActiveTab('diary');\n              const allIds = new Set(filteredGroupedEntries[sortedDates[0]]?.map(e => e.id) || []);\n              setExpandedEntries(allIds);\n            }}\n          />\n        ) : activeTab === 'analytics' ? (\n          <div className=\"space-y-6\">\n            <WeeklyAnalytics goals={nutritionGoals} />\n            <AdvancedAnalytics goals={nutritionGoals} />\n          </div>\n        ) : activeTab === 'weight' ? (\n          <div className=\"space-y-6\">\n            {/* Weight Tracking Header */}\n            <div className=\"bg-gradient-to-br from-purple-50 to-violet-50 border border-purple-200 dark:border-purple-800 rounded-xl p-6\">\n              <div className=\"flex items-center justify-between mb-4\">\n                <div className=\"flex items-center space-x-2\">\n                  <Target className=\"h-5 w-5 text-purple-600\" />\n                  <h2 className=\"text-lg font-bold\">Weight Progress</h2>\n                </div>\n                <div className=\"text-sm text-muted-foreground\">\n                  Track your weekly weigh-ins\n                </div>\n              </div>\n            </div>\n            \n            {/* Weight Form */}\n            <WeightForm />\n            \n            {/* Recent Weight Entries */}\n            <WeightList onEdit={(entry) => {\n              setEditingWeightEntry(entry);\n              setIsEditDialogOpen(true);\n            }} />\n            \n            {/* Weight Progress Chart */}\n            <WeightChart />\n          </div>\n        ) : viewMode === 'today' ? (\n          <div className=\"space-y-6\">\n            {/* Today's Meals */}\n            {sortedDates.length === 0 ? (\n              <div className=\"text-center py-8 bg-muted/30 rounded-xl\">\n                <Utensils className=\"h-8 w-8 mx-auto text-muted-foreground mb-3\" />\n                <h3 className=\"font-medium text-muted-foreground mb-2\">No meals logged today</h3>\n                <p className=\"text-sm text-muted-foreground mb-4\">\n                  Start your day by scanning food or using voice input\n                </p>\n                <Link href=\"/\">\n                  <button className=\"bg-primary text-primary-foreground px-4 py-2 rounded-lg text-sm font-medium hover:bg-primary/90 transition-colors\">\n                    Go to Homepage\n                  </button>\n                </Link>\n              </div>\n            ) : (\n              <div className=\"space-y-4\">\n                {/* Section Header - Purple Background with Back Button */}\n                <div className=\"bg-gradient-to-r from-purple-600 to-purple-500 rounded-xl px-4 py-3 shadow-md\">\n                  <div className=\"flex items-center space-x-3\">\n                    <button\n                      onClick={() => setActiveTab('dashboard')}\n                      className=\"text-white/80 hover:text-white transition-colors\"\n                      data-testid=\"button-back-to-dashboard\"\n                      title=\"Back to Dashboard\"\n                    >\n                      <ArrowLeft className=\"h-5 w-5\" />\n                    </button>\n                    <h3 className=\"text-xl font-bold text-white\">Today's Meals</h3>\n                  </div>\n                </div>\n                \n                {sortedDates.map((date) => (\n                  <div key={date} className=\"space-y-3\">\n                    {filteredGroupedEntries[date]?.map((entry, index) => {\n                      const isExpanded = expandedEntries.has(entry.id);\n                      \n                      const getMealColor = (mealType: string) => {\n                        if (mealType === 'snack') return 'bg-purple-500';\n                        return 'bg-orange-500';\n                      };\n                      \n                      const toggleExpanded = () => {\n                        const newExpanded = new Set(expandedEntries);\n                        if (isExpanded) {\n                          newExpanded.delete(entry.id);\n                        } else {\n                          newExpanded.add(entry.id);\n                        }\n                        setExpandedEntries(newExpanded);\n                      };\n                      \n                      return (\n                        <motion.div \n                          key={`${entry.id}-${activeTab}-${viewMode}`}\n                          initial={{ \n                            opacity: 0, \n                            x: -100,\n                            y: 20, \n                            scale: 0.7,\n                            rotateY: -15\n                          }}\n                          animate={{ \n                            opacity: 1, \n                            x: 0,\n                            y: 0, \n                            scale: 1,\n                            rotateY: 0\n                          }}\n                          transition={{ \n                            duration: 0.8,\n                            delay: index * 0.12,\n                            type: \"spring\",\n                            stiffness: 100,\n                            damping: 15,\n                            mass: 1\n                          }}\n                          whileHover={{ \n                            scale: 1.03, \n                            y: -5,\n                            transition: { duration: 0.2 } \n                          }}\n                          className=\"bg-gradient-to-br from-amber-50 to-orange-50 dark:from-gray-800 dark:to-gray-800 border border-purple-200 dark:border-purple-800 rounded-xl p-4 shadow-sm\"\n                        >\n                          {/* Header with colored meal badge and time */}\n                          <div className=\"flex items-center justify-between mb-3\">\n                            <div className=\"flex items-center space-x-2\">\n                              <span className={`${getMealColor(entry.mealType)} text-white px-3 py-1 rounded-full text-sm font-semibold capitalize`}>\n                                {entry.mealType}\n                              </span>\n                              <span className=\"text-sm text-muted-foreground\">\n                                {format(new Date(entry.mealDate), 'h:mm a')}\n                              </span>\n                            </div>\n                            <div className=\"flex items-center space-x-1\">\n                              <button\n                                onClick={() => {\n                                  setEditingDiaryEntry(entry);\n                                  setIsDiaryEditDialogOpen(true);\n                                }}\n                                className=\"p-2 text-purple-600 hover:bg-purple-50 dark:hover:bg-purple-900/20 rounded-lg transition-colors\"\n                                aria-label={`Edit ${entry.mealType} meal entry`}\n                                title=\"Edit entry\"\n                                data-testid={`button-edit-${entry.id}`}\n                              >\n                                <Utensils className=\"h-4 w-4\" aria-hidden=\"true\" />\n                              </button>\n                              <button\n                                onClick={() => deleteMutation.mutate(entry.id)}\n                                className=\"p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors\"\n                                aria-label={`Delete ${entry.mealType} meal entry`}\n                                title=\"Delete entry\"\n                                data-testid={`button-delete-${entry.id}`}\n                              >\n                                <Trash2 className=\"h-4 w-4\" aria-hidden=\"true\" />\n                              </button>\n                            </div>\n                          </div>\n                          \n                          {/* Macros with emoji icons - compact grid */}\n                          <div className=\"grid grid-cols-4 gap-2 bg-white/60 dark:bg-gray-900/40 rounded-lg p-3\">\n                            <div className=\"flex items-center space-x-1\">\n                              <span className=\"text-lg\">ðŸ”¥</span>\n                              <span className=\"text-sm font-semibold\" data-testid={`meal-calories-${entry.id}`}>\n                                {entry.analysis?.totalCalories || 0}\n                              </span>\n                            </div>\n                            <div className=\"flex items-center space-x-1\">\n                              <span className=\"text-lg\">ðŸ’ª</span>\n                              <span className=\"text-sm font-medium text-blue-600\" data-testid={`meal-protein-${entry.id}`}>\n                                {entry.analysis?.totalProtein || 0}g\n                              </span>\n                            </div>\n                            <div className=\"flex items-center space-x-1\">\n                              <span className=\"text-lg\">ðŸŒ¾</span>\n                              <span className=\"text-sm font-medium text-orange-600\" data-testid={`meal-carbs-${entry.id}`}>\n                                {entry.analysis?.totalCarbs || 0}g\n                              </span>\n                            </div>\n                            <div className=\"flex items-center space-x-1\">\n                              <span className=\"text-lg\">ðŸ¥‘</span>\n                              <span className=\"text-sm font-medium text-yellow-600\" data-testid={`meal-fat-${entry.id}`}>\n                                {entry.analysis?.totalFat || 0}g\n                              </span>\n                            </div>\n                          </div>\n                          \n                          {/* Food items list - Collapsible */}\n                          {isExpanded && entry.analysis?.detectedFoods && entry.analysis.detectedFoods.length > 0 && (\n                            <div className=\"space-y-2 mt-3 animate-in slide-in-from-top-2 duration-200\">\n                              {entry.analysis.detectedFoods.map((food, index) => (\n                                <div key={index} className=\"flex items-center justify-between py-2 px-3 bg-white/50 dark:bg-gray-900/30 rounded-lg border border-purple-100 dark:border-purple-900\">\n                                  <div className=\"flex-1 min-w-0\">\n                                    <p className=\"font-semibold text-sm truncate\">{food.name}</p>\n                                    <p className=\"text-xs text-muted-foreground\">{food.portion}</p>\n                                  </div>\n                                  <div className=\"flex items-center space-x-2 text-xs ml-2 shrink-0\">\n                                    <span className=\"font-bold text-red-600\">{food.calories}</span>\n                                    <span className=\"text-blue-600\">{food.protein}p</span>\n                                    <span className=\"text-orange-600\">{food.carbs}c</span>\n                                    <span className=\"text-yellow-600\">{food.fat}f</span>\n                                  </div>\n                                </div>\n                              ))}\n                            </div>\n                          )}\n                        </motion.div>\n                      );\n                    })}\n                    \n                    {/* Today's Drinks */}\n                    {groupedDrinks[date]?.map((drink) => (\n                      <div key={drink.id} className=\"bg-card border border-blue-200 rounded-lg p-4 mb-2\">\n                        {/* Header with drink info and actions */}\n                        <div className=\"flex items-center justify-between mb-3\">\n                          <div className=\"flex items-center space-x-3\">\n                            {/* Drink Icon */}\n                            <div className=\"w-10 h-10 rounded-lg overflow-hidden bg-blue-100 flex items-center justify-center\">\n                              <Droplets className=\"h-6 w-6 text-blue-600\" />\n                            </div>\n                            <div>\n                              <div className=\"flex items-center space-x-2 mb-1\">\n                                <span className=\"text-sm font-medium capitalize\">{drink.drinkName}</span>\n                                <span className=\"text-xs text-muted-foreground\">\n                                  {format(new Date(drink.loggedAt), 'h:mm a')}\n                                </span>\n                              </div>\n                              \n                              {/* Compact drink info */}\n                              <div className=\"flex items-center space-x-3 text-xs\">\n                                <span className=\"font-semibold text-red-600\" data-testid={`drink-calories-${drink.id}`}>\n                                  {drink.calories || 0} cal\n                                </span>\n                                <span className=\"text-blue-600\" data-testid={`drink-amount-${drink.id}`}>\n                                  {drink.amount}ml\n                                </span>\n                                {(drink.caffeine || 0) > 0 && (\n                                  <span className=\"text-green-600\" data-testid={`drink-caffeine-${drink.id}`}>\n                                    {drink.caffeine}mg caffeine\n                                  </span>\n                                )}\n                                {(drink.alcoholContent || 0) > 0 && (\n                                  <span className=\"text-purple-600\" data-testid={`drink-alcohol-${drink.id}`}>\n                                    {drink.alcoholContent}% ABV\n                                  </span>\n                                )}\n                              </div>\n                            </div>\n                          </div>\n                          <div className=\"flex items-center space-x-1\">\n                            <button\n                              onClick={() => deleteDrinkMutation.mutate(drink.id)}\n                              className=\"p-1 text-red-500 hover:bg-red-50 rounded\"\n                              aria-label={`Delete ${drink.drinkName} drink entry`}\n                              title=\"Delete drink\"\n                              data-testid={`button-delete-drink-${drink.id}`}\n                            >\n                              <Trash2 className=\"h-4 w-4\" aria-hidden=\"true\" />\n                            </button>\n                          </div>\n                        </div>\n                        \n                        {/* Drink Details */}\n                        <div className=\"bg-blue-50/50 rounded-lg p-2\">\n                          <div className=\"flex items-center justify-between text-xs\">\n                            <div className=\"flex items-center space-x-4\">\n                              <span className=\"text-muted-foreground\">Type: <strong>{drink.drinkType}</strong></span>\n                              {(drink.sugar || 0) > 0 && <span className=\"text-muted-foreground\">Sugar: <strong>{drink.sugar}g</strong></span>}\n                              {(drink.alcoholUnits || 0) > 0 && <span className=\"text-muted-foreground\">Units: <strong>{drink.alcoholUnits}</strong></span>}\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                ))}\n              </div>\n            )}\n            \n            {/* Today's Summary */}\n            <div className=\"bg-white dark:bg-gray-900 border border-slate-200 dark:border-gray-700 rounded-xl p-6 shadow-lg\">\n              <div className=\"flex items-center justify-between mb-4\">\n                <div className=\"flex items-center space-x-2\">\n                  <Target className=\"h-5 w-5 text-primary\" />\n                  <h2 className=\"text-lg font-bold\">Today's Intake</h2>\n                </div>\n                <div className=\"text-sm text-muted-foreground\">\n                  {format(new Date(), 'EEEE, MMMM d')}\n                </div>\n              </div>\n              \n              {/* Daily Totals */}\n              <div className=\"bg-background/80 rounded-lg p-4 text-center mb-4\">\n                <div className=\"text-2xl font-bold text-primary\" data-testid=\"calories-consumed\">\n                  {todayNutrition.calories} <span className=\"text-sm text-green-600\">({remainingNutrition?.calories || 0} left)</span>\n                </div>\n                <div className=\"text-sm text-muted-foreground\">Calories</div>\n              </div>\n              \n              {/* Macros Progress */}\n              {nutritionGoals && (\n                <div className=\"space-y-3\">\n                  <div className=\"text-sm font-medium mb-2\">Macronutrients</div>\n                  <div className=\"grid grid-cols-3 gap-3\">\n                    <div className=\"text-center\">\n                      <div className=\"text-lg font-bold text-red-600\">\n                        {todayNutrition.protein}g <span className=\"text-xs text-green-600\">({remainingNutrition?.protein || 0} left)</span>\n                      </div>\n                      <div className=\"text-xs text-muted-foreground\">Protein</div>\n                    </div>\n                    <div className=\"text-center\">\n                      <div className=\"text-lg font-bold text-blue-600\">\n                        {todayNutrition.carbs}g <span className=\"text-xs text-green-600\">({remainingNutrition?.carbs || 0} left)</span>\n                      </div>\n                      <div className=\"text-xs text-muted-foreground\">Carbs</div>\n                    </div>\n                    <div className=\"text-center\">\n                      <div className=\"text-lg font-bold text-yellow-600\">\n                        {todayNutrition.fat}g <span className=\"text-xs text-green-600\">({remainingNutrition?.fat || 0} left)</span>\n                      </div>\n                      <div className=\"text-xs text-muted-foreground\">Fat</div>\n                    </div>\n                  </div>\n                </div>\n              )}\n              \n              {/* Progress Bar */}\n              {nutritionGoals && (\n                <div className=\"mt-4\">\n                  <div className=\"flex justify-between text-sm mb-1\">\n                    <span>Daily Goal Progress</span>\n                    <span>{Math.round((todayNutrition.calories / (nutritionGoals.dailyCalories || 1)) * 100)}%</span>\n                  </div>\n                  <div className=\"w-full bg-muted rounded-full h-2\">\n                    <div \n                      className=\"bg-gradient-to-r from-primary to-primary/80 h-2 rounded-full transition-all duration-500\"\n                      style={{ width: `${Math.min(100, (todayNutrition.calories / (nutritionGoals.dailyCalories || 1)) * 100)}%` }}\n                    ></div>\n                  </div>\n                </div>\n              )}\n            </div>\n            \n            {/* Water Tracker - Separate section for water intake tracking */}\n            <WaterTracker selectedDate={new Date()} />\n            \n            {/* View All Meals Button - Placed under Today's Intake */}\n            <button\n              onClick={() => {\n                const totalEntries = filteredGroupedEntries[sortedDates[0]]?.length || 0;\n                if (expandedEntries.size > 0) {\n                  setExpandedEntries(new Set());\n                } else {\n                  const allIds = new Set(filteredGroupedEntries[sortedDates[0]]?.map(e => e.id) || []);\n                  setExpandedEntries(allIds);\n                }\n              }}\n              className=\"w-full bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white px-6 py-3 rounded-xl text-base font-semibold transition-all flex items-center justify-center space-x-2 shadow-lg\"\n              data-testid=\"button-toggle-all-meals\"\n            >\n              <Utensils className=\"h-5 w-5\" />\n              <span>{expandedEntries.size > 0 ? 'Hide All Meals' : 'View All Meals'}</span>\n            </button>\n          </div>\n        ) : (\n          <div className=\"space-y-6\">\n            {/* History Header */}\n            <div className=\"bg-muted/30 rounded-xl p-4\">\n              <div className=\"flex items-center space-x-2 text-sm text-muted-foreground\">\n                <Calendar className=\"h-4 w-4\" />\n                <span>Previous Days (Last 30 days)</span>\n              </div>\n            </div>\n            \n            {sortedDates.length === 0 ? (\n              <div className=\"text-center py-8\">\n                <Calendar className=\"h-8 w-8 mx-auto text-muted-foreground mb-3\" />\n                <h3 className=\"font-medium text-muted-foreground\">No history available</h3>\n                <p className=\"text-sm text-muted-foreground\">Your meal history will appear here</p>\n              </div>\n            ) : (\n              <div className=\"space-y-4\">\n                {sortedDates.map((date) => {\n                  const dailyNutrition = getDailyNutrition(date);\n                  return (\n                    <div key={date} className=\"bg-card border rounded-lg p-4\">\n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"flex items-center space-x-2 text-sm font-medium text-muted-foreground\">\n                          <Calendar className=\"h-4 w-4\" />\n                          <span>{format(new Date(date), 'EEEE, MMMM d, yyyy')}</span>\n                        </div>\n                        <div className=\"flex items-center space-x-2 bg-primary/10 text-primary px-3 py-1 rounded-full\">\n                          <Flame className=\"h-4 w-4\" />\n                          <span className=\"text-sm font-semibold\">\n                            {dailyNutrition.calories} cal\n                          </span>\n                        </div>\n                      </div>\n                      {filteredGroupedEntries[date] && (\n                        <div className=\"mt-2 text-sm text-muted-foreground\">\n                          {filteredGroupedEntries[date].length} meal{filteredGroupedEntries[date].length !== 1 ? 's' : ''} logged\n                        </div>\n                      )}\n                    </div>\n                  );\n                })}\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n      \n      {/* Voice Meal Confirmation Dialog */}\n      {showVoiceMealDialog && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-card rounded-xl p-6 w-full max-w-md\">\n            <h3 className=\"text-lg font-semibold mb-4 flex items-center gap-2\">\n              <Mic className=\"h-5 w-5 text-primary\" />\n              Add Voice Meal\n            </h3>\n            \n            <div className=\"space-y-4\">\n              {/* Voice Input Display */}\n              <div className=\"bg-muted/50 rounded-lg p-3\">\n                <label className=\"block text-sm font-medium mb-2\">What you said:</label>\n                <p className=\"text-sm font-mono bg-background p-2 rounded border\">\n                  \"{voiceInput}\"\n                </p>\n              </div>\n\n              {/* Meal Type Selection */}\n              <div>\n                <label className=\"block text-sm font-medium mb-2\">Meal Type</label>\n                <div className=\"grid grid-cols-4 gap-2\">\n                  {(['breakfast', 'lunch', 'dinner', 'snack'] as const).map((meal) => (\n                    <button\n                      key={meal}\n                      onClick={() => setSelectedMealType(meal)}\n                      className={`py-2 px-3 rounded-lg text-sm font-medium transition-colors ${\n                        selectedMealType === meal\n                          ? 'bg-primary text-primary-foreground'\n                          : 'bg-secondary text-secondary-foreground hover:bg-secondary/80'\n                      }`}\n                      data-testid={`button-voice-meal-${meal}`}\n                    >\n                      {meal.charAt(0).toUpperCase() + meal.slice(1)}\n                    </button>\n                  ))}\n                </div>\n              </div>\n            </div>\n\n            {/* Dialog Actions */}\n            <div className=\"flex space-x-3 mt-6\">\n              <button\n                onClick={() => setShowVoiceMealDialog(false)}\n                disabled={analyzeVoiceMutation.isPending}\n                className=\"flex-1 py-2 px-4 border border-input rounded-lg font-medium hover:bg-muted transition-colors disabled:opacity-50\"\n                data-testid=\"button-cancel-voice-meal\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleConfirmVoiceMeal}\n                disabled={analyzeVoiceMutation.isPending || !voiceInput.trim()}\n                className=\"flex-1 py-2 px-4 bg-primary text-primary-foreground rounded-lg font-medium hover:bg-primary/90 transition-colors disabled:opacity-50\"\n                data-testid=\"button-confirm-voice-meal\"\n              >\n                {analyzeVoiceMutation.isPending ? 'Analyzing...' : 'Analyze Meal'}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Review Dialog - Shows AI analysis before saving to diary */}\n      {showReviewDialog && reviewAnalysis && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4 backdrop-blur-sm overflow-y-auto\">\n          <div className=\"bg-card rounded-2xl p-5 w-full max-w-md shadow-2xl border border-border/20 my-8\">\n            <h3 className=\"text-lg font-bold mb-3 flex items-center gap-2\">\n              <Utensils className=\"h-5 w-5 text-primary\" />\n              Review & Edit\n            </h3>\n            <p className=\"text-xs text-muted-foreground mb-4\">\n              \"{reviewDescription}\"\n            </p>\n            \n            {/* Detected Foods - Editable */}\n            <div className=\"space-y-3 mb-5\">\n              {reviewAnalysis.detectedFoods.map((food: any, index: number) => {\n                const isEditing = editingFoodIndex === index;\n                \n                return (\n                  <div \n                    key={index}\n                    className=\"bg-gradient-to-r from-purple-50 to-white dark:from-purple-900/20 dark:to-gray-800 rounded-xl p-3 border border-purple-200/50 dark:border-purple-700/30\"\n                  >\n                    <div className=\"flex items-start justify-between mb-2\">\n                      <div className=\"flex-1\">\n                        {isEditing ? (\n                          <input\n                            type=\"text\"\n                            value={food.name}\n                            onChange={(e) => {\n                              setReviewAnalysis((prev: any) => prev ? {\n                                ...prev,\n                                detectedFoods: prev.detectedFoods.map((f: any, i: number) => \n                                  i === index ? { ...f, name: e.target.value } : f\n                                )\n                              } : null);\n                            }}\n                            className=\"font-bold text-sm w-full px-2 py-1 border rounded dark:bg-gray-700 dark:border-gray-600\"\n                            placeholder=\"Food name\"\n                          />\n                        ) : (\n                          <p className=\"font-bold text-sm text-gray-900 dark:text-white\">{food.name}</p>\n                        )}\n                        {isEditing ? (\n                          <input\n                            type=\"text\"\n                            value={food.portion}\n                            onChange={(e) => {\n                              setReviewAnalysis((prev: any) => prev ? {\n                                ...prev,\n                                detectedFoods: prev.detectedFoods.map((f: any, i: number) => \n                                  i === index ? { ...f, portion: e.target.value } : f\n                                )\n                              } : null);\n                            }}\n                            className=\"text-xs w-full px-2 py-1 mt-1 border rounded dark:bg-gray-700 dark:border-gray-600\"\n                            placeholder=\"Portion size\"\n                          />\n                        ) : (\n                          <p className=\"text-xs text-gray-600 dark:text-gray-400\">{food.portion}</p>\n                        )}\n                      </div>\n                      {isEditing ? (\n                        <button\n                          onClick={() => {\n                            if (!reviewAnalysis) return;\n                            setReviewAnalysis({\n                              ...reviewAnalysis,\n                              totalCalories: reviewAnalysis.detectedFoods.reduce((sum: number, f: any) => sum + f.calories, 0),\n                              totalProtein: reviewAnalysis.detectedFoods.reduce((sum: number, f: any) => sum + f.protein, 0),\n                              totalCarbs: reviewAnalysis.detectedFoods.reduce((sum: number, f: any) => sum + f.carbs, 0),\n                              totalFat: reviewAnalysis.detectedFoods.reduce((sum: number, f: any) => sum + f.fat, 0)\n                            });\n                            setEditingFoodIndex(null);\n                          }}\n                          className=\"text-xs px-2 py-1 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 rounded hover:bg-green-200 dark:hover:bg-green-900/50\"\n                        >\n                          Done\n                        </button>\n                      ) : (\n                        <button\n                          onClick={() => setEditingFoodIndex(index)}\n                          className=\"text-xs px-2 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-900/50\"\n                        >\n                          Edit\n                        </button>\n                      )}\n                    </div>\n                    \n                    {/* Nutrition Values */}\n                    {isEditing ? (\n                      <div className=\"grid grid-cols-4 gap-2\">\n                        <div>\n                          <label className=\"text-[10px] text-muted-foreground block mb-1\">cal</label>\n                          <input\n                            type=\"number\"\n                            value={food.calories}\n                            onChange={(e) => {\n                              setReviewAnalysis((prev: any) => prev ? {\n                                ...prev,\n                                detectedFoods: prev.detectedFoods.map((f: any, i: number) => \n                                  i === index ? { ...f, calories: parseInt(e.target.value) || 0 } : f\n                                )\n                              } : null);\n                            }}\n                            className=\"w-full px-1 py-1 text-xs border rounded text-center dark:bg-gray-700 dark:border-gray-600\"\n                          />\n                        </div>\n                        <div>\n                          <label className=\"text-[10px] text-muted-foreground block mb-1\">protein</label>\n                          <input\n                            type=\"number\"\n                            value={food.protein}\n                            onChange={(e) => {\n                              setReviewAnalysis((prev: any) => prev ? {\n                                ...prev,\n                                detectedFoods: prev.detectedFoods.map((f: any, i: number) => \n                                  i === index ? { ...f, protein: parseInt(e.target.value) || 0 } : f\n                                )\n                              } : null);\n                            }}\n                            className=\"w-full px-1 py-1 text-xs border rounded text-center dark:bg-gray-700 dark:border-gray-600\"\n                          />\n                        </div>\n                        <div>\n                          <label className=\"text-[10px] text-muted-foreground block mb-1\">carbs</label>\n                          <input\n                            type=\"number\"\n                            value={food.carbs}\n                            onChange={(e) => {\n                              setReviewAnalysis((prev: any) => prev ? {\n                                ...prev,\n                                detectedFoods: prev.detectedFoods.map((f: any, i: number) => \n                                  i === index ? { ...f, carbs: parseInt(e.target.value) || 0 } : f\n                                )\n                              } : null);\n                            }}\n                            className=\"w-full px-1 py-1 text-xs border rounded text-center dark:bg-gray-700 dark:border-gray-600\"\n                          />\n                        </div>\n                        <div>\n                          <label className=\"text-[10px] text-muted-foreground block mb-1\">fat</label>\n                          <input\n                            type=\"number\"\n                            value={food.fat}\n                            onChange={(e) => {\n                              setReviewAnalysis((prev: any) => prev ? {\n                                ...prev,\n                                detectedFoods: prev.detectedFoods.map((f: any, i: number) => \n                                  i === index ? { ...f, fat: parseInt(e.target.value) || 0 } : f\n                                )\n                              } : null);\n                            }}\n                            className=\"w-full px-1 py-1 text-xs border rounded text-center dark:bg-gray-700 dark:border-gray-600\"\n                          />\n                        </div>\n                      </div>\n                    ) : (\n                      <div className=\"grid grid-cols-4 gap-2 text-center\">\n                        <div>\n                          <div className=\"text-sm font-bold text-orange-600\">{food.calories}</div>\n                          <div className=\"text-[10px] text-muted-foreground\">cal</div>\n                        </div>\n                        <div>\n                          <div className=\"text-sm font-bold text-blue-600\">{food.protein}g</div>\n                          <div className=\"text-[10px] text-muted-foreground\">protein</div>\n                        </div>\n                        <div>\n                          <div className=\"text-sm font-bold text-yellow-600\">{food.carbs}g</div>\n                          <div className=\"text-[10px] text-muted-foreground\">carbs</div>\n                        </div>\n                        <div>\n                          <div className=\"text-sm font-bold text-green-600\">{food.fat}g</div>\n                          <div className=\"text-[10px] text-muted-foreground\">fat</div>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                );\n              })}\n            </div>\n\n            {/* Total Nutrition Summary */}\n            <div className=\"bg-gradient-to-r from-purple-100 to-pink-100 dark:from-purple-900/40 dark:to-pink-900/40 rounded-xl p-3 mb-4\">\n              <p className=\"text-xs font-semibold mb-2 text-gray-700 dark:text-gray-300\">Total Nutrition:</p>\n              <div className=\"grid grid-cols-4 gap-2 text-center\">\n                <div>\n                  <div className=\"text-base font-bold text-orange-600\">{reviewAnalysis.totalCalories}</div>\n                  <div className=\"text-[10px] text-muted-foreground\">cal</div>\n                </div>\n                <div>\n                  <div className=\"text-base font-bold text-blue-600\">{reviewAnalysis.totalProtein}g</div>\n                  <div className=\"text-[10px] text-muted-foreground\">protein</div>\n                </div>\n                <div>\n                  <div className=\"text-base font-bold text-yellow-600\">{reviewAnalysis.totalCarbs}g</div>\n                  <div className=\"text-[10px] text-muted-foreground\">carbs</div>\n                </div>\n                <div>\n                  <div className=\"text-base font-bold text-green-600\">{reviewAnalysis.totalFat}g</div>\n                  <div className=\"text-[10px] text-muted-foreground\">fat</div>\n                </div>\n              </div>\n            </div>\n\n            {/* Meal Type Selection */}\n            <div className=\"mb-4\">\n              <label className=\"block text-sm font-semibold mb-2 text-gray-700 dark:text-gray-300\">Meal Type</label>\n              <div className=\"grid grid-cols-2 gap-2\">\n                {(['breakfast', 'lunch', 'dinner', 'snack'] as const).map((meal) => (\n                  <button\n                    key={meal}\n                    onClick={() => setSelectedMealType(meal)}\n                    className={`py-2 px-3 rounded-lg text-xs font-bold transition-all duration-200 ${\n                      selectedMealType === meal\n                        ? 'bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-md transform scale-105'\n                        : 'bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-600'\n                    }`}\n                    data-testid={`button-review-meal-${meal}`}\n                  >\n                    {meal.charAt(0).toUpperCase() + meal.slice(1)}\n                  </button>\n                ))}\n              </div>\n            </div>\n\n            {/* Action Buttons */}\n            <div className=\"flex space-x-3\">\n              <button\n                onClick={() => {\n                  setShowReviewDialog(false);\n                  setReviewAnalysis(null);\n                }}\n                disabled={saveToDiaryMutation.isPending}\n                className=\"flex-1 py-2.5 px-4 border-2 border-gray-300 dark:border-gray-600 rounded-xl font-bold text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-all duration-200 disabled:opacity-50\"\n                data-testid=\"button-cancel-review\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={() => {\n                  saveToDiaryMutation.mutate({\n                    analysisId: reviewAnalysis.id,\n                    mealType: selectedMealType,\n                    notes: `Added via voice: \"${reviewDescription}\"`,\n                    updatedFoods: reviewAnalysis.detectedFoods\n                  });\n                }}\n                disabled={saveToDiaryMutation.isPending}\n                className=\"flex-1 py-2.5 px-4 bg-gradient-to-r from-purple-600 to-pink-500 text-white rounded-xl font-bold text-sm hover:from-purple-700 hover:to-pink-600 disabled:opacity-50 transition-all duration-200 shadow-lg\"\n                data-testid=\"button-save-to-diary\"\n              >\n                {saveToDiaryMutation.isPending ? 'Saving...' : 'Save to Diary'}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Bottom Navigation */}\n      <DropdownNavigation />\n      \n      {/* Bottom Help Section */}\n      <BottomHelpSection />\n      \n      {/* Weight Edit Dialog */}\n      <WeightEditDialog\n        entry={editingWeightEntry}\n        open={isEditDialogOpen}\n        onOpenChange={setIsEditDialogOpen}\n        onSuccess={() => {\n          setEditingWeightEntry(null);\n        }}\n      />\n\n      <DiaryEditDialog\n        entry={editingDiaryEntry}\n        open={isDiaryEditDialogOpen}\n        onOpenChange={setIsDiaryEditDialogOpen}\n        onSuccess={() => {\n          setEditingDiaryEntry(null);\n        }}\n      />\n    </motion.div>\n  );\n}\n\nexport default DiaryPage;","size_bytes":62716},"capacitor.config.ts":{"content":"import type { CapacitorConfig } from '@capacitor/cli';\n\nconst config: CapacitorConfig = {\n  appId: 'com.platemate.app',\n  appName: 'PlateMate',\n  webDir: 'dist/public',\n  server: {\n    androidScheme: 'https'\n  },\n  plugins: {\n    SplashScreen: {\n      launchShowDuration: 2000,\n      backgroundColor: \"#8B5CF6\",\n      showSpinner: false,\n      splashFullScreen: true,\n      splashImmersive: true\n    },\n    StatusBar: {\n      style: 'dark'\n    },\n    Camera: {\n      permissions: [\n        'camera',\n        'photos'\n      ]\n    },\n    LocalNotifications: {\n      smallIcon: \"ic_stat_icon_config_sample\",\n      iconColor: \"#8B5CF6\",\n      sound: \"beep.wav\"\n    },\n    Motion: {\n      interval: 100\n    }\n  }\n};\n\nexport default config;\n","size_bytes":735},"client/src/components/weekly-weigh-in-widget.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Collapsible, CollapsibleContent, CollapsibleTrigger } from \"@/components/ui/collapsible\";\nimport { Button } from \"@/components/ui/button\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ChevronDown, Scale } from \"lucide-react\";\nimport { WeightForm } from \"./weight-form\";\nimport { WeightList } from \"./weight-list\";\nimport type { WeightEntry } from \"@shared/schema\";\n\ninterface WeeklyWeighInWidgetProps {\n  onEdit?: (entry: WeightEntry) => void;\n}\n\nexport function WeeklyWeighInWidget({ onEdit }: WeeklyWeighInWidgetProps) {\n  const [isOpen, setIsOpen] = useState(false);\n\n  // Persist open state in localStorage\n  useEffect(() => {\n    const saved = localStorage.getItem('home-weight-open');\n    if (saved !== null) {\n      setIsOpen(saved === 'true');\n    }\n  }, []);\n\n  const handleOpenChange = (open: boolean) => {\n    setIsOpen(open);\n    localStorage.setItem('home-weight-open', String(open));\n  };\n\n  // Fetch latest weight entry for header display\n  const { data: weightEntries } = useQuery<WeightEntry[]>({\n    queryKey: ['/api/weights'],\n    retry: false,\n  });\n\n  const latestEntry = weightEntries?.[0];\n  const formatWeight = (weightGrams: number) => {\n    const kg = weightGrams / 1000;\n    return `${kg.toFixed(1)} kg`;\n  };\n\n  // Check if entry is due (no entry in last 7 days)\n  const isDue = !latestEntry || (new Date().getTime() - new Date(latestEntry.loggedAt).getTime()) > (7 * 24 * 60 * 60 * 1000);\n\n  return (\n    <div className=\"max-w-md mx-auto px-4 py-3\">\n      <Collapsible open={isOpen} onOpenChange={handleOpenChange}>\n        <div className=\"bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm\">\n          {/* Compact Header */}\n          <CollapsibleTrigger asChild>\n            <button \n              className=\"w-full p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg transition-colors\"\n              data-testid=\"trigger-weight\"\n            >\n              <div className=\"flex items-center space-x-3\">\n                <div className=\"bg-orange-100 dark:bg-orange-900/30 p-2 rounded-lg\">\n                  <Scale className=\"h-4 w-4 text-orange-600 dark:text-orange-400\" />\n                </div>\n                <div className=\"flex flex-col items-start\">\n                  <span className=\"font-medium text-gray-900 dark:text-gray-100 text-sm\">\n                    Weekly Weigh-In\n                  </span>\n                  <div className=\"flex items-center space-x-2\">\n                    {latestEntry ? (\n                      <span className=\"text-xs text-gray-500 dark:text-gray-400\">\n                        Last: {formatWeight(latestEntry.weightGrams)}\n                      </span>\n                    ) : (\n                      <span className=\"text-xs text-gray-500 dark:text-gray-400\">\n                        No entries yet\n                      </span>\n                    )}\n                    {isDue && (\n                      <Badge variant=\"secondary\" className=\"text-xs px-2 py-0.5\">\n                        Due this week\n                      </Badge>\n                    )}\n                  </div>\n                </div>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <Button \n                  size=\"sm\" \n                  variant=\"outline\"\n                  onClick={(e) => {\n                    e.stopPropagation();\n                    handleOpenChange(!isOpen);\n                  }}\n                  className=\"text-xs\"\n                  data-testid=\"button-log-weight\"\n                >\n                  Log\n                </Button>\n                <ChevronDown className={`h-4 w-4 text-gray-500 transition-transform ${isOpen ? 'rotate-180' : ''}`} />\n              </div>\n            </button>\n          </CollapsibleTrigger>\n\n          {/* Collapsible Content */}\n          <CollapsibleContent>\n            <div className=\"border-t border-gray-200 dark:border-gray-700 p-4 space-y-4\">\n              {/* Weight Form */}\n              <WeightForm \n                compact \n                onSuccess={() => {\n                  // Keep expanded after success to show the new entry\n                }}\n              />\n              \n              {/* Recent Weight Entries */}\n              {weightEntries && weightEntries.length > 0 && (\n                <div className=\"pt-4 border-t border-gray-100 dark:border-gray-800\">\n                  <h4 className=\"text-sm font-medium text-gray-900 dark:text-gray-100 mb-3\">\n                    Recent Entries\n                  </h4>\n                  <ScrollArea className=\"max-h-64\">\n                    <WeightList compact onEdit={onEdit} />\n                  </ScrollArea>\n                </div>\n              )}\n            </div>\n          </CollapsibleContent>\n        </div>\n      </Collapsible>\n    </div>\n  );\n}","size_bytes":5024},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"client/src/components/weight-list.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { format, parseISO } from \"date-fns\";\nimport { Edit2, Trash2, Calendar, Target, StickyNote, Camera } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle, AlertDialogTrigger } from \"@/components/ui/alert-dialog\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport type { WeightEntry } from \"@shared/schema\";\n\ninterface WeightListProps {\n  onEdit?: (entry: WeightEntry) => void;\n  displayUnit?: \"kg\" | \"lb\";\n  compact?: boolean;\n}\n\nexport function WeightList({ onEdit, displayUnit = \"kg\", compact = false }: WeightListProps) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [deleteId, setDeleteId] = useState<string | null>(null);\n  const [viewPhotoEntry, setViewPhotoEntry] = useState<WeightEntry | null>(null);\n\n  // Fetch weight entries\n  const { data: weightEntries = [], isLoading, error } = useQuery<WeightEntry[]>({\n    queryKey: ['/api/weights'],\n    select: (data) => data || [],\n  });\n\n  // Delete weight entry mutation\n  const deleteWeightMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return apiRequest('DELETE', `/api/weights/${id}`);\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Entry Deleted\",\n        description: \"Weight entry has been deleted successfully.\",\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/weights'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges/points'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges/streak'] });\n      setDeleteId(null);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to delete weight entry\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleDelete = (id: string) => {\n    deleteWeightMutation.mutate(id);\n  };\n\n  const formatWeight = (weightGrams: number): string => {\n    if (displayUnit === \"kg\") {\n      return `${(weightGrams / 1000).toFixed(1)} kg`;\n    } else {\n      return `${(weightGrams / 453.592).toFixed(1)} lb`;\n    }\n  };\n\n  const formatDate = (dateInput: string | Date): string => {\n    try {\n      const date = typeof dateInput === 'string' ? parseISO(dateInput) : dateInput;\n      return format(date, 'MMM d, yyyy');\n    } catch {\n      return dateInput.toString();\n    }\n  };\n\n  const formatFullDate = (dateInput: string | Date): string => {\n    try {\n      const date = typeof dateInput === 'string' ? parseISO(dateInput) : dateInput;\n      return format(date, 'EEEE, MMMM d, yyyy');\n    } catch {\n      return dateInput.toString();\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"bg-card border rounded-xl p-6\">\n        <h3 className=\"text-lg font-medium mb-4\">Recent Weigh-ins</h3>\n        <div className=\"space-y-3\">\n          {[1, 2, 3].map((i) => (\n            <div key={i} className=\"animate-pulse\">\n              <div className=\"h-16 bg-muted rounded-lg\"></div>\n            </div>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"bg-card border rounded-xl p-6\">\n        <h3 className=\"text-lg font-medium mb-4\">Recent Weigh-ins</h3>\n        <div className=\"text-center text-muted-foreground py-8\">\n          <p>Unable to load weight entries</p>\n          <p className=\"text-sm\">{(error as Error).message}</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (weightEntries.length === 0) {\n    return (\n      <div className=\"bg-card border rounded-xl p-6\">\n        <h3 className=\"text-lg font-medium mb-4\">Recent Weigh-ins</h3>\n        <div className=\"text-center text-muted-foreground py-8\">\n          <Target className=\"h-12 w-12 mx-auto mb-3 opacity-50\" />\n          <p>No weight entries yet</p>\n          <p className=\"text-sm\">Log your first weigh-in above to track your progress</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"bg-card border rounded-xl p-6\">\n      <div className=\"flex items-center justify-between mb-4\">\n        <h3 className=\"text-lg font-medium\">Recent Weigh-ins</h3>\n        <div className=\"text-sm text-muted-foreground\">\n          {weightEntries.length} {weightEntries.length === 1 ? 'entry' : 'entries'}\n        </div>\n      </div>\n\n      <div className=\"space-y-3\" data-testid=\"weight-entries-list\">\n        {weightEntries.map((entry, index) => (\n          <Card key={entry.id} className=\"hover:shadow-sm transition-shadow\">\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-start justify-between gap-4\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center space-x-3 mb-2\">\n                    <div className=\"flex items-center space-x-2\">\n                      <Calendar className=\"h-4 w-4 text-purple-600\" />\n                      <span \n                        className=\"font-medium\"\n                        data-testid={`weight-entry-date-${entry.id}`}\n                        title={formatFullDate(entry.loggedAt)}\n                      >\n                        {formatDate(entry.loggedAt)}\n                      </span>\n                    </div>\n                    <div className=\"flex items-center space-x-2\">\n                      <Target className=\"h-4 w-4 text-purple-600\" />\n                      <span \n                        className=\"text-lg font-bold text-purple-600\"\n                        data-testid={`weight-entry-weight-${entry.id}`}\n                      >\n                        {formatWeight(entry.weightGrams)}\n                      </span>\n                    </div>\n                  </div>\n                  \n                  {entry.imageUrl && (\n                    <div className=\"mb-2\">\n                      <button\n                        onClick={() => setViewPhotoEntry(entry)}\n                        className=\"relative group rounded-lg overflow-hidden border-2 border-gray-200 dark:border-gray-700 hover:border-blue-500 dark:hover:border-blue-400 transition-colors\"\n                        data-testid={`button-view-photo-${entry.id}`}\n                        title=\"Click to view full-size photo\"\n                      >\n                        <img \n                          src={entry.imageUrl} \n                          alt=\"Progress photo\"\n                          className=\"w-24 h-24 object-cover\"\n                        />\n                        <div className=\"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-all flex items-center justify-center\">\n                          <Camera className=\"h-6 w-6 text-white opacity-0 group-hover:opacity-100 transition-opacity\" />\n                        </div>\n                      </button>\n                    </div>\n                  )}\n                  \n                  {entry.notes && (\n                    <div className=\"flex items-start space-x-2 text-sm text-muted-foreground\">\n                      <StickyNote className=\"h-4 w-4 mt-0.5 flex-shrink-0\" />\n                      <span \n                        data-testid={`weight-entry-notes-${entry.id}`}\n                        className=\"line-clamp-2\"\n                      >\n                        {entry.notes}\n                      </span>\n                    </div>\n                  )}\n                </div>\n\n                <div className=\"flex items-center space-x-2 ml-4\">\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => onEdit?.(entry)}\n                    className=\"h-8 w-8 p-0 hover:bg-blue-50 hover:text-blue-600\"\n                    data-testid={`button-edit-weight-${entry.id}`}\n                    title=\"Edit entry\"\n                  >\n                    <Edit2 className=\"h-4 w-4\" />\n                  </Button>\n                  \n                  <AlertDialog open={deleteId === entry.id} onOpenChange={(open) => setDeleteId(open ? entry.id : null)}>\n                    <AlertDialogTrigger asChild>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        className=\"h-8 w-8 p-0 hover:bg-red-50 hover:text-red-600\"\n                        data-testid={`button-delete-weight-${entry.id}`}\n                        title=\"Delete entry\"\n                      >\n                        <Trash2 className=\"h-4 w-4\" />\n                      </Button>\n                    </AlertDialogTrigger>\n                    <AlertDialogContent data-testid=\"dialog-delete-weight\">\n                      <AlertDialogHeader>\n                        <AlertDialogTitle>Delete Weight Entry</AlertDialogTitle>\n                        <AlertDialogDescription>\n                          Are you sure you want to delete this weight entry from {formatFullDate(entry.loggedAt)}? \n                          This action cannot be undone.\n                        </AlertDialogDescription>\n                      </AlertDialogHeader>\n                      <AlertDialogFooter>\n                        <AlertDialogCancel data-testid=\"button-cancel-delete\">Cancel</AlertDialogCancel>\n                        <AlertDialogAction\n                          onClick={() => handleDelete(entry.id)}\n                          disabled={deleteWeightMutation.isPending}\n                          className=\"bg-red-600 hover:bg-red-700\"\n                          data-testid=\"button-confirm-delete\"\n                        >\n                          {deleteWeightMutation.isPending ? \"Deleting...\" : \"Delete\"}\n                        </AlertDialogAction>\n                      </AlertDialogFooter>\n                    </AlertDialogContent>\n                  </AlertDialog>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      {/* Full-screen photo viewer dialog */}\n      <Dialog open={!!viewPhotoEntry} onOpenChange={(open) => !open && setViewPhotoEntry(null)}>\n        <DialogContent className=\"max-w-4xl p-6\" data-testid=\"dialog-view-photo\">\n          <DialogHeader>\n            <DialogTitle className=\"text-xl font-semibold\">\n              Progress Photo - {viewPhotoEntry && formatFullDate(viewPhotoEntry.loggedAt)}\n            </DialogTitle>\n          </DialogHeader>\n          <div className=\"mt-4\">\n            {viewPhotoEntry?.imageUrl && (\n              <div className=\"relative rounded-lg overflow-hidden bg-gray-100 dark:bg-gray-800\">\n                <img \n                  src={viewPhotoEntry.imageUrl} \n                  alt=\"Progress photo full size\"\n                  className=\"w-full h-auto max-h-[70vh] object-contain mx-auto\"\n                  data-testid=\"img-progress-photo\"\n                />\n              </div>\n            )}\n            {viewPhotoEntry && (\n              <div className=\"mt-4 space-y-2\">\n                <div className=\"flex items-center space-x-2\">\n                  <Target className=\"h-5 w-5 text-purple-600\" />\n                  <span className=\"text-lg font-bold text-purple-600\">\n                    {formatWeight(viewPhotoEntry.weightGrams)}\n                  </span>\n                </div>\n                {viewPhotoEntry.notes && (\n                  <div className=\"flex items-start space-x-2 text-sm text-muted-foreground\">\n                    <StickyNote className=\"h-5 w-5 mt-0.5 flex-shrink-0\" />\n                    <p>{viewPhotoEntry.notes}</p>\n                  </div>\n                )}\n              </div>\n            )}\n          </div>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}","size_bytes":12013},"client/src/lib/speech-service.ts":{"content":"export interface VoiceCommand {\n  command: string;\n  phrases: string[];\n  action: () => void;\n  description: string;\n  category: 'navigation' | 'action' | 'control';\n}\n\nexport interface SpeechEvent {\n  type: 'command-recognized' | 'listening-start' | 'listening-end' | 'error' | 'no-match';\n  command?: string;\n  confidence?: number;\n  transcript?: string;\n  error?: string;\n}\n\nexport type SpeechHandler = (event: SpeechEvent) => void;\n\nclass SpeechService {\n  private recognition: any = null;\n  private isListening = false;\n  private isEnabled = false;\n  private handlers: SpeechHandler[] = [];\n  private voiceCommands: Map<string, VoiceCommand> = new Map();\n  private continuousMode = false;\n  private lastCommandTime = 0;\n  private commandTimeout = 5000; // 5 seconds timeout between commands\n\n  async initialize(): Promise<boolean> {\n    try {\n      // Check if Web Speech API is supported\n      const SpeechRecognition = window.SpeechRecognition || (window as any).webkitSpeechRecognition;\n      \n      if (!SpeechRecognition) {\n        console.warn('Speech recognition not supported in this browser');\n        return false;\n      }\n\n      this.recognition = new SpeechRecognition();\n      \n      // Configure recognition\n      this.recognition.continuous = false;\n      this.recognition.interimResults = false;\n      this.recognition.lang = 'en-US';\n      this.recognition.maxAlternatives = 3;\n\n      // Set up event handlers\n      this.recognition.onstart = () => {\n        this.isListening = true;\n        this.triggerEvent({ type: 'listening-start' });\n        console.log('ðŸŽ¤ Speech recognition started');\n      };\n\n      this.recognition.onend = () => {\n        this.isListening = false;\n        this.triggerEvent({ type: 'listening-end' });\n        console.log('ðŸŽ¤ Speech recognition ended');\n        \n        // Restart if in continuous mode and still enabled\n        if (this.continuousMode && this.isEnabled) {\n          setTimeout(() => {\n            if (this.isEnabled && !this.isListening) {\n              this.startListening();\n            }\n          }, 1000);\n        }\n      };\n\n      this.recognition.onresult = (event: any) => {\n        const results = Array.from(event.results);\n        const lastResult = results[results.length - 1] as any;\n        const transcript = lastResult?.[0]?.transcript?.toLowerCase() || '';\n        const confidence = lastResult?.[0]?.confidence || 0;\n\n        console.log(`ðŸŽ¤ Speech recognized: \"${transcript}\" (confidence: ${confidence.toFixed(2)})`);\n        \n        if (transcript) {\n          this.processVoiceCommand(transcript, confidence);\n        }\n      };\n\n      this.recognition.onerror = (event: any) => {\n        console.error('Speech recognition error:', event.error);\n        \n        // Don't treat 'aborted' as an error if we deliberately stopped\n        if (event.error === 'aborted' && !this.isEnabled) {\n          console.log('ðŸŽ¤ Speech recognition properly stopped');\n          return;\n        }\n        \n        this.triggerEvent({ \n          type: 'error', \n          error: event.error \n        });\n      };\n\n      this.recognition.onnomatch = () => {\n        console.log('ðŸŽ¤ No speech match found');\n        this.triggerEvent({ type: 'no-match' });\n      };\n\n      console.log('âœ“ Speech recognition service initialized');\n      return true;\n    } catch (error) {\n      console.error('Failed to initialize speech recognition:', error);\n      return false;\n    }\n  }\n\n  private processVoiceCommand(transcript: string, confidence: number) {\n    const now = Date.now();\n    \n    // Prevent rapid successive commands\n    if (now - this.lastCommandTime < 2000) {\n      console.log('ðŸŽ¤ Command ignored - too soon after previous command');\n      return;\n    }\n\n    // Find matching command\n    for (const [commandId, voiceCommand] of Array.from(this.voiceCommands.entries())) {\n      const matched = voiceCommand.phrases.find((phrase: string) => {\n        const words = phrase.toLowerCase().split(' ');\n        return words.every((word: string) => transcript.includes(word));\n      });\n\n      if (matched && confidence > 0.6) {\n        console.log(`ðŸŽ¤ Voice command matched: ${commandId} (\"${matched}\")`);\n        \n        this.triggerEvent({\n          type: 'command-recognized',\n          command: commandId,\n          confidence,\n          transcript\n        });\n\n        // Execute the command\n        try {\n          voiceCommand.action();\n          this.lastCommandTime = now;\n          \n          // Stop listening after successful command execution (unless in continuous mode)\n          if (!this.continuousMode) {\n            setTimeout(() => {\n              this.stopListening();\n            }, 100); // Small delay to ensure feedback is shown\n          }\n        } catch (error) {\n          console.error(`Error executing voice command ${commandId}:`, error);\n        }\n        return;\n      }\n    }\n\n    // No command matched\n    console.log(`ðŸŽ¤ No matching voice command for: \"${transcript}\"`);\n    this.triggerEvent({ \n      type: 'no-match', \n      transcript \n    });\n  }\n\n  registerCommand(id: string, command: VoiceCommand) {\n    this.voiceCommands.set(id, command);\n    console.log(`ðŸŽ¤ Registered voice command: ${id} - ${command.phrases.join(', ')}`);\n  }\n\n  unregisterCommand(id: string) {\n    this.voiceCommands.delete(id);\n  }\n\n  async startListening(continuous = false): Promise<boolean> {\n    if (!this.recognition || this.isListening) {\n      return false;\n    }\n\n    try {\n      this.continuousMode = continuous;\n      this.isEnabled = true;\n      this.recognition.start();\n      return true;\n    } catch (error) {\n      console.error('Failed to start speech recognition:', error);\n      return false;\n    }\n  }\n\n  stopListening() {\n    if (this.recognition) {\n      this.isEnabled = false;\n      this.continuousMode = false;\n      \n      // Force stop regardless of current state\n      try {\n        this.recognition.stop();\n        console.log('ðŸ›‘ Speech recognition stop requested');\n      } catch (error) {\n        console.warn('Speech recognition stop error (expected):', error);\n      }\n      \n      // Ensure state is updated\n      this.isListening = false;\n    }\n  }\n\n  isCurrentlyListening(): boolean {\n    return this.isListening;\n  }\n\n  isSpeechEnabled(): boolean {\n    return this.isEnabled;\n  }\n\n  isSupported(): boolean {\n    return !!(window.SpeechRecognition || (window as any).webkitSpeechRecognition);\n  }\n\n  on(handler: SpeechHandler) {\n    this.handlers.push(handler);\n  }\n\n  off(handler: SpeechHandler) {\n    const index = this.handlers.indexOf(handler);\n    if (index > -1) {\n      this.handlers.splice(index, 1);\n    }\n  }\n\n  private triggerEvent(event: SpeechEvent) {\n    this.handlers.forEach(handler => {\n      try {\n        handler(event);\n      } catch (error) {\n        console.error('Error in speech event handler:', error);\n      }\n    });\n  }\n\n  // Get/Set settings\n  getSettings() {\n    return {\n      enabled: localStorage.getItem('platemate-speech-enabled') === 'true',\n      continuous: localStorage.getItem('platemate-speech-continuous') === 'true',\n      wakeWord: localStorage.getItem('platemate-wake-word') || 'hey platemate',\n      voiceConfirmation: localStorage.getItem('platemate-voice-confirmation') !== 'false'\n    };\n  }\n\n  updateSettings(settings: {\n    enabled?: boolean;\n    continuous?: boolean;\n    wakeWord?: string;\n    voiceConfirmation?: boolean;\n  }) {\n    Object.entries(settings).forEach(([key, value]) => {\n      if (value !== undefined) {\n        localStorage.setItem(`platemate-${key.replace(/([A-Z])/g, '-$1').toLowerCase()}`, value.toString());\n      }\n    });\n  }\n\n  // Get available commands for help\n  getAvailableCommands(): VoiceCommand[] {\n    return Array.from(this.voiceCommands.values());\n  }\n}\n\n// Extend window interface for TypeScript\ndeclare global {\n  interface Window {\n    SpeechRecognition: any;\n    webkitSpeechRecognition: any;\n  }\n  \n  interface SpeechRecognitionEvent extends Event {\n    results: SpeechRecognitionResultList;\n    resultIndex: number;\n  }\n  \n  interface SpeechRecognitionErrorEvent extends Event {\n    error: string;\n    message?: string;\n  }\n}\n\nexport const speechService = new SpeechService();","size_bytes":8217},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","size_bytes":710},"server/ai-providers/gemini-provider.ts":{"content":"import { GoogleGenAI } from \"@google/genai\";\nimport { promises as fs } from \"fs\";\nimport { AIProvider, FoodAnalysisResult, FoodDetectionResult, DietAdviceResult, DiaryEntry, ProviderError, DailyCoaching, EducationalTip } from \"./types\";\nimport { mapUKFoodTerms } from \"../uk-food-mapping\";\n\nexport class GeminiProvider extends AIProvider {\n  public readonly name = \"Gemini\";\n  public readonly priority = 1; // Highest priority (free, unlimited)\n  public readonly maxRetries = 2;\n\n  private client: GoogleGenAI;\n\n  constructor() {\n    super();\n    this.client = new GoogleGenAI({ \n      apiKey: process.env.GEMINI_API_KEY || \"\" \n    });\n  }\n\n  async performHealthCheck(): Promise<any> {\n    const startTime = Date.now();\n    \n    try {\n      if (!process.env.GEMINI_API_KEY) {\n        throw new Error(\"GEMINI_API_KEY not configured\");\n      }\n\n      const response = await this.client.models.generateContent({\n        model: \"gemini-2.5-flash\",\n        contents: \"Health check\",\n      });\n\n      const responseTime = Date.now() - startTime;\n      \n      return {\n        providerName: this.name,\n        healthy: true,\n        responseTime,\n        timestamp: new Date(),\n        details: {\n          model: \"gemini-2.5-flash\",\n          apiVersion: \"1.0\"\n        }\n      };\n    } catch (error: any) {\n      const responseTime = Date.now() - startTime;\n      \n      return {\n        providerName: this.name,\n        healthy: false,\n        responseTime,\n        error: error.message,\n        timestamp: new Date()\n      };\n    }\n  }\n\n  async analyzeFoodImage(imagePath: string): Promise<FoodAnalysisResult> {\n    try {\n      if (!process.env.GEMINI_API_KEY) {\n        throw new Error(\"GEMINI_API_KEY not configured\");\n      }\n\n      // Read image file\n      const imageBytes = await fs.readFile(imagePath);\n      \n      const contents = [\n        {\n          inlineData: {\n            data: imageBytes.toString(\"base64\"),\n            mimeType: \"image/jpeg\",\n          },\n        },\n        `Analyze this food image and identify all visible food items with high accuracy. Focus on recognizing common meals, dishes, and ingredients that people typically eat.\n\nIMPORTANT: Look for reference objects in the image to help estimate scale and portion sizes:\n- Plate, bowl, or dish (standard dinner plate = 10-12 inches)\n- Utensils (fork = 7 inches, spoon = 6 inches)  \n- Hand or fingers for scale\n- Common objects like coins, phones, etc.\n\nPORTION ESTIMATION GUIDELINES - BE CONSERVATIVE AND REALISTIC:\n- Default to MEDIUM portions unless the image clearly shows otherwise\n- Don't over-estimate portion sizes or assume extra toppings you can't see\n- Explicitly state what toppings/ingredients you can actually see in the image\n- If in doubt about portion size, choose the smaller estimate\n\nCRITICAL UK FOOD PORTIONS WITH TYPICAL CALORIE RANGES:\n- Jacket potato (plain): Medium (200g) = ~150-180 cal | with butter (10g) add ~70 cal | with cheese (30g) add ~100 cal\n  * Only add toppings you can CLEARLY SEE in the image\n  * Jacket potato >600 cal is almost certainly wrong unless it's massive with lots of visible toppings\n- UK crisps/chips: Single-serve packet = 25g (~130 cal) | sharing bag = 150g (~780 cal)\n- Fish & chips: Medium portion = ~600-700 cal total (fish 250g = 450 cal, chips 200g = 300 cal)\n- Full English breakfast: Standard = ~800-1000 cal (2 eggs, 2 bacon, 2 sausages, beans, toast, mushrooms, tomato)\n- Sandwich: Standard = 250-400 cal depending on fillings\n- Pasta dish (cooked): Medium portion 300g = 400-600 cal depending on sauce\n\nPROTEIN SHAKES & SUPPLEMENTS (CRITICAL):\n- Protein shakes, Herbalife, protein powder, BCAAs, pre-workout drinks are made with WATER (not milk) unless milk is explicitly visible\n- If you see protein powder/shake but no milk carton/bottle in the image, assume it's made with water\n- Examples: \"Herbalife shake made with water\", \"protein powder with water\", \"BCAA drink\"\n- Only specify \"made with milk\" if you can actually see milk being used in the image\n\nGuidelines for accurate food identification:\n- Focus on identifying actual food items, not random objects\n- Look for typical breakfast, lunch, dinner, or snack foods\n- Consider the context - is this a meal photo, home cooking, restaurant food?\n- If something looks unclear, err on the side of common foods rather than exotic items\n- Only identify foods you can clearly see and recognize\n- EXPLICITLY STATE VISIBLE TOPPINGS (e.g., \"jacket potato with visible cheese and beans\" vs \"plain jacket potato\")\n\nFor each food item detected, provide ONLY the food name and estimated portion - DO NOT include nutritional information as we will look that up from the USDA database for accuracy.\n\nReturn the response as a JSON object with this exact structure:\n\n{\n  \"confidence\": number (0-100),\n  \"referenceObjects\": [\"list of reference objects spotted for scale estimation\"],\n  \"detectedFoods\": [\n    {\n      \"name\": \"Food Name with visible toppings/ingredients clearly stated\",\n      \"portion\": \"estimated portion size with weight/volume (be conservative)\",\n      \"icon\": \"appropriate icon name from: egg, bacon, bread-slice, apple-alt\"\n    }\n  ]\n}\n\nFocus on accurate food identification and CONSERVATIVE portion estimation using any reference objects you can see. Be specific with portions (e.g., \"100g\", \"1 medium slice\", \"150ml\", \"25g\" for UK crisps). Only return the JSON object, no additional text.`,\n      ];\n\n      const response = await this.client.models.generateContent({\n        model: \"gemini-2.5-flash\",\n        contents: contents,\n      });\n\n      const responseText = response.text;\n      \n      if (!responseText) {\n        throw new Error(\"No response from Gemini\");\n      }\n\n      // Clean the response text by removing markdown formatting\n      const cleanedText = responseText\n        .replace(/```json\\s*/g, '')\n        .replace(/```\\s*/g, '')\n        .trim();\n\n      // Parse the JSON response\n      const parsed = JSON.parse(cleanedText);\n      \n      // Validate the response structure\n      if (!parsed.detectedFoods || !Array.isArray(parsed.detectedFoods)) {\n        throw new Error(\"Invalid response format from Gemini\");\n      }\n\n      // Convert to legacy format with mock nutrition - will be replaced by USDA lookup\n      const mockNutritionFoods = parsed.detectedFoods.map((food: any) => ({\n        name: food.name,\n        portion: food.portion,\n        calories: 100, // Mock - will be replaced by USDA lookup\n        protein: 5,\n        carbs: 10,\n        fat: 3,\n        icon: food.icon\n      }));\n\n      // Calculate totals from mock data\n      const totalCalories = mockNutritionFoods.reduce((sum: number, food: any) => sum + food.calories, 0);\n      const totalProtein = mockNutritionFoods.reduce((sum: number, food: any) => sum + food.protein, 0);\n      const totalCarbs = mockNutritionFoods.reduce((sum: number, food: any) => sum + food.carbs, 0);\n      const totalFat = mockNutritionFoods.reduce((sum: number, food: any) => sum + food.fat, 0);\n\n      const result: FoodAnalysisResult = {\n        imageUrl: imagePath,\n        confidence: Math.round(parsed.confidence || 80),\n        totalCalories,\n        totalProtein,\n        totalCarbs,\n        totalFat,\n        detectedFoods: mockNutritionFoods,\n        // Store reference objects in a custom property for now\n        referenceObjects: parsed.referenceObjects || []\n      } as any;\n\n      this.recordSuccess();\n      return result;\n\n    } catch (error: any) {\n      console.error(\"Gemini food analysis error:\", error);\n      \n      let providerError: ProviderError;\n      \n      if (error?.message?.includes('quota') || error?.message?.includes('rate')) {\n        providerError = this.createError(\n          'RATE_LIMIT',\n          'Gemini rate limit exceeded',\n          true,\n          true,\n          120 // Retry after 2 minutes\n        );\n      } else if (error?.message?.includes('GEMINI_API_KEY')) {\n        providerError = this.createError(\n          'CONFIG_ERROR',\n          'Gemini API key not configured',\n          false,\n          false\n        );\n      } else {\n        providerError = this.createError(\n          'ANALYSIS_ERROR',\n          `Gemini analysis failed: ${error.message}`,\n          false,\n          true,\n          60\n        );\n      }\n      \n      this.recordError(providerError);\n      throw providerError;\n    }\n  }\n\n  async detectFoodNames(imagePath: string): Promise<FoodDetectionResult> {\n    try {\n      if (!process.env.GEMINI_API_KEY) {\n        throw new Error(\"GEMINI_API_KEY not configured\");\n      }\n\n      // Read image file\n      const imageBytes = await fs.readFile(imagePath);\n      \n      const contents = [\n        {\n          inlineData: {\n            data: imageBytes.toString(\"base64\"),\n            mimeType: \"image/jpeg\",\n          },\n        },\n        `Analyze this food image and identify all visible food items. Return ONLY the food names, separated by commas.\n\nExamples:\n- \"banana, chicken breast, broccoli\"\n- \"pizza, salad\"\n- \"rice, beans, grilled chicken\"\n\nDO NOT provide nutrition information, portions, or any other details. Only return the food names as a simple comma-separated list.\n\nIf you can't clearly identify something, don't include it. Be as accurate as possible with food identification.`,\n      ];\n\n      const response = await this.client.models.generateContent({\n        model: \"gemini-2.5-flash\",\n        contents: contents,\n      });\n\n      const responseText = response.text;\n      \n      if (!responseText) {\n        throw new Error(\"No response from Gemini\");\n      }\n\n      console.log(`ðŸ¤– Gemini detected food names: ${responseText}`);\n\n      // Parse the comma-separated food names\n      const detectedFoodNames = responseText\n        .split(',')\n        .map(name => name.trim())\n        .filter(name => name.length > 0);\n\n      const result: FoodDetectionResult = {\n        confidence: 80, // Default confidence for food detection\n        detectedFoodNames\n      };\n\n      this.recordSuccess();\n      return result;\n\n    } catch (error: any) {\n      console.error(\"Gemini food detection error:\", error);\n      \n      let providerError: ProviderError;\n      \n      if (error?.message?.includes('quota') || error?.message?.includes('rate')) {\n        providerError = this.createError(\n          'RATE_LIMIT',\n          'Gemini rate limit exceeded',\n          true,\n          true,\n          120 // Retry after 2 minutes\n        );\n      } else if (error?.message?.includes('GEMINI_API_KEY')) {\n        providerError = this.createError(\n          'CONFIG_ERROR',\n          'Gemini API key not configured',\n          false,\n          false\n        );\n      } else {\n        providerError = this.createError(\n          'DETECTION_ERROR',\n          `Gemini food detection failed: ${error.message}`,\n          false,\n          true,\n          60\n        );\n      }\n      \n      this.recordError(providerError);\n      throw providerError;\n    }\n  }\n\n  async analyzeFoodText(foodDescription: string, clientTimeInfo?: { timeString: string, timeOfDay: string, hours: number, minutes: number }): Promise<FoodAnalysisResult> {\n    try {\n      if (!process.env.GEMINI_API_KEY) {\n        throw new Error(\"GEMINI_API_KEY not configured\");\n      }\n\n      // Apply UK to US food term mapping BEFORE sending to AI\n      const mappedDescription = mapUKFoodTerms(foodDescription);\n\n      // Add time context for better analysis (use client's local time if provided, otherwise server time)\n      let timeString: string;\n      let timeOfDay: string;\n      \n      if (clientTimeInfo) {\n        // Use pre-calculated client local time (no timezone conversion needed)\n        timeString = clientTimeInfo.timeString;\n        timeOfDay = clientTimeInfo.timeOfDay;\n      } else {\n        // Fallback to server time\n        const now = new Date();\n        const hours = now.getHours();\n        const minutes = now.getMinutes();\n        timeString = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;\n        timeOfDay = hours < 12 ? 'morning' : hours < 17 ? 'afternoon' : 'evening';\n      }\n\n      const prompt = `Current time: ${timeString} (${timeOfDay})\n\nAnalyze this food description and extract nutritional information. Parse the quantity, unit, and food name from: \"${mappedDescription}\"\n\nUK FOOD VOCABULARY - THESE ARE SINGLE ITEMS (DO NOT SPLIT):\n- \"jacket potato\" = baked potato (ONE item, not \"bread\" and \"potato\")\n- \"fish and chips\" = ONE dish (battered fish + chips together)\n- \"full English\" = ONE breakfast (eggs, bacon, sausages, beans, toast, etc.)\n- \"beans on toast\" = ONE item\n- Examples:\n  * \"jacket potato\" â†’ [{\"name\": \"Baked potato (jacket potato)\", \"portion\": \"1 medium (200g)\"}] âœ“ CORRECT\n  * \"jacket potato\" â†’ [{\"name\": \"Bread, potato\"}] âœ— WRONG - Do NOT split!\n\nCRITICAL FOOD INTERPRETATION RULES:\n- \"rice\" = cooked white/brown rice (NOT rice paper, rice cakes, or rice noodles)\n- \"chicken\" = grilled/baked chicken breast unless specified otherwise\n- \"beef\" = lean beef/ground beef\n- \"pasta\" = cooked pasta (NOT raw weight)\n- \"bread\" = sliced bread\n- When user says \"X and Y\" (e.g., \"chicken and rice\"), create TWO separate food items\n- BUT: UK food names like \"jacket potato\" are SINGLE items even if they contain multiple words\n\nCOMMON MEAL EXAMPLES:\n- \"chicken and rice\" â†’ [{\"name\": \"Grilled chicken breast\", \"portion\": \"150g\"}, {\"name\": \"Cooked white rice\", \"portion\": \"200g\"}]\n- \"salmon and broccoli\" â†’ [{\"name\": \"Baked salmon fillet\", \"portion\": \"150g\"}, {\"name\": \"Steamed broccoli\", \"portion\": \"100g\"}]\n- \"eggs and toast\" â†’ [{\"name\": \"Scrambled eggs\", \"portion\": \"2 large eggs\"}, {\"name\": \"Whole wheat bread\", \"portion\": \"2 slices\"}]\n- \"jacket potato\" â†’ [{\"name\": \"Baked potato (jacket potato)\", \"portion\": \"1 medium (200g)\"}]\n\nPORTION ESTIMATION - BE CONSERVATIVE AND REALISTIC:\n- Default to MEDIUM portions unless specified\n- Don't over-estimate or assume extra toppings not mentioned\n- If in doubt, choose the smaller estimate\n\nDEFAULT PORTION SIZES (use when not specified):\n- Jacket potato: 1 medium (200g) plain = ~150-180 cal\n- Chicken breast: 150g cooked\n- Fish fillet: 150g cooked\n- Rice (cooked): 200g (1 cup)\n- Pasta (cooked): 200g (1 cup)\n- Vegetables: 100g\n- Eggs: 2 large\n- Bread: 2 slices\n\nCRITICAL UK FOOD PORTIONS WITH TYPICAL CALORIE RANGES:\n- Jacket potato (plain): Medium (200g) = ~150-180 cal | with butter add ~70 cal | with cheese add ~100 cal\n  * Jacket potato >600 cal is almost certainly wrong unless massive with lots of toppings\n- UK crisps: Single-serve packet = 25g (~130 cal)\n- Fish & chips: Medium portion = ~600-700 cal total\n- Full English breakfast: Standard = ~800-1000 cal\n- Sandwich: Standard = 250-400 cal depending on fillings\n\nCRITICAL QUANTITY HANDLING:\n- If user specifies quantity (e.g., \"4 Weetabix\", \"2 eggs\"), multiply nutrition by that quantity\n- Preserve original portion description with quantity\n\nSANITY CHECKS - Flag if values seem wrong:\n- Jacket potato >600 cal is suspicious\n- Simple meal >800 calories is suspicious\n- Chicken breast >250 cal per 100g is wrong\n- Rice >150 cal per 100g cooked is wrong\n- Single egg >80 calories is wrong\n\nProvide accurate nutritional information based on standard USDA values. Return the response as a JSON object with this exact structure:\n\n{\n  \"confidence\": number (0-100),\n  \"detectedFoods\": [\n    {\n      \"name\": \"Simple, basic food name (e.g., 'Grilled chicken breast', 'Baked potato (jacket potato)')\",\n      \"portion\": \"Specific amount with unit (e.g., '150g', '2 large eggs', '1 medium (200g)')\",\n      \"quantity\": number (default 1),\n      \"calories\": number (per 100g: chicken ~165, rice ~130, egg ~72 each, potato plain ~80),\n      \"protein\": number,\n      \"carbs\": number,\n      \"fat\": number,\n      \"icon\": \"ðŸ½ï¸\"\n    }\n  ]\n}\n\nIMPORTANT: UK food names like \"jacket potato\" are SINGLE items - do NOT split them! Use realistic portions and accurate nutrition values. Only return the JSON object, no additional text.`;\n\n      const response = await this.client.models.generateContent({\n        model: \"gemini-2.5-flash\",\n        contents: prompt,\n      });\n\n      const responseText = response.text;\n      \n      if (!responseText) {\n        throw new Error(\"No response from Gemini\");\n      }\n\n      // Clean the response text by removing markdown formatting\n      const cleanedText = responseText\n        .replace(/```json\\s*/g, '')\n        .replace(/```\\s*/g, '')\n        .trim();\n\n      // Parse the JSON response\n      const parsed = JSON.parse(cleanedText);\n      \n      // Validate the response structure\n      if (!parsed.detectedFoods || !Array.isArray(parsed.detectedFoods)) {\n        throw new Error(\"Invalid response format from Gemini\");\n      }\n\n      // Calculate totals and round to integers for database compatibility\n      const totalCalories = Math.round(parsed.detectedFoods.reduce((sum: number, food: any) => sum + (food.calories || 0), 0));\n      const totalProtein = Math.round(parsed.detectedFoods.reduce((sum: number, food: any) => sum + (food.protein || 0), 0));\n      const totalCarbs = Math.round(parsed.detectedFoods.reduce((sum: number, food: any) => sum + (food.carbs || 0), 0));\n      const totalFat = Math.round(parsed.detectedFoods.reduce((sum: number, food: any) => sum + (food.fat || 0), 0));\n\n      // Round nutritional values in detected foods\n      const roundedDetectedFoods = parsed.detectedFoods.map((food: any) => ({\n        ...food,\n        calories: Math.round(food.calories || 0),\n        protein: Math.round(food.protein || 0),\n        carbs: Math.round(food.carbs || 0),\n        fat: Math.round(food.fat || 0),\n        icon: food.icon || 'ðŸ½ï¸'\n      }));\n\n      const result: FoodAnalysisResult = {\n        imageUrl: `voice-input-${Date.now()}.txt`, // Placeholder for voice input\n        confidence: Math.round(parsed.confidence || 85),\n        totalCalories,\n        totalProtein,\n        totalCarbs,\n        totalFat,\n        detectedFoods: roundedDetectedFoods\n      };\n\n      this.recordSuccess();\n      return result;\n\n    } catch (error: any) {\n      console.error(\"Gemini text analysis error:\", error);\n      \n      let providerError: ProviderError;\n      \n      if (error?.message?.includes('quota') || error?.message?.includes('rate')) {\n        providerError = this.createError(\n          'RATE_LIMIT',\n          'Gemini rate limit exceeded',\n          true,\n          true,\n          120 // Retry after 2 minutes\n        );\n      } else if (error?.message?.includes('GEMINI_API_KEY')) {\n        providerError = this.createError(\n          'CONFIG_ERROR',\n          'Gemini API key not configured',\n          false,\n          false\n        );\n      } else {\n        providerError = this.createError(\n          'ANALYSIS_ERROR',\n          `Gemini text analysis failed: ${error.message}`,\n          false,\n          false\n        );\n      }\n      \n      this.recordError(providerError);\n      throw providerError;\n    }\n  }\n\n  async generateDietAdvice(entries: DiaryEntry[], userProfile?: any): Promise<DietAdviceResult> {\n    try {\n      if (!process.env.GEMINI_API_KEY) {\n        throw new Error(\"GEMINI_API_KEY not configured\");\n      }\n\n      // Analyze eating patterns\n      const totalEntries = entries.length;\n      const totalCalories = entries.reduce((sum, entry) => sum + (entry.analysis?.totalCalories || 0), 0);\n      const avgCalories = totalCalories / totalEntries;\n      \n      const totalProtein = entries.reduce((sum, entry) => sum + (entry.analysis?.totalProtein || 0), 0);\n      const totalCarbs = entries.reduce((sum, entry) => sum + (entry.analysis?.totalCarbs || 0), 0);\n      const totalFat = entries.reduce((sum, entry) => sum + (entry.analysis?.totalFat || 0), 0);\n      \n      // Count meal types\n      const mealTypeCounts = entries.reduce((counts, entry) => {\n        counts[entry.mealType] = (counts[entry.mealType] || 0) + 1;\n        return counts;\n      }, {} as Record<string, number>);\n\n      const analysisData = {\n        totalMeals: totalEntries,\n        averageCalories: Math.round(avgCalories),\n        totalNutrients: {\n          protein: Math.round(totalProtein),\n          carbs: Math.round(totalCarbs),\n          fat: Math.round(totalFat)\n        },\n        mealPattern: mealTypeCounts,\n        recentFoods: entries.slice(0, 10).map(entry => \n          entry.analysis?.detectedFoods?.map((food: any) => food.name).join(', ') || 'Unknown'\n        ).filter(Boolean),\n        userProfile: userProfile ? {\n          age: userProfile.age,\n          sex: userProfile.sex,\n          heightCm: userProfile.heightCm,\n          currentWeightKg: userProfile.currentWeightKg,\n          goalWeightKg: userProfile.goalWeightKg,\n          activityLevel: userProfile.activityLevel,\n          weightGoal: userProfile.weightGoal,\n          weeklyWeightChangeKg: userProfile.weeklyWeightChangeKg,\n          medication: userProfile.medication\n        } : null\n      };\n\n      const systemPrompt = `You are a certified nutritionist and diet advisor. \nAnalyze the user's eating patterns and personal profile to provide highly personalized advice including specific meal ideas tailored to their individual needs, goals, health considerations, and lifestyle factors.\nRespond with JSON in this format: \n{\n  \"personalizedAdvice\": [\"advice based on specific patterns...\"],\n  \"nutritionGoals\": [\"specific goals to work towards...\"],\n  \"improvements\": [\"areas where can improve...\"],\n  \"generalTips\": [\"helpful nutrition tips...\"],\n  \"mealIdeas\": [\n    {\n      \"mealType\": \"breakfast/lunch/dinner/snack\",\n      \"name\": \"Meal Name\",\n      \"description\": \"Brief description of the meal\",\n      \"calories\": 400,\n      \"protein\": 25,\n      \"carbs\": 35,\n      \"fat\": 15,\n      \"ingredients\": [\"ingredient1\", \"ingredient2\", \"ingredient3\"],\n      \"benefits\": \"Why this meal is good for the user based on their patterns\",\n      \"recipeLink\": \"https://www.example.com/recipe-name\",\n      \"cookingInstructions\": [\n        \"Step 1: Brief cooking instruction\",\n        \"Step 2: Next step in preparation\",\n        \"Step 3: Final cooking steps\"\n      ]\n    }\n  ]\n}\n\nGenerate 4-6 meal ideas that address the user's specific nutritional needs, deficiencies, and goals based on their eating patterns AND personal profile (age, sex, weight goals, activity level, medication). Consider their current vs goal weight, activity level, and any weight loss medication when recommending portions and meal types. Include a variety of meal types (breakfast, lunch, dinner, snacks). For each meal idea, include a realistic recipe link (use popular cooking websites like allrecipes.com, foodnetwork.com, or BBC Good Food) and provide 3-4 simple cooking instructions. Keep advice items to 1-2 sentences. Be encouraging and specific. Focus on practical, actionable advice that considers their personal goals and health status.`;\n\n      const userPrompt = `Analyze my eating patterns and personal profile to provide highly personalized diet advice with meal ideas tailored specifically to my goals, health status, and lifestyle. Here's my comprehensive data from the last 30 days:\n\n${JSON.stringify(analysisData, null, 2)}`;\n\n      const response = await this.client.models.generateContent({\n        model: \"gemini-2.5-pro\",\n        config: {\n          systemInstruction: systemPrompt,\n          responseMimeType: \"application/json\",\n          responseSchema: {\n            type: \"object\",\n            properties: {\n              personalizedAdvice: { type: \"array\", items: { type: \"string\" } },\n              nutritionGoals: { type: \"array\", items: { type: \"string\" } },\n              improvements: { type: \"array\", items: { type: \"string\" } },\n              generalTips: { type: \"array\", items: { type: \"string\" } },\n              mealIdeas: {\n                type: \"array\",\n                items: {\n                  type: \"object\",\n                  properties: {\n                    mealType: { type: \"string\", enum: [\"breakfast\", \"lunch\", \"dinner\", \"snack\"] },\n                    name: { type: \"string\" },\n                    description: { type: \"string\" },\n                    calories: { type: \"number\" },\n                    protein: { type: \"number\" },\n                    carbs: { type: \"number\" },\n                    fat: { type: \"number\" },\n                    ingredients: { type: \"array\", items: { type: \"string\" } },\n                    benefits: { type: \"string\" },\n                    recipeLink: { type: \"string\" },\n                    cookingInstructions: { type: \"array\", items: { type: \"string\" } }\n                  },\n                  required: [\"mealType\", \"name\", \"description\", \"calories\", \"protein\", \"carbs\", \"fat\", \"ingredients\", \"benefits\", \"recipeLink\", \"cookingInstructions\"]\n                }\n              }\n            },\n            required: [\"personalizedAdvice\", \"nutritionGoals\", \"improvements\", \"generalTips\", \"mealIdeas\"],\n          },\n        },\n        contents: userPrompt,\n      });\n\n      const responseText = response.text;\n      \n      if (!responseText) {\n        throw new Error(\"No response from Gemini\");\n      }\n\n      const adviceData = JSON.parse(responseText);\n      \n      this.recordSuccess();\n      return adviceData;\n\n    } catch (error: any) {\n      console.error(\"Gemini diet advice error:\", error);\n      \n      let providerError: ProviderError;\n      \n      if (error?.message?.includes('quota') || error?.message?.includes('rate')) {\n        providerError = this.createError(\n          'RATE_LIMIT',\n          'Gemini rate limit exceeded',\n          true,\n          true,\n          120\n        );\n      } else if (error?.message?.includes('GEMINI_API_KEY')) {\n        providerError = this.createError(\n          'CONFIG_ERROR',\n          'Gemini API key not configured',\n          false,\n          false\n        );\n      } else {\n        providerError = this.createError(\n          'ADVICE_ERROR',\n          `Gemini advice generation failed: ${error.message}`,\n          false,\n          true,\n          60\n        );\n      }\n      \n      this.recordError(providerError);\n      throw providerError;\n    }\n  }\n\n  private prepareNutritionContextData(entries: DiaryEntry[]) {\n    if (!entries || entries.length === 0) {\n      return \"No recent meal data available.\";\n    }\n\n    const summary = {\n      totalMeals: entries.length,\n      recentMeals: entries.slice(0, 10).map(entry => ({\n        date: entry.createdAt.toISOString().split('T')[0],\n        mealType: entry.mealType,\n        calories: entry.analysis?.totalCalories || 0,\n        protein: entry.analysis?.totalProtein || 0,\n        carbs: entry.analysis?.totalCarbs || 0,\n        fat: entry.analysis?.totalFat || 0,\n        foods: entry.analysis?.detectedFoods?.map(f => f.name).join(', ') || 'Unknown'\n      })),\n      averageDaily: {\n        calories: Math.round(entries.reduce((sum, e) => sum + (e.analysis?.totalCalories || 0), 0) / Math.max(entries.length, 1)),\n        protein: Math.round(entries.reduce((sum, e) => sum + (e.analysis?.totalProtein || 0), 0) / Math.max(entries.length, 1)),\n        carbs: Math.round(entries.reduce((sum, e) => sum + (e.analysis?.totalCarbs || 0), 0) / Math.max(entries.length, 1)),\n        fat: Math.round(entries.reduce((sum, e) => sum + (e.analysis?.totalFat || 0), 0) / Math.max(entries.length, 1))\n      }\n    };\n\n    return JSON.stringify(summary, null, 2);\n  }\n\n  async answerNutritionQuestion(\n    question: string, \n    entries: DiaryEntry[], \n    userProfile?: any,\n    nutritionGoals?: any,\n    coachMemory?: any,\n    personality?: any,\n    clientTimeInfo?: { timeString: string, timeOfDay: string, hours: number, minutes: number }\n  ): Promise<string> {\n    try {\n      // Prepare context from user's nutrition data\n      const contextData = this.prepareNutritionContextData(entries);\n      \n      // Build profile context if available\n      let profileContext = \"\";\n      let userDisplayName = \"\";\n      if (userProfile) {\n        const profileParts = [];\n        \n        // Set user display name (prefer nickname, fall back to name)\n        if (userProfile.nickname) {\n          userDisplayName = userProfile.nickname;\n          profileParts.push(`Preferred Name: ${userProfile.nickname}`);\n        } else if (userProfile.name) {\n          userDisplayName = userProfile.name;\n          profileParts.push(`Name: ${userProfile.name}`);\n        }\n        \n        if (userProfile.dietaryRequirements && userProfile.dietaryRequirements.length > 0) {\n          profileParts.push(`Dietary Requirements: ${userProfile.dietaryRequirements.join(', ')}`);\n        }\n        if (userProfile.allergies && userProfile.allergies.length > 0) {\n          profileParts.push(`Allergies/Intolerances: ${userProfile.allergies.join(', ')}`);\n        }\n        if (userProfile.foodDislikes) {\n          profileParts.push(`Foods They Dislike: ${userProfile.foodDislikes}`);\n        }\n        if (userProfile.healthConditions) {\n          profileParts.push(`Health Conditions: ${userProfile.healthConditions}`);\n        }\n        \n        if (profileParts.length > 0) {\n          profileContext = `\\n\\nUser Profile:\\n${profileParts.join('\\n')}`;\n        }\n      }\n      \n      // Build coach memory context if available\n      let memoryContext = \"\";\n      if (coachMemory) {\n        const memoryParts = [];\n        \n        if (coachMemory.age) memoryParts.push(`Age: ${coachMemory.age}`);\n        if (coachMemory.occupation) memoryParts.push(`Occupation: ${coachMemory.occupation}`);\n        if (coachMemory.lifestyleDetails) memoryParts.push(`Lifestyle: ${coachMemory.lifestyleDetails}`);\n        if (coachMemory.workSchedule) memoryParts.push(`Work Schedule: ${coachMemory.workSchedule}`);\n        if (coachMemory.exerciseFrequency) memoryParts.push(`Exercise Frequency: ${coachMemory.exerciseFrequency}`);\n        if (coachMemory.interests && coachMemory.interests.length > 0) {\n          memoryParts.push(`Interests: ${coachMemory.interests.join(', ')}`);\n        }\n        if (coachMemory.fitnessGoals) memoryParts.push(`Fitness Goals: ${coachMemory.fitnessGoals}`);\n        if (coachMemory.stressGoals) memoryParts.push(`Stress Management Goals: ${coachMemory.stressGoals}`);\n        if (coachMemory.sleepGoals) memoryParts.push(`Sleep Goals: ${coachMemory.sleepGoals}`);\n        if (coachMemory.mentalHealthGoals) memoryParts.push(`Mental Health Goals: ${coachMemory.mentalHealthGoals}`);\n        \n        if (memoryParts.length > 0) {\n          memoryContext = `\\n\\nPersonal Information:\\n${memoryParts.join('\\n')}`;\n        }\n      }\n      \n      // Build goals context if available\n      let goalsContext = \"\";\n      if (nutritionGoals) {\n        const goalsParts = [];\n        if (nutritionGoals.caloriesGoal) goalsParts.push(`Calorie Goal: ${nutritionGoals.caloriesGoal} kcal`);\n        if (nutritionGoals.proteinGoal) goalsParts.push(`Protein Goal: ${nutritionGoals.proteinGoal}g`);\n        if (nutritionGoals.carbsGoal) goalsParts.push(`Carbs Goal: ${nutritionGoals.carbsGoal}g`);\n        if (nutritionGoals.fatGoal) goalsParts.push(`Fat Goal: ${nutritionGoals.fatGoal}g`);\n        if (nutritionGoals.waterGoal) goalsParts.push(`Water Goal: ${nutritionGoals.waterGoal} glasses`);\n        \n        if (goalsParts.length > 0) {\n          goalsContext = `\\n\\nNutrition Goals:\\n${goalsParts.join('\\n')}`;\n        }\n      }\n      \n      // Get personality settings or use defaults\n      const personalitySettings = personality || {\n        name: 'Zen Wellness Coach',\n        systemPrompt: 'You are a calm, mindful wellness coach who focuses on balance and self-compassion.',\n        greetingPhrase: 'Welcome! Let\\'s work together on your journey to better health.',\n        encouragementPhrases: ['You\\'re doing great!', 'Every step forward is progress.'],\n        responseStyle: {\n          tone: 'Calm and supportive',\n          formality: 'Casual',\n          emoji: false,\n          directness: 'Gentle'\n        }\n      };\n      \n      // Extract shift pattern information from user profile\n      let shiftGuidance = \"\";\n      if (userProfile) {\n        const today = new Date().toISOString().split('T')[0];\n        let currentShift = userProfile.defaultShiftType || 'regular';\n        \n        // Use today's override if set\n        if (userProfile.todayShiftDate === today && userProfile.todayShiftType) {\n          currentShift = userProfile.todayShiftType;\n        }\n        \n        // Build shift-specific guidance\n        if (currentShift === 'day_off') {\n          shiftGuidance = `\\n\\nSHIFT PATTERN GUIDANCE (Day Off):\nThe user has no shift today. They have more flexibility for meal timing and preparation.\n- Suggest balanced meals throughout the day at regular intervals\n- This is a good opportunity for meal prep or batch cooking\n- Recommend more complex recipes that require time`;\n        } else if (currentShift === 'night_shift') {\n          shiftGuidance = `\\n\\nSHIFT PATTERN GUIDANCE (Night Shift):\nThe user is working overnight hours. Adapt all meal advice for night shift:\n- Avoid heavy carbs during night hours (causes drowsiness)\n- Focus on meals that stabilize blood sugar without disrupting post-shift sleep\n- Recommend protein-rich snacks to maintain energy during shift\n- Suggest light, easily digestible meals before bedtime after shift\n- Adjust circadian calorie timing (lower calories after midnight, more before shift)`;\n        } else if (currentShift === 'long_shift') {\n          shiftGuidance = `\\n\\nSHIFT PATTERN GUIDANCE (Long 12.5hr Clinical Shift):\nThe user is working a long NHS/emergency shift with limited eating windows.\n- Compress meal suggestions into 2-3 slots (pre-shift + breaks)\n- Recommend meals that can be eaten cold or reheated quickly\n- Increase calories in pre-shift meal to prevent hunger\n- Suggest portable, easy-to-eat foods (wraps, protein bars, fruit)\n- Add post-shift recovery meal with protein and anti-inflammatory foods\n${userProfile.customBreakWindows && userProfile.customBreakWindows.length > 0 ? `- Break times available: ${userProfile.customBreakWindows.join(', ')}` : ''}`;\n        } else if (currentShift === 'early_shift') {\n          shiftGuidance = `\\n\\nSHIFT PATTERN GUIDANCE (Early Shift):\nThe user works early hours (typically 6am-2pm).\n- Suggest quick, energizing breakfast options (can eat before 6am)\n- Mid-morning snack is crucial for sustained energy\n- Recommend having main meal after shift ends (early afternoon)\n- Evening meals can be lighter since shift ends early`;\n        } else if (currentShift === 'late_shift') {\n          shiftGuidance = `\\n\\nSHIFT PATTERN GUIDANCE (Late Shift):\nThe user works late hours (typically 2pm-10pm).\n- Suggest substantial late breakfast/brunch\n- Light pre-shift meal around 1pm\n- Recommend snacks during shift (6-7pm)\n- Late dinner after shift ends (post-10pm) should be lighter`;\n        } else if (currentShift === 'custom' && userProfile.customShiftStart && userProfile.customShiftEnd) {\n          shiftGuidance = `\\n\\nSHIFT PATTERN GUIDANCE (Custom Shift):\nThe user works ${userProfile.customShiftStart} to ${userProfile.customShiftEnd}.\n- Adapt meal timing around these custom hours\n- Suggest meals that fit their available eating windows\n${userProfile.customBreakWindows && userProfile.customBreakWindows.length > 0 ? `- Break times available: ${userProfile.customBreakWindows.join(', ')}` : '- Recommend portable foods if break times are limited'}`;\n        }\n      }\n\n      // Get current time context (use client's local time if provided)\n      let timeContext = \"\";\n      if (clientTimeInfo) {\n        timeContext = `\\n\\nCurrent time for the user: ${clientTimeInfo.timeString} (${clientTimeInfo.timeOfDay})`;\n      }\n      \n      // Build system prompt with personality as PRIMARY identity\n      const systemPrompt = `${personalitySettings.systemPrompt}\n\nYou are a personal AI companion and coach. Stay in character with your unique personality style at all times.${timeContext}\n\nYour communication style:\n- Tone: ${personalitySettings.responseStyle.tone}\n- Formality: ${personalitySettings.responseStyle.formality}\n- Directness: ${personalitySettings.responseStyle.directness}\n${personalitySettings.responseStyle.emoji ? '- Use emojis to make conversations more engaging' : '- Keep responses professional without emojis'}\n\n${userDisplayName ? `The user prefers to be called \"${userDisplayName}\". Use this name naturally when addressing them to make the conversation more personal and friendly.` : ''}\n\nContext about the user (for reference when relevant):\n${contextData}${profileContext}${memoryContext}${goalsContext}${shiftGuidance}\n\nGuidelines:\n- You can discuss ANY topic: relationships, career, hobbies, news, sports, motivation, life advice, philosophy, entertainment, technology, or anything else the user wants to talk about\n- When nutrition/health topics come up, consider their dietary requirements, allergies, and health conditions\n- Never suggest foods they're allergic to or that violate their dietary restrictions\n- Reference their personal goals, interests, and lifestyle when relevant${userDisplayName ? `\\n- Address the user as \"${userDisplayName}\" to make the conversation feel personal` : ''}\n- CRITICAL: Always adapt meal timing, calorie distribution, and food suggestions based on their current shift pattern\n- For shift workers: prioritize portable, quick-prep, and shift-friendly foods\n- Stay fully in character with your unique personality - this is who you ARE, not just how you talk\n- Give practical, actionable advice in your distinctive style\n- If medical advice is needed, recommend consulting a healthcare professional\n- Keep responses focused and engaging (200-300 words max)`;\n\n      const response = await this.client.models.generateContent({\n        model: \"gemini-2.5-flash\",\n        config: {\n          systemInstruction: systemPrompt,\n        },\n        contents: question,\n      });\n\n      const answer = response.text || \"I'm sorry, I couldn't generate a response to your question right now.\";\n      \n      this.recordSuccess();\n      return answer;\n\n    } catch (error: any) {\n      console.error(\"Gemini question answering error:\", error);\n      \n      let providerError: ProviderError;\n      \n      // Check for 503 service overloaded - this is retryable\n      if (error?.status === 503 || error?.message?.includes('UNAVAILABLE') || error?.message?.includes('overloaded')) {\n        providerError = this.createError(\n          'SERVICE_UNAVAILABLE',\n          'Gemini is temporarily overloaded, retrying...',\n          true, // retryable\n          true, // use fallback\n          30 // retry after 30 seconds\n        );\n      } else if (error?.message?.includes('quota') || error?.message?.includes('rate')) {\n        providerError = this.createError(\n          'RATE_LIMIT',\n          'Gemini rate limit exceeded',\n          true,\n          true,\n          120\n        );\n      } else if (error?.message?.includes('GEMINI_API_KEY')) {\n        providerError = this.createError(\n          'CONFIG_ERROR',\n          'Gemini API key not configured',\n          false,\n          false\n        );\n      } else {\n        providerError = this.createError(\n          'QUESTION_ERROR',\n          `Gemini question answering failed: ${error.message}`,\n          false,\n          true,\n          60\n        );\n      }\n      \n      this.recordError(providerError);\n      throw providerError;\n    }\n  }\n\n  async generateDailyCoaching(entries: DiaryEntry[], userProfile?: any): Promise<DailyCoaching> {\n    try {\n      // Prepare context from user's nutrition data\n      const contextData = this.prepareNutritionContextData(entries);\n      \n      const systemPrompt = `You are PlateMate's AI wellness coach. Generate daily coaching content that's motivational, educational, and personalized. Be encouraging, supportive, and provide actionable advice.\n\nUser's Recent Nutrition Data:\n${contextData}\n\nGenerate coaching content with these exact JSON keys:\n- motivation: Uplifting, personal message (30-50 words)\n- nutritionTip: Practical, actionable advice based on their eating patterns (30-50 words)\n- medicationTip: If relevant, gentle reminder about GLP-1 medications and nutrition (20-40 words, optional)\n- encouragement: Supportive message acknowledging their efforts (20-40 words)\n- todaysFocus: One specific, achievable goal for today (15-30 words)\n- achievement: If they've hit a milestone, acknowledge it (optional)\n\nRespond with valid JSON object only.`;\n\n      const response = await this.client.models.generateContent({\n        model: \"gemini-2.5-flash\",\n        config: {\n          systemInstruction: systemPrompt,\n          responseMimeType: \"application/json\",\n          responseSchema: {\n            type: \"object\",\n            properties: {\n              motivation: { type: \"string\" },\n              nutritionTip: { type: \"string\" },\n              medicationTip: { type: \"string\" },\n              encouragement: { type: \"string\" },\n              todaysFocus: { type: \"string\" },\n              achievement: { type: \"string\" }\n            },\n            required: [\"motivation\", \"nutritionTip\", \"encouragement\", \"todaysFocus\"]\n          }\n        },\n        contents: \"Generate my daily coaching content based on my nutrition data.\",\n      });\n\n      const responseText = response.text;\n      \n      if (!responseText) {\n        throw new Error(\"No response from Gemini\");\n      }\n\n      const parsed = JSON.parse(responseText);\n      \n      // Calculate actual streak from entries\n      const actualStreak = this.calculateStreak(entries);\n      \n      const coaching: DailyCoaching = {\n        motivation: parsed.motivation || \"You're doing great! Every healthy choice you make is an investment in your future self.\",\n        nutritionTip: parsed.nutritionTip || \"Try to include a variety of colorful vegetables in your meals for optimal nutrition.\",\n        medicationTip: parsed.medicationTip,\n        encouragement: parsed.encouragement || \"Remember, progress isn't always perfect, but consistency is key. You've got this!\",\n        todaysFocus: parsed.todaysFocus || \"Focus on staying hydrated and eating mindfully today.\",\n        streak: actualStreak,\n        achievement: actualStreak >= 7 ? `${actualStreak} day logging streak!` : parsed.achievement\n      };\n\n      this.recordSuccess();\n      return coaching;\n\n    } catch (error: any) {\n      console.error(\"Gemini coaching generation error:\", error);\n      \n      let providerError: ProviderError;\n      \n      if (error?.message?.includes('quota') || error?.message?.includes('rate')) {\n        providerError = this.createError(\n          'RATE_LIMIT',\n          'Gemini rate limit exceeded',\n          true,\n          true,\n          120\n        );\n      } else if (error?.message?.includes('GEMINI_API_KEY')) {\n        providerError = this.createError(\n          'CONFIG_ERROR',\n          'Gemini API key not configured',\n          false,\n          false\n        );\n      } else {\n        providerError = this.createError(\n          'COACHING_ERROR',\n          `Gemini coaching generation failed: ${error.message}`,\n          false,\n          true,\n          60\n        );\n      }\n      \n      this.recordError(providerError);\n      throw providerError;\n    }\n  }\n\n  async generateEducationalTips(category: 'all' | 'nutrition' | 'medication' | 'motivation'): Promise<EducationalTip[]> {\n    try {\n      const categoryFilter = category === 'all' ? 'nutrition, medication, and motivation' : category;\n      \n      const systemPrompt = `You are a certified nutritionist and wellness expert. Generate 6-8 educational tips about ${categoryFilter}. \n\nEach tip should be:\n- Practical and actionable\n- Evidence-based\n- Easy to understand\n- Relevant to people using nutrition tracking apps\n- Include proper importance level (high/medium/low)\n\nFocus areas:\n- Nutrition: Macro/micronutrients, meal timing, food combinations, healthy eating habits\n- Medication: GLP-1 medications, timing with meals, side effects management, interactions\n- Motivation: Habit formation, goal setting, overcoming challenges, mindset\n\nRespond with JSON object containing 'tips' array.`;\n\n      const response = await this.client.models.generateContent({\n        model: \"gemini-2.5-pro\",\n        config: {\n          systemInstruction: systemPrompt,\n          responseMimeType: \"application/json\",\n          responseSchema: {\n            type: \"object\",\n            properties: {\n              tips: {\n                type: \"array\",\n                items: {\n                  type: \"object\",\n                  properties: {\n                    id: { type: \"string\" },\n                    title: { type: \"string\" },\n                    content: { type: \"string\" },\n                    category: { type: \"string\", enum: [\"nutrition\", \"medication\", \"motivation\"] },\n                    importance: { type: \"string\", enum: [\"high\", \"medium\", \"low\"] }\n                  },\n                  required: [\"id\", \"title\", \"content\", \"category\", \"importance\"]\n                }\n              }\n            },\n            required: [\"tips\"]\n          }\n        },\n        contents: `Generate educational tips for: ${categoryFilter}`,\n      });\n\n      const responseText = response.text;\n      \n      if (!responseText) {\n        throw new Error(\"No response from Gemini\");\n      }\n\n      const parsed = JSON.parse(responseText);\n      const tips = parsed.tips || [];\n      \n      // Filter by category if specific category requested\n      const filteredTips = category === 'all' ? tips : tips.filter((tip: any) => tip.category === category);\n      \n      this.recordSuccess();\n      return filteredTips;\n\n    } catch (error: any) {\n      console.error(\"Gemini tips generation error:\", error);\n      \n      let providerError: ProviderError;\n      \n      if (error?.message?.includes('quota') || error?.message?.includes('rate')) {\n        providerError = this.createError(\n          'RATE_LIMIT',\n          'Gemini rate limit exceeded',\n          true,\n          true,\n          120\n        );\n      } else if (error?.message?.includes('GEMINI_API_KEY')) {\n        providerError = this.createError(\n          'CONFIG_ERROR',\n          'Gemini API key not configured',\n          false,\n          false\n        );\n      } else {\n        providerError = this.createError(\n          'TIPS_ERROR',\n          `Gemini tips generation failed: ${error.message}`,\n          false,\n          true,\n          60\n        );\n      }\n      \n      this.recordError(providerError);\n      throw providerError;\n    }\n  }\n\n  async generateRecipes(dietaryFilter: string = \"\", userProfile: any = null): Promise<any[]> {\n    try {\n      const filterText = dietaryFilter ? ` that are suitable for ${dietaryFilter} dietary requirements` : \"\";\n      \n      // Build user-specific constraints\n      let userConstraints = \"\";\n      let shiftFriendlyGuidance = \"\";\n      if (userProfile) {\n        const constraints: string[] = [];\n        \n        if (userProfile.allergies && userProfile.allergies.length > 0) {\n          constraints.push(`CRITICAL: Avoid ALL recipes containing these allergens: ${userProfile.allergies.join(', ')}. Do not include any recipe with these ingredients.`);\n        }\n        \n        if (userProfile.foodDislikes) {\n          constraints.push(`Avoid using these foods if possible: ${userProfile.foodDislikes}`);\n        }\n        \n        if (userProfile.healthConditions) {\n          constraints.push(`Consider these health conditions: ${userProfile.healthConditions}`);\n        }\n        \n        if (constraints.length > 0) {\n          userConstraints = \"\\n\\nUSER-SPECIFIC REQUIREMENTS:\\n\" + constraints.join('\\n');\n        }\n        \n        // Extract shift pattern information\n        const today = new Date().toISOString().split('T')[0];\n        let currentShift = userProfile.defaultShiftType || 'regular';\n        \n        // Use today's override if set\n        if (userProfile.todayShiftDate === today && userProfile.todayShiftType) {\n          currentShift = userProfile.todayShiftType;\n        }\n        \n        // Build shift-specific recipe guidance\n        if (currentShift === 'night_shift' || currentShift === 'long_shift') {\n          shiftFriendlyGuidance = \"\\n\\nSHIFT-FRIENDLY RECIPE REQUIREMENTS:\";\n          \n          if (currentShift === 'night_shift') {\n            shiftFriendlyGuidance += `\\nUser works NIGHT SHIFTS. Prioritize recipes that are:\n- Portable and easy to pack in containers\n- Can be eaten cold or reheated quickly\n- Quick prep time (under 20 minutes prep)\n- Avoid heavy carbs that cause drowsiness\n- Protein-rich to maintain energy during overnight hours\n- Include make-ahead/batch-cooking options`;\n          } else if (currentShift === 'long_shift') {\n            shiftFriendlyGuidance += `\\nUser works LONG 12.5hr SHIFTS (NHS/Emergency). Prioritize recipes that are:\n- Can be eaten with one hand or on-the-go\n- Portable in containers (wraps, bowls, mason jar meals)\n- Very quick prep (under 15 minutes) or can be batch-cooked\n- Can be eaten cold if microwaves unavailable\n- High protein and sustained energy (no sugar crashes)\n- Include snack-friendly options (protein bars, energy balls, portable fruits)`;\n          }\n        } else if (currentShift === 'early_shift' || currentShift === 'late_shift') {\n          shiftFriendlyGuidance = \"\\n\\nSHIFT-FRIENDLY RECIPE REQUIREMENTS:\";\n          \n          if (currentShift === 'early_shift') {\n            shiftFriendlyGuidance += `\\nUser works EARLY SHIFTS (6am-2pm). Include:\n- Quick breakfast options that can be prepared in under 10 minutes\n- Energizing morning meals\n- Make-ahead breakfast options (overnight oats, etc.)`;\n          } else if (currentShift === 'late_shift') {\n            shiftFriendlyGuidance += `\\nUser works LATE SHIFTS (2pm-10pm). Include:\n- Substantial brunch/lunch recipes\n- Portable snacks for during shift\n- Lighter late-evening meal options`;\n          }\n        }\n      }\n      \n      const systemPrompt = `You are a professional chef and nutritionist. Generate 8-10 healthy and delicious recipes${filterText}.\n\nEach recipe should include:\n- Complete ingredient list with measurements\n- Step-by-step cooking instructions\n- Accurate nutritional information (calories, protein, carbs, fat)\n- Cooking time (prep and cook) and difficulty level\n- Serving size information\n- Dietary tags and information\n\nFocus on:\n- Balanced nutrition\n- Easy-to-find ingredients\n- Clear, actionable instructions\n- Variety in meal types (breakfast, lunch, dinner, snacks)\n- Different cooking methods and cuisines${userConstraints}${shiftFriendlyGuidance}\n\nRespond with JSON in this exact format:\n{\n  \"recipes\": [\n    {\n      \"id\": \"recipe-1\",\n      \"name\": \"Recipe Name\",\n      \"description\": \"Brief description\",\n      \"calories\": 400,\n      \"protein\": 25,\n      \"carbs\": 35,\n      \"fat\": 15,\n      \"servings\": 2,\n      \"prepTime\": 15,\n      \"cookTime\": 20,\n      \"difficulty\": \"Easy\",\n      \"ingredients\": [\"ingredient 1\", \"ingredient 2\"],\n      \"instructions\": [\"Step 1\", \"Step 2\"],\n      \"dietaryInfo\": [\"Vegetarian\", \"High Protein\"]\n    }\n  ]\n}`;\n\n      const userPrompt = dietaryFilter \n        ? `Generate healthy recipes for ${dietaryFilter} diet. Include variety in meal types and cooking methods.`\n        : \"Generate a variety of healthy recipes for different meal types and dietary preferences.\";\n\n      const response = await this.client.models.generateContent({\n        model: \"gemini-2.5-flash\",\n        config: {\n          systemInstruction: systemPrompt,\n          responseMimeType: \"application/json\",\n          responseSchema: {\n            type: \"object\",\n            properties: {\n              recipes: {\n                type: \"array\",\n                items: {\n                  type: \"object\",\n                  properties: {\n                    id: { type: \"string\" },\n                    name: { type: \"string\" },\n                    description: { type: \"string\" },\n                    calories: { type: \"number\" },\n                    protein: { type: \"number\" },\n                    carbs: { type: \"number\" },\n                    fat: { type: \"number\" },\n                    servings: { type: \"number\" },\n                    prepTime: { type: \"number\" },\n                    cookTime: { type: \"number\" },\n                    difficulty: { type: \"string\" },\n                    ingredients: { type: \"array\", items: { type: \"string\" } },\n                    instructions: { type: \"array\", items: { type: \"string\" } },\n                    dietaryInfo: { type: \"array\", items: { type: \"string\" } }\n                  },\n                  required: [\"id\", \"name\", \"description\", \"calories\", \"protein\", \"carbs\", \"fat\", \"servings\", \"prepTime\", \"cookTime\", \"difficulty\", \"ingredients\", \"instructions\", \"dietaryInfo\"]\n                }\n              }\n            },\n            required: [\"recipes\"]\n          },\n          temperature: 0.8\n        },\n        contents: userPrompt,\n      });\n\n      const responseText = response.text;\n      \n      if (!responseText) {\n        throw new Error(\"No response from Gemini\");\n      }\n\n      const parsed = JSON.parse(responseText);\n      const recipes = parsed.recipes || [];\n      \n      this.recordSuccess();\n      return recipes;\n\n    } catch (error: any) {\n      console.error(\"Gemini recipe generation error:\", error);\n      \n      let providerError: ProviderError;\n      \n      if (error?.status === 429 || error?.code === 'RATE_LIMIT_EXCEEDED') {\n        providerError = this.createError(\n          'RATE_LIMIT',\n          'Gemini rate limit exceeded',\n          true,\n          true,\n          60\n        );\n      } else if (error?.status >= 500) {\n        providerError = this.createError(\n          'SERVER_ERROR',\n          `Gemini server error: ${error.message}`,\n          false,\n          true,\n          30\n        );\n      } else {\n        providerError = this.createError(\n          'RECIPE_ERROR',\n          `Gemini recipe generation failed: ${error.message}`,\n          false,\n          false\n        );\n      }\n      \n      this.recordError(providerError);\n      throw providerError;\n    }\n  }\n\n  private calculateStreak(entries: DiaryEntry[]): number {\n    if (!entries || entries.length === 0) return 0;\n    \n    // Sort entries by date (most recent first)\n    const sortedEntries = entries.sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());\n    \n    let streak = 0;\n    let currentDate = new Date();\n    currentDate.setHours(0, 0, 0, 0);\n    \n    // Check each day going backwards\n    for (let i = 0; i < 30; i++) { // Check last 30 days max\n      const checkDate = new Date(currentDate);\n      checkDate.setDate(checkDate.getDate() - i);\n      \n      // Find if there's an entry for this date\n      const hasEntryForDate = sortedEntries.some(entry => {\n        const entryDate = new Date(entry.createdAt);\n        entryDate.setHours(0, 0, 0, 0);\n        return entryDate.getTime() === checkDate.getTime();\n      });\n      \n      if (hasEntryForDate) {\n        streak++;\n      } else {\n        break; // Streak is broken\n      }\n    }\n    \n    return streak;\n  }\n}","size_bytes":55006},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"server/db.ts":{"content":"import { Pool, neonConfig } from '@neondatabase/serverless';\nimport { drizzle } from 'drizzle-orm/neon-serverless';\nimport ws from \"ws\";\nimport * as schema from \"@shared/schema\";\n\nneonConfig.webSocketConstructor = ws;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle({ client: pool, schema });","size_bytes":482},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","size_bytes":1139},"client/src/components/quick-actions-bar.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { Zap, Coffee, Droplets, Wine, Apple, Clock, Utensils } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\n\ninterface QuickActionsBarProps {\n  onQuickLog?: (type: string, data: any) => void;\n}\n\nconst QUICK_DRINKS = [\n  { name: \"Water\", icon: \"ðŸ’§\", type: \"water\", defaultAmount: 250, calories: 0 },\n  { name: \"Coffee\", icon: \"â˜•\", type: \"coffee\", defaultAmount: 200, calories: 5, caffeine: 95 },\n  { name: \"Tea\", icon: \"ðŸµ\", type: \"tea\", defaultAmount: 200, calories: 2, caffeine: 30 },\n  { name: \"Juice\", icon: \"ðŸ¥¤\", type: \"juice\", defaultAmount: 250, calories: 110, sugar: 26 },\n];\n\nconst QUICK_SNACKS = [\n  { name: \"Apple\", icon: \"ðŸŽ\", calories: 80, protein: 0, carbs: 21, fat: 0 },\n  { name: \"Banana\", icon: \"ðŸŒ\", calories: 105, protein: 1, carbs: 27, fat: 0 },\n  { name: \"Greek Yogurt\", icon: \"ðŸ¥›\", calories: 100, protein: 17, carbs: 6, fat: 0 },\n  { name: \"Almonds (handful)\", icon: \"ðŸ¥œ\", calories: 160, protein: 6, carbs: 6, fat: 14 },\n];\n\nexport function QuickActionsBar({ onQuickLog }: QuickActionsBarProps) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [customDrink, setCustomDrink] = useState({\n    name: \"\",\n    type: \"water\" as const,\n    amount: 250,\n    calories: 0,\n  });\n\n  const logDrinkMutation = useMutation({\n    mutationFn: async (drinkData: any) => {\n      await apiRequest(\"POST\", \"/api/drinks\", {\n        ...drinkData,\n        loggedAt: new Date().toISOString(),\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/drinks\"] });\n    },\n  });\n\n  const logSnackMutation = useMutation({\n    mutationFn: async (snackData: any) => {\n      // Create a mock food analysis for quick snacks\n      const mockAnalysis = {\n        imageUrl: \"\", // No image for quick logs\n        confidence: 100, // High confidence for known foods\n        totalCalories: snackData.calories,\n        totalProtein: snackData.protein,\n        totalCarbs: snackData.carbs,\n        totalFat: snackData.fat,\n        detectedFoods: [{\n          name: snackData.name,\n          portion: \"1 serving\",\n          calories: snackData.calories,\n          protein: snackData.protein,\n          carbs: snackData.carbs,\n          fat: snackData.fat,\n          icon: snackData.icon,\n        }],\n      };\n\n      // For quick snacks, we'll skip creating a full analysis and just create a diary entry\n      // In a real implementation, this would create a proper analysis entry\n      // For now, just log it as a simple entry\n      await apiRequest(\"POST\", \"/api/diary\", {\n        analysisId: \"quick-snack-placeholder\", // Would be a real analysis ID\n        mealType: \"snack\",\n        mealDate: new Date().toISOString(),\n        notes: `Quick logged: ${snackData.name}`,\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/diary\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/analyses\"] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges/points'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges/streak'] });\n    },\n  });\n\n  const handleQuickDrink = (drink: typeof QUICK_DRINKS[0]) => {\n    logDrinkMutation.mutate({\n      drinkName: drink.name,\n      drinkType: drink.type,\n      amount: drink.defaultAmount,\n      calories: drink.calories,\n      caffeine: drink.caffeine || 0,\n      sugar: drink.name === \"Juice\" ? 26 : 0,\n    });\n\n    toast({\n      title: \"Drink Logged\",\n      description: `${drink.name} (${drink.defaultAmount}ml) added to your diary.`,\n    });\n\n    onQuickLog?.(\"drink\", drink);\n  };\n\n  const handleQuickSnack = (snack: typeof QUICK_SNACKS[0]) => {\n    logSnackMutation.mutate(snack);\n\n    toast({\n      title: \"Snack Logged\",\n      description: `${snack.name} added to your diary.`,\n    });\n\n    onQuickLog?.(\"snack\", snack);\n  };\n\n  const handleCustomDrink = () => {\n    if (!customDrink.name.trim()) return;\n\n    logDrinkMutation.mutate({\n      drinkName: customDrink.name,\n      drinkType: customDrink.type,\n      amount: customDrink.amount,\n      calories: customDrink.calories,\n      caffeine: 0,\n      sugar: 0,\n    });\n\n    toast({\n      title: \"Custom Drink Logged\",\n      description: `${customDrink.name} added to your diary.`,\n    });\n\n    setCustomDrink({ name: \"\", type: \"water\", amount: 250, calories: 0 });\n    onQuickLog?.(\"custom-drink\", customDrink);\n  };\n\n  return (\n    <div className=\"bg-card border rounded-lg p-4 space-y-4\">\n      <div className=\"flex items-center gap-2 mb-3\">\n        <Zap className=\"h-4 w-4 text-primary\" />\n        <h3 className=\"font-medium\">Quick Actions</h3>\n      </div>\n\n      {/* Quick Drinks */}\n      <div className=\"space-y-2\">\n        <h4 className=\"text-sm font-medium flex items-center gap-1\">\n          <Droplets className=\"h-3 w-3\" />\n          Quick Drinks\n        </h4>\n        <div className=\"grid grid-cols-2 gap-2\">\n          {QUICK_DRINKS.map((drink) => (\n            <Button\n              key={drink.name}\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => handleQuickDrink(drink)}\n              disabled={logDrinkMutation.isPending}\n              className=\"justify-start h-auto p-2 hover:bg-blue-50 dark:hover:bg-blue-950\"\n              data-testid={`quick-drink-${drink.name.toLowerCase()}`}\n            >\n              <div className=\"flex items-center gap-2 w-full\">\n                <span className=\"text-lg\">{drink.icon}</span>\n                <div className=\"flex-1 text-left\">\n                  <div className=\"text-xs font-medium\">{drink.name}</div>\n                  <div className=\"text-xs text-muted-foreground\">\n                    {drink.defaultAmount}ml\n                  </div>\n                </div>\n              </div>\n            </Button>\n          ))}\n        </div>\n\n        {/* Custom Drink */}\n        <Popover>\n          <PopoverTrigger asChild>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              className=\"w-full justify-start hover:bg-blue-50 dark:hover:bg-blue-950\"\n              data-testid=\"button-custom-drink\"\n            >\n              <Coffee className=\"h-4 w-4 mr-2\" />\n              Log Custom Drink\n            </Button>\n          </PopoverTrigger>\n          <PopoverContent className=\"w-80\">\n            <div className=\"space-y-3\">\n              <h4 className=\"font-medium\">Custom Drink</h4>\n              \n              <div className=\"space-y-2\">\n                <Label>Drink Name</Label>\n                <Input\n                  placeholder=\"e.g., Green Smoothie\"\n                  value={customDrink.name}\n                  onChange={(e) => setCustomDrink({ ...customDrink, name: e.target.value })}\n                  data-testid=\"input-custom-drink-name\"\n                />\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-2\">\n                <div className=\"space-y-2\">\n                  <Label>Type</Label>\n                  <Select\n                    value={customDrink.type}\n                    onValueChange={(value: any) => setCustomDrink({ ...customDrink, type: value })}\n                  >\n                    <SelectTrigger data-testid=\"select-custom-drink-type\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"water\">ðŸ’§ Water</SelectItem>\n                      <SelectItem value=\"coffee\">â˜• Coffee</SelectItem>\n                      <SelectItem value=\"tea\">ðŸµ Tea</SelectItem>\n                      <SelectItem value=\"juice\">ðŸ¥¤ Juice</SelectItem>\n                      <SelectItem value=\"soda\">ðŸ¥¤ Soda</SelectItem>\n                      <SelectItem value=\"other\">ðŸ¥› Other</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>Amount (ml)</Label>\n                  <Input\n                    type=\"number\"\n                    value={customDrink.amount}\n                    onChange={(e) => setCustomDrink({ ...customDrink, amount: parseInt(e.target.value) || 0 })}\n                    data-testid=\"input-custom-drink-amount\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label>Calories (optional)</Label>\n                <Input\n                  type=\"number\"\n                  placeholder=\"0\"\n                  value={customDrink.calories}\n                  onChange={(e) => setCustomDrink({ ...customDrink, calories: parseInt(e.target.value) || 0 })}\n                  data-testid=\"input-custom-drink-calories\"\n                />\n              </div>\n\n              <Button\n                onClick={handleCustomDrink}\n                disabled={!customDrink.name.trim() || logDrinkMutation.isPending}\n                className=\"w-full\"\n                data-testid=\"button-log-custom-drink\"\n              >\n                {logDrinkMutation.isPending ? \"Logging...\" : \"Log Drink\"}\n              </Button>\n            </div>\n          </PopoverContent>\n        </Popover>\n      </div>\n\n      {/* Quick Snacks */}\n      <div className=\"space-y-2\">\n        <h4 className=\"text-sm font-medium flex items-center gap-1\">\n          <Apple className=\"h-3 w-3\" />\n          Quick Snacks\n        </h4>\n        <div className=\"grid grid-cols-2 gap-2\">\n          {QUICK_SNACKS.map((snack) => (\n            <Button\n              key={snack.name}\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => handleQuickSnack(snack)}\n              disabled={logSnackMutation.isPending}\n              className=\"justify-start h-auto p-2 hover:bg-green-50 dark:hover:bg-green-950\"\n              data-testid={`quick-snack-${snack.name.toLowerCase().replace(/[^a-z0-9]/g, '-')}`}\n            >\n              <div className=\"flex items-center gap-2 w-full\">\n                <span className=\"text-lg\">{snack.icon}</span>\n                <div className=\"flex-1 text-left\">\n                  <div className=\"text-xs font-medium\">{snack.name}</div>\n                  <div className=\"text-xs text-muted-foreground\">\n                    {snack.calories} cal\n                  </div>\n                </div>\n              </div>\n            </Button>\n          ))}\n        </div>\n      </div>\n\n      {/* Voice Notes Placeholder */}\n      <div className=\"pt-2 border-t\">\n        <Button\n          variant=\"ghost\"\n          size=\"sm\"\n          className=\"w-full justify-start text-muted-foreground\"\n          disabled\n          data-testid=\"button-voice-notes\"\n        >\n          <Utensils className=\"h-4 w-4 mr-2\" />\n          Voice Notes (Coming Soon)\n        </Button>\n      </div>\n    </div>\n  );\n}","size_bytes":11311},"ios/App/App/public/assets/index-Dg-kYJjB.css":{"content":"@import\"https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap\";@import\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\";*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }*,:before,:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:before,:after{--tw-content: \"\"}html,:host{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:var(--font-sans);font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:var(--font-mono);font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}ol,ul,menu{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}*{border-color:var(--border)}body{font-family:var(--font-sans);color:var(--foreground);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;background:var(--background);min-height:100vh}h1,h2,h3,h4,h5,h6{font-weight:500;letter-spacing:-.025em}.gradient-text{background:var(--primary);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.glass-card{background:#fffffff2;-webkit-backdrop-filter:blur(16px);backdrop-filter:blur(16px);border:1px solid rgba(255,255,255,.2);box-shadow:var(--shadow-soft)}.dark .glass-card{background:#1e1e32f2;border:1px solid rgba(255,255,255,.1)}.gradient-button{background:var(--primary);border:none;color:var(--primary-foreground);transition:all .3s cubic-bezier(.4,0,.2,1);transform:translateY(0);box-shadow:var(--shadow-soft)}.gradient-button:hover{transform:translateY(-2px);box-shadow:var(--shadow-medium)}.gradient-button:active{transform:translateY(0);box-shadow:var(--shadow-soft)}.modern-card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow-soft);transition:all .3s cubic-bezier(.4,0,.2,1)}.modern-card:hover{box-shadow:var(--shadow-medium);transform:translateY(-2px)}.smooth-transition{transition:all .3s cubic-bezier(.4,0,.2,1)}.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}.pointer-events-none{pointer-events:none}.pointer-events-auto{pointer-events:auto}.visible{visibility:visible}.invisible{visibility:hidden}.static{position:static}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.inset-0{top:0;right:0;bottom:0;left:0}.inset-16{top:4rem;right:4rem;bottom:4rem;left:4rem}.inset-x-0{left:0;right:0}.inset-y-0{top:0;bottom:0}.-bottom-1{bottom:-.25rem}.-bottom-12{bottom:-3rem}.-left-1{left:-.25rem}.-left-12{left:-3rem}.-right-1{right:-.25rem}.-right-12{right:-3rem}.-right-2{right:-.5rem}.-right-4{right:-1rem}.-top-1{top:-.25rem}.-top-12{top:-3rem}.-top-2{top:-.5rem}.-top-4{top:-1rem}.bottom-0{bottom:0}.bottom-1\\/4{bottom:25%}.bottom-10{bottom:2.5rem}.bottom-24{bottom:6rem}.left-0{left:0}.left-1{left:.25rem}.left-1\\/2{left:50%}.left-1\\/4{left:25%}.left-10{left:2.5rem}.left-2{left:.5rem}.left-3{left:.75rem}.left-\\[50\\%\\]{left:50%}.right-0{right:0}.right-1{right:.25rem}.right-10{right:2.5rem}.right-2{right:.5rem}.right-20{right:5rem}.right-3{right:.75rem}.right-4{right:1rem}.top-0{top:0}.top-1\\.5{top:.375rem}.top-1\\/2{top:50%}.top-1\\/4{top:25%}.top-10{top:2.5rem}.top-2{top:.5rem}.top-20{top:5rem}.top-3\\.5{top:.875rem}.top-4{top:1rem}.top-\\[1px\\]{top:1px}.top-\\[50\\%\\]{top:50%}.top-\\[60\\%\\]{top:60%}.top-full{top:100%}.z-10{z-index:10}.z-20{z-index:20}.z-40{z-index:40}.z-50{z-index:50}.z-\\[100\\]{z-index:100}.z-\\[1\\]{z-index:1}.z-\\[9999\\]{z-index:9999}.col-span-2{grid-column:span 2 / span 2}.-mx-1{margin-left:-.25rem;margin-right:-.25rem}.-mx-6{margin-left:-1.5rem;margin-right:-1.5rem}.mx-1{margin-left:.25rem;margin-right:.25rem}.mx-2{margin-left:.5rem;margin-right:.5rem}.mx-3\\.5{margin-left:.875rem;margin-right:.875rem}.mx-4{margin-left:1rem;margin-right:1rem}.mx-auto{margin-left:auto;margin-right:auto}.my-0\\.5{margin-top:.125rem;margin-bottom:.125rem}.my-1{margin-top:.25rem;margin-bottom:.25rem}.-mb-6{margin-bottom:-1.5rem}.-ml-4{margin-left:-1rem}.-mt-4{margin-top:-1rem}.mb-1{margin-bottom:.25rem}.mb-12{margin-bottom:3rem}.mb-16{margin-bottom:4rem}.mb-2{margin-bottom:.5rem}.mb-24{margin-bottom:6rem}.mb-3{margin-bottom:.75rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mb-8{margin-bottom:2rem}.ml-1{margin-left:.25rem}.ml-2{margin-left:.5rem}.ml-4{margin-left:1rem}.ml-6{margin-left:1.5rem}.ml-auto{margin-left:auto}.mr-1{margin-right:.25rem}.mr-2{margin-right:.5rem}.mt-0\\.5{margin-top:.125rem}.mt-1{margin-top:.25rem}.mt-1\\.5{margin-top:.375rem}.mt-16{margin-top:4rem}.mt-2{margin-top:.5rem}.mt-24{margin-top:6rem}.mt-3{margin-top:.75rem}.mt-4{margin-top:1rem}.mt-6{margin-top:1.5rem}.mt-8{margin-top:2rem}.mt-auto{margin-top:auto}.line-clamp-2{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2}.block{display:block}.inline-block{display:inline-block}.inline{display:inline}.flex{display:flex}.inline-flex{display:inline-flex}.table{display:table}.grid{display:grid}.hidden{display:none}.aspect-square{aspect-ratio:1 / 1}.aspect-video{aspect-ratio:16 / 9}.size-4{width:1rem;height:1rem}.h-1{height:.25rem}.h-1\\.5{height:.375rem}.h-10{height:2.5rem}.h-11{height:2.75rem}.h-12{height:3rem}.h-16{height:4rem}.h-2{height:.5rem}.h-2\\.5{height:.625rem}.h-20{height:5rem}.h-24{height:6rem}.h-3{height:.75rem}.h-3\\.5{height:.875rem}.h-32{height:8rem}.h-4{height:1rem}.h-48{height:12rem}.h-5{height:1.25rem}.h-6{height:1.5rem}.h-64{height:16rem}.h-7{height:1.75rem}.h-8{height:2rem}.h-9{height:2.25rem}.h-\\[1px\\]{height:1px}.h-\\[var\\(--radix-navigation-menu-viewport-height\\)\\]{height:var(--radix-navigation-menu-viewport-height)}.h-\\[var\\(--radix-select-trigger-height\\)\\]{height:var(--radix-select-trigger-height)}.h-auto{height:auto}.h-full{height:100%}.h-px{height:1px}.h-screen{height:100vh}.h-svh{height:100svh}.max-h-32{max-height:8rem}.max-h-48{max-height:12rem}.max-h-64{max-height:16rem}.max-h-96{max-height:24rem}.max-h-\\[--radix-context-menu-content-available-height\\]{max-height:var(--radix-context-menu-content-available-height)}.max-h-\\[--radix-select-content-available-height\\]{max-height:var(--radix-select-content-available-height)}.max-h-\\[300px\\]{max-height:300px}.max-h-\\[80vh\\]{max-height:80vh}.max-h-\\[90vh\\]{max-height:90vh}.max-h-\\[var\\(--radix-dropdown-menu-content-available-height\\)\\]{max-height:var(--radix-dropdown-menu-content-available-height)}.max-h-screen{max-height:100vh}.min-h-0{min-height:0px}.min-h-\\[44px\\]{min-height:44px}.min-h-\\[80px\\]{min-height:80px}.min-h-screen{min-height:100vh}.min-h-svh{min-height:100svh}.w-0{width:0px}.w-1{width:.25rem}.w-1\\/2{width:50%}.w-1\\/3{width:33.333333%}.w-10{width:2.5rem}.w-11{width:2.75rem}.w-12{width:3rem}.w-16{width:4rem}.w-2{width:.5rem}.w-2\\.5{width:.625rem}.w-2\\/3{width:66.666667%}.w-20{width:5rem}.w-24{width:6rem}.w-3{width:.75rem}.w-3\\.5{width:.875rem}.w-3\\/4{width:75%}.w-32{width:8rem}.w-4{width:1rem}.w-5{width:1.25rem}.w-6{width:1.5rem}.w-64{width:16rem}.w-7{width:1.75rem}.w-72{width:18rem}.w-8{width:2rem}.w-80{width:20rem}.w-9{width:2.25rem}.w-\\[--sidebar-width\\]{width:var(--sidebar-width)}.w-\\[100px\\]{width:100px}.w-\\[1px\\]{width:1px}.w-auto{width:auto}.w-fit{width:-moz-fit-content;width:fit-content}.w-full{width:100%}.w-max{width:-moz-max-content;width:max-content}.w-px{width:1px}.w-screen{width:100vw}.min-w-0{min-width:0px}.min-w-10{min-width:2.5rem}.min-w-11{min-width:2.75rem}.min-w-5{min-width:1.25rem}.min-w-9{min-width:2.25rem}.min-w-\\[12rem\\]{min-width:12rem}.min-w-\\[200px\\]{min-width:200px}.min-w-\\[44px\\]{min-width:44px}.min-w-\\[8rem\\]{min-width:8rem}.min-w-\\[var\\(--radix-select-trigger-width\\)\\]{min-width:var(--radix-select-trigger-width)}.min-w-fit{min-width:-moz-fit-content;min-width:fit-content}.max-w-2xl{max-width:42rem}.max-w-4xl{max-width:56rem}.max-w-6xl{max-width:72rem}.max-w-\\[--skeleton-width\\]{max-width:var(--skeleton-width)}.max-w-full{max-width:100%}.max-w-lg{max-width:32rem}.max-w-max{max-width:-moz-max-content;max-width:max-content}.max-w-md{max-width:28rem}.max-w-sm{max-width:24rem}.flex-1{flex:1 1 0%}.flex-shrink-0,.shrink-0{flex-shrink:0}.grow{flex-grow:1}.grow-0{flex-grow:0}.basis-full{flex-basis:100%}.caption-bottom{caption-side:bottom}.border-collapse{border-collapse:collapse}.origin-\\[--radix-context-menu-content-transform-origin\\]{transform-origin:var(--radix-context-menu-content-transform-origin)}.origin-\\[--radix-dropdown-menu-content-transform-origin\\]{transform-origin:var(--radix-dropdown-menu-content-transform-origin)}.origin-\\[--radix-hover-card-content-transform-origin\\]{transform-origin:var(--radix-hover-card-content-transform-origin)}.origin-\\[--radix-menubar-content-transform-origin\\]{transform-origin:var(--radix-menubar-content-transform-origin)}.origin-\\[--radix-popover-content-transform-origin\\]{transform-origin:var(--radix-popover-content-transform-origin)}.origin-\\[--radix-select-content-transform-origin\\]{transform-origin:var(--radix-select-content-transform-origin)}.origin-\\[--radix-tooltip-content-transform-origin\\]{transform-origin:var(--radix-tooltip-content-transform-origin)}.-translate-x-1\\/2{--tw-translate-x: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-x-px{--tw-translate-x: -1px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-y-1\\/2{--tw-translate-y: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-\\[-50\\%\\]{--tw-translate-x: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-px{--tw-translate-x: 1px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-y-\\[-50\\%\\]{--tw-translate-y: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-180{--tw-rotate: 180deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-45{--tw-rotate: 45deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-90{--tw-rotate: 90deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-\\[-90deg\\]{--tw-rotate: -90deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-105{--tw-scale-x: 1.05;--tw-scale-y: 1.05;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.animate-bounce{animation:bounce 1s infinite}@keyframes ping{75%,to{transform:scale(2);opacity:0}}.animate-ping{animation:ping 1s cubic-bezier(0,0,.2,1) infinite}.animate-pulse{animation:pulse 2s cubic-bezier(.4,0,.6,1) infinite}.animate-spin{animation:spin 1s linear infinite}.cursor-default{cursor:default}.cursor-not-allowed{cursor:not-allowed}.cursor-pointer{cursor:pointer}.touch-none{touch-action:none}.touch-manipulation{touch-action:manipulation}.select-none{-webkit-user-select:none;-moz-user-select:none;user-select:none}.resize-none{resize:none}.list-disc{list-style-type:disc}.list-none{list-style-type:none}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.grid-cols-7{grid-template-columns:repeat(7,minmax(0,1fr))}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.flex-col-reverse{flex-direction:column-reverse}.flex-wrap{flex-wrap:wrap}.items-start{align-items:flex-start}.items-end{align-items:flex-end}.items-center{align-items:center}.items-stretch{align-items:stretch}.justify-start{justify-content:flex-start}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.justify-around{justify-content:space-around}.gap-1{gap:.25rem}.gap-1\\.5{gap:.375rem}.gap-2{gap:.5rem}.gap-3{gap:.75rem}.gap-4{gap:1rem}.gap-6{gap:1.5rem}.gap-8{gap:2rem}.space-x-1>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(.25rem * var(--tw-space-x-reverse));margin-left:calc(.25rem * calc(1 - var(--tw-space-x-reverse)))}.space-x-1\\.5>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(.375rem * var(--tw-space-x-reverse));margin-left:calc(.375rem * calc(1 - var(--tw-space-x-reverse)))}.space-x-2>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(.5rem * var(--tw-space-x-reverse));margin-left:calc(.5rem * calc(1 - var(--tw-space-x-reverse)))}.space-x-3>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(.75rem * var(--tw-space-x-reverse));margin-left:calc(.75rem * calc(1 - var(--tw-space-x-reverse)))}.space-x-4>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(1rem * var(--tw-space-x-reverse));margin-left:calc(1rem * calc(1 - var(--tw-space-x-reverse)))}.space-x-6>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(1.5rem * var(--tw-space-x-reverse));margin-left:calc(1.5rem * calc(1 - var(--tw-space-x-reverse)))}.space-y-1>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.25rem * var(--tw-space-y-reverse))}.space-y-1\\.5>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.375rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.375rem * var(--tw-space-y-reverse))}.space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem * var(--tw-space-y-reverse))}.space-y-3>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.75rem * var(--tw-space-y-reverse))}.space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.space-y-5>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1.25rem * var(--tw-space-y-reverse))}.space-y-6>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1.5rem * var(--tw-space-y-reverse))}.space-y-8>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(2rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(2rem * var(--tw-space-y-reverse))}.overflow-auto{overflow:auto}.overflow-hidden{overflow:hidden}.overflow-x-auto{overflow-x:auto}.overflow-y-auto{overflow-y:auto}.overflow-x-hidden{overflow-x:hidden}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.whitespace-nowrap{white-space:nowrap}.break-words{overflow-wrap:break-word}.break-all{word-break:break-all}.rounded{border-radius:.25rem}.rounded-2xl{border-radius:1rem}.rounded-3xl{border-radius:1.5rem}.rounded-\\[2\\.5rem\\]{border-radius:2.5rem}.rounded-\\[2px\\]{border-radius:2px}.rounded-\\[inherit\\]{border-radius:inherit}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:var(--radius)}.rounded-md{border-radius:calc(var(--radius) - 2px)}.rounded-sm{border-radius:calc(var(--radius) - 4px)}.rounded-xl{border-radius:.75rem}.rounded-b-2xl{border-bottom-right-radius:1rem;border-bottom-left-radius:1rem}.rounded-t-\\[10px\\]{border-top-left-radius:10px;border-top-right-radius:10px}.rounded-t-lg{border-top-left-radius:var(--radius);border-top-right-radius:var(--radius)}.rounded-bl{border-bottom-left-radius:.25rem}.rounded-br{border-bottom-right-radius:.25rem}.rounded-tl{border-top-left-radius:.25rem}.rounded-tl-sm{border-top-left-radius:calc(var(--radius) - 4px)}.rounded-tr{border-top-right-radius:.25rem}.border{border-width:1px}.border-0{border-width:0px}.border-2{border-width:2px}.border-4{border-width:4px}.border-\\[1\\.5px\\]{border-width:1.5px}.border-y{border-top-width:1px;border-bottom-width:1px}.border-b{border-bottom-width:1px}.border-b-2{border-bottom-width:2px}.border-b-4{border-bottom-width:4px}.border-l{border-left-width:1px}.border-l-2{border-left-width:2px}.border-l-4{border-left-width:4px}.border-r{border-right-width:1px}.border-r-4{border-right-width:4px}.border-t{border-top-width:1px}.border-t-4{border-top-width:4px}.border-dashed{border-style:dashed}.border-\\[--color-border\\]{border-color:var(--color-border)}.border-amber-200{--tw-border-opacity: 1;border-color:rgb(253 230 138 / var(--tw-border-opacity, 1))}.border-amber-300{--tw-border-opacity: 1;border-color:rgb(252 211 77 / var(--tw-border-opacity, 1))}.border-amber-400\\/20{border-color:#fbbf2433}.border-blue-200{--tw-border-opacity: 1;border-color:rgb(191 219 254 / var(--tw-border-opacity, 1))}.border-blue-200\\/30{border-color:#bfdbfe4d}.border-blue-200\\/50{border-color:#bfdbfe80}.border-blue-300{--tw-border-opacity: 1;border-color:rgb(147 197 253 / var(--tw-border-opacity, 1))}.border-blue-400\\/20{border-color:#60a5fa33}.border-blue-400\\/30{border-color:#60a5fa4d}.border-blue-500{--tw-border-opacity: 1;border-color:rgb(59 130 246 / var(--tw-border-opacity, 1))}.border-blue-600\\/30{border-color:#2563eb4d}.border-gray-100{--tw-border-opacity: 1;border-color:rgb(243 244 246 / var(--tw-border-opacity, 1))}.border-gray-200{--tw-border-opacity: 1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1))}.border-gray-200\\/50{border-color:#e5e7eb80}.border-gray-300{--tw-border-opacity: 1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1))}.border-green-200{--tw-border-opacity: 1;border-color:rgb(187 247 208 / var(--tw-border-opacity, 1))}.border-green-200\\/50{border-color:#bbf7d080}.border-green-300{--tw-border-opacity: 1;border-color:rgb(134 239 172 / var(--tw-border-opacity, 1))}.border-green-400{--tw-border-opacity: 1;border-color:rgb(74 222 128 / var(--tw-border-opacity, 1))}.border-green-400\\/30{border-color:#4ade804d}.border-green-600\\/30{border-color:#16a34a4d}.border-indigo-200{--tw-border-opacity: 1;border-color:rgb(199 210 254 / var(--tw-border-opacity, 1))}.border-input{border-color:var(--input)}.border-orange-200{--tw-border-opacity: 1;border-color:rgb(254 215 170 / var(--tw-border-opacity, 1))}.border-orange-200\\/50{border-color:#fed7aa80}.border-orange-500\\/30{border-color:#f973164d}.border-orange-600\\/30{border-color:#ea580c4d}.border-pink-200{--tw-border-opacity: 1;border-color:rgb(251 207 232 / var(--tw-border-opacity, 1))}.border-pink-300{--tw-border-opacity: 1;border-color:rgb(249 168 212 / var(--tw-border-opacity, 1))}.border-primary{border-color:var(--primary)}.border-purple-100{--tw-border-opacity: 1;border-color:rgb(243 232 255 / var(--tw-border-opacity, 1))}.border-purple-200{--tw-border-opacity: 1;border-color:rgb(233 213 255 / var(--tw-border-opacity, 1))}.border-purple-200\\/30{border-color:#e9d5ff4d}.border-purple-200\\/50{border-color:#e9d5ff80}.border-purple-300{--tw-border-opacity: 1;border-color:rgb(216 180 254 / var(--tw-border-opacity, 1))}.border-purple-400\\/20{border-color:#c084fc33}.border-purple-500{--tw-border-opacity: 1;border-color:rgb(168 85 247 / var(--tw-border-opacity, 1))}.border-purple-600\\/30{border-color:#9333ea4d}.border-red-200{--tw-border-opacity: 1;border-color:rgb(254 202 202 / var(--tw-border-opacity, 1))}.border-red-200\\/30{border-color:#fecaca4d}.border-red-300{--tw-border-opacity: 1;border-color:rgb(252 165 165 / var(--tw-border-opacity, 1))}.border-red-400{--tw-border-opacity: 1;border-color:rgb(248 113 113 / var(--tw-border-opacity, 1))}.border-red-500{--tw-border-opacity: 1;border-color:rgb(239 68 68 / var(--tw-border-opacity, 1))}.border-sidebar-border{border-color:var(--sidebar-border)}.border-slate-200{--tw-border-opacity: 1;border-color:rgb(226 232 240 / var(--tw-border-opacity, 1))}.border-slate-300{--tw-border-opacity: 1;border-color:rgb(203 213 225 / var(--tw-border-opacity, 1))}.border-slate-600{--tw-border-opacity: 1;border-color:rgb(71 85 105 / var(--tw-border-opacity, 1))}.border-slate-600\\/30{border-color:#4755694d}.border-slate-600\\/50{border-color:#47556980}.border-slate-700\\/50{border-color:#33415580}.border-transparent{border-color:transparent}.border-white{--tw-border-opacity: 1;border-color:rgb(255 255 255 / var(--tw-border-opacity, 1))}.border-white\\/10{border-color:#ffffff1a}.border-white\\/20{border-color:#fff3}.border-white\\/30{border-color:#ffffff4d}.border-yellow-200{--tw-border-opacity: 1;border-color:rgb(254 240 138 / var(--tw-border-opacity, 1))}.border-yellow-300{--tw-border-opacity: 1;border-color:rgb(253 224 71 / var(--tw-border-opacity, 1))}.border-yellow-300\\/50{border-color:#fde04780}.border-yellow-400\\/20{border-color:#facc1533}.border-yellow-400\\/50{border-color:#facc1580}.border-l-green-500{--tw-border-opacity: 1;border-left-color:rgb(34 197 94 / var(--tw-border-opacity, 1))}.border-l-primary{border-left-color:var(--primary)}.border-l-red-500{--tw-border-opacity: 1;border-left-color:rgb(239 68 68 / var(--tw-border-opacity, 1))}.border-l-transparent{border-left-color:transparent}.border-t-transparent{border-top-color:transparent}.bg-\\[--color-bg\\]{background-color:var(--color-bg)}.bg-accent{background-color:var(--accent)}.bg-amber-100{--tw-bg-opacity: 1;background-color:rgb(254 243 199 / var(--tw-bg-opacity, 1))}.bg-amber-50{--tw-bg-opacity: 1;background-color:rgb(255 251 235 / var(--tw-bg-opacity, 1))}.bg-background{background-color:var(--background)}.bg-black{--tw-bg-opacity: 1;background-color:rgb(0 0 0 / var(--tw-bg-opacity, 1))}.bg-black\\/50{background-color:#00000080}.bg-black\\/60{background-color:#0009}.bg-black\\/70{background-color:#000000b3}.bg-black\\/80{background-color:#000c}.bg-blue-100{--tw-bg-opacity: 1;background-color:rgb(219 234 254 / var(--tw-bg-opacity, 1))}.bg-blue-200\\/20{background-color:#bfdbfe33}.bg-blue-200\\/25{background-color:#bfdbfe40}.bg-blue-50{--tw-bg-opacity: 1;background-color:rgb(239 246 255 / var(--tw-bg-opacity, 1))}.bg-blue-50\\/50{background-color:#eff6ff80}.bg-blue-500{--tw-bg-opacity: 1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.bg-blue-600{--tw-bg-opacity: 1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1))}.bg-blue-900\\/30{background-color:#1e3a8a4d}.bg-border{background-color:var(--border)}.bg-card{background-color:var(--card)}.bg-destructive{background-color:var(--destructive)}.bg-emerald-100{--tw-bg-opacity: 1;background-color:rgb(209 250 229 / var(--tw-bg-opacity, 1))}.bg-foreground{background-color:var(--foreground)}.bg-gray-100{--tw-bg-opacity: 1;background-color:rgb(243 244 246 / var(--tw-bg-opacity, 1))}.bg-gray-200{--tw-bg-opacity: 1;background-color:rgb(229 231 235 / var(--tw-bg-opacity, 1))}.bg-gray-300{--tw-bg-opacity: 1;background-color:rgb(209 213 219 / var(--tw-bg-opacity, 1))}.bg-gray-400{--tw-bg-opacity: 1;background-color:rgb(156 163 175 / var(--tw-bg-opacity, 1))}.bg-gray-50{--tw-bg-opacity: 1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.bg-gray-900{--tw-bg-opacity: 1;background-color:rgb(17 24 39 / var(--tw-bg-opacity, 1))}.bg-green-100{--tw-bg-opacity: 1;background-color:rgb(220 252 231 / var(--tw-bg-opacity, 1))}.bg-green-50{--tw-bg-opacity: 1;background-color:rgb(240 253 244 / var(--tw-bg-opacity, 1))}.bg-green-500{--tw-bg-opacity: 1;background-color:rgb(34 197 94 / var(--tw-bg-opacity, 1))}.bg-green-600{--tw-bg-opacity: 1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.bg-green-900\\/30{background-color:#14532d4d}.bg-indigo-100{--tw-bg-opacity: 1;background-color:rgb(224 231 255 / var(--tw-bg-opacity, 1))}.bg-muted{background-color:var(--muted)}.bg-orange-100{--tw-bg-opacity: 1;background-color:rgb(255 237 213 / var(--tw-bg-opacity, 1))}.bg-orange-200\\/20{background-color:#fed7aa33}.bg-orange-50{--tw-bg-opacity: 1;background-color:rgb(255 247 237 / var(--tw-bg-opacity, 1))}.bg-orange-500{--tw-bg-opacity: 1;background-color:rgb(249 115 22 / var(--tw-bg-opacity, 1))}.bg-orange-600{--tw-bg-opacity: 1;background-color:rgb(234 88 12 / var(--tw-bg-opacity, 1))}.bg-orange-900\\/30{background-color:#7c2d124d}.bg-pink-100{--tw-bg-opacity: 1;background-color:rgb(252 231 243 / var(--tw-bg-opacity, 1))}.bg-pink-200\\/20{background-color:#fbcfe833}.bg-popover{background-color:var(--popover)}.bg-primary{background-color:var(--primary)}.bg-purple-100{--tw-bg-opacity: 1;background-color:rgb(243 232 255 / var(--tw-bg-opacity, 1))}.bg-purple-200\\/30{background-color:#e9d5ff4d}.bg-purple-500{--tw-bg-opacity: 1;background-color:rgb(168 85 247 / var(--tw-bg-opacity, 1))}.bg-purple-900\\/30{background-color:#581c874d}.bg-red-100{--tw-bg-opacity: 1;background-color:rgb(254 226 226 / var(--tw-bg-opacity, 1))}.bg-red-200\\/20{background-color:#fecaca33}.bg-red-50{--tw-bg-opacity: 1;background-color:rgb(254 242 242 / var(--tw-bg-opacity, 1))}.bg-red-500{--tw-bg-opacity: 1;background-color:rgb(239 68 68 / var(--tw-bg-opacity, 1))}.bg-red-600{--tw-bg-opacity: 1;background-color:rgb(220 38 38 / var(--tw-bg-opacity, 1))}.bg-secondary{background-color:var(--secondary)}.bg-sidebar{background-color:var(--sidebar-background)}.bg-sidebar-border{background-color:var(--sidebar-border)}.bg-slate-700{--tw-bg-opacity: 1;background-color:rgb(51 65 85 / var(--tw-bg-opacity, 1))}.bg-slate-800{--tw-bg-opacity: 1;background-color:rgb(30 41 59 / var(--tw-bg-opacity, 1))}.bg-slate-800\\/80{background-color:#1e293bcc}.bg-teal-100{--tw-bg-opacity: 1;background-color:rgb(204 251 241 / var(--tw-bg-opacity, 1))}.bg-transparent{background-color:transparent}.bg-white{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-white\\/10{background-color:#ffffff1a}.bg-white\\/20{background-color:#fff3}.bg-white\\/30{background-color:#ffffff4d}.bg-white\\/50{background-color:#ffffff80}.bg-white\\/60{background-color:#fff9}.bg-white\\/80{background-color:#fffc}.bg-white\\/90{background-color:#ffffffe6}.bg-white\\/95{background-color:#fffffff2}.bg-yellow-100{--tw-bg-opacity: 1;background-color:rgb(254 249 195 / var(--tw-bg-opacity, 1))}.bg-yellow-200\\/20{background-color:#fef08a33}.bg-yellow-200\\/30{background-color:#fef08a4d}.bg-yellow-300\\/30{background-color:#fde0474d}.bg-yellow-50{--tw-bg-opacity: 1;background-color:rgb(254 252 232 / var(--tw-bg-opacity, 1))}.bg-yellow-500{--tw-bg-opacity: 1;background-color:rgb(234 179 8 / var(--tw-bg-opacity, 1))}.bg-opacity-50{--tw-bg-opacity: .5}.bg-opacity-60{--tw-bg-opacity: .6}.bg-opacity-90{--tw-bg-opacity: .9}.bg-gradient-to-br{background-image:linear-gradient(to bottom right,var(--tw-gradient-stops))}.bg-gradient-to-r{background-image:linear-gradient(to right,var(--tw-gradient-stops))}.bg-gradient-to-t{background-image:linear-gradient(to top,var(--tw-gradient-stops))}.from-amber-100{--tw-gradient-from: #fef3c7 var(--tw-gradient-from-position);--tw-gradient-to: rgb(254 243 199 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-amber-50{--tw-gradient-from: #fffbeb var(--tw-gradient-from-position);--tw-gradient-to: rgb(255 251 235 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-amber-600\\/90{--tw-gradient-from: rgb(217 119 6 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(217 119 6 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-black\\/20{--tw-gradient-from: rgb(0 0 0 / .2) var(--tw-gradient-from-position);--tw-gradient-to: rgb(0 0 0 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-blue-100{--tw-gradient-from: #dbeafe var(--tw-gradient-from-position);--tw-gradient-to: rgb(219 234 254 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-blue-50{--tw-gradient-from: #eff6ff var(--tw-gradient-from-position);--tw-gradient-to: rgb(239 246 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-blue-500{--tw-gradient-from: #3b82f6 var(--tw-gradient-from-position);--tw-gradient-to: rgb(59 130 246 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-blue-500\\/10{--tw-gradient-from: rgb(59 130 246 / .1) var(--tw-gradient-from-position);--tw-gradient-to: rgb(59 130 246 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-blue-600{--tw-gradient-from: #2563eb var(--tw-gradient-from-position);--tw-gradient-to: rgb(37 99 235 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-blue-600\\/90{--tw-gradient-from: rgb(37 99 235 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(37 99 235 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-gray-100{--tw-gradient-from: #f3f4f6 var(--tw-gradient-from-position);--tw-gradient-to: rgb(243 244 246 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-gray-50{--tw-gradient-from: #f9fafb var(--tw-gradient-from-position);--tw-gradient-to: rgb(249 250 251 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-gray-500{--tw-gradient-from: #6b7280 var(--tw-gradient-from-position);--tw-gradient-to: rgb(107 114 128 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-green-100{--tw-gradient-from: #dcfce7 var(--tw-gradient-from-position);--tw-gradient-to: rgb(220 252 231 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-green-400{--tw-gradient-from: #4ade80 var(--tw-gradient-from-position);--tw-gradient-to: rgb(74 222 128 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-green-50{--tw-gradient-from: #f0fdf4 var(--tw-gradient-from-position);--tw-gradient-to: rgb(240 253 244 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-green-500{--tw-gradient-from: #22c55e var(--tw-gradient-from-position);--tw-gradient-to: rgb(34 197 94 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-green-500\\/10{--tw-gradient-from: rgb(34 197 94 / .1) var(--tw-gradient-from-position);--tw-gradient-to: rgb(34 197 94 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-green-600{--tw-gradient-from: #16a34a var(--tw-gradient-from-position);--tw-gradient-to: rgb(22 163 74 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-indigo-600{--tw-gradient-from: #4f46e5 var(--tw-gradient-from-position);--tw-gradient-to: rgb(79 70 229 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-orange-100{--tw-gradient-from: #ffedd5 var(--tw-gradient-from-position);--tw-gradient-to: rgb(255 237 213 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-orange-400{--tw-gradient-from: #fb923c var(--tw-gradient-from-position);--tw-gradient-to: rgb(251 146 60 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-orange-50{--tw-gradient-from: #fff7ed var(--tw-gradient-from-position);--tw-gradient-to: rgb(255 247 237 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-orange-500{--tw-gradient-from: #f97316 var(--tw-gradient-from-position);--tw-gradient-to: rgb(249 115 22 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-orange-500\\/5{--tw-gradient-from: rgb(249 115 22 / .05) var(--tw-gradient-from-position);--tw-gradient-to: rgb(249 115 22 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-orange-600{--tw-gradient-from: #ea580c var(--tw-gradient-from-position);--tw-gradient-to: rgb(234 88 12 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-orange-600\\/20{--tw-gradient-from: rgb(234 88 12 / .2) var(--tw-gradient-from-position);--tw-gradient-to: rgb(234 88 12 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-pink-100{--tw-gradient-from: #fce7f3 var(--tw-gradient-from-position);--tw-gradient-to: rgb(252 231 243 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-pink-400{--tw-gradient-from: #f472b6 var(--tw-gradient-from-position);--tw-gradient-to: rgb(244 114 182 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-pink-400\\/50{--tw-gradient-from: rgb(244 114 182 / .5) var(--tw-gradient-from-position);--tw-gradient-to: rgb(244 114 182 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-primary{--tw-gradient-from: var(--primary) var(--tw-gradient-from-position);--tw-gradient-to: rgb(255 255 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-100{--tw-gradient-from: #f3e8ff var(--tw-gradient-from-position);--tw-gradient-to: rgb(243 232 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-400{--tw-gradient-from: #c084fc var(--tw-gradient-from-position);--tw-gradient-to: rgb(192 132 252 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-400\\/50{--tw-gradient-from: rgb(192 132 252 / .5) var(--tw-gradient-from-position);--tw-gradient-to: rgb(192 132 252 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-50{--tw-gradient-from: #faf5ff var(--tw-gradient-from-position);--tw-gradient-to: rgb(250 245 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-500{--tw-gradient-from: #a855f7 var(--tw-gradient-from-position);--tw-gradient-to: rgb(168 85 247 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-500\\/10{--tw-gradient-from: rgb(168 85 247 / .1) var(--tw-gradient-from-position);--tw-gradient-to: rgb(168 85 247 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-600{--tw-gradient-from: #9333ea var(--tw-gradient-from-position);--tw-gradient-to: rgb(147 51 234 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-600\\/90{--tw-gradient-from: rgb(147 51 234 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(147 51 234 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-red-100{--tw-gradient-from: #fee2e2 var(--tw-gradient-from-position);--tw-gradient-to: rgb(254 226 226 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-red-100\\/50{--tw-gradient-from: rgb(254 226 226 / .5) var(--tw-gradient-from-position);--tw-gradient-to: rgb(254 226 226 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-red-50{--tw-gradient-from: #fef2f2 var(--tw-gradient-from-position);--tw-gradient-to: rgb(254 242 242 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-red-500{--tw-gradient-from: #ef4444 var(--tw-gradient-from-position);--tw-gradient-to: rgb(239 68 68 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-slate-50{--tw-gradient-from: #f8fafc var(--tw-gradient-from-position);--tw-gradient-to: rgb(248 250 252 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-slate-700\\/90{--tw-gradient-from: rgb(51 65 85 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(51 65 85 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-slate-800{--tw-gradient-from: #1e293b var(--tw-gradient-from-position);--tw-gradient-to: rgb(30 41 59 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-slate-900{--tw-gradient-from: #0f172a var(--tw-gradient-from-position);--tw-gradient-to: rgb(15 23 42 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-white{--tw-gradient-from: #fff var(--tw-gradient-from-position);--tw-gradient-to: rgb(255 255 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-white\\/10{--tw-gradient-from: rgb(255 255 255 / .1) var(--tw-gradient-from-position);--tw-gradient-to: rgb(255 255 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-yellow-100{--tw-gradient-from: #fef9c3 var(--tw-gradient-from-position);--tw-gradient-to: rgb(254 249 195 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-yellow-400{--tw-gradient-from: #facc15 var(--tw-gradient-from-position);--tw-gradient-to: rgb(250 204 21 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-yellow-50{--tw-gradient-from: #fefce8 var(--tw-gradient-from-position);--tw-gradient-to: rgb(254 252 232 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-yellow-500{--tw-gradient-from: #eab308 var(--tw-gradient-from-position);--tw-gradient-to: rgb(234 179 8 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-yellow-600\\/90{--tw-gradient-from: rgb(202 138 4 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(202 138 4 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.via-emerald-50{--tw-gradient-to: rgb(236 253 245 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #ecfdf5 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-emerald-600{--tw-gradient-to: rgb(5 150 105 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #059669 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-gray-800{--tw-gradient-to: rgb(31 41 55 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #1f2937 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-indigo-50{--tw-gradient-to: rgb(238 242 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #eef2ff var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-indigo-600{--tw-gradient-to: rgb(79 70 229 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #4f46e5 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-orange-50{--tw-gradient-to: rgb(255 247 237 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #fff7ed var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-orange-500{--tw-gradient-to: rgb(249 115 22 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #f97316 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-pink-400\\/50{--tw-gradient-to: rgb(244 114 182 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(244 114 182 / .5) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-pink-600{--tw-gradient-to: rgb(219 39 119 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #db2777 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-purple-400\\/50{--tw-gradient-to: rgb(192 132 252 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(192 132 252 / .5) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-purple-500{--tw-gradient-to: rgb(168 85 247 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #a855f7 var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-purple-600{--tw-gradient-to: rgb(147 51 234 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #9333ea var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-slate-50{--tw-gradient-to: rgb(248 250 252 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #f8fafc var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-slate-800{--tw-gradient-to: rgb(30 41 59 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #1e293b var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-transparent{--tw-gradient-to: rgb(0 0 0 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), transparent var(--tw-gradient-via-position), var(--tw-gradient-to)}.to-amber-100{--tw-gradient-to: #fef3c7 var(--tw-gradient-to-position)}.to-amber-50{--tw-gradient-to: #fffbeb var(--tw-gradient-to-position)}.to-amber-600\\/90{--tw-gradient-to: rgb(217 119 6 / .9) var(--tw-gradient-to-position)}.to-blue-100{--tw-gradient-to: #dbeafe var(--tw-gradient-to-position)}.to-blue-200{--tw-gradient-to: #bfdbfe var(--tw-gradient-to-position)}.to-blue-400{--tw-gradient-to: #60a5fa var(--tw-gradient-to-position)}.to-blue-50{--tw-gradient-to: #eff6ff var(--tw-gradient-to-position)}.to-blue-500\\/10{--tw-gradient-to: rgb(59 130 246 / .1) var(--tw-gradient-to-position)}.to-blue-600{--tw-gradient-to: #2563eb var(--tw-gradient-to-position)}.to-cyan-100{--tw-gradient-to: #cffafe var(--tw-gradient-to-position)}.to-cyan-50{--tw-gradient-to: #ecfeff var(--tw-gradient-to-position)}.to-cyan-500{--tw-gradient-to: #06b6d4 var(--tw-gradient-to-position)}.to-cyan-600{--tw-gradient-to: #0891b2 var(--tw-gradient-to-position)}.to-cyan-600\\/90{--tw-gradient-to: rgb(8 145 178 / .9) var(--tw-gradient-to-position)}.to-emerald-100{--tw-gradient-to: #d1fae5 var(--tw-gradient-to-position)}.to-emerald-50{--tw-gradient-to: #ecfdf5 var(--tw-gradient-to-position)}.to-emerald-500{--tw-gradient-to: #10b981 var(--tw-gradient-to-position)}.to-emerald-600{--tw-gradient-to: #059669 var(--tw-gradient-to-position)}.to-gray-100{--tw-gradient-to: #f3f4f6 var(--tw-gradient-to-position)}.to-gray-200{--tw-gradient-to: #e5e7eb var(--tw-gradient-to-position)}.to-gray-50{--tw-gradient-to: #f9fafb var(--tw-gradient-to-position)}.to-gray-600{--tw-gradient-to: #4b5563 var(--tw-gradient-to-position)}.to-green-200{--tw-gradient-to: #bbf7d0 var(--tw-gradient-to-position)}.to-green-50{--tw-gradient-to: #f0fdf4 var(--tw-gradient-to-position)}.to-green-600{--tw-gradient-to: #16a34a var(--tw-gradient-to-position)}.to-indigo-50{--tw-gradient-to: #eef2ff var(--tw-gradient-to-position)}.to-orange-100{--tw-gradient-to: #ffedd5 var(--tw-gradient-to-position)}.to-orange-200{--tw-gradient-to: #fed7aa var(--tw-gradient-to-position)}.to-orange-50{--tw-gradient-to: #fff7ed var(--tw-gradient-to-position)}.to-orange-500{--tw-gradient-to: #f97316 var(--tw-gradient-to-position)}.to-orange-600\\/90{--tw-gradient-to: rgb(234 88 12 / .9) var(--tw-gradient-to-position)}.to-pink-100{--tw-gradient-to: #fce7f3 var(--tw-gradient-to-position)}.to-pink-400{--tw-gradient-to: #f472b6 var(--tw-gradient-to-position)}.to-pink-50{--tw-gradient-to: #fdf2f8 var(--tw-gradient-to-position)}.to-pink-500{--tw-gradient-to: #ec4899 var(--tw-gradient-to-position)}.to-pink-500\\/10{--tw-gradient-to: rgb(236 72 153 / .1) var(--tw-gradient-to-position)}.to-pink-600{--tw-gradient-to: #db2777 var(--tw-gradient-to-position)}.to-pink-600\\/50{--tw-gradient-to: rgb(219 39 119 / .5) var(--tw-gradient-to-position)}.to-pink-600\\/90{--tw-gradient-to: rgb(219 39 119 / .9) var(--tw-gradient-to-position)}.to-purple-100{--tw-gradient-to: #f3e8ff var(--tw-gradient-to-position)}.to-purple-200{--tw-gradient-to: #e9d5ff var(--tw-gradient-to-position)}.to-purple-50{--tw-gradient-to: #faf5ff var(--tw-gradient-to-position)}.to-purple-500\\/10{--tw-gradient-to: rgb(168 85 247 / .1) var(--tw-gradient-to-position)}.to-purple-600{--tw-gradient-to: #9333ea var(--tw-gradient-to-position)}.to-purple-600\\/50{--tw-gradient-to: rgb(147 51 234 / .5) var(--tw-gradient-to-position)}.to-red-200\\/30{--tw-gradient-to: rgb(254 202 202 / .3) var(--tw-gradient-to-position)}.to-red-400{--tw-gradient-to: #f87171 var(--tw-gradient-to-position)}.to-red-50{--tw-gradient-to: #fef2f2 var(--tw-gradient-to-position)}.to-red-500{--tw-gradient-to: #ef4444 var(--tw-gradient-to-position)}.to-red-500\\/5{--tw-gradient-to: rgb(239 68 68 / .05) var(--tw-gradient-to-position)}.to-red-600{--tw-gradient-to: #dc2626 var(--tw-gradient-to-position)}.to-red-600\\/20{--tw-gradient-to: rgb(220 38 38 / .2) var(--tw-gradient-to-position)}.to-rose-100{--tw-gradient-to: #ffe4e6 var(--tw-gradient-to-position)}.to-slate-50{--tw-gradient-to: #f8fafc var(--tw-gradient-to-position)}.to-slate-800\\/90{--tw-gradient-to: rgb(30 41 59 / .9) var(--tw-gradient-to-position)}.to-slate-900{--tw-gradient-to: #0f172a var(--tw-gradient-to-position)}.to-slate-950{--tw-gradient-to: #020617 var(--tw-gradient-to-position)}.to-teal-50{--tw-gradient-to: #f0fdfa var(--tw-gradient-to-position)}.to-teal-600{--tw-gradient-to: #0d9488 var(--tw-gradient-to-position)}.to-transparent{--tw-gradient-to: transparent var(--tw-gradient-to-position)}.to-white\\/5{--tw-gradient-to: rgb(255 255 255 / .05) var(--tw-gradient-to-position)}.to-yellow-400{--tw-gradient-to: #facc15 var(--tw-gradient-to-position)}.bg-clip-text{-webkit-background-clip:text;background-clip:text}.fill-current{fill:currentColor}.stroke-muted{stroke:var(--muted)}.object-contain{-o-object-fit:contain;object-fit:contain}.object-cover{-o-object-fit:cover;object-fit:cover}.p-0{padding:0}.p-0\\.5{padding:.125rem}.p-1{padding:.25rem}.p-1\\.5{padding:.375rem}.p-2{padding:.5rem}.p-3{padding:.75rem}.p-4{padding:1rem}.p-5{padding:1.25rem}.p-6{padding:1.5rem}.p-8{padding:2rem}.p-\\[1px\\]{padding:1px}.px-1{padding-left:.25rem;padding-right:.25rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-2\\.5{padding-left:.625rem;padding-right:.625rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-4{padding-left:1rem;padding-right:1rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.px-8{padding-left:2rem;padding-right:2rem}.py-0\\.5{padding-top:.125rem;padding-bottom:.125rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-1\\.5{padding-top:.375rem;padding-bottom:.375rem}.py-12{padding-top:3rem;padding-bottom:3rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.py-2\\.5{padding-top:.625rem;padding-bottom:.625rem}.py-3{padding-top:.75rem;padding-bottom:.75rem}.py-4{padding-top:1rem;padding-bottom:1rem}.py-6{padding-top:1.5rem;padding-bottom:1.5rem}.py-8{padding-top:2rem;padding-bottom:2rem}.pb-2{padding-bottom:.5rem}.pb-20{padding-bottom:5rem}.pb-24{padding-bottom:6rem}.pb-3{padding-bottom:.75rem}.pb-32{padding-bottom:8rem}.pb-4{padding-bottom:1rem}.pb-6{padding-bottom:1.5rem}.pl-10{padding-left:2.5rem}.pl-11{padding-left:2.75rem}.pl-2\\.5{padding-left:.625rem}.pl-3{padding-left:.75rem}.pl-4{padding-left:1rem}.pl-8{padding-left:2rem}.pr-10{padding-right:2.5rem}.pr-12{padding-right:3rem}.pr-2{padding-right:.5rem}.pr-2\\.5{padding-right:.625rem}.pr-4{padding-right:1rem}.pr-8{padding-right:2rem}.pt-0{padding-top:0}.pt-1{padding-top:.25rem}.pt-2{padding-top:.5rem}.pt-3{padding-top:.75rem}.pt-4{padding-top:1rem}.pt-6{padding-top:1.5rem}.pt-8{padding-top:2rem}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.align-middle{vertical-align:middle}.font-mono{font-family:var(--font-mono)}.text-2xl{font-size:1.5rem;line-height:2rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-5xl{font-size:3rem;line-height:1}.text-6xl{font-size:3.75rem;line-height:1}.text-\\[0\\.8rem\\]{font-size:.8rem}.text-\\[10px\\]{font-size:10px}.text-base{font-size:1rem;line-height:1.5rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:.75rem;line-height:1rem}.font-black{font-weight:900}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-normal{font-weight:400}.font-semibold{font-weight:600}.capitalize{text-transform:capitalize}.italic{font-style:italic}.tabular-nums{--tw-numeric-spacing: tabular-nums;font-variant-numeric:var(--tw-ordinal) var(--tw-slashed-zero) var(--tw-numeric-figure) var(--tw-numeric-spacing) var(--tw-numeric-fraction)}.leading-none{line-height:1}.leading-relaxed{line-height:1.625}.leading-tight{line-height:1.25}.tracking-tight{letter-spacing:-.025em}.tracking-wide{letter-spacing:.025em}.tracking-widest{letter-spacing:.1em}.text-accent-foreground{color:var(--accent-foreground)}.text-amber-600{--tw-text-opacity: 1;color:rgb(217 119 6 / var(--tw-text-opacity, 1))}.text-amber-700{--tw-text-opacity: 1;color:rgb(180 83 9 / var(--tw-text-opacity, 1))}.text-black{--tw-text-opacity: 1;color:rgb(0 0 0 / var(--tw-text-opacity, 1))}.text-blue-100{--tw-text-opacity: 1;color:rgb(219 234 254 / var(--tw-text-opacity, 1))}.text-blue-200{--tw-text-opacity: 1;color:rgb(191 219 254 / var(--tw-text-opacity, 1))}.text-blue-300{--tw-text-opacity: 1;color:rgb(147 197 253 / var(--tw-text-opacity, 1))}.text-blue-400{--tw-text-opacity: 1;color:rgb(96 165 250 / var(--tw-text-opacity, 1))}.text-blue-500{--tw-text-opacity: 1;color:rgb(59 130 246 / var(--tw-text-opacity, 1))}.text-blue-600{--tw-text-opacity: 1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.text-blue-600\\/70{color:#2563ebb3}.text-blue-700{--tw-text-opacity: 1;color:rgb(29 78 216 / var(--tw-text-opacity, 1))}.text-blue-800{--tw-text-opacity: 1;color:rgb(30 64 175 / var(--tw-text-opacity, 1))}.text-blue-900{--tw-text-opacity: 1;color:rgb(30 58 138 / var(--tw-text-opacity, 1))}.text-card-foreground{color:var(--card-foreground)}.text-current{color:currentColor}.text-destructive{color:var(--destructive)}.text-destructive-foreground{color:var(--destructive-foreground)}.text-emerald-600{--tw-text-opacity: 1;color:rgb(5 150 105 / var(--tw-text-opacity, 1))}.text-foreground{color:var(--foreground)}.text-gray-200{--tw-text-opacity: 1;color:rgb(229 231 235 / var(--tw-text-opacity, 1))}.text-gray-300{--tw-text-opacity: 1;color:rgb(209 213 219 / var(--tw-text-opacity, 1))}.text-gray-400{--tw-text-opacity: 1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.text-gray-500{--tw-text-opacity: 1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.text-gray-600{--tw-text-opacity: 1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.text-gray-700{--tw-text-opacity: 1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.text-gray-800{--tw-text-opacity: 1;color:rgb(31 41 55 / var(--tw-text-opacity, 1))}.text-gray-900{--tw-text-opacity: 1;color:rgb(17 24 39 / var(--tw-text-opacity, 1))}.text-green-100{--tw-text-opacity: 1;color:rgb(220 252 231 / var(--tw-text-opacity, 1))}.text-green-300{--tw-text-opacity: 1;color:rgb(134 239 172 / var(--tw-text-opacity, 1))}.text-green-500{--tw-text-opacity: 1;color:rgb(34 197 94 / var(--tw-text-opacity, 1))}.text-green-600{--tw-text-opacity: 1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.text-green-600\\/70{color:#16a34ab3}.text-green-700{--tw-text-opacity: 1;color:rgb(21 128 61 / var(--tw-text-opacity, 1))}.text-green-800{--tw-text-opacity: 1;color:rgb(22 101 52 / var(--tw-text-opacity, 1))}.text-green-900{--tw-text-opacity: 1;color:rgb(20 83 45 / var(--tw-text-opacity, 1))}.text-indigo-100{--tw-text-opacity: 1;color:rgb(224 231 255 / var(--tw-text-opacity, 1))}.text-indigo-500{--tw-text-opacity: 1;color:rgb(99 102 241 / var(--tw-text-opacity, 1))}.text-indigo-600{--tw-text-opacity: 1;color:rgb(79 70 229 / var(--tw-text-opacity, 1))}.text-muted-foreground{color:var(--muted-foreground)}.text-orange-200{--tw-text-opacity: 1;color:rgb(254 215 170 / var(--tw-text-opacity, 1))}.text-orange-300{--tw-text-opacity: 1;color:rgb(253 186 116 / var(--tw-text-opacity, 1))}.text-orange-400{--tw-text-opacity: 1;color:rgb(251 146 60 / var(--tw-text-opacity, 1))}.text-orange-500{--tw-text-opacity: 1;color:rgb(249 115 22 / var(--tw-text-opacity, 1))}.text-orange-600{--tw-text-opacity: 1;color:rgb(234 88 12 / var(--tw-text-opacity, 1))}.text-orange-600\\/70{color:#ea580cb3}.text-orange-700{--tw-text-opacity: 1;color:rgb(194 65 12 / var(--tw-text-opacity, 1))}.text-orange-800{--tw-text-opacity: 1;color:rgb(154 52 18 / var(--tw-text-opacity, 1))}.text-orange-900{--tw-text-opacity: 1;color:rgb(124 45 18 / var(--tw-text-opacity, 1))}.text-pink-600{--tw-text-opacity: 1;color:rgb(219 39 119 / var(--tw-text-opacity, 1))}.text-pink-700{--tw-text-opacity: 1;color:rgb(190 24 93 / var(--tw-text-opacity, 1))}.text-popover-foreground{color:var(--popover-foreground)}.text-primary{color:var(--primary)}.text-primary-foreground{color:var(--primary-foreground)}.text-purple-300{--tw-text-opacity: 1;color:rgb(216 180 254 / var(--tw-text-opacity, 1))}.text-purple-400{--tw-text-opacity: 1;color:rgb(192 132 252 / var(--tw-text-opacity, 1))}.text-purple-500{--tw-text-opacity: 1;color:rgb(168 85 247 / var(--tw-text-opacity, 1))}.text-purple-600{--tw-text-opacity: 1;color:rgb(147 51 234 / var(--tw-text-opacity, 1))}.text-purple-700{--tw-text-opacity: 1;color:rgb(126 34 206 / var(--tw-text-opacity, 1))}.text-purple-800{--tw-text-opacity: 1;color:rgb(107 33 168 / var(--tw-text-opacity, 1))}.text-red-300{--tw-text-opacity: 1;color:rgb(252 165 165 / var(--tw-text-opacity, 1))}.text-red-500{--tw-text-opacity: 1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.text-red-600{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.text-red-600\\/70{color:#dc2626b3}.text-red-700{--tw-text-opacity: 1;color:rgb(185 28 28 / var(--tw-text-opacity, 1))}.text-red-900{--tw-text-opacity: 1;color:rgb(127 29 29 / var(--tw-text-opacity, 1))}.text-secondary-foreground{color:var(--secondary-foreground)}.text-sidebar-foreground{color:var(--sidebar-foreground)}.text-slate-700{--tw-text-opacity: 1;color:rgb(51 65 85 / var(--tw-text-opacity, 1))}.text-slate-800{--tw-text-opacity: 1;color:rgb(30 41 59 / var(--tw-text-opacity, 1))}.text-teal-600{--tw-text-opacity: 1;color:rgb(13 148 136 / var(--tw-text-opacity, 1))}.text-transparent{color:transparent}.text-white{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-white\\/60{color:#fff9}.text-white\\/70{color:#ffffffb3}.text-white\\/80{color:#fffc}.text-white\\/90{color:#ffffffe6}.text-yellow-300{--tw-text-opacity: 1;color:rgb(253 224 71 / var(--tw-text-opacity, 1))}.text-yellow-500{--tw-text-opacity: 1;color:rgb(234 179 8 / var(--tw-text-opacity, 1))}.text-yellow-600{--tw-text-opacity: 1;color:rgb(202 138 4 / var(--tw-text-opacity, 1))}.text-yellow-600\\/70{color:#ca8a04b3}.text-yellow-700{--tw-text-opacity: 1;color:rgb(161 98 7 / var(--tw-text-opacity, 1))}.text-yellow-800{--tw-text-opacity: 1;color:rgb(133 77 14 / var(--tw-text-opacity, 1))}.no-underline{text-decoration-line:none}.underline-offset-4{text-underline-offset:4px}.opacity-0{opacity:0}.opacity-100{opacity:1}.opacity-50{opacity:.5}.opacity-60{opacity:.6}.opacity-70{opacity:.7}.opacity-75{opacity:.75}.opacity-80{opacity:.8}.opacity-90{opacity:.9}.shadow-2xl{--tw-shadow: 0 25px 50px -12px rgb(0 0 0 / .25);--tw-shadow-colored: 0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\\[0_0_0_1px_hsl\\(var\\(--sidebar-border\\)\\)\\]{--tw-shadow: 0 0 0 1px hsl(var(--sidebar-border));--tw-shadow-colored: 0 0 0 1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\\[0_25px_60px_-12px_rgba\\(0\\,0\\,0\\,0\\.8\\)\\]{--tw-shadow: 0 25px 60px -12px rgba(0,0,0,.8);--tw-shadow-colored: 0 25px 60px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-inner{--tw-shadow: inset 0 2px 4px 0 rgb(0 0 0 / .05);--tw-shadow-colored: inset 0 2px 4px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-lg{--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-md{--tw-shadow: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1);--tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-none{--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-sm{--tw-shadow: 0 1px 2px 0 rgb(0 0 0 / .05);--tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-xl{--tw-shadow: 0 20px 25px -5px rgb(0 0 0 / .1), 0 8px 10px -6px rgb(0 0 0 / .1);--tw-shadow-colored: 0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-orange-500\\/25{--tw-shadow-color: rgb(249 115 22 / .25);--tw-shadow: var(--tw-shadow-colored)}.outline-none{outline:2px solid transparent;outline-offset:2px}.outline{outline-style:solid}.ring-0{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.ring-2{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.ring-ring{--tw-ring-color: var(--ring)}.ring-sidebar-ring{--tw-ring-color: var(--sidebar-ring)}.ring-white{--tw-ring-opacity: 1;--tw-ring-color: rgb(255 255 255 / var(--tw-ring-opacity, 1))}.ring-offset-2{--tw-ring-offset-width: 2px}.ring-offset-background{--tw-ring-offset-color: var(--background)}.ring-offset-transparent{--tw-ring-offset-color: transparent}.blur-2xl{--tw-blur: blur(40px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.blur-lg{--tw-blur: blur(16px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.blur-xl{--tw-blur: blur(24px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-2xl{--tw-drop-shadow: drop-shadow(0 25px 25px rgb(0 0 0 / .15));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-lg{--tw-drop-shadow: drop-shadow(0 10px 8px rgb(0 0 0 / .04)) drop-shadow(0 4px 3px rgb(0 0 0 / .1));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.backdrop-blur-md{--tw-backdrop-blur: blur(12px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-sm{--tw-backdrop-blur: blur(4px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-xl{--tw-backdrop-blur: blur(24px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-\\[left\\,right\\,width\\]{transition-property:left,right,width;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-\\[margin\\,opacity\\]{transition-property:margin,opacity;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-\\[width\\,height\\,padding\\]{transition-property:width,height,padding;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-\\[width\\]{transition-property:width;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-colors{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-opacity{transition-property:opacity;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-shadow{transition-property:box-shadow;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-transform{transition-property:transform;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.delay-1000{transition-delay:1s}.duration-100{transition-duration:.1s}.duration-1000{transition-duration:1s}.duration-200{transition-duration:.2s}.duration-300{transition-duration:.3s}.duration-500{transition-duration:.5s}.ease-in{transition-timing-function:cubic-bezier(.4,0,1,1)}.ease-in-out{transition-timing-function:cubic-bezier(.4,0,.2,1)}.ease-linear{transition-timing-function:linear}.ease-out{transition-timing-function:cubic-bezier(0,0,.2,1)}@keyframes enter{0%{opacity:var(--tw-enter-opacity, 1);transform:translate3d(var(--tw-enter-translate-x, 0),var(--tw-enter-translate-y, 0),0) scale3d(var(--tw-enter-scale, 1),var(--tw-enter-scale, 1),var(--tw-enter-scale, 1)) rotate(var(--tw-enter-rotate, 0))}}@keyframes exit{to{opacity:var(--tw-exit-opacity, 1);transform:translate3d(var(--tw-exit-translate-x, 0),var(--tw-exit-translate-y, 0),0) scale3d(var(--tw-exit-scale, 1),var(--tw-exit-scale, 1),var(--tw-exit-scale, 1)) rotate(var(--tw-exit-rotate, 0))}}.animate-in{animation-name:enter;animation-duration:.15s;--tw-enter-opacity: initial;--tw-enter-scale: initial;--tw-enter-rotate: initial;--tw-enter-translate-x: initial;--tw-enter-translate-y: initial}.fade-in,.fade-in-0{--tw-enter-opacity: 0}.fade-in-80{--tw-enter-opacity: .8}.zoom-in-95{--tw-enter-scale: .95}.slide-in-from-bottom-4{--tw-enter-translate-y: 1rem}.duration-100{animation-duration:.1s}.duration-1000{animation-duration:1s}.duration-200{animation-duration:.2s}.duration-300{animation-duration:.3s}.duration-500{animation-duration:.5s}.delay-1000{animation-delay:1s}.ease-in{animation-timing-function:cubic-bezier(.4,0,1,1)}.ease-in-out{animation-timing-function:cubic-bezier(.4,0,.2,1)}.ease-linear{animation-timing-function:linear}.ease-out{animation-timing-function:cubic-bezier(0,0,.2,1)}.running{animation-play-state:running}:root{--background: linear-gradient(135deg, hsl(110 60% 97%) 0%, hsl(180 50% 96%) 100%);--background-solid: hsl(110 60% 97%);--foreground: hsl(222.2 84% 4.9%);--card: hsl(0 0% 100%);--card-foreground: hsl(222.2 84% 4.9%);--popover: hsl(0 0% 100%);--popover-foreground: hsl(222.2 84% 4.9%);--primary: linear-gradient(135deg, hsl(160 84% 39%) 0%, hsl(200 100% 50%) 100%);--primary-solid: hsl(160 84% 39%);--primary-foreground: hsl(0 0% 98%);--secondary: hsl(110 50% 92%);--secondary-foreground: hsl(160 84% 39%);--muted: hsl(110 40% 94%);--muted-foreground: hsl(160 30% 45%);--accent: linear-gradient(135deg, hsl(110 50% 92%) 0%, hsl(140 60% 88%) 100%);--accent-solid: hsl(110 50% 92%);--accent-foreground: hsl(160 84% 39%);--destructive: hsl(0 84% 60%);--destructive-foreground: hsl(0 0% 98%);--border: hsl(110 40% 87%);--input: hsl(110 30% 90%);--ring: hsl(160 84% 39%);--chart-1: hsl(160 84% 39%);--chart-2: hsl(200 100% 50%);--chart-3: hsl(45 100% 60%);--chart-4: hsl(25 100% 65%);--chart-5: hsl(290 80% 58%);--sidebar: hsl(0 0% 100%);--sidebar-foreground: hsl(222.2 84% 4.9%);--sidebar-primary: hsl(160 84% 39%);--sidebar-primary-foreground: hsl(0 0% 98%);--sidebar-accent: hsl(110 50% 92%);--sidebar-accent-foreground: hsl(160 84% 39%);--sidebar-border: hsl(110 40% 87%);--sidebar-ring: hsl(160 84% 39%);--font-sans: \"Roboto\", sans-serif;--font-serif: Georgia, serif;--font-mono: \"Courier New\", monospace;--radius: .75rem;--shadow-soft: 0 4px 16px rgba(20, 184, 166, .12);--shadow-medium: 0 8px 32px rgba(20, 184, 166, .16);--shadow-strong: 0 16px 48px rgba(20, 184, 166, .2);--bg-gradient: linear-gradient(135deg, #8B5CF6 0%, #A855F7 100%)}.dark{--background: linear-gradient(135deg, hsl(222.2 84% 4.9%) 0%, hsl(180 30% 8%) 100%);--background-solid: hsl(222.2 84% 4.9%);--foreground: hsl(210 40% 98%);--card: linear-gradient(135deg, hsl(222.2 84% 4.9%) 0%, hsl(180 20% 8%) 100%);--card-foreground: hsl(210 40% 98%);--popover: hsl(222.2 84% 4.9%);--popover-foreground: hsl(210 40% 98%);--primary: linear-gradient(135deg, hsl(160 70% 45%) 0%, hsl(200 80% 55%) 100%);--primary-solid: hsl(160 70% 45%);--primary-foreground: hsl(0 0% 98%);--secondary: hsl(180 20% 20%);--secondary-foreground: hsl(160 60% 80%);--muted: hsl(180 15% 20%);--muted-foreground: hsl(180 10% 65%);--accent: linear-gradient(135deg, hsl(180 20% 20%) 0%, hsl(160 25% 18%) 100%);--accent-solid: hsl(180 20% 20%);--accent-foreground: hsl(160 60% 80%);--destructive: hsl(0 62.8% 30.6%);--destructive-foreground: hsl(210 40% 98%);--border: hsl(180 15% 20%);--input: hsl(180 15% 20%);--ring: hsl(160 70% 45%);--chart-1: hsl(160 70% 45%);--chart-2: hsl(200 80% 55%);--chart-3: hsl(45 90% 60%);--chart-4: hsl(25 90% 65%);--chart-5: hsl(290 70% 58%);--sidebar: hsl(222.2 84% 4.9%);--sidebar-foreground: hsl(210 40% 98%);--sidebar-primary: hsl(160 70% 45%);--sidebar-primary-foreground: hsl(0 0% 98%);--sidebar-accent: hsl(180 20% 20%);--sidebar-accent-foreground: hsl(160 60% 80%);--sidebar-border: hsl(180 15% 20%);--sidebar-ring: hsl(160 70% 45%);--shadow-soft: 0 4px 16px rgba(0, 0, 0, .25);--shadow-medium: 0 8px 32px rgba(0, 0, 0, .35);--shadow-strong: 0 16px 48px rgba(0, 0, 0, .45);--bg-gradient: linear-gradient(135deg, #2D1B69 0%, #5B21B6 100%)}.camera-viewfinder{background:linear-gradient(45deg,transparent 15px,rgba(20,184,166,.3) 15px,rgba(20,184,166,.3) 16px,transparent 16px),linear-gradient(-45deg,transparent 15px,rgba(20,184,166,.3) 15px,rgba(20,184,166,.3) 16px,transparent 16px);background-size:20px 20px;background-position:0 0,10px 10px}.pulse-green{animation:pulse-green 2s cubic-bezier(.4,0,.6,1) infinite}@keyframes pulse-green{0%,to{opacity:1}50%{opacity:.5}}@keyframes fadeInUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}@keyframes fadeInDown{0%{opacity:0;transform:translateY(-30px)}to{opacity:1;transform:translateY(0)}}@keyframes fadeInLeft{0%{opacity:0;transform:translate(-30px)}to{opacity:1;transform:translate(0)}}@keyframes fadeInRight{0%{opacity:0;transform:translate(30px)}to{opacity:1;transform:translate(0)}}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}@keyframes float{0%,to{transform:translateY(0)}50%{transform:translateY(-10px)}}@keyframes spinSlow{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes pulseGlow{0%,to{box-shadow:0 0 20px #14b8a680}50%{box-shadow:0 0 40px #14b8a6cc}}.animate-fade-in-up{animation:fadeInUp .8s ease-out forwards}.animate-fade-in-down{animation:fadeInDown .8s ease-out forwards}.animate-fade-in-left{animation:fadeInLeft .8s ease-out forwards}.animate-fade-in-right{animation:fadeInRight .8s ease-out forwards}.animate-fade-in{animation:fadeIn .8s ease-out forwards}.animate-float{animation:float 3s ease-in-out infinite}.animate-spin-slow{animation:spinSlow 8s linear infinite}.animate-pulse-glow{animation:pulseGlow 2s ease-in-out infinite}.animation-delay-300{animation-delay:.3s}.animation-delay-500{animation-delay:.5s}.animation-delay-600{animation-delay:.6s}.animation-delay-900{animation-delay:.9s}.animation-delay-1000{animation-delay:1s}.animation-delay-1200{animation-delay:1.2s}.animation-delay-1500{animation-delay:1.5s}.animation-delay-1800{animation-delay:1.8s}.animation-delay-2100{animation-delay:2.1s}.animation-delay-2400{animation-delay:2.4s}.animation-delay-2700{animation-delay:2.7s}.animation-delay-3000{animation-delay:3s}.animation-delay-3300{animation-delay:3.3s}.animation-delay-3600{animation-delay:3.6s}.animation-delay-4500{animation-delay:4.5s}.animation-delay-4800{animation-delay:4.8s}.animation-delay-5100{animation-delay:5.1s}.animation-delay-5700{animation-delay:5.7s}.animation-delay-6000{animation-delay:6s}.animation-delay-6300{animation-delay:6.3s}@keyframes shimmer{0%{background-position:-200% 0}to{background-position:200% 0}}@keyframes slideIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes scaleIn{0%{opacity:0;transform:scale(.9)}to{opacity:1;transform:scale(1)}}.animate-shimmer{background:linear-gradient(90deg,#fff0,#fff3,#fff0);background-size:200% 100%;animation:shimmer 2s ease-in-out infinite}.animate-slide-in{animation:slideIn .4s ease-out forwards}.animate-scale-in{animation:scaleIn .3s ease-out forwards}::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{background:var(--muted);border-radius:3px}::-webkit-scrollbar-thumb{background:var(--primary-solid);border-radius:3px}::-webkit-scrollbar-thumb:hover{background:var(--ring)}.enhanced-focus:focus-visible{outline:2px solid var(--ring);outline-offset:2px;border-radius:var(--radius)}.skeleton{background:linear-gradient(90deg,var(--muted) 25%,var(--muted)/50 50%,var(--muted) 75%);background-size:200% 100%;animation:shimmer 2s ease-in-out infinite}.button-glow:hover{box-shadow:0 0 20px var(--primary-solid) / 30}.text-responsive{font-size:clamp(.875rem,2.5vw,1rem)}.glass-enhanced{background:#ffffff1a;-webkit-backdrop-filter:blur(20px) saturate(1.8);backdrop-filter:blur(20px) saturate(1.8);border:1px solid rgba(255,255,255,.2)}.dark .glass-enhanced{background:#141428cc;border:1px solid rgba(255,255,255,.1)}.nutrition-gradient{background:linear-gradient(135deg,#10b77f,#3c3,#f5f53d,#f2a65a,#0af)}.health-card{background:linear-gradient(135deg,#ffffffe6,#f0fdf4f2);border:1px solid rgba(20,184,166,.2);box-shadow:0 4px 16px #14b8a61a,0 0 0 1px #14b8a60d}.dark .health-card{background:linear-gradient(135deg,#141e28e6,#0f2823f2);border:1px solid rgba(20,184,166,.3)}.vibrant-button{background:linear-gradient(135deg,#10b77f,#17cfcf,#0da6f2);border:none;color:#fff;transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden}.vibrant-button:before{content:\"\";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);transition:left .5s}.vibrant-button:hover:before{left:100%}.vibrant-button:hover{transform:translateY(-2px) scale(1.02);box-shadow:0 8px 25px #14b8a640,0 4px 15px #0096ff26}.success-accent{background:linear-gradient(135deg,#3c3,#28bd5a)}.warning-accent{background:linear-gradient(135deg,#fc3,#f6b355)}.info-accent{background:linear-gradient(135deg,#0af,#2b6cee)}@keyframes colorShift{0%{filter:hue-rotate(0deg)}25%{filter:hue-rotate(90deg)}50%{filter:hue-rotate(180deg)}75%{filter:hue-rotate(270deg)}to{filter:hue-rotate(360deg)}}@keyframes breathe{0%,to{transform:scale(1)}50%{transform:scale(1.05)}}.animate-color-shift{animation:colorShift 8s linear infinite}.animate-breathe{animation:breathe 3s ease-in-out infinite}@keyframes bulbFlicker{0%,20%{opacity:1;filter:brightness(1.2) saturate(1.1)}25%,30%{opacity:.3;filter:brightness(.7) saturate(.8)}35%,85%{opacity:1;filter:brightness(1.2) saturate(1.1)}90%,95%{opacity:.4;filter:brightness(.8) saturate(.9)}to{opacity:1;filter:brightness(1.2) saturate(1.1)}}.calorie-gradient{background:linear-gradient(45deg,#e05252,#eda65e,#f5f53d)}.protein-gradient{background:linear-gradient(45deg,#e05281,#e963bc)}.carbs-gradient{background:linear-gradient(45deg,#f0f042,#abe830)}.fat-gradient{background:linear-gradient(45deg,#b152e0,#8f63e9)}.file\\:border-0::file-selector-button{border-width:0px}.file\\:bg-transparent::file-selector-button{background-color:transparent}.file\\:text-sm::file-selector-button{font-size:.875rem;line-height:1.25rem}.file\\:font-medium::file-selector-button{font-weight:500}.file\\:text-foreground::file-selector-button{color:var(--foreground)}.placeholder\\:text-muted-foreground::-moz-placeholder{color:var(--muted-foreground)}.placeholder\\:text-muted-foreground::placeholder{color:var(--muted-foreground)}.after\\:absolute:after{content:var(--tw-content);position:absolute}.after\\:-inset-2:after{content:var(--tw-content);top:-.5rem;right:-.5rem;bottom:-.5rem;left:-.5rem}.after\\:inset-y-0:after{content:var(--tw-content);top:0;bottom:0}.after\\:left-1\\/2:after{content:var(--tw-content);left:50%}.after\\:w-1:after{content:var(--tw-content);width:.25rem}.after\\:w-\\[2px\\]:after{content:var(--tw-content);width:2px}.after\\:-translate-x-1\\/2:after{content:var(--tw-content);--tw-translate-x: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.first\\:rounded-l-md:first-child{border-top-left-radius:calc(var(--radius) - 2px);border-bottom-left-radius:calc(var(--radius) - 2px)}.first\\:border-l:first-child{border-left-width:1px}.last\\:rounded-r-md:last-child{border-top-right-radius:calc(var(--radius) - 2px);border-bottom-right-radius:calc(var(--radius) - 2px)}.focus-within\\:relative:focus-within{position:relative}.focus-within\\:z-20:focus-within{z-index:20}.hover\\:-rotate-1:hover{--tw-rotate: -1deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\\:rotate-1:hover{--tw-rotate: 1deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\\:scale-105:hover{--tw-scale-x: 1.05;--tw-scale-y: 1.05;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\\:scale-110:hover{--tw-scale-x: 1.1;--tw-scale-y: 1.1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\\:scale-\\[1\\.02\\]:hover{--tw-scale-x: 1.02;--tw-scale-y: 1.02;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes spin{to{transform:rotate(360deg)}}.hover\\:animate-spin:hover{animation:spin 1s linear infinite}.hover\\:border-blue-300:hover{--tw-border-opacity: 1;border-color:rgb(147 197 253 / var(--tw-border-opacity, 1))}.hover\\:border-blue-400:hover{--tw-border-opacity: 1;border-color:rgb(96 165 250 / var(--tw-border-opacity, 1))}.hover\\:border-emerald-300:hover{--tw-border-opacity: 1;border-color:rgb(110 231 183 / var(--tw-border-opacity, 1))}.hover\\:border-gray-300:hover{--tw-border-opacity: 1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1))}.hover\\:border-green-300:hover{--tw-border-opacity: 1;border-color:rgb(134 239 172 / var(--tw-border-opacity, 1))}.hover\\:border-indigo-300:hover{--tw-border-opacity: 1;border-color:rgb(165 180 252 / var(--tw-border-opacity, 1))}.hover\\:border-orange-300:hover{--tw-border-opacity: 1;border-color:rgb(253 186 116 / var(--tw-border-opacity, 1))}.hover\\:border-pink-300:hover{--tw-border-opacity: 1;border-color:rgb(249 168 212 / var(--tw-border-opacity, 1))}.hover\\:border-purple-300:hover{--tw-border-opacity: 1;border-color:rgb(216 180 254 / var(--tw-border-opacity, 1))}.hover\\:border-teal-300:hover{--tw-border-opacity: 1;border-color:rgb(94 234 212 / var(--tw-border-opacity, 1))}.hover\\:bg-accent:hover{background-color:var(--accent)}.hover\\:bg-background:hover{background-color:var(--background)}.hover\\:bg-blue-100:hover{--tw-bg-opacity: 1;background-color:rgb(219 234 254 / var(--tw-bg-opacity, 1))}.hover\\:bg-blue-200:hover{--tw-bg-opacity: 1;background-color:rgb(191 219 254 / var(--tw-bg-opacity, 1))}.hover\\:bg-blue-50:hover{--tw-bg-opacity: 1;background-color:rgb(239 246 255 / var(--tw-bg-opacity, 1))}.hover\\:bg-blue-500:hover{--tw-bg-opacity: 1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.hover\\:bg-blue-600:hover{--tw-bg-opacity: 1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1))}.hover\\:bg-blue-700:hover{--tw-bg-opacity: 1;background-color:rgb(29 78 216 / var(--tw-bg-opacity, 1))}.hover\\:bg-gray-100:hover{--tw-bg-opacity: 1;background-color:rgb(243 244 246 / var(--tw-bg-opacity, 1))}.hover\\:bg-gray-200:hover{--tw-bg-opacity: 1;background-color:rgb(229 231 235 / var(--tw-bg-opacity, 1))}.hover\\:bg-gray-50:hover{--tw-bg-opacity: 1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.hover\\:bg-green-100:hover{--tw-bg-opacity: 1;background-color:rgb(220 252 231 / var(--tw-bg-opacity, 1))}.hover\\:bg-green-50:hover{--tw-bg-opacity: 1;background-color:rgb(240 253 244 / var(--tw-bg-opacity, 1))}.hover\\:bg-green-500:hover{--tw-bg-opacity: 1;background-color:rgb(34 197 94 / var(--tw-bg-opacity, 1))}.hover\\:bg-green-700:hover{--tw-bg-opacity: 1;background-color:rgb(21 128 61 / var(--tw-bg-opacity, 1))}.hover\\:bg-muted:hover{background-color:var(--muted)}.hover\\:bg-orange-200:hover{--tw-bg-opacity: 1;background-color:rgb(254 215 170 / var(--tw-bg-opacity, 1))}.hover\\:bg-orange-600:hover{--tw-bg-opacity: 1;background-color:rgb(234 88 12 / var(--tw-bg-opacity, 1))}.hover\\:bg-orange-700:hover{--tw-bg-opacity: 1;background-color:rgb(194 65 12 / var(--tw-bg-opacity, 1))}.hover\\:bg-primary:hover{background-color:var(--primary)}.hover\\:bg-purple-200:hover{--tw-bg-opacity: 1;background-color:rgb(233 213 255 / var(--tw-bg-opacity, 1))}.hover\\:bg-purple-50:hover{--tw-bg-opacity: 1;background-color:rgb(250 245 255 / var(--tw-bg-opacity, 1))}.hover\\:bg-red-100:hover{--tw-bg-opacity: 1;background-color:rgb(254 226 226 / var(--tw-bg-opacity, 1))}.hover\\:bg-red-50:hover{--tw-bg-opacity: 1;background-color:rgb(254 242 242 / var(--tw-bg-opacity, 1))}.hover\\:bg-red-700:hover{--tw-bg-opacity: 1;background-color:rgb(185 28 28 / var(--tw-bg-opacity, 1))}.hover\\:bg-secondary:hover{background-color:var(--secondary)}.hover\\:bg-sidebar-accent:hover{background-color:var(--sidebar-accent)}.hover\\:bg-slate-600:hover{--tw-bg-opacity: 1;background-color:rgb(71 85 105 / var(--tw-bg-opacity, 1))}.hover\\:bg-slate-700:hover{--tw-bg-opacity: 1;background-color:rgb(51 65 85 / var(--tw-bg-opacity, 1))}.hover\\:bg-slate-700\\/80:hover{background-color:#334155cc}.hover\\:bg-slate-700\\/90:hover{background-color:#334155e6}.hover\\:bg-white:hover{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.hover\\:bg-white\\/10:hover{background-color:#ffffff1a}.hover\\:bg-white\\/20:hover{background-color:#fff3}.hover\\:bg-yellow-600:hover{--tw-bg-opacity: 1;background-color:rgb(202 138 4 / var(--tw-bg-opacity, 1))}.hover\\:from-amber-200:hover{--tw-gradient-from: #fde68a var(--tw-gradient-from-position);--tw-gradient-to: rgb(253 230 138 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-amber-500\\/90:hover{--tw-gradient-from: rgb(245 158 11 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(245 158 11 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-blue-200:hover{--tw-gradient-from: #bfdbfe var(--tw-gradient-from-position);--tw-gradient-to: rgb(191 219 254 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-blue-500\\/20:hover{--tw-gradient-from: rgb(59 130 246 / .2) var(--tw-gradient-from-position);--tw-gradient-to: rgb(59 130 246 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-blue-500\\/90:hover{--tw-gradient-from: rgb(59 130 246 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(59 130 246 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-blue-600:hover{--tw-gradient-from: #2563eb var(--tw-gradient-from-position);--tw-gradient-to: rgb(37 99 235 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-blue-700:hover{--tw-gradient-from: #1d4ed8 var(--tw-gradient-from-position);--tw-gradient-to: rgb(29 78 216 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-gray-200:hover{--tw-gradient-from: #e5e7eb var(--tw-gradient-from-position);--tw-gradient-to: rgb(229 231 235 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-gray-600:hover{--tw-gradient-from: #4b5563 var(--tw-gradient-from-position);--tw-gradient-to: rgb(75 85 99 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-green-200:hover{--tw-gradient-from: #bbf7d0 var(--tw-gradient-from-position);--tw-gradient-to: rgb(187 247 208 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-green-500\\/20:hover{--tw-gradient-from: rgb(34 197 94 / .2) var(--tw-gradient-from-position);--tw-gradient-to: rgb(34 197 94 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-green-600:hover{--tw-gradient-from: #16a34a var(--tw-gradient-from-position);--tw-gradient-to: rgb(22 163 74 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-green-700:hover{--tw-gradient-from: #15803d var(--tw-gradient-from-position);--tw-gradient-to: rgb(21 128 61 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-orange-600:hover{--tw-gradient-from: #ea580c var(--tw-gradient-from-position);--tw-gradient-to: rgb(234 88 12 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-pink-200:hover{--tw-gradient-from: #fbcfe8 var(--tw-gradient-from-position);--tw-gradient-to: rgb(251 207 232 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-purple-200:hover{--tw-gradient-from: #e9d5ff var(--tw-gradient-from-position);--tw-gradient-to: rgb(233 213 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-purple-500\\/20:hover{--tw-gradient-from: rgb(168 85 247 / .2) var(--tw-gradient-from-position);--tw-gradient-to: rgb(168 85 247 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-purple-500\\/90:hover{--tw-gradient-from: rgb(168 85 247 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(168 85 247 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-purple-600:hover{--tw-gradient-from: #9333ea var(--tw-gradient-from-position);--tw-gradient-to: rgb(147 51 234 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-purple-700:hover{--tw-gradient-from: #7e22ce var(--tw-gradient-from-position);--tw-gradient-to: rgb(126 34 206 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-red-200:hover{--tw-gradient-from: #fecaca var(--tw-gradient-from-position);--tw-gradient-to: rgb(254 202 202 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-red-200\\/70:hover{--tw-gradient-from: rgb(254 202 202 / .7) var(--tw-gradient-from-position);--tw-gradient-to: rgb(254 202 202 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-red-600:hover{--tw-gradient-from: #dc2626 var(--tw-gradient-from-position);--tw-gradient-to: rgb(220 38 38 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-slate-600\\/90:hover{--tw-gradient-from: rgb(71 85 105 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(71 85 105 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-yellow-200:hover{--tw-gradient-from: #fef08a var(--tw-gradient-from-position);--tw-gradient-to: rgb(254 240 138 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-yellow-500\\/90:hover{--tw-gradient-from: rgb(234 179 8 / .9) var(--tw-gradient-from-position);--tw-gradient-to: rgb(234 179 8 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:from-yellow-600:hover{--tw-gradient-from: #ca8a04 var(--tw-gradient-from-position);--tw-gradient-to: rgb(202 138 4 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\\:via-indigo-700:hover{--tw-gradient-to: rgb(67 56 202 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #4338ca var(--tw-gradient-via-position), var(--tw-gradient-to)}.hover\\:to-amber-200:hover{--tw-gradient-to: #fde68a var(--tw-gradient-to-position)}.hover\\:to-amber-500\\/90:hover{--tw-gradient-to: rgb(245 158 11 / .9) var(--tw-gradient-to-position)}.hover\\:to-blue-500\\/20:hover{--tw-gradient-to: rgb(59 130 246 / .2) var(--tw-gradient-to-position)}.hover\\:to-blue-700:hover{--tw-gradient-to: #1d4ed8 var(--tw-gradient-to-position)}.hover\\:to-cyan-200:hover{--tw-gradient-to: #a5f3fc var(--tw-gradient-to-position)}.hover\\:to-cyan-500\\/90:hover{--tw-gradient-to: rgb(6 182 212 / .9) var(--tw-gradient-to-position)}.hover\\:to-emerald-200:hover{--tw-gradient-to: #a7f3d0 var(--tw-gradient-to-position)}.hover\\:to-emerald-600:hover{--tw-gradient-to: #059669 var(--tw-gradient-to-position)}.hover\\:to-emerald-700:hover{--tw-gradient-to: #047857 var(--tw-gradient-to-position)}.hover\\:to-gray-300:hover{--tw-gradient-to: #d1d5db var(--tw-gradient-to-position)}.hover\\:to-gray-700:hover{--tw-gradient-to: #374151 var(--tw-gradient-to-position)}.hover\\:to-green-700:hover{--tw-gradient-to: #15803d var(--tw-gradient-to-position)}.hover\\:to-orange-200:hover{--tw-gradient-to: #fed7aa var(--tw-gradient-to-position)}.hover\\:to-orange-500\\/90:hover{--tw-gradient-to: rgb(249 115 22 / .9) var(--tw-gradient-to-position)}.hover\\:to-orange-600:hover{--tw-gradient-to: #ea580c var(--tw-gradient-to-position)}.hover\\:to-pink-200:hover{--tw-gradient-to: #fbcfe8 var(--tw-gradient-to-position)}.hover\\:to-pink-500\\/20:hover{--tw-gradient-to: rgb(236 72 153 / .2) var(--tw-gradient-to-position)}.hover\\:to-pink-500\\/90:hover{--tw-gradient-to: rgb(236 72 153 / .9) var(--tw-gradient-to-position)}.hover\\:to-pink-700:hover{--tw-gradient-to: #be185d var(--tw-gradient-to-position)}.hover\\:to-purple-500\\/20:hover{--tw-gradient-to: rgb(168 85 247 / .2) var(--tw-gradient-to-position)}.hover\\:to-purple-700:hover{--tw-gradient-to: #7e22ce var(--tw-gradient-to-position)}.hover\\:to-red-300\\/50:hover{--tw-gradient-to: rgb(252 165 165 / .5) var(--tw-gradient-to-position)}.hover\\:to-red-600:hover{--tw-gradient-to: #dc2626 var(--tw-gradient-to-position)}.hover\\:to-red-700:hover{--tw-gradient-to: #b91c1c var(--tw-gradient-to-position)}.hover\\:to-rose-200:hover{--tw-gradient-to: #fecdd3 var(--tw-gradient-to-position)}.hover\\:to-slate-700\\/90:hover{--tw-gradient-to: rgb(51 65 85 / .9) var(--tw-gradient-to-position)}.hover\\:text-accent-foreground:hover{color:var(--accent-foreground)}.hover\\:text-blue-600:hover{--tw-text-opacity: 1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.hover\\:text-blue-800:hover{--tw-text-opacity: 1;color:rgb(30 64 175 / var(--tw-text-opacity, 1))}.hover\\:text-destructive:hover{color:var(--destructive)}.hover\\:text-foreground:hover{color:var(--foreground)}.hover\\:text-gray-900:hover{--tw-text-opacity: 1;color:rgb(17 24 39 / var(--tw-text-opacity, 1))}.hover\\:text-muted-foreground:hover{color:var(--muted-foreground)}.hover\\:text-primary-foreground:hover{color:var(--primary-foreground)}.hover\\:text-purple-600:hover{--tw-text-opacity: 1;color:rgb(147 51 234 / var(--tw-text-opacity, 1))}.hover\\:text-red-600:hover{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.hover\\:text-sidebar-accent-foreground:hover{color:var(--sidebar-accent-foreground)}.hover\\:underline:hover{text-decoration-line:underline}.hover\\:opacity-100:hover{opacity:1}.hover\\:opacity-90:hover{opacity:.9}.hover\\:shadow-2xl:hover{--tw-shadow: 0 25px 50px -12px rgb(0 0 0 / .25);--tw-shadow-colored: 0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\\:shadow-\\[0_0_0_1px_hsl\\(var\\(--sidebar-accent\\)\\)\\]:hover{--tw-shadow: 0 0 0 1px hsl(var(--sidebar-accent));--tw-shadow-colored: 0 0 0 1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\\:shadow-lg:hover{--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\\:shadow-md:hover{--tw-shadow: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1);--tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\\:shadow-sm:hover{--tw-shadow: 0 1px 2px 0 rgb(0 0 0 / .05);--tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\\:shadow-xl:hover{--tw-shadow: 0 20px 25px -5px rgb(0 0 0 / .1), 0 8px 10px -6px rgb(0 0 0 / .1);--tw-shadow-colored: 0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\\:shadow-amber-500\\/25:hover{--tw-shadow-color: rgb(245 158 11 / .25);--tw-shadow: var(--tw-shadow-colored)}.hover\\:shadow-blue-500\\/25:hover{--tw-shadow-color: rgb(59 130 246 / .25);--tw-shadow: var(--tw-shadow-colored)}.hover\\:shadow-green-500\\/25:hover{--tw-shadow-color: rgb(34 197 94 / .25);--tw-shadow: var(--tw-shadow-colored)}.hover\\:shadow-indigo-500\\/25:hover{--tw-shadow-color: rgb(99 102 241 / .25);--tw-shadow: var(--tw-shadow-colored)}.hover\\:shadow-orange-500\\/25:hover{--tw-shadow-color: rgb(249 115 22 / .25);--tw-shadow: var(--tw-shadow-colored)}.hover\\:shadow-orange-500\\/40:hover{--tw-shadow-color: rgb(249 115 22 / .4);--tw-shadow: var(--tw-shadow-colored)}.hover\\:shadow-pink-500\\/25:hover{--tw-shadow-color: rgb(236 72 153 / .25);--tw-shadow: var(--tw-shadow-colored)}.hover\\:shadow-purple-500\\/25:hover{--tw-shadow-color: rgb(168 85 247 / .25);--tw-shadow: var(--tw-shadow-colored)}.hover\\:shadow-red-500\\/25:hover{--tw-shadow-color: rgb(239 68 68 / .25);--tw-shadow: var(--tw-shadow-colored)}.hover\\:shadow-slate-500\\/25:hover{--tw-shadow-color: rgb(100 116 139 / .25);--tw-shadow: var(--tw-shadow-colored)}.hover\\:shadow-yellow-500\\/25:hover{--tw-shadow-color: rgb(234 179 8 / .25);--tw-shadow: var(--tw-shadow-colored)}.hover\\:after\\:bg-sidebar-border:hover:after{content:var(--tw-content);background-color:var(--sidebar-border)}.focus\\:border-blue-500:focus{--tw-border-opacity: 1;border-color:rgb(59 130 246 / var(--tw-border-opacity, 1))}.focus\\:border-emerald-500:focus{--tw-border-opacity: 1;border-color:rgb(16 185 129 / var(--tw-border-opacity, 1))}.focus\\:border-green-500:focus{--tw-border-opacity: 1;border-color:rgb(34 197 94 / var(--tw-border-opacity, 1))}.focus\\:border-indigo-500:focus{--tw-border-opacity: 1;border-color:rgb(99 102 241 / var(--tw-border-opacity, 1))}.focus\\:border-orange-500:focus{--tw-border-opacity: 1;border-color:rgb(249 115 22 / var(--tw-border-opacity, 1))}.focus\\:border-pink-500:focus{--tw-border-opacity: 1;border-color:rgb(236 72 153 / var(--tw-border-opacity, 1))}.focus\\:border-primary:focus{border-color:var(--primary)}.focus\\:border-purple-500:focus{--tw-border-opacity: 1;border-color:rgb(168 85 247 / var(--tw-border-opacity, 1))}.focus\\:border-teal-500:focus{--tw-border-opacity: 1;border-color:rgb(20 184 166 / var(--tw-border-opacity, 1))}.focus\\:border-transparent:focus{border-color:transparent}.focus\\:bg-accent:focus{background-color:var(--accent)}.focus\\:bg-primary:focus{background-color:var(--primary)}.focus\\:bg-slate-700:focus{--tw-bg-opacity: 1;background-color:rgb(51 65 85 / var(--tw-bg-opacity, 1))}.focus\\:text-accent-foreground:focus{color:var(--accent-foreground)}.focus\\:text-primary-foreground:focus{color:var(--primary-foreground)}.focus\\:opacity-100:focus{opacity:1}.focus\\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.focus\\:ring-2:focus{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.focus\\:ring-blue-500:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(59 130 246 / var(--tw-ring-opacity, 1))}.focus\\:ring-primary:focus{--tw-ring-color: var(--primary)}.focus\\:ring-purple-500:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(168 85 247 / var(--tw-ring-opacity, 1))}.focus\\:ring-ring:focus{--tw-ring-color: var(--ring)}.focus\\:ring-offset-2:focus{--tw-ring-offset-width: 2px}.focus-visible\\:outline-none:focus-visible{outline:2px solid transparent;outline-offset:2px}.focus-visible\\:ring-1:focus-visible{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.focus-visible\\:ring-2:focus-visible{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.focus-visible\\:ring-ring:focus-visible{--tw-ring-color: var(--ring)}.focus-visible\\:ring-sidebar-ring:focus-visible{--tw-ring-color: var(--sidebar-ring)}.focus-visible\\:ring-offset-1:focus-visible{--tw-ring-offset-width: 1px}.focus-visible\\:ring-offset-2:focus-visible{--tw-ring-offset-width: 2px}.focus-visible\\:ring-offset-background:focus-visible{--tw-ring-offset-color: var(--background)}.active\\:scale-95:active{--tw-scale-x: .95;--tw-scale-y: .95;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.active\\:bg-sidebar-accent:active{background-color:var(--sidebar-accent)}.active\\:text-sidebar-accent-foreground:active{color:var(--sidebar-accent-foreground)}.disabled\\:pointer-events-none:disabled{pointer-events:none}.disabled\\:transform-none:disabled{transform:none}.disabled\\:cursor-not-allowed:disabled{cursor:not-allowed}.disabled\\:from-gray-400:disabled{--tw-gradient-from: #9ca3af var(--tw-gradient-from-position);--tw-gradient-to: rgb(156 163 175 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.disabled\\:to-gray-500:disabled{--tw-gradient-to: #6b7280 var(--tw-gradient-to-position)}.disabled\\:opacity-50:disabled{opacity:.5}.disabled\\:shadow-none:disabled{--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.group\\/menu-item:focus-within .group-focus-within\\/menu-item\\:opacity-100{opacity:1}.group:hover .group-hover\\:scale-110{--tw-scale-x: 1.1;--tw-scale-y: 1.1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes bounce{0%,to{transform:translateY(-25%);animation-timing-function:cubic-bezier(.8,0,1,1)}50%{transform:none;animation-timing-function:cubic-bezier(0,0,.2,1)}}.group:hover .group-hover\\:animate-bounce{animation:bounce 1s infinite}@keyframes pulse{50%{opacity:.5}}.group:hover .group-hover\\:animate-pulse{animation:pulse 2s cubic-bezier(.4,0,.6,1) infinite}.group:hover .group-hover\\:text-blue-600{--tw-text-opacity: 1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.group:hover .group-hover\\:text-green-600{--tw-text-opacity: 1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.group:hover .group-hover\\:text-indigo-600{--tw-text-opacity: 1;color:rgb(79 70 229 / var(--tw-text-opacity, 1))}.group:hover .group-hover\\:text-orange-600{--tw-text-opacity: 1;color:rgb(234 88 12 / var(--tw-text-opacity, 1))}.group:hover .group-hover\\:text-pink-600{--tw-text-opacity: 1;color:rgb(219 39 119 / var(--tw-text-opacity, 1))}.group:hover .group-hover\\:text-purple-600{--tw-text-opacity: 1;color:rgb(147 51 234 / var(--tw-text-opacity, 1))}.group:hover .group-hover\\:text-red-600{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.group:hover .group-hover\\:text-yellow-600{--tw-text-opacity: 1;color:rgb(202 138 4 / var(--tw-text-opacity, 1))}.group\\/menu-item:hover .group-hover\\/menu-item\\:opacity-100,.group:hover .group-hover\\:opacity-100{opacity:1}.group:hover .group-hover\\:shadow-lg{--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.group.destructive .group-\\[\\.destructive\\]\\:text-red-600{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.group.destructive .group-\\[\\.destructive\\]\\:hover\\:bg-destructive:hover{background-color:var(--destructive)}.group.destructive .group-\\[\\.destructive\\]\\:hover\\:text-destructive-foreground:hover{color:var(--destructive-foreground)}.group.destructive .group-\\[\\.destructive\\]\\:hover\\:text-red-800:hover{--tw-text-opacity: 1;color:rgb(153 27 27 / var(--tw-text-opacity, 1))}.group.destructive .group-\\[\\.destructive\\]\\:focus\\:ring-destructive:focus{--tw-ring-color: var(--destructive)}.group.destructive .group-\\[\\.destructive\\]\\:focus\\:ring-red-400:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(248 113 113 / var(--tw-ring-opacity, 1))}.peer\\/menu-button:hover~.peer-hover\\/menu-button\\:text-sidebar-accent-foreground{color:var(--sidebar-accent-foreground)}.peer:disabled~.peer-disabled\\:cursor-not-allowed{cursor:not-allowed}.peer:disabled~.peer-disabled\\:opacity-70{opacity:.7}.has-\\[\\[data-variant\\=inset\\]\\]\\:bg-sidebar:has([data-variant=inset]){background-color:var(--sidebar-background)}.has-\\[\\:disabled\\]\\:opacity-50:has(:disabled){opacity:.5}.group\\/menu-item:has([data-sidebar=menu-action]) .group-has-\\[\\[data-sidebar\\=menu-action\\]\\]\\/menu-item\\:pr-8{padding-right:2rem}.aria-disabled\\:pointer-events-none[aria-disabled=true]{pointer-events:none}.aria-disabled\\:opacity-50[aria-disabled=true]{opacity:.5}.aria-selected\\:bg-accent[aria-selected=true]{background-color:var(--accent)}.aria-selected\\:text-accent-foreground[aria-selected=true]{color:var(--accent-foreground)}.aria-selected\\:text-muted-foreground[aria-selected=true]{color:var(--muted-foreground)}.aria-selected\\:opacity-100[aria-selected=true]{opacity:1}.data-\\[disabled\\=true\\]\\:pointer-events-none[data-disabled=true],.data-\\[disabled\\]\\:pointer-events-none[data-disabled]{pointer-events:none}.data-\\[panel-group-direction\\=vertical\\]\\:h-px[data-panel-group-direction=vertical]{height:1px}.data-\\[panel-group-direction\\=vertical\\]\\:w-full[data-panel-group-direction=vertical]{width:100%}.data-\\[side\\=bottom\\]\\:translate-y-1[data-side=bottom]{--tw-translate-y: .25rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\\[side\\=left\\]\\:-translate-x-1[data-side=left]{--tw-translate-x: -.25rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\\[side\\=right\\]\\:translate-x-1[data-side=right]{--tw-translate-x: .25rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\\[side\\=top\\]\\:-translate-y-1[data-side=top]{--tw-translate-y: -.25rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\\[state\\=checked\\]\\:translate-x-5[data-state=checked]{--tw-translate-x: 1.25rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\\[state\\=unchecked\\]\\:translate-x-0[data-state=unchecked],.data-\\[swipe\\=cancel\\]\\:translate-x-0[data-swipe=cancel]{--tw-translate-x: 0px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\\[swipe\\=end\\]\\:translate-x-\\[var\\(--radix-toast-swipe-end-x\\)\\][data-swipe=end]{--tw-translate-x: var(--radix-toast-swipe-end-x);transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\\[swipe\\=move\\]\\:translate-x-\\[var\\(--radix-toast-swipe-move-x\\)\\][data-swipe=move]{--tw-translate-x: var(--radix-toast-swipe-move-x);transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes accordion-up{0%{height:var(--radix-accordion-content-height)}to{height:0}}.data-\\[state\\=closed\\]\\:animate-accordion-up[data-state=closed]{animation:accordion-up .2s ease-out}@keyframes accordion-down{0%{height:0}to{height:var(--radix-accordion-content-height)}}.data-\\[state\\=open\\]\\:animate-accordion-down[data-state=open]{animation:accordion-down .2s ease-out}.data-\\[panel-group-direction\\=vertical\\]\\:flex-col[data-panel-group-direction=vertical]{flex-direction:column}.data-\\[active\\=true\\]\\:bg-sidebar-accent[data-active=true]{background-color:var(--sidebar-accent)}.data-\\[selected\\=\\'true\\'\\]\\:bg-accent[data-selected=true]{background-color:var(--accent)}.data-\\[state\\=active\\]\\:bg-background[data-state=active]{background-color:var(--background)}.data-\\[state\\=checked\\]\\:bg-primary[data-state=checked]{background-color:var(--primary)}.data-\\[state\\=on\\]\\:bg-accent[data-state=on],.data-\\[state\\=open\\]\\:bg-accent[data-state=open]{background-color:var(--accent)}.data-\\[state\\=open\\]\\:bg-secondary[data-state=open]{background-color:var(--secondary)}.data-\\[state\\=selected\\]\\:bg-muted[data-state=selected]{background-color:var(--muted)}.data-\\[state\\=unchecked\\]\\:bg-input[data-state=unchecked]{background-color:var(--input)}.data-\\[state\\=active\\]\\:bg-gradient-to-r[data-state=active]{background-image:linear-gradient(to right,var(--tw-gradient-stops))}.data-\\[state\\=active\\]\\:from-blue-500[data-state=active]{--tw-gradient-from: #3b82f6 var(--tw-gradient-from-position);--tw-gradient-to: rgb(59 130 246 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.data-\\[state\\=active\\]\\:from-green-500[data-state=active]{--tw-gradient-from: #22c55e var(--tw-gradient-from-position);--tw-gradient-to: rgb(34 197 94 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.data-\\[state\\=active\\]\\:to-emerald-500[data-state=active]{--tw-gradient-to: #10b981 var(--tw-gradient-to-position)}.data-\\[state\\=active\\]\\:to-purple-500[data-state=active]{--tw-gradient-to: #a855f7 var(--tw-gradient-to-position)}.data-\\[active\\=true\\]\\:font-medium[data-active=true]{font-weight:500}.data-\\[active\\=true\\]\\:text-sidebar-accent-foreground[data-active=true]{color:var(--sidebar-accent-foreground)}.data-\\[placeholder\\]\\:text-muted-foreground[data-placeholder]{color:var(--muted-foreground)}.data-\\[selected\\=true\\]\\:text-accent-foreground[data-selected=true]{color:var(--accent-foreground)}.data-\\[state\\=active\\]\\:text-foreground[data-state=active]{color:var(--foreground)}.data-\\[state\\=active\\]\\:text-white[data-state=active]{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.data-\\[state\\=checked\\]\\:text-primary-foreground[data-state=checked]{color:var(--primary-foreground)}.data-\\[state\\=on\\]\\:text-accent-foreground[data-state=on],.data-\\[state\\=open\\]\\:text-accent-foreground[data-state=open]{color:var(--accent-foreground)}.data-\\[state\\=open\\]\\:text-muted-foreground[data-state=open]{color:var(--muted-foreground)}.data-\\[disabled\\=true\\]\\:opacity-50[data-disabled=true],.data-\\[disabled\\]\\:opacity-50[data-disabled]{opacity:.5}.data-\\[state\\=open\\]\\:opacity-100[data-state=open]{opacity:1}.data-\\[state\\=active\\]\\:shadow-lg[data-state=active]{--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.data-\\[state\\=active\\]\\:shadow-sm[data-state=active]{--tw-shadow: 0 1px 2px 0 rgb(0 0 0 / .05);--tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.data-\\[swipe\\=move\\]\\:transition-none[data-swipe=move]{transition-property:none}.data-\\[state\\=closed\\]\\:duration-300[data-state=closed]{transition-duration:.3s}.data-\\[state\\=open\\]\\:duration-500[data-state=open]{transition-duration:.5s}.data-\\[motion\\^\\=from-\\]\\:animate-in[data-motion^=from-],.data-\\[state\\=open\\]\\:animate-in[data-state=open],.data-\\[state\\=visible\\]\\:animate-in[data-state=visible]{animation-name:enter;animation-duration:.15s;--tw-enter-opacity: initial;--tw-enter-scale: initial;--tw-enter-rotate: initial;--tw-enter-translate-x: initial;--tw-enter-translate-y: initial}.data-\\[motion\\^\\=to-\\]\\:animate-out[data-motion^=to-],.data-\\[state\\=closed\\]\\:animate-out[data-state=closed],.data-\\[state\\=hidden\\]\\:animate-out[data-state=hidden],.data-\\[swipe\\=end\\]\\:animate-out[data-swipe=end]{animation-name:exit;animation-duration:.15s;--tw-exit-opacity: initial;--tw-exit-scale: initial;--tw-exit-rotate: initial;--tw-exit-translate-x: initial;--tw-exit-translate-y: initial}.data-\\[motion\\^\\=from-\\]\\:fade-in[data-motion^=from-]{--tw-enter-opacity: 0}.data-\\[motion\\^\\=to-\\]\\:fade-out[data-motion^=to-],.data-\\[state\\=closed\\]\\:fade-out-0[data-state=closed]{--tw-exit-opacity: 0}.data-\\[state\\=closed\\]\\:fade-out-80[data-state=closed]{--tw-exit-opacity: .8}.data-\\[state\\=hidden\\]\\:fade-out[data-state=hidden]{--tw-exit-opacity: 0}.data-\\[state\\=open\\]\\:fade-in-0[data-state=open],.data-\\[state\\=visible\\]\\:fade-in[data-state=visible]{--tw-enter-opacity: 0}.data-\\[state\\=closed\\]\\:zoom-out-95[data-state=closed]{--tw-exit-scale: .95}.data-\\[state\\=open\\]\\:zoom-in-90[data-state=open]{--tw-enter-scale: .9}.data-\\[state\\=open\\]\\:zoom-in-95[data-state=open]{--tw-enter-scale: .95}.data-\\[motion\\=from-end\\]\\:slide-in-from-right-52[data-motion=from-end]{--tw-enter-translate-x: 13rem}.data-\\[motion\\=from-start\\]\\:slide-in-from-left-52[data-motion=from-start]{--tw-enter-translate-x: -13rem}.data-\\[motion\\=to-end\\]\\:slide-out-to-right-52[data-motion=to-end]{--tw-exit-translate-x: 13rem}.data-\\[motion\\=to-start\\]\\:slide-out-to-left-52[data-motion=to-start]{--tw-exit-translate-x: -13rem}.data-\\[side\\=bottom\\]\\:slide-in-from-top-2[data-side=bottom]{--tw-enter-translate-y: -.5rem}.data-\\[side\\=left\\]\\:slide-in-from-right-2[data-side=left]{--tw-enter-translate-x: .5rem}.data-\\[side\\=right\\]\\:slide-in-from-left-2[data-side=right]{--tw-enter-translate-x: -.5rem}.data-\\[side\\=top\\]\\:slide-in-from-bottom-2[data-side=top]{--tw-enter-translate-y: .5rem}.data-\\[state\\=closed\\]\\:slide-out-to-bottom[data-state=closed]{--tw-exit-translate-y: 100%}.data-\\[state\\=closed\\]\\:slide-out-to-left[data-state=closed]{--tw-exit-translate-x: -100%}.data-\\[state\\=closed\\]\\:slide-out-to-left-1\\/2[data-state=closed]{--tw-exit-translate-x: -50%}.data-\\[state\\=closed\\]\\:slide-out-to-right[data-state=closed],.data-\\[state\\=closed\\]\\:slide-out-to-right-full[data-state=closed]{--tw-exit-translate-x: 100%}.data-\\[state\\=closed\\]\\:slide-out-to-top[data-state=closed]{--tw-exit-translate-y: -100%}.data-\\[state\\=closed\\]\\:slide-out-to-top-\\[48\\%\\][data-state=closed]{--tw-exit-translate-y: -48%}.data-\\[state\\=open\\]\\:slide-in-from-bottom[data-state=open]{--tw-enter-translate-y: 100%}.data-\\[state\\=open\\]\\:slide-in-from-left[data-state=open]{--tw-enter-translate-x: -100%}.data-\\[state\\=open\\]\\:slide-in-from-left-1\\/2[data-state=open]{--tw-enter-translate-x: -50%}.data-\\[state\\=open\\]\\:slide-in-from-right[data-state=open]{--tw-enter-translate-x: 100%}.data-\\[state\\=open\\]\\:slide-in-from-top[data-state=open]{--tw-enter-translate-y: -100%}.data-\\[state\\=open\\]\\:slide-in-from-top-\\[48\\%\\][data-state=open]{--tw-enter-translate-y: -48%}.data-\\[state\\=open\\]\\:slide-in-from-top-full[data-state=open]{--tw-enter-translate-y: -100%}.data-\\[state\\=closed\\]\\:duration-300[data-state=closed]{animation-duration:.3s}.data-\\[state\\=open\\]\\:duration-500[data-state=open]{animation-duration:.5s}.data-\\[panel-group-direction\\=vertical\\]\\:after\\:left-0[data-panel-group-direction=vertical]:after{content:var(--tw-content);left:0}.data-\\[panel-group-direction\\=vertical\\]\\:after\\:h-1[data-panel-group-direction=vertical]:after{content:var(--tw-content);height:.25rem}.data-\\[panel-group-direction\\=vertical\\]\\:after\\:w-full[data-panel-group-direction=vertical]:after{content:var(--tw-content);width:100%}.data-\\[panel-group-direction\\=vertical\\]\\:after\\:-translate-y-1\\/2[data-panel-group-direction=vertical]:after{content:var(--tw-content);--tw-translate-y: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\\[panel-group-direction\\=vertical\\]\\:after\\:translate-x-0[data-panel-group-direction=vertical]:after{content:var(--tw-content);--tw-translate-x: 0px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\\[state\\=open\\]\\:hover\\:bg-accent:hover[data-state=open]{background-color:var(--accent)}.data-\\[state\\=open\\]\\:hover\\:bg-sidebar-accent:hover[data-state=open]{background-color:var(--sidebar-accent)}.data-\\[state\\=open\\]\\:hover\\:text-sidebar-accent-foreground:hover[data-state=open]{color:var(--sidebar-accent-foreground)}.data-\\[state\\=open\\]\\:focus\\:bg-accent:focus[data-state=open]{background-color:var(--accent)}.group[data-collapsible=offcanvas] .group-data-\\[collapsible\\=offcanvas\\]\\:left-\\[calc\\(var\\(--sidebar-width\\)\\*-1\\)\\]{left:calc(var(--sidebar-width) * -1)}.group[data-collapsible=offcanvas] .group-data-\\[collapsible\\=offcanvas\\]\\:right-\\[calc\\(var\\(--sidebar-width\\)\\*-1\\)\\]{right:calc(var(--sidebar-width) * -1)}.group[data-side=left] .group-data-\\[side\\=left\\]\\:-right-4{right:-1rem}.group[data-side=right] .group-data-\\[side\\=right\\]\\:left-0{left:0}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:-mt-8{margin-top:-2rem}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:hidden{display:none}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:\\!size-8{width:2rem!important;height:2rem!important}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:w-\\[--sidebar-width-icon\\]{width:var(--sidebar-width-icon)}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:w-\\[calc\\(var\\(--sidebar-width-icon\\)_\\+_theme\\(spacing\\.4\\)\\)\\]{width:calc(var(--sidebar-width-icon) + 1rem)}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:w-\\[calc\\(var\\(--sidebar-width-icon\\)_\\+_theme\\(spacing\\.4\\)_\\+2px\\)\\]{width:calc(var(--sidebar-width-icon) + 1rem + 2px)}.group[data-collapsible=offcanvas] .group-data-\\[collapsible\\=offcanvas\\]\\:w-0{width:0px}.group[data-collapsible=offcanvas] .group-data-\\[collapsible\\=offcanvas\\]\\:translate-x-0{--tw-translate-x: 0px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.group[data-side=right] .group-data-\\[side\\=right\\]\\:rotate-180,.group[data-state=open] .group-data-\\[state\\=open\\]\\:rotate-180{--tw-rotate: 180deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:overflow-hidden{overflow:hidden}.group[data-variant=floating] .group-data-\\[variant\\=floating\\]\\:rounded-lg{border-radius:var(--radius)}.group[data-variant=floating] .group-data-\\[variant\\=floating\\]\\:border{border-width:1px}.group[data-side=left] .group-data-\\[side\\=left\\]\\:border-r{border-right-width:1px}.group[data-side=right] .group-data-\\[side\\=right\\]\\:border-l{border-left-width:1px}.group[data-variant=floating] .group-data-\\[variant\\=floating\\]\\:border-sidebar-border{border-color:var(--sidebar-border)}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:\\!p-0{padding:0!important}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:\\!p-2{padding:.5rem!important}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:opacity-0{opacity:0}.group[data-variant=floating] .group-data-\\[variant\\=floating\\]\\:shadow{--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.group[data-collapsible=offcanvas] .group-data-\\[collapsible\\=offcanvas\\]\\:after\\:left-full:after{content:var(--tw-content);left:100%}.group[data-collapsible=offcanvas] .group-data-\\[collapsible\\=offcanvas\\]\\:hover\\:bg-sidebar:hover{background-color:var(--sidebar-background)}.peer\\/menu-button[data-size=default]~.peer-data-\\[size\\=default\\]\\/menu-button\\:top-1\\.5{top:.375rem}.peer\\/menu-button[data-size=lg]~.peer-data-\\[size\\=lg\\]\\/menu-button\\:top-2\\.5{top:.625rem}.peer\\/menu-button[data-size=sm]~.peer-data-\\[size\\=sm\\]\\/menu-button\\:top-1{top:.25rem}.peer\\/menu-button[data-active=true]~.peer-data-\\[active\\=true\\]\\/menu-button\\:text-sidebar-accent-foreground{color:var(--sidebar-accent-foreground)}.dark\\:border-amber-800:is(.dark *){--tw-border-opacity: 1;border-color:rgb(146 64 14 / var(--tw-border-opacity, 1))}.dark\\:border-blue-600:is(.dark *){--tw-border-opacity: 1;border-color:rgb(37 99 235 / var(--tw-border-opacity, 1))}.dark\\:border-blue-700\\/30:is(.dark *){border-color:#1d4ed84d}.dark\\:border-blue-800:is(.dark *){--tw-border-opacity: 1;border-color:rgb(30 64 175 / var(--tw-border-opacity, 1))}.dark\\:border-blue-800\\/50:is(.dark *){border-color:#1e40af80}.dark\\:border-gray-600:is(.dark *){--tw-border-opacity: 1;border-color:rgb(75 85 99 / var(--tw-border-opacity, 1))}.dark\\:border-gray-600\\/30:is(.dark *){border-color:#4b55634d}.dark\\:border-gray-700:is(.dark *){--tw-border-opacity: 1;border-color:rgb(55 65 81 / var(--tw-border-opacity, 1))}.dark\\:border-gray-700\\/30:is(.dark *){border-color:#3741514d}.dark\\:border-gray-700\\/50:is(.dark *){border-color:#37415180}.dark\\:border-gray-800:is(.dark *){--tw-border-opacity: 1;border-color:rgb(31 41 55 / var(--tw-border-opacity, 1))}.dark\\:border-green-800:is(.dark *){--tw-border-opacity: 1;border-color:rgb(22 101 52 / var(--tw-border-opacity, 1))}.dark\\:border-indigo-800:is(.dark *){--tw-border-opacity: 1;border-color:rgb(55 48 163 / var(--tw-border-opacity, 1))}.dark\\:border-orange-700:is(.dark *){--tw-border-opacity: 1;border-color:rgb(194 65 12 / var(--tw-border-opacity, 1))}.dark\\:border-orange-700\\/50:is(.dark *){border-color:#c2410c80}.dark\\:border-orange-800:is(.dark *){--tw-border-opacity: 1;border-color:rgb(154 52 18 / var(--tw-border-opacity, 1))}.dark\\:border-orange-800\\/50:is(.dark *){border-color:#9a341280}.dark\\:border-pink-800:is(.dark *){--tw-border-opacity: 1;border-color:rgb(157 23 77 / var(--tw-border-opacity, 1))}.dark\\:border-purple-700:is(.dark *){--tw-border-opacity: 1;border-color:rgb(126 34 206 / var(--tw-border-opacity, 1))}.dark\\:border-purple-700\\/30:is(.dark *){border-color:#7e22ce4d}.dark\\:border-purple-800:is(.dark *){--tw-border-opacity: 1;border-color:rgb(107 33 168 / var(--tw-border-opacity, 1))}.dark\\:border-red-700:is(.dark *){--tw-border-opacity: 1;border-color:rgb(185 28 28 / var(--tw-border-opacity, 1))}.dark\\:border-red-700\\/20:is(.dark *){border-color:#b91c1c33}.dark\\:border-red-800:is(.dark *){--tw-border-opacity: 1;border-color:rgb(153 27 27 / var(--tw-border-opacity, 1))}.dark\\:border-red-900:is(.dark *){--tw-border-opacity: 1;border-color:rgb(127 29 29 / var(--tw-border-opacity, 1))}.dark\\:border-slate-700:is(.dark *){--tw-border-opacity: 1;border-color:rgb(51 65 85 / var(--tw-border-opacity, 1))}.dark\\:border-slate-800:is(.dark *){--tw-border-opacity: 1;border-color:rgb(30 41 59 / var(--tw-border-opacity, 1))}.dark\\:border-yellow-700:is(.dark *){--tw-border-opacity: 1;border-color:rgb(161 98 7 / var(--tw-border-opacity, 1))}.dark\\:border-yellow-800:is(.dark *){--tw-border-opacity: 1;border-color:rgb(133 77 14 / var(--tw-border-opacity, 1))}.dark\\:bg-amber-900\\/20:is(.dark *){background-color:#78350f33}.dark\\:bg-amber-950:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(69 26 3 / var(--tw-bg-opacity, 1))}.dark\\:bg-black\\/10:is(.dark *){background-color:#0000001a}.dark\\:bg-black\\/20:is(.dark *){background-color:#0003}.dark\\:bg-blue-800\\/20:is(.dark *){background-color:#1e40af33}.dark\\:bg-blue-900:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(30 58 138 / var(--tw-bg-opacity, 1))}.dark\\:bg-blue-900\\/20:is(.dark *){background-color:#1e3a8a33}.dark\\:bg-blue-900\\/30:is(.dark *){background-color:#1e3a8a4d}.dark\\:bg-blue-950:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(23 37 84 / var(--tw-bg-opacity, 1))}.dark\\:bg-blue-950\\/20:is(.dark *){background-color:#17255433}.dark\\:bg-blue-950\\/30:is(.dark *){background-color:#1725544d}.dark\\:bg-blue-950\\/50:is(.dark *){background-color:#17255480}.dark\\:bg-emerald-900\\/30:is(.dark *){background-color:#064e3b4d}.dark\\:bg-gray-100:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(243 244 246 / var(--tw-bg-opacity, 1))}.dark\\:bg-gray-700:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1))}.dark\\:bg-gray-800:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(31 41 55 / var(--tw-bg-opacity, 1))}.dark\\:bg-gray-800\\/50:is(.dark *){background-color:#1f293780}.dark\\:bg-gray-800\\/60:is(.dark *){background-color:#1f293799}.dark\\:bg-gray-800\\/90:is(.dark *){background-color:#1f2937e6}.dark\\:bg-gray-900:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(17 24 39 / var(--tw-bg-opacity, 1))}.dark\\:bg-gray-900\\/95:is(.dark *){background-color:#111827f2}.dark\\:bg-green-900:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(20 83 45 / var(--tw-bg-opacity, 1))}.dark\\:bg-green-900\\/20:is(.dark *){background-color:#14532d33}.dark\\:bg-green-900\\/30:is(.dark *){background-color:#14532d4d}.dark\\:bg-green-950\\/20:is(.dark *){background-color:#052e1633}.dark\\:bg-indigo-900:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(49 46 129 / var(--tw-bg-opacity, 1))}.dark\\:bg-indigo-900\\/30:is(.dark *){background-color:#312e814d}.dark\\:bg-orange-800\\/20:is(.dark *){background-color:#9a341233}.dark\\:bg-orange-900:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(124 45 18 / var(--tw-bg-opacity, 1))}.dark\\:bg-orange-900\\/20:is(.dark *){background-color:#7c2d1233}.dark\\:bg-orange-900\\/30:is(.dark *){background-color:#7c2d124d}.dark\\:bg-orange-950\\/30:is(.dark *){background-color:#4314074d}.dark\\:bg-pink-900:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(131 24 67 / var(--tw-bg-opacity, 1))}.dark\\:bg-purple-900:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(88 28 135 / var(--tw-bg-opacity, 1))}.dark\\:bg-purple-900\\/30:is(.dark *){background-color:#581c874d}.dark\\:bg-red-800\\/20:is(.dark *){background-color:#991b1b33}.dark\\:bg-red-900:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(127 29 29 / var(--tw-bg-opacity, 1))}.dark\\:bg-red-900\\/20:is(.dark *){background-color:#7f1d1d33}.dark\\:bg-red-900\\/30:is(.dark *){background-color:#7f1d1d4d}.dark\\:bg-red-950\\/50:is(.dark *){background-color:#450a0a80}.dark\\:bg-slate-900:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(15 23 42 / var(--tw-bg-opacity, 1))}.dark\\:bg-teal-900\\/30:is(.dark *){background-color:#134e4a4d}.dark\\:bg-yellow-800\\/20:is(.dark *){background-color:#854d0e33}.dark\\:bg-yellow-900:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(113 63 18 / var(--tw-bg-opacity, 1))}.dark\\:bg-yellow-900\\/20:is(.dark *){background-color:#713f1233}.dark\\:bg-yellow-900\\/30:is(.dark *){background-color:#713f124d}.dark\\:from-amber-900\\/30:is(.dark *){--tw-gradient-from: rgb(120 53 15 / .3) var(--tw-gradient-from-position);--tw-gradient-to: rgb(120 53 15 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-amber-950\\/50:is(.dark *){--tw-gradient-from: rgb(69 26 3 / .5) var(--tw-gradient-from-position);--tw-gradient-to: rgb(69 26 3 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-blue-400:is(.dark *){--tw-gradient-from: #60a5fa var(--tw-gradient-from-position);--tw-gradient-to: rgb(96 165 250 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-blue-900:is(.dark *){--tw-gradient-from: #1e3a8a var(--tw-gradient-from-position);--tw-gradient-to: rgb(30 58 138 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-blue-900\\/10:is(.dark *){--tw-gradient-from: rgb(30 58 138 / .1) var(--tw-gradient-from-position);--tw-gradient-to: rgb(30 58 138 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-blue-900\\/20:is(.dark *){--tw-gradient-from: rgb(30 58 138 / .2) var(--tw-gradient-from-position);--tw-gradient-to: rgb(30 58 138 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-blue-900\\/30:is(.dark *){--tw-gradient-from: rgb(30 58 138 / .3) var(--tw-gradient-from-position);--tw-gradient-to: rgb(30 58 138 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-blue-900\\/40:is(.dark *){--tw-gradient-from: rgb(30 58 138 / .4) var(--tw-gradient-from-position);--tw-gradient-to: rgb(30 58 138 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-blue-950:is(.dark *){--tw-gradient-from: #172554 var(--tw-gradient-from-position);--tw-gradient-to: rgb(23 37 84 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-blue-950\\/30:is(.dark *){--tw-gradient-from: rgb(23 37 84 / .3) var(--tw-gradient-from-position);--tw-gradient-to: rgb(23 37 84 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-blue-950\\/50:is(.dark *){--tw-gradient-from: rgb(23 37 84 / .5) var(--tw-gradient-from-position);--tw-gradient-to: rgb(23 37 84 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-gray-700:is(.dark *){--tw-gradient-from: #374151 var(--tw-gradient-from-position);--tw-gradient-to: rgb(55 65 81 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-gray-800:is(.dark *){--tw-gradient-from: #1f2937 var(--tw-gradient-from-position);--tw-gradient-to: rgb(31 41 55 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-gray-800\\/50:is(.dark *){--tw-gradient-from: rgb(31 41 55 / .5) var(--tw-gradient-from-position);--tw-gradient-to: rgb(31 41 55 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-gray-900:is(.dark *){--tw-gradient-from: #111827 var(--tw-gradient-from-position);--tw-gradient-to: rgb(17 24 39 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-green-900:is(.dark *){--tw-gradient-from: #14532d var(--tw-gradient-from-position);--tw-gradient-to: rgb(20 83 45 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-green-900\\/30:is(.dark *){--tw-gradient-from: rgb(20 83 45 / .3) var(--tw-gradient-from-position);--tw-gradient-to: rgb(20 83 45 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-green-900\\/40:is(.dark *){--tw-gradient-from: rgb(20 83 45 / .4) var(--tw-gradient-from-position);--tw-gradient-to: rgb(20 83 45 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-green-950:is(.dark *){--tw-gradient-from: #052e16 var(--tw-gradient-from-position);--tw-gradient-to: rgb(5 46 22 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-green-950\\/30:is(.dark *){--tw-gradient-from: rgb(5 46 22 / .3) var(--tw-gradient-from-position);--tw-gradient-to: rgb(5 46 22 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-orange-900\\/10:is(.dark *){--tw-gradient-from: rgb(124 45 18 / .1) var(--tw-gradient-from-position);--tw-gradient-to: rgb(124 45 18 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-orange-900\\/40:is(.dark *){--tw-gradient-from: rgb(124 45 18 / .4) var(--tw-gradient-from-position);--tw-gradient-to: rgb(124 45 18 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-pink-900\\/40:is(.dark *){--tw-gradient-from: rgb(131 24 67 / .4) var(--tw-gradient-from-position);--tw-gradient-to: rgb(131 24 67 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-purple-400:is(.dark *){--tw-gradient-from: #c084fc var(--tw-gradient-from-position);--tw-gradient-to: rgb(192 132 252 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-purple-900:is(.dark *){--tw-gradient-from: #581c87 var(--tw-gradient-from-position);--tw-gradient-to: rgb(88 28 135 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-purple-900\\/30:is(.dark *){--tw-gradient-from: rgb(88 28 135 / .3) var(--tw-gradient-from-position);--tw-gradient-to: rgb(88 28 135 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-purple-900\\/40:is(.dark *){--tw-gradient-from: rgb(88 28 135 / .4) var(--tw-gradient-from-position);--tw-gradient-to: rgb(88 28 135 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-purple-950\\/30:is(.dark *){--tw-gradient-from: rgb(59 7 100 / .3) var(--tw-gradient-from-position);--tw-gradient-to: rgb(59 7 100 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-red-900\\/10:is(.dark *){--tw-gradient-from: rgb(127 29 29 / .1) var(--tw-gradient-from-position);--tw-gradient-to: rgb(127 29 29 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-red-900\\/20:is(.dark *){--tw-gradient-from: rgb(127 29 29 / .2) var(--tw-gradient-from-position);--tw-gradient-to: rgb(127 29 29 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-red-900\\/30:is(.dark *){--tw-gradient-from: rgb(127 29 29 / .3) var(--tw-gradient-from-position);--tw-gradient-to: rgb(127 29 29 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-red-900\\/40:is(.dark *){--tw-gradient-from: rgb(127 29 29 / .4) var(--tw-gradient-from-position);--tw-gradient-to: rgb(127 29 29 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-slate-950\\/50:is(.dark *){--tw-gradient-from: rgb(2 6 23 / .5) var(--tw-gradient-from-position);--tw-gradient-to: rgb(2 6 23 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-yellow-900:is(.dark *){--tw-gradient-from: #713f12 var(--tw-gradient-from-position);--tw-gradient-to: rgb(113 63 18 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-yellow-900\\/10:is(.dark *){--tw-gradient-from: rgb(113 63 18 / .1) var(--tw-gradient-from-position);--tw-gradient-to: rgb(113 63 18 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:from-yellow-900\\/40:is(.dark *){--tw-gradient-from: rgb(113 63 18 / .4) var(--tw-gradient-from-position);--tw-gradient-to: rgb(113 63 18 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:via-emerald-950\\/30:is(.dark *){--tw-gradient-to: rgb(2 44 34 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(2 44 34 / .3) var(--tw-gradient-via-position), var(--tw-gradient-to)}.dark\\:via-gray-800:is(.dark *){--tw-gradient-to: rgb(31 41 55 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), #1f2937 var(--tw-gradient-via-position), var(--tw-gradient-to)}.dark\\:via-indigo-900\\/20:is(.dark *){--tw-gradient-to: rgb(49 46 129 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(49 46 129 / .2) var(--tw-gradient-via-position), var(--tw-gradient-to)}.dark\\:via-indigo-950\\/30:is(.dark *){--tw-gradient-to: rgb(30 27 75 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(30 27 75 / .3) var(--tw-gradient-via-position), var(--tw-gradient-to)}.dark\\:via-orange-900\\/20:is(.dark *){--tw-gradient-to: rgb(124 45 18 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), rgb(124 45 18 / .2) var(--tw-gradient-via-position), var(--tw-gradient-to)}.dark\\:to-amber-900\\/10:is(.dark *){--tw-gradient-to: rgb(120 53 15 / .1) var(--tw-gradient-to-position)}.dark\\:to-amber-900\\/40:is(.dark *){--tw-gradient-to: rgb(120 53 15 / .4) var(--tw-gradient-to-position)}.dark\\:to-blue-800\\/30:is(.dark *){--tw-gradient-to: rgb(30 64 175 / .3) var(--tw-gradient-to-position)}.dark\\:to-blue-900:is(.dark *){--tw-gradient-to: #1e3a8a var(--tw-gradient-to-position)}.dark\\:to-blue-900\\/20:is(.dark *){--tw-gradient-to: rgb(30 58 138 / .2) var(--tw-gradient-to-position)}.dark\\:to-blue-950\\/50:is(.dark *){--tw-gradient-to: rgb(23 37 84 / .5) var(--tw-gradient-to-position)}.dark\\:to-cyan-900\\/30:is(.dark *){--tw-gradient-to: rgb(22 78 99 / .3) var(--tw-gradient-to-position)}.dark\\:to-cyan-950:is(.dark *){--tw-gradient-to: #083344 var(--tw-gradient-to-position)}.dark\\:to-cyan-950\\/50:is(.dark *){--tw-gradient-to: rgb(8 51 68 / .5) var(--tw-gradient-to-position)}.dark\\:to-emerald-900\\/30:is(.dark *){--tw-gradient-to: rgb(6 78 59 / .3) var(--tw-gradient-to-position)}.dark\\:to-emerald-950:is(.dark *){--tw-gradient-to: #022c22 var(--tw-gradient-to-position)}.dark\\:to-gray-600:is(.dark *){--tw-gradient-to: #4b5563 var(--tw-gradient-to-position)}.dark\\:to-gray-700:is(.dark *){--tw-gradient-to: #374151 var(--tw-gradient-to-position)}.dark\\:to-gray-700\\/30:is(.dark *){--tw-gradient-to: rgb(55 65 81 / .3) var(--tw-gradient-to-position)}.dark\\:to-gray-700\\/50:is(.dark *){--tw-gradient-to: rgb(55 65 81 / .5) var(--tw-gradient-to-position)}.dark\\:to-gray-950\\/50:is(.dark *){--tw-gradient-to: rgb(3 7 18 / .5) var(--tw-gradient-to-position)}.dark\\:to-green-800\\/30:is(.dark *){--tw-gradient-to: rgb(22 101 52 / .3) var(--tw-gradient-to-position)}.dark\\:to-green-900\\/20:is(.dark *){--tw-gradient-to: rgb(20 83 45 / .2) var(--tw-gradient-to-position)}.dark\\:to-indigo-900\\/10:is(.dark *){--tw-gradient-to: rgb(49 46 129 / .1) var(--tw-gradient-to-position)}.dark\\:to-indigo-950\\/30:is(.dark *){--tw-gradient-to: rgb(30 27 75 / .3) var(--tw-gradient-to-position)}.dark\\:to-orange-800\\/30:is(.dark *){--tw-gradient-to: rgb(154 52 18 / .3) var(--tw-gradient-to-position)}.dark\\:to-orange-900:is(.dark *){--tw-gradient-to: #7c2d12 var(--tw-gradient-to-position)}.dark\\:to-orange-900\\/10:is(.dark *){--tw-gradient-to: rgb(124 45 18 / .1) var(--tw-gradient-to-position)}.dark\\:to-orange-900\\/30:is(.dark *){--tw-gradient-to: rgb(124 45 18 / .3) var(--tw-gradient-to-position)}.dark\\:to-orange-950\\/50:is(.dark *){--tw-gradient-to: rgb(67 20 7 / .5) var(--tw-gradient-to-position)}.dark\\:to-pink-400:is(.dark *){--tw-gradient-to: #f472b6 var(--tw-gradient-to-position)}.dark\\:to-pink-900:is(.dark *){--tw-gradient-to: #831843 var(--tw-gradient-to-position)}.dark\\:to-pink-900\\/30:is(.dark *){--tw-gradient-to: rgb(131 24 67 / .3) var(--tw-gradient-to-position)}.dark\\:to-pink-900\\/40:is(.dark *){--tw-gradient-to: rgb(131 24 67 / .4) var(--tw-gradient-to-position)}.dark\\:to-pink-950\\/30:is(.dark *){--tw-gradient-to: rgb(80 7 36 / .3) var(--tw-gradient-to-position)}.dark\\:to-purple-400:is(.dark *){--tw-gradient-to: #c084fc var(--tw-gradient-to-position)}.dark\\:to-purple-800\\/30:is(.dark *){--tw-gradient-to: rgb(107 33 168 / .3) var(--tw-gradient-to-position)}.dark\\:to-purple-900:is(.dark *){--tw-gradient-to: #581c87 var(--tw-gradient-to-position)}.dark\\:to-purple-950\\/30:is(.dark *){--tw-gradient-to: rgb(59 7 100 / .3) var(--tw-gradient-to-position)}.dark\\:to-red-800\\/10:is(.dark *){--tw-gradient-to: rgb(153 27 27 / .1) var(--tw-gradient-to-position)}.dark\\:to-red-900\\/20:is(.dark *){--tw-gradient-to: rgb(127 29 29 / .2) var(--tw-gradient-to-position)}.dark\\:to-rose-900\\/40:is(.dark *){--tw-gradient-to: rgb(136 19 55 / .4) var(--tw-gradient-to-position)}.dark\\:to-slate-800\\/50:is(.dark *){--tw-gradient-to: rgb(30 41 59 / .5) var(--tw-gradient-to-position)}.dark\\:to-teal-950\\/30:is(.dark *){--tw-gradient-to: rgb(4 47 46 / .3) var(--tw-gradient-to-position)}.dark\\:text-amber-300:is(.dark *){--tw-text-opacity: 1;color:rgb(252 211 77 / var(--tw-text-opacity, 1))}.dark\\:text-amber-400:is(.dark *){--tw-text-opacity: 1;color:rgb(251 191 36 / var(--tw-text-opacity, 1))}.dark\\:text-blue-100:is(.dark *){--tw-text-opacity: 1;color:rgb(219 234 254 / var(--tw-text-opacity, 1))}.dark\\:text-blue-200:is(.dark *){--tw-text-opacity: 1;color:rgb(191 219 254 / var(--tw-text-opacity, 1))}.dark\\:text-blue-300:is(.dark *){--tw-text-opacity: 1;color:rgb(147 197 253 / var(--tw-text-opacity, 1))}.dark\\:text-blue-400:is(.dark *){--tw-text-opacity: 1;color:rgb(96 165 250 / var(--tw-text-opacity, 1))}.dark\\:text-blue-400\\/70:is(.dark *){color:#60a5fab3}.dark\\:text-blue-400\\/80:is(.dark *){color:#60a5facc}.dark\\:text-emerald-400:is(.dark *){--tw-text-opacity: 1;color:rgb(52 211 153 / var(--tw-text-opacity, 1))}.dark\\:text-gray-100:is(.dark *){--tw-text-opacity: 1;color:rgb(243 244 246 / var(--tw-text-opacity, 1))}.dark\\:text-gray-200:is(.dark *){--tw-text-opacity: 1;color:rgb(229 231 235 / var(--tw-text-opacity, 1))}.dark\\:text-gray-300:is(.dark *){--tw-text-opacity: 1;color:rgb(209 213 219 / var(--tw-text-opacity, 1))}.dark\\:text-gray-400:is(.dark *){--tw-text-opacity: 1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.dark\\:text-gray-900:is(.dark *){--tw-text-opacity: 1;color:rgb(17 24 39 / var(--tw-text-opacity, 1))}.dark\\:text-green-100:is(.dark *){--tw-text-opacity: 1;color:rgb(220 252 231 / var(--tw-text-opacity, 1))}.dark\\:text-green-200:is(.dark *){--tw-text-opacity: 1;color:rgb(187 247 208 / var(--tw-text-opacity, 1))}.dark\\:text-green-300:is(.dark *){--tw-text-opacity: 1;color:rgb(134 239 172 / var(--tw-text-opacity, 1))}.dark\\:text-green-400:is(.dark *){--tw-text-opacity: 1;color:rgb(74 222 128 / var(--tw-text-opacity, 1))}.dark\\:text-green-400\\/70:is(.dark *){color:#4ade80b3}.dark\\:text-green-400\\/80:is(.dark *){color:#4ade80cc}.dark\\:text-indigo-400:is(.dark *){--tw-text-opacity: 1;color:rgb(129 140 248 / var(--tw-text-opacity, 1))}.dark\\:text-orange-100:is(.dark *){--tw-text-opacity: 1;color:rgb(255 237 213 / var(--tw-text-opacity, 1))}.dark\\:text-orange-200:is(.dark *){--tw-text-opacity: 1;color:rgb(254 215 170 / var(--tw-text-opacity, 1))}.dark\\:text-orange-300:is(.dark *){--tw-text-opacity: 1;color:rgb(253 186 116 / var(--tw-text-opacity, 1))}.dark\\:text-orange-400:is(.dark *){--tw-text-opacity: 1;color:rgb(251 146 60 / var(--tw-text-opacity, 1))}.dark\\:text-orange-400\\/70:is(.dark *){color:#fb923cb3}.dark\\:text-orange-400\\/80:is(.dark *){color:#fb923ccc}.dark\\:text-pink-300:is(.dark *){--tw-text-opacity: 1;color:rgb(249 168 212 / var(--tw-text-opacity, 1))}.dark\\:text-pink-400:is(.dark *){--tw-text-opacity: 1;color:rgb(244 114 182 / var(--tw-text-opacity, 1))}.dark\\:text-purple-200:is(.dark *){--tw-text-opacity: 1;color:rgb(233 213 255 / var(--tw-text-opacity, 1))}.dark\\:text-purple-300:is(.dark *){--tw-text-opacity: 1;color:rgb(216 180 254 / var(--tw-text-opacity, 1))}.dark\\:text-purple-400:is(.dark *){--tw-text-opacity: 1;color:rgb(192 132 252 / var(--tw-text-opacity, 1))}.dark\\:text-purple-400\\/80:is(.dark *){color:#c084fccc}.dark\\:text-red-100:is(.dark *){--tw-text-opacity: 1;color:rgb(254 226 226 / var(--tw-text-opacity, 1))}.dark\\:text-red-300:is(.dark *){--tw-text-opacity: 1;color:rgb(252 165 165 / var(--tw-text-opacity, 1))}.dark\\:text-red-400:is(.dark *){--tw-text-opacity: 1;color:rgb(248 113 113 / var(--tw-text-opacity, 1))}.dark\\:text-red-400\\/70:is(.dark *){color:#f87171b3}.dark\\:text-slate-300:is(.dark *){--tw-text-opacity: 1;color:rgb(203 213 225 / var(--tw-text-opacity, 1))}.dark\\:text-teal-400:is(.dark *){--tw-text-opacity: 1;color:rgb(45 212 191 / var(--tw-text-opacity, 1))}.dark\\:text-white:is(.dark *){--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.dark\\:text-yellow-200:is(.dark *){--tw-text-opacity: 1;color:rgb(254 240 138 / var(--tw-text-opacity, 1))}.dark\\:text-yellow-300:is(.dark *){--tw-text-opacity: 1;color:rgb(253 224 71 / var(--tw-text-opacity, 1))}.dark\\:text-yellow-400:is(.dark *){--tw-text-opacity: 1;color:rgb(250 204 21 / var(--tw-text-opacity, 1))}.dark\\:text-yellow-400\\/70:is(.dark *){color:#facc15b3}.dark\\:hover\\:border-gray-500:hover:is(.dark *){--tw-border-opacity: 1;border-color:rgb(107 114 128 / var(--tw-border-opacity, 1))}.dark\\:hover\\:bg-blue-900\\/20:hover:is(.dark *){background-color:#1e3a8a33}.dark\\:hover\\:bg-blue-900\\/50:hover:is(.dark *){background-color:#1e3a8a80}.dark\\:hover\\:bg-blue-950:hover:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(23 37 84 / var(--tw-bg-opacity, 1))}.dark\\:hover\\:bg-blue-950\\/30:hover:is(.dark *){background-color:#1725544d}.dark\\:hover\\:bg-gray-600:hover:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(75 85 99 / var(--tw-bg-opacity, 1))}.dark\\:hover\\:bg-gray-700:hover:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1))}.dark\\:hover\\:bg-gray-800:hover:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(31 41 55 / var(--tw-bg-opacity, 1))}.dark\\:hover\\:bg-green-950:hover:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(5 46 22 / var(--tw-bg-opacity, 1))}.dark\\:hover\\:bg-orange-900\\/50:hover:is(.dark *){background-color:#7c2d1280}.dark\\:hover\\:bg-purple-900\\/20:hover:is(.dark *){background-color:#581c8733}.dark\\:hover\\:bg-purple-900\\/50:hover:is(.dark *){background-color:#581c8780}.dark\\:hover\\:bg-red-900\\/20:hover:is(.dark *){background-color:#7f1d1d33}.dark\\:hover\\:bg-red-900\\/30:hover:is(.dark *){background-color:#7f1d1d4d}.dark\\:hover\\:from-gray-600:hover:is(.dark *){--tw-gradient-from: #4b5563 var(--tw-gradient-from-position);--tw-gradient-to: rgb(75 85 99 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.dark\\:hover\\:to-gray-500:hover:is(.dark *){--tw-gradient-to: #6b7280 var(--tw-gradient-to-position)}.dark\\:hover\\:text-blue-300:hover:is(.dark *){--tw-text-opacity: 1;color:rgb(147 197 253 / var(--tw-text-opacity, 1))}.dark\\:hover\\:text-white:hover:is(.dark *){--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.group.destructive .dark\\:group-\\[\\.destructive\\]\\:text-red-400:is(.dark *){--tw-text-opacity: 1;color:rgb(248 113 113 / var(--tw-text-opacity, 1))}.group.destructive .dark\\:group-\\[\\.destructive\\]\\:hover\\:text-red-200:hover:is(.dark *){--tw-text-opacity: 1;color:rgb(254 202 202 / var(--tw-text-opacity, 1))}@media (min-width: 640px){.sm\\:bottom-0{bottom:0}.sm\\:right-0{right:0}.sm\\:top-auto{top:auto}.sm\\:mt-0{margin-top:0}.sm\\:flex{display:flex}.sm\\:max-w-md{max-width:28rem}.sm\\:max-w-sm{max-width:24rem}.sm\\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.sm\\:flex-row{flex-direction:row}.sm\\:flex-col{flex-direction:column}.sm\\:justify-end{justify-content:flex-end}.sm\\:gap-2\\.5{gap:.625rem}.sm\\:space-x-2>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(.5rem * var(--tw-space-x-reverse));margin-left:calc(.5rem * calc(1 - var(--tw-space-x-reverse)))}.sm\\:space-x-4>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(1rem * var(--tw-space-x-reverse));margin-left:calc(1rem * calc(1 - var(--tw-space-x-reverse)))}.sm\\:space-y-0>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(0px * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0px * var(--tw-space-y-reverse))}.sm\\:rounded-lg{border-radius:var(--radius)}.sm\\:text-left{text-align:left}.data-\\[state\\=open\\]\\:sm\\:slide-in-from-bottom-full[data-state=open]{--tw-enter-translate-y: 100%}}@media (min-width: 768px){.md\\:absolute{position:absolute}.md\\:block{display:block}.md\\:flex{display:flex}.md\\:w-\\[var\\(--radix-navigation-menu-viewport-width\\)\\]{width:var(--radix-navigation-menu-viewport-width)}.md\\:w-auto{width:auto}.md\\:max-w-\\[420px\\]{max-width:420px}.md\\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.md\\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.md\\:grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.md\\:text-2xl{font-size:1.5rem;line-height:2rem}.md\\:text-6xl{font-size:3.75rem;line-height:1}.md\\:text-sm{font-size:.875rem;line-height:1.25rem}.md\\:opacity-0{opacity:0}.after\\:md\\:hidden:after{content:var(--tw-content);display:none}.peer[data-variant=inset]~.md\\:peer-data-\\[variant\\=inset\\]\\:m-2{margin:.5rem}.peer[data-state=collapsed][data-variant=inset]~.md\\:peer-data-\\[state\\=collapsed\\]\\:peer-data-\\[variant\\=inset\\]\\:ml-2{margin-left:.5rem}.peer[data-variant=inset]~.md\\:peer-data-\\[variant\\=inset\\]\\:ml-0{margin-left:0}.peer[data-variant=inset]~.md\\:peer-data-\\[variant\\=inset\\]\\:rounded-xl{border-radius:.75rem}.peer[data-variant=inset]~.md\\:peer-data-\\[variant\\=inset\\]\\:shadow{--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}}@media (min-width: 1024px){.lg\\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.lg\\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}}.\\[\\&\\:has\\(\\[aria-selected\\]\\)\\]\\:bg-accent:has([aria-selected]){background-color:var(--accent)}.first\\:\\[\\&\\:has\\(\\[aria-selected\\]\\)\\]\\:rounded-l-md:has([aria-selected]):first-child{border-top-left-radius:calc(var(--radius) - 2px);border-bottom-left-radius:calc(var(--radius) - 2px)}.last\\:\\[\\&\\:has\\(\\[aria-selected\\]\\)\\]\\:rounded-r-md:has([aria-selected]):last-child{border-top-right-radius:calc(var(--radius) - 2px);border-bottom-right-radius:calc(var(--radius) - 2px)}.\\[\\&\\:has\\(\\[aria-selected\\]\\.day-range-end\\)\\]\\:rounded-r-md:has([aria-selected].day-range-end){border-top-right-radius:calc(var(--radius) - 2px);border-bottom-right-radius:calc(var(--radius) - 2px)}.\\[\\&\\:has\\(\\[role\\=checkbox\\]\\)\\]\\:pr-0:has([role=checkbox]){padding-right:0}.\\[\\&\\>button\\]\\:hidden>button{display:none}.\\[\\&\\>span\\:last-child\\]\\:truncate>span:last-child{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.\\[\\&\\>span\\]\\:line-clamp-1>span{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.\\[\\&\\>svg\\+div\\]\\:translate-y-\\[-3px\\]>svg+div{--tw-translate-y: -3px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.\\[\\&\\>svg\\]\\:absolute>svg{position:absolute}.\\[\\&\\>svg\\]\\:left-4>svg{left:1rem}.\\[\\&\\>svg\\]\\:top-4>svg{top:1rem}.\\[\\&\\>svg\\]\\:size-4>svg{width:1rem;height:1rem}.\\[\\&\\>svg\\]\\:h-2\\.5>svg{height:.625rem}.\\[\\&\\>svg\\]\\:h-3>svg{height:.75rem}.\\[\\&\\>svg\\]\\:h-3\\.5>svg{height:.875rem}.\\[\\&\\>svg\\]\\:w-2\\.5>svg{width:.625rem}.\\[\\&\\>svg\\]\\:w-3>svg{width:.75rem}.\\[\\&\\>svg\\]\\:w-3\\.5>svg{width:.875rem}.\\[\\&\\>svg\\]\\:shrink-0>svg{flex-shrink:0}.\\[\\&\\>svg\\]\\:text-blue-600>svg{--tw-text-opacity: 1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.\\[\\&\\>svg\\]\\:text-foreground>svg{color:var(--foreground)}.\\[\\&\\>svg\\]\\:text-muted-foreground>svg{color:var(--muted-foreground)}.\\[\\&\\>svg\\]\\:text-red-600>svg{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.\\[\\&\\>svg\\]\\:text-sidebar-accent-foreground>svg{color:var(--sidebar-accent-foreground)}.dark\\:\\[\\&\\>svg\\]\\:text-blue-400>svg:is(.dark *){--tw-text-opacity: 1;color:rgb(96 165 250 / var(--tw-text-opacity, 1))}.dark\\:\\[\\&\\>svg\\]\\:text-red-400>svg:is(.dark *){--tw-text-opacity: 1;color:rgb(248 113 113 / var(--tw-text-opacity, 1))}.\\[\\&\\>svg\\~\\*\\]\\:pl-7>svg~*{padding-left:1.75rem}.\\[\\&\\>tr\\]\\:last\\:border-b-0:last-child>tr{border-bottom-width:0px}.\\[\\&\\[data-panel-group-direction\\=vertical\\]\\>div\\]\\:rotate-90[data-panel-group-direction=vertical]>div{--tw-rotate: 90deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.\\[\\&\\[data-state\\=open\\]\\>svg\\]\\:rotate-180[data-state=open]>svg{--tw-rotate: 180deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.\\[\\&_\\.recharts-cartesian-axis-tick_text\\]\\:fill-muted-foreground .recharts-cartesian-axis-tick text{fill:var(--muted-foreground)}.\\[\\&_\\.recharts-curve\\.recharts-tooltip-cursor\\]\\:stroke-border .recharts-curve.recharts-tooltip-cursor{stroke:var(--border)}.\\[\\&_\\.recharts-dot\\[stroke\\=\\'\\#fff\\'\\]\\]\\:stroke-transparent .recharts-dot[stroke=\"#fff\"]{stroke:transparent}.\\[\\&_\\.recharts-layer\\]\\:outline-none .recharts-layer{outline:2px solid transparent;outline-offset:2px}.\\[\\&_\\.recharts-polar-grid_\\[stroke\\=\\'\\#ccc\\'\\]\\]\\:stroke-border .recharts-polar-grid [stroke=\"#ccc\"]{stroke:var(--border)}.\\[\\&_\\.recharts-radial-bar-background-sector\\]\\:fill-muted .recharts-radial-bar-background-sector,.\\[\\&_\\.recharts-rectangle\\.recharts-tooltip-cursor\\]\\:fill-muted .recharts-rectangle.recharts-tooltip-cursor{fill:var(--muted)}.\\[\\&_\\.recharts-reference-line_\\[stroke\\=\\'\\#ccc\\'\\]\\]\\:stroke-border .recharts-reference-line [stroke=\"#ccc\"]{stroke:var(--border)}.\\[\\&_\\.recharts-sector\\[stroke\\=\\'\\#fff\\'\\]\\]\\:stroke-transparent .recharts-sector[stroke=\"#fff\"]{stroke:transparent}.\\[\\&_\\.recharts-sector\\]\\:outline-none .recharts-sector,.\\[\\&_\\.recharts-surface\\]\\:outline-none .recharts-surface{outline:2px solid transparent;outline-offset:2px}.\\[\\&_\\[cmdk-group-heading\\]\\]\\:px-2 [cmdk-group-heading]{padding-left:.5rem;padding-right:.5rem}.\\[\\&_\\[cmdk-group-heading\\]\\]\\:py-1\\.5 [cmdk-group-heading]{padding-top:.375rem;padding-bottom:.375rem}.\\[\\&_\\[cmdk-group-heading\\]\\]\\:text-xs [cmdk-group-heading]{font-size:.75rem;line-height:1rem}.\\[\\&_\\[cmdk-group-heading\\]\\]\\:font-medium [cmdk-group-heading]{font-weight:500}.\\[\\&_\\[cmdk-group-heading\\]\\]\\:text-muted-foreground [cmdk-group-heading]{color:var(--muted-foreground)}.\\[\\&_\\[cmdk-group\\]\\:not\\(\\[hidden\\]\\)_\\~\\[cmdk-group\\]\\]\\:pt-0 [cmdk-group]:not([hidden])~[cmdk-group]{padding-top:0}.\\[\\&_\\[cmdk-group\\]\\]\\:px-2 [cmdk-group]{padding-left:.5rem;padding-right:.5rem}.\\[\\&_\\[cmdk-input-wrapper\\]_svg\\]\\:h-5 [cmdk-input-wrapper] svg{height:1.25rem}.\\[\\&_\\[cmdk-input-wrapper\\]_svg\\]\\:w-5 [cmdk-input-wrapper] svg{width:1.25rem}.\\[\\&_\\[cmdk-input\\]\\]\\:h-12 [cmdk-input]{height:3rem}.\\[\\&_\\[cmdk-item\\]\\]\\:px-2 [cmdk-item]{padding-left:.5rem;padding-right:.5rem}.\\[\\&_\\[cmdk-item\\]\\]\\:py-3 [cmdk-item]{padding-top:.75rem;padding-bottom:.75rem}.\\[\\&_\\[cmdk-item\\]_svg\\]\\:h-5 [cmdk-item] svg{height:1.25rem}.\\[\\&_\\[cmdk-item\\]_svg\\]\\:w-5 [cmdk-item] svg{width:1.25rem}.\\[\\&_p\\]\\:leading-relaxed p{line-height:1.625}.\\[\\&_svg\\]\\:pointer-events-none svg{pointer-events:none}.\\[\\&_svg\\]\\:size-4 svg{width:1rem;height:1rem}.\\[\\&_svg\\]\\:shrink-0 svg{flex-shrink:0}.\\[\\&_tr\\:last-child\\]\\:border-0 tr:last-child{border-width:0px}.\\[\\&_tr\\]\\:border-b tr{border-bottom-width:1px}[data-side=left][data-collapsible=offcanvas] .\\[\\[data-side\\=left\\]\\[data-collapsible\\=offcanvas\\]_\\&\\]\\:-right-2{right:-.5rem}[data-side=left][data-state=collapsed] .\\[\\[data-side\\=left\\]\\[data-state\\=collapsed\\]_\\&\\]\\:cursor-e-resize{cursor:e-resize}[data-side=left] .\\[\\[data-side\\=left\\]_\\&\\]\\:cursor-w-resize{cursor:w-resize}[data-side=right][data-collapsible=offcanvas] .\\[\\[data-side\\=right\\]\\[data-collapsible\\=offcanvas\\]_\\&\\]\\:-left-2{left:-.5rem}[data-side=right][data-state=collapsed] .\\[\\[data-side\\=right\\]\\[data-state\\=collapsed\\]_\\&\\]\\:cursor-w-resize{cursor:w-resize}[data-side=right] .\\[\\[data-side\\=right\\]_\\&\\]\\:cursor-e-resize{cursor:e-resize}\n","size_bytes":160096},"android/app/src/main/assets/public/assets/web-xwe1Y9Sz.js":{"content":"import{W as o}from\"./index-BQFIQdpH.js\";class e extends o{constructor(){super(),this._lastWindow=null}async open(s){this._lastWindow=window.open(s.url,s.windowName||\"_blank\")}async close(){return new Promise((s,n)=>{this._lastWindow!=null?(this._lastWindow.close(),this._lastWindow=null,s()):n(\"No active window to close!\")})}}const i=new e;export{i as Browser,e as BrowserWeb};\n","size_bytes":379},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4885},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border-2 border-gray-300 bg-white dark:bg-gray-800 text-gray-900 dark:text-white p-4 shadow-2xl backdrop-blur-sm outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1337},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1419},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":1901},"client/src/components/speech-settings.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Switch } from '@/components/ui/switch';\nimport { Label } from '@/components/ui/label';\nimport { Input } from '@/components/ui/input';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Separator } from '@/components/ui/separator';\nimport { Mic, MicOff, Volume2, Brain, Settings, Zap } from 'lucide-react';\nimport { speechService, type VoiceCommand } from '@/lib/speech-service';\n\nexport function SpeechSettings() {\n  const [isSupported, setIsSupported] = useState(false);\n  const [settings, setSettings] = useState({\n    enabled: false,\n    continuous: false,\n    wakeWord: 'hey platemate',\n    voiceConfirmation: true\n  });\n  const [commands, setCommands] = useState<VoiceCommand[]>([]);\n  const [isListening, setIsListening] = useState(false);\n\n  useEffect(() => {\n    // Check if speech recognition is supported\n    setIsSupported(speechService.isSupported());\n\n    // Load current settings\n    const currentSettings = speechService.getSettings();\n    setSettings(currentSettings);\n\n    // Get available commands\n    setCommands(speechService.getAvailableCommands());\n\n    // Update listening state\n    const updateListeningState = () => {\n      setIsListening(speechService.isCurrentlyListening());\n    };\n\n    // Set up interval to check listening state\n    const interval = setInterval(updateListeningState, 1000);\n    return () => clearInterval(interval);\n  }, []);\n\n  const handleSettingChange = (key: keyof typeof settings, value: any) => {\n    const newSettings = { ...settings, [key]: value };\n    setSettings(newSettings);\n    speechService.updateSettings({ [key]: value });\n  };\n\n  const startListening = async () => {\n    const started = await speechService.startListening(settings.continuous);\n    if (started) {\n      setIsListening(true);\n    }\n  };\n\n  const stopListening = () => {\n    speechService.stopListening();\n    setIsListening(false);\n  };\n\n  const testVoiceCommand = () => {\n    if (isListening) {\n      stopListening();\n    } else {\n      startListening();\n    }\n  };\n\n  if (!isSupported) {\n    return (\n      <Card className=\"border-yellow-200 bg-yellow-50 dark:bg-yellow-900/20 dark:border-yellow-800\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex items-center space-x-3 text-yellow-800 dark:text-yellow-200\">\n            <MicOff className=\"h-5 w-5\" />\n            <div>\n              <p className=\"font-medium\">Speech Recognition Not Available</p>\n              <p className=\"text-sm opacity-80\">\n                Your browser doesn't support speech recognition or you're not using HTTPS.\n              </p>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Speech Control Panel */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center space-x-2\">\n            <Settings className=\"h-5 w-5\" />\n            <span>Speech Navigation Settings</span>\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-6\">\n          {/* Enable/Disable Toggle */}\n          <div className=\"flex items-center justify-between\">\n            <div className=\"space-y-1\">\n              <Label htmlFor=\"speech-enabled\">Enable Speech Navigation</Label>\n              <p className=\"text-sm text-muted-foreground\">\n                Allow voice commands to navigate the app\n              </p>\n            </div>\n            <Switch\n              id=\"speech-enabled\"\n              checked={settings.enabled}\n              onCheckedChange={(checked) => handleSettingChange('enabled', checked)}\n              data-testid=\"switch-speech-enabled\"\n            />\n          </div>\n\n          <Separator />\n\n          {/* Continuous Listening */}\n          <div className=\"flex items-center justify-between\">\n            <div className=\"space-y-1\">\n              <Label htmlFor=\"continuous-listening\">Continuous Listening</Label>\n              <p className=\"text-sm text-muted-foreground\">\n                Keep listening for commands after each recognition\n              </p>\n            </div>\n            <Switch\n              id=\"continuous-listening\"\n              checked={settings.continuous}\n              onCheckedChange={(checked) => handleSettingChange('continuous', checked)}\n              disabled={!settings.enabled}\n              data-testid=\"switch-continuous-listening\"\n            />\n          </div>\n\n          <Separator />\n\n          {/* Voice Confirmation */}\n          <div className=\"flex items-center justify-between\">\n            <div className=\"space-y-1\">\n              <Label htmlFor=\"voice-confirmation\">Voice Confirmations</Label>\n              <p className=\"text-sm text-muted-foreground\">\n                Show notifications when commands are recognized\n              </p>\n            </div>\n            <Switch\n              id=\"voice-confirmation\"\n              checked={settings.voiceConfirmation}\n              onCheckedChange={(checked) => handleSettingChange('voiceConfirmation', checked)}\n              disabled={!settings.enabled}\n              data-testid=\"switch-voice-confirmation\"\n            />\n          </div>\n\n          <Separator />\n\n          {/* Wake Word */}\n          <div className=\"space-y-3\">\n            <Label htmlFor=\"wake-word\">Wake Word (Future Feature)</Label>\n            <Input\n              id=\"wake-word\"\n              value={settings.wakeWord}\n              onChange={(e) => handleSettingChange('wakeWord', e.target.value)}\n              placeholder=\"hey platemate\"\n              disabled={!settings.enabled}\n              data-testid=\"input-wake-word\"\n            />\n            <p className=\"text-xs text-muted-foreground\">\n              Wake word functionality coming soon - currently all phrases are active\n            </p>\n          </div>\n\n          <Separator />\n\n          {/* Test Controls */}\n          <div className=\"space-y-3\">\n            <Label>Test Speech Recognition</Label>\n            <div className=\"flex items-center space-x-3\">\n              <Button\n                onClick={testVoiceCommand}\n                variant={isListening ? \"destructive\" : \"default\"}\n                disabled={!settings.enabled}\n                data-testid=\"button-test-speech\"\n              >\n                {isListening ? (\n                  <>\n                    <MicOff className=\"h-4 w-4 mr-2\" />\n                    Stop Listening\n                  </>\n                ) : (\n                  <>\n                    <Mic className=\"h-4 w-4 mr-2\" />\n                    Start Listening\n                  </>\n                )}\n              </Button>\n              \n              {isListening && (\n                <div className=\"flex items-center space-x-2 text-red-600 dark:text-red-400\">\n                  <div className=\"w-2 h-2 bg-red-500 rounded-full animate-pulse\"></div>\n                  <span className=\"text-sm font-medium\">Listening...</span>\n                </div>\n              )}\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Available Commands */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center space-x-2\">\n            <Brain className=\"h-5 w-5\" />\n            <span>Available Voice Commands</span>\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-4\">\n            {/* Navigation Commands */}\n            <div>\n              <h4 className=\"font-medium text-sm mb-3 flex items-center space-x-2\">\n                <Zap className=\"h-4 w-4\" />\n                <span>Navigation</span>\n              </h4>\n              <div className=\"grid gap-2\">\n                {commands\n                  .filter(cmd => cmd.category === 'navigation')\n                  .map((cmd, index) => (\n                    <div key={index} className=\"p-3 bg-muted rounded-lg\">\n                      <div className=\"flex items-start justify-between\">\n                        <div>\n                          <p className=\"text-sm font-medium\">{cmd.description}</p>\n                          <div className=\"flex flex-wrap gap-1 mt-2\">\n                            {cmd.phrases.slice(0, 3).map((phrase, phraseIndex) => (\n                              <Badge key={phraseIndex} variant=\"secondary\" className=\"text-xs\">\n                                \"{phrase}\"\n                              </Badge>\n                            ))}\n                            {cmd.phrases.length > 3 && (\n                              <Badge variant=\"outline\" className=\"text-xs\">\n                                +{cmd.phrases.length - 3} more\n                              </Badge>\n                            )}\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  ))\n                }\n              </div>\n            </div>\n\n            {/* Action Commands */}\n            <div>\n              <h4 className=\"font-medium text-sm mb-3 flex items-center space-x-2\">\n                <Volume2 className=\"h-4 w-4\" />\n                <span>Actions</span>\n              </h4>\n              <div className=\"grid gap-2\">\n                {commands\n                  .filter(cmd => cmd.category === 'action')\n                  .map((cmd, index) => (\n                    <div key={index} className=\"p-3 bg-muted rounded-lg\">\n                      <div className=\"flex items-start justify-between\">\n                        <div>\n                          <p className=\"text-sm font-medium\">{cmd.description}</p>\n                          <div className=\"flex flex-wrap gap-1 mt-2\">\n                            {cmd.phrases.slice(0, 3).map((phrase, phraseIndex) => (\n                              <Badge key={phraseIndex} variant=\"secondary\" className=\"text-xs\">\n                                \"{phrase}\"\n                              </Badge>\n                            ))}\n                            {cmd.phrases.length > 3 && (\n                              <Badge variant=\"outline\" className=\"text-xs\">\n                                +{cmd.phrases.length - 3} more\n                              </Badge>\n                            )}\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  ))\n                }\n              </div>\n            </div>\n\n            {/* Control Commands */}\n            <div>\n              <h4 className=\"font-medium text-sm mb-3 flex items-center space-x-2\">\n                <Settings className=\"h-4 w-4\" />\n                <span>Control</span>\n              </h4>\n              <div className=\"grid gap-2\">\n                {commands\n                  .filter(cmd => cmd.category === 'control')\n                  .map((cmd, index) => (\n                    <div key={index} className=\"p-3 bg-muted rounded-lg\">\n                      <div className=\"flex items-start justify-between\">\n                        <div>\n                          <p className=\"text-sm font-medium\">{cmd.description}</p>\n                          <div className=\"flex flex-wrap gap-1 mt-2\">\n                            {cmd.phrases.slice(0, 3).map((phrase, phraseIndex) => (\n                              <Badge key={phraseIndex} variant=\"secondary\" className=\"text-xs\">\n                                \"{phrase}\"\n                              </Badge>\n                            ))}\n                            {cmd.phrases.length > 3 && (\n                              <Badge variant=\"outline\" className=\"text-xs\">\n                                +{cmd.phrases.length - 3} more\n                              </Badge>\n                            )}\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  ))\n                }\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Usage Tips */}\n      <Card>\n        <CardContent className=\"pt-6\">\n          <div className=\"space-y-3\">\n            <h4 className=\"font-medium flex items-center space-x-2\">\n              <Brain className=\"h-4 w-4\" />\n              <span>Speech Recognition Tips</span>\n            </h4>\n            <ul className=\"text-sm space-y-2 text-muted-foreground\">\n              <li>â€¢ Speak clearly and at a normal pace</li>\n              <li>â€¢ Use any of the listed phrases for each command</li>\n              <li>â€¢ Allow microphone access when prompted</li>\n              <li>â€¢ Speech works best in quiet environments</li>\n              <li>â€¢ Commands are case-insensitive</li>\n              <li>â€¢ Some browsers may require HTTPS for speech recognition</li>\n            </ul>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":12954},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","size_bytes":261},"client/src/components/data-management-dialog.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation, useQuery } from \"@tanstack/react-query\";\nimport { Download, Upload, Trash2, Archive, FileText, Database, Calendar, Settings } from \"lucide-react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Label } from \"@/components/ui/label\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { format, subDays } from \"date-fns\";\nimport type { DiaryEntryWithAnalysis, DrinkEntry } from \"@shared/schema\";\n\nexport function DataManagementDialog() {\n  const { toast } = useToast();\n  const [open, setOpen] = useState(false);\n  const [exportFormat, setExportFormat] = useState<\"csv\" | \"json\" | \"pdf\">(\"csv\");\n  const [exportRange, setExportRange] = useState<\"week\" | \"month\" | \"year\" | \"all\">(\"month\");\n  const [selectedEntries, setSelectedEntries] = useState<string[]>([]);\n\n  const { data: diaryEntries = [] } = useQuery<DiaryEntryWithAnalysis[]>({\n    queryKey: ['/api/diary'],\n  });\n\n  const { data: drinkEntries = [] } = useQuery<DrinkEntry[]>({\n    queryKey: ['/api/drinks'],\n  });\n\n  const exportMutation = useMutation({\n    mutationFn: async ({ format, range }: { format: string; range: string }) => {\n      // Mock export functionality - in real app this would call API\n      const data = {\n        diary: diaryEntries,\n        drinks: drinkEntries,\n        exportDate: new Date().toISOString(),\n        range,\n        format,\n      };\n      \n      const fileName = `platemate-export-${format}-${Date.now()}`;\n      \n      if (format === 'json') {\n        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });\n        const url = URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = `${fileName}.json`;\n        document.body.appendChild(a);\n        a.click();\n        document.body.removeChild(a);\n        URL.revokeObjectURL(url);\n      } else if (format === 'csv') {\n        const csvContent = convertToCSV(diaryEntries);\n        const blob = new Blob([csvContent], { type: 'text/csv' });\n        const url = URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = `${fileName}.csv`;\n        document.body.appendChild(a);\n        a.click();\n        document.body.removeChild(a);\n        URL.revokeObjectURL(url);\n      }\n      \n      return { success: true };\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Export Complete\",\n        description: \"Your data has been downloaded successfully.\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Export Failed\",\n        description: \"Failed to export data. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const bulkDeleteMutation = useMutation({\n    mutationFn: async (entryIds: string[]) => {\n      // Mock bulk delete - in real app would call API for each entry\n      return Promise.all(\n        entryIds.map(id => \n          new Promise(resolve => setTimeout(() => resolve(true), 100))\n        )\n      );\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Entries Deleted\",\n        description: `${selectedEntries.length} entries have been removed.`,\n      });\n      setSelectedEntries([]);\n    },\n    onError: () => {\n      toast({\n        title: \"Delete Failed\",\n        description: \"Failed to delete entries. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const convertToCSV = (data: DiaryEntryWithAnalysis[]) => {\n    const headers = [\n      'Date',\n      'Meal Type',\n      'Custom Name',\n      'Calories',\n      'Protein (g)',\n      'Carbs (g)',\n      'Fat (g)',\n      'Detected Foods',\n      'Notes',\n      'Confidence'\n    ];\n\n    const rows = data.map(entry => [\n      format(new Date(entry.mealDate), 'yyyy-MM-dd HH:mm'),\n      entry.mealType,\n      entry.customMealName || '',\n      entry.analysis?.totalCalories || 0,\n      entry.analysis?.totalProtein || 0,\n      entry.analysis?.totalCarbs || 0,\n      entry.analysis?.totalFat || 0,\n      entry.analysis?.detectedFoods?.map(f => f.name).join('; ') || '',\n      entry.notes || '',\n      entry.analysis?.confidence || 0,\n    ]);\n\n    return [headers, ...rows]\n      .map(row => row.map(cell => `\"${cell}\"`).join(','))\n      .join('\\n');\n  };\n\n  const getFilteredEntries = () => {\n    const now = new Date();\n    let startDate: Date;\n\n    switch (exportRange) {\n      case 'week':\n        startDate = subDays(now, 7);\n        break;\n      case 'month':\n        startDate = subDays(now, 30);\n        break;\n      case 'year':\n        startDate = subDays(now, 365);\n        break;\n      default:\n        return diaryEntries;\n    }\n\n    return diaryEntries.filter(entry => new Date(entry.mealDate) >= startDate);\n  };\n\n  const handleExport = () => {\n    exportMutation.mutate({ format: exportFormat, range: exportRange });\n  };\n\n  const handleBulkDelete = () => {\n    if (selectedEntries.length === 0) return;\n    \n    const confirmed = window.confirm(\n      `Are you sure you want to delete ${selectedEntries.length} entries? This action cannot be undone.`\n    );\n    \n    if (confirmed) {\n      bulkDeleteMutation.mutate(selectedEntries);\n    }\n  };\n\n  const handleEntrySelection = (entryId: string, checked: boolean) => {\n    if (checked) {\n      setSelectedEntries(prev => [...prev, entryId]);\n    } else {\n      setSelectedEntries(prev => prev.filter(id => id !== entryId));\n    }\n  };\n\n  const filteredEntries = getFilteredEntries();\n\n  return (\n    <Dialog open={open} onOpenChange={setOpen}>\n      <DialogTrigger asChild>\n        <Button\n          variant=\"outline\"\n          size=\"sm\"\n          className=\"bg-gradient-to-r from-purple-500/10 to-pink-500/10 hover:from-purple-500/20 hover:to-pink-500/20 border-purple-200 dark:border-purple-800\"\n          data-testid=\"button-data-management\"\n        >\n          <Database className=\"h-4 w-4 mr-2\" />\n          Manage Data\n        </Button>\n      </DialogTrigger>\n      <DialogContent className=\"max-w-2xl max-h-[80vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <Database className=\"h-5 w-5\" />\n            Data Management\n          </DialogTitle>\n          <DialogDescription>\n            Export your data, manage entries, and clean up your diary\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-6\">\n          {/* Export Section */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2 text-lg\">\n                <Download className=\"h-5 w-5\" />\n                Export Data\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label>Export Format</Label>\n                  <Select value={exportFormat} onValueChange={(value: any) => setExportFormat(value)}>\n                    <SelectTrigger data-testid=\"select-export-format\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"csv\">ðŸ“Š CSV Spreadsheet</SelectItem>\n                      <SelectItem value=\"json\">ðŸ’» JSON Data</SelectItem>\n                      <SelectItem value=\"pdf\" disabled>ðŸ“„ PDF Report (Soon)</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>Time Range</Label>\n                  <Select value={exportRange} onValueChange={(value: any) => setExportRange(value)}>\n                    <SelectTrigger data-testid=\"select-export-range\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"week\">ðŸ“… Last Week</SelectItem>\n                      <SelectItem value=\"month\">ðŸ“… Last Month</SelectItem>\n                      <SelectItem value=\"year\">ðŸ“… Last Year</SelectItem>\n                      <SelectItem value=\"all\">ðŸ“… All Time</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n\n              <div className=\"bg-muted/50 p-3 rounded text-sm\">\n                <p><strong>Export Preview:</strong></p>\n                <p>â€¢ {filteredEntries.length} diary entries</p>\n                <p>â€¢ {drinkEntries.length} drink entries</p>\n                <p>â€¢ Format: {exportFormat.toUpperCase()}</p>\n              </div>\n\n              <Button\n                onClick={handleExport}\n                disabled={exportMutation.isPending}\n                className=\"w-full bg-gradient-to-r from-blue-500 to-purple-600\"\n                data-testid=\"button-export-data\"\n              >\n                <Download className=\"h-4 w-4 mr-2\" />\n                {exportMutation.isPending ? \"Exporting...\" : \"Export Data\"}\n              </Button>\n            </CardContent>\n          </Card>\n\n          {/* Bulk Operations Section */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2 text-lg\">\n                <Settings className=\"h-5 w-5\" />\n                Bulk Operations\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"text-sm text-muted-foreground mb-3\">\n                Select entries to perform bulk operations\n              </div>\n\n              {/* Entry Selection */}\n              <div className=\"max-h-48 overflow-y-auto space-y-2 border rounded p-2\">\n                {diaryEntries.slice(0, 20).map((entry) => (\n                  <div\n                    key={entry.id}\n                    className=\"flex items-center space-x-2 p-2 hover:bg-muted/50 rounded\"\n                  >\n                    <Checkbox\n                      checked={selectedEntries.includes(entry.id)}\n                      onCheckedChange={(checked) => \n                        handleEntrySelection(entry.id, checked as boolean)\n                      }\n                      data-testid={`checkbox-entry-${entry.id}`}\n                    />\n                    <div className=\"flex-1 min-w-0\">\n                      <div className=\"flex items-center gap-2\">\n                        <span className=\"text-sm font-medium\">\n                          {entry.mealType === 'custom' && entry.customMealName \n                            ? entry.customMealName \n                            : entry.mealType\n                          }\n                        </span>\n                        <span className=\"text-xs text-muted-foreground\">\n                          {entry.analysis?.totalCalories || 0} cal\n                        </span>\n                      </div>\n                      <div className=\"text-xs text-muted-foreground\">\n                        {format(new Date(entry.mealDate), 'MMM d, yyyy h:mm a')}\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n\n              {/* Bulk Actions */}\n              <div className=\"flex gap-2\">\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => {\n                    const allIds = diaryEntries.slice(0, 20).map(e => e.id);\n                    setSelectedEntries(\n                      selectedEntries.length === allIds.length ? [] : allIds\n                    );\n                  }}\n                  data-testid=\"button-select-all\"\n                >\n                  {selectedEntries.length === diaryEntries.slice(0, 20).length ? \"Deselect All\" : \"Select All\"}\n                </Button>\n                \n                <Button\n                  variant=\"destructive\"\n                  size=\"sm\"\n                  onClick={handleBulkDelete}\n                  disabled={selectedEntries.length === 0 || bulkDeleteMutation.isPending}\n                  data-testid=\"button-bulk-delete\"\n                >\n                  <Trash2 className=\"h-4 w-4 mr-1\" />\n                  Delete {selectedEntries.length > 0 ? `(${selectedEntries.length})` : ''}\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Stats & Info */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2 text-lg\">\n                <FileText className=\"h-5 w-5\" />\n                Data Summary\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                <div className=\"space-y-2\">\n                  <div className=\"flex justify-between\">\n                    <span>Total Meals:</span>\n                    <span className=\"font-medium\">{diaryEntries.length}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>Total Drinks:</span>\n                    <span className=\"font-medium\">{drinkEntries.length}</span>\n                  </div>\n                </div>\n                <div className=\"space-y-2\">\n                  <div className=\"flex justify-between\">\n                    <span>This Month:</span>\n                    <span className=\"font-medium\">\n                      {diaryEntries.filter(e => \n                        new Date(e.mealDate) >= subDays(new Date(), 30)\n                      ).length}\n                    </span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>This Week:</span>\n                    <span className=\"font-medium\">\n                      {diaryEntries.filter(e => \n                        new Date(e.mealDate) >= subDays(new Date(), 7)\n                      ).length}\n                    </span>\n                  </div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":14461},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\nimport { buildApiUrl } from \"./api-config\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const token = localStorage.getItem(\"auth_token\");\n  const headers: Record<string, string> = data ? { \"Content-Type\": \"application/json\" } : {};\n  \n  if (token) {\n    headers[\"Authorization\"] = `Bearer ${token}`;\n  }\n  \n  // Build full API URL (handles both browser and mobile)\n  const fullUrl = buildApiUrl(url);\n  \n  const res = await fetch(fullUrl, {\n    method,\n    headers,\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const token = localStorage.getItem(\"auth_token\");\n    const headers: Record<string, string> = {};\n    \n    if (token) {\n      headers[\"Authorization\"] = `Bearer ${token}`;\n    }\n    \n    // Build full API URL (handles both browser and mobile)\n    const urlPath = queryKey.join(\"/\") as string;\n    const fullUrl = buildApiUrl(urlPath);\n    \n    const res = await fetch(fullUrl, {\n      headers,\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false, // DISABLED: Causes WebView crashes in Capacitor\n      refetchOnMount: false, // DISABLED: Reduces unnecessary refetches\n      staleTime: 5 * 60 * 1000, // 5 minutes - allow data to become stale and refetch\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":2215},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"android/app/src/main/assets/public/assets/web-B1u9ZI0p.js":{"content":"import{W as t}from\"./index-BQFIQdpH.js\";class s extends t{constructor(){super(),this.handleVisibilityChange=()=>{const e={isActive:document.hidden!==!0};this.notifyListeners(\"appStateChange\",e),document.hidden?this.notifyListeners(\"pause\",null):this.notifyListeners(\"resume\",null)},document.addEventListener(\"visibilitychange\",this.handleVisibilityChange,!1)}exitApp(){throw this.unimplemented(\"Not implemented on web.\")}async getInfo(){throw this.unimplemented(\"Not implemented on web.\")}async getLaunchUrl(){return{url:\"\"}}async getState(){return{isActive:document.hidden!==!0}}async minimizeApp(){throw this.unimplemented(\"Not implemented on web.\")}async toggleBackButtonHandler(){throw this.unimplemented(\"Not implemented on web.\")}}export{s as AppWeb};\n","size_bytes":758},"server/bridgeTokens.ts":{"content":"import { randomBytes } from 'crypto';\n\ninterface BridgeToken {\n  token: string;\n  sessionId: string;\n  expiresAt: number;\n}\n\n// In-memory store for bridge tokens (expires after 5 minutes)\nconst bridgeTokens = new Map<string, BridgeToken>();\n\n// Clean up expired tokens every minute\nsetInterval(() => {\n  const now = Date.now();\n  const tokensToDelete: string[] = [];\n  bridgeTokens.forEach((data, token) => {\n    if (data.expiresAt < now) {\n      tokensToDelete.push(token);\n    }\n  });\n  tokensToDelete.forEach(token => bridgeTokens.delete(token));\n}, 60 * 1000);\n\nexport function createBridgeToken(sessionId: string): string {\n  // Generate a secure 256-bit random token\n  const token = randomBytes(32).toString('hex');\n  \n  const bridgeToken: BridgeToken = {\n    token,\n    sessionId,\n    expiresAt: Date.now() + (5 * 60 * 1000), // 5 minutes\n  };\n  \n  bridgeTokens.set(token, bridgeToken);\n  \n  console.log('ðŸ”‘ Created bridge token for session:', sessionId);\n  \n  return token;\n}\n\nexport function consumeBridgeToken(token: string): string | null {\n  const bridgeToken = bridgeTokens.get(token);\n  \n  if (!bridgeToken) {\n    console.log('âŒ Bridge token not found or expired:', token);\n    return null;\n  }\n  \n  if (bridgeToken.expiresAt < Date.now()) {\n    bridgeTokens.delete(token);\n    console.log('âŒ Bridge token expired:', token);\n    return null;\n  }\n  \n  // Token can only be used once - delete it immediately\n  bridgeTokens.delete(token);\n  \n  console.log('âœ… Bridge token consumed for session:', bridgeToken.sessionId);\n  \n  return bridgeToken.sessionId;\n}\n","size_bytes":1576},"server/replitAuth.ts":{"content":"import * as client from \"openid-client\";\nimport { Strategy, type VerifyFunction } from \"openid-client/passport\";\n\nimport passport from \"passport\";\nimport session from \"express-session\";\nimport type { Express, RequestHandler } from \"express\";\nimport memoize from \"memoizee\";\nimport connectPg from \"connect-pg-simple\";\nimport { storage } from \"./storage\";\nimport { createBridgeToken } from \"./bridgeTokens\";\n\nif (!process.env.REPLIT_DOMAINS) {\n  throw new Error(\"Environment variable REPLIT_DOMAINS not provided\");\n}\n\nconst getOidcConfig = memoize(\n  async () => {\n    return await client.discovery(\n      new URL(process.env.ISSUER_URL ?? \"https://replit.com/oidc\"),\n      process.env.REPL_ID!\n    );\n  },\n  { maxAge: 3600 * 1000 }\n);\n\nexport function getSession() {\n  const sessionTtl = 7 * 24 * 60 * 60 * 1000; // 1 week\n  const pgStore = connectPg(session);\n  const sessionStore = new pgStore({\n    conString: process.env.DATABASE_URL,\n    createTableIfMissing: false,\n    ttl: sessionTtl,\n    tableName: \"sessions\",\n  });\n  \n  // For Capacitor apps, we need different cookie settings\n  // Capacitor uses capacitor://localhost which is not HTTPS\n  const isProduction = process.env.NODE_ENV === 'production';\n  \n  return session({\n    secret: process.env.SESSION_SECRET!,\n    store: sessionStore,\n    resave: false,\n    saveUninitialized: false,\n    cookie: {\n      httpOnly: true,\n      // Only require secure cookies in production\n      // In development (including Capacitor localhost), allow non-secure\n      secure: isProduction ? 'auto' : false,\n      // Use 'lax' for better compatibility with Capacitor\n      // This works for both web and native apps\n      sameSite: isProduction ? 'none' : 'lax',\n      maxAge: sessionTtl,\n    },\n  });\n}\n\nfunction updateUserSession(\n  user: any,\n  tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers\n) {\n  user.claims = tokens.claims();\n  user.access_token = tokens.access_token;\n  user.refresh_token = tokens.refresh_token;\n  user.expires_at = user.claims?.exp;\n}\n\nasync function upsertUser(\n  claims: any,\n) {\n  await storage.upsertUser({\n    id: claims[\"sub\"],\n    email: claims[\"email\"],\n    firstName: claims[\"first_name\"],\n    lastName: claims[\"last_name\"],\n    profileImageUrl: claims[\"profile_image_url\"],\n  });\n}\n\nexport async function setupAuth(app: Express) {\n  app.set(\"trust proxy\", 1);\n  app.use(getSession());\n  app.use(passport.initialize());\n  app.use(passport.session());\n\n  const config = await getOidcConfig();\n\n  const verify: VerifyFunction = async (\n    tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers,\n    verified: passport.AuthenticateCallback\n  ) => {\n    const user = {};\n    updateUserSession(user, tokens);\n    await upsertUser(tokens.claims());\n    verified(null, user);\n  };\n\n  for (const domain of process.env\n    .REPLIT_DOMAINS!.split(\",\")) {\n    const strategy = new Strategy(\n      {\n        name: `replitauth:${domain}`,\n        config,\n        scope: \"openid email profile offline_access\",\n        callbackURL: `https://${domain}/api/callback`,\n      },\n      verify,\n    );\n    passport.use(strategy);\n  }\n\n  passport.serializeUser((user: Express.User, cb) => cb(null, user));\n  passport.deserializeUser((user: Express.User, cb) => cb(null, user));\n\n  app.get(\"/api/login\", (req, res, next) => {\n    console.log(`ðŸ” Login attempt - req.hostname: ${req.hostname}`);\n    \n    // Store returnUrl in session if provided (for mobile OAuth)\n    const returnUrl = req.query.returnUrl as string | undefined;\n    if (returnUrl) {\n      // SECURITY: Validate returnUrl to prevent open redirects\n      if (!returnUrl.startsWith('platemate://auth-complete')) {\n        console.error('âŒ Invalid returnUrl - must start with platemate://auth-complete');\n        return res.status(400).json({ error: 'Invalid return URL' });\n      }\n      console.log(`ðŸ“± Mobile OAuth - validated returnUrl: ${returnUrl}`);\n      (req.session as any).returnUrl = returnUrl;\n    }\n    \n    // Use the first domain from REPLIT_DOMAINS for authentication\n    const domain = process.env.REPLIT_DOMAINS!.split(\",\")[0];\n    console.log(`ðŸ” Using domain for auth: ${domain}`);\n    \n    passport.authenticate(`replitauth:${domain}`, {\n      prompt: \"login consent\",\n      scope: [\"openid\", \"email\", \"profile\", \"offline_access\"],\n    })(req, res, next);\n  });\n\n  // Signup route - uses OAuth flow just like login (Replit will show signup if user doesn't exist)\n  app.get(\"/api/signup\", (req, res, next) => {\n    console.log(`ðŸ” Signup attempt - req.hostname: ${req.hostname}`);\n    \n    // Store returnUrl in session if provided (for mobile OAuth)\n    const returnUrl = req.query.returnUrl as string | undefined;\n    if (returnUrl) {\n      // SECURITY: Validate returnUrl to prevent open redirects\n      if (!returnUrl.startsWith('platemate://auth-complete')) {\n        console.error('âŒ Invalid returnUrl - must start with platemate://auth-complete');\n        return res.status(400).json({ error: 'Invalid return URL' });\n      }\n      console.log(`ðŸ“± Mobile OAuth signup - validated returnUrl: ${returnUrl}`);\n      (req.session as any).returnUrl = returnUrl;\n    }\n    \n    // Use the first domain from REPLIT_DOMAINS for authentication\n    const domain = process.env.REPLIT_DOMAINS!.split(\",\")[0];\n    console.log(`ðŸ” Using domain for signup: ${domain}`);\n    \n    // Trigger OAuth flow (Replit will show signup form if user doesn't exist)\n    passport.authenticate(`replitauth:${domain}`, {\n      prompt: \"login consent\",\n      scope: [\"openid\", \"email\", \"profile\", \"offline_access\"],\n    })(req, res, next);\n  });\n\n  app.get(\"/api/callback\", (req, res, next) => {\n    console.log(`ðŸ” Callback attempt - req.hostname: ${req.hostname}`);\n    console.log(`ðŸ” Callback query params:`, req.query);\n    console.log(`ðŸ” Callback full URL:`, req.url);\n    \n    // Use the first domain from REPLIT_DOMAINS for authentication\n    const domain = process.env.REPLIT_DOMAINS!.split(\",\")[0];\n    console.log(`ðŸ” Using domain for callback: ${domain}`);\n    \n    passport.authenticate(`replitauth:${domain}`, (err: any, user: any) => {\n      if (err) {\n        console.error('âŒ Authentication error:', err);\n        return res.redirect(\"/api/login\");\n      }\n      \n      if (!user) {\n        console.log('âŒ No user returned from authentication');\n        return res.redirect(\"/api/login\");\n      }\n      \n      req.logIn(user, (err) => {\n        if (err) {\n          console.error('âŒ Login error:', err);\n          return res.redirect(\"/api/login\");\n        }\n        \n        // Check if this is a mobile OAuth flow with returnUrl\n        const returnUrl = (req.session as any).returnUrl;\n        \n        if (returnUrl) {\n          console.log(`ðŸ“± Mobile OAuth complete - generating bridge token`);\n          \n          // Create a bridge token for the mobile app\n          const bridgeToken = createBridgeToken(req.sessionID);\n          \n          // Clear the returnUrl from session\n          delete (req.session as any).returnUrl;\n          \n          // Redirect back to the mobile app with the bridge token\n          const redirectUrl = `${returnUrl}?token=${bridgeToken}`;\n          console.log(`ðŸ“± Redirecting to mobile app: ${redirectUrl}`);\n          return res.redirect(redirectUrl);\n        }\n        \n        // Normal web flow - redirect to home\n        console.log(`ðŸŒ Web OAuth complete - redirecting to /`);\n        res.redirect(\"/\");\n      });\n    })(req, res, next);\n  });\n\n  app.get(\"/api/logout\", (req, res) => {\n    req.logout(() => {\n      res.redirect(\n        client.buildEndSessionUrl(config, {\n          client_id: process.env.REPL_ID!,\n          post_logout_redirect_uri: `${req.protocol}://${req.hostname}/landing`,\n        }).href\n      );\n    });\n  });\n}\n\nexport const isAuthenticated: RequestHandler = async (req, res, next) => {\n  const user = req.user as any;\n\n  if (!req.isAuthenticated() || !user.expires_at) {\n    return res.status(401).json({ message: \"Unauthorized\" });\n  }\n\n  const now = Math.floor(Date.now() / 1000);\n  if (now <= user.expires_at) {\n    return next();\n  }\n\n  const refreshToken = user.refresh_token;\n  if (!refreshToken) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n\n  try {\n    const config = await getOidcConfig();\n    const tokenResponse = await client.refreshTokenGrant(config, refreshToken);\n    updateUserSession(user, tokenResponse);\n    return next();\n  } catch (error) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n};","size_bytes":8559},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","size_bytes":166},"client/src/components/ui/sidebar.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { VariantProps, cva } from \"class-variance-authority\"\nimport { PanelLeft } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nconst SidebarProvider = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    defaultOpen?: boolean\n    open?: boolean\n    onOpenChange?: (open: boolean) => void\n  }\n>(\n  (\n    {\n      defaultOpen = true,\n      open: openProp,\n      onOpenChange: setOpenProp,\n      className,\n      style,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const isMobile = useIsMobile()\n    const [openMobile, setOpenMobile] = React.useState(false)\n\n    // This is the internal state of the sidebar.\n    // We use openProp and setOpenProp for control from outside the component.\n    const [_open, _setOpen] = React.useState(defaultOpen)\n    const open = openProp ?? _open\n    const setOpen = React.useCallback(\n      (value: boolean | ((value: boolean) => boolean)) => {\n        const openState = typeof value === \"function\" ? value(open) : value\n        if (setOpenProp) {\n          setOpenProp(openState)\n        } else {\n          _setOpen(openState)\n        }\n\n        // This sets the cookie to keep the sidebar state.\n        document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n      },\n      [setOpenProp, open]\n    )\n\n    // Helper to toggle the sidebar.\n    const toggleSidebar = React.useCallback(() => {\n      return isMobile\n        ? setOpenMobile((open) => !open)\n        : setOpen((open) => !open)\n    }, [isMobile, setOpen, setOpenMobile])\n\n    // Adds a keyboard shortcut to toggle the sidebar.\n    React.useEffect(() => {\n      const handleKeyDown = (event: KeyboardEvent) => {\n        if (\n          event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n          (event.metaKey || event.ctrlKey)\n        ) {\n          event.preventDefault()\n          toggleSidebar()\n        }\n      }\n\n      window.addEventListener(\"keydown\", handleKeyDown)\n      return () => window.removeEventListener(\"keydown\", handleKeyDown)\n    }, [toggleSidebar])\n\n    // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n    // This makes it easier to style the sidebar with Tailwind classes.\n    const state = open ? \"expanded\" : \"collapsed\"\n\n    const contextValue = React.useMemo<SidebarContextProps>(\n      () => ({\n        state,\n        open,\n        setOpen,\n        isMobile,\n        openMobile,\n        setOpenMobile,\n        toggleSidebar,\n      }),\n      [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n    )\n\n    return (\n      <SidebarContext.Provider value={contextValue}>\n        <TooltipProvider delayDuration={0}>\n          <div\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH,\n                \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n                ...style,\n              } as React.CSSProperties\n            }\n            className={cn(\n              \"group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar\",\n              className\n            )}\n            ref={ref}\n            {...props}\n          >\n            {children}\n          </div>\n        </TooltipProvider>\n      </SidebarContext.Provider>\n    )\n  }\n)\nSidebarProvider.displayName = \"SidebarProvider\"\n\nconst Sidebar = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    side?: \"left\" | \"right\"\n    variant?: \"sidebar\" | \"floating\" | \"inset\"\n    collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n  }\n>(\n  (\n    {\n      side = \"left\",\n      variant = \"sidebar\",\n      collapsible = \"offcanvas\",\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n    if (collapsible === \"none\") {\n      return (\n        <div\n          className={cn(\n            \"flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground\",\n            className\n          )}\n          ref={ref}\n          {...props}\n        >\n          {children}\n        </div>\n      )\n    }\n\n    if (isMobile) {\n      return (\n        <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n          <SheetContent\n            data-sidebar=\"sidebar\"\n            data-mobile=\"true\"\n            className=\"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden\"\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n              } as React.CSSProperties\n            }\n            side={side}\n          >\n            <SheetHeader className=\"sr-only\">\n              <SheetTitle>Sidebar</SheetTitle>\n              <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n            </SheetHeader>\n            <div className=\"flex h-full w-full flex-col\">{children}</div>\n          </SheetContent>\n        </Sheet>\n      )\n    }\n\n    return (\n      <div\n        ref={ref}\n        className=\"group peer hidden text-sidebar-foreground md:block\"\n        data-state={state}\n        data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n        data-variant={variant}\n        data-side={side}\n      >\n        {/* This is what handles the sidebar gap on desktop */}\n        <div\n          className={cn(\n            \"relative w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear\",\n            \"group-data-[collapsible=offcanvas]:w-0\",\n            \"group-data-[side=right]:rotate-180\",\n            variant === \"floating\" || variant === \"inset\"\n              ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon]\"\n          )}\n        />\n        <div\n          className={cn(\n            \"fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex\",\n            side === \"left\"\n              ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n              : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n            // Adjust the padding for floating and inset variants.\n            variant === \"floating\" || variant === \"inset\"\n              ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n            className\n          )}\n          {...props}\n        >\n          <div\n            data-sidebar=\"sidebar\"\n            className=\"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow\"\n          >\n            {children}\n          </div>\n        </div>\n      </div>\n    )\n  }\n)\nSidebar.displayName = \"Sidebar\"\n\nconst SidebarTrigger = React.forwardRef<\n  React.ElementRef<typeof Button>,\n  React.ComponentProps<typeof Button>\n>(({ className, onClick, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      ref={ref}\n      data-sidebar=\"trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeft />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n})\nSidebarTrigger.displayName = \"SidebarTrigger\"\n\nconst SidebarRail = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\">\n>(({ className, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <button\n      ref={ref}\n      data-sidebar=\"rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex\",\n        \"[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarRail.displayName = \"SidebarRail\"\n\nconst SidebarInset = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"main\">\n>(({ className, ...props }, ref) => {\n  return (\n    <main\n      ref={ref}\n      className={cn(\n        \"relative flex w-full flex-1 flex-col bg-background\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInset.displayName = \"SidebarInset\"\n\nconst SidebarInput = React.forwardRef<\n  React.ElementRef<typeof Input>,\n  React.ComponentProps<typeof Input>\n>(({ className, ...props }, ref) => {\n  return (\n    <Input\n      ref={ref}\n      data-sidebar=\"input\"\n      className={cn(\n        \"h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInput.displayName = \"SidebarInput\"\n\nconst SidebarHeader = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarHeader.displayName = \"SidebarHeader\"\n\nconst SidebarFooter = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarFooter.displayName = \"SidebarFooter\"\n\nconst SidebarSeparator = React.forwardRef<\n  React.ElementRef<typeof Separator>,\n  React.ComponentProps<typeof Separator>\n>(({ className, ...props }, ref) => {\n  return (\n    <Separator\n      ref={ref}\n      data-sidebar=\"separator\"\n      className={cn(\"mx-2 w-auto bg-sidebar-border\", className)}\n      {...props}\n    />\n  )\n})\nSidebarSeparator.displayName = \"SidebarSeparator\"\n\nconst SidebarContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarContent.displayName = \"SidebarContent\"\n\nconst SidebarGroup = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarGroup.displayName = \"SidebarGroup\"\n\nconst SidebarGroupLabel = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupLabel.displayName = \"SidebarGroupLabel\"\n\nconst SidebarGroupAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupAction.displayName = \"SidebarGroupAction\"\n\nconst SidebarGroupContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"group-content\"\n    className={cn(\"w-full text-sm\", className)}\n    {...props}\n  />\n))\nSidebarGroupContent.displayName = \"SidebarGroupContent\"\n\nconst SidebarMenu = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu\"\n    className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n    {...props}\n  />\n))\nSidebarMenu.displayName = \"SidebarMenu\"\n\nconst SidebarMenuItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    data-sidebar=\"menu-item\"\n    className={cn(\"group/menu-item relative\", className)}\n    {...props}\n  />\n))\nSidebarMenuItem.displayName = \"SidebarMenuItem\"\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:!p-0\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst SidebarMenuButton = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    isActive?: boolean\n    tooltip?: string | React.ComponentProps<typeof TooltipContent>\n  } & VariantProps<typeof sidebarMenuButtonVariants>\n>(\n  (\n    {\n      asChild = false,\n      isActive = false,\n      variant = \"default\",\n      size = \"default\",\n      tooltip,\n      className,\n      ...props\n    },\n    ref\n  ) => {\n    const Comp = asChild ? Slot : \"button\"\n    const { isMobile, state } = useSidebar()\n\n    const button = (\n      <Comp\n        ref={ref}\n        data-sidebar=\"menu-button\"\n        data-size={size}\n        data-active={isActive}\n        className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n        {...props}\n      />\n    )\n\n    if (!tooltip) {\n      return button\n    }\n\n    if (typeof tooltip === \"string\") {\n      tooltip = {\n        children: tooltip,\n      }\n    }\n\n    return (\n      <Tooltip>\n        <TooltipTrigger asChild>{button}</TooltipTrigger>\n        <TooltipContent\n          side=\"right\"\n          align=\"center\"\n          hidden={state !== \"collapsed\" || isMobile}\n          {...tooltip}\n        />\n      </Tooltip>\n    )\n  }\n)\nSidebarMenuButton.displayName = \"SidebarMenuButton\"\n\nconst SidebarMenuAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    showOnHover?: boolean\n  }\n>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuAction.displayName = \"SidebarMenuAction\"\n\nconst SidebarMenuBadge = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"menu-badge\"\n    className={cn(\n      \"pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground\",\n      \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n      \"peer-data-[size=sm]/menu-button:top-1\",\n      \"peer-data-[size=default]/menu-button:top-1.5\",\n      \"peer-data-[size=lg]/menu-button:top-2.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuBadge.displayName = \"SidebarMenuBadge\"\n\nconst SidebarMenuSkeleton = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    showIcon?: boolean\n  }\n>(({ className, showIcon = false, ...props }, ref) => {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[--skeleton-width] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n})\nSidebarMenuSkeleton.displayName = \"SidebarMenuSkeleton\"\n\nconst SidebarMenuSub = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu-sub\"\n    className={cn(\n      \"mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuSub.displayName = \"SidebarMenuSub\"\n\nconst SidebarMenuSubItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ ...props }, ref) => <li ref={ref} {...props} />)\nSidebarMenuSubItem.displayName = \"SidebarMenuSubItem\"\n\nconst SidebarMenuSubButton = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentProps<\"a\"> & {\n    asChild?: boolean\n    size?: \"sm\" | \"md\"\n    isActive?: boolean\n  }\n>(({ asChild = false, size = \"md\", isActive, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuSubButton.displayName = \"SidebarMenuSubButton\"\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":23567},"client/src/pages/home.tsx":{"content":"import { useState, useEffect, useRef, useCallback } from \"react\";\nimport { useMutation, useQuery, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { motion } from \"framer-motion\";\nimport { AppHeader } from \"@/components/app-header\";\nimport { soundService } from \"@/lib/sound-service\";\nimport { CameraInterface } from \"@/components/camera-interface\";\nimport { ProcessingState } from \"@/components/processing-state\";\nimport { ResultsDisplay } from \"@/components/results-display\";\nimport { ErrorState } from \"@/components/error-state\";\nimport { Dashboard } from \"@/components/dashboard\";\nimport { Link, useLocation } from \"wouter\";\nimport { Book, Utensils, Lightbulb, Target, HelpCircle, Calculator, Syringe, Zap, TrendingUp, Mic, MicOff, Plus, Keyboard, Scale, User, History, LogOut, ChevronDown, ChevronUp, AlertTriangle, Check, X, Info, Flame, Camera, QrCode, Images, Menu } from \"lucide-react\";\n// Confetti disabled: import { ConfettiCelebration } from \"@/components/confetti-celebration\";\nimport { ScannerModal } from \"@/components/scanner-modal\";\nimport { BarcodeScanner } from \"@/components/barcode-scanner\";\nimport { OfflineIndicator } from \"@/components/offline-indicator\";\nimport type { FoodAnalysis, NutritionGoals, DiaryEntry, DiaryEntryWithAnalysis, DrinkEntry } from \"@shared/schema\";\nimport { DropdownNavigation } from \"@/components/dropdown-navigation\";\nimport { BottomHelpSection } from \"@/components/bottom-help-section\";\nimport { ProgressIndicators } from \"@/components/progress-indicators\";\nimport { calculateTodayNutrition } from \"@/lib/nutrition-calculator\";\nimport { launchLogin } from \"@/lib/auth-launcher\";\nimport { StreakCounter } from \"@/components/streak-counter\";\nimport { StepCounterWidget } from \"@/components/step-counter-widget\";\nimport { updateStreak } from \"@/lib/streak-tracker\";\nimport { ShiftCheckInModal } from \"@/components/shift-checkin-modal\";\nimport { ProfileReminderBanner } from \"@/components/profile-reminder-banner\";\nimport { getPortionOptions, portionToGrams } from \"@/lib/portionHelpers\";\nimport { buildApiUrl } from '@/lib/api-config';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\n\ntype AppState = 'camera' | 'processing' | 'results' | 'error' | 'confirmation';\n\n// Helper function to determine meal type based on current time\nfunction getMealTypeFromTime(): 'breakfast' | 'lunch' | 'dinner' | 'snack' {\n  const hour = new Date().getHours();\n  \n  if (hour >= 5 && hour < 11) {\n    return 'breakfast';\n  } else if (hour >= 11 && hour < 15) {\n    return 'lunch';\n  } else if (hour >= 15 && hour < 18) {\n    return 'snack';\n  } else if (hour >= 18 && hour < 23) {\n    return 'dinner';\n  } else {\n    return 'snack'; // Late night/early morning\n  }\n}\n\nexport default function Home() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const { user, isAuthenticated } = useAuth();\n  const [, setLocation] = useLocation();\n  const [currentState, setCurrentState] = useState<AppState>('camera');\n  const [analysisData, setAnalysisData] = useState<FoodAnalysis | null>(null);\n  const [errorMessage, setErrorMessage] = useState<string>('');\n  const [errorType, setErrorType] = useState<'food' | 'barcode'>('food');\n  const [confirmationData, setConfirmationData] = useState<any>(null);\n  const [editableFoods, setEditableFoods] = useState<any[]>([]);\n  const [editingIndex, setEditingIndex] = useState<number | null>(null);\n  \n  // Voice input state\n  const [isListening, setIsListening] = useState(false);\n  const [speechSupported, setSpeechSupported] = useState(false);\n  const [voiceInput, setVoiceInput] = useState('');\n  const [showVoiceMealDialog, setShowVoiceMealDialog] = useState(false);\n  const [textInput, setTextInput] = useState('');\n  const [showTextMealDialog, setShowTextMealDialog] = useState(false);\n  const [selectedMealType, setSelectedMealType] = useState<'breakfast' | 'lunch' | 'dinner' | 'snack'>(getMealTypeFromTime());\n  const [textMealInput, setTextMealInput] = useState('');\n  const [nutritionUpdateTimer, setNutritionUpdateTimer] = useState<NodeJS.Timeout | null>(null);\n  const [nutritionUpdateController, setNutritionUpdateController] = useState<AbortController | null>(null);\n  const [nutritionRequestId, setNutritionRequestId] = useState<number>(0);\n  \n  // Review dialog state for voice/text input\n  const [showReviewDialog, setShowReviewDialog] = useState(false);\n  const [reviewAnalysis, setReviewAnalysis] = useState<FoodAnalysis | null>(null);\n  const [reviewDescription, setReviewDescription] = useState('');\n  const [editingFoodIndex, setEditingFoodIndex] = useState<number | null>(null);\n  \n  // Navigation state\n  const [showProfile, setShowProfile] = useState(false);\n  const profileRef = useRef<HTMLDivElement>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  \n  // No voice input functionality on homepage\n  \n  // Barcode scanner state\n  const [showBarcodeScanner, setShowBarcodeScanner] = useState(false);\n  const [showManualEntry, setShowManualEntry] = useState(false);\n  const [scannerMode, setScannerMode] = useState<'barcode' | 'menu'>('barcode');\n  \n  // Shift check-in state\n  const [showShiftCheckIn, setShowShiftCheckIn] = useState(false);\n  \n  \n  // Confetti disabled per user request\n  // const [showPersistentConfetti, setShowPersistentConfetti] = useState(false);\n  \n  \n  // Fetch nutrition goals and diary data for consumed values calculation\n  const { data: nutritionGoals, status: nutritionGoalsStatus } = useQuery<NutritionGoals>({\n    queryKey: ['/api/nutrition-goals'],\n    retry: false,\n    enabled: isAuthenticated, // Enable when authenticated\n    throwOnError: false,\n    refetchOnMount: true, // Always refetch on mount to prevent stale data\n  });\n\n  // Fetch diary and drink data to calculate consumed nutrition\n  const { data: diaryEntries } = useQuery<DiaryEntryWithAnalysis[]>({\n    queryKey: ['/api/diary'],\n    enabled: isAuthenticated,\n    throwOnError: false,\n  });\n\n  const { data: drinkEntries } = useQuery<DrinkEntry[]>({\n    queryKey: ['/api/drinks'],\n    enabled: isAuthenticated,\n    throwOnError: false,\n  });\n\n  // Fetch user profile for shift check-in\n  const { data: userProfile } = useQuery<any>({\n    queryKey: ['/api/user-profile'],\n    enabled: isAuthenticated,\n    throwOnError: false,\n  });\n\n  // Calculate today's consumed nutrition using standardized function\n  const todayConsumedNutrition = diaryEntries && drinkEntries \n    ? calculateTodayNutrition(diaryEntries, drinkEntries)\n    : { calories: 0, protein: 0, carbs: 0, fat: 0, water: 0 };\n  \n  // Use default goals if not set - ensures UI is always visible for all users\n  const defaultGoals: NutritionGoals = {\n    id: 'default',\n    userId: 'default',\n    dailyCalories: 2000,\n    dailyProtein: 150,\n    dailyCarbs: 250,\n    dailyFat: 65,\n    dailyWater: 2000,\n    createdAt: null,\n    updatedAt: null\n  };\n  \n  const activeGoals = nutritionGoals || defaultGoals;\n\n  // Initialize speech recognition\n  useEffect(() => {\n    const checkSpeechSupport = () => {\n      const supported = 'SpeechRecognition' in window || 'webkitSpeechRecognition' in window;\n      setSpeechSupported(supported);\n    };\n    checkSpeechSupport();\n  }, []);\n\n  // Check if shift check-in should be shown\n  useEffect(() => {\n    if (!isAuthenticated || !userProfile) return;\n\n    // Check if daily check-in is enabled\n    if (userProfile.enableDailyShiftCheckIn !== 1) return;\n\n    const today = new Date().toISOString().split('T')[0];\n    \n    // Check if user already dismissed or set shift for today\n    const dismissed = localStorage.getItem(`shift-checkin-dismissed-${today}`);\n    if (dismissed) return;\n\n    // Check if shift was already set for today\n    if (userProfile.todayShiftDate === today && userProfile.todayShiftType) {\n      return;\n    }\n\n    // Show the check-in modal after a short delay\n    const timer = setTimeout(() => {\n      setShowShiftCheckIn(true);\n    }, 1500);\n\n    return () => clearTimeout(timer);\n  }, [isAuthenticated, userProfile]);\n\n  // Check for authentication failure in URL\n  useEffect(() => {\n    const urlParams = new URLSearchParams(window.location.search);\n    if (urlParams.get('auth') === 'failed') {\n      toast({\n        title: \"Sign In Failed\",\n        description: \"There was an issue signing you in. Please try again or create a new Replit account first.\",\n        variant: \"destructive\",\n      });\n      // Clean up URL\n      window.history.replaceState({}, document.title, window.location.pathname);\n    }\n  }, [toast]);\n\n  // Force data refresh when homepage loads/mounts\n  useEffect(() => {\n    if (isAuthenticated) {\n      // Force fresh data fetch whenever homepage component mounts\n      queryClient.invalidateQueries({ queryKey: ['/api/nutrition-goals'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/diary'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/drinks'] });\n    }\n  }, [isAuthenticated, queryClient]);\n\n  // Auto-create default nutrition goals if missing - ONLY after query successfully returns empty\n  useEffect(() => {\n    const createDefaultGoals = async () => {\n      // Only create defaults if query completed successfully and returned no data\n      if (isAuthenticated && nutritionGoalsStatus === 'success' && !nutritionGoals) {\n        try {\n          const response = await apiRequest('POST', '/api/nutrition-goals', {\n            dailyCalories: 2000,\n            dailyProtein: 150,\n            dailyCarbs: 250,\n            dailyFat: 65,\n            dailyWater: 2000\n          });\n          if (response.ok) {\n            queryClient.invalidateQueries({ queryKey: ['/api/nutrition-goals'] });\n            console.log('âœ… Default nutrition goals created');\n          }\n        } catch (error) {\n          console.error('Failed to create default nutrition goals:', error);\n        }\n      }\n    };\n    createDefaultGoals();\n  }, [isAuthenticated, nutritionGoalsStatus, nutritionGoals, queryClient]);\n  \n  // Handle page visibility/navigation\n  useEffect(() => {\n    \n    // Force refresh data when coming back to page (handles browser back/forward cache)\n    const handlePageShow = (event: PageTransitionEvent) => {\n      if (event.persisted && isAuthenticated) {\n        // Page was restored from bfcache, force refresh nutrition goals and diary data\n        queryClient.invalidateQueries({ queryKey: ['/api/nutrition-goals'] });\n        queryClient.invalidateQueries({ queryKey: ['/api/diary'] });\n        queryClient.invalidateQueries({ queryKey: ['/api/drinks'] });\n        queryClient.refetchQueries({ queryKey: ['/api/nutrition-goals'] });\n        queryClient.refetchQueries({ queryKey: ['/api/diary'] });\n        queryClient.refetchQueries({ queryKey: ['/api/drinks'] });\n      }\n    };\n\n    // Refetch data when the page becomes visible (handles navigation back from other pages)\n    const handleVisibilityChange = () => {\n      if (!document.hidden && isAuthenticated) {\n        // Refetch nutrition goals and diary data when page becomes visible\n        queryClient.invalidateQueries({ queryKey: ['/api/nutrition-goals'] });\n        queryClient.invalidateQueries({ queryKey: ['/api/diary'] });\n        queryClient.invalidateQueries({ queryKey: ['/api/drinks'] });\n      }\n    };\n\n    // Also handle when window regains focus\n    const handleFocus = () => {\n      if (isAuthenticated) {\n        queryClient.invalidateQueries({ queryKey: ['/api/nutrition-goals'] });\n        queryClient.invalidateQueries({ queryKey: ['/api/diary'] });\n        queryClient.invalidateQueries({ queryKey: ['/api/drinks'] });\n      }\n    };\n\n    // Listen for page show events (bfcache restoration)\n    window.addEventListener('pageshow', handlePageShow);\n    // Listen for page visibility changes\n    document.addEventListener('visibilitychange', handleVisibilityChange);\n    // Listen for window focus events\n    window.addEventListener('focus', handleFocus);\n    \n    // Cleanup function to clear any pending nutrition updates\n    return () => {\n      window.removeEventListener('pageshow', handlePageShow);\n      document.removeEventListener('visibilitychange', handleVisibilityChange);\n      window.removeEventListener('focus', handleFocus);\n      if (nutritionUpdateTimer) {\n        clearTimeout(nutritionUpdateTimer);\n      }\n      if (nutritionUpdateController) {\n        nutritionUpdateController.abort();\n      }\n    };\n  }, [isAuthenticated, queryClient]);\n\n  // Close profile dropdown when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (profileRef.current && !profileRef.current.contains(event.target as Node)) {\n        setShowProfile(false);\n      }\n    };\n\n    if (showProfile) {\n      document.addEventListener('mousedown', handleClickOutside);\n    }\n\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [showProfile]);\n\n  // No achievement checking or calorie calculation on homepage\n\n  const handleAnalysisStart = () => {\n    soundService.playScan();\n    setCurrentState('processing');\n  };\n\n  const handleAnalysisSuccess = (data: any) => {\n    console.log(\"ðŸ“Š handleAnalysisSuccess called:\", { \n      type: data.type, \n      confidence: data.confidence,\n      hasConfirmationId: !!data.confirmationId,\n      hasSuggestedFoods: !!data.suggestedFoods \n    });\n    \n    // Check if this is a confirmation request (low confidence)\n    if (data.type === 'confirmation_required') {\n      console.log(\"âš ï¸ Low confidence detected, showing confirmation UI:\", data);\n      console.log(\"ðŸ”§ Setting confirmationData:\", {\n        confirmationId: data.confirmationId,\n        suggestedFoodsCount: data.suggestedFoods?.length\n      });\n      soundService.playError(); // Different sound for confirmation needed\n      setConfirmationData(data);\n      setEditableFoods(Array.isArray(data.suggestedFoods) ? [...data.suggestedFoods] : []); // Initialize editable foods safely\n      setCurrentState('confirmation');\n      \n      // Show user-friendly toast about low confidence\n      toast({\n        title: `Low Confidence (${data.confidence}%)`,\n        description: \"AI analysis needs your confirmation. Please review the detected foods.\",\n        duration: 5000,\n      });\n    } else {\n      // Normal high-confidence analysis\n      console.log(\"âœ… High confidence analysis, showing results:\", data);\n      soundService.playSuccess();\n      setAnalysisData(data as FoodAnalysis);\n      setCurrentState('results');\n      // setShowPersistentConfetti(true); // Confetti disabled\n    }\n  };\n\n  const handleAnalysisError = (error: string, errorType: 'food' | 'barcode' = 'food') => {\n    soundService.playError();\n    setErrorMessage(error);\n    setErrorType(errorType);\n    setCurrentState('error');\n  };\n\n  const handleRetry = () => {\n    setCurrentState('camera');\n    setAnalysisData(null);\n    setErrorMessage('');\n    setErrorType('food');\n    setConfirmationData(null);\n  };\n\n  // Gallery selection handlers\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    const inputType = event.target.getAttribute('capture') ? 'camera' : 'gallery';\n    \n    console.log(\"ðŸ“ File selected:\", {\n      hasFile: !!file,\n      fileName: file?.name,\n      fileSize: file?.size,\n      fileType: file?.type,\n      inputType: inputType\n    });\n\n    if (!file) {\n      toast({\n        title: \"No file selected\",\n        description: \"Please select an image file to analyze.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (!file.type.startsWith('image/')) {\n      toast({\n        title: \"Invalid file type\",\n        description: \"Please select an image file (JPG, PNG, etc.)\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    // For gallery selection, scroll to camera section and let camera interface handle the analysis\n    document.getElementById('camera-section')?.scrollIntoView({ behavior: 'smooth' });\n    \n    // The camera interface will handle the analysis when the file is processed\n    // Reset file input\n    event.target.value = '';\n  };\n\n  const handleGallerySelect = () => {\n    // Directly trigger the camera interface's gallery input instead of homepage file input\n    document.getElementById('camera-section')?.scrollIntoView({ behavior: 'smooth' });\n    // Give scroll time to complete, then trigger the camera interface's file input\n    setTimeout(() => {\n      const cameraFileInput = document.querySelector('[data-testid=\"input-file\"]') as HTMLInputElement;\n      if (cameraFileInput) {\n        cameraFileInput.click();\n      }\n    }, 300);\n  };\n\n  const handleCameraCapture = () => {\n    // Directly trigger the camera interface's camera capture instead of trying to click the panel\n    console.log(\"ðŸ“· CAMERA BUTTON CLICKED - Taking photo\");\n    document.getElementById('camera-section')?.scrollIntoView({ behavior: 'smooth' });\n    // Give scroll time to complete, then trigger the camera interface's camera input\n    setTimeout(() => {\n      const cameraInput = document.querySelector('[data-testid=\"input-camera\"]') as HTMLInputElement;\n      if (cameraInput) {\n        cameraInput.click();\n      }\n    }, 300);\n  };\n\n  const handleScanAnother = () => {\n    setCurrentState('camera');\n    setAnalysisData(null);\n    setConfirmationData(null);\n  };\n\n  const handleConfirmAnalysis = async () => {\n    console.log(\"ðŸ”˜ Confirm Analysis button clicked\", {\n      hasConfirmationData: !!confirmationData,\n      confirmationData,\n      editableFoodsCount: editableFoods.length\n    });\n    \n    if (!confirmationData) {\n      console.error(\"âŒ confirmationData is missing!\", { confirmationData });\n      toast({\n        title: \"Missing Data\",\n        description: \"Confirmation data is missing. Please try scanning the image again.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    \n    if (!confirmationData.confirmationId) {\n      console.error(\"âŒ confirmationId is missing!\", { confirmationData });\n      toast({\n        title: \"Invalid Data\",\n        description: \"Confirmation ID is missing. Please try scanning the image again.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    \n    try {\n      console.log(\"ðŸ“¤ Sending PATCH request to /api/food-confirmations/\" + confirmationData.confirmationId);\n      \n      // Call the API to confirm the analysis with edited foods using correct endpoint\n      const response = await apiRequest('PATCH', `/api/food-confirmations/${confirmationData.confirmationId}`, {\n        status: 'confirmed',\n        finalFoods: editableFoods.length > 0 ? editableFoods : confirmationData.suggestedFoods,\n        userFeedback: null\n      });\n      \n      console.log(\"ðŸ“¥ Response received:\", { status: response.status, ok: response.ok });\n      \n      const result = await response.json();\n      console.log(\"âœ… Analysis confirmed successfully:\", result);\n      \n      // Show the confirmed analysis as results - use finalAnalysis if available\n      const analysisToShow = result.finalAnalysis || result.confirmation;\n      soundService.playSuccess();\n      setAnalysisData(analysisToShow);\n      setConfirmationData(null);\n      setEditableFoods([]); // Clear edited foods\n      setEditingIndex(null); // Clear editing state\n      setCurrentState('results');\n      // setShowPersistentConfetti(true); // Confetti disabled\n      \n      toast({\n        title: \"Analysis Confirmed\",\n        description: \"Your food analysis has been confirmed and saved.\",\n      });\n    } catch (error: any) {\n      console.error(\"âŒ Failed to confirm analysis:\", error);\n      toast({\n        title: \"Confirmation Failed\",\n        description: error.message || \"Failed to confirm the analysis. Please try again.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const handleRejectAnalysis = () => {\n    setConfirmationData(null);\n    setEditableFoods([]); // Clear edited foods\n    setEditingIndex(null); // Clear editing state\n    setCurrentState('camera');\n    \n    // Clear any pending nutrition updates\n    if (nutritionUpdateTimer) {\n      clearTimeout(nutritionUpdateTimer);\n      setNutritionUpdateTimer(null);\n    }\n    if (nutritionUpdateController) {\n      nutritionUpdateController.abort();\n      setNutritionUpdateController(null);\n    }\n    \n    toast({\n      title: \"Analysis Rejected\",\n      description: \"You can take a new photo or try again with better lighting.\",\n    });\n  };\n\n  const handleVoiceInput = async () => {\n    if (!speechSupported) {\n      toast({\n        title: \"Speech Not Supported\",\n        description: \"Speech recognition is not supported in this browser\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (isListening) {\n      setIsListening(false);\n      return;\n    }\n\n    try {\n      const recognition = new (window.SpeechRecognition || (window as any).webkitSpeechRecognition)();\n      recognition.continuous = false;\n      recognition.interimResults = false;\n      recognition.lang = 'en-US';\n\n      recognition.onstart = () => {\n        setIsListening(true);\n        toast({\n          title: \"Listening...\",\n          description: \"Say your food item and quantity (e.g., '100g salmon')\",\n        });\n      };\n\n      recognition.onresult = (event: any) => {\n        const transcript = event.results[0][0].transcript;\n        setVoiceInput(transcript);\n        setSelectedMealType(getMealTypeFromTime()); // Recalculate based on current time\n        setShowVoiceMealDialog(true);\n        toast({\n          title: \"Voice captured!\",\n          description: `Heard: \"${transcript}\"`,\n        });\n      };\n\n      recognition.onerror = (event: any) => {\n        console.error('Speech recognition error:', event.error);\n        toast({\n          title: \"Speech Error\",\n          description: \"Could not recognize speech. Please try again.\",\n          variant: \"destructive\",\n        });\n        setIsListening(false);\n      };\n\n      recognition.onend = () => {\n        setIsListening(false);\n      };\n\n      recognition.start();\n    } catch (error) {\n      toast({\n        title: \"Speech Error\",\n        description: \"Failed to start speech recognition\",\n        variant: \"destructive\",\n      });\n      setIsListening(false);\n    }\n  };\n\n  const handleConfirmVoiceMeal = () => {\n    if (!voiceInput.trim()) return;\n    analyzeTextMutation.mutate({\n      foodDescription: voiceInput.trim()\n    });\n  };\n\n  const handleConfirmTextMeal = () => {\n    if (!textInput.trim()) return;\n    analyzeTextMutation.mutate({\n      foodDescription: textInput.trim()\n    });\n  };\n\n  // Step 1: Analyze text (voice or typed) - doesn't save to diary yet\n  const analyzeTextMutation = useMutation({\n    mutationFn: async ({ foodDescription }: { foodDescription: string }) => {\n      // Analyze the text-based food description (send client's local time for timezone-aware analysis)\n      const now = new Date();\n      const hours = now.getHours();\n      const minutes = now.getMinutes();\n      const clientTimeInfo = {\n        hours,\n        minutes,\n        timeString: `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`,\n        timeOfDay: hours < 12 ? 'morning' : hours < 17 ? 'afternoon' : 'evening'\n      };\n      console.log('ðŸ• Sending time to AI:', clientTimeInfo);\n      const analysisResponse = await apiRequest('POST', '/api/analyze-text', { \n        foodDescription,\n        clientTimeInfo \n      });\n      const analysis = await analysisResponse.json();\n      return { analysis, foodDescription };\n    },\n    onSuccess: ({ analysis, foodDescription }) => {\n      // Close input dialogs\n      setShowVoiceMealDialog(false);\n      setShowTextMealDialog(false);\n      \n      // Show review dialog with analysis\n      setReviewAnalysis(analysis);\n      setReviewDescription(foodDescription);\n      setSelectedMealType(getMealTypeFromTime()); // Recalculate based on current time\n      setShowReviewDialog(true);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Analysis Error\",\n        description: error.message || \"Failed to analyze food. Please try again.\",\n        variant: \"destructive\",\n      });\n      console.error(\"Error analyzing text:\", error);\n    },\n  });\n\n  // Step 2: Save to diary after user reviews and confirms\n  const saveToDiaryMutation = useMutation({\n    mutationFn: async ({ analysisId, mealType, notes, updatedFoods }: { \n      analysisId: string, \n      mealType: string, \n      notes: string,\n      updatedFoods?: any[]\n    }) => {\n      // If foods were edited, update the analysis first\n      if (updatedFoods) {\n        await apiRequest('PATCH', `/api/analyses/${analysisId}`, {\n          detectedFoods: updatedFoods\n        });\n      }\n      \n      // Then create diary entry with updated analysis\n      const now = new Date();\n      const diaryResponse = await apiRequest('POST', '/api/diary', {\n        analysisId,\n        mealType,\n        mealDate: now.toISOString(),\n        notes\n      });\n      return await diaryResponse.json();\n    },\n    onSuccess: () => {\n      // Update streak when meal is added\n      const streakData = updateStreak();\n      \n      toast({\n        title: \"Meal Added!\",\n        description: `Your meal has been added to your diary. ${streakData.currentStreak > 0 ? `Streak: ${streakData.currentStreak} days!` : ''}`,\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/diary'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges/points'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges/streak'] });\n      setShowReviewDialog(false);\n      setReviewAnalysis(null);\n      setVoiceInput('');\n      setTextInput('');\n      \n      // Trigger a re-render of the StreakCounter component\n      window.dispatchEvent(new Event('streakUpdated'));\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to add meal. Please try again.\",\n        variant: \"destructive\",\n      });\n      console.error(\"Error adding meal:\", error);\n    },\n  });\n\n  // Debounced nutrition calculation function with race condition protection\n  const updateNutritionValues = useCallback(async (foodsToUpdate: any[], requestId: number) => {\n    try {\n      // Cancel previous request if it exists\n      if (nutritionUpdateController) {\n        nutritionUpdateController.abort();\n      }\n      \n      // Create new AbortController for this request\n      const controller = new AbortController();\n      setNutritionUpdateController(controller);\n      \n      const response = await fetch(buildApiUrl('/api/calculate-nutrition'), {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ foods: foodsToUpdate }),\n        credentials: 'include',\n        signal: controller.signal\n      });\n      \n      if (!response.ok) {\n        throw new Error(`${response.status}: ${response.statusText}`);\n      }\n      \n      const data = await response.json();\n      \n      // Only update if this is still the latest request\n      if (requestId === nutritionRequestId && data.foods) {\n        // Merge nutrition data while preserving current user edits\n        setEditableFoods(currentFoods => {\n          return currentFoods.map((currentFood, index) => {\n            const updatedFood = data.foods[index];\n            if (updatedFood) {\n              // Preserve user-edited name and portion, update only nutrition values\n              return {\n                ...currentFood,\n                calories: updatedFood.calories || currentFood.calories,\n                protein: updatedFood.protein || currentFood.protein,\n                carbs: updatedFood.carbs || currentFood.carbs,\n                fat: updatedFood.fat || currentFood.fat\n              };\n            }\n            return currentFood;\n          });\n        });\n      }\n      \n      // Clear the controller reference\n      setNutritionUpdateController(null);\n    } catch (error: any) {\n      if (error.name === 'AbortError') {\n        console.log('Nutrition request was cancelled');\n        return;\n      }\n      \n      console.error('Failed to update nutrition values:', error);\n      setNutritionUpdateController(null);\n      \n      // Show subtle error indication without disrupting user flow\n      if (error.message && (error.message.includes('401') || error.message.includes('403'))) {\n        console.warn('Authentication required for nutrition updates');\n      }\n    }\n  }, [nutritionUpdateController, nutritionRequestId]);\n\n  // Debounced function to trigger nutrition updates with request versioning\n  const scheduleNutritionUpdate = useCallback((foods: any[]) => {\n    // Clear existing timer\n    if (nutritionUpdateTimer) {\n      clearTimeout(nutritionUpdateTimer);\n    }\n    \n    // Increment request ID for race condition protection\n    const newRequestId = nutritionRequestId + 1;\n    setNutritionRequestId(newRequestId);\n    \n    // Set new timer with 1 second delay\n    const timer = setTimeout(() => {\n      updateNutritionValues(foods, newRequestId);\n    }, 1000);\n    \n    setNutritionUpdateTimer(timer);\n  }, [nutritionUpdateTimer, updateNutritionValues, nutritionRequestId]);\n\n  // Voice and text meal input removed from homepage - only in diary page\n\n  const barcodeMutation = useMutation({\n    mutationFn: async (barcode: string) => {\n      console.log(\"ðŸ” Looking up barcode:\", barcode);\n      \n      const response = await apiRequest('POST', '/api/barcode', { barcode });\n      const result = await response.json();\n      console.log(\"âœ… Barcode lookup successful:\", result);\n      return result;\n    },\n    onMutate: () => {\n      setCurrentState('processing');\n    },\n    onSuccess: (data: FoodAnalysis) => {\n      console.log(\"ðŸŽ‰ Barcode lookup success:\", data);\n      setShowBarcodeScanner(false);\n      handleAnalysisSuccess(data);\n    },\n    onError: (error: Error) => {\n      console.error(\"ðŸ’¥ Barcode lookup error:\", error);\n      \n      // If product not found, fallback to manual entry\n      if (error.message.includes(\"Product not found\") || error.message.includes(\"not found\")) {\n        console.log(\"ðŸ”„ Product not found, opening manual entry fallback\");\n        setShowBarcodeScanner(false);\n        setShowManualEntry(true);\n        toast({\n          title: \"Product Not Found\",\n          description: \"This barcode wasn't found in our database. Please enter the product details manually.\",\n          variant: \"default\",\n        });\n      } else {\n        // Other errors\n        toast({\n          title: \"Barcode Scanner Error\",\n          description: error.message,\n          variant: \"destructive\",\n        });\n        setShowBarcodeScanner(false);\n        handleAnalysisError(error.message, 'barcode');\n      }\n    },\n  });\n\n  const handleBarcodeScanned = (barcode: string) => {\n    // Guard: Ignore empty or invalid barcodes\n    if (!barcode || barcode.trim().length === 0) {\n      console.warn(\"âš ï¸ Empty barcode detected, ignoring\");\n      return;\n    }\n    \n    // If we're in menu mode, only accept URL QR codes\n    if (scannerMode === 'menu') {\n      try {\n        const url = new URL(barcode);\n        // If it's a valid URL, navigate to menu analysis page using wouter\n        if (url.protocol === 'http:' || url.protocol === 'https:') {\n          setShowBarcodeScanner(false);\n          setLocation(`/menu-analysis?url=${encodeURIComponent(barcode)}`);\n          toast({\n            title: \"ðŸ½ï¸ Restaurant Menu Detected!\",\n            description: \"Opening menu scanner...\",\n            duration: 2000,\n          });\n          return;\n        }\n      } catch {\n        // Not a valid URL in menu mode - show error\n        toast({\n          title: \"Invalid QR Code\",\n          description: \"Please scan a restaurant menu QR code with a URL.\",\n          variant: \"destructive\",\n        });\n        return;\n      }\n    }\n    \n    // Barcode mode - check if it's a URL (for backward compatibility)\n    try {\n      const url = new URL(barcode);\n      // If it's a valid URL, navigate to menu analysis page using wouter\n      if (url.protocol === 'http:' || url.protocol === 'https:') {\n        setShowBarcodeScanner(false);\n        setLocation(`/menu-analysis?url=${encodeURIComponent(barcode)}`);\n        toast({\n          title: \"ðŸ½ï¸ Restaurant Menu Detected!\",\n          description: \"Opening menu scanner...\",\n          duration: 2000,\n        });\n        return;\n      }\n    } catch {\n      // Not a URL, continue with barcode lookup\n    }\n    \n    console.log(\"ðŸ“· Barcode scanned on homepage:\", {\n      barcode,\n      length: barcode.length,\n      type: barcode.length === 12 ? 'UPC-A' : barcode.length === 13 ? 'EAN-13' : 'Other'\n    });\n    \n    // Show immediate success feedback\n    toast({\n      title: \"âœ… Barcode Detected!\",\n      description: `Scanning: ${barcode}`,\n      duration: 2000,\n    });\n    \n    barcodeMutation.mutate(barcode);\n  };\n\n  // Listen for manual barcode entry events\n  useEffect(() => {\n    const handleManualBarcodeEvent = () => {\n      setShowBarcodeScanner(false);\n      setShowManualEntry(true);\n    };\n\n    window.addEventListener('open-manual-barcode', handleManualBarcodeEvent);\n    return () => window.removeEventListener('open-manual-barcode', handleManualBarcodeEvent);\n  }, []);\n\n  return (\n    <div className=\"min-h-screen text-foreground\" style={{background: 'var(--bg-gradient)'}}>\n      {/* Offline Status Indicator */}\n      <OfflineIndicator />\n      \n      {/* Profile Reminder Banner */}\n      {isAuthenticated && userProfile && <ProfileReminderBanner userProfile={userProfile} />}\n      \n      {/* Custom Header for New Design */}\n      <div className=\"px-4 pt-8 pb-6 text-center relative\">\n        {/* Navigation Menu - moved above title */}\n        <div className=\"absolute top-4 right-4 flex items-center space-x-2 z-10\">\n          {isAuthenticated ? (\n            <>\n              <Link href=\"/rewards\">\n                <button \n                  className=\"p-2 rounded-xl bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-600 hover:to-orange-600 transition-all duration-200 border border-yellow-400/50 shadow-lg hover:shadow-xl transform hover:scale-105\"\n                  data-testid=\"button-nav-rewards\"\n                  title=\"Rewards & Steps\"\n                >\n                  <Zap className=\"h-4 w-4 text-white\" />\n                </button>\n              </Link>\n              <Link href=\"/diary\">\n                <button \n                  className=\"p-2 rounded-xl bg-white/10 backdrop-blur-sm hover:bg-white/20 transition-all duration-200 border border-white/20\"\n                  data-testid=\"button-nav-history\"\n                  title=\"View Diary\"\n                >\n                  <History className=\"h-4 w-4 text-white\" />\n                </button>\n              </Link>\n              \n              <div className=\"relative\" ref={profileRef}>\n                <button\n                  onClick={() => setShowProfile(!showProfile)}\n                  className=\"flex items-center space-x-1 p-2 rounded-xl bg-white/10 backdrop-blur-sm hover:bg-white/20 transition-all duration-200 border border-white/20\"\n                  data-testid=\"button-nav-profile\"\n                  title=\"Profile\"\n                >\n                  <User className=\"h-4 w-4 text-white\" />\n                  {showProfile ? (\n                    <ChevronUp className=\"h-3 w-3 text-white/80\" />\n                  ) : (\n                    <ChevronDown className=\"h-3 w-3 text-white/80\" />\n                  )}\n                </button>\n                \n                {showProfile && (\n                  <div className=\"absolute top-full right-0 mt-2 bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 p-3 min-w-[200px] backdrop-blur-md z-50\">\n                    <div className=\"flex items-center space-x-2 mb-3\">\n                      <User className=\"h-4 w-4 text-foreground/80\" />\n                      <span className=\"text-sm font-medium text-foreground/90\">\n                        {user?.email || 'User'}\n                      </span>\n                    </div>\n                    {user?.email && (\n                      <div className=\"text-xs text-foreground/60 mb-3 ml-6\">\n                        {user.email}\n                      </div>\n                    )}\n                    <div className=\"border-t border-gray-200 dark:border-gray-700 pt-3\">\n                      <button \n                        onClick={() => {\n                          localStorage.removeItem('auth_token');\n                          localStorage.removeItem('auth_user');\n                          window.location.href = '/';\n                        }}\n                        className=\"flex items-center space-x-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg p-2 transition-colors w-full\" \n                        data-testid=\"button-nav-logout\"\n                      >\n                        <LogOut className=\"h-4 w-4\" />\n                        <span className=\"text-sm font-medium\">Logout</span>\n                      </button>\n                    </div>\n                  </div>\n                )}\n              </div>\n            </>\n          ) : (\n            <button\n              onClick={launchLogin}\n              className=\"flex items-center space-x-2 px-4 py-2 rounded-xl bg-white/10 backdrop-blur-sm hover:bg-white/20 transition-all duration-200 border border-white/20 text-white hover:scale-105 transform\"\n              data-testid=\"button-login\"\n              title=\"Login with Replit\"\n            >\n              <User className=\"h-4 w-4\" />\n              <span className=\"text-sm font-medium\">Login</span>\n            </button>\n          )}\n        </div>\n        \n        <div className=\"mt-8\">\n          <h1 className=\"text-5xl font-bold mb-2 text-white\">PlateMate</h1>\n          <p className=\"text-lg text-white opacity-90\">Voice-powered nutrition companion</p>\n        </div>\n      </div>\n      \n      {/* Step Counter Widget */}\n      {isAuthenticated && currentState === 'camera' && (\n        <div className=\"max-w-md mx-auto px-6 mb-6\">\n          <StepCounterWidget />\n        </div>\n      )}\n\n      {/* Streak Counter */}\n      {isAuthenticated && currentState === 'camera' && (\n        <div className=\"max-w-md mx-auto px-6 mb-6\">\n          <StreakCounter />\n        </div>\n      )}\n\n      {/* All Add Buttons */}\n      {currentState === 'camera' && (\n        <div className=\"max-w-md mx-auto px-4 mb-4\">\n          <div className=\"grid grid-cols-2 gap-3 mb-4\">\n            <button\n              onClick={handleVoiceInput}\n              disabled={!speechSupported}\n              className={`py-3 px-4 rounded-xl font-medium flex items-center justify-center space-x-2 transition-all duration-200 ${\n                isListening\n                  ? 'bg-red-500 text-white'\n                  : speechSupported\n                  ? 'bg-slate-700 text-white hover:bg-slate-600'\n                  : 'bg-gray-400 text-gray-600 cursor-not-allowed'\n              }`}\n              data-testid=\"button-add-voice\"\n              aria-label={isListening ? 'Stop listening for voice input' : 'Add meal using voice input'}\n              aria-disabled={!speechSupported}\n            >\n              {isListening ? (\n                <MicOff className=\"h-4 w-4\" aria-hidden=\"true\" />\n              ) : (\n                <Mic className=\"h-4 w-4\" aria-hidden=\"true\" />\n              )}\n              <span className=\"text-sm\">\n                {isListening ? 'Listening...' : 'Voice Add'}\n              </span>\n            </button>\n            \n            <button\n              onClick={() => {\n                setSelectedMealType(getMealTypeFromTime()); // Recalculate based on current time\n                setShowTextMealDialog(true);\n              }}\n              className=\"py-3 px-4 rounded-xl font-medium flex items-center justify-center space-x-2 transition-all duration-200 bg-blue-600 text-white hover:bg-blue-500\"\n              data-testid=\"button-add-type\"\n              aria-label=\"Add meal by typing description\"\n            >\n              <Plus className=\"h-4 w-4\" aria-hidden=\"true\" />\n              <span className=\"text-sm\">Type</span>\n            </button>\n          </div>\n          \n          <div className=\"grid grid-cols-3 gap-3\">\n            <motion.button\n              onClick={handleCameraCapture}\n              className=\"py-4 px-6 rounded-full font-bold flex items-center justify-center space-x-3 transition-all duration-300 bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:from-blue-700 hover:to-indigo-700 shadow-lg hover:shadow-xl hover:scale-105 transform\"\n              data-testid=\"button-add-camera\"\n              aria-label=\"Take photo of meal with camera\"\n              whileHover={{ scale: 1.05 }}\n              whileTap={{ scale: 0.95 }}\n            >\n              <Camera className=\"h-5 w-5\" aria-hidden=\"true\" />\n              <span className=\"text-sm\">Camera</span>\n            </motion.button>\n            \n            <motion.button\n              onClick={handleGallerySelect}\n              className=\"py-4 px-6 rounded-full font-bold flex items-center justify-center space-x-3 transition-all duration-300 bg-gradient-to-r from-green-600 to-emerald-600 text-white hover:from-green-700 hover:to-emerald-700 shadow-lg hover:shadow-xl hover:scale-105 transform\"\n              data-testid=\"button-add-gallery\"\n              aria-label=\"Select meal photo from gallery\"\n              whileHover={{ scale: 1.05 }}\n              whileTap={{ scale: 0.95 }}\n            >\n              <Images className=\"h-5 w-5\" aria-hidden=\"true\" />\n              <span className=\"text-sm\">Gallery</span>\n            </motion.button>\n            \n            <motion.button\n              onClick={() => {\n                console.log(\"ðŸ” BARCODE BUTTON CLICKED - Opening barcode scanner\");\n                setScannerMode('barcode');\n                setShowBarcodeScanner(true);\n              }}\n              className=\"py-4 px-6 rounded-full font-bold flex items-center justify-center space-x-3 transition-all duration-300 bg-gradient-to-r from-orange-500 to-pink-600 text-white hover:from-orange-600 hover:to-pink-700 shadow-lg hover:shadow-xl hover:scale-105 transform\"\n              data-testid=\"button-add-barcode\"\n              aria-label=\"Scan product barcode to add food\"\n              whileHover={{ scale: 1.05 }}\n              whileTap={{ scale: 0.95 }}\n            >\n              <QrCode className=\"h-5 w-5\" aria-hidden=\"true\" />\n              <span className=\"text-sm\">Barcode</span>\n            </motion.button>\n          </div>\n        </div>\n      )}\n\n      {/* Menu Scanner Button */}\n      {currentState === 'camera' && (\n        <div className=\"max-w-md mx-auto px-6 mb-6\">\n          <Link href=\"/menu-analysis\">\n            <motion.button\n              className=\"w-full bg-gradient-to-r from-purple-600 via-pink-600 to-red-600 hover:from-purple-700 hover:to-red-700 text-white py-4 px-6 rounded-2xl font-bold shadow-xl hover:shadow-2xl transform hover:scale-105 transition-all duration-300 flex items-center justify-center space-x-3 border-2 border-purple-300/50\"\n              data-testid=\"button-menu-scanner\"\n              whileHover={{ scale: 1.05 }}\n              whileTap={{ scale: 0.95 }}\n            >\n              <Camera className=\"h-6 w-6\" />\n              <span className=\"text-lg\">ðŸ“¸ Scan Menu with Camera</span>\n            </motion.button>\n          </Link>\n          <p className=\"text-xs text-center mt-2 text-gray-500 dark:text-gray-400\">\n            Take photos of restaurant menus for AI analysis\n          </p>\n        </div>\n      )}\n\n      {/* Portion Analysis Tip - positioned near camera button */}\n      {currentState === 'camera' && (\n        <div className=\"max-w-md mx-auto px-6 mt-4 mb-6\">\n          <div className=\"text-center\">\n            <p className=\"text-sm text-gray-700 dark:text-gray-300 font-medium bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-2xl px-4 py-3 inline-block\" data-testid=\"text-scale-advice\">\n              ðŸ’¡ For more precise portion analysis, place a fork or your hand in the photo.\n            </p>\n          </div>\n        </div>\n      )}\n\n      {/* Weight Loss Injection Guide */}\n      {currentState === 'camera' && (\n        <div className=\"max-w-md mx-auto px-6 mb-6\">\n          <div className=\"text-center\">\n            <Link href=\"/injection-advice\">\n              <button className=\"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white py-3 px-6 rounded-2xl font-semibold shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300 flex items-center justify-center space-x-2 mx-auto border border-blue-200 backdrop-blur-xl w-full\" data-testid=\"button-injection-advice-quick\">\n              <Syringe className=\"h-5 w-5\" />\n              <span>Weight Loss Injection Guide</span>\n            </button>\n            </Link>\n          </div>\n        </div>\n      )}\n\n      {/* Calories Remaining Box - ALWAYS visible for all users */}\n      {currentState === 'camera' && (\n        <div className=\"max-w-md mx-auto px-6 mb-6\">\n          <div className=\"bg-white dark:bg-gray-800 rounded-3xl p-6 shadow-lg border border-gray-200 dark:border-gray-700\">\n            <div className=\"text-center\">\n              <div className=\"w-20 h-20 mx-auto bg-gradient-to-br from-orange-400 to-red-500 rounded-2xl flex items-center justify-center mb-4\">\n                <motion.div\n                  animate={{\n                    scale: [1, 1.3, 1.1, 1.4, 1],\n                    rotate: [0, -5, 5, -3, 0],\n                    y: [0, -2, 1, -3, 0]\n                  }}\n                  transition={{\n                    duration: 1.5,\n                    repeat: Infinity,\n                    repeatType: \"loop\",\n                    ease: \"easeInOut\"\n                  }}\n                >\n                  <Flame className=\"text-white h-10 w-10\" />\n                </motion.div>\n              </div>\n              <div className=\"text-gray-900 dark:text-gray-100\">\n                <p className=\"text-3xl font-bold\">{Math.max(0, (activeGoals.dailyCalories || 2000) - todayConsumedNutrition.calories)}</p>\n                <p className=\"text-lg font-medium text-gray-600 dark:text-gray-400\">calories remaining</p>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Daily Nutrition Progress - ALWAYS visible for all users */}\n      <div className=\"max-w-md mx-auto px-6 mb-6\">\n        <ProgressIndicators\n          goals={activeGoals}\n          consumed={todayConsumedNutrition}\n        />\n      </div>\n      \n      {/* Weigh In Button */}\n      {currentState === 'camera' && (\n        <div className=\"max-w-md mx-auto px-6 mb-6\">\n          <Link \n            href=\"/diary?tab=weight\"\n            className=\"w-full py-4 px-6 rounded-2xl font-semibold flex items-center justify-center space-x-3 transition-all duration-200 text-white hover:opacity-90 transform hover:scale-105 no-underline\"\n            style={{backgroundColor: '#F97316'}}\n            data-testid=\"button-weigh-in\"\n          >\n            <Scale className=\"h-5 w-5\" />\n            <span className=\"text-base font-bold\">Weigh In</span>\n          </Link>\n        </div>\n      )}\n\n\n\n      <div className=\"max-w-md mx-auto\" id=\"camera-section\">\n        {currentState === 'camera' && (\n          <CameraInterface\n            onAnalysisStart={handleAnalysisStart}\n            onAnalysisSuccess={handleAnalysisSuccess}\n            onAnalysisError={handleAnalysisError}\n            caloriesConsumed={0}\n            caloriesGoal={activeGoals.dailyCalories || 2000}\n          />\n        )}\n\n        {/* Touch to Analyze Instruction - positioned below camera interface */}\n        {currentState === 'camera' && (\n          <div className=\"px-6 mt-4 mb-6\">\n            <div className=\"text-center\">\n              <p className=\"text-sm text-gray-600 dark:text-gray-400 font-medium bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-2xl px-4 py-3 inline-block\" data-testid=\"text-analyze-instruction\">\n                ðŸ“¸ After taking a photo, press the image to analyze your meal\n              </p>\n            </div>\n          </div>\n        )}\n\n        \n        {currentState === 'processing' && <ProcessingState />}\n        \n        {currentState === 'confirmation' && confirmationData && (\n          <div className=\"bg-card rounded-3xl p-6 shadow-2xl border border-border/20\">\n            {/* Confidence Alert */}\n            <div className=\"mb-6 p-4 bg-orange-50 dark:bg-orange-950/30 border border-orange-200 dark:border-orange-800/50 rounded-2xl\">\n              <div className=\"flex items-center space-x-3\">\n                <div className=\"flex-shrink-0\">\n                  <AlertTriangle className=\"h-6 w-6 text-orange-600 dark:text-orange-400\" />\n                </div>\n                <div>\n                  <h3 className=\"text-lg font-semibold text-orange-800 dark:text-orange-200\">\n                    Low Confidence Detection ({confirmationData.confidence}%)\n                  </h3>\n                  <p className=\"text-sm text-orange-700 dark:text-orange-300 mt-1\">\n                    The AI analysis has lower confidence. Please review the detected foods and confirm if they look correct.\n                  </p>\n                </div>\n              </div>\n            </div>\n\n            {/* Image Preview */}\n            {confirmationData.imageUrl && (\n              <div className=\"mb-6\">\n                <img \n                  src={confirmationData.imageUrl} \n                  alt=\"Food to confirm\" \n                  className=\"w-full h-48 object-cover rounded-2xl border border-border/20\"\n                />\n              </div>\n            )}\n\n            {/* Editable Foods */}\n            <div className=\"mb-6\">\n              <h4 className=\"text-lg font-semibold mb-4 flex items-center space-x-2\">\n                <Utensils className=\"h-5 w-5\" />\n                <span>Detected Foods</span>\n              </h4>\n              <div className=\"space-y-3\">\n                {editableFoods.map((food: any, index: number) => (\n                  <div \n                    key={index} \n                    className={`p-3 rounded-xl transition-all ${\n                      editingIndex === index \n                        ? 'bg-primary/10 border-2 border-primary/30' \n                        : 'bg-secondary/50 border border-transparent'\n                    }`}\n                  >\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center space-x-3 flex-1\">\n                        <div className=\"flex-1\">\n                          {editingIndex === index ? (\n                            <input\n                              type=\"text\"\n                              value={food.name}\n                              onChange={(e) => {\n                                const updated = [...editableFoods];\n                                updated[index] = { ...updated[index], name: e.target.value };\n                                setEditableFoods(updated);\n                                scheduleNutritionUpdate(updated);\n                              }}\n                              className=\"w-full px-2 py-1 text-sm border rounded focus:outline-none focus:ring-2 focus:ring-primary/50 bg-background font-medium\"\n                              placeholder=\"e.g., Jacket Potato with Ham and Cheese\"\n                            />\n                          ) : (\n                            <div className=\"flex items-center space-x-2\">\n                              <div className=\"font-medium\">{food.name}</div>\n                              <button\n                                onClick={() => setEditingIndex(index)}\n                                className=\"p-1 text-blue-600 hover:bg-blue-100 rounded opacity-70 hover:opacity-100 transition-opacity\"\n                                title=\"Edit food name\"\n                                data-testid={`button-edit-name-${index}`}\n                              >\n                                <Plus className=\"h-3 w-3\" />\n                              </button>\n                            </div>\n                          )}\n                          {editingIndex === index ? (\n                            <div className=\"flex items-center space-x-2 mt-2\">\n                              <input\n                                type=\"text\"\n                                value={food.portion}\n                                onChange={(e) => {\n                                  const updated = [...editableFoods];\n                                  updated[index] = { ...updated[index], portion: e.target.value };\n                                  setEditableFoods(updated);\n                                  scheduleNutritionUpdate(updated);\n                                }}\n                                className=\"px-2 py-1 text-sm border rounded focus:outline-none focus:ring-2 focus:ring-primary/50 bg-background\"\n                                placeholder=\"e.g., 200g, 1 cup\"\n                              />\n                              <button\n                                onClick={() => setEditingIndex(null)}\n                                className=\"p-1 text-green-600 hover:bg-green-100 rounded\"\n                                data-testid={`button-save-edit-${index}`}\n                              >\n                                <Check className=\"h-4 w-4\" />\n                              </button>\n                              <button\n                                onClick={() => {\n                                  const updated = [...editableFoods];\n                                  updated.splice(index, 1);\n                                  setEditableFoods(updated);\n                                  setEditingIndex(null);\n                                }}\n                                className=\"p-1 text-red-600 hover:bg-red-100 rounded\"\n                                title=\"Remove this food item\"\n                                data-testid={`button-remove-food-${index}`}\n                              >\n                                <X className=\"h-4 w-4\" />\n                              </button>\n                            </div>\n                          ) : (\n                            <div className=\"flex items-center space-x-2\">\n                              <div className=\"text-sm text-muted-foreground\">{food.portion}</div>\n                              <button\n                                onClick={() => setEditingIndex(index)}\n                                className=\"p-1 text-blue-600 hover:bg-blue-100 rounded opacity-70 hover:opacity-100 transition-opacity\"\n                                title=\"Edit portion\"\n                                data-testid={`button-edit-portion-${index}`}\n                              >\n                                <Plus className=\"h-3 w-3\" />\n                              </button>\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                      <div className=\"text-right\">\n                        <div className=\"font-semibold\">{food.calories} cal</div>\n                        <div className=\"text-xs text-muted-foreground\">\n                          {food.protein}g protein\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n              \n              {/* Add Missing Food Button */}\n              <button\n                onClick={() => {\n                  const newFood = {\n                    name: \"New Food Item\",\n                    portion: \"1 serving\",\n                    calories: 0,\n                    protein: 0,\n                    carbs: 0,\n                    fat: 0,\n                    icon: \"utensils\"\n                  };\n                  const updated = [...editableFoods, newFood];\n                  setEditableFoods(updated);\n                  setEditingIndex(editableFoods.length);\n                  scheduleNutritionUpdate(updated);\n                }}\n                className=\"w-full mt-3 py-3 px-4 border-2 border-dashed border-primary/30 text-primary hover:border-primary/50 hover:bg-primary/5 rounded-xl font-medium transition-all flex items-center justify-center space-x-2\"\n                data-testid=\"button-add-missing-food\"\n              >\n                <Plus className=\"h-5 w-5\" />\n                <span>Add Missing Food Item</span>\n              </button>\n            </div>\n\n            {/* Confirmation Actions */}\n            <div className=\"space-y-3\">\n              <button\n                onClick={handleConfirmAnalysis}\n                className=\"w-full bg-green-600 hover:bg-green-700 text-white py-3 px-4 rounded-xl font-medium transition-colors flex items-center justify-center space-x-2\"\n                data-testid=\"button-confirm-analysis\"\n              >\n                <Check className=\"h-5 w-5\" />\n                <span>Confirm Analysis</span>\n              </button>\n              \n              <button\n                onClick={handleRejectAnalysis}\n                className=\"w-full bg-secondary hover:bg-secondary/80 text-secondary-foreground py-3 px-4 rounded-xl font-medium transition-colors flex items-center justify-center space-x-2\"\n                data-testid=\"button-reject-analysis\"\n              >\n                <X className=\"h-5 w-5\" />\n                <span>Take New Photo</span>\n              </button>\n            </div>\n\n            {/* Help Text */}\n            <div className=\"mt-4 p-3 bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800/50 rounded-xl\">\n              <div className=\"flex items-start space-x-2\">\n                <Info className=\"h-4 w-4 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0\" />\n                <div className=\"text-xs text-blue-700 dark:text-blue-300\">\n                  <strong>Tip:</strong> For better accuracy, ensure good lighting and place a reference object (like a fork or coin) in the photo for scale.\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n        \n        {currentState === 'results' && analysisData && (\n          <ResultsDisplay \n            data={analysisData} \n            onScanAnother={handleScanAnother}\n          />\n        )}\n        \n        {currentState === 'error' && (\n          <ErrorState \n            message={errorMessage}\n            onRetry={handleRetry}\n            type={errorType}\n          />\n        )}\n      </div>\n\n      {/* Dashboard with Fluid Tracker - Moved to bottom */}\n      {currentState === 'camera' && (\n        <Dashboard />\n      )}\n      \n      {/* Voice Meal Confirmation Dialog */}\n      {showVoiceMealDialog && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4 backdrop-blur-sm\">\n          <div className=\"bg-card rounded-2xl p-6 w-full max-w-md shadow-2xl border border-border/20\">\n            <h3 className=\"text-xl font-bold mb-6 flex items-center gap-3\">\n              <div className=\"p-2 bg-primary/10 rounded-lg\">\n                <Mic className=\"h-6 w-6 text-primary\" />\n              </div>\n              Add Voice Meal\n            </h3>\n            \n            <div className=\"space-y-6\">\n              {/* Voice Input Display */}\n              <div className=\"bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-950/30 dark:to-indigo-950/30 rounded-xl p-4 border border-blue-200/30 dark:border-blue-700/30\">\n                <label className=\"block text-sm font-semibold mb-3 text-blue-700 dark:text-blue-300\">What you said:</label>\n                <div className=\"bg-gradient-to-r from-white to-blue-50 dark:from-gray-900 dark:to-blue-950/50 p-6 rounded-xl border-3 border-blue-300 dark:border-blue-600 shadow-lg\">\n                  <p className=\"text-2xl font-black text-blue-900 dark:text-blue-100 leading-relaxed text-center tracking-wide\">\n                    \"{voiceInput}\"\n                  </p>\n                </div>\n              </div>\n\n              {/* Meal Type Selection */}\n              <div>\n                <label className=\"block text-sm font-semibold mb-3 text-gray-700 dark:text-gray-300\">Meal Type</label>\n                <div className=\"grid grid-cols-2 gap-3\">\n                  {(['breakfast', 'lunch', 'dinner', 'snack'] as const).map((meal) => (\n                    <button\n                      key={meal}\n                      onClick={() => setSelectedMealType(meal)}\n                      className={`py-3 px-4 rounded-xl text-sm font-bold transition-all duration-200 ${\n                        selectedMealType === meal\n                          ? 'bg-gradient-to-r from-green-500 to-emerald-500 text-white shadow-lg transform scale-105 border-2 border-green-400'\n                          : 'bg-gradient-to-r from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-600 text-gray-700 dark:text-gray-200 hover:from-gray-200 hover:to-gray-300 dark:hover:from-gray-600 dark:hover:to-gray-500 border-2 border-transparent hover:border-gray-300 dark:hover:border-gray-500'\n                      }`}\n                      data-testid={`button-voice-meal-${meal}`}\n                    >\n                      {meal.charAt(0).toUpperCase() + meal.slice(1)}\n                    </button>\n                  ))}\n                </div>\n              </div>\n            </div>\n\n            {/* Dialog Actions */}\n            <div className=\"flex space-x-4 mt-6\">\n              <button\n                onClick={() => setShowVoiceMealDialog(false)}\n                disabled={analyzeTextMutation.isPending}\n                className=\"flex-1 py-3 px-6 border-2 border-gray-300 dark:border-gray-600 rounded-xl font-bold text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-all duration-200 disabled:opacity-50\"\n                data-testid=\"button-cancel-voice-meal\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleConfirmVoiceMeal}\n                disabled={analyzeTextMutation.isPending || !voiceInput.trim()}\n                className=\"flex-1 py-3 px-6 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-xl font-bold hover:from-green-600 hover:to-emerald-600 disabled:opacity-50 transition-all duration-200 shadow-lg\"\n                data-testid=\"button-confirm-voice-meal\"\n              >\n                {analyzeTextMutation.isPending ? 'Analyzing...' : 'Continue'}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Text Meal Dialog */}\n      {showTextMealDialog && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4 backdrop-blur-sm\">\n          <div className=\"bg-card rounded-2xl p-6 w-full max-w-md shadow-2xl border border-border/20\">\n            <h3 className=\"text-xl font-bold mb-6 flex items-center gap-3\">\n              <div className=\"p-2 bg-primary/10 rounded-lg\">\n                <Keyboard className=\"h-6 w-6 text-primary\" />\n              </div>\n              Add Text Meal\n            </h3>\n            \n            <div className=\"space-y-6\">\n              {/* Text Input */}\n              <div>\n                <label className=\"block text-sm font-semibold mb-3 text-gray-700 dark:text-gray-300\">Describe your meal:</label>\n                <textarea\n                  value={textInput}\n                  onChange={(e) => setTextInput(e.target.value)}\n                  placeholder=\"e.g., 200g grilled chicken breast with rice\"\n                  className=\"w-full p-4 border rounded-xl resize-none h-24 text-sm focus:ring-2 focus:ring-primary focus:border-primary\"\n                  data-testid=\"textarea-text-meal\"\n                />\n              </div>\n\n              {/* Meal Type Selection */}\n              <div>\n                <label className=\"block text-sm font-semibold mb-3 text-gray-700 dark:text-gray-300\">Meal Type</label>\n                <div className=\"grid grid-cols-2 gap-3\">\n                  {(['breakfast', 'lunch', 'dinner', 'snack'] as const).map((meal) => (\n                    <button\n                      key={meal}\n                      onClick={() => setSelectedMealType(meal)}\n                      className={`py-3 px-4 rounded-xl text-sm font-bold transition-all duration-200 ${\n                        selectedMealType === meal\n                          ? 'bg-gradient-to-r from-green-500 to-emerald-500 text-white shadow-lg transform scale-105 border-2 border-green-400'\n                          : 'bg-gradient-to-r from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-600 text-gray-700 dark:text-gray-200 hover:from-gray-200 hover:to-gray-300 dark:hover:from-gray-600 dark:hover:to-gray-500 border-2 border-transparent hover:border-gray-300 dark:hover:border-gray-500'\n                      }`}\n                      data-testid={`button-text-meal-${meal}`}\n                    >\n                      {meal.charAt(0).toUpperCase() + meal.slice(1)}\n                    </button>\n                  ))}\n                </div>\n              </div>\n            </div>\n\n            {/* Dialog Actions */}\n            <div className=\"flex space-x-4 mt-6\">\n              <button\n                onClick={() => setShowTextMealDialog(false)}\n                disabled={analyzeTextMutation.isPending}\n                className=\"flex-1 py-3 px-6 border-2 border-gray-300 dark:border-gray-600 rounded-xl font-bold text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-all duration-200 disabled:opacity-50\"\n                data-testid=\"button-cancel-text-meal\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleConfirmTextMeal}\n                disabled={analyzeTextMutation.isPending || !textInput.trim()}\n                className=\"flex-1 py-3 px-6 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-xl font-bold hover:from-green-600 hover:to-emerald-600 disabled:opacity-50 transition-all duration-200 shadow-lg\"\n                data-testid=\"button-confirm-text-meal\"\n              >\n                {analyzeTextMutation.isPending ? 'Analyzing...' : 'Continue'}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Review Dialog - New Design */}\n      {showReviewDialog && reviewAnalysis && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-70 z-50 overflow-y-auto backdrop-blur-sm\">\n          <div className=\"min-h-screen flex items-center justify-center p-4\">\n            <div className=\"bg-gradient-to-br from-purple-900 via-indigo-900 to-blue-900 rounded-3xl p-6 w-full max-w-md shadow-2xl border border-purple-500/30 my-8\">\n            \n            {/* Header */}\n            <div className=\"flex items-start gap-3 mb-6\">\n              <Utensils className=\"h-8 w-8 text-white mt-1\" />\n              <div>\n                <h2 className=\"text-2xl font-bold text-white\">Review Your Meal</h2>\n                <p className=\"text-sm text-purple-200\">Adjust portions and values before saving</p>\n              </div>\n            </div>\n\n            {/* Individual Food Cards */}\n            <div className=\"space-y-4 mb-6\">\n              {reviewAnalysis.detectedFoods.map((food, index) => {\n                const totalMacros = food.protein + food.carbs + food.fat;\n                const proteinPercent = totalMacros > 0 ? (food.protein / totalMacros) * 100 : 0;\n                const carbsPercent = totalMacros > 0 ? (food.carbs / totalMacros) * 100 : 0;\n                const fatPercent = totalMacros > 0 ? (food.fat / totalMacros) * 100 : 0;\n                \n                return (\n                  <div \n                    key={index}\n                    className=\"bg-gradient-to-br from-indigo-800/60 to-blue-800/60 rounded-2xl p-4 border border-blue-400/30 backdrop-blur-sm\"\n                  >\n                    {/* Food Name & Portion - Always Editable */}\n                    <div className=\"mb-3 space-y-2\">\n                      <div>\n                        <label className=\"text-xs text-purple-200 mb-1 block\">Food Name:</label>\n                        <input\n                          type=\"text\"\n                          value={food.name}\n                          onChange={(e) => {\n                            setReviewAnalysis(prev => prev ? {\n                              ...prev,\n                              detectedFoods: prev.detectedFoods.map((f, i) => \n                                i === index ? { ...f, name: e.target.value } : f\n                              )\n                            } : null);\n                          }}\n                          className=\"text-lg font-bold text-white w-full bg-white/10 px-3 py-2 rounded-lg border border-white/20\"\n                          placeholder=\"Food name\"\n                          data-testid={`input-food-name-${index}`}\n                        />\n                      </div>\n                      <div>\n                        <label className=\"text-xs text-purple-200 mb-1 block\">Portion:</label>\n                        <Select\n                          value={food.portion || '100g'}\n                          onValueChange={(newPortion) => {\n                            const currentGrams = portionToGrams(food.portion || '100g');\n                            const newGrams = portionToGrams(newPortion);\n                            const scaleFactor = newGrams / currentGrams;\n                            \n                            const updatedFoods = reviewAnalysis.detectedFoods.map((f, i) => {\n                              if (i !== index) return f;\n                              return {\n                                ...f,\n                                portion: newPortion,\n                                calories: Math.round(f.calories * scaleFactor),\n                                protein: Math.round(f.protein * scaleFactor),\n                                carbs: Math.round(f.carbs * scaleFactor),\n                                fat: Math.round(f.fat * scaleFactor)\n                              };\n                            });\n                            \n                            setReviewAnalysis({\n                              ...reviewAnalysis,\n                              detectedFoods: updatedFoods,\n                              totalCalories: updatedFoods.reduce((sum, f) => sum + f.calories, 0),\n                              totalProtein: updatedFoods.reduce((sum, f) => sum + f.protein, 0),\n                              totalCarbs: updatedFoods.reduce((sum, f) => sum + f.carbs, 0),\n                              totalFat: updatedFoods.reduce((sum, f) => sum + f.fat, 0)\n                            });\n                          }}\n                        >\n                          <SelectTrigger className=\"text-sm text-white w-full bg-white/10 px-3 py-1.5 rounded-lg border border-white/20\" data-testid={`select-food-portion-${index}`}>\n                            <SelectValue placeholder=\"Select portion\" />\n                          </SelectTrigger>\n                          <SelectContent>\n                            {getPortionOptions(food.name, food.portion || '100g').map((option) => (\n                              <SelectItem key={option} value={option} data-testid={`option-portion-${option}`}>\n                                {option}\n                              </SelectItem>\n                            ))}\n                          </SelectContent>\n                        </Select>\n                      </div>\n                    </div>\n                    \n                    {/* Nutrition Values - Always Editable */}\n                    <div className=\"grid grid-cols-2 gap-3 mb-3\">\n                      {/* Calories */}\n                      <div>\n                        <label className=\"text-xs text-purple-200 mb-1 block\">Calories:</label>\n                        <input\n                          type=\"number\"\n                          value={food.calories}\n                          onChange={(e) => {\n                            const newCalories = parseInt(e.target.value) || 0;\n                            setReviewAnalysis(prev => prev ? {\n                              ...prev,\n                              detectedFoods: prev.detectedFoods.map((f, i) => \n                                i === index ? { ...f, calories: newCalories } : f\n                              ),\n                              totalCalories: prev.detectedFoods.reduce((sum, f, i) => \n                                sum + (i === index ? newCalories : f.calories), 0\n                              )\n                            } : null);\n                          }}\n                          className=\"w-full bg-white/10 rounded-lg px-3 py-2 text-center text-2xl font-bold text-orange-400 border border-white/20\"\n                          data-testid={`input-food-calories-${index}`}\n                        />\n                      </div>\n                      \n                      {/* Protein */}\n                      <div>\n                        <label className=\"text-xs text-purple-200 mb-1 block\">Protein (g):</label>\n                        <input\n                          type=\"number\"\n                          value={food.protein}\n                          onChange={(e) => {\n                            const newProtein = parseInt(e.target.value) || 0;\n                            setReviewAnalysis(prev => prev ? {\n                              ...prev,\n                              detectedFoods: prev.detectedFoods.map((f, i) => \n                                i === index ? { ...f, protein: newProtein } : f\n                              ),\n                              totalProtein: prev.detectedFoods.reduce((sum, f, i) => \n                                sum + (i === index ? newProtein : f.protein), 0\n                              )\n                            } : null);\n                          }}\n                          className=\"w-full bg-white/10 rounded-lg px-3 py-2 text-center text-2xl font-bold text-blue-400 border border-white/20\"\n                          data-testid={`input-food-protein-${index}`}\n                        />\n                      </div>\n                      \n                      {/* Carbs */}\n                      <div>\n                        <label className=\"text-xs text-purple-200 mb-1 block\">Carbs (g):</label>\n                        <input\n                          type=\"number\"\n                          value={food.carbs}\n                          onChange={(e) => {\n                            const newCarbs = parseInt(e.target.value) || 0;\n                            setReviewAnalysis(prev => prev ? {\n                              ...prev,\n                              detectedFoods: prev.detectedFoods.map((f, i) => \n                                i === index ? { ...f, carbs: newCarbs } : f\n                              ),\n                              totalCarbs: prev.detectedFoods.reduce((sum, f, i) => \n                                sum + (i === index ? newCarbs : f.carbs), 0\n                              )\n                            } : null);\n                          }}\n                          className=\"w-full bg-white/10 rounded-lg px-3 py-2 text-center text-2xl font-bold text-yellow-400 border border-white/20\"\n                          data-testid={`input-food-carbs-${index}`}\n                        />\n                      </div>\n                      \n                      {/* Fat */}\n                      <div>\n                        <label className=\"text-xs text-purple-200 mb-1 block\">Fat (g):</label>\n                        <input\n                          type=\"number\"\n                          value={food.fat}\n                          onChange={(e) => {\n                            const newFat = parseInt(e.target.value) || 0;\n                            setReviewAnalysis(prev => prev ? {\n                              ...prev,\n                              detectedFoods: prev.detectedFoods.map((f, i) => \n                                i === index ? { ...f, fat: newFat } : f\n                              ),\n                              totalFat: prev.detectedFoods.reduce((sum, f, i) => \n                                sum + (i === index ? newFat : f.fat), 0\n                              )\n                            } : null);\n                          }}\n                          className=\"w-full bg-white/10 rounded-lg px-3 py-2 text-center text-2xl font-bold text-green-400 border border-white/20\"\n                          data-testid={`input-food-fat-${index}`}\n                        />\n                      </div>\n                    </div>\n                    \n                    {/* Macro Bar Chart */}\n                    <div className=\"flex h-2 rounded-full overflow-hidden bg-purple-950/50\">\n                      <div \n                        className=\"bg-blue-500\" \n                        style={{ width: `${proteinPercent}%` }}\n                      />\n                      <div \n                        className=\"bg-yellow-500\" \n                        style={{ width: `${carbsPercent}%` }}\n                      />\n                      <div \n                        className=\"bg-green-500\" \n                        style={{ width: `${fatPercent}%` }}\n                      />\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n\n            {/* Total Nutrition */}\n            <div className=\"bg-gradient-to-br from-indigo-800/60 to-blue-800/60 rounded-2xl p-4 border border-blue-400/30 backdrop-blur-sm mb-6\">\n              <h3 className=\"text-lg font-semibold text-white mb-3\">Total Nutrition</h3>\n              <div className=\"flex items-center justify-between gap-3\">\n                {/* Total Calories Pill */}\n                <div className=\"bg-gradient-to-r from-orange-500 to-red-500 rounded-full px-4 py-2 flex items-center gap-2\">\n                  <span className=\"text-2xl\">ðŸ”¥</span>\n                  <div>\n                    <div className=\"text-2xl font-bold text-white\">{reviewAnalysis.totalCalories}</div>\n                    <div className=\"text-xs text-white/90\">cal</div>\n                  </div>\n                </div>\n                \n                {/* Protein */}\n                <div className=\"flex-1 text-center\">\n                  <div className=\"text-2xl font-bold text-blue-400\">{reviewAnalysis.totalProtein}g</div>\n                  <div className=\"text-xs text-purple-200\">protein</div>\n                </div>\n                \n                {/* Carbs */}\n                <div className=\"flex-1 text-center\">\n                  <div className=\"text-2xl font-bold text-yellow-400\">{reviewAnalysis.totalCarbs}g</div>\n                  <div className=\"text-xs text-purple-200\">carbs</div>\n                </div>\n                \n                {/* Fat */}\n                <div className=\"flex-1 text-center\">\n                  <div className=\"text-2xl font-bold text-green-400\">{reviewAnalysis.totalFat}g</div>\n                  <div className=\"text-xs text-purple-200\">fat</div>\n                </div>\n              </div>\n            </div>\n\n            {/* Meal Type and Save Buttons - 2x2 Grid */}\n            <div className=\"grid grid-cols-2 gap-3 mb-4\">\n              <button\n                onClick={() => setSelectedMealType('breakfast')}\n                className={`py-4 rounded-2xl font-bold text-base transition-all ${\n                  selectedMealType === 'breakfast'\n                    ? 'bg-gradient-to-r from-purple-600 to-purple-700 text-white shadow-lg scale-105'\n                    : 'bg-indigo-800/40 text-purple-200 hover:bg-indigo-800/60 border border-purple-500/30'\n                }`}\n                data-testid=\"button-review-meal-breakfast\"\n              >\n                Breakfast\n              </button>\n              <button\n                onClick={() => setSelectedMealType('lunch')}\n                className={`py-4 rounded-2xl font-bold text-base transition-all ${\n                  selectedMealType === 'lunch'\n                    ? 'bg-gradient-to-r from-purple-600 to-purple-700 text-white shadow-lg scale-105'\n                    : 'bg-indigo-800/40 text-purple-200 hover:bg-indigo-800/60 border border-purple-500/30'\n                }`}\n                data-testid=\"button-review-meal-lunch\"\n              >\n                Lunch\n              </button>\n              <button\n                onClick={() => setSelectedMealType('dinner')}\n                className={`py-4 rounded-2xl font-bold text-base transition-all ${\n                  selectedMealType === 'dinner'\n                    ? 'bg-gradient-to-r from-purple-600 to-purple-700 text-white shadow-lg scale-105'\n                    : 'bg-indigo-800/40 text-purple-200 hover:bg-indigo-800/60 border border-purple-500/30'\n                }`}\n                data-testid=\"button-review-meal-dinner\"\n              >\n                Dinner\n              </button>\n              <button\n                onClick={() => {\n                  saveToDiaryMutation.mutate({\n                    analysisId: reviewAnalysis.id,\n                    mealType: selectedMealType,\n                    notes: `Added via text/voice: \"${reviewDescription}\"`,\n                    updatedFoods: reviewAnalysis.detectedFoods\n                  });\n                }}\n                disabled={saveToDiaryMutation.isPending}\n                className=\"py-4 rounded-2xl font-bold text-base bg-gradient-to-r from-pink-500 to-pink-600 text-white shadow-lg hover:from-pink-600 hover:to-pink-700 transition-all disabled:opacity-50\"\n                data-testid=\"button-save-to-diary\"\n              >\n                {saveToDiaryMutation.isPending ? 'Saving...' : 'Save to Diary'}\n              </button>\n            </div>\n\n            {/* Cancel Button */}\n            <button\n              onClick={() => {\n                setShowReviewDialog(false);\n                setReviewAnalysis(null);\n                setEditingFoodIndex(null);\n              }}\n              disabled={saveToDiaryMutation.isPending}\n              className=\"w-full py-4 rounded-2xl font-bold text-base bg-indigo-800/40 text-purple-200 hover:bg-indigo-800/60 border border-purple-500/30 transition-all disabled:opacity-50\"\n              data-testid=\"button-cancel-review\"\n            >\n              Cancel\n            </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Dropdown Navigation */}\n      <DropdownNavigation />\n      \n      {/* Bottom Help Section */}\n      <BottomHelpSection />\n      \n\n      {/* Camera Barcode Scanner Modal */}\n      <ScannerModal\n        isOpen={showBarcodeScanner}\n        mode={scannerMode}\n        onScanSuccess={(barcode: string) => {\n          handleBarcodeScanned(barcode);\n        }}\n        onClose={() => {\n          setShowBarcodeScanner(false);\n        }}\n      />\n\n      {/* Manual Barcode Entry */}\n      <BarcodeScanner\n        isOpen={showManualEntry}\n        onScanSuccess={(barcode: string) => {\n          setShowManualEntry(false);\n          handleBarcodeScanned(barcode);\n        }}\n        onClose={() => {\n          setShowManualEntry(false);\n        }}\n      />\n\n      {/* Shift Check-In Modal */}\n      <ShiftCheckInModal\n        isOpen={showShiftCheckIn}\n        onClose={() => setShowShiftCheckIn(false)}\n      />\n\n      {/* Hidden file input for gallery */}\n      <input\n        ref={fileInputRef}\n        type=\"file\"\n        accept=\"image/*\"\n        onChange={handleFileSelect}\n        className=\"hidden\"\n        data-testid=\"input-file-gallery\"\n      />\n\n      {/* Confetti celebration disabled per user request */}\n    </div>\n  );\n}\n","size_bytes":84349},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","size_bytes":791},"client/src/components/results-display.tsx":{"content":"import { Share2, Bookmark, Plus, Camera, Utensils, PieChart, Calendar, Clock, AlertTriangle, Info, Zap, Edit3, Check, X, Minus, Trash2, Mic, MicOff, ArrowLeft } from \"lucide-react\";\nimport type { FoodAnalysis, DetectedFood } from \"@shared/schema\";\nimport { useState, useEffect, useCallback, useMemo, useRef } from \"react\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { motion } from \"framer-motion\";\nimport { updateStreak } from \"@/lib/streak-tracker\";\nimport { soundService } from \"@/lib/sound-service\";\nimport { buildApiUrl } from '@/lib/api-config';\n\n// Extended food item with baseline data for editing\ninterface EditableFood extends DetectedFood {\n  baselinePortionValue: number;\n  baselinePortionUnit: string;\n  baselineCalories: number;\n  baselineProtein: number;\n  baselineCarbs: number;\n  baselineFat: number;\n}\n\ninterface ResultsDisplayProps {\n  data: FoodAnalysis;\n  onScanAnother: () => void;\n}\n\n// Helper function to parse portion string and extract numeric value and unit\nfunction parsePortionString(portion: string): { value: number; unit: string } | null {\n  // Remove extra spaces and lowercase for matching\n  const cleaned = portion.trim().toLowerCase();\n  \n  // Comprehensive list of units (including both abbreviated and full forms)\n  const units = 'servings?|srv|cups?|tablespoons?|tbsp|teaspoons?|tsp|ounces?|oz|pounds?|lbs?|grams?|g|kilograms?|kg|milliliters?|ml|liters?|l|slices?|pieces?|pcs?|items?';\n  \n  // First, strip generic filler words (of, a, an) appearing before units\n  // This handles \"one of cup\", \"half a cup\", \"two of tablespoons\" etc.\n  let normalized = cleaned;\n  const fillerPattern = new RegExp(`\\\\s+(?:of|a|an)\\\\s+(?=${units})`, 'gi');\n  normalized = normalized.replace(fillerPattern, ' ');\n  \n  // Word to number mapping for common numerals (excluding \"a\" and \"an\" as they're fillers)\n  const wordToNumber: { [key: string]: number } = {\n    'zero': 0, 'one': 1, 'two': 2, 'three': 3, 'four': 4, 'five': 5,\n    'six': 6, 'seven': 7, 'eight': 8, 'nine': 9, 'ten': 10,\n    'half': 0.5, 'quarter': 0.25, 'third': 0.33\n  };\n  \n  // Replace word numerals with digits\n  Object.keys(wordToNumber).forEach(word => {\n    const pattern = new RegExp(`\\\\b${word}\\\\b`, 'gi');\n    normalized = normalized.replace(pattern, wordToNumber[word].toString());\n  });\n  \n  // Common unit patterns (prioritize longer matches first)\n  const unitPatterns = [\n    { regex: /(\\d+(?:\\.\\d+)?)\\s*(?:servings?|srv)/i, unit: 'serving' },\n    { regex: /(\\d+(?:\\.\\d+)?)\\s*(?:cups?)/i, unit: 'cup' },\n    { regex: /(\\d+(?:\\.\\d+)?)\\s*(?:tablespoons?|tbsp)/i, unit: 'tbsp' },\n    { regex: /(\\d+(?:\\.\\d+)?)\\s*(?:teaspoons?|tsp)/i, unit: 'tsp' },\n    { regex: /(\\d+(?:\\.\\d+)?)\\s*(?:ounces?|oz)/i, unit: 'oz' },\n    { regex: /(\\d+(?:\\.\\d+)?)\\s*(?:pounds?|lbs?)/i, unit: 'lb' },\n    { regex: /(\\d+(?:\\.\\d+)?)\\s*(?:grams?|g)(?:\\s|$|,)/i, unit: 'g' },\n    { regex: /(\\d+(?:\\.\\d+)?)\\s*(?:kilograms?|kg)/i, unit: 'kg' },\n    { regex: /(\\d+(?:\\.\\d+)?)\\s*(?:milliliters?|ml)/i, unit: 'ml' },\n    { regex: /(\\d+(?:\\.\\d+)?)\\s*(?:liters?|l)(?:\\s|$|,)/i, unit: 'L' },\n    { regex: /(\\d+(?:\\.\\d+)?)\\s*(?:slices?)/i, unit: 'slice' },\n    { regex: /(\\d+(?:\\.\\d+)?)\\s*(?:pieces?|pcs?)/i, unit: 'piece' },\n    { regex: /(\\d+(?:\\.\\d+)?)\\s*(?:items?)/i, unit: 'item' },\n  ];\n  \n  // Try to match each pattern\n  for (const { regex, unit } of unitPatterns) {\n    const match = normalized.match(regex);\n    if (match && match[1]) {\n      return { value: parseFloat(match[1]), unit };\n    }\n  }\n  \n  // Fallback: just grab the first number\n  const numMatch = normalized.match(/(\\d+(?:\\.\\d+)?)/);\n  if (numMatch && numMatch[1]) {\n    return { value: parseFloat(numMatch[1]), unit: 'g' }; // default to grams\n  }\n  \n  // Return null if no portion detected (instead of defaulting to 100g)\n  return null;\n}\n\n// Helper function to initialize editable food with baseline data\nfunction initializeEditableFood(food: DetectedFood): EditableFood {\n  const parsed = parsePortionString(food.portion);\n  const { value, unit } = parsed || { value: 100, unit: 'g' };\n  \n  return {\n    ...food,\n    baselinePortionValue: value,\n    baselinePortionUnit: unit,\n    baselineCalories: food.calories,\n    baselineProtein: food.protein,\n    baselineCarbs: food.carbs,\n    baselineFat: food.fat,\n  };\n}\n\n// Helper function to strip baseline data before sending to server\nfunction stripBaselineData(editableFood: EditableFood): DetectedFood {\n  const { baselinePortionValue, baselinePortionUnit, baselineCalories, baselineProtein, baselineCarbs, baselineFat, ...detectedFood } = editableFood;\n  return detectedFood as DetectedFood;\n}\n\nexport function ResultsDisplay({ data, onScanAnother }: ResultsDisplayProps) {\n  const [showDiaryDialog, setShowDiaryDialog] = useState(false);\n  const [selectedMealType, setSelectedMealType] = useState<\"breakfast\" | \"lunch\" | \"dinner\" | \"snack\">(\"lunch\");\n  const [selectedDate, setSelectedDate] = useState(new Date().toISOString().split('T')[0]);\n  const [selectedTime, setSelectedTime] = useState(new Date().toTimeString().slice(0, 5));\n  const [editableFoods, setEditableFoods] = useState<EditableFood[]>(\n    data.detectedFoods.map(initializeEditableFood)\n  );\n  const [editingIndex, setEditingIndex] = useState<number | null>(null);\n  const [editingField, setEditingField] = useState<{ index: number; field: string; value: string } | null>(null);\n  const [editingSummary, setEditingSummary] = useState<{ field: 'calories' | 'protein' | 'carbs' | 'fat'; value: string } | null>(null);\n  const [isListening, setIsListening] = useState(false);\n  const [speechSupported, setSpeechSupported] = useState(false);\n  const [voiceInput, setVoiceInput] = useState('');\n  const [voiceFoodName, setVoiceFoodName] = useState('');\n  const [voicePortionAmount, setVoicePortionAmount] = useState('100');\n  const [voicePortionUnit, setVoicePortionUnit] = useState('g');\n  const [showVoiceMealDialog, setShowVoiceMealDialog] = useState(false);\n  const [showManualEntryDialog, setShowManualEntryDialog] = useState(false);\n  const [manualFoodName, setManualFoodName] = useState('');\n  const [manualPortionAmount, setManualPortionAmount] = useState('100');\n  const [manualPortionUnit, setManualPortionUnit] = useState('g');\n  const [recognitionInstance, setRecognitionInstance] = useState<any>(null);\n  const [showLowConfidenceDialog, setShowLowConfidenceDialog] = useState(false);\n  const [nutritionUpdateTimer, setNutritionUpdateTimer] = useState<NodeJS.Timeout | null>(null);\n  const [lastRequestFoods, setLastRequestFoods] = useState<string>('');\n  // Local state for portion input values (allows free typing)\n  const [portionInputValues, setPortionInputValues] = useState<{[key: number]: string}>({});\n  \n  // Use refs for values that don't need to trigger re-renders\n  const nutritionUpdateControllerRef = useRef<AbortController | null>(null);\n  const nutritionRequestIdRef = useRef<number>(0);\n  \n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  // Check speech recognition support\n  useEffect(() => {\n    const checkSpeechSupport = () => {\n      const supported = 'SpeechRecognition' in window || 'webkitSpeechRecognition' in window;\n      setSpeechSupported(supported);\n    };\n    checkSpeechSupport();\n    \n    // Cleanup function to clear any pending nutrition updates\n    return () => {\n      if (nutritionUpdateTimer) {\n        clearTimeout(nutritionUpdateTimer);\n      }\n      if (nutritionUpdateControllerRef.current) {\n        nutritionUpdateControllerRef.current.abort();\n      }\n    };\n  }, []);\n\n  // Check for low confidence on mount\n  useEffect(() => {\n    if (!data.isAITemporarilyUnavailable && data.confidence < 90) {\n      setShowLowConfidenceDialog(true);\n    }\n  }, [data.confidence, data.isAITemporarilyUnavailable]);\n\n  // Handle voice input for adding food items\n  const handleVoiceInput = async () => {\n    if (!speechSupported) {\n      toast({\n        title: \"Speech Not Supported\",\n        description: \"Speech recognition is not supported in this browser\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    // If already listening, stop the recording\n    if (isListening && recognitionInstance) {\n      try {\n        // Force immediate stop with state cleanup\n        setIsListening(false);\n        setRecognitionInstance(null);\n        \n        recognitionInstance.abort(); // Use abort() for immediate termination\n      } catch (error) {\n        try {\n          recognitionInstance.stop();\n        } catch (stopError) {\n          // Ignore errors, we're stopping anyway\n        }\n        // Ensure state is cleared even if abort/stop fails\n        setIsListening(false);\n        setRecognitionInstance(null);\n      }\n      \n      toast({\n        title: \"Voice Recording Stopped\",\n        description: \"Speech recognition has been stopped\",\n      });\n      return;\n    }\n\n    try {\n      const recognition = new (window.SpeechRecognition || (window as any).webkitSpeechRecognition)();\n      recognition.continuous = false;\n      recognition.interimResults = false;\n      recognition.lang = 'en-US';\n\n      recognition.onstart = () => {\n        setIsListening(true);\n        toast({\n          title: \"Listening...\",\n          description: \"Say your food item and quantity (e.g., '100g salmon')\",\n        });\n      };\n\n      recognition.onresult = (event: any) => {\n        const transcript = event.results[0][0].transcript;\n        setVoiceInput(transcript);\n        \n        // Try to parse portion from transcript (e.g., \"200g chicken\", \"1 cup rice\", \"one cup rice\")\n        const parsed = parsePortionString(transcript);\n        \n        if (parsed) {\n          // Portion detected - extract food name (remove portion from start if present)\n          // General pattern that handles any combination of:\n          // (number/word) [optional space] [optional fillers] (unit) [optional \"of\"] (food name)\n          // Examples: \"200g chicken\", \"200 g chicken\", \"one cup rice\", \"half a cup of milk\", \"two tablespoons sugar\"\n          const portionPattern = new RegExp(\n            `^(?:\\\\d+(?:\\\\.\\\\d+)?|zero|one|two|three|four|five|six|seven|eight|nine|ten|half|quarter|third)` + // number or word\n            `\\\\s*(?:of\\\\s+|a\\\\s+|an\\\\s+)*` + // optional whitespace and fillers\n            `(?:servings?|srv|cups?|tablespoons?|tbsp|teaspoons?|tsp|ounces?|oz|pounds?|lbs?|grams?|g|kilograms?|kg|milliliters?|ml|liters?|l|slices?|pieces?|pcs?|items?)` + // unit (full forms included)\n            `\\\\s*(?:of\\\\s+)?` + // optional whitespace and \"of\" after unit\n            `(.+)$`, // food name\n            'i'\n          );\n          \n          const match = transcript.match(portionPattern);\n          const foodName = match && match[1] ? match[1].trim() : transcript;\n          \n          setVoiceFoodName(foodName);\n          setVoicePortionAmount(parsed.value.toString());\n          setVoicePortionUnit(parsed.unit);\n        } else {\n          // No portion detected - use original transcript as food name\n          setVoiceFoodName(transcript);\n          setVoicePortionAmount('100');\n          setVoicePortionUnit('g');\n        }\n        \n        setShowVoiceMealDialog(true);\n        toast({\n          title: \"Voice captured!\",\n          description: `Heard: \"${transcript}\"`,\n        });\n        setIsListening(false);\n        setRecognitionInstance(null);\n      };\n\n      recognition.onerror = (event: any) => {\n        console.error('Speech recognition error:', event.error);\n        \n        // Don't show error for aborted (user stopped)\n        if (event.error !== 'aborted') {\n          toast({\n            title: \"Speech Error\",\n            description: \"Could not recognize speech. Please try again.\",\n            variant: \"destructive\",\n          });\n        }\n        setIsListening(false);\n        setRecognitionInstance(null);\n      };\n\n      recognition.onend = () => {\n        setIsListening(false);\n        setRecognitionInstance(null);\n      };\n\n      // Store the recognition instance so we can stop it later\n      setRecognitionInstance(recognition);\n      recognition.start();\n    } catch (error) {\n      toast({\n        title: \"Speech Error\",\n        description: \"Failed to start speech recognition\",\n        variant: \"destructive\",\n      });\n      setIsListening(false);\n      setRecognitionInstance(null);\n    }\n  };\n\n  // Function to update portion for a specific food item using numeric value\n  const updateFoodPortionValue = (index: number, newValue: number) => {\n    const updatedFoods = [...editableFoods];\n    const currentFood = editableFoods[index];\n    \n    // Guard against division by zero or invalid baseline\n    if (!currentFood.baselinePortionValue || currentFood.baselinePortionValue <= 0) {\n      console.warn('Invalid baseline portion value, skipping update');\n      return;\n    }\n    \n    // Calculate multiplier from baseline value\n    const multiplier = newValue / currentFood.baselinePortionValue;\n    \n    // Clamp multiplier to reasonable range (0.01x to 100x)\n    const clampedMultiplier = Math.max(0.01, Math.min(100, multiplier));\n    \n    // Update display portion string with spacing\n    const newPortionString = `${newValue} ${currentFood.baselinePortionUnit}`;\n    \n    // Update nutrition values based on baseline\n    updatedFoods[index] = {\n      ...currentFood,\n      portion: newPortionString,\n      calories: Math.round(currentFood.baselineCalories * clampedMultiplier),\n      protein: Math.round(currentFood.baselineProtein * clampedMultiplier * 10) / 10,\n      carbs: Math.round(currentFood.baselineCarbs * clampedMultiplier * 10) / 10,\n      fat: Math.round(currentFood.baselineFat * clampedMultiplier * 10) / 10,\n    };\n    \n    setEditableFoods(updatedFoods);\n    scheduleNutritionUpdate(updatedFoods);\n  };\n  \n  // Function to update portion unit\n  const updateFoodPortionUnit = (index: number, newUnit: string) => {\n    const updatedFoods = [...editableFoods];\n    const currentFood = editableFoods[index];\n    \n    // Extract current numeric value from portion\n    const parsed = parsePortionString(currentFood.portion);\n    const currentValue = parsed ? parsed.value : currentFood.baselinePortionValue || 100;\n    \n    // Update portion string with new unit (with spacing)\n    updatedFoods[index] = {\n      ...currentFood,\n      portion: `${currentValue} ${newUnit}`,\n      baselinePortionUnit: newUnit,\n    };\n    \n    setEditableFoods(updatedFoods);\n    // Trigger nutrition recalculation with new unit - server will update baseline\n    scheduleNutritionUpdate(updatedFoods);\n  };\n\n  // Debounced nutrition calculation function with race condition protection\n  const updateNutritionValues = useCallback(async (foodsToUpdate: DetectedFood[], requestId: number) => {\n    try {\n      // Cancel previous request if it exists\n      if (nutritionUpdateControllerRef.current) {\n        nutritionUpdateControllerRef.current.abort();\n      }\n      \n      // Create new AbortController for this request\n      const controller = new AbortController();\n      nutritionUpdateControllerRef.current = controller;\n      \n      const response = await fetch(buildApiUrl('/api/calculate-nutrition'), {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ foods: foodsToUpdate }),\n        credentials: 'include',\n        signal: controller.signal\n      });\n      \n      if (!response.ok) {\n        throw new Error(`${response.status}: ${response.statusText}`);\n      }\n      \n      const nutritionData = await response.json();\n      \n      // Only update if this is still the latest request (using ref for fresh comparison)\n      if (requestId === nutritionRequestIdRef.current && nutritionData.foods) {\n        // Merge nutrition data while preserving current user edits and updating baseline\n        setEditableFoods(currentFoods => {\n          return currentFoods.map((currentFood, index) => {\n            const updatedFood = nutritionData.foods[index];\n            if (updatedFood) {\n              // Update both displayed and baseline nutrition values from server\n              const parsed = parsePortionString(updatedFood.portion);\n              const { value, unit } = parsed || { value: 100, unit: 'g' };\n              return {\n                ...currentFood,\n                calories: updatedFood.calories || currentFood.calories,\n                protein: updatedFood.protein || currentFood.protein,\n                carbs: updatedFood.carbs || currentFood.carbs,\n                fat: updatedFood.fat || currentFood.fat,\n                // Update baseline to match new nutrition values\n                baselineCalories: updatedFood.calories || currentFood.baselineCalories,\n                baselineProtein: updatedFood.protein || currentFood.baselineProtein,\n                baselineCarbs: updatedFood.carbs || currentFood.baselineCarbs,\n                baselineFat: updatedFood.fat || currentFood.baselineFat,\n                // Only update baseline portion if the parsed value is valid (> 0)\n                baselinePortionValue: value > 0 ? value : currentFood.baselinePortionValue,\n                baselinePortionUnit: unit || currentFood.baselinePortionUnit,\n              };\n            }\n            return currentFood;\n          });\n        });\n      }\n      \n      // Clear the controller reference\n      nutritionUpdateControllerRef.current = null;\n    } catch (error: any) {\n      if (error.name === 'AbortError') {\n        return;\n      }\n      nutritionUpdateControllerRef.current = null;\n      \n    }\n  }, []);\n\n  // Debounced function to trigger nutrition updates with request versioning and deduplication\n  const scheduleNutritionUpdate = useCallback((foods: DetectedFood[]) => {\n    // Create a stable key for the current foods to detect duplicates\n    const foodsKey = JSON.stringify(foods.map(f => ({ name: f.name, portion: f.portion })));\n    \n    // Skip if this exact request was just made (deduplication)\n    if (foodsKey === lastRequestFoods) {\n      return;\n    }\n    \n    // Clear existing timer\n    if (nutritionUpdateTimer) {\n      clearTimeout(nutritionUpdateTimer);\n    }\n    \n    // Increment request ID for race condition protection (using ref)\n    nutritionRequestIdRef.current = nutritionRequestIdRef.current + 1;\n    const newRequestId = nutritionRequestIdRef.current;\n    \n    // Set new timer with 500ms delay (reduced from 1000ms for snappier feel)\n    const timer = setTimeout(() => {\n      setLastRequestFoods(foodsKey);\n      updateNutritionValues(foods, newRequestId);\n    }, 500);\n    \n    setNutritionUpdateTimer(timer);\n  }, [updateNutritionValues, nutritionUpdateTimer, lastRequestFoods]);\n\n  const updateFoodName = (index: number, newName: string) => {\n    const updatedFoods = [...editableFoods];\n    \n    // Expanded quick nutrition lookup for instant feedback\n    const quickNutrition: { [key: string]: { calories: number; protein: number; carbs: number; fat: number } } = {\n      // Proteins\n      'chicken breast': { calories: 231, protein: 43, carbs: 0, fat: 5 },\n      'chicken': { calories: 231, protein: 43, carbs: 0, fat: 5 },\n      'beef': { calories: 250, protein: 35, carbs: 0, fat: 15 },\n      'salmon': { calories: 208, protein: 30, carbs: 0, fat: 12 },\n      'tuna': { calories: 184, protein: 40, carbs: 0, fat: 1 },\n      'pork': { calories: 242, protein: 27, carbs: 0, fat: 14 },\n      'turkey': { calories: 189, protein: 29, carbs: 0, fat: 7 },\n      'fish': { calories: 206, protein: 22, carbs: 0, fat: 12 },\n      'shrimp': { calories: 99, protein: 24, carbs: 0, fat: 0 },\n      'eggs': { calories: 155, protein: 13, carbs: 1, fat: 11 },\n      'tofu': { calories: 144, protein: 17, carbs: 3, fat: 9 },\n      \n      // Carbohydrates\n      'rice': { calories: 130, protein: 3, carbs: 28, fat: 0 },\n      'pasta': { calories: 220, protein: 8, carbs: 44, fat: 1 },\n      'bread': { calories: 80, protein: 4, carbs: 15, fat: 1 },\n      'potato': { calories: 161, protein: 4, carbs: 37, fat: 0 },\n      'sweet potato': { calories: 112, protein: 2, carbs: 26, fat: 0 },\n      'quinoa': { calories: 222, protein: 8, carbs: 39, fat: 4 },\n      'oats': { calories: 389, protein: 17, carbs: 66, fat: 7 },\n      \n      // Fruits\n      'apple': { calories: 95, protein: 0, carbs: 25, fat: 0 },\n      'banana': { calories: 105, protein: 1, carbs: 27, fat: 0 },\n      'orange': { calories: 62, protein: 1, carbs: 15, fat: 0 },\n      'berries': { calories: 57, protein: 1, carbs: 14, fat: 0 },\n      'strawberries': { calories: 49, protein: 1, carbs: 12, fat: 0 },\n      \n      // Vegetables\n      'broccoli': { calories: 55, protein: 4, carbs: 11, fat: 0 },\n      'spinach': { calories: 23, protein: 3, carbs: 4, fat: 0 },\n      'carrots': { calories: 41, protein: 1, carbs: 10, fat: 0 },\n      'beans': { calories: 245, protein: 15, carbs: 45, fat: 1 },\n      'baked beans': { calories: 105, protein: 5, carbs: 22, fat: 1 },\n      \n      // Nuts and seeds\n      'almonds': { calories: 579, protein: 21, carbs: 22, fat: 50 },\n      'walnuts': { calories: 654, protein: 15, carbs: 14, fat: 65 },\n      \n      // Dairy\n      'milk': { calories: 42, protein: 3, carbs: 5, fat: 1 },\n      'cheese': { calories: 402, protein: 25, carbs: 1, fat: 33 },\n      'yogurt': { calories: 59, protein: 10, carbs: 4, fat: 0 }\n    };\n    \n    const lowerName = newName.toLowerCase();\n    const nutritionMatch = Object.keys(quickNutrition).find(key => lowerName.includes(key));\n    \n    if (nutritionMatch) {\n      // Update with known nutrition values immediately for instant feedback\n      updatedFoods[index] = {\n        ...updatedFoods[index],\n        name: newName,\n        ...quickNutrition[nutritionMatch]\n      };\n    } else {\n      // Just update name, nutrition will be calculated by API\n      updatedFoods[index] = {\n        ...updatedFoods[index],\n        name: newName,\n      };\n    }\n    \n    setEditableFoods(updatedFoods);\n    \n    // ALWAYS call API for the most accurate nutrition values\n    scheduleNutritionUpdate(updatedFoods);\n  };\n\n  const removeFoodItem = (index: number) => {\n    const updatedFoods = editableFoods.filter((_, i) => i !== index);\n    setEditableFoods(updatedFoods);\n    setEditingIndex(null);\n  };\n\n  const addNewFoodItem = () => {\n    setShowManualEntryDialog(true);\n  };\n\n  const addManualMealMutation = useMutation({\n    mutationFn: async ({ foodDescription }: { foodDescription: string }) => {\n      // Analyze the text-based food description\n      const analysisResponse = await apiRequest('POST', '/api/analyze-text', { foodDescription });\n      const analysis = await analysisResponse.json();\n      \n      // Add the new food to the current analysis\n      const newFood = analysis.detectedFoods[0]; // Take the first detected food\n      if (newFood) {\n        const updatedFoods = [...editableFoods, initializeEditableFood(newFood)];\n        setEditableFoods(updatedFoods);\n        \n        // Save changes to the database (strip baseline data)\n        const updateResponse = await apiRequest('PATCH', `/api/analyses/${data.id}`, {\n          detectedFoods: updatedFoods.map(stripBaselineData)\n        });\n        return await updateResponse.json();\n      }\n      return analysis;\n    },\n    onSuccess: (updatedAnalysis) => {\n      soundService.playSuccess();\n      toast({\n        title: \"Food Added!\",\n        description: \"Manual food item has been added to your analysis.\",\n      });\n      \n      // Update data totals if we got an updated analysis back\n      if (updatedAnalysis && updatedAnalysis.detectedFoods) {\n        data.detectedFoods = [...updatedAnalysis.detectedFoods];\n        data.totalCalories = updatedAnalysis.totalCalories;\n        data.totalProtein = updatedAnalysis.totalProtein;\n        data.totalCarbs = updatedAnalysis.totalCarbs;\n        data.totalFat = updatedAnalysis.totalFat;\n        setEditableFoods(updatedAnalysis.detectedFoods.map(initializeEditableFood));\n      }\n      \n      queryClient.invalidateQueries({ queryKey: ['/api/analyses'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/diary'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges/points'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges/streak'] });\n      setShowManualEntryDialog(false);\n      setManualFoodName('');\n      setManualPortionAmount('100');\n      setManualPortionUnit('g');\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to add manual food. Please try again.\",\n        variant: \"destructive\",\n      });\n      console.error(\"Error adding manual food:\", error);\n    },\n  });\n\n  const handleConfirmManualFood = () => {\n    if (!manualFoodName.trim()) return;\n    // Construct food description with portion\n    const foodDescription = `${manualPortionAmount} ${manualPortionUnit} ${manualFoodName.trim()}`;\n    addManualMealMutation.mutate({\n      foodDescription\n    });\n  };\n\n  const hasChanges = () => {\n    return JSON.stringify(editableFoods) !== JSON.stringify(data.detectedFoods);\n  };\n\n  const saveChangesMutation = useMutation({\n    mutationFn: async () => {\n      // Server calculates totals for security - only send detectedFoods without baseline data\n      const response = await apiRequest('PATCH', `/api/analyses/${data.id}`, {\n        detectedFoods: editableFoods.map(stripBaselineData)\n      });\n      return await response.json();\n    },\n    onSuccess: (updatedAnalysis) => {\n      soundService.playClick();\n      // Update the original data with server-calculated values\n      data.detectedFoods = [...updatedAnalysis.detectedFoods];\n      data.totalCalories = updatedAnalysis.totalCalories;\n      data.totalProtein = updatedAnalysis.totalProtein;\n      data.totalCarbs = updatedAnalysis.totalCarbs;\n      data.totalFat = updatedAnalysis.totalFat;\n      \n      // Update local state to match server response\n      setEditableFoods(updatedAnalysis.detectedFoods.map(initializeEditableFood));\n      \n      toast({\n        title: \"Changes Saved\",\n        description: \"Your food corrections have been saved to the database.\",\n      });\n      \n      // Invalidate all related caches\n      queryClient.invalidateQueries({ queryKey: ['/api/analyses'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/diary'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/analyses', data.id] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges/points'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges/streak'] });\n    },\n    onError: (error: Error) => {\n      console.error(\"âŒ Failed to save changes:\", error);\n      toast({\n        title: \"Save Failed\",\n        description: \"Could not save your changes. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const saveChanges = () => {\n    saveChangesMutation.mutate();\n  };\n\n  const resetChanges = () => {\n    setEditableFoods(data.detectedFoods.map(initializeEditableFood));\n    setEditingIndex(null);\n    toast({\n      title: \"Changes Reset\",\n      description: \"All changes have been reset to original AI detection.\",\n    });\n  };\n\n  const updateFoodNutrition = (index: number, field: string, value: number) => {\n    const updatedFoods = [...editableFoods];\n    updatedFoods[index] = {\n      ...updatedFoods[index],\n      [field]: value,\n    };\n    setEditableFoods(updatedFoods);\n  };\n\n  const startEditingField = (index: number, field: string, currentValue: number) => {\n    setEditingField({ index, field, value: currentValue.toString() });\n  };\n\n  const saveEditingField = () => {\n    if (!editingField) return;\n    \n    const numValue = parseFloat(editingField.value);\n    if (!isNaN(numValue) && numValue >= 0) {\n      updateFoodNutrition(editingField.index, editingField.field, numValue);\n    }\n    setEditingField(null);\n  };\n\n  const cancelEditingField = () => {\n    setEditingField(null);\n  };\n\n  const handleFieldKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      saveEditingField();\n    } else if (e.key === 'Escape') {\n      e.preventDefault();\n      cancelEditingField();\n    }\n  };\n\n  const startEditingSummary = (field: 'calories' | 'protein' | 'carbs' | 'fat', currentValue: number) => {\n    setEditingSummary({ field, value: currentValue.toString() });\n  };\n\n  const saveSummaryEdit = () => {\n    if (!editingSummary) return;\n    \n    const newValue = parseFloat(editingSummary.value);\n    if (isNaN(newValue) || newValue < 0) {\n      setEditingSummary(null);\n      return;\n    }\n\n    const field = editingSummary.field;\n    const currentTotal = totals[field];\n\n    if (editableFoods.length === 0) {\n      // No foods to edit\n      setEditingSummary(null);\n      return;\n    }\n\n    if (currentTotal === 0) {\n      // If current total is 0, distribute the new value evenly across all food items\n      const perFood = newValue / editableFoods.length;\n      \n      // Build all items except the last\n      const updatedFoods: EditableFood[] = [];\n      let sumOfOthers = 0;\n      \n      editableFoods.forEach((food, index) => {\n        if (index < editableFoods.length - 1) {\n          const roundedValue = Math.round(perFood * 100) / 100;\n          updatedFoods.push({\n            ...food,\n            [field]: roundedValue\n          });\n          sumOfOthers += roundedValue;\n        } else {\n          // Last item gets exactly the remainder, but never negative\n          const remainder = newValue - sumOfOthers;\n          updatedFoods.push({\n            ...food,\n            [field]: Math.max(0, Math.round(remainder * 100) / 100)\n          });\n        }\n      });\n      \n      // Update baselines\n      const finalFoods = updatedFoods.map(food => ({\n        ...food,\n        [`baseline${field.charAt(0).toUpperCase() + field.slice(1)}`]: food[field]\n      }));\n      \n      setEditableFoods(finalFoods);\n      setEditingSummary(null);\n      return;\n    }\n\n    // Calculate the adjustment ratio\n    const ratio = newValue / currentTotal;\n\n    // Build all items except the last\n    const updatedFoods: EditableFood[] = [];\n    let sumOfOthers = 0;\n    \n    editableFoods.forEach((food, index) => {\n      if (index < editableFoods.length - 1) {\n        const scaledValue = food[field] * ratio;\n        const roundedValue = Math.round(scaledValue * 100) / 100;\n        updatedFoods.push({\n          ...food,\n          [field]: roundedValue\n        });\n        sumOfOthers += roundedValue;\n      } else {\n        // Last item gets exactly the remainder, but never negative\n        const remainder = newValue - sumOfOthers;\n        updatedFoods.push({\n          ...food,\n          [field]: Math.max(0, Math.round(remainder * 100) / 100)\n        });\n      }\n    });\n\n    // Update baseline values to new values\n    const finalFoods = updatedFoods.map(food => ({\n      ...food,\n      [`baseline${field.charAt(0).toUpperCase() + field.slice(1)}`]: food[field]\n    }));\n\n    setEditableFoods(finalFoods);\n    setEditingSummary(null);\n  };\n\n  const cancelSummaryEdit = () => {\n    setEditingSummary(null);\n  };\n\n  const handleSummaryKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      saveSummaryEdit();\n    } else if (e.key === 'Escape') {\n      e.preventDefault();\n      cancelSummaryEdit();\n    }\n  };\n\n  // Memoized calculation of total nutrition from editable foods - only recalculates when foods change\n  const totals = useMemo(() => {\n    return editableFoods.reduce(\n      (totals, food) => ({\n        calories: totals.calories + (food.calories || 0),\n        protein: totals.protein + (food.protein || 0),\n        carbs: totals.carbs + (food.carbs || 0),\n        fat: totals.fat + (food.fat || 0),\n      }),\n      { calories: 0, protein: 0, carbs: 0, fat: 0 }\n    );\n  }, [editableFoods]);\n\n  const addVoiceMealMutation = useMutation({\n    mutationFn: async ({ foodDescription }: { foodDescription: string }) => {\n      // Analyze the text-based food description\n      const analysisResponse = await apiRequest('POST', '/api/analyze-text', { foodDescription });\n      const analysis = await analysisResponse.json();\n      \n      // Add the new food to the current analysis\n      const newFood = analysis.detectedFoods[0]; // Take the first detected food\n      if (newFood) {\n        const updatedFoods = [...editableFoods, initializeEditableFood(newFood)];\n        setEditableFoods(updatedFoods);\n        \n        // Save changes to the database (strip baseline data)\n        const updateResponse = await apiRequest('PATCH', `/api/analyses/${data.id}`, {\n          detectedFoods: updatedFoods.map(stripBaselineData)\n        });\n        return await updateResponse.json();\n      }\n      return analysis;\n    },\n    onSuccess: (updatedAnalysis) => {\n      soundService.playSuccess();\n      toast({\n        title: \"Food Added!\",\n        description: \"Voice food item has been added to your analysis.\",\n      });\n      \n      // Update data totals if we got an updated analysis back\n      if (updatedAnalysis && updatedAnalysis.detectedFoods) {\n        data.detectedFoods = [...updatedAnalysis.detectedFoods];\n        data.totalCalories = updatedAnalysis.totalCalories;\n        data.totalProtein = updatedAnalysis.totalProtein;\n        data.totalCarbs = updatedAnalysis.totalCarbs;\n        data.totalFat = updatedAnalysis.totalFat;\n        setEditableFoods(updatedAnalysis.detectedFoods.map(initializeEditableFood));\n      }\n      \n      queryClient.invalidateQueries({ queryKey: ['/api/analyses'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/diary'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges/points'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges/streak'] });\n      setShowVoiceMealDialog(false);\n      setVoiceInput('');\n      setVoiceFoodName('');\n      setVoicePortionAmount('100');\n      setVoicePortionUnit('g');\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to add food from voice. Please try again.\",\n        variant: \"destructive\",\n      });\n      console.error(\"Error adding voice food:\", error);\n    },\n  });\n\n  const handleConfirmVoiceFood = () => {\n    if (!voiceFoodName.trim()) return;\n    // Construct food description with portion\n    const foodDescription = `${voicePortionAmount} ${voicePortionUnit} ${voiceFoodName.trim()}`;\n    addVoiceMealMutation.mutate({\n      foodDescription\n    });\n  };\n\n  const addToDiaryMutation = useMutation({\n    mutationFn: async () => {\n      const isGuestAnalysis = data.id.startsWith('guest_');\n      \n      // Step 1: Save any unsaved changes to the analysis first (only for persisted analyses)\n      if (hasChanges() && !isGuestAnalysis) {\n        const patchResponse = await apiRequest('PATCH', `/api/analyses/${data.id}`, {\n          detectedFoods: editableFoods.map(stripBaselineData)\n        });\n        \n        if (!patchResponse.ok) {\n          throw new Error('Failed to save analysis changes');\n        }\n        \n        const updatedAnalysis = await patchResponse.json();\n        \n        // Update the component state with server-calculated values\n        data.detectedFoods = [...updatedAnalysis.detectedFoods];\n        data.totalCalories = updatedAnalysis.totalCalories;\n        data.totalProtein = updatedAnalysis.totalProtein;\n        data.totalCarbs = updatedAnalysis.totalCarbs;\n        data.totalFat = updatedAnalysis.totalFat;\n        \n        // Update local state to match server response\n        setEditableFoods(updatedAnalysis.detectedFoods.map(initializeEditableFood));\n      }\n      \n      // Step 2: Create the diary entry\n      const mealDateTime = new Date(`${selectedDate}T${selectedTime}`);\n      const requestBody: any = {\n        analysisId: data.id,\n        mealType: selectedMealType,\n        mealDate: mealDateTime.toISOString(),\n        notes: \"\",\n      };\n      \n      // For guest analyses with changes, include the modified analysis\n      if (isGuestAnalysis && hasChanges()) {\n        requestBody.modifiedAnalysis = {\n          imageUrl: data.imageUrl,\n          confidence: data.confidence,\n          detectedFoods: editableFoods.map(stripBaselineData),\n          totalCalories: Math.round(totals.calories),\n          totalProtein: Math.round(totals.protein),\n          totalCarbs: Math.round(totals.carbs),\n          totalFat: Math.round(totals.fat)\n        };\n      }\n      \n      const response = await apiRequest('POST', '/api/diary', requestBody);\n      const result = await response.json();\n      return result;\n    },\n    onSuccess: () => {\n      soundService.playSuccess();\n      // Update streak when diary entry is saved\n      const streakData = updateStreak();\n      \n      toast({\n        title: \"Saved to Diary!\",\n        description: `Your meal has been saved to your food diary. ${streakData.currentStreak > 0 ? `Streak: ${streakData.currentStreak} days!` : ''}`,\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/diary'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/analyses'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/analyses', data.id] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges/points'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges/streak'] });\n      setShowDiaryDialog(false);\n      \n      // Trigger a re-render of the StreakCounter component\n      window.dispatchEvent(new Event('streakUpdated'));\n      \n      // Return to camera view so scan buttons are visible\n      onScanAnother();\n    },\n    onError: (error: Error) => {\n      console.error(\"Error adding to diary:\", error);\n      \n      toast({\n        title: \"Error Adding to Diary\",\n        description: error.message || \"Failed to save meal to diary. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n  const formatTime = (date: Date | string | null | undefined) => {\n    try {\n      // Handle null, undefined, or invalid inputs\n      if (!date) {\n        return 'Unknown time';\n      }\n      \n      const now = new Date();\n      let dateObj: Date;\n      \n      if (typeof date === 'string') {\n        dateObj = new Date(date);\n      } else if (date instanceof Date) {\n        dateObj = date;\n      } else {\n        return 'Unknown time';\n      }\n      \n      // Check if dateObj is valid\n      if (isNaN(dateObj.getTime())) {\n        return 'Unknown time';\n      }\n      \n      const diff = now.getTime() - dateObj.getTime();\n      const minutes = Math.floor(diff / 60000);\n      \n      if (minutes < 1) return 'Just now';\n      if (minutes < 60) return `${minutes}m ago`;\n      const hours = Math.floor(minutes / 60);\n      if (hours < 24) return `${hours}h ago`;\n      return dateObj.toLocaleDateString();\n    } catch (error) {\n      console.error('Error formatting time:', error);\n      return 'Unknown time';\n    }\n  };\n\n  const getNutrientIcon = (type: string) => {\n    switch (type) {\n      case 'protein': return 'fas fa-dumbbell';\n      case 'carbs': return 'fas fa-bread-slice';\n      case 'fat': return 'fas fa-tint';\n      case 'calories': return 'fas fa-fire';\n      default: return 'fas fa-circle';\n    }\n  };\n\n  const getFoodIcon = (iconName: string) => {\n    switch (iconName) {\n      case 'egg': return 'fas fa-egg';\n      case 'bacon': return 'fas fa-bacon';\n      case 'bread-slice': return 'fas fa-bread-slice';\n      case 'apple-alt': return 'fas fa-apple-alt';\n      default: return 'fas fa-utensils';\n    }\n  };\n\n  // Get food emoji based on food name\n  const getFoodEmoji = (foodName: string): string => {\n    const name = foodName.toLowerCase();\n    \n    // Eggs\n    if (name.includes('egg')) return 'ðŸ¥š';\n    \n    // Meat & Protein\n    if (name.includes('bacon')) return 'ðŸ¥“';\n    if (name.includes('chicken') || name.includes('turkey')) return 'ðŸ—';\n    if (name.includes('beef') || name.includes('steak')) return 'ðŸ¥©';\n    if (name.includes('fish') || name.includes('salmon')) return 'ðŸŸ';\n    if (name.includes('shrimp') || name.includes('prawn')) return 'ðŸ¤';\n    \n    // Bread & Grains\n    if (name.includes('toast') || name.includes('bread')) return 'ðŸž';\n    if (name.includes('pasta') || name.includes('spaghetti')) return 'ðŸ';\n    if (name.includes('rice')) return 'ðŸš';\n    if (name.includes('pizza')) return 'ðŸ•';\n    if (name.includes('sandwich') || name.includes('burger')) return 'ðŸ”';\n    \n    // Vegetables\n    if (name.includes('avocado')) return 'ðŸ¥‘';\n    if (name.includes('tomato')) return 'ðŸ…';\n    if (name.includes('carrot')) return 'ðŸ¥•';\n    if (name.includes('broccoli')) return 'ðŸ¥¦';\n    if (name.includes('salad')) return 'ðŸ¥—';\n    if (name.includes('potato')) return 'ðŸ¥”';\n    \n    // Fruits\n    if (name.includes('apple')) return 'ðŸŽ';\n    if (name.includes('banana')) return 'ðŸŒ';\n    if (name.includes('berry') || name.includes('berries')) return 'ðŸ«';\n    if (name.includes('strawberry')) return 'ðŸ“';\n    if (name.includes('orange')) return 'ðŸŠ';\n    if (name.includes('watermelon')) return 'ðŸ‰';\n    \n    // Dairy\n    if (name.includes('milk')) return 'ðŸ¥›';\n    if (name.includes('cheese')) return 'ðŸ§€';\n    if (name.includes('yogurt') || name.includes('yoghurt')) return 'ðŸ¥›';\n    \n    // Misc\n    if (name.includes('coffee')) return 'â˜•';\n    if (name.includes('tea')) return 'ðŸµ';\n    if (name.includes('soup')) return 'ðŸ²';\n    if (name.includes('cookie') || name.includes('biscuit')) return 'ðŸª';\n    if (name.includes('cake')) return 'ðŸ°';\n    \n    // Default\n    return 'ðŸ½ï¸';\n  };\n\n  // Memoized calculation for macro percentages - only recalculates when data changes\n  const macroPercentages = useMemo(() => {\n    const totalMacros = data.totalProtein * 4 + data.totalCarbs * 4 + data.totalFat * 9;\n    return {\n      protein: Math.round((data.totalProtein * 4 / totalMacros) * 100),\n      carbs: Math.round((data.totalCarbs * 4 / totalMacros) * 100),\n      fat: Math.round((data.totalFat * 9 / totalMacros) * 100),\n    };\n  }, [data.totalProtein, data.totalCarbs, data.totalFat]);\n\n  return (\n    <motion.div \n      className=\"p-4 space-y-4\"\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      transition={{ duration: 0.5 }}\n    >\n      {/* Back Button */}\n      <motion.div \n        className=\"flex items-center mb-4\"\n        initial={{ x: -20, opacity: 0 }}\n        animate={{ x: 0, opacity: 1 }}\n        transition={{ delay: 0.1 }}\n      >\n        <button \n          onClick={onScanAnother}\n          className=\"flex items-center space-x-2 text-muted-foreground hover:text-foreground transition-colors p-2 hover:bg-muted/30 rounded-xl\"\n          data-testid=\"button-back\"\n          aria-label=\"Return to camera to scan another meal\"\n        >\n          <ArrowLeft className=\"h-5 w-5\" aria-hidden=\"true\" />\n          <span className=\"font-medium\">Back to Camera</span>\n        </button>\n      </motion.div>\n      \n      {/* AI Unavailable Warning */}\n      {data.isAITemporarilyUnavailable && (\n        <Alert className=\"border-amber-200 bg-amber-50 dark:bg-amber-950 dark:border-amber-800\">\n          <AlertTriangle className=\"h-4 w-4 text-amber-600\" />\n          <AlertDescription className=\"text-amber-700 dark:text-amber-300\">\n            <strong>AI services temporarily unavailable</strong><br />\n            We've provided estimated values based on typical portions. You can still save this entry and edit the details later when our AI services are back online.\n          </AlertDescription>\n        </Alert>\n      )}\n      \n      {/* Editing Instructions */}\n      <Alert className=\"border-blue-200 bg-blue-50 dark:bg-blue-950 dark:border-blue-800\">\n        <Info className=\"h-4 w-4 text-blue-600\" />\n        <AlertDescription className=\"text-blue-700 dark:text-blue-300\">\n          <strong>ðŸ’¡ Tip:</strong> Click the pencil icon <Edit3 className=\"h-3 w-3 inline mx-1\" /> next to food names or portions to edit them. Nutrition values will update automatically!\n        </AlertDescription>\n      </Alert>\n      {/* Stunning Header with Purple Gradient and AI Brain Icon */}\n      <motion.div \n        className=\"relative bg-gradient-to-br from-indigo-900 via-purple-900 to-purple-800 rounded-3xl p-8 shadow-2xl border border-purple-400/20 overflow-hidden\"\n        initial={{ scale: 0.95, opacity: 0 }}\n        animate={{ \n          scale: 1, \n          opacity: 1\n        }}\n        transition={{ \n          duration: 0.6,\n          delay: 0.1,\n          ease: [0.34, 1.56, 0.64, 1]\n        }}\n      >\n        {/* Animated background glow */}\n        <motion.div \n          className=\"absolute inset-0 bg-gradient-to-br from-purple-500/20 via-pink-500/10 to-transparent\"\n          animate={{\n            opacity: [0.3, 0.6, 0.3]\n          }}\n          transition={{\n            duration: 3,\n            repeat: Infinity,\n            ease: \"easeInOut\"\n          }}\n        />\n        \n        {/* Content */}\n        <div className=\"relative z-10\">\n          {/* AI Brain Icon with Sparkles */}\n          <motion.div \n            className=\"flex justify-center mb-6\"\n            initial={{ scale: 0, rotate: -180 }}\n            animate={{ scale: 1, rotate: 0 }}\n            transition={{ \n              delay: 0.3, \n              duration: 0.7,\n              type: \"spring\",\n              stiffness: 200\n            }}\n          >\n            <div className=\"relative\">\n              {/* Glow effect */}\n              <motion.div \n                className=\"absolute inset-0 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full blur-2xl\"\n                animate={{\n                  scale: [1, 1.2, 1],\n                  opacity: [0.5, 0.8, 0.5]\n                }}\n                transition={{\n                  duration: 2,\n                  repeat: Infinity,\n                  ease: \"easeInOut\"\n                }}\n              />\n              \n              {/* Brain Icon */}\n              <div className=\"relative w-20 h-20 bg-gradient-to-br from-pink-500 to-purple-600 rounded-full flex items-center justify-center shadow-xl ring-4 ring-white/20\">\n                <span className=\"text-4xl\" role=\"img\" aria-label=\"AI brain\">ðŸ§ </span>\n              </div>\n              \n              {/* Sparkle particles */}\n              {[...Array(6)].map((_, i) => (\n                <motion.div\n                  key={i}\n                  className=\"absolute w-1.5 h-1.5 bg-white rounded-full\"\n                  style={{\n                    top: '50%',\n                    left: '50%',\n                  }}\n                  initial={{ \n                    x: 0, \n                    y: 0,\n                    opacity: 0 \n                  }}\n                  animate={{\n                    x: [0, Math.cos(i * 60 * Math.PI / 180) * 40],\n                    y: [0, Math.sin(i * 60 * Math.PI / 180) * 40],\n                    opacity: [0, 1, 0],\n                    scale: [0, 1, 0]\n                  }}\n                  transition={{\n                    duration: 1.5,\n                    repeat: Infinity,\n                    delay: 0.5 + i * 0.1,\n                    ease: \"easeOut\"\n                  }}\n                />\n              ))}\n            </div>\n          </motion.div>\n          \n          {/* Title */}\n          <motion.h2 \n            className=\"text-3xl font-bold text-center text-white mb-2\"\n            initial={{ y: 20, opacity: 0 }}\n            animate={{ y: 0, opacity: 1 }}\n            transition={{ delay: 0.5 }}\n            data-testid=\"text-analysis-title\"\n          >\n            AI Analysis Complete\n          </motion.h2>\n          \n          <motion.p \n            className=\"text-center text-purple-200 text-sm mb-6\"\n            initial={{ y: 20, opacity: 0 }}\n            animate={{ y: 0, opacity: 1 }}\n            transition={{ delay: 0.6 }}\n            data-testid=\"text-analysis-subtitle\"\n          >\n            Your meal has been analyzed!\n          </motion.p>\n          \n          {/* Confidence Badge */}\n          <motion.div \n            className=\"flex justify-center\"\n            initial={{ scale: 0 }}\n            animate={{ scale: 1 }}\n            transition={{ delay: 0.7, type: \"spring\" }}\n          >\n            <div \n              data-testid=\"text-confidence\" \n              className={`inline-flex items-center space-x-2 px-4 py-2 rounded-full font-semibold shadow-lg ${\n                data.isAITemporarilyUnavailable \n                  ? 'bg-amber-400 text-amber-900'\n                  : 'bg-white/95 text-purple-700'\n              }`}\n            >\n              <Zap className=\"h-4 w-4\" />\n              <span>\n                {data.isAITemporarilyUnavailable ? 'Estimated values' : `${data.confidence}% confidence`}\n              </span>\n            </div>\n          </motion.div>\n        </div>\n      </motion.div>\n\n      {/* Detected Foods - Dark Purple Theme with Emojis */}\n      <motion.div \n        className=\"relative bg-gradient-to-br from-indigo-950 via-purple-950 to-purple-900 rounded-3xl shadow-2xl p-6 border border-purple-500/20 overflow-hidden\"\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ delay: 0.8 }}\n      >\n        {/* Subtle animated background */}\n        <div className=\"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0zNiAxOGMzLjMxNCAwIDYgMi42ODYgNiA2cy0yLjY4NiA2LTYgNi02LTIuNjg2LTYtNiAyLjY4Ni02IDYtNnoiIHN0cm9rZT0icmdiYSgyNTUsMjU1LDI1NSwwLjAzKSIvPjwvZz48L3N2Zz4=')] opacity-20\" />\n        \n        <div className=\"relative z-10 space-y-3\">\n          {editableFoods.map((food, index) => (\n            <motion.div \n              key={index}\n              initial={{ x: -20, opacity: 0 }}\n              animate={{ x: 0, opacity: 1 }}\n              transition={{ delay: 0.9 + index * 0.1 }}\n              className={`p-4 rounded-2xl transition-all duration-200 ${\n                editingIndex === index \n                  ? 'bg-indigo-800/50 border-2 border-indigo-400 scale-[1.02]' \n                  : 'bg-indigo-900/30 border border-indigo-800/30 hover:bg-indigo-800/40'\n              }`}\n              data-testid={`card-food-${index}`}\n            >\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center space-x-3 flex-1\">\n                  {/* Food Emoji */}\n                  <div className=\"w-12 h-12 flex items-center justify-center text-3xl\">\n                    {getFoodEmoji(food.name)}\n                  </div>\n                  <div className=\"flex-1\">\n                    {editingIndex === index ? (\n                      <input\n                        type=\"text\"\n                        value={food.name}\n                        onChange={(e) => updateFoodName(index, e.target.value)}\n                        onKeyDown={(e) => {\n                          if (e.key === 'Enter') {\n                            setEditingIndex(null);\n                          } else if (e.key === 'Escape') {\n                            setEditableFoods(data.detectedFoods.map(initializeEditableFood));\n                            setEditingIndex(null);\n                          }\n                        }}\n                        className=\"w-full px-2 py-1 text-sm border rounded focus:outline-none focus:ring-2 focus:ring-primary/50 bg-background font-medium\"\n                        placeholder=\"e.g., Jacket Potato with Ham and Cheese\"\n                        data-testid={`input-food-name-${index}`}\n                      />\n                    ) : (\n                      <div className=\"flex items-center space-x-1.5\">\n                        <p className=\"font-medium text-white\" data-testid={`text-food-name-${index}`}>\n                          {food.name}\n                        </p>\n                        <button\n                          onClick={(e) => {\n                            e.preventDefault();\n                            e.stopPropagation();\n                            setEditingIndex(index);\n                          }}\n                          className=\"inline-flex items-center justify-center rounded-md h-7 w-7 p-0 text-muted-foreground hover:text-foreground hover:bg-muted/50 transition-colors\"\n                          aria-label={`Edit ${food.name} name`}\n                          title=\"Edit food name\"\n                          data-testid={`button-edit-name-${index}`}\n                        >\n                          <Edit3 className=\"h-3 w-3\" aria-hidden=\"true\" />\n                        </button>\n                      </div>\n                    )}\n                    <div className=\"flex items-start gap-2 mt-3\">\n                      <div className=\"flex-1 min-w-0\">\n                        <label className=\"text-sm font-semibold text-orange-300 mb-2 block\">\n                          ðŸ“ Portion Size\n                        </label>\n                        <div className=\"flex gap-2\">\n                          <input\n                            type=\"number\"\n                            value={\n                              portionInputValues[index] !== undefined\n                                ? portionInputValues[index]\n                                : (parsePortionString(food.portion)?.value || food.baselinePortionValue || 100)\n                            }\n                            onChange={(e) => {\n                              // Update local state immediately for responsive typing\n                              setPortionInputValues(prev => ({\n                                ...prev,\n                                [index]: e.target.value\n                              }));\n                            }}\n                            onBlur={(e) => {\n                              const newValue = parseFloat(e.target.value);\n                              // Validate and commit the value\n                              if (!isNaN(newValue) && newValue > 0) {\n                                updateFoodPortionValue(index, newValue);\n                                // Clear local state after committing\n                                setPortionInputValues(prev => {\n                                  const updated = { ...prev };\n                                  delete updated[index];\n                                  return updated;\n                                });\n                              } else {\n                                // Reset to current value if invalid\n                                setPortionInputValues(prev => {\n                                  const updated = { ...prev };\n                                  delete updated[index];\n                                  return updated;\n                                });\n                              }\n                            }}\n                            onKeyDown={(e) => {\n                              if (e.key === 'Enter') {\n                                e.currentTarget.blur();\n                              }\n                            }}\n                            className=\"w-20 sm:w-24 px-2 sm:px-4 py-3 text-base font-medium border-2 border-orange-300 dark:border-orange-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-orange-400 focus:border-orange-400 bg-white dark:bg-gray-800 transition-all shadow-sm\"\n                            placeholder=\"100\"\n                            min=\"0\"\n                            step=\"any\"\n                            data-testid={`input-food-portion-value-${index}`}\n                          />\n                          <select\n                            value={food.baselinePortionUnit}\n                            onChange={(e) => updateFoodPortionUnit(index, e.target.value)}\n                            className=\"flex-1 min-w-0 px-2 sm:px-3 py-3 text-sm sm:text-base font-medium border-2 border-orange-300 dark:border-orange-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-orange-400 focus:border-orange-400 bg-white dark:bg-gray-800 transition-all shadow-sm\"\n                            data-testid={`select-food-portion-unit-${index}`}\n                          >\n                            <option value=\"g\">g</option>\n                            <option value=\"oz\">oz</option>\n                            <option value=\"lb\">lb</option>\n                            <option value=\"kg\">kg</option>\n                            <option value=\"ml\">ml</option>\n                            <option value=\"L\">L</option>\n                            <option value=\"cup\">cup</option>\n                            <option value=\"tbsp\">tbsp</option>\n                            <option value=\"tsp\">tsp</option>\n                            <option value=\"serving\">serving</option>\n                            <option value=\"slice\">slice</option>\n                            <option value=\"piece\">piece</option>\n                            <option value=\"item\">item</option>\n                          </select>\n                        </div>\n                        <p className=\"text-xs text-purple-300 mt-1\">Enter amount and unit to adjust calories</p>\n                      </div>\n                      <button\n                        onClick={() => removeFoodItem(index)}\n                        className=\"mt-8 p-2 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/30 rounded-lg transition-colors flex-shrink-0\"\n                        aria-label={`Remove ${food.name} from list`}\n                        title=\"Remove this food item\"\n                        data-testid={`button-remove-food-${index}`}\n                      >\n                        <Trash2 className=\"h-4 w-4\" aria-hidden=\"true\" />\n                      </button>\n                    </div>\n                  </div>\n                </div>\n                <div className=\"text-right\">\n                  {/* Calories - Click to Edit */}\n                  {editingField?.index === index && editingField?.field === 'calories' ? (\n                    <input\n                      type=\"number\"\n                      value={editingField.value}\n                      onChange={(e) => setEditingField(prev => prev ? { ...prev, value: e.target.value } : null)}\n                      onBlur={saveEditingField}\n                      onKeyDown={handleFieldKeyDown}\n                      autoFocus\n                      className=\"w-20 px-2 py-1 text-sm font-semibold text-center border-2 border-orange-400 rounded bg-white dark:bg-gray-800 text-foreground focus:outline-none focus:ring-2 focus:ring-orange-500\"\n                      data-testid={`input-calories-${index}`}\n                    />\n                  ) : (\n                    <p \n                      className=\"font-semibold text-white cursor-pointer hover:bg-white/10 rounded px-2 py-1 transition-colors\" \n                      onClick={() => startEditingField(index, 'calories', food.calories)}\n                      data-testid={`text-food-calories-${index}`}\n                      title=\"Click to edit calories\"\n                    >\n                      {food.calories} cal\n                    </p>\n                  )}\n                  \n                  {/* Protein - Click to Edit */}\n                  {editingField?.index === index && editingField?.field === 'protein' ? (\n                    <input\n                      type=\"number\"\n                      value={editingField.value}\n                      onChange={(e) => setEditingField(prev => prev ? { ...prev, value: e.target.value } : null)}\n                      onBlur={saveEditingField}\n                      onKeyDown={handleFieldKeyDown}\n                      autoFocus\n                      className=\"w-16 px-2 py-1 text-xs text-center border-2 border-orange-400 rounded bg-white dark:bg-gray-800 text-foreground focus:outline-none focus:ring-2 focus:ring-orange-500\"\n                      data-testid={`input-protein-${index}`}\n                    />\n                  ) : (\n                    <p \n                      className=\"text-xs text-purple-200 cursor-pointer hover:bg-white/10 rounded px-2 py-0.5 transition-colors\" \n                      onClick={() => startEditingField(index, 'protein', food.protein)}\n                      title=\"Click to edit protein\"\n                    >\n                      {food.protein}g protein\n                    </p>\n                  )}\n                  \n                  {/* Carbs - Click to Edit */}\n                  <div className=\"text-xs text-purple-200/80 mt-0.5\">\n                    {editingField?.index === index && editingField?.field === 'carbs' ? (\n                      <input\n                        type=\"number\"\n                        value={editingField.value}\n                        onChange={(e) => setEditingField(prev => prev ? { ...prev, value: e.target.value } : null)}\n                        onBlur={saveEditingField}\n                        onKeyDown={handleFieldKeyDown}\n                        autoFocus\n                        className=\"w-16 px-2 py-1 text-xs text-center border-2 border-orange-400 rounded bg-white dark:bg-gray-800 text-foreground focus:outline-none focus:ring-2 focus:ring-orange-500\"\n                        data-testid={`input-carbs-${index}`}\n                      />\n                    ) : (\n                      <span \n                        className=\"cursor-pointer hover:bg-white/10 rounded px-2 py-0.5 transition-colors inline-block\" \n                        onClick={() => startEditingField(index, 'carbs', food.carbs)}\n                        title=\"Click to edit carbs\"\n                      >\n                        {food.carbs}g carbs\n                      </span>\n                    )}\n                    {' â€¢ '}\n                    {/* Fat - Click to Edit */}\n                    {editingField?.index === index && editingField?.field === 'fat' ? (\n                      <input\n                        type=\"number\"\n                        value={editingField.value}\n                        onChange={(e) => setEditingField(prev => prev ? { ...prev, value: e.target.value } : null)}\n                        onBlur={saveEditingField}\n                        onKeyDown={handleFieldKeyDown}\n                        autoFocus\n                        className=\"w-16 px-2 py-1 text-xs text-center border-2 border-orange-400 rounded bg-white dark:bg-gray-800 text-foreground focus:outline-none focus:ring-2 focus:ring-orange-500\"\n                        data-testid={`input-fat-${index}`}\n                      />\n                    ) : (\n                      <span \n                        className=\"cursor-pointer hover:bg-white/10 rounded px-2 py-0.5 transition-colors inline-block\" \n                        onClick={() => startEditingField(index, 'fat', food.fat)}\n                        title=\"Click to edit fat\"\n                      >\n                        {food.fat}g fat\n                      </span>\n                    )}\n                  </div>\n                </div>\n              </div>\n            </motion.div>\n          ))}\n        </div>\n\n        {/* Add Missing Foods - Dark Purple Theme */}\n        <div className=\"mt-4 bg-gradient-to-br from-indigo-950 via-purple-950 to-purple-900 rounded-3xl p-6 shadow-lg border border-purple-500/20\">\n          {/* Header with Instructions */}\n          <div className=\"text-center mb-6\">\n            <h3 className=\"text-white text-lg font-bold mb-2\">Add Missing Foods</h3>\n            <p className=\"text-purple-200 text-sm\">\n              AI might miss some items in your meal\n            </p>\n          </div>\n          \n          {/* Action Buttons */}\n          <div className=\"flex space-x-3\">\n            {/* Voice Add Button */}\n            <button\n              onClick={handleVoiceInput}\n              disabled={!speechSupported}\n              className={`flex-1 py-4 px-6 rounded-2xl flex items-center justify-center space-x-3 border transition-all duration-300 shadow-md hover:scale-105 font-semibold ${\n                isListening\n                  ? 'bg-gradient-to-br from-red-500 to-pink-500 text-white border-red-400 animate-pulse shadow-xl'\n                  : speechSupported\n                  ? 'bg-indigo-800/50 text-purple-200 border-purple-600/30 hover:bg-indigo-700/50 hover:shadow-purple-500/25'\n                  : 'bg-gray-700/30 text-gray-400 cursor-not-allowed border-gray-600/30'\n              }`}\n              data-testid=\"button-add-voice\"\n            >\n              {isListening ? (\n                <MicOff className=\"h-5 w-5\" />\n              ) : (\n                <Mic className=\"h-5 w-5\" />\n              )}\n              <span>{isListening ? 'Stop' : 'Voice Add'}</span>\n            </button>\n            \n            {/* Type Button */}\n            <button\n              onClick={() => addNewFoodItem()}\n              className=\"flex-1 bg-indigo-800/50 text-white py-4 px-6 rounded-2xl flex items-center justify-center space-x-3 shadow-md hover:scale-105 transition-all duration-300 hover:bg-indigo-700/50 hover:shadow-lg border border-orange-500/30\"\n              data-testid=\"button-add-type\"\n            >\n              <Plus className=\"h-5 w-5 text-orange-300\" />\n              <span className=\"font-semibold\">Type</span>\n            </button>\n          </div>\n        </div>\n        \n        {/* Always show editing tip */}\n        <div className=\"mt-4 p-3 bg-gradient-to-br from-indigo-950 via-purple-950 to-purple-900 rounded-lg border border-purple-500/20\">\n          <div className=\"flex items-start space-x-2\">\n            <Info className=\"h-4 w-4 text-blue-300 mt-0.5 flex-shrink-0\" />\n            <p className=\"text-sm text-purple-200\">\n              <strong className=\"text-white\">Quick Edit:</strong> Click any nutrition value (calories, protein, carbs, fat) to edit it directly. Click the <Edit3 className=\"h-3 w-3 inline mx-1\" /> icon to edit food names and portions, or use the <Trash2 className=\"h-3 w-3 inline mx-1\" /> icon to remove items. Remember to save your changes!\n            </p>\n          </div>\n        </div>\n        \n        {data.isAITemporarilyUnavailable && (\n          <div className=\"mt-3 p-3 bg-amber-50 dark:bg-amber-900/20 rounded-lg border border-amber-200 dark:border-amber-800\">\n            <div className=\"flex items-center space-x-2\">\n              <Info className=\"h-4 w-4 text-amber-600\" />\n              <p className=\"text-sm text-amber-700 dark:text-amber-300\">\n                <strong>AI Unavailable:</strong> These are estimated values. Edit them above for more accuracy.\n              </p>\n            </div>\n          </div>\n        )}\n      </motion.div>\n\n      {/* Nutrition Summary Cards - Now Second */}\n      <div className=\"grid grid-cols-2 gap-4\">\n        {/* Calories */}\n        <div className=\"modern-card bg-gradient-to-br from-red-50 to-orange-50 dark:from-red-900/10 dark:to-orange-900/10 p-5 border-0 relative overflow-hidden\">\n          <div className=\"absolute -top-2 -right-2 w-16 h-16 bg-red-200/20 dark:bg-red-800/20 rounded-full\"></div>\n          <div className=\"flex items-center justify-between mb-3 relative z-10\">\n            <span className=\"text-sm font-semibold text-red-700 dark:text-red-400\">Calories</span>\n            <div className=\"flex items-center gap-2\">\n              <button\n                onClick={() => startEditingSummary('calories', totals.calories)}\n                className=\"p-1.5 hover:bg-red-100 dark:hover:bg-red-900/30 rounded-lg transition-colors\"\n                aria-label=\"Edit calories\"\n                data-testid=\"button-edit-calories\"\n              >\n                <Edit3 className=\"h-3.5 w-3.5 text-red-600 dark:text-red-400\" />\n              </button>\n              <div className=\"w-8 h-8 bg-red-100 dark:bg-red-900/30 rounded-lg flex items-center justify-center\">\n                <i className=\"fas fa-fire text-red-500 dark:text-red-400\"></i>\n              </div>\n            </div>\n          </div>\n          {editingSummary?.field === 'calories' ? (\n            <input\n              type=\"number\"\n              value={editingSummary.value}\n              onChange={(e) => setEditingSummary(prev => prev ? { ...prev, value: e.target.value } : null)}\n              onBlur={saveSummaryEdit}\n              onKeyDown={handleSummaryKeyDown}\n              autoFocus\n              className=\"text-3xl font-bold text-red-600 dark:text-red-400 mb-1 w-full bg-white dark:bg-gray-800 border-2 border-red-400 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-red-500\"\n              data-testid=\"input-edit-calories\"\n            />\n          ) : (\n            <p className=\"text-3xl font-bold text-red-600 dark:text-red-400 mb-1\" data-testid=\"text-calories\">\n              {totals.calories}\n            </p>\n          )}\n          <p className=\"text-xs text-red-600/70 dark:text-red-400/70 font-medium\">\n            {Math.round((totals.calories / 2000) * 100)}% daily value\n          </p>\n        </div>\n\n        {/* Protein */}\n        <div className=\"modern-card bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/10 dark:to-indigo-900/10 p-5 border-0 relative overflow-hidden\">\n          <div className=\"absolute -top-2 -right-2 w-16 h-16 bg-blue-200/20 dark:bg-blue-800/20 rounded-full\"></div>\n          <div className=\"flex items-center justify-between mb-3 relative z-10\">\n            <span className=\"text-sm font-semibold text-blue-700 dark:text-blue-400\">Protein</span>\n            <div className=\"flex items-center gap-2\">\n              <button\n                onClick={() => startEditingSummary('protein', totals.protein)}\n                className=\"p-1.5 hover:bg-blue-100 dark:hover:bg-blue-900/30 rounded-lg transition-colors\"\n                aria-label=\"Edit protein\"\n                data-testid=\"button-edit-protein\"\n              >\n                <Edit3 className=\"h-3.5 w-3.5 text-blue-600 dark:text-blue-400\" />\n              </button>\n              <div className=\"w-8 h-8 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center\">\n                <i className=\"fas fa-dumbbell text-blue-500 dark:text-blue-400\"></i>\n              </div>\n            </div>\n          </div>\n          {editingSummary?.field === 'protein' ? (\n            <input\n              type=\"number\"\n              value={editingSummary.value}\n              onChange={(e) => setEditingSummary(prev => prev ? { ...prev, value: e.target.value } : null)}\n              onBlur={saveSummaryEdit}\n              onKeyDown={handleSummaryKeyDown}\n              autoFocus\n              className=\"text-3xl font-bold text-blue-600 dark:text-blue-400 mb-1 w-full bg-white dark:bg-gray-800 border-2 border-blue-400 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              data-testid=\"input-edit-protein\"\n            />\n          ) : (\n            <p className=\"text-3xl font-bold text-blue-600 dark:text-blue-400 mb-1\" data-testid=\"text-protein\">\n              {totals.protein}g\n            </p>\n          )}\n          <p className=\"text-xs text-blue-600/70 dark:text-blue-400/70 font-medium\">\n            {Math.round((totals.protein / 50) * 100)}% daily value\n          </p>\n        </div>\n\n        {/* Carbs */}\n        <div className=\"modern-card bg-gradient-to-br from-orange-50 to-amber-50 dark:from-orange-900/10 dark:to-amber-900/10 p-5 border-0 relative overflow-hidden\">\n          <div className=\"absolute -top-2 -right-2 w-16 h-16 bg-orange-200/20 dark:bg-orange-800/20 rounded-full\"></div>\n          <div className=\"flex items-center justify-between mb-3 relative z-10\">\n            <span className=\"text-sm font-semibold text-orange-700 dark:text-orange-400\">Carbs</span>\n            <div className=\"flex items-center gap-2\">\n              <button\n                onClick={() => startEditingSummary('carbs', totals.carbs)}\n                className=\"p-1.5 hover:bg-orange-100 dark:hover:bg-orange-900/30 rounded-lg transition-colors\"\n                aria-label=\"Edit carbs\"\n                data-testid=\"button-edit-carbs\"\n              >\n                <Edit3 className=\"h-3.5 w-3.5 text-orange-600 dark:text-orange-400\" />\n              </button>\n              <div className=\"w-8 h-8 bg-orange-100 dark:bg-orange-900/30 rounded-lg flex items-center justify-center\">\n                <i className=\"fas fa-bread-slice text-orange-500 dark:text-orange-400\"></i>\n              </div>\n            </div>\n          </div>\n          {editingSummary?.field === 'carbs' ? (\n            <input\n              type=\"number\"\n              value={editingSummary.value}\n              onChange={(e) => setEditingSummary(prev => prev ? { ...prev, value: e.target.value } : null)}\n              onBlur={saveSummaryEdit}\n              onKeyDown={handleSummaryKeyDown}\n              autoFocus\n              className=\"text-3xl font-bold text-orange-600 dark:text-orange-400 mb-1 w-full bg-white dark:bg-gray-800 border-2 border-orange-400 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-orange-500\"\n              data-testid=\"input-edit-carbs\"\n            />\n          ) : (\n            <p className=\"text-3xl font-bold text-orange-600 dark:text-orange-400 mb-1\" data-testid=\"text-carbs\">\n              {totals.carbs}g\n            </p>\n          )}\n          <p className=\"text-xs text-orange-600/70 dark:text-orange-400/70 font-medium\">\n            {Math.round((totals.carbs / 300) * 100)}% daily value\n          </p>\n        </div>\n\n        {/* Fat */}\n        <div className=\"modern-card bg-gradient-to-br from-yellow-50 to-amber-50 dark:from-yellow-900/10 dark:to-amber-900/10 p-5 border-0 relative overflow-hidden\">\n          <div className=\"absolute -top-2 -right-2 w-16 h-16 bg-yellow-200/20 dark:bg-yellow-800/20 rounded-full\"></div>\n          <div className=\"flex items-center justify-between mb-3 relative z-10\">\n            <span className=\"text-sm font-semibold text-yellow-700 dark:text-yellow-400\">Fat</span>\n            <div className=\"flex items-center gap-2\">\n              <button\n                onClick={() => startEditingSummary('fat', totals.fat)}\n                className=\"p-1.5 hover:bg-yellow-100 dark:hover:bg-yellow-900/30 rounded-lg transition-colors\"\n                aria-label=\"Edit fat\"\n                data-testid=\"button-edit-fat\"\n              >\n                <Edit3 className=\"h-3.5 w-3.5 text-yellow-600 dark:text-yellow-400\" />\n              </button>\n              <div className=\"w-8 h-8 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg flex items-center justify-center\">\n                <i className=\"fas fa-tint text-yellow-500 dark:text-yellow-400\"></i>\n              </div>\n            </div>\n          </div>\n          {editingSummary?.field === 'fat' ? (\n            <input\n              type=\"number\"\n              value={editingSummary.value}\n              onChange={(e) => setEditingSummary(prev => prev ? { ...prev, value: e.target.value } : null)}\n              onBlur={saveSummaryEdit}\n              onKeyDown={handleSummaryKeyDown}\n              autoFocus\n              className=\"text-3xl font-bold text-yellow-600 dark:text-yellow-400 mb-1 w-full bg-white dark:bg-gray-800 border-2 border-yellow-400 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-yellow-500\"\n              data-testid=\"input-edit-fat\"\n            />\n          ) : (\n            <p className=\"text-3xl font-bold text-yellow-600 dark:text-yellow-400 mb-1\" data-testid=\"text-fat\">\n              {totals.fat}g\n            </p>\n          )}\n          <p className=\"text-xs text-yellow-600/70 dark:text-yellow-400/70 font-medium\">\n            {Math.round((totals.fat / 65) * 100)}% daily value\n          </p>\n        </div>\n      </div>\n\n      {/* Macro Breakdown Chart */}\n      <div className=\"bg-card rounded-xl shadow-lg p-6\">\n        <h3 className=\"text-lg font-semibold mb-4 flex items-center\">\n          <PieChart className=\"text-primary mr-2 h-5 w-5\" />\n          Macronutrient Breakdown\n        </h3>\n        \n        <div className=\"space-y-4\">\n          {/* Protein */}\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"w-4 h-4 bg-blue-500 rounded-full\"></div>\n              <span className=\"font-medium\">Protein</span>\n            </div>\n            <span className=\"text-sm text-muted-foreground\" data-testid=\"text-protein-percent\">\n              {macroPercentages.protein}%\n            </span>\n          </div>\n          <div className=\"w-full bg-muted rounded-full h-2\">\n            <div \n              className=\"bg-blue-500 h-2 rounded-full transition-all duration-1000\" \n              style={{width: `${macroPercentages.protein}%`}}\n            ></div>\n          </div>\n\n          {/* Carbohydrates */}\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"w-4 h-4 bg-orange-500 rounded-full\"></div>\n              <span className=\"font-medium\">Carbohydrates</span>\n            </div>\n            <span className=\"text-sm text-muted-foreground\" data-testid=\"text-carbs-percent\">\n              {macroPercentages.carbs}%\n            </span>\n          </div>\n          <div className=\"w-full bg-muted rounded-full h-2\">\n            <div \n              className=\"bg-orange-500 h-2 rounded-full transition-all duration-1000\" \n              style={{width: `${macroPercentages.carbs}%`}}\n            ></div>\n          </div>\n\n          {/* Fat */}\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"w-4 h-4 bg-yellow-500 rounded-full\"></div>\n              <span className=\"font-medium\">Fat</span>\n            </div>\n            <span className=\"text-sm text-muted-foreground\" data-testid=\"text-fat-percent\">\n              {macroPercentages.fat}%\n            </span>\n          </div>\n          <div className=\"w-full bg-muted rounded-full h-2\">\n            <div \n              className=\"bg-yellow-500 h-2 rounded-full transition-all duration-1000\" \n              style={{width: `${macroPercentages.fat}%`}}\n            ></div>\n          </div>\n        </div>\n      </div>\n\n      {/* Action buttons */}\n      <div className=\"flex space-x-4 pt-6\">\n        <button \n          className=\"flex-1 gradient-button py-4 px-6 rounded-xl font-medium hover:scale-[1.02] flex items-center justify-center space-x-2\"\n          onClick={() => setShowDiaryDialog(true)}\n          data-testid=\"button-add-diary\"\n        >\n          <Plus className=\"h-5 w-5\" />\n          <span>Save to Diary</span>\n        </button>\n        <button \n          className=\"flex-1 modern-card bg-gradient-to-br from-gray-50 to-slate-50 dark:from-gray-800/50 dark:to-slate-800/50 text-gray-700 dark:text-gray-300 py-4 px-6 rounded-xl font-medium hover:scale-[1.02] smooth-transition flex items-center justify-center space-x-2\"\n          onClick={onScanAnother}\n          data-testid=\"button-scan-another\"\n        >\n          <Camera className=\"h-5 w-5\" />\n          <span>Scan Another</span>\n        </button>\n      </div>\n\n      {/* Save to Diary Dialog */}\n      {showDiaryDialog && (\n        <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-in fade-in duration-300\">\n          <div className=\"bg-gradient-to-br from-white via-slate-50 to-blue-50 dark:from-gray-900 dark:via-gray-800 dark:to-blue-900/20 rounded-2xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto shadow-2xl border border-white/20 dark:border-gray-700/50 animate-in slide-in-from-bottom-4 duration-300\">\n            \n            {/* Beautiful Header */}\n            <div className=\"text-center mb-8\">\n              <div className=\"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl shadow-lg mb-4\">\n                <Plus className=\"h-8 w-8 text-white\" />\n              </div>\n              <h3 className=\"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent\">\n                Save to Food Diary\n              </h3>\n              <p className=\"text-sm text-muted-foreground mt-1\">Track your delicious meal</p>\n            </div>\n            \n            <div className=\"space-y-6\">\n              {/* Enhanced Meal Type Selection */}\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3\">\n                  ðŸ½ï¸ Meal Type\n                </label>\n                <div className=\"grid grid-cols-2 gap-3\">\n                  {[\n                    { type: 'breakfast', icon: 'ðŸŒ…', gradient: 'from-orange-400 to-yellow-400' },\n                    { type: 'lunch', icon: 'â˜€ï¸', gradient: 'from-green-400 to-blue-400' },\n                    { type: 'dinner', icon: 'ðŸŒ™', gradient: 'from-purple-400 to-pink-400' },\n                    { type: 'snack', icon: 'ðŸ¿', gradient: 'from-pink-400 to-red-400' }\n                  ].map((meal) => (\n                    <button\n                      key={meal.type}\n                      onClick={() => setSelectedMealType(meal.type as any)}\n                      className={`relative p-4 rounded-xl text-sm font-medium transition-all duration-300 transform hover:scale-105 hover:shadow-lg ${\n                        selectedMealType === meal.type\n                          ? `bg-gradient-to-r ${meal.gradient} text-white shadow-xl scale-105`\n                          : 'bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 border border-gray-200 dark:border-gray-600'\n                      }`}\n                      data-testid={`button-meal-${meal.type}`}\n                    >\n                      <div className=\"text-2xl mb-1\">{meal.icon}</div>\n                      <div className=\"capitalize font-semibold\">{meal.type}</div>\n                      {selectedMealType === meal.type && (\n                        <div className=\"absolute inset-0 rounded-xl ring-2 ring-white ring-offset-2 ring-offset-transparent\"></div>\n                      )}\n                    </button>\n                  ))}\n                </div>\n              </div>\n\n              {/* Enhanced Date Selection */}\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3\">\n                  ðŸ“… Date\n                </label>\n                <div className=\"relative\">\n                  <Calendar className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                  <input\n                    type=\"date\"\n                    value={selectedDate}\n                    onChange={(e) => setSelectedDate(e.target.value)}\n                    className=\"w-full pl-11 pr-4 py-3 border border-gray-200 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-800 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 shadow-sm hover:shadow-md\"\n                    data-testid=\"input-meal-date\"\n                  />\n                </div>\n              </div>\n\n              {/* Enhanced Time Selection */}\n              <div>\n                <label className=\"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3\">\n                  â° Time\n                </label>\n                <div className=\"relative\">\n                  <Clock className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                  <input\n                    type=\"time\"\n                    value={selectedTime}\n                    onChange={(e) => setSelectedTime(e.target.value)}\n                    className=\"w-full pl-11 pr-4 py-3 border border-gray-200 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-800 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 shadow-sm hover:shadow-md\"\n                    data-testid=\"input-meal-time\"\n                  />\n                </div>\n              </div>\n            </div>\n\n            {/* Enhanced Dialog Actions - Always visible */}\n            <div className=\"flex space-x-4 mt-6 pt-4 border-t border-gray-200 dark:border-gray-600 bg-white/50 dark:bg-gray-800/50 -mx-6 px-6 -mb-6 pb-6 rounded-b-2xl\">\n              <button\n                onClick={() => setShowDiaryDialog(false)}\n                className=\"flex-1 py-3 px-6 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-xl font-semibold hover:bg-gray-200 dark:hover:bg-gray-600 transition-all duration-200 transform hover:scale-105 shadow-sm hover:shadow-md\"\n                data-testid=\"button-cancel-diary\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={() => addToDiaryMutation.mutate()}\n                disabled={addToDiaryMutation.isPending}\n                className=\"flex-1 py-3 px-6 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white rounded-xl font-semibold transition-all duration-200 transform hover:scale-105 shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none\"\n                data-testid=\"button-save-diary\"\n              >\n                <Plus className=\"h-5 w-5 mr-2 inline\" />\n                {addToDiaryMutation.isPending ? (\n                  <span className=\"flex items-center\">\n                    <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\n                    Saving...\n                  </span>\n                ) : (\n                  'Save to Diary'\n                )}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Voice Meal Confirmation Dialog */}\n      {showVoiceMealDialog && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4 backdrop-blur-sm\">\n          <div className=\"bg-card rounded-2xl p-6 w-full max-w-md shadow-2xl border border-border/20\">\n            <h3 className=\"text-xl font-bold mb-6 flex items-center gap-3\">\n              <div className=\"p-2 bg-primary/10 rounded-lg\">\n                <Mic className=\"h-6 w-6 text-primary\" />\n              </div>\n              Voice Input Captured\n            </h3>\n            \n            <div className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-muted-foreground mb-2\">\n                  What did I hear?\n                </label>\n                <div className=\"p-3 bg-muted rounded-lg border\">\n                  <p className=\"text-foreground font-medium\">\"{voiceInput}\"</p>\n                </div>\n              </div>\n              \n              <div>\n                <label className=\"block text-sm font-semibold text-foreground mb-2\">\n                  ðŸ½ï¸ Food Name\n                </label>\n                <input\n                  type=\"text\"\n                  value={voiceFoodName}\n                  onChange={(e) => setVoiceFoodName(e.target.value)}\n                  placeholder=\"e.g., chicken breast, salmon\"\n                  className=\"w-full px-4 py-2 border rounded-lg bg-background focus:ring-2 focus:ring-primary focus:border-transparent\"\n                  data-testid=\"input-voice-food-name\"\n                />\n              </div>\n              \n              <div>\n                <label className=\"block text-sm font-semibold text-foreground mb-2\">\n                  ðŸ“ Portion Size\n                </label>\n                <div className=\"flex gap-2\">\n                  <input\n                    type=\"number\"\n                    value={voicePortionAmount}\n                    onChange={(e) => setVoicePortionAmount(e.target.value)}\n                    min=\"0\"\n                    step=\"0.1\"\n                    placeholder=\"Amount\"\n                    className=\"flex-1 px-4 py-2 border rounded-lg bg-background focus:ring-2 focus:ring-primary focus:border-transparent\"\n                    data-testid=\"input-voice-portion-amount\"\n                  />\n                  <select\n                    value={voicePortionUnit}\n                    onChange={(e) => setVoicePortionUnit(e.target.value)}\n                    className=\"px-4 py-2 border rounded-lg bg-background focus:ring-2 focus:ring-primary focus:border-transparent\"\n                    data-testid=\"select-voice-portion-unit\"\n                  >\n                    <option value=\"g\">g</option>\n                    <option value=\"kg\">kg</option>\n                    <option value=\"oz\">oz</option>\n                    <option value=\"lb\">lb</option>\n                    <option value=\"cup\">cup</option>\n                    <option value=\"tbsp\">tbsp</option>\n                    <option value=\"tsp\">tsp</option>\n                    <option value=\"ml\">ml</option>\n                    <option value=\"L\">L</option>\n                    <option value=\"serving\">serving</option>\n                    <option value=\"slice\">slice</option>\n                    <option value=\"piece\">piece</option>\n                  </select>\n                </div>\n                \n                {/* Quick Portion Presets */}\n                <div className=\"mt-2 flex flex-wrap gap-2\">\n                  <button\n                    onClick={() => { setVoicePortionAmount('100'); setVoicePortionUnit('g'); }}\n                    className=\"px-3 py-1 text-xs bg-muted hover:bg-muted/80 rounded-md transition-colors\"\n                    data-testid=\"preset-100g\"\n                  >\n                    100g\n                  </button>\n                  <button\n                    onClick={() => { setVoicePortionAmount('200'); setVoicePortionUnit('g'); }}\n                    className=\"px-3 py-1 text-xs bg-muted hover:bg-muted/80 rounded-md transition-colors\"\n                    data-testid=\"preset-200g\"\n                  >\n                    200g\n                  </button>\n                  <button\n                    onClick={() => { setVoicePortionAmount('1'); setVoicePortionUnit('serving'); }}\n                    className=\"px-3 py-1 text-xs bg-muted hover:bg-muted/80 rounded-md transition-colors\"\n                    data-testid=\"preset-1-serving\"\n                  >\n                    1 serving\n                  </button>\n                  <button\n                    onClick={() => { setVoicePortionAmount('1'); setVoicePortionUnit('cup'); }}\n                    className=\"px-3 py-1 text-xs bg-muted hover:bg-muted/80 rounded-md transition-colors\"\n                    data-testid=\"preset-1-cup\"\n                  >\n                    1 cup\n                  </button>\n                </div>\n              </div>\n              \n              <div className=\"p-3 bg-primary/10 rounded-lg border border-primary/20\">\n                <p className=\"text-sm text-foreground font-medium\">\n                  Preview: {voicePortionAmount} {voicePortionUnit} {voiceFoodName}\n                </p>\n              </div>\n            </div>\n\n            <div className=\"flex space-x-3 mt-6\">\n              <button\n                onClick={() => {\n                  setShowVoiceMealDialog(false);\n                  setVoiceInput('');\n                  setVoiceFoodName('');\n                  setVoicePortionAmount('100');\n                  setVoicePortionUnit('g');\n                }}\n                className=\"flex-1 py-2 px-4 bg-muted text-muted-foreground rounded-lg hover:bg-muted/80 transition-colors\"\n                data-testid=\"button-cancel-voice\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleConfirmVoiceFood}\n                disabled={addVoiceMealMutation.isPending || !voiceFoodName.trim()}\n                className=\"flex-1 py-2 px-4 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2\"\n                data-testid=\"button-confirm-voice\"\n              >\n                {addVoiceMealMutation.isPending ? (\n                  <>\n                    <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white\"></div>\n                    <span>Adding...</span>\n                  </>\n                ) : (\n                  <>\n                    <Plus className=\"h-4 w-4\" />\n                    <span>Add Food</span>\n                  </>\n                )}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Manual Food Entry Dialog */}\n      {showManualEntryDialog && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4 backdrop-blur-sm\">\n          <div className=\"bg-card rounded-2xl p-6 w-full max-w-md shadow-2xl border border-border/20\">\n            <h3 className=\"text-xl font-bold mb-6 flex items-center gap-3\">\n              <div className=\"p-2 bg-primary/10 rounded-lg\">\n                <Plus className=\"h-6 w-6 text-primary\" />\n              </div>\n              Add Food Manually\n            </h3>\n            \n            <div className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-semibold text-foreground mb-2\">\n                  ðŸ½ï¸ Food Name\n                </label>\n                <input\n                  type=\"text\"\n                  value={manualFoodName}\n                  onChange={(e) => setManualFoodName(e.target.value)}\n                  placeholder=\"e.g., chicken breast, salmon, rice\"\n                  className=\"w-full px-4 py-2 border rounded-lg bg-background focus:ring-2 focus:ring-primary focus:border-transparent\"\n                  data-testid=\"input-manual-food-name\"\n                  autoFocus\n                />\n              </div>\n              \n              <div>\n                <label className=\"block text-sm font-semibold text-foreground mb-2\">\n                  ðŸ“ Portion Size\n                </label>\n                <div className=\"flex gap-2\">\n                  <input\n                    type=\"number\"\n                    value={manualPortionAmount}\n                    onChange={(e) => setManualPortionAmount(e.target.value)}\n                    min=\"0\"\n                    step=\"0.1\"\n                    placeholder=\"Amount\"\n                    className=\"flex-1 px-4 py-2 border rounded-lg bg-background focus:ring-2 focus:ring-primary focus:border-transparent\"\n                    data-testid=\"input-manual-portion-amount\"\n                  />\n                  <select\n                    value={manualPortionUnit}\n                    onChange={(e) => setManualPortionUnit(e.target.value)}\n                    className=\"px-4 py-2 border rounded-lg bg-background focus:ring-2 focus:ring-primary focus:border-transparent\"\n                    data-testid=\"select-manual-portion-unit\"\n                  >\n                    <option value=\"g\">g</option>\n                    <option value=\"kg\">kg</option>\n                    <option value=\"oz\">oz</option>\n                    <option value=\"lb\">lb</option>\n                    <option value=\"cup\">cup</option>\n                    <option value=\"tbsp\">tbsp</option>\n                    <option value=\"tsp\">tsp</option>\n                    <option value=\"ml\">ml</option>\n                    <option value=\"L\">L</option>\n                    <option value=\"serving\">serving</option>\n                    <option value=\"slice\">slice</option>\n                    <option value=\"piece\">piece</option>\n                  </select>\n                </div>\n                \n                {/* Quick Portion Presets */}\n                <div className=\"mt-2 flex flex-wrap gap-2\">\n                  <button\n                    onClick={() => { setManualPortionAmount('100'); setManualPortionUnit('g'); }}\n                    className=\"px-3 py-1 text-xs bg-muted hover:bg-muted/80 rounded-md transition-colors\"\n                    data-testid=\"preset-manual-100g\"\n                  >\n                    100g\n                  </button>\n                  <button\n                    onClick={() => { setManualPortionAmount('200'); setManualPortionUnit('g'); }}\n                    className=\"px-3 py-1 text-xs bg-muted hover:bg-muted/80 rounded-md transition-colors\"\n                    data-testid=\"preset-manual-200g\"\n                  >\n                    200g\n                  </button>\n                  <button\n                    onClick={() => { setManualPortionAmount('1'); setManualPortionUnit('serving'); }}\n                    className=\"px-3 py-1 text-xs bg-muted hover:bg-muted/80 rounded-md transition-colors\"\n                    data-testid=\"preset-manual-1-serving\"\n                  >\n                    1 serving\n                  </button>\n                  <button\n                    onClick={() => { setManualPortionAmount('1'); setManualPortionUnit('cup'); }}\n                    className=\"px-3 py-1 text-xs bg-muted hover:bg-muted/80 rounded-md transition-colors\"\n                    data-testid=\"preset-manual-1-cup\"\n                  >\n                    1 cup\n                  </button>\n                </div>\n              </div>\n              \n              <div className=\"p-3 bg-primary/10 rounded-lg border border-primary/20\">\n                <p className=\"text-sm text-foreground font-medium\">\n                  Preview: {manualPortionAmount} {manualPortionUnit} {manualFoodName || '...'}\n                </p>\n              </div>\n            </div>\n\n            <div className=\"flex space-x-3 mt-6\">\n              <button\n                onClick={() => {\n                  setShowManualEntryDialog(false);\n                  setManualFoodName('');\n                  setManualPortionAmount('100');\n                  setManualPortionUnit('g');\n                }}\n                className=\"flex-1 py-2 px-4 bg-muted text-muted-foreground rounded-lg hover:bg-muted/80 transition-colors\"\n                data-testid=\"button-cancel-manual\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleConfirmManualFood}\n                disabled={addManualMealMutation.isPending || !manualFoodName.trim()}\n                className=\"flex-1 py-2 px-4 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2\"\n                data-testid=\"button-confirm-manual\"\n              >\n                {addManualMealMutation.isPending ? (\n                  <>\n                    <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white\"></div>\n                    <span>Adding...</span>\n                  </>\n                ) : (\n                  <>\n                    <Plus className=\"h-4 w-4\" />\n                    <span>Add Food</span>\n                  </>\n                )}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Low Confidence Warning Dialog */}\n      {showLowConfidenceDialog && (\n        <div className=\"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-3 sm:p-4 animate-in fade-in duration-300\">\n          <div className=\"bg-gradient-to-br from-white via-orange-50 to-red-50 dark:from-gray-900 dark:via-orange-900/20 dark:to-red-900/20 rounded-2xl p-4 sm:p-6 w-full max-w-md shadow-2xl border border-orange-200/50 dark:border-orange-700/50 animate-in slide-in-from-bottom-4 duration-300\">\n            \n            {/* Warning Header */}\n            <div className=\"text-center mb-6\">\n              <div className=\"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-orange-500 to-red-500 rounded-2xl shadow-lg mb-4\">\n                <AlertTriangle className=\"h-8 w-8 text-white\" />\n              </div>\n              <h3 className=\"text-2xl font-bold bg-gradient-to-r from-orange-600 to-red-600 bg-clip-text text-transparent\">\n                Low Confidence Detection\n              </h3>\n              <p className=\"text-sm text-muted-foreground mt-2\">\n                AI confidence: <span className=\"font-semibold text-orange-600 dark:text-orange-400\">{data.confidence}%</span>\n              </p>\n            </div>\n            \n            {/* Warning Content */}\n            <div className=\"space-y-4 mb-6\">\n              <div className=\"p-4 bg-orange-100 dark:bg-orange-900/30 rounded-xl border border-orange-200 dark:border-orange-700\">\n                <div className=\"flex items-start space-x-3\">\n                  <Info className=\"h-5 w-5 text-orange-600 dark:text-orange-400 mt-0.5 flex-shrink-0\" />\n                  <div className=\"text-sm text-orange-800 dark:text-orange-200\">\n                    <p className=\"font-medium mb-1\">The AI is less confident about this analysis.</p>\n                    <p>Please review the detected foods and portions. You can edit them before saving to your diary.</p>\n                  </div>\n                </div>\n              </div>\n              \n              <div className=\"text-sm text-muted-foreground\">\n                <p>Tip: Taking photos with better lighting and closer angles helps improve accuracy.</p>\n              </div>\n            </div>\n\n            {/* Action Buttons */}\n            <div className=\"flex flex-col sm:flex-row gap-3\">\n              <button\n                onClick={() => setShowLowConfidenceDialog(false)}\n                className=\"flex-1 py-3 px-4 bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300 rounded-xl font-semibold hover:bg-orange-200 dark:hover:bg-orange-900/50 transition-all duration-200 transform hover:scale-105 shadow-sm hover:shadow-md border border-orange-200 dark:border-orange-700 flex items-center justify-center\"\n                data-testid=\"button-review-foods\"\n              >\n                <Edit3 className=\"h-4 w-4 mr-2\" aria-hidden=\"true\" />\n                <span className=\"whitespace-nowrap\">Review & Edit</span>\n              </button>\n              <button\n                onClick={() => {\n                  setShowLowConfidenceDialog(false);\n                  setShowDiaryDialog(true);\n                }}\n                className=\"flex-1 py-3 px-4 bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700 text-white rounded-xl font-semibold transition-all duration-200 transform hover:scale-105 shadow-lg hover:shadow-xl flex items-center justify-center\"\n                data-testid=\"button-proceed-anyway\"\n              >\n                <Check className=\"h-4 w-4 mr-2\" aria-hidden=\"true\" />\n                <span className=\"whitespace-nowrap\">Use Anyway</span>\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </motion.div>\n  );\n}\n","size_bytes":103234},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","size_bytes":1883},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \"var(--radius)\",\n        md: \"calc(var(--radius) - 2px)\",\n        sm: \"calc(var(--radius) - 4px)\",\n      },\n      colors: {\n        background: \"var(--background)\",\n        foreground: \"var(--foreground)\",\n        card: {\n          DEFAULT: \"var(--card)\",\n          foreground: \"var(--card-foreground)\",\n        },\n        popover: {\n          DEFAULT: \"var(--popover)\",\n          foreground: \"var(--popover-foreground)\",\n        },\n        primary: {\n          DEFAULT: \"var(--primary)\",\n          foreground: \"var(--primary-foreground)\",\n        },\n        secondary: {\n          DEFAULT: \"var(--secondary)\",\n          foreground: \"var(--secondary-foreground)\",\n        },\n        muted: {\n          DEFAULT: \"var(--muted)\",\n          foreground: \"var(--muted-foreground)\",\n        },\n        accent: {\n          DEFAULT: \"var(--accent)\",\n          foreground: \"var(--accent-foreground)\",\n        },\n        destructive: {\n          DEFAULT: \"var(--destructive)\",\n          foreground: \"var(--destructive-foreground)\",\n        },\n        border: \"var(--border)\",\n        input: \"var(--input)\",\n        ring: \"var(--ring)\",\n        chart: {\n          \"1\": \"var(--chart-1)\",\n          \"2\": \"var(--chart-2)\",\n          \"3\": \"var(--chart-3)\",\n          \"4\": \"var(--chart-4)\",\n          \"5\": \"var(--chart-5)\",\n        },\n        sidebar: {\n          DEFAULT: \"var(--sidebar-background)\",\n          foreground: \"var(--sidebar-foreground)\",\n          primary: \"var(--sidebar-primary)\",\n          \"primary-foreground\": \"var(--sidebar-primary-foreground)\",\n          accent: \"var(--sidebar-accent)\",\n          \"accent-foreground\": \"var(--sidebar-accent-foreground)\",\n          border: \"var(--sidebar-border)\",\n          ring: \"var(--sidebar-ring)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"var(--font-mono)\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: {\n            height: \"0\",\n          },\n          to: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n        },\n        \"accordion-up\": {\n          from: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n          to: {\n            height: \"0\",\n          },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":2766},"ios/App/App/public/assets/web-DNXzBeur.js":{"content":"import{W as t}from\"./index-BfQ6GJWf.js\";class s extends t{constructor(){super(),this.handleVisibilityChange=()=>{const e={isActive:document.hidden!==!0};this.notifyListeners(\"appStateChange\",e),document.hidden?this.notifyListeners(\"pause\",null):this.notifyListeners(\"resume\",null)},document.addEventListener(\"visibilitychange\",this.handleVisibilityChange,!1)}exitApp(){throw this.unimplemented(\"Not implemented on web.\")}async getInfo(){throw this.unimplemented(\"Not implemented on web.\")}async getLaunchUrl(){return{url:\"\"}}async getState(){return{isActive:document.hidden!==!0}}async minimizeApp(){throw this.unimplemented(\"Not implemented on web.\")}async toggleBackButtonHandler(){throw this.unimplemented(\"Not implemented on web.\")}}export{s as AppWeb};\n","size_bytes":758},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":711},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","size_bytes":791},"client/src/pages/RecipesPage.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useLocation, Link } from \"wouter\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { DropdownNavigation } from \"@/components/dropdown-navigation\";\nimport { BottomHelpSection } from \"@/components/bottom-help-section\";\nimport { ShoppingListDialog } from \"@/components/shopping-list-dialog\";\nimport { ChefHat, Clock, Users, ExternalLink, Filter, Utensils, ArrowLeft, RefreshCw, Heart, Bookmark, Trash2, ShoppingCart } from \"lucide-react\";\nimport { motion } from \"framer-motion\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { soundService } from \"@/lib/sound-service\";\n\nconst DIETARY_REQUIREMENTS = [\n  { value: \"all\", label: \"All Recipes\" },\n  { value: \"keto\", label: \"Keto\" },\n  { value: \"vegan\", label: \"Vegan\" },\n  { value: \"vegetarian\", label: \"Vegetarian\" },\n  { value: \"pescatarian\", label: \"Pescatarian\" },\n  { value: \"high-protein\", label: \"High Protein\" },\n  { value: \"high-fiber\", label: \"High Fiber\" },\n  { value: \"low-residue\", label: \"Low Residue\" },\n  { value: \"gluten-free\", label: \"Gluten Free\" },\n  { value: \"dairy-free\", label: \"Dairy Free\" },\n  { value: \"low-carb\", label: \"Low Carb\" },\n  { value: \"paleo\", label: \"Paleo\" },\n  { value: \"mediterranean\", label: \"Mediterranean\" }\n];\n\ninterface Recipe {\n  id: string;\n  name: string;\n  description: string;\n  calories: number;\n  protein: number;\n  carbs: number;\n  fat: number;\n  servings: number;\n  prepTime: number;\n  cookTime: number;\n  difficulty: \"Easy\" | \"Medium\" | \"Hard\";\n  ingredients: string[];\n  instructions: string[];\n  tags: string[];\n  dietaryInfo: string[];\n  recipeLink?: string;\n}\n\nexport function RecipesPage() {\n  const [selectedDiet, setSelectedDiet] = useState(\"all\");\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [, navigate] = useLocation();\n  const [expandedIngredients, setExpandedIngredients] = useState<Set<string>>(new Set());\n  const [expandedInstructions, setExpandedInstructions] = useState<Set<string>>(new Set());\n  const [viewMode, setViewMode] = useState<\"all\" | \"saved\">(\"all\");\n  const [selectedRecipes, setSelectedRecipes] = useState<Set<string>>(new Set());\n  const [showShoppingList, setShowShoppingList] = useState(false);\n  const { toast } = useToast();\n\n  // Fetch user profile for auto-filtering\n  const { data: userProfile } = useQuery<any>({\n    queryKey: ['/api/user-profile'],\n  });\n\n  // Get diet filter from URL parameters or user profile\n  useEffect(() => {\n    const urlParams = new URLSearchParams(window.location.search);\n    const dietParam = urlParams.get('diet');\n    const viewParam = urlParams.get('view');\n    \n    // Auto-open shopping list if view=shopping-list parameter is present\n    if (viewParam === 'shopping-list') {\n      setShowShoppingList(true);\n    }\n    \n    if (dietParam) {\n      // URL parameter takes precedence (manual override)\n      setSelectedDiet(dietParam);\n    } else if (userProfile && userProfile.dietaryRequirements && userProfile.dietaryRequirements.length > 0) {\n      // Auto-set based on user's first dietary requirement\n      const userDiet = userProfile.dietaryRequirements[0].toLowerCase();\n      // Check if it matches one of our filter options\n      const matchingDiet = DIETARY_REQUIREMENTS.find(d => d.value === userDiet);\n      if (matchingDiet) {\n        setSelectedDiet(userDiet);\n      }\n    } else {\n      setSelectedDiet('all');\n    }\n  }, [userProfile]);\n\n  // Update URL when diet filter changes\n  const handleDietChange = (newDiet: string) => {\n    setSelectedDiet(newDiet);\n    const newUrl = newDiet && newDiet !== 'all' ? `/recipes?diet=${newDiet}` : '/recipes';\n    navigate(newUrl);\n  };\n\n  const { data: recipes, isLoading, error } = useQuery<Recipe[]>({\n    queryKey: [\"/api/recipes\", selectedDiet === 'all' ? '' : selectedDiet, searchQuery],\n    queryFn: async () => {\n      // Build URL properly to avoid double slashes\n      let url = '/api/recipes';\n      const dietParam = selectedDiet === 'all' ? '' : selectedDiet;\n      \n      if (dietParam && searchQuery) {\n        url = `/api/recipes/${dietParam}/${searchQuery}`;\n      } else if (dietParam) {\n        url = `/api/recipes/${dietParam}`;\n      } else if (searchQuery) {\n        url = `/api/recipes/_/${searchQuery}`;\n      }\n      \n      console.log('Fetching recipes from:', url);\n      const response = await fetch(url);\n      if (!response.ok) {\n        throw new Error(`Failed to fetch recipes: ${response.status} ${response.statusText}`);\n      }\n      const data = await response.json();\n      console.log('Received recipes:', data);\n      return data;\n    },\n    retry: 3,\n    retryDelay: 1000,\n    staleTime: 30000, // Cache for 30 seconds\n    enabled: viewMode === \"all\"\n  });\n\n  // Fetch saved recipes (always enabled to check save status)\n  const { data: savedRecipes, isLoading: savedLoading } = useQuery<Recipe[]>({\n    queryKey: [\"/api/recipes/saved\"]\n    // Note: Server has caching disabled, so no custom queryFn needed\n  });\n\n  // Refresh recipes mutation\n  const refreshMutation = useMutation({\n    mutationFn: async () => {\n      const response = await apiRequest(\n        \"POST\",\n        \"/api/recipes/refresh\",\n        { dietary: selectedDiet === 'all' ? '' : selectedDiet }\n      );\n      return response;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/recipes\"] });\n      soundService.playSuccess();\n      toast({\n        title: \"Recipes refreshed!\",\n        description: \"New recipes have been generated for you.\",\n      });\n    },\n    onError: () => {\n      soundService.playError();\n      toast({\n        title: \"Refresh failed\",\n        description: \"Unable to refresh recipes. Please try again.\",\n        variant: \"destructive\"\n      });\n    }\n  });\n\n  // Save recipe mutation\n  const saveMutation = useMutation({\n    mutationFn: async (recipe: Recipe) => {\n      return apiRequest(\n        \"POST\",\n        \"/api/recipes/save\",\n        {\n          recipeId: recipe.id,\n          recipeName: recipe.name,\n          recipeData: recipe\n        }\n      );\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/recipes/saved\"] });\n      soundService.playSuccess();\n      toast({\n        title: \"Recipe saved!\",\n        description: \"Added to your saved recipes.\",\n      });\n    },\n    onError: (error: any) => {\n      soundService.playError();\n      toast({\n        title: \"Save failed\",\n        description: error.message || \"Unable to save recipe.\",\n        variant: \"destructive\"\n      });\n    }\n  });\n\n  // Unsave recipe mutation\n  const unsaveMutation = useMutation({\n    mutationFn: async (recipeId: string) => {\n      return apiRequest(\"DELETE\", `/api/recipes/save/${recipeId}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/recipes/saved\"], refetchType: 'active' });\n      queryClient.refetchQueries({ queryKey: [\"/api/recipes/saved\"] });\n      soundService.playClick();\n      toast({\n        title: \"Recipe removed\",\n        description: \"Removed from your saved recipes.\",\n      });\n    },\n    onError: () => {\n      soundService.playError();\n      toast({\n        title: \"Remove failed\",\n        description: \"Unable to remove recipe.\",\n        variant: \"destructive\"\n      });\n    }\n  });\n\n  const filteredRecipes = viewMode === \"all\" ? (recipes || []) : (savedRecipes || []);\n  const currentLoading = viewMode === \"all\" ? isLoading : savedLoading;\n\n  // Check if a recipe is saved\n  const isSaved = (recipeId: string) => {\n    return savedRecipes?.some(r => r.id === recipeId) || false;\n  };\n\n  const handleSaveToggle = (recipe: Recipe) => {\n    if (isSaved(recipe.id)) {\n      unsaveMutation.mutate(recipe.id);\n    } else {\n      saveMutation.mutate(recipe);\n    }\n  };\n\n  const toggleIngredients = (recipeId: string) => {\n    setExpandedIngredients(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(recipeId)) {\n        newSet.delete(recipeId);\n      } else {\n        newSet.add(recipeId);\n      }\n      return newSet;\n    });\n  };\n\n  const toggleInstructions = (recipeId: string) => {\n    setExpandedInstructions(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(recipeId)) {\n        newSet.delete(recipeId);\n      } else {\n        newSet.add(recipeId);\n      }\n      return newSet;\n    });\n  };\n\n  const toggleRecipeSelection = (recipeId: string) => {\n    setSelectedRecipes(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(recipeId)) {\n        newSet.delete(recipeId);\n      } else {\n        newSet.add(recipeId);\n      }\n      return newSet;\n    });\n  };\n\n  const clearSelection = () => {\n    setSelectedRecipes(new Set());\n  };\n\n  const getSelectedRecipeObjects = (): Recipe[] => {\n    if (!savedRecipes) return [];\n    return savedRecipes.filter(recipe => selectedRecipes.has(recipe.id));\n  };\n\n  return (\n    <motion.div \n      initial={{ opacity: 0, scale: 0.95, y: 20 }}\n      animate={{ opacity: 1, scale: 1, y: 0 }}\n      transition={{ duration: 0.6, ease: \"easeOut\" }}\n      className=\"min-h-screen text-foreground\" \n      style={{background: 'var(--bg-gradient)'}}\n    >\n      {/* Header */}\n      <div className=\"bg-card border-b\">\n        <div className=\"max-w-md mx-auto px-4 py-4\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <div className=\"flex items-center space-x-3\">\n              <h1 className=\"text-xl font-bold\">\n                {viewMode === \"saved\" ? \"Saved Recipes\" : \"Recipe Collection\"}\n              </h1>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              {viewMode === \"saved\" && (\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => setViewMode(\"all\")}\n                  data-testid=\"button-back-to-all\"\n                >\n                  <ArrowLeft className=\"h-4 w-4 mr-2\" />\n                  Back to All\n                </Button>\n              )}\n              {viewMode === \"all\" && (\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => refreshMutation.mutate()}\n                  disabled={refreshMutation.isPending}\n                  data-testid=\"button-refresh-recipes\"\n                >\n                  <RefreshCw className={`h-4 w-4 mr-2 ${refreshMutation.isPending ? 'animate-spin' : ''}`} />\n                  Refresh\n                </Button>\n              )}\n            </div>\n          </div>\n          \n          {/* View Mode Toggle */}\n          <div className=\"flex gap-2 mb-4\">\n            <Button\n              variant={viewMode === \"all\" ? \"default\" : \"outline\"}\n              size=\"sm\"\n              onClick={() => setViewMode(\"all\")}\n              className=\"flex-1\"\n              data-testid=\"button-view-all\"\n            >\n              <Utensils className=\"h-4 w-4 mr-2\" />\n              All Recipes\n            </Button>\n            <Button\n              variant={viewMode === \"saved\" ? \"default\" : \"outline\"}\n              size=\"sm\"\n              onClick={() => setViewMode(\"saved\")}\n              className=\"flex-1\"\n              data-testid=\"button-view-saved\"\n            >\n              <Bookmark className=\"h-4 w-4 mr-2\" />\n              Saved\n            </Button>\n          </div>\n\n          {/* Shopping List Button - only show for Saved view */}\n          {viewMode === \"saved\" && selectedRecipes.size > 0 && (\n            <div className=\"flex gap-2 mb-4\">\n              <Button\n                onClick={() => setShowShoppingList(true)}\n                className=\"flex-1 bg-green-600 hover:bg-green-700\"\n                data-testid=\"button-create-shopping-list\"\n              >\n                <ShoppingCart className=\"h-4 w-4 mr-2\" />\n                Create Shopping List ({selectedRecipes.size})\n              </Button>\n              <Button\n                onClick={clearSelection}\n                variant=\"outline\"\n                size=\"sm\"\n                data-testid=\"button-clear-selection\"\n              >\n                Clear\n              </Button>\n            </div>\n          )}\n          \n          {/* Filters - only show for All Recipes view */}\n          {viewMode === \"all\" && (\n            <>\n              <div className=\"flex flex-col sm:flex-row gap-3\">\n                <div className=\"flex-1 relative\">\n                  <Filter className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n                  <Select value={selectedDiet} onValueChange={handleDietChange}>\n                    <SelectTrigger className=\"pl-10\" data-testid=\"select-dietary-filter\">\n                      <SelectValue placeholder=\"Filter by dietary requirements\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {DIETARY_REQUIREMENTS.map((diet) => (\n                        <SelectItem key={diet.value} value={diet.value} data-testid={`option-diet-${diet.value || 'all'}`}>\n                          {diet.label}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n\n              {/* Selected Filter Display */}\n              {selectedDiet && selectedDiet !== 'all' && (\n                <div className=\"mt-3 flex items-center gap-2\">\n                  <span className=\"text-sm text-muted-foreground\">Filtering by:</span>\n                  <Badge variant=\"secondary\" className=\"flex items-center gap-1\">\n                    {DIETARY_REQUIREMENTS.find(d => d.value === selectedDiet)?.label}\n                    <button \n                      onClick={() => setSelectedDiet(\"all\")}\n                      className=\"ml-1 hover:bg-muted-foreground/20 rounded-full p-0.5\"\n                      data-testid=\"button-clear-filter\"\n                    >\n                      Ã—\n                    </button>\n                  </Badge>\n                </div>\n              )}\n            </>\n          )}\n        </div>\n      </div>\n\n      {/* Content */}\n      <div className=\"p-4 pb-24\">\n        {currentLoading ? (\n          <div className=\"space-y-4\">\n            {[1, 2, 3].map((i) => (\n              <Card key={i}>\n                <CardHeader>\n                  <Skeleton className=\"h-6 w-3/4\" />\n                  <Skeleton className=\"h-4 w-1/2\" />\n                </CardHeader>\n                <CardContent>\n                  <Skeleton className=\"h-20 w-full\" />\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        ) : error ? (\n          <div className=\"text-center py-12\">\n            <ChefHat className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\n            <h3 className=\"text-lg font-medium text-muted-foreground mb-2\">Unable to Load Recipes</h3>\n            <p className=\"text-sm text-muted-foreground mb-4\">\n              There was an error loading recipes. Please try again later.\n            </p>\n            <Button \n              onClick={() => window.location.reload()} \n              variant=\"outline\"\n              data-testid=\"button-retry-recipes\"\n            >\n              Try Again\n            </Button>\n          </div>\n        ) : !Array.isArray(filteredRecipes) || filteredRecipes.length === 0 ? (\n          <div className=\"text-center py-12\">\n            <Utensils className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\n            <h3 className=\"text-lg font-medium text-muted-foreground mb-2\">\n              {selectedDiet && selectedDiet !== 'all' ? \"No Recipes Found\" : \"Loading Delicious Recipes...\"}\n            </h3>\n            <p className=\"text-sm text-muted-foreground mb-4\">\n              {selectedDiet && selectedDiet !== 'all'\n                ? `No recipes match your ${DIETARY_REQUIREMENTS.find(d => d.value === selectedDiet)?.label} dietary requirements yet.`\n                : \"Our AI is preparing some amazing recipes for you!\"\n              }\n            </p>\n            {selectedDiet && selectedDiet !== 'all' && (\n              <Button \n                onClick={() => setSelectedDiet(\"all\")}\n                variant=\"outline\"\n                data-testid=\"button-clear-filter-empty\"\n              >\n                View All Recipes\n              </Button>\n            )}\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {filteredRecipes.map((recipe: Recipe, index: number) => (\n              <Card key={recipe.id || index} className=\"overflow-hidden\" data-testid={`card-recipe-${index}`}>\n                <CardHeader className=\"pb-3\">\n                  <div className=\"flex items-start justify-between gap-3\">\n                    {viewMode === \"saved\" && (\n                      <div className=\"pt-1\">\n                        <Checkbox\n                          checked={selectedRecipes.has(recipe.id)}\n                          onCheckedChange={() => toggleRecipeSelection(recipe.id)}\n                          data-testid={`checkbox-recipe-${index}`}\n                        />\n                      </div>\n                    )}\n                    <div className=\"flex-1 min-w-0\">\n                      <CardTitle className=\"text-lg mb-1\" data-testid={`text-recipe-name-${index}`}>\n                        {recipe.name}\n                      </CardTitle>\n                      <p className=\"text-sm text-muted-foreground mb-2\">\n                        {recipe.description}\n                      </p>\n                      \n                      {/* Recipe Meta */}\n                      <div className=\"flex flex-wrap gap-3 text-xs text-muted-foreground\">\n                        <div className=\"flex items-center gap-1\">\n                          <Clock className=\"h-3 w-3\" />\n                          {recipe.prepTime + recipe.cookTime} min\n                        </div>\n                        <div className=\"flex items-center gap-1\">\n                          <Users className=\"h-3 w-3\" />\n                          {recipe.servings} servings\n                        </div>\n                        <div className=\"px-2 py-1 bg-primary/10 text-primary rounded\">\n                          {recipe.difficulty}\n                        </div>\n                      </div>\n                    </div>\n                    \n                    <div className=\"flex flex-col items-end gap-2 flex-shrink-0\">\n                      {viewMode === \"saved\" ? (\n                        <button\n                          onClick={() => unsaveMutation.mutate(recipe.id)}\n                          className=\"p-2 hover:bg-destructive/10 text-destructive rounded-lg transition-colors\"\n                          disabled={unsaveMutation.isPending}\n                          data-testid={`button-remove-recipe-${index}`}\n                        >\n                          <Trash2 className=\"h-5 w-5\" />\n                        </button>\n                      ) : (\n                        <button\n                          onClick={() => handleSaveToggle(recipe)}\n                          className=\"p-2 hover:bg-muted rounded-lg transition-colors\"\n                          disabled={saveMutation.isPending || unsaveMutation.isPending}\n                          data-testid={`button-save-recipe-${index}`}\n                        >\n                          {isSaved(recipe.id) ? (\n                            <Heart className=\"h-5 w-5 fill-red-500 text-red-500\" />\n                          ) : (\n                            <Heart className=\"h-5 w-5 text-muted-foreground hover:text-red-500\" />\n                          )}\n                        </button>\n                      )}\n                      <div className=\"text-right\">\n                        <div className=\"text-lg font-semibold text-primary\">\n                          {recipe.calories}\n                        </div>\n                        <div className=\"text-xs text-muted-foreground\">calories</div>\n                      </div>\n                    </div>\n                  </div>\n                </CardHeader>\n                \n                <CardContent className=\"space-y-4\">\n                  {/* Nutrition Info */}\n                  <div className=\"flex justify-between items-center text-xs text-muted-foreground bg-muted/30 rounded p-2\">\n                    <span>Protein: {recipe.protein}g</span>\n                    <span>Carbs: {recipe.carbs}g</span>\n                    <span>Fat: {recipe.fat}g</span>\n                  </div>\n\n                  {/* Dietary Tags */}\n                  {recipe.dietaryInfo && recipe.dietaryInfo.length > 0 && (\n                    <div className=\"flex flex-wrap gap-1\">\n                      {recipe.dietaryInfo.map((diet, idx) => (\n                        <Badge key={idx} variant=\"outline\" className=\"text-xs\">\n                          {diet}\n                        </Badge>\n                      ))}\n                    </div>\n                  )}\n\n                  {/* Ingredients */}\n                  <div>\n                    <h4 className=\"text-sm font-medium mb-2\">Ingredients:</h4>\n                    <div className=\"flex flex-wrap gap-1\">\n                      {(expandedIngredients.has(recipe.id) ? recipe.ingredients : recipe.ingredients.slice(0, 6)).map((ingredient, idx) => (\n                        <span key={idx} className=\"text-xs bg-secondary text-secondary-foreground px-2 py-1 rounded\">\n                          {ingredient}\n                        </span>\n                      ))}\n                      {recipe.ingredients.length > 6 && !expandedIngredients.has(recipe.id) && (\n                        <button\n                          onClick={() => toggleIngredients(recipe.id)}\n                          className=\"text-xs text-primary hover:underline px-2 py-1 font-medium\"\n                          data-testid={`button-show-all-ingredients-${index}`}\n                        >\n                          +{recipe.ingredients.length - 6} more\n                        </button>\n                      )}\n                      {expandedIngredients.has(recipe.id) && recipe.ingredients.length > 6 && (\n                        <button\n                          onClick={() => toggleIngredients(recipe.id)}\n                          className=\"text-xs text-primary hover:underline px-2 py-1 font-medium\"\n                          data-testid={`button-show-less-ingredients-${index}`}\n                        >\n                          Show less\n                        </button>\n                      )}\n                    </div>\n                  </div>\n\n                  {/* Instructions */}\n                  {recipe.instructions && recipe.instructions.length > 0 && (\n                    <div className=\"bg-muted/50 rounded p-3\">\n                      <h4 className=\"text-sm font-medium mb-2 flex items-center\">\n                        <ChefHat className=\"h-4 w-4 mr-1\" />\n                        How to Make It:\n                      </h4>\n                      <ol className=\"text-sm text-muted-foreground space-y-1\">\n                        {(expandedInstructions.has(recipe.id) ? recipe.instructions : recipe.instructions.slice(0, 3)).map((instruction, idx) => (\n                          <li key={idx} className=\"flex items-start\">\n                            <span className=\"text-primary font-medium mr-2 flex-shrink-0\">{idx + 1}.</span>\n                            <span>{instruction}</span>\n                          </li>\n                        ))}\n                      </ol>\n                      {recipe.instructions.length > 3 && (\n                        <button\n                          onClick={() => toggleInstructions(recipe.id)}\n                          className=\"text-xs text-primary hover:underline mt-2 font-medium\"\n                          data-testid={`button-toggle-instructions-${index}`}\n                        >\n                          {expandedInstructions.has(recipe.id) \n                            ? 'Show less' \n                            : `Show all ${recipe.instructions.length} steps`}\n                        </button>\n                      )}\n                    </div>\n                  )}\n\n                  {/* Recipe Link */}\n                  {recipe.recipeLink && (\n                    <div className=\"flex justify-center pt-2\">\n                      <a \n                        href={recipe.recipeLink} \n                        target=\"_blank\" \n                        rel=\"noopener noreferrer\"\n                        className=\"inline-flex items-center px-4 py-2 bg-primary text-primary-foreground rounded-lg text-sm font-medium hover:bg-primary/90 transition-colors\"\n                        data-testid={`button-recipe-link-${index}`}\n                      >\n                        <ExternalLink className=\"h-4 w-4 mr-2\" />\n                        View Full Recipe\n                      </a>\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Bottom Navigation */}\n      <DropdownNavigation />\n      \n      {/* Bottom Help Section */}\n      <BottomHelpSection />\n\n      {/* Floating Action Button for Shopping List */}\n      {viewMode === \"saved\" && (\n        <motion.div\n          initial={{ scale: 0 }}\n          animate={{ scale: 1 }}\n          className=\"fixed bottom-24 right-4 z-40\"\n        >\n          <motion.div\n            animate={selectedRecipes.size > 0 ? {\n              scale: [1, 1.1, 1],\n            } : {}}\n            transition={{\n              duration: 2,\n              repeat: selectedRecipes.size > 0 ? Infinity : 0,\n              repeatType: \"loop\"\n            }}\n          >\n            <Button\n              onClick={() => setShowShoppingList(true)}\n              size=\"lg\"\n              className=\"h-16 w-16 rounded-full shadow-2xl bg-gradient-to-br from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 relative group\"\n              aria-label={selectedRecipes.size > 0 ? `View shopping list with ${selectedRecipes.size} recipes` : \"View shopping list\"}\n              data-testid=\"button-fab-shopping-list\"\n            >\n              <ShoppingCart className=\"h-7 w-7\" />\n              <span className=\"sr-only\">Shopping List</span>\n              {selectedRecipes.size > 0 && (\n                <motion.span\n                  initial={{ scale: 0 }}\n                  animate={{ scale: 1 }}\n                  className=\"absolute -top-1 -right-1 h-7 w-7 rounded-full bg-orange-500 text-white text-xs font-bold flex items-center justify-center ring-4 ring-white dark:ring-gray-900\"\n                  aria-label={`${selectedRecipes.size} recipes selected`}\n                >\n                  {selectedRecipes.size}\n                </motion.span>\n              )}\n            </Button>\n          </motion.div>\n          {selectedRecipes.size === 0 && (\n            <motion.div\n              initial={{ opacity: 0, y: 10 }}\n              animate={{ opacity: 1, y: 0 }}\n              className=\"absolute bottom-full mb-3 right-0 bg-gray-900 text-white text-xs px-3 py-2 rounded-lg whitespace-nowrap shadow-lg pointer-events-none\"\n              role=\"tooltip\"\n            >\n              Select recipes to create a shopping list\n              <div className=\"absolute top-full right-4 w-0 h-0 border-l-4 border-r-4 border-t-4 border-l-transparent border-r-transparent border-t-gray-900\"></div>\n            </motion.div>\n          )}\n        </motion.div>\n      )}\n\n      {/* Shopping List Dialog */}\n      <ShoppingListDialog\n        isOpen={showShoppingList}\n        onClose={() => setShowShoppingList(false)}\n        recipes={getSelectedRecipeObjects()}\n      />\n    </motion.div>\n  );\n}\n\nexport default RecipesPage;","size_bytes":28184},"client/src/components/permission-debugger.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { Button } from '@/components/ui/button';\n\ninterface PermissionDebuggerProps {\n  onClose: () => void;\n}\n\nexport function PermissionDebugger({ onClose }: PermissionDebuggerProps) {\n  const [debugInfo, setDebugInfo] = useState<any>({});\n  const [isChecking, setIsChecking] = useState(false);\n\n  const runDiagnostics = async () => {\n    setIsChecking(true);\n    const info: any = {\n      timestamp: new Date().toLocaleString(),\n      userAgent: navigator.userAgent,\n      platform: navigator.platform,\n      isSecureContext: window.isSecureContext,\n      protocol: window.location.protocol,\n      host: window.location.host,\n      hasGetUserMedia: !!(navigator.mediaDevices && navigator.mediaDevices.getUserMedia),\n      hasMediaDevices: !!navigator.mediaDevices,\n      permissions: {},\n      mediaConstraints: {},\n      errors: []\n    };\n\n    // Check if we're in Replit mobile app\n    info.isReplitApp = /Replit-Bonsai/.test(navigator.userAgent);\n    info.isMobile = /Mobile|Android|iPhone|iPad/.test(navigator.userAgent);\n\n    // Test permissions API\n    if (navigator.permissions && navigator.permissions.query) {\n      try {\n        const cameraPermission = await navigator.permissions.query({ name: 'camera' as PermissionName });\n        info.permissions.camera = {\n          state: cameraPermission.state,\n          supported: true\n        };\n      } catch (error: any) {\n        info.permissions.camera = {\n          error: error.message,\n          supported: false\n        };\n      }\n    } else {\n      info.permissions.camera = { supported: false, reason: 'Permissions API not available' };\n    }\n\n    // Test getUserMedia with different constraints\n    const constraints = [\n      { video: true },\n      { video: { facingMode: 'environment' } },\n      { video: { facingMode: 'user' } }\n    ];\n\n    for (let i = 0; i < constraints.length; i++) {\n      const constraint = constraints[i];\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia(constraint);\n        \n        info.mediaConstraints[`test_${i + 1}`] = {\n          constraint,\n          success: true,\n          tracks: stream.getTracks().map(track => ({\n            kind: track.kind,\n            label: track.label,\n            readyState: track.readyState,\n            enabled: track.enabled\n          }))\n        };\n        \n        // Stop the stream immediately\n        stream.getTracks().forEach(track => track.stop());\n        break; // If one works, we're good\n      } catch (error: any) {\n        info.mediaConstraints[`test_${i + 1}`] = {\n          constraint,\n          success: false,\n          error: {\n            name: error.name,\n            message: error.message,\n            code: error.code || 0\n          }\n        };\n      }\n    }\n\n    // Check for other browser features\n    info.features = {\n      localStorage: !!window.localStorage,\n      sessionStorage: !!window.sessionStorage,\n      geolocation: !!navigator.geolocation,\n      serviceWorker: 'serviceWorker' in navigator,\n      webRTC: !!(window as any).RTCPeerConnection,\n      fullscreen: !!(document as any).fullscreenEnabled,\n      notification: 'Notification' in window\n    };\n\n    setDebugInfo(info);\n    setIsChecking(false);\n  };\n\n  useEffect(() => {\n    runDiagnostics();\n  }, []);\n\n  const copyToClipboard = () => {\n    const debugText = JSON.stringify(debugInfo, null, 2);\n    navigator.clipboard.writeText(debugText).then(() => {\n      alert('Debug information copied to clipboard!');\n    });\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-[9999] p-4\">\n      <div className=\"bg-gray-900 text-white rounded-xl p-6 w-full max-w-2xl max-h-[80vh] overflow-y-auto shadow-2xl\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h2 className=\"text-xl font-bold\">ðŸ“‹ Camera Permission Diagnostics</h2>\n          <Button variant=\"outline\" onClick={onClose} className=\"text-white border-white/20\">\n            Close\n          </Button>\n        </div>\n\n        {isChecking ? (\n          <div className=\"text-center py-8\">\n            <div className=\"animate-spin inline-block w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full mb-4\"></div>\n            <p>Running diagnostics...</p>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {/* Environment Info */}\n            <div className=\"bg-blue-900/30 border border-blue-600/30 rounded-lg p-4\">\n              <h3 className=\"font-semibold mb-2\">ðŸŒ Environment</h3>\n              <div className=\"text-sm space-y-1\">\n                <p><strong>Platform:</strong> {debugInfo.platform}</p>\n                <p><strong>Secure Context:</strong> {debugInfo.isSecureContext ? 'âœ… Yes' : 'âŒ No'}</p>\n                <p><strong>Protocol:</strong> {debugInfo.protocol}</p>\n                <p><strong>Replit App:</strong> {debugInfo.isReplitApp ? 'ðŸ“± Yes' : 'ðŸŒ Browser'}</p>\n                <p><strong>Mobile:</strong> {debugInfo.isMobile ? 'ðŸ“± Yes' : 'ðŸ’» Desktop'}</p>\n              </div>\n            </div>\n\n            {/* Camera Support */}\n            <div className=\"bg-green-900/30 border border-green-600/30 rounded-lg p-4\">\n              <h3 className=\"font-semibold mb-2\">ðŸ“· Camera Support</h3>\n              <div className=\"text-sm space-y-1\">\n                <p><strong>getUserMedia:</strong> {debugInfo.hasGetUserMedia ? 'âœ… Available' : 'âŒ Not Available'}</p>\n                <p><strong>MediaDevices API:</strong> {debugInfo.hasMediaDevices ? 'âœ… Available' : 'âŒ Not Available'}</p>\n                \n                {debugInfo.permissions?.camera && (\n                  <p><strong>Permission State:</strong> \n                    {debugInfo.permissions.camera.supported ? \n                      `${debugInfo.permissions.camera.state === 'granted' ? 'âœ…' : \n                        debugInfo.permissions.camera.state === 'denied' ? 'âŒ' : 'âš ï¸'} ${debugInfo.permissions.camera.state}` :\n                      'âŒ Not Supported'\n                    }\n                  </p>\n                )}\n              </div>\n            </div>\n\n            {/* Test Results */}\n            <div className=\"bg-purple-900/30 border border-purple-600/30 rounded-lg p-4\">\n              <h3 className=\"font-semibold mb-2\">ðŸ§ª Camera Tests</h3>\n              <div className=\"text-sm space-y-2\">\n                {Object.entries(debugInfo.mediaConstraints || {}).map(([key, result]: [string, any]) => (\n                  <div key={key} className=\"border-l-2 border-purple-500 pl-3\">\n                    <p><strong>Test {key.split('_')[1]}:</strong> {result.success ? 'âœ… Success' : 'âŒ Failed'}</p>\n                    {result.success && result.tracks ? (\n                      <p className=\"text-xs text-green-300\">Camera found: {result.tracks[0]?.label || 'Camera device'}</p>\n                    ) : (\n                      <p className=\"text-xs text-red-300\">Error: {result.error?.message}</p>\n                    )}\n                  </div>\n                ))}\n              </div>\n            </div>\n\n            {/* Recommendations */}\n            <div className=\"bg-orange-900/30 border border-orange-600/30 rounded-lg p-4\">\n              <h3 className=\"font-semibold mb-2\">ðŸ’¡ Recommendations</h3>\n              <div className=\"text-sm space-y-1\">\n                {debugInfo.isReplitApp ? (\n                  <>\n                    <p>â€¢ âš ï¸ <strong>Replit Mobile App detected</strong> - camera may be blocked</p>\n                    <p>â€¢ ðŸŒ Try opening in external browser (Chrome/Safari)</p>\n                    <p>â€¢ ðŸ“ Use manual barcode entry as reliable alternative</p>\n                  </>\n                ) : debugInfo.permissions?.camera?.state === 'denied' ? (\n                  <>\n                    <p>â€¢ âŒ <strong>Camera permission denied</strong></p>\n                    <p>â€¢ âš™ï¸ Go to browser settings and allow camera for this site</p>\n                    <p>â€¢ ðŸ”„ Refresh page after changing permissions</p>\n                  </>\n                ) : !debugInfo.hasGetUserMedia ? (\n                  <>\n                    <p>â€¢ âŒ <strong>Camera API not supported</strong></p>\n                    <p>â€¢ ðŸ“± Update your browser to the latest version</p>\n                    <p>â€¢ ðŸŒ Try a different browser (Chrome/Firefox)</p>\n                  </>\n                ) : (\n                  <>\n                    <p>â€¢ âœ… Camera should work - try again</p>\n                    <p>â€¢ ðŸ”„ Refresh the page and allow permissions</p>\n                  </>\n                )}\n              </div>\n            </div>\n\n            {/* Actions */}\n            <div className=\"flex space-x-3\">\n              <Button onClick={runDiagnostics} className=\"flex-1\">\n                ðŸ”„ Run Again\n              </Button>\n              <Button onClick={copyToClipboard} variant=\"outline\" className=\"flex-1 border-white/20\">\n                ðŸ“‹ Copy Debug Info\n              </Button>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}","size_bytes":9123},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"client/src/components/confetti-celebration.tsx":{"content":"import React, { useEffect, useState } from 'react';\n\ninterface ConfettiPiece {\n  id: number;\n  x: number;\n  y: number;\n  rotation: number;\n  color: string;\n  size: number;\n  velocityX: number;\n  velocityY: number;\n  rotationSpeed: number;\n}\n\ninterface ConfettiCelebrationProps {\n  trigger: boolean;\n  duration?: number;\n  particleCount?: number;\n  onComplete?: () => void;\n}\n\ninterface ScreenFlash {\n  opacity: number;\n  color: string;\n}\n\nexport function ConfettiCelebration({ \n  trigger, \n  duration = 3000, \n  particleCount = 50,\n  onComplete \n}: ConfettiCelebrationProps) {\n  const [confetti, setConfetti] = useState<ConfettiPiece[]>([]);\n  const [isActive, setIsActive] = useState(false);\n  const [screenFlash, setScreenFlash] = useState<ScreenFlash>({ opacity: 0, color: '#FFD700' });\n  const [showText, setShowText] = useState(false);\n\n  const colors = [\n    '#FFD700', '#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', \n    '#FFEAA7', '#DDA0DD', '#98D8C8', '#F7DC6F', '#BB8FCE',\n    '#FF1493', '#00FF7F', '#FF4500', '#8A2BE2', '#DC143C',\n    '#00CED1', '#FFB6C1', '#98FB98', '#F0E68C', '#DDA0DD'\n  ];\n\n  const createConfettiPiece = (id: number): ConfettiPiece => {\n    // Get actual viewport dimensions for mobile\n    const viewWidth = window.innerWidth;\n    const viewHeight = window.innerHeight;\n    \n    // Create spawn zones that truly cover the entire screen including mobile\n    const spawnType = Math.floor(Math.random() * 5);\n    let zone;\n    \n    switch (spawnType) {\n      case 0: // Top edge - rain down\n        zone = {\n          x: Math.random() * viewWidth,\n          y: -50 - Math.random() * 100, // Start well above screen\n          vx: (Math.random() - 0.5) * 4,\n          vy: Math.random() * 6 + 4 // Fall down\n        };\n        break;\n      case 1: // Bottom edge - shoot up\n        zone = {\n          x: Math.random() * viewWidth,\n          y: viewHeight + 50 + Math.random() * 100, // Start well below screen\n          vx: (Math.random() - 0.5) * 4,\n          vy: -(Math.random() * 6 + 4) // Shoot up\n        };\n        break;\n      case 2: // Left edge - sweep right\n        zone = {\n          x: -50 - Math.random() * 100, // Start well left of screen\n          y: Math.random() * viewHeight,\n          vx: Math.random() * 6 + 4, // Move right\n          vy: (Math.random() - 0.5) * 4\n        };\n        break;\n      case 3: // Right edge - sweep left\n        zone = {\n          x: viewWidth + 50 + Math.random() * 100, // Start well right of screen\n          y: Math.random() * viewHeight,\n          vx: -(Math.random() * 6 + 4), // Move left\n          vy: (Math.random() - 0.5) * 4\n        };\n        break;\n      case 4: // Center explosion - burst outward\n        const centerX = viewWidth * (0.3 + Math.random() * 0.4); // Random center area\n        const centerY = viewHeight * (0.3 + Math.random() * 0.4);\n        const angle = Math.random() * Math.PI * 2;\n        const speed = Math.random() * 8 + 6;\n        zone = {\n          x: centerX,\n          y: centerY,\n          vx: Math.cos(angle) * speed,\n          vy: Math.sin(angle) * speed\n        };\n        break;\n      default:\n        zone = { x: 0, y: 0, vx: 0, vy: 0 };\n    }\n    \n    return {\n      id,\n      x: zone.x,\n      y: zone.y,\n      rotation: Math.random() * 360,\n      color: colors[Math.floor(Math.random() * colors.length)],\n      size: Math.random() * 12 + 8, // 8-20px (even bigger)\n      velocityX: zone.vx,\n      velocityY: zone.vy,\n      rotationSpeed: (Math.random() - 0.5) * 20, // Much faster rotation\n    };\n  };\n\n  useEffect(() => {\n    if (!trigger) return;\n\n    // Create initial confetti pieces\n    const pieces = Array.from({ length: particleCount }, (_, i) => createConfettiPiece(i));\n    setConfetti(pieces);\n    setIsActive(true);\n    setShowText(true);\n    \n    // Screen flash effect (shorter)\n    setScreenFlash({ opacity: 0.6, color: '#FFD700' });\n    setTimeout(() => setScreenFlash({ opacity: 0.3, color: '#FF6B6B' }), 80);\n    setTimeout(() => setScreenFlash({ opacity: 0.1, color: '#4ECDC4' }), 160);\n    setTimeout(() => setScreenFlash({ opacity: 0, color: '#FFD700' }), 300);\n    \n    // Hide text after 1.5 seconds\n    setTimeout(() => setShowText(false), 1500);\n\n    // Animation loop\n    let animationId: number;\n    let startTime: number | null = null;\n\n    const animate = (timestamp: number) => {\n      if (!startTime) startTime = timestamp;\n      const elapsed = timestamp - startTime;\n\n      if (elapsed >= duration) {\n        setIsActive(false);\n        setConfetti([]);\n        setShowText(false);\n        setScreenFlash({ opacity: 0, color: '#FFD700' });\n        onComplete?.();\n        return;\n      }\n\n      setConfetti(prevConfetti => \n        prevConfetti.map(piece => ({\n          ...piece,\n          x: piece.x + piece.velocityX,\n          y: piece.y + piece.velocityY,\n          rotation: piece.rotation + piece.rotationSpeed,\n          velocityY: piece.velocityY + 0.1, // gravity\n        })).filter(piece => \n          piece.y < window.innerHeight + 200 && \n          piece.y > -200 && \n          piece.x < window.innerWidth + 200 && \n          piece.x > -200\n        ) // Remove pieces that go far off any edge\n      );\n\n      animationId = requestAnimationFrame(animate);\n    };\n\n    animationId = requestAnimationFrame(animate);\n\n    return () => {\n      if (animationId) {\n        cancelAnimationFrame(animationId);\n      }\n    };\n  }, [trigger, duration, particleCount, onComplete]);\n\n  if (!isActive || confetti.length === 0) return null;\n\n  return (\n    <div \n      className=\"fixed pointer-events-none z-50 overflow-hidden\"\n      style={{\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        width: '100vw',\n        height: '100vh',\n        position: 'fixed'\n      }}\n    >\n      {/* Screen Flash Effect */}\n      {screenFlash.opacity > 0 && (\n        <div \n          className=\"absolute transition-opacity duration-100\"\n          style={{\n            top: 0,\n            left: 0,\n            right: 0,\n            bottom: 0,\n            width: '100%',\n            height: '100%',\n            backgroundColor: screenFlash.color,\n            opacity: screenFlash.opacity,\n            mixBlendMode: 'screen'\n          }}\n        />\n      )}\n      \n      {/* Achievement Text */}\n      {showText && (\n        <div \n          className=\"absolute flex items-center justify-center\"\n          style={{\n            top: 0,\n            left: 0,\n            right: 0,\n            bottom: 0,\n            width: '100%',\n            height: '100%'\n          }}\n        >\n          <div className=\"text-center animate-bounce\">\n            <div className=\"text-4xl md:text-6xl font-bold text-white mb-4 drop-shadow-2xl animate-pulse\">\n              ðŸŽ‰ GOAL ACHIEVED! ðŸŽ‰\n            </div>\n            <div className=\"text-lg md:text-2xl font-semibold text-yellow-300 drop-shadow-lg\">\n              Keep up the amazing work!\n            </div>\n          </div>\n        </div>\n      )}\n      \n      {/* Confetti Particles */}\n      {confetti.map(piece => {\n        const isSpecial = Math.random() > 0.7;\n        const shape = isSpecial \n          ? (Math.random() > 0.5 ? 'â­' : 'â¤ï¸') \n          : '';\n        \n        return (\n          <div\n            key={piece.id}\n            className=\"absolute flex items-center justify-center\"\n            style={{\n              left: `${piece.x}px`,\n              top: `${piece.y}px`,\n              width: `${piece.size}px`,\n              height: `${piece.size}px`,\n              backgroundColor: shape ? 'transparent' : piece.color,\n              transform: `rotate(${piece.rotation}deg)`,\n              borderRadius: !shape && Math.random() > 0.3 ? '50%' : '2px',\n              boxShadow: `0 0 ${piece.size}px ${piece.color}60`,\n              fontSize: shape ? `${piece.size * 0.8}px` : 'inherit',\n              filter: `brightness(1.2) saturate(1.3)`,\n            }}\n          >\n            {shape}\n          </div>\n        );\n      })}\n    </div>\n  );\n}\n\n// Hook for easy confetti triggering\nexport function useConfetti() {\n  const [shouldTrigger, setShouldTrigger] = useState(false);\n  const [hasCelebratedToday, setHasCelebratedToday] = useState(false);\n\n  // Check if we already celebrated today when component mounts\n  useEffect(() => {\n    const todayKey = new Date().toISOString().split('T')[0];\n    const celebrated = localStorage.getItem(`platemate-celebrated-${todayKey}`);\n    if (celebrated === 'true') {\n      setHasCelebratedToday(true);\n    }\n  }, []);\n\n  const triggerConfetti = () => {\n    // Only trigger if we haven't celebrated today\n    if (!hasCelebratedToday) {\n      setShouldTrigger(true);\n      setHasCelebratedToday(true);\n      // Store celebration flag in localStorage\n      const todayKey = new Date().toISOString().split('T')[0];\n      localStorage.setItem(`platemate-celebrated-${todayKey}`, 'true');\n    }\n  };\n\n  const resetTrigger = () => {\n    setShouldTrigger(false);\n  };\n\n  return {\n    shouldTrigger,\n    triggerConfetti,\n    resetTrigger,\n    hasCelebratedToday,\n  };\n}","size_bytes":9030},"android/app/src/main/assets/public/assets/index-BQFIQdpH.js":{"content":"var Rte=Object.defineProperty;var mk=t=>{throw TypeError(t)};var Fte=(t,e,r)=>e in t?Rte(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var te=(t,e,r)=>Fte(t,typeof e!=\"symbol\"?e+\"\":e,r),Mw=(t,e,r)=>e.has(t)||mk(\"Cannot \"+r);var Z=(t,e,r)=>(Mw(t,e,\"read from private field\"),r?r.call(t):e.get(t)),rt=(t,e,r)=>e.has(t)?mk(\"Cannot add the same private member more than once\"):e instanceof WeakSet?e.add(t):e.set(t,r),Le=(t,e,r,n)=>(Mw(t,e,\"write to private field\"),n?n.call(t,r):e.set(t,r),r),St=(t,e,r)=>(Mw(t,e,\"access private method\"),r);var zg=(t,e,r,n)=>({set _(i){Le(t,e,i,r)},get _(){return Z(t,e,n)}});function Lte(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!=\"string\"&&!Array.isArray(n)){for(const i in n)if(i!==\"default\"&&!(i in t)){const a=Object.getOwnPropertyDescriptor(n,i);a&&Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}))}(function(){const e=document.createElement(\"link\").relList;if(e&&e.supports&&e.supports(\"modulepreload\"))return;for(const i of document.querySelectorAll('link[rel=\"modulepreload\"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type===\"childList\")for(const o of a.addedNodes)o.tagName===\"LINK\"&&o.rel===\"modulepreload\"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin===\"use-credentials\"?a.credentials=\"include\":i.crossOrigin===\"anonymous\"?a.credentials=\"omit\":a.credentials=\"same-origin\",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var Wg=typeof globalThis<\"u\"?globalThis:typeof window<\"u\"?window:typeof global<\"u\"?global:typeof self<\"u\"?self:{};function or(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,\"default\")?t.default:t}var Dw={exports:{}},Kh={},Rw={exports:{}},jt={};/**\n * @license React\n * react.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */var gk;function Bte(){if(gk)return jt;gk=1;var t=Symbol.for(\"react.element\"),e=Symbol.for(\"react.portal\"),r=Symbol.for(\"react.fragment\"),n=Symbol.for(\"react.strict_mode\"),i=Symbol.for(\"react.profiler\"),a=Symbol.for(\"react.provider\"),o=Symbol.for(\"react.context\"),s=Symbol.for(\"react.forward_ref\"),c=Symbol.for(\"react.suspense\"),u=Symbol.for(\"react.memo\"),f=Symbol.for(\"react.lazy\"),h=Symbol.iterator;function m(U){return U===null||typeof U!=\"object\"?null:(U=h&&U[h]||U[\"@@iterator\"],typeof U==\"function\"?U:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,v={};function b(U,Y,me){this.props=U,this.context=Y,this.refs=v,this.updater=me||g}b.prototype.isReactComponent={},b.prototype.setState=function(U,Y){if(typeof U!=\"object\"&&typeof U!=\"function\"&&U!=null)throw Error(\"setState(...): takes an object of state variables to update or a function which returns an object of state variables.\");this.updater.enqueueSetState(this,U,Y,\"setState\")},b.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,\"forceUpdate\")};function w(){}w.prototype=b.prototype;function C(U,Y,me){this.props=U,this.context=Y,this.refs=v,this.updater=me||g}var _=C.prototype=new w;_.constructor=C,x(_,b.prototype),_.isPureReactComponent=!0;var N=Array.isArray,A=Object.prototype.hasOwnProperty,T={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function k(U,Y,me){var Ee,Fe={},Me=null,je=null;if(Y!=null)for(Ee in Y.ref!==void 0&&(je=Y.ref),Y.key!==void 0&&(Me=\"\"+Y.key),Y)A.call(Y,Ee)&&!P.hasOwnProperty(Ee)&&(Fe[Ee]=Y[Ee]);var Ae=arguments.length-2;if(Ae===1)Fe.children=me;else if(1<Ae){for(var fe=Array(Ae),_e=0;_e<Ae;_e++)fe[_e]=arguments[_e+2];Fe.children=fe}if(U&&U.defaultProps)for(Ee in Ae=U.defaultProps,Ae)Fe[Ee]===void 0&&(Fe[Ee]=Ae[Ee]);return{$$typeof:t,type:U,key:Me,ref:je,props:Fe,_owner:T.current}}function I(U,Y){return{$$typeof:t,type:U.type,key:Y,ref:U.ref,props:U.props,_owner:U._owner}}function R(U){return typeof U==\"object\"&&U!==null&&U.$$typeof===t}function F(U){var Y={\"=\":\"=0\",\":\":\"=2\"};return\"$\"+U.replace(/[=:]/g,function(me){return Y[me]})}var D=/\\/+/g;function L(U,Y){return typeof U==\"object\"&&U!==null&&U.key!=null?F(\"\"+U.key):Y.toString(36)}function q(U,Y,me,Ee,Fe){var Me=typeof U;(Me===\"undefined\"||Me===\"boolean\")&&(U=null);var je=!1;if(U===null)je=!0;else switch(Me){case\"string\":case\"number\":je=!0;break;case\"object\":switch(U.$$typeof){case t:case e:je=!0}}if(je)return je=U,Fe=Fe(je),U=Ee===\"\"?\".\"+L(je,0):Ee,N(Fe)?(me=\"\",U!=null&&(me=U.replace(D,\"$&/\")+\"/\"),q(Fe,Y,me,\"\",function(_e){return _e})):Fe!=null&&(R(Fe)&&(Fe=I(Fe,me+(!Fe.key||je&&je.key===Fe.key?\"\":(\"\"+Fe.key).replace(D,\"$&/\")+\"/\")+U)),Y.push(Fe)),1;if(je=0,Ee=Ee===\"\"?\".\":Ee+\":\",N(U))for(var Ae=0;Ae<U.length;Ae++){Me=U[Ae];var fe=Ee+L(Me,Ae);je+=q(Me,Y,me,fe,Fe)}else if(fe=m(U),typeof fe==\"function\")for(U=fe.call(U),Ae=0;!(Me=U.next()).done;)Me=Me.value,fe=Ee+L(Me,Ae++),je+=q(Me,Y,me,fe,Fe);else if(Me===\"object\")throw Y=String(U),Error(\"Objects are not valid as a React child (found: \"+(Y===\"[object Object]\"?\"object with keys {\"+Object.keys(U).join(\", \")+\"}\":Y)+\"). If you meant to render a collection of children, use an array instead.\");return je}function W(U,Y,me){if(U==null)return U;var Ee=[],Fe=0;return q(U,Ee,\"\",\"\",function(Me){return Y.call(me,Me,Fe++)}),Ee}function V(U){if(U._status===-1){var Y=U._result;Y=Y(),Y.then(function(me){(U._status===0||U._status===-1)&&(U._status=1,U._result=me)},function(me){(U._status===0||U._status===-1)&&(U._status=2,U._result=me)}),U._status===-1&&(U._status=0,U._result=Y)}if(U._status===1)return U._result.default;throw U._result}var K={current:null},z={transition:null},re={ReactCurrentDispatcher:K,ReactCurrentBatchConfig:z,ReactCurrentOwner:T};function ne(){throw Error(\"act(...) is not supported in production builds of React.\")}return jt.Children={map:W,forEach:function(U,Y,me){W(U,function(){Y.apply(this,arguments)},me)},count:function(U){var Y=0;return W(U,function(){Y++}),Y},toArray:function(U){return W(U,function(Y){return Y})||[]},only:function(U){if(!R(U))throw Error(\"React.Children.only expected to receive a single React element child.\");return U}},jt.Component=b,jt.Fragment=r,jt.Profiler=i,jt.PureComponent=C,jt.StrictMode=n,jt.Suspense=c,jt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=re,jt.act=ne,jt.cloneElement=function(U,Y,me){if(U==null)throw Error(\"React.cloneElement(...): The argument must be a React element, but you passed \"+U+\".\");var Ee=x({},U.props),Fe=U.key,Me=U.ref,je=U._owner;if(Y!=null){if(Y.ref!==void 0&&(Me=Y.ref,je=T.current),Y.key!==void 0&&(Fe=\"\"+Y.key),U.type&&U.type.defaultProps)var Ae=U.type.defaultProps;for(fe in Y)A.call(Y,fe)&&!P.hasOwnProperty(fe)&&(Ee[fe]=Y[fe]===void 0&&Ae!==void 0?Ae[fe]:Y[fe])}var fe=arguments.length-2;if(fe===1)Ee.children=me;else if(1<fe){Ae=Array(fe);for(var _e=0;_e<fe;_e++)Ae[_e]=arguments[_e+2];Ee.children=Ae}return{$$typeof:t,type:U.type,key:Fe,ref:Me,props:Ee,_owner:je}},jt.createContext=function(U){return U={$$typeof:o,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},U.Provider={$$typeof:a,_context:U},U.Consumer=U},jt.createElement=k,jt.createFactory=function(U){var Y=k.bind(null,U);return Y.type=U,Y},jt.createRef=function(){return{current:null}},jt.forwardRef=function(U){return{$$typeof:s,render:U}},jt.isValidElement=R,jt.lazy=function(U){return{$$typeof:f,_payload:{_status:-1,_result:U},_init:V}},jt.memo=function(U,Y){return{$$typeof:u,type:U,compare:Y===void 0?null:Y}},jt.startTransition=function(U){var Y=z.transition;z.transition={};try{U()}finally{z.transition=Y}},jt.unstable_act=ne,jt.useCallback=function(U,Y){return K.current.useCallback(U,Y)},jt.useContext=function(U){return K.current.useContext(U)},jt.useDebugValue=function(){},jt.useDeferredValue=function(U){return K.current.useDeferredValue(U)},jt.useEffect=function(U,Y){return K.current.useEffect(U,Y)},jt.useId=function(){return K.current.useId()},jt.useImperativeHandle=function(U,Y,me){return K.current.useImperativeHandle(U,Y,me)},jt.useInsertionEffect=function(U,Y){return K.current.useInsertionEffect(U,Y)},jt.useLayoutEffect=function(U,Y){return K.current.useLayoutEffect(U,Y)},jt.useMemo=function(U,Y){return K.current.useMemo(U,Y)},jt.useReducer=function(U,Y,me){return K.current.useReducer(U,Y,me)},jt.useRef=function(U){return K.current.useRef(U)},jt.useState=function(U){return K.current.useState(U)},jt.useSyncExternalStore=function(U,Y,me){return K.current.useSyncExternalStore(U,Y,me)},jt.useTransition=function(){return K.current.useTransition()},jt.version=\"18.3.1\",jt}var vk;function jx(){return vk||(vk=1,Rw.exports=Bte()),Rw.exports}/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */var yk;function $te(){if(yk)return Kh;yk=1;var t=jx(),e=Symbol.for(\"react.element\"),r=Symbol.for(\"react.fragment\"),n=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function o(s,c,u){var f,h={},m=null,g=null;u!==void 0&&(m=\"\"+u),c.key!==void 0&&(m=\"\"+c.key),c.ref!==void 0&&(g=c.ref);for(f in c)n.call(c,f)&&!a.hasOwnProperty(f)&&(h[f]=c[f]);if(s&&s.defaultProps)for(f in c=s.defaultProps,c)h[f]===void 0&&(h[f]=c[f]);return{$$typeof:e,type:s,key:m,ref:g,props:h,_owner:i.current}}return Kh.Fragment=r,Kh.jsx=o,Kh.jsxs=o,Kh}var xk;function Vte(){return xk||(xk=1,Dw.exports=$te()),Dw.exports}var l=Vte(),qg={},Fw={exports:{}},Ii={},Lw={exports:{}},Bw={};/**\n * @license React\n * scheduler.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */var bk;function Ute(){return bk||(bk=1,(function(t){function e(z,re){var ne=z.length;z.push(re);e:for(;0<ne;){var U=ne-1>>>1,Y=z[U];if(0<i(Y,re))z[U]=re,z[ne]=Y,ne=U;else break e}}function r(z){return z.length===0?null:z[0]}function n(z){if(z.length===0)return null;var re=z[0],ne=z.pop();if(ne!==re){z[0]=ne;e:for(var U=0,Y=z.length,me=Y>>>1;U<me;){var Ee=2*(U+1)-1,Fe=z[Ee],Me=Ee+1,je=z[Me];if(0>i(Fe,ne))Me<Y&&0>i(je,Fe)?(z[U]=je,z[Me]=ne,U=Me):(z[U]=Fe,z[Ee]=ne,U=Ee);else if(Me<Y&&0>i(je,ne))z[U]=je,z[Me]=ne,U=Me;else break e}}return re}function i(z,re){var ne=z.sortIndex-re.sortIndex;return ne!==0?ne:z.id-re.id}if(typeof performance==\"object\"&&typeof performance.now==\"function\"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,s=o.now();t.unstable_now=function(){return o.now()-s}}var c=[],u=[],f=1,h=null,m=3,g=!1,x=!1,v=!1,b=typeof setTimeout==\"function\"?setTimeout:null,w=typeof clearTimeout==\"function\"?clearTimeout:null,C=typeof setImmediate<\"u\"?setImmediate:null;typeof navigator<\"u\"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(z){for(var re=r(u);re!==null;){if(re.callback===null)n(u);else if(re.startTime<=z)n(u),re.sortIndex=re.expirationTime,e(c,re);else break;re=r(u)}}function N(z){if(v=!1,_(z),!x)if(r(c)!==null)x=!0,V(A);else{var re=r(u);re!==null&&K(N,re.startTime-z)}}function A(z,re){x=!1,v&&(v=!1,w(k),k=-1),g=!0;var ne=m;try{for(_(re),h=r(c);h!==null&&(!(h.expirationTime>re)||z&&!F());){var U=h.callback;if(typeof U==\"function\"){h.callback=null,m=h.priorityLevel;var Y=U(h.expirationTime<=re);re=t.unstable_now(),typeof Y==\"function\"?h.callback=Y:h===r(c)&&n(c),_(re)}else n(c);h=r(c)}if(h!==null)var me=!0;else{var Ee=r(u);Ee!==null&&K(N,Ee.startTime-re),me=!1}return me}finally{h=null,m=ne,g=!1}}var T=!1,P=null,k=-1,I=5,R=-1;function F(){return!(t.unstable_now()-R<I)}function D(){if(P!==null){var z=t.unstable_now();R=z;var re=!0;try{re=P(!0,z)}finally{re?L():(T=!1,P=null)}}else T=!1}var L;if(typeof C==\"function\")L=function(){C(D)};else if(typeof MessageChannel<\"u\"){var q=new MessageChannel,W=q.port2;q.port1.onmessage=D,L=function(){W.postMessage(null)}}else L=function(){b(D,0)};function V(z){P=z,T||(T=!0,L())}function K(z,re){k=b(function(){z(t.unstable_now())},re)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(z){z.callback=null},t.unstable_continueExecution=function(){x||g||(x=!0,V(A))},t.unstable_forceFrameRate=function(z){0>z||125<z?console.error(\"forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported\"):I=0<z?Math.floor(1e3/z):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(z){switch(m){case 1:case 2:case 3:var re=3;break;default:re=m}var ne=m;m=re;try{return z()}finally{m=ne}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(z,re){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var ne=m;m=z;try{return re()}finally{m=ne}},t.unstable_scheduleCallback=function(z,re,ne){var U=t.unstable_now();switch(typeof ne==\"object\"&&ne!==null?(ne=ne.delay,ne=typeof ne==\"number\"&&0<ne?U+ne:U):ne=U,z){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=ne+Y,z={id:f++,callback:re,priorityLevel:z,startTime:ne,expirationTime:Y,sortIndex:-1},ne>U?(z.sortIndex=ne,e(u,z),r(c)===null&&z===r(u)&&(v?(w(k),k=-1):v=!0,K(N,ne-U))):(z.sortIndex=Y,e(c,z),x||g||(x=!0,V(A))),z},t.unstable_shouldYield=F,t.unstable_wrapCallback=function(z){var re=m;return function(){var ne=m;m=re;try{return z.apply(this,arguments)}finally{m=ne}}}})(Bw)),Bw}var wk;function zte(){return wk||(wk=1,Lw.exports=Ute()),Lw.exports}/**\n * @license React\n * react-dom.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */var Sk;function Wte(){if(Sk)return Ii;Sk=1;var t=jx(),e=zte();function r(d){for(var p=\"https://reactjs.org/docs/error-decoder.html?invariant=\"+d,y=1;y<arguments.length;y++)p+=\"&args[]=\"+encodeURIComponent(arguments[y]);return\"Minified React error #\"+d+\"; visit \"+p+\" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.\"}var n=new Set,i={};function a(d,p){o(d,p),o(d+\"Capture\",p)}function o(d,p){for(i[d]=p,d=0;d<p.length;d++)n.add(p[d])}var s=!(typeof window>\"u\"||typeof window.document>\"u\"||typeof window.document.createElement>\"u\"),c=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$/,f={},h={};function m(d){return c.call(h,d)?!0:c.call(f,d)?!1:u.test(d)?h[d]=!0:(f[d]=!0,!1)}function g(d,p,y,S){if(y!==null&&y.type===0)return!1;switch(typeof p){case\"function\":case\"symbol\":return!0;case\"boolean\":return S?!1:y!==null?!y.acceptsBooleans:(d=d.toLowerCase().slice(0,5),d!==\"data-\"&&d!==\"aria-\");default:return!1}}function x(d,p,y,S){if(p===null||typeof p>\"u\"||g(d,p,y,S))return!0;if(S)return!1;if(y!==null)switch(y.type){case 3:return!p;case 4:return p===!1;case 5:return isNaN(p);case 6:return isNaN(p)||1>p}return!1}function v(d,p,y,S,j,O,M){this.acceptsBooleans=p===2||p===3||p===4,this.attributeName=S,this.attributeNamespace=j,this.mustUseProperty=y,this.propertyName=d,this.type=p,this.sanitizeURL=O,this.removeEmptyString=M}var b={};\"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style\".split(\" \").forEach(function(d){b[d]=new v(d,0,!1,d,null,!1,!1)}),[[\"acceptCharset\",\"accept-charset\"],[\"className\",\"class\"],[\"htmlFor\",\"for\"],[\"httpEquiv\",\"http-equiv\"]].forEach(function(d){var p=d[0];b[p]=new v(p,1,!1,d[1],null,!1,!1)}),[\"contentEditable\",\"draggable\",\"spellCheck\",\"value\"].forEach(function(d){b[d]=new v(d,2,!1,d.toLowerCase(),null,!1,!1)}),[\"autoReverse\",\"externalResourcesRequired\",\"focusable\",\"preserveAlpha\"].forEach(function(d){b[d]=new v(d,2,!1,d,null,!1,!1)}),\"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope\".split(\" \").forEach(function(d){b[d]=new v(d,3,!1,d.toLowerCase(),null,!1,!1)}),[\"checked\",\"multiple\",\"muted\",\"selected\"].forEach(function(d){b[d]=new v(d,3,!0,d,null,!1,!1)}),[\"capture\",\"download\"].forEach(function(d){b[d]=new v(d,4,!1,d,null,!1,!1)}),[\"cols\",\"rows\",\"size\",\"span\"].forEach(function(d){b[d]=new v(d,6,!1,d,null,!1,!1)}),[\"rowSpan\",\"start\"].forEach(function(d){b[d]=new v(d,5,!1,d.toLowerCase(),null,!1,!1)});var w=/[\\-:]([a-z])/g;function C(d){return d[1].toUpperCase()}\"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height\".split(\" \").forEach(function(d){var p=d.replace(w,C);b[p]=new v(p,1,!1,d,null,!1,!1)}),\"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type\".split(\" \").forEach(function(d){var p=d.replace(w,C);b[p]=new v(p,1,!1,d,\"http://www.w3.org/1999/xlink\",!1,!1)}),[\"xml:base\",\"xml:lang\",\"xml:space\"].forEach(function(d){var p=d.replace(w,C);b[p]=new v(p,1,!1,d,\"http://www.w3.org/XML/1998/namespace\",!1,!1)}),[\"tabIndex\",\"crossOrigin\"].forEach(function(d){b[d]=new v(d,1,!1,d.toLowerCase(),null,!1,!1)}),b.xlinkHref=new v(\"xlinkHref\",1,!1,\"xlink:href\",\"http://www.w3.org/1999/xlink\",!0,!1),[\"src\",\"href\",\"action\",\"formAction\"].forEach(function(d){b[d]=new v(d,1,!1,d.toLowerCase(),null,!0,!0)});function _(d,p,y,S){var j=b.hasOwnProperty(p)?b[p]:null;(j!==null?j.type!==0:S||!(2<p.length)||p[0]!==\"o\"&&p[0]!==\"O\"||p[1]!==\"n\"&&p[1]!==\"N\")&&(x(p,y,j,S)&&(y=null),S||j===null?m(p)&&(y===null?d.removeAttribute(p):d.setAttribute(p,\"\"+y)):j.mustUseProperty?d[j.propertyName]=y===null?j.type===3?!1:\"\":y:(p=j.attributeName,S=j.attributeNamespace,y===null?d.removeAttribute(p):(j=j.type,y=j===3||j===4&&y===!0?\"\":\"\"+y,S?d.setAttributeNS(S,p,y):d.setAttribute(p,y))))}var N=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,A=Symbol.for(\"react.element\"),T=Symbol.for(\"react.portal\"),P=Symbol.for(\"react.fragment\"),k=Symbol.for(\"react.strict_mode\"),I=Symbol.for(\"react.profiler\"),R=Symbol.for(\"react.provider\"),F=Symbol.for(\"react.context\"),D=Symbol.for(\"react.forward_ref\"),L=Symbol.for(\"react.suspense\"),q=Symbol.for(\"react.suspense_list\"),W=Symbol.for(\"react.memo\"),V=Symbol.for(\"react.lazy\"),K=Symbol.for(\"react.offscreen\"),z=Symbol.iterator;function re(d){return d===null||typeof d!=\"object\"?null:(d=z&&d[z]||d[\"@@iterator\"],typeof d==\"function\"?d:null)}var ne=Object.assign,U;function Y(d){if(U===void 0)try{throw Error()}catch(y){var p=y.stack.trim().match(/\\n( *(at )?)/);U=p&&p[1]||\"\"}return`\n`+U+d}var me=!1;function Ee(d,p){if(!d||me)return\"\";me=!0;var y=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(p)if(p=function(){throw Error()},Object.defineProperty(p.prototype,\"props\",{set:function(){throw Error()}}),typeof Reflect==\"object\"&&Reflect.construct){try{Reflect.construct(p,[])}catch(se){var S=se}Reflect.construct(d,[],p)}else{try{p.call()}catch(se){S=se}d.call(p.prototype)}else{try{throw Error()}catch(se){S=se}d()}}catch(se){if(se&&S&&typeof se.stack==\"string\"){for(var j=se.stack.split(`\n`),O=S.stack.split(`\n`),M=j.length-1,H=O.length-1;1<=M&&0<=H&&j[M]!==O[H];)H--;for(;1<=M&&0<=H;M--,H--)if(j[M]!==O[H]){if(M!==1||H!==1)do if(M--,H--,0>H||j[M]!==O[H]){var J=`\n`+j[M].replace(\" at new \",\" at \");return d.displayName&&J.includes(\"<anonymous>\")&&(J=J.replace(\"<anonymous>\",d.displayName)),J}while(1<=M&&0<=H);break}}}finally{me=!1,Error.prepareStackTrace=y}return(d=d?d.displayName||d.name:\"\")?Y(d):\"\"}function Fe(d){switch(d.tag){case 5:return Y(d.type);case 16:return Y(\"Lazy\");case 13:return Y(\"Suspense\");case 19:return Y(\"SuspenseList\");case 0:case 2:case 15:return d=Ee(d.type,!1),d;case 11:return d=Ee(d.type.render,!1),d;case 1:return d=Ee(d.type,!0),d;default:return\"\"}}function Me(d){if(d==null)return null;if(typeof d==\"function\")return d.displayName||d.name||null;if(typeof d==\"string\")return d;switch(d){case P:return\"Fragment\";case T:return\"Portal\";case I:return\"Profiler\";case k:return\"StrictMode\";case L:return\"Suspense\";case q:return\"SuspenseList\"}if(typeof d==\"object\")switch(d.$$typeof){case F:return(d.displayName||\"Context\")+\".Consumer\";case R:return(d._context.displayName||\"Context\")+\".Provider\";case D:var p=d.render;return d=d.displayName,d||(d=p.displayName||p.name||\"\",d=d!==\"\"?\"ForwardRef(\"+d+\")\":\"ForwardRef\"),d;case W:return p=d.displayName||null,p!==null?p:Me(d.type)||\"Memo\";case V:p=d._payload,d=d._init;try{return Me(d(p))}catch{}}return null}function je(d){var p=d.type;switch(d.tag){case 24:return\"Cache\";case 9:return(p.displayName||\"Context\")+\".Consumer\";case 10:return(p._context.displayName||\"Context\")+\".Provider\";case 18:return\"DehydratedFragment\";case 11:return d=p.render,d=d.displayName||d.name||\"\",p.displayName||(d!==\"\"?\"ForwardRef(\"+d+\")\":\"ForwardRef\");case 7:return\"Fragment\";case 5:return p;case 4:return\"Portal\";case 3:return\"Root\";case 6:return\"Text\";case 16:return Me(p);case 8:return p===k?\"StrictMode\":\"Mode\";case 22:return\"Offscreen\";case 12:return\"Profiler\";case 21:return\"Scope\";case 13:return\"Suspense\";case 19:return\"SuspenseList\";case 25:return\"TracingMarker\";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof p==\"function\")return p.displayName||p.name||null;if(typeof p==\"string\")return p}return null}function Ae(d){switch(typeof d){case\"boolean\":case\"number\":case\"string\":case\"undefined\":return d;case\"object\":return d;default:return\"\"}}function fe(d){var p=d.type;return(d=d.nodeName)&&d.toLowerCase()===\"input\"&&(p===\"checkbox\"||p===\"radio\")}function _e(d){var p=fe(d)?\"checked\":\"value\",y=Object.getOwnPropertyDescriptor(d.constructor.prototype,p),S=\"\"+d[p];if(!d.hasOwnProperty(p)&&typeof y<\"u\"&&typeof y.get==\"function\"&&typeof y.set==\"function\"){var j=y.get,O=y.set;return Object.defineProperty(d,p,{configurable:!0,get:function(){return j.call(this)},set:function(M){S=\"\"+M,O.call(this,M)}}),Object.defineProperty(d,p,{enumerable:y.enumerable}),{getValue:function(){return S},setValue:function(M){S=\"\"+M},stopTracking:function(){d._valueTracker=null,delete d[p]}}}}function we(d){d._valueTracker||(d._valueTracker=_e(d))}function ce(d){if(!d)return!1;var p=d._valueTracker;if(!p)return!0;var y=p.getValue(),S=\"\";return d&&(S=fe(d)?d.checked?\"true\":\"false\":d.value),d=S,d!==y?(p.setValue(d),!0):!1}function at(d){if(d=d||(typeof document<\"u\"?document:void 0),typeof d>\"u\")return null;try{return d.activeElement||d.body}catch{return d.body}}function le(d,p){var y=p.checked;return ne({},p,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:y??d._wrapperState.initialChecked})}function qe(d,p){var y=p.defaultValue==null?\"\":p.defaultValue,S=p.checked!=null?p.checked:p.defaultChecked;y=Ae(p.value!=null?p.value:y),d._wrapperState={initialChecked:S,initialValue:y,controlled:p.type===\"checkbox\"||p.type===\"radio\"?p.checked!=null:p.value!=null}}function tt(d,p){p=p.checked,p!=null&&_(d,\"checked\",p,!1)}function ke(d,p){tt(d,p);var y=Ae(p.value),S=p.type;if(y!=null)S===\"number\"?(y===0&&d.value===\"\"||d.value!=y)&&(d.value=\"\"+y):d.value!==\"\"+y&&(d.value=\"\"+y);else if(S===\"submit\"||S===\"reset\"){d.removeAttribute(\"value\");return}p.hasOwnProperty(\"value\")?qt(d,p.type,y):p.hasOwnProperty(\"defaultValue\")&&qt(d,p.type,Ae(p.defaultValue)),p.checked==null&&p.defaultChecked!=null&&(d.defaultChecked=!!p.defaultChecked)}function sr(d,p,y){if(p.hasOwnProperty(\"value\")||p.hasOwnProperty(\"defaultValue\")){var S=p.type;if(!(S!==\"submit\"&&S!==\"reset\"||p.value!==void 0&&p.value!==null))return;p=\"\"+d._wrapperState.initialValue,y||p===d.value||(d.value=p),d.defaultValue=p}y=d.name,y!==\"\"&&(d.name=\"\"),d.defaultChecked=!!d._wrapperState.initialChecked,y!==\"\"&&(d.name=y)}function qt(d,p,y){(p!==\"number\"||at(d.ownerDocument)!==d)&&(y==null?d.defaultValue=\"\"+d._wrapperState.initialValue:d.defaultValue!==\"\"+y&&(d.defaultValue=\"\"+y))}var X=Array.isArray;function $(d,p,y,S){if(d=d.options,p){p={};for(var j=0;j<y.length;j++)p[\"$\"+y[j]]=!0;for(y=0;y<d.length;y++)j=p.hasOwnProperty(\"$\"+d[y].value),d[y].selected!==j&&(d[y].selected=j),j&&S&&(d[y].defaultSelected=!0)}else{for(y=\"\"+Ae(y),p=null,j=0;j<d.length;j++){if(d[j].value===y){d[j].selected=!0,S&&(d[j].defaultSelected=!0);return}p!==null||d[j].disabled||(p=d[j])}p!==null&&(p.selected=!0)}}function Q(d,p){if(p.dangerouslySetInnerHTML!=null)throw Error(r(91));return ne({},p,{value:void 0,defaultValue:void 0,children:\"\"+d._wrapperState.initialValue})}function ue(d,p){var y=p.value;if(y==null){if(y=p.children,p=p.defaultValue,y!=null){if(p!=null)throw Error(r(92));if(X(y)){if(1<y.length)throw Error(r(93));y=y[0]}p=y}p==null&&(p=\"\"),y=p}d._wrapperState={initialValue:Ae(y)}}function pe(d,p){var y=Ae(p.value),S=Ae(p.defaultValue);y!=null&&(y=\"\"+y,y!==d.value&&(d.value=y),p.defaultValue==null&&d.defaultValue!==y&&(d.defaultValue=y)),S!=null&&(d.defaultValue=\"\"+S)}function ge(d){var p=d.textContent;p===d._wrapperState.initialValue&&p!==\"\"&&p!==null&&(d.value=p)}function Ve(d){switch(d){case\"svg\":return\"http://www.w3.org/2000/svg\";case\"math\":return\"http://www.w3.org/1998/Math/MathML\";default:return\"http://www.w3.org/1999/xhtml\"}}function gt(d,p){return d==null||d===\"http://www.w3.org/1999/xhtml\"?Ve(p):d===\"http://www.w3.org/2000/svg\"&&p===\"foreignObject\"?\"http://www.w3.org/1999/xhtml\":d}var wt,lr=(function(d){return typeof MSApp<\"u\"&&MSApp.execUnsafeLocalFunction?function(p,y,S,j){MSApp.execUnsafeLocalFunction(function(){return d(p,y,S,j)})}:d})(function(d,p){if(d.namespaceURI!==\"http://www.w3.org/2000/svg\"||\"innerHTML\"in d)d.innerHTML=p;else{for(wt=wt||document.createElement(\"div\"),wt.innerHTML=\"<svg>\"+p.valueOf().toString()+\"</svg>\",p=wt.firstChild;d.firstChild;)d.removeChild(d.firstChild);for(;p.firstChild;)d.appendChild(p.firstChild)}});function Ei(d,p){if(p){var y=d.firstChild;if(y&&y===d.lastChild&&y.nodeType===3){y.nodeValue=p;return}}d.textContent=p}var fr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Qo=[\"Webkit\",\"ms\",\"Moz\",\"O\"];Object.keys(fr).forEach(function(d){Qo.forEach(function(p){p=p+d.charAt(0).toUpperCase()+d.substring(1),fr[p]=fr[d]})});function yo(d,p,y){return p==null||typeof p==\"boolean\"||p===\"\"?\"\":y||typeof p!=\"number\"||p===0||fr.hasOwnProperty(d)&&fr[d]?(\"\"+p).trim():p+\"px\"}function qs(d,p){d=d.style;for(var y in p)if(p.hasOwnProperty(y)){var S=y.indexOf(\"--\")===0,j=yo(y,p[y],S);y===\"float\"&&(y=\"cssFloat\"),S?d.setProperty(y,j):d[y]=j}}var Mu=ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(d,p){if(p){if(Mu[d]&&(p.children!=null||p.dangerouslySetInnerHTML!=null))throw Error(r(137,d));if(p.dangerouslySetInnerHTML!=null){if(p.children!=null)throw Error(r(60));if(typeof p.dangerouslySetInnerHTML!=\"object\"||!(\"__html\"in p.dangerouslySetInnerHTML))throw Error(r(61))}if(p.style!=null&&typeof p.style!=\"object\")throw Error(r(62))}}function We(d,p){if(d.indexOf(\"-\")===-1)return typeof p.is==\"string\";switch(d){case\"annotation-xml\":case\"color-profile\":case\"font-face\":case\"font-face-src\":case\"font-face-uri\":case\"font-face-format\":case\"font-face-name\":case\"missing-glyph\":return!1;default:return!0}}var Et=null;function vr(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var Da=null,Jo=null,Ui=null;function D0(d){if(d=Ih(d)){if(typeof Da!=\"function\")throw Error(r(280));var p=d.stateNode;p&&(p=ig(p),Da(d.stateNode,d.type,p))}}function Hs(d){Jo?Ui?Ui.push(d):Ui=[d]:Jo=d}function MP(){if(Jo){var d=Jo,p=Ui;if(Ui=Jo=null,D0(d),p)for(d=0;d<p.length;d++)D0(p[d])}}function DP(d,p){return d(p)}function RP(){}var Z1=!1;function FP(d,p,y){if(Z1)return d(p,y);Z1=!0;try{return DP(d,p,y)}finally{Z1=!1,(Jo!==null||Ui!==null)&&(RP(),MP())}}function fh(d,p){var y=d.stateNode;if(y===null)return null;var S=ig(y);if(S===null)return null;y=S[p];e:switch(p){case\"onClick\":case\"onClickCapture\":case\"onDoubleClick\":case\"onDoubleClickCapture\":case\"onMouseDown\":case\"onMouseDownCapture\":case\"onMouseMove\":case\"onMouseMoveCapture\":case\"onMouseUp\":case\"onMouseUpCapture\":case\"onMouseEnter\":(S=!S.disabled)||(d=d.type,S=!(d===\"button\"||d===\"input\"||d===\"select\"||d===\"textarea\")),d=!S;break e;default:d=!1}if(d)return null;if(y&&typeof y!=\"function\")throw Error(r(231,p,typeof y));return y}var Q1=!1;if(s)try{var hh={};Object.defineProperty(hh,\"passive\",{get:function(){Q1=!0}}),window.addEventListener(\"test\",hh,hh),window.removeEventListener(\"test\",hh,hh)}catch{Q1=!1}function UJ(d,p,y,S,j,O,M,H,J){var se=Array.prototype.slice.call(arguments,3);try{p.apply(y,se)}catch(be){this.onError(be)}}var ph=!1,R0=null,F0=!1,J1=null,zJ={onError:function(d){ph=!0,R0=d}};function WJ(d,p,y,S,j,O,M,H,J){ph=!1,R0=null,UJ.apply(zJ,arguments)}function qJ(d,p,y,S,j,O,M,H,J){if(WJ.apply(this,arguments),ph){if(ph){var se=R0;ph=!1,R0=null}else throw Error(r(198));F0||(F0=!0,J1=se)}}function hc(d){var p=d,y=d;if(d.alternate)for(;p.return;)p=p.return;else{d=p;do p=d,(p.flags&4098)!==0&&(y=p.return),d=p.return;while(d)}return p.tag===3?y:null}function LP(d){if(d.tag===13){var p=d.memoizedState;if(p===null&&(d=d.alternate,d!==null&&(p=d.memoizedState)),p!==null)return p.dehydrated}return null}function BP(d){if(hc(d)!==d)throw Error(r(188))}function HJ(d){var p=d.alternate;if(!p){if(p=hc(d),p===null)throw Error(r(188));return p!==d?null:d}for(var y=d,S=p;;){var j=y.return;if(j===null)break;var O=j.alternate;if(O===null){if(S=j.return,S!==null){y=S;continue}break}if(j.child===O.child){for(O=j.child;O;){if(O===y)return BP(j),d;if(O===S)return BP(j),p;O=O.sibling}throw Error(r(188))}if(y.return!==S.return)y=j,S=O;else{for(var M=!1,H=j.child;H;){if(H===y){M=!0,y=j,S=O;break}if(H===S){M=!0,S=j,y=O;break}H=H.sibling}if(!M){for(H=O.child;H;){if(H===y){M=!0,y=O,S=j;break}if(H===S){M=!0,S=O,y=j;break}H=H.sibling}if(!M)throw Error(r(189))}}if(y.alternate!==S)throw Error(r(190))}if(y.tag!==3)throw Error(r(188));return y.stateNode.current===y?d:p}function $P(d){return d=HJ(d),d!==null?VP(d):null}function VP(d){if(d.tag===5||d.tag===6)return d;for(d=d.child;d!==null;){var p=VP(d);if(p!==null)return p;d=d.sibling}return null}var UP=e.unstable_scheduleCallback,zP=e.unstable_cancelCallback,GJ=e.unstable_shouldYield,KJ=e.unstable_requestPaint,qr=e.unstable_now,XJ=e.unstable_getCurrentPriorityLevel,eb=e.unstable_ImmediatePriority,WP=e.unstable_UserBlockingPriority,L0=e.unstable_NormalPriority,YJ=e.unstable_LowPriority,qP=e.unstable_IdlePriority,B0=null,xo=null;function ZJ(d){if(xo&&typeof xo.onCommitFiberRoot==\"function\")try{xo.onCommitFiberRoot(B0,d,void 0,(d.current.flags&128)===128)}catch{}}var Ra=Math.clz32?Math.clz32:eee,QJ=Math.log,JJ=Math.LN2;function eee(d){return d>>>=0,d===0?32:31-(QJ(d)/JJ|0)|0}var $0=64,V0=4194304;function mh(d){switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return d&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return d}}function U0(d,p){var y=d.pendingLanes;if(y===0)return 0;var S=0,j=d.suspendedLanes,O=d.pingedLanes,M=y&268435455;if(M!==0){var H=M&~j;H!==0?S=mh(H):(O&=M,O!==0&&(S=mh(O)))}else M=y&~j,M!==0?S=mh(M):O!==0&&(S=mh(O));if(S===0)return 0;if(p!==0&&p!==S&&(p&j)===0&&(j=S&-S,O=p&-p,j>=O||j===16&&(O&4194240)!==0))return p;if((S&4)!==0&&(S|=y&16),p=d.entangledLanes,p!==0)for(d=d.entanglements,p&=S;0<p;)y=31-Ra(p),j=1<<y,S|=d[y],p&=~j;return S}function tee(d,p){switch(d){case 1:case 2:case 4:return p+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ree(d,p){for(var y=d.suspendedLanes,S=d.pingedLanes,j=d.expirationTimes,O=d.pendingLanes;0<O;){var M=31-Ra(O),H=1<<M,J=j[M];J===-1?((H&y)===0||(H&S)!==0)&&(j[M]=tee(H,p)):J<=p&&(d.expiredLanes|=H),O&=~H}}function tb(d){return d=d.pendingLanes&-1073741825,d!==0?d:d&1073741824?1073741824:0}function HP(){var d=$0;return $0<<=1,($0&4194240)===0&&($0=64),d}function rb(d){for(var p=[],y=0;31>y;y++)p.push(d);return p}function gh(d,p,y){d.pendingLanes|=p,p!==536870912&&(d.suspendedLanes=0,d.pingedLanes=0),d=d.eventTimes,p=31-Ra(p),d[p]=y}function nee(d,p){var y=d.pendingLanes&~p;d.pendingLanes=p,d.suspendedLanes=0,d.pingedLanes=0,d.expiredLanes&=p,d.mutableReadLanes&=p,d.entangledLanes&=p,p=d.entanglements;var S=d.eventTimes;for(d=d.expirationTimes;0<y;){var j=31-Ra(y),O=1<<j;p[j]=0,S[j]=-1,d[j]=-1,y&=~O}}function nb(d,p){var y=d.entangledLanes|=p;for(d=d.entanglements;y;){var S=31-Ra(y),j=1<<S;j&p|d[S]&p&&(d[S]|=p),y&=~j}}var Qt=0;function GP(d){return d&=-d,1<d?4<d?(d&268435455)!==0?16:536870912:4:1}var KP,ib,XP,YP,ZP,ab=!1,z0=[],Gs=null,Ks=null,Xs=null,vh=new Map,yh=new Map,Ys=[],iee=\"mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit\".split(\" \");function QP(d,p){switch(d){case\"focusin\":case\"focusout\":Gs=null;break;case\"dragenter\":case\"dragleave\":Ks=null;break;case\"mouseover\":case\"mouseout\":Xs=null;break;case\"pointerover\":case\"pointerout\":vh.delete(p.pointerId);break;case\"gotpointercapture\":case\"lostpointercapture\":yh.delete(p.pointerId)}}function xh(d,p,y,S,j,O){return d===null||d.nativeEvent!==O?(d={blockedOn:p,domEventName:y,eventSystemFlags:S,nativeEvent:O,targetContainers:[j]},p!==null&&(p=Ih(p),p!==null&&ib(p)),d):(d.eventSystemFlags|=S,p=d.targetContainers,j!==null&&p.indexOf(j)===-1&&p.push(j),d)}function aee(d,p,y,S,j){switch(p){case\"focusin\":return Gs=xh(Gs,d,p,y,S,j),!0;case\"dragenter\":return Ks=xh(Ks,d,p,y,S,j),!0;case\"mouseover\":return Xs=xh(Xs,d,p,y,S,j),!0;case\"pointerover\":var O=j.pointerId;return vh.set(O,xh(vh.get(O)||null,d,p,y,S,j)),!0;case\"gotpointercapture\":return O=j.pointerId,yh.set(O,xh(yh.get(O)||null,d,p,y,S,j)),!0}return!1}function JP(d){var p=pc(d.target);if(p!==null){var y=hc(p);if(y!==null){if(p=y.tag,p===13){if(p=LP(y),p!==null){d.blockedOn=p,ZP(d.priority,function(){XP(y)});return}}else if(p===3&&y.stateNode.current.memoizedState.isDehydrated){d.blockedOn=y.tag===3?y.stateNode.containerInfo:null;return}}}d.blockedOn=null}function W0(d){if(d.blockedOn!==null)return!1;for(var p=d.targetContainers;0<p.length;){var y=sb(d.domEventName,d.eventSystemFlags,p[0],d.nativeEvent);if(y===null){y=d.nativeEvent;var S=new y.constructor(y.type,y);Et=S,y.target.dispatchEvent(S),Et=null}else return p=Ih(y),p!==null&&ib(p),d.blockedOn=y,!1;p.shift()}return!0}function e4(d,p,y){W0(d)&&y.delete(p)}function oee(){ab=!1,Gs!==null&&W0(Gs)&&(Gs=null),Ks!==null&&W0(Ks)&&(Ks=null),Xs!==null&&W0(Xs)&&(Xs=null),vh.forEach(e4),yh.forEach(e4)}function bh(d,p){d.blockedOn===p&&(d.blockedOn=null,ab||(ab=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,oee)))}function wh(d){function p(j){return bh(j,d)}if(0<z0.length){bh(z0[0],d);for(var y=1;y<z0.length;y++){var S=z0[y];S.blockedOn===d&&(S.blockedOn=null)}}for(Gs!==null&&bh(Gs,d),Ks!==null&&bh(Ks,d),Xs!==null&&bh(Xs,d),vh.forEach(p),yh.forEach(p),y=0;y<Ys.length;y++)S=Ys[y],S.blockedOn===d&&(S.blockedOn=null);for(;0<Ys.length&&(y=Ys[0],y.blockedOn===null);)JP(y),y.blockedOn===null&&Ys.shift()}var Du=N.ReactCurrentBatchConfig,q0=!0;function see(d,p,y,S){var j=Qt,O=Du.transition;Du.transition=null;try{Qt=1,ob(d,p,y,S)}finally{Qt=j,Du.transition=O}}function lee(d,p,y,S){var j=Qt,O=Du.transition;Du.transition=null;try{Qt=4,ob(d,p,y,S)}finally{Qt=j,Du.transition=O}}function ob(d,p,y,S){if(q0){var j=sb(d,p,y,S);if(j===null)Cb(d,p,S,H0,y),QP(d,S);else if(aee(j,d,p,y,S))S.stopPropagation();else if(QP(d,S),p&4&&-1<iee.indexOf(d)){for(;j!==null;){var O=Ih(j);if(O!==null&&KP(O),O=sb(d,p,y,S),O===null&&Cb(d,p,S,H0,y),O===j)break;j=O}j!==null&&S.stopPropagation()}else Cb(d,p,S,null,y)}}var H0=null;function sb(d,p,y,S){if(H0=null,d=vr(S),d=pc(d),d!==null)if(p=hc(d),p===null)d=null;else if(y=p.tag,y===13){if(d=LP(p),d!==null)return d;d=null}else if(y===3){if(p.stateNode.current.memoizedState.isDehydrated)return p.tag===3?p.stateNode.containerInfo:null;d=null}else p!==d&&(d=null);return H0=d,null}function t4(d){switch(d){case\"cancel\":case\"click\":case\"close\":case\"contextmenu\":case\"copy\":case\"cut\":case\"auxclick\":case\"dblclick\":case\"dragend\":case\"dragstart\":case\"drop\":case\"focusin\":case\"focusout\":case\"input\":case\"invalid\":case\"keydown\":case\"keypress\":case\"keyup\":case\"mousedown\":case\"mouseup\":case\"paste\":case\"pause\":case\"play\":case\"pointercancel\":case\"pointerdown\":case\"pointerup\":case\"ratechange\":case\"reset\":case\"resize\":case\"seeked\":case\"submit\":case\"touchcancel\":case\"touchend\":case\"touchstart\":case\"volumechange\":case\"change\":case\"selectionchange\":case\"textInput\":case\"compositionstart\":case\"compositionend\":case\"compositionupdate\":case\"beforeblur\":case\"afterblur\":case\"beforeinput\":case\"blur\":case\"fullscreenchange\":case\"focus\":case\"hashchange\":case\"popstate\":case\"select\":case\"selectstart\":return 1;case\"drag\":case\"dragenter\":case\"dragexit\":case\"dragleave\":case\"dragover\":case\"mousemove\":case\"mouseout\":case\"mouseover\":case\"pointermove\":case\"pointerout\":case\"pointerover\":case\"scroll\":case\"toggle\":case\"touchmove\":case\"wheel\":case\"mouseenter\":case\"mouseleave\":case\"pointerenter\":case\"pointerleave\":return 4;case\"message\":switch(XJ()){case eb:return 1;case WP:return 4;case L0:case YJ:return 16;case qP:return 536870912;default:return 16}default:return 16}}var Zs=null,lb=null,G0=null;function r4(){if(G0)return G0;var d,p=lb,y=p.length,S,j=\"value\"in Zs?Zs.value:Zs.textContent,O=j.length;for(d=0;d<y&&p[d]===j[d];d++);var M=y-d;for(S=1;S<=M&&p[y-S]===j[O-S];S++);return G0=j.slice(d,1<S?1-S:void 0)}function K0(d){var p=d.keyCode;return\"charCode\"in d?(d=d.charCode,d===0&&p===13&&(d=13)):d=p,d===10&&(d=13),32<=d||d===13?d:0}function X0(){return!0}function n4(){return!1}function zi(d){function p(y,S,j,O,M){this._reactName=y,this._targetInst=j,this.type=S,this.nativeEvent=O,this.target=M,this.currentTarget=null;for(var H in d)d.hasOwnProperty(H)&&(y=d[H],this[H]=y?y(O):O[H]);return this.isDefaultPrevented=(O.defaultPrevented!=null?O.defaultPrevented:O.returnValue===!1)?X0:n4,this.isPropagationStopped=n4,this}return ne(p.prototype,{preventDefault:function(){this.defaultPrevented=!0;var y=this.nativeEvent;y&&(y.preventDefault?y.preventDefault():typeof y.returnValue!=\"unknown\"&&(y.returnValue=!1),this.isDefaultPrevented=X0)},stopPropagation:function(){var y=this.nativeEvent;y&&(y.stopPropagation?y.stopPropagation():typeof y.cancelBubble!=\"unknown\"&&(y.cancelBubble=!0),this.isPropagationStopped=X0)},persist:function(){},isPersistent:X0}),p}var Ru={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cb=zi(Ru),Sh=ne({},Ru,{view:0,detail:0}),cee=zi(Sh),ub,db,_h,Y0=ne({},Sh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hb,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return\"movementX\"in d?d.movementX:(d!==_h&&(_h&&d.type===\"mousemove\"?(ub=d.screenX-_h.screenX,db=d.screenY-_h.screenY):db=ub=0,_h=d),ub)},movementY:function(d){return\"movementY\"in d?d.movementY:db}}),i4=zi(Y0),uee=ne({},Y0,{dataTransfer:0}),dee=zi(uee),fee=ne({},Sh,{relatedTarget:0}),fb=zi(fee),hee=ne({},Ru,{animationName:0,elapsedTime:0,pseudoElement:0}),pee=zi(hee),mee=ne({},Ru,{clipboardData:function(d){return\"clipboardData\"in d?d.clipboardData:window.clipboardData}}),gee=zi(mee),vee=ne({},Ru,{data:0}),a4=zi(vee),yee={Esc:\"Escape\",Spacebar:\" \",Left:\"ArrowLeft\",Up:\"ArrowUp\",Right:\"ArrowRight\",Down:\"ArrowDown\",Del:\"Delete\",Win:\"OS\",Menu:\"ContextMenu\",Apps:\"ContextMenu\",Scroll:\"ScrollLock\",MozPrintableKey:\"Unidentified\"},xee={8:\"Backspace\",9:\"Tab\",12:\"Clear\",13:\"Enter\",16:\"Shift\",17:\"Control\",18:\"Alt\",19:\"Pause\",20:\"CapsLock\",27:\"Escape\",32:\" \",33:\"PageUp\",34:\"PageDown\",35:\"End\",36:\"Home\",37:\"ArrowLeft\",38:\"ArrowUp\",39:\"ArrowRight\",40:\"ArrowDown\",45:\"Insert\",46:\"Delete\",112:\"F1\",113:\"F2\",114:\"F3\",115:\"F4\",116:\"F5\",117:\"F6\",118:\"F7\",119:\"F8\",120:\"F9\",121:\"F10\",122:\"F11\",123:\"F12\",144:\"NumLock\",145:\"ScrollLock\",224:\"Meta\"},bee={Alt:\"altKey\",Control:\"ctrlKey\",Meta:\"metaKey\",Shift:\"shiftKey\"};function wee(d){var p=this.nativeEvent;return p.getModifierState?p.getModifierState(d):(d=bee[d])?!!p[d]:!1}function hb(){return wee}var See=ne({},Sh,{key:function(d){if(d.key){var p=yee[d.key]||d.key;if(p!==\"Unidentified\")return p}return d.type===\"keypress\"?(d=K0(d),d===13?\"Enter\":String.fromCharCode(d)):d.type===\"keydown\"||d.type===\"keyup\"?xee[d.keyCode]||\"Unidentified\":\"\"},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hb,charCode:function(d){return d.type===\"keypress\"?K0(d):0},keyCode:function(d){return d.type===\"keydown\"||d.type===\"keyup\"?d.keyCode:0},which:function(d){return d.type===\"keypress\"?K0(d):d.type===\"keydown\"||d.type===\"keyup\"?d.keyCode:0}}),_ee=zi(See),Cee=ne({},Y0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),o4=zi(Cee),Aee=ne({},Sh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hb}),Nee=zi(Aee),Eee=ne({},Ru,{propertyName:0,elapsedTime:0,pseudoElement:0}),jee=zi(Eee),Tee=ne({},Y0,{deltaX:function(d){return\"deltaX\"in d?d.deltaX:\"wheelDeltaX\"in d?-d.wheelDeltaX:0},deltaY:function(d){return\"deltaY\"in d?d.deltaY:\"wheelDeltaY\"in d?-d.wheelDeltaY:\"wheelDelta\"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),Pee=zi(Tee),Oee=[9,13,27,32],pb=s&&\"CompositionEvent\"in window,Ch=null;s&&\"documentMode\"in document&&(Ch=document.documentMode);var kee=s&&\"TextEvent\"in window&&!Ch,s4=s&&(!pb||Ch&&8<Ch&&11>=Ch),l4=\" \",c4=!1;function u4(d,p){switch(d){case\"keyup\":return Oee.indexOf(p.keyCode)!==-1;case\"keydown\":return p.keyCode!==229;case\"keypress\":case\"mousedown\":case\"focusout\":return!0;default:return!1}}function d4(d){return d=d.detail,typeof d==\"object\"&&\"data\"in d?d.data:null}var Fu=!1;function Iee(d,p){switch(d){case\"compositionend\":return d4(p);case\"keypress\":return p.which!==32?null:(c4=!0,l4);case\"textInput\":return d=p.data,d===l4&&c4?null:d;default:return null}}function Mee(d,p){if(Fu)return d===\"compositionend\"||!pb&&u4(d,p)?(d=r4(),G0=lb=Zs=null,Fu=!1,d):null;switch(d){case\"paste\":return null;case\"keypress\":if(!(p.ctrlKey||p.altKey||p.metaKey)||p.ctrlKey&&p.altKey){if(p.char&&1<p.char.length)return p.char;if(p.which)return String.fromCharCode(p.which)}return null;case\"compositionend\":return s4&&p.locale!==\"ko\"?null:p.data;default:return null}}var Dee={color:!0,date:!0,datetime:!0,\"datetime-local\":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function f4(d){var p=d&&d.nodeName&&d.nodeName.toLowerCase();return p===\"input\"?!!Dee[d.type]:p===\"textarea\"}function h4(d,p,y,S){Hs(S),p=tg(p,\"onChange\"),0<p.length&&(y=new cb(\"onChange\",\"change\",null,y,S),d.push({event:y,listeners:p}))}var Ah=null,Nh=null;function Ree(d){O4(d,0)}function Z0(d){var p=Uu(d);if(ce(p))return d}function Fee(d,p){if(d===\"change\")return p}var p4=!1;if(s){var mb;if(s){var gb=\"oninput\"in document;if(!gb){var m4=document.createElement(\"div\");m4.setAttribute(\"oninput\",\"return;\"),gb=typeof m4.oninput==\"function\"}mb=gb}else mb=!1;p4=mb&&(!document.documentMode||9<document.documentMode)}function g4(){Ah&&(Ah.detachEvent(\"onpropertychange\",v4),Nh=Ah=null)}function v4(d){if(d.propertyName===\"value\"&&Z0(Nh)){var p=[];h4(p,Nh,d,vr(d)),FP(Ree,p)}}function Lee(d,p,y){d===\"focusin\"?(g4(),Ah=p,Nh=y,Ah.attachEvent(\"onpropertychange\",v4)):d===\"focusout\"&&g4()}function Bee(d){if(d===\"selectionchange\"||d===\"keyup\"||d===\"keydown\")return Z0(Nh)}function $ee(d,p){if(d===\"click\")return Z0(p)}function Vee(d,p){if(d===\"input\"||d===\"change\")return Z0(p)}function Uee(d,p){return d===p&&(d!==0||1/d===1/p)||d!==d&&p!==p}var Fa=typeof Object.is==\"function\"?Object.is:Uee;function Eh(d,p){if(Fa(d,p))return!0;if(typeof d!=\"object\"||d===null||typeof p!=\"object\"||p===null)return!1;var y=Object.keys(d),S=Object.keys(p);if(y.length!==S.length)return!1;for(S=0;S<y.length;S++){var j=y[S];if(!c.call(p,j)||!Fa(d[j],p[j]))return!1}return!0}function y4(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function x4(d,p){var y=y4(d);d=0;for(var S;y;){if(y.nodeType===3){if(S=d+y.textContent.length,d<=p&&S>=p)return{node:y,offset:p-d};d=S}e:{for(;y;){if(y.nextSibling){y=y.nextSibling;break e}y=y.parentNode}y=void 0}y=y4(y)}}function b4(d,p){return d&&p?d===p?!0:d&&d.nodeType===3?!1:p&&p.nodeType===3?b4(d,p.parentNode):\"contains\"in d?d.contains(p):d.compareDocumentPosition?!!(d.compareDocumentPosition(p)&16):!1:!1}function w4(){for(var d=window,p=at();p instanceof d.HTMLIFrameElement;){try{var y=typeof p.contentWindow.location.href==\"string\"}catch{y=!1}if(y)d=p.contentWindow;else break;p=at(d.document)}return p}function vb(d){var p=d&&d.nodeName&&d.nodeName.toLowerCase();return p&&(p===\"input\"&&(d.type===\"text\"||d.type===\"search\"||d.type===\"tel\"||d.type===\"url\"||d.type===\"password\")||p===\"textarea\"||d.contentEditable===\"true\")}function zee(d){var p=w4(),y=d.focusedElem,S=d.selectionRange;if(p!==y&&y&&y.ownerDocument&&b4(y.ownerDocument.documentElement,y)){if(S!==null&&vb(y)){if(p=S.start,d=S.end,d===void 0&&(d=p),\"selectionStart\"in y)y.selectionStart=p,y.selectionEnd=Math.min(d,y.value.length);else if(d=(p=y.ownerDocument||document)&&p.defaultView||window,d.getSelection){d=d.getSelection();var j=y.textContent.length,O=Math.min(S.start,j);S=S.end===void 0?O:Math.min(S.end,j),!d.extend&&O>S&&(j=S,S=O,O=j),j=x4(y,O);var M=x4(y,S);j&&M&&(d.rangeCount!==1||d.anchorNode!==j.node||d.anchorOffset!==j.offset||d.focusNode!==M.node||d.focusOffset!==M.offset)&&(p=p.createRange(),p.setStart(j.node,j.offset),d.removeAllRanges(),O>S?(d.addRange(p),d.extend(M.node,M.offset)):(p.setEnd(M.node,M.offset),d.addRange(p)))}}for(p=[],d=y;d=d.parentNode;)d.nodeType===1&&p.push({element:d,left:d.scrollLeft,top:d.scrollTop});for(typeof y.focus==\"function\"&&y.focus(),y=0;y<p.length;y++)d=p[y],d.element.scrollLeft=d.left,d.element.scrollTop=d.top}}var Wee=s&&\"documentMode\"in document&&11>=document.documentMode,Lu=null,yb=null,jh=null,xb=!1;function S4(d,p,y){var S=y.window===y?y.document:y.nodeType===9?y:y.ownerDocument;xb||Lu==null||Lu!==at(S)||(S=Lu,\"selectionStart\"in S&&vb(S)?S={start:S.selectionStart,end:S.selectionEnd}:(S=(S.ownerDocument&&S.ownerDocument.defaultView||window).getSelection(),S={anchorNode:S.anchorNode,anchorOffset:S.anchorOffset,focusNode:S.focusNode,focusOffset:S.focusOffset}),jh&&Eh(jh,S)||(jh=S,S=tg(yb,\"onSelect\"),0<S.length&&(p=new cb(\"onSelect\",\"select\",null,p,y),d.push({event:p,listeners:S}),p.target=Lu)))}function Q0(d,p){var y={};return y[d.toLowerCase()]=p.toLowerCase(),y[\"Webkit\"+d]=\"webkit\"+p,y[\"Moz\"+d]=\"moz\"+p,y}var Bu={animationend:Q0(\"Animation\",\"AnimationEnd\"),animationiteration:Q0(\"Animation\",\"AnimationIteration\"),animationstart:Q0(\"Animation\",\"AnimationStart\"),transitionend:Q0(\"Transition\",\"TransitionEnd\")},bb={},_4={};s&&(_4=document.createElement(\"div\").style,\"AnimationEvent\"in window||(delete Bu.animationend.animation,delete Bu.animationiteration.animation,delete Bu.animationstart.animation),\"TransitionEvent\"in window||delete Bu.transitionend.transition);function J0(d){if(bb[d])return bb[d];if(!Bu[d])return d;var p=Bu[d],y;for(y in p)if(p.hasOwnProperty(y)&&y in _4)return bb[d]=p[y];return d}var C4=J0(\"animationend\"),A4=J0(\"animationiteration\"),N4=J0(\"animationstart\"),E4=J0(\"transitionend\"),j4=new Map,T4=\"abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel\".split(\" \");function Qs(d,p){j4.set(d,p),a(p,[d])}for(var wb=0;wb<T4.length;wb++){var Sb=T4[wb],qee=Sb.toLowerCase(),Hee=Sb[0].toUpperCase()+Sb.slice(1);Qs(qee,\"on\"+Hee)}Qs(C4,\"onAnimationEnd\"),Qs(A4,\"onAnimationIteration\"),Qs(N4,\"onAnimationStart\"),Qs(\"dblclick\",\"onDoubleClick\"),Qs(\"focusin\",\"onFocus\"),Qs(\"focusout\",\"onBlur\"),Qs(E4,\"onTransitionEnd\"),o(\"onMouseEnter\",[\"mouseout\",\"mouseover\"]),o(\"onMouseLeave\",[\"mouseout\",\"mouseover\"]),o(\"onPointerEnter\",[\"pointerout\",\"pointerover\"]),o(\"onPointerLeave\",[\"pointerout\",\"pointerover\"]),a(\"onChange\",\"change click focusin focusout input keydown keyup selectionchange\".split(\" \")),a(\"onSelect\",\"focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange\".split(\" \")),a(\"onBeforeInput\",[\"compositionend\",\"keypress\",\"textInput\",\"paste\"]),a(\"onCompositionEnd\",\"compositionend focusout keydown keypress keyup mousedown\".split(\" \")),a(\"onCompositionStart\",\"compositionstart focusout keydown keypress keyup mousedown\".split(\" \")),a(\"onCompositionUpdate\",\"compositionupdate focusout keydown keypress keyup mousedown\".split(\" \"));var Th=\"abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting\".split(\" \"),Gee=new Set(\"cancel close invalid load scroll toggle\".split(\" \").concat(Th));function P4(d,p,y){var S=d.type||\"unknown-event\";d.currentTarget=y,qJ(S,p,void 0,d),d.currentTarget=null}function O4(d,p){p=(p&4)!==0;for(var y=0;y<d.length;y++){var S=d[y],j=S.event;S=S.listeners;e:{var O=void 0;if(p)for(var M=S.length-1;0<=M;M--){var H=S[M],J=H.instance,se=H.currentTarget;if(H=H.listener,J!==O&&j.isPropagationStopped())break e;P4(j,H,se),O=J}else for(M=0;M<S.length;M++){if(H=S[M],J=H.instance,se=H.currentTarget,H=H.listener,J!==O&&j.isPropagationStopped())break e;P4(j,H,se),O=J}}}if(F0)throw d=J1,F0=!1,J1=null,d}function yr(d,p){var y=p[Pb];y===void 0&&(y=p[Pb]=new Set);var S=d+\"__bubble\";y.has(S)||(k4(p,d,2,!1),y.add(S))}function _b(d,p,y){var S=0;p&&(S|=4),k4(y,d,S,p)}var eg=\"_reactListening\"+Math.random().toString(36).slice(2);function Ph(d){if(!d[eg]){d[eg]=!0,n.forEach(function(y){y!==\"selectionchange\"&&(Gee.has(y)||_b(y,!1,d),_b(y,!0,d))});var p=d.nodeType===9?d:d.ownerDocument;p===null||p[eg]||(p[eg]=!0,_b(\"selectionchange\",!1,p))}}function k4(d,p,y,S){switch(t4(p)){case 1:var j=see;break;case 4:j=lee;break;default:j=ob}y=j.bind(null,p,y,d),j=void 0,!Q1||p!==\"touchstart\"&&p!==\"touchmove\"&&p!==\"wheel\"||(j=!0),S?j!==void 0?d.addEventListener(p,y,{capture:!0,passive:j}):d.addEventListener(p,y,!0):j!==void 0?d.addEventListener(p,y,{passive:j}):d.addEventListener(p,y,!1)}function Cb(d,p,y,S,j){var O=S;if((p&1)===0&&(p&2)===0&&S!==null)e:for(;;){if(S===null)return;var M=S.tag;if(M===3||M===4){var H=S.stateNode.containerInfo;if(H===j||H.nodeType===8&&H.parentNode===j)break;if(M===4)for(M=S.return;M!==null;){var J=M.tag;if((J===3||J===4)&&(J=M.stateNode.containerInfo,J===j||J.nodeType===8&&J.parentNode===j))return;M=M.return}for(;H!==null;){if(M=pc(H),M===null)return;if(J=M.tag,J===5||J===6){S=O=M;continue e}H=H.parentNode}}S=S.return}FP(function(){var se=O,be=vr(y),Se=[];e:{var xe=j4.get(d);if(xe!==void 0){var Ue=cb,Ke=d;switch(d){case\"keypress\":if(K0(y)===0)break e;case\"keydown\":case\"keyup\":Ue=_ee;break;case\"focusin\":Ke=\"focus\",Ue=fb;break;case\"focusout\":Ke=\"blur\",Ue=fb;break;case\"beforeblur\":case\"afterblur\":Ue=fb;break;case\"click\":if(y.button===2)break e;case\"auxclick\":case\"dblclick\":case\"mousedown\":case\"mousemove\":case\"mouseup\":case\"mouseout\":case\"mouseover\":case\"contextmenu\":Ue=i4;break;case\"drag\":case\"dragend\":case\"dragenter\":case\"dragexit\":case\"dragleave\":case\"dragover\":case\"dragstart\":case\"drop\":Ue=dee;break;case\"touchcancel\":case\"touchend\":case\"touchmove\":case\"touchstart\":Ue=Nee;break;case C4:case A4:case N4:Ue=pee;break;case E4:Ue=jee;break;case\"scroll\":Ue=cee;break;case\"wheel\":Ue=Pee;break;case\"copy\":case\"cut\":case\"paste\":Ue=gee;break;case\"gotpointercapture\":case\"lostpointercapture\":case\"pointercancel\":case\"pointerdown\":case\"pointermove\":case\"pointerout\":case\"pointerover\":case\"pointerup\":Ue=o4}var Ze=(p&4)!==0,Hr=!Ze&&d===\"scroll\",ie=Ze?xe!==null?xe+\"Capture\":null:xe;Ze=[];for(var ee=se,oe;ee!==null;){oe=ee;var Te=oe.stateNode;if(oe.tag===5&&Te!==null&&(oe=Te,ie!==null&&(Te=fh(ee,ie),Te!=null&&Ze.push(Oh(ee,Te,oe)))),Hr)break;ee=ee.return}0<Ze.length&&(xe=new Ue(xe,Ke,null,y,be),Se.push({event:xe,listeners:Ze}))}}if((p&7)===0){e:{if(xe=d===\"mouseover\"||d===\"pointerover\",Ue=d===\"mouseout\"||d===\"pointerout\",xe&&y!==Et&&(Ke=y.relatedTarget||y.fromElement)&&(pc(Ke)||Ke[es]))break e;if((Ue||xe)&&(xe=be.window===be?be:(xe=be.ownerDocument)?xe.defaultView||xe.parentWindow:window,Ue?(Ke=y.relatedTarget||y.toElement,Ue=se,Ke=Ke?pc(Ke):null,Ke!==null&&(Hr=hc(Ke),Ke!==Hr||Ke.tag!==5&&Ke.tag!==6)&&(Ke=null)):(Ue=null,Ke=se),Ue!==Ke)){if(Ze=i4,Te=\"onMouseLeave\",ie=\"onMouseEnter\",ee=\"mouse\",(d===\"pointerout\"||d===\"pointerover\")&&(Ze=o4,Te=\"onPointerLeave\",ie=\"onPointerEnter\",ee=\"pointer\"),Hr=Ue==null?xe:Uu(Ue),oe=Ke==null?xe:Uu(Ke),xe=new Ze(Te,ee+\"leave\",Ue,y,be),xe.target=Hr,xe.relatedTarget=oe,Te=null,pc(be)===se&&(Ze=new Ze(ie,ee+\"enter\",Ke,y,be),Ze.target=oe,Ze.relatedTarget=Hr,Te=Ze),Hr=Te,Ue&&Ke)t:{for(Ze=Ue,ie=Ke,ee=0,oe=Ze;oe;oe=$u(oe))ee++;for(oe=0,Te=ie;Te;Te=$u(Te))oe++;for(;0<ee-oe;)Ze=$u(Ze),ee--;for(;0<oe-ee;)ie=$u(ie),oe--;for(;ee--;){if(Ze===ie||ie!==null&&Ze===ie.alternate)break t;Ze=$u(Ze),ie=$u(ie)}Ze=null}else Ze=null;Ue!==null&&I4(Se,xe,Ue,Ze,!1),Ke!==null&&Hr!==null&&I4(Se,Hr,Ke,Ze,!0)}}e:{if(xe=se?Uu(se):window,Ue=xe.nodeName&&xe.nodeName.toLowerCase(),Ue===\"select\"||Ue===\"input\"&&xe.type===\"file\")var Je=Fee;else if(f4(xe))if(p4)Je=Vee;else{Je=Bee;var ot=Lee}else(Ue=xe.nodeName)&&Ue.toLowerCase()===\"input\"&&(xe.type===\"checkbox\"||xe.type===\"radio\")&&(Je=$ee);if(Je&&(Je=Je(d,se))){h4(Se,Je,y,be);break e}ot&&ot(d,xe,se),d===\"focusout\"&&(ot=xe._wrapperState)&&ot.controlled&&xe.type===\"number\"&&qt(xe,\"number\",xe.value)}switch(ot=se?Uu(se):window,d){case\"focusin\":(f4(ot)||ot.contentEditable===\"true\")&&(Lu=ot,yb=se,jh=null);break;case\"focusout\":jh=yb=Lu=null;break;case\"mousedown\":xb=!0;break;case\"contextmenu\":case\"mouseup\":case\"dragend\":xb=!1,S4(Se,y,be);break;case\"selectionchange\":if(Wee)break;case\"keydown\":case\"keyup\":S4(Se,y,be)}var st;if(pb)e:{switch(d){case\"compositionstart\":var mt=\"onCompositionStart\";break e;case\"compositionend\":mt=\"onCompositionEnd\";break e;case\"compositionupdate\":mt=\"onCompositionUpdate\";break e}mt=void 0}else Fu?u4(d,y)&&(mt=\"onCompositionEnd\"):d===\"keydown\"&&y.keyCode===229&&(mt=\"onCompositionStart\");mt&&(s4&&y.locale!==\"ko\"&&(Fu||mt!==\"onCompositionStart\"?mt===\"onCompositionEnd\"&&Fu&&(st=r4()):(Zs=be,lb=\"value\"in Zs?Zs.value:Zs.textContent,Fu=!0)),ot=tg(se,mt),0<ot.length&&(mt=new a4(mt,d,null,y,be),Se.push({event:mt,listeners:ot}),st?mt.data=st:(st=d4(y),st!==null&&(mt.data=st)))),(st=kee?Iee(d,y):Mee(d,y))&&(se=tg(se,\"onBeforeInput\"),0<se.length&&(be=new a4(\"onBeforeInput\",\"beforeinput\",null,y,be),Se.push({event:be,listeners:se}),be.data=st))}O4(Se,p)})}function Oh(d,p,y){return{instance:d,listener:p,currentTarget:y}}function tg(d,p){for(var y=p+\"Capture\",S=[];d!==null;){var j=d,O=j.stateNode;j.tag===5&&O!==null&&(j=O,O=fh(d,y),O!=null&&S.unshift(Oh(d,O,j)),O=fh(d,p),O!=null&&S.push(Oh(d,O,j))),d=d.return}return S}function $u(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5);return d||null}function I4(d,p,y,S,j){for(var O=p._reactName,M=[];y!==null&&y!==S;){var H=y,J=H.alternate,se=H.stateNode;if(J!==null&&J===S)break;H.tag===5&&se!==null&&(H=se,j?(J=fh(y,O),J!=null&&M.unshift(Oh(y,J,H))):j||(J=fh(y,O),J!=null&&M.push(Oh(y,J,H)))),y=y.return}M.length!==0&&d.push({event:p,listeners:M})}var Kee=/\\r\\n?/g,Xee=/\\u0000|\\uFFFD/g;function M4(d){return(typeof d==\"string\"?d:\"\"+d).replace(Kee,`\n`).replace(Xee,\"\")}function rg(d,p,y){if(p=M4(p),M4(d)!==p&&y)throw Error(r(425))}function ng(){}var Ab=null,Nb=null;function Eb(d,p){return d===\"textarea\"||d===\"noscript\"||typeof p.children==\"string\"||typeof p.children==\"number\"||typeof p.dangerouslySetInnerHTML==\"object\"&&p.dangerouslySetInnerHTML!==null&&p.dangerouslySetInnerHTML.__html!=null}var jb=typeof setTimeout==\"function\"?setTimeout:void 0,Yee=typeof clearTimeout==\"function\"?clearTimeout:void 0,D4=typeof Promise==\"function\"?Promise:void 0,Zee=typeof queueMicrotask==\"function\"?queueMicrotask:typeof D4<\"u\"?function(d){return D4.resolve(null).then(d).catch(Qee)}:jb;function Qee(d){setTimeout(function(){throw d})}function Tb(d,p){var y=p,S=0;do{var j=y.nextSibling;if(d.removeChild(y),j&&j.nodeType===8)if(y=j.data,y===\"/$\"){if(S===0){d.removeChild(j),wh(p);return}S--}else y!==\"$\"&&y!==\"$?\"&&y!==\"$!\"||S++;y=j}while(y);wh(p)}function Js(d){for(;d!=null;d=d.nextSibling){var p=d.nodeType;if(p===1||p===3)break;if(p===8){if(p=d.data,p===\"$\"||p===\"$!\"||p===\"$?\")break;if(p===\"/$\")return null}}return d}function R4(d){d=d.previousSibling;for(var p=0;d;){if(d.nodeType===8){var y=d.data;if(y===\"$\"||y===\"$!\"||y===\"$?\"){if(p===0)return d;p--}else y===\"/$\"&&p++}d=d.previousSibling}return null}var Vu=Math.random().toString(36).slice(2),bo=\"__reactFiber$\"+Vu,kh=\"__reactProps$\"+Vu,es=\"__reactContainer$\"+Vu,Pb=\"__reactEvents$\"+Vu,Jee=\"__reactListeners$\"+Vu,ete=\"__reactHandles$\"+Vu;function pc(d){var p=d[bo];if(p)return p;for(var y=d.parentNode;y;){if(p=y[es]||y[bo]){if(y=p.alternate,p.child!==null||y!==null&&y.child!==null)for(d=R4(d);d!==null;){if(y=d[bo])return y;d=R4(d)}return p}d=y,y=d.parentNode}return null}function Ih(d){return d=d[bo]||d[es],!d||d.tag!==5&&d.tag!==6&&d.tag!==13&&d.tag!==3?null:d}function Uu(d){if(d.tag===5||d.tag===6)return d.stateNode;throw Error(r(33))}function ig(d){return d[kh]||null}var Ob=[],zu=-1;function el(d){return{current:d}}function xr(d){0>zu||(d.current=Ob[zu],Ob[zu]=null,zu--)}function hr(d,p){zu++,Ob[zu]=d.current,d.current=p}var tl={},Hn=el(tl),ji=el(!1),mc=tl;function Wu(d,p){var y=d.type.contextTypes;if(!y)return tl;var S=d.stateNode;if(S&&S.__reactInternalMemoizedUnmaskedChildContext===p)return S.__reactInternalMemoizedMaskedChildContext;var j={},O;for(O in y)j[O]=p[O];return S&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=p,d.__reactInternalMemoizedMaskedChildContext=j),j}function Ti(d){return d=d.childContextTypes,d!=null}function ag(){xr(ji),xr(Hn)}function F4(d,p,y){if(Hn.current!==tl)throw Error(r(168));hr(Hn,p),hr(ji,y)}function L4(d,p,y){var S=d.stateNode;if(p=p.childContextTypes,typeof S.getChildContext!=\"function\")return y;S=S.getChildContext();for(var j in S)if(!(j in p))throw Error(r(108,je(d)||\"Unknown\",j));return ne({},y,S)}function og(d){return d=(d=d.stateNode)&&d.__reactInternalMemoizedMergedChildContext||tl,mc=Hn.current,hr(Hn,d),hr(ji,ji.current),!0}function B4(d,p,y){var S=d.stateNode;if(!S)throw Error(r(169));y?(d=L4(d,p,mc),S.__reactInternalMemoizedMergedChildContext=d,xr(ji),xr(Hn),hr(Hn,d)):xr(ji),hr(ji,y)}var ts=null,sg=!1,kb=!1;function $4(d){ts===null?ts=[d]:ts.push(d)}function tte(d){sg=!0,$4(d)}function rl(){if(!kb&&ts!==null){kb=!0;var d=0,p=Qt;try{var y=ts;for(Qt=1;d<y.length;d++){var S=y[d];do S=S(!0);while(S!==null)}ts=null,sg=!1}catch(j){throw ts!==null&&(ts=ts.slice(d+1)),UP(eb,rl),j}finally{Qt=p,kb=!1}}return null}var qu=[],Hu=0,lg=null,cg=0,ca=[],ua=0,gc=null,rs=1,ns=\"\";function vc(d,p){qu[Hu++]=cg,qu[Hu++]=lg,lg=d,cg=p}function V4(d,p,y){ca[ua++]=rs,ca[ua++]=ns,ca[ua++]=gc,gc=d;var S=rs;d=ns;var j=32-Ra(S)-1;S&=~(1<<j),y+=1;var O=32-Ra(p)+j;if(30<O){var M=j-j%5;O=(S&(1<<M)-1).toString(32),S>>=M,j-=M,rs=1<<32-Ra(p)+j|y<<j|S,ns=O+d}else rs=1<<O|y<<j|S,ns=d}function Ib(d){d.return!==null&&(vc(d,1),V4(d,1,0))}function Mb(d){for(;d===lg;)lg=qu[--Hu],qu[Hu]=null,cg=qu[--Hu],qu[Hu]=null;for(;d===gc;)gc=ca[--ua],ca[ua]=null,ns=ca[--ua],ca[ua]=null,rs=ca[--ua],ca[ua]=null}var Wi=null,qi=null,Ar=!1,La=null;function U4(d,p){var y=pa(5,null,null,0);y.elementType=\"DELETED\",y.stateNode=p,y.return=d,p=d.deletions,p===null?(d.deletions=[y],d.flags|=16):p.push(y)}function z4(d,p){switch(d.tag){case 5:var y=d.type;return p=p.nodeType!==1||y.toLowerCase()!==p.nodeName.toLowerCase()?null:p,p!==null?(d.stateNode=p,Wi=d,qi=Js(p.firstChild),!0):!1;case 6:return p=d.pendingProps===\"\"||p.nodeType!==3?null:p,p!==null?(d.stateNode=p,Wi=d,qi=null,!0):!1;case 13:return p=p.nodeType!==8?null:p,p!==null?(y=gc!==null?{id:rs,overflow:ns}:null,d.memoizedState={dehydrated:p,treeContext:y,retryLane:1073741824},y=pa(18,null,null,0),y.stateNode=p,y.return=d,d.child=y,Wi=d,qi=null,!0):!1;default:return!1}}function Db(d){return(d.mode&1)!==0&&(d.flags&128)===0}function Rb(d){if(Ar){var p=qi;if(p){var y=p;if(!z4(d,p)){if(Db(d))throw Error(r(418));p=Js(y.nextSibling);var S=Wi;p&&z4(d,p)?U4(S,y):(d.flags=d.flags&-4097|2,Ar=!1,Wi=d)}}else{if(Db(d))throw Error(r(418));d.flags=d.flags&-4097|2,Ar=!1,Wi=d}}}function W4(d){for(d=d.return;d!==null&&d.tag!==5&&d.tag!==3&&d.tag!==13;)d=d.return;Wi=d}function ug(d){if(d!==Wi)return!1;if(!Ar)return W4(d),Ar=!0,!1;var p;if((p=d.tag!==3)&&!(p=d.tag!==5)&&(p=d.type,p=p!==\"head\"&&p!==\"body\"&&!Eb(d.type,d.memoizedProps)),p&&(p=qi)){if(Db(d))throw q4(),Error(r(418));for(;p;)U4(d,p),p=Js(p.nextSibling)}if(W4(d),d.tag===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(r(317));e:{for(d=d.nextSibling,p=0;d;){if(d.nodeType===8){var y=d.data;if(y===\"/$\"){if(p===0){qi=Js(d.nextSibling);break e}p--}else y!==\"$\"&&y!==\"$!\"&&y!==\"$?\"||p++}d=d.nextSibling}qi=null}}else qi=Wi?Js(d.stateNode.nextSibling):null;return!0}function q4(){for(var d=qi;d;)d=Js(d.nextSibling)}function Gu(){qi=Wi=null,Ar=!1}function Fb(d){La===null?La=[d]:La.push(d)}var rte=N.ReactCurrentBatchConfig;function Mh(d,p,y){if(d=y.ref,d!==null&&typeof d!=\"function\"&&typeof d!=\"object\"){if(y._owner){if(y=y._owner,y){if(y.tag!==1)throw Error(r(309));var S=y.stateNode}if(!S)throw Error(r(147,d));var j=S,O=\"\"+d;return p!==null&&p.ref!==null&&typeof p.ref==\"function\"&&p.ref._stringRef===O?p.ref:(p=function(M){var H=j.refs;M===null?delete H[O]:H[O]=M},p._stringRef=O,p)}if(typeof d!=\"string\")throw Error(r(284));if(!y._owner)throw Error(r(290,d))}return d}function dg(d,p){throw d=Object.prototype.toString.call(p),Error(r(31,d===\"[object Object]\"?\"object with keys {\"+Object.keys(p).join(\", \")+\"}\":d))}function H4(d){var p=d._init;return p(d._payload)}function G4(d){function p(ie,ee){if(d){var oe=ie.deletions;oe===null?(ie.deletions=[ee],ie.flags|=16):oe.push(ee)}}function y(ie,ee){if(!d)return null;for(;ee!==null;)p(ie,ee),ee=ee.sibling;return null}function S(ie,ee){for(ie=new Map;ee!==null;)ee.key!==null?ie.set(ee.key,ee):ie.set(ee.index,ee),ee=ee.sibling;return ie}function j(ie,ee){return ie=ul(ie,ee),ie.index=0,ie.sibling=null,ie}function O(ie,ee,oe){return ie.index=oe,d?(oe=ie.alternate,oe!==null?(oe=oe.index,oe<ee?(ie.flags|=2,ee):oe):(ie.flags|=2,ee)):(ie.flags|=1048576,ee)}function M(ie){return d&&ie.alternate===null&&(ie.flags|=2),ie}function H(ie,ee,oe,Te){return ee===null||ee.tag!==6?(ee=jw(oe,ie.mode,Te),ee.return=ie,ee):(ee=j(ee,oe),ee.return=ie,ee)}function J(ie,ee,oe,Te){var Je=oe.type;return Je===P?be(ie,ee,oe.props.children,Te,oe.key):ee!==null&&(ee.elementType===Je||typeof Je==\"object\"&&Je!==null&&Je.$$typeof===V&&H4(Je)===ee.type)?(Te=j(ee,oe.props),Te.ref=Mh(ie,ee,oe),Te.return=ie,Te):(Te=Dg(oe.type,oe.key,oe.props,null,ie.mode,Te),Te.ref=Mh(ie,ee,oe),Te.return=ie,Te)}function se(ie,ee,oe,Te){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==oe.containerInfo||ee.stateNode.implementation!==oe.implementation?(ee=Tw(oe,ie.mode,Te),ee.return=ie,ee):(ee=j(ee,oe.children||[]),ee.return=ie,ee)}function be(ie,ee,oe,Te,Je){return ee===null||ee.tag!==7?(ee=Ac(oe,ie.mode,Te,Je),ee.return=ie,ee):(ee=j(ee,oe),ee.return=ie,ee)}function Se(ie,ee,oe){if(typeof ee==\"string\"&&ee!==\"\"||typeof ee==\"number\")return ee=jw(\"\"+ee,ie.mode,oe),ee.return=ie,ee;if(typeof ee==\"object\"&&ee!==null){switch(ee.$$typeof){case A:return oe=Dg(ee.type,ee.key,ee.props,null,ie.mode,oe),oe.ref=Mh(ie,null,ee),oe.return=ie,oe;case T:return ee=Tw(ee,ie.mode,oe),ee.return=ie,ee;case V:var Te=ee._init;return Se(ie,Te(ee._payload),oe)}if(X(ee)||re(ee))return ee=Ac(ee,ie.mode,oe,null),ee.return=ie,ee;dg(ie,ee)}return null}function xe(ie,ee,oe,Te){var Je=ee!==null?ee.key:null;if(typeof oe==\"string\"&&oe!==\"\"||typeof oe==\"number\")return Je!==null?null:H(ie,ee,\"\"+oe,Te);if(typeof oe==\"object\"&&oe!==null){switch(oe.$$typeof){case A:return oe.key===Je?J(ie,ee,oe,Te):null;case T:return oe.key===Je?se(ie,ee,oe,Te):null;case V:return Je=oe._init,xe(ie,ee,Je(oe._payload),Te)}if(X(oe)||re(oe))return Je!==null?null:be(ie,ee,oe,Te,null);dg(ie,oe)}return null}function Ue(ie,ee,oe,Te,Je){if(typeof Te==\"string\"&&Te!==\"\"||typeof Te==\"number\")return ie=ie.get(oe)||null,H(ee,ie,\"\"+Te,Je);if(typeof Te==\"object\"&&Te!==null){switch(Te.$$typeof){case A:return ie=ie.get(Te.key===null?oe:Te.key)||null,J(ee,ie,Te,Je);case T:return ie=ie.get(Te.key===null?oe:Te.key)||null,se(ee,ie,Te,Je);case V:var ot=Te._init;return Ue(ie,ee,oe,ot(Te._payload),Je)}if(X(Te)||re(Te))return ie=ie.get(oe)||null,be(ee,ie,Te,Je,null);dg(ee,Te)}return null}function Ke(ie,ee,oe,Te){for(var Je=null,ot=null,st=ee,mt=ee=0,An=null;st!==null&&mt<oe.length;mt++){st.index>mt?(An=st,st=null):An=st.sibling;var Vt=xe(ie,st,oe[mt],Te);if(Vt===null){st===null&&(st=An);break}d&&st&&Vt.alternate===null&&p(ie,st),ee=O(Vt,ee,mt),ot===null?Je=Vt:ot.sibling=Vt,ot=Vt,st=An}if(mt===oe.length)return y(ie,st),Ar&&vc(ie,mt),Je;if(st===null){for(;mt<oe.length;mt++)st=Se(ie,oe[mt],Te),st!==null&&(ee=O(st,ee,mt),ot===null?Je=st:ot.sibling=st,ot=st);return Ar&&vc(ie,mt),Je}for(st=S(ie,st);mt<oe.length;mt++)An=Ue(st,ie,mt,oe[mt],Te),An!==null&&(d&&An.alternate!==null&&st.delete(An.key===null?mt:An.key),ee=O(An,ee,mt),ot===null?Je=An:ot.sibling=An,ot=An);return d&&st.forEach(function(dl){return p(ie,dl)}),Ar&&vc(ie,mt),Je}function Ze(ie,ee,oe,Te){var Je=re(oe);if(typeof Je!=\"function\")throw Error(r(150));if(oe=Je.call(oe),oe==null)throw Error(r(151));for(var ot=Je=null,st=ee,mt=ee=0,An=null,Vt=oe.next();st!==null&&!Vt.done;mt++,Vt=oe.next()){st.index>mt?(An=st,st=null):An=st.sibling;var dl=xe(ie,st,Vt.value,Te);if(dl===null){st===null&&(st=An);break}d&&st&&dl.alternate===null&&p(ie,st),ee=O(dl,ee,mt),ot===null?Je=dl:ot.sibling=dl,ot=dl,st=An}if(Vt.done)return y(ie,st),Ar&&vc(ie,mt),Je;if(st===null){for(;!Vt.done;mt++,Vt=oe.next())Vt=Se(ie,Vt.value,Te),Vt!==null&&(ee=O(Vt,ee,mt),ot===null?Je=Vt:ot.sibling=Vt,ot=Vt);return Ar&&vc(ie,mt),Je}for(st=S(ie,st);!Vt.done;mt++,Vt=oe.next())Vt=Ue(st,ie,mt,Vt.value,Te),Vt!==null&&(d&&Vt.alternate!==null&&st.delete(Vt.key===null?mt:Vt.key),ee=O(Vt,ee,mt),ot===null?Je=Vt:ot.sibling=Vt,ot=Vt);return d&&st.forEach(function(Dte){return p(ie,Dte)}),Ar&&vc(ie,mt),Je}function Hr(ie,ee,oe,Te){if(typeof oe==\"object\"&&oe!==null&&oe.type===P&&oe.key===null&&(oe=oe.props.children),typeof oe==\"object\"&&oe!==null){switch(oe.$$typeof){case A:e:{for(var Je=oe.key,ot=ee;ot!==null;){if(ot.key===Je){if(Je=oe.type,Je===P){if(ot.tag===7){y(ie,ot.sibling),ee=j(ot,oe.props.children),ee.return=ie,ie=ee;break e}}else if(ot.elementType===Je||typeof Je==\"object\"&&Je!==null&&Je.$$typeof===V&&H4(Je)===ot.type){y(ie,ot.sibling),ee=j(ot,oe.props),ee.ref=Mh(ie,ot,oe),ee.return=ie,ie=ee;break e}y(ie,ot);break}else p(ie,ot);ot=ot.sibling}oe.type===P?(ee=Ac(oe.props.children,ie.mode,Te,oe.key),ee.return=ie,ie=ee):(Te=Dg(oe.type,oe.key,oe.props,null,ie.mode,Te),Te.ref=Mh(ie,ee,oe),Te.return=ie,ie=Te)}return M(ie);case T:e:{for(ot=oe.key;ee!==null;){if(ee.key===ot)if(ee.tag===4&&ee.stateNode.containerInfo===oe.containerInfo&&ee.stateNode.implementation===oe.implementation){y(ie,ee.sibling),ee=j(ee,oe.children||[]),ee.return=ie,ie=ee;break e}else{y(ie,ee);break}else p(ie,ee);ee=ee.sibling}ee=Tw(oe,ie.mode,Te),ee.return=ie,ie=ee}return M(ie);case V:return ot=oe._init,Hr(ie,ee,ot(oe._payload),Te)}if(X(oe))return Ke(ie,ee,oe,Te);if(re(oe))return Ze(ie,ee,oe,Te);dg(ie,oe)}return typeof oe==\"string\"&&oe!==\"\"||typeof oe==\"number\"?(oe=\"\"+oe,ee!==null&&ee.tag===6?(y(ie,ee.sibling),ee=j(ee,oe),ee.return=ie,ie=ee):(y(ie,ee),ee=jw(oe,ie.mode,Te),ee.return=ie,ie=ee),M(ie)):y(ie,ee)}return Hr}var Ku=G4(!0),K4=G4(!1),fg=el(null),hg=null,Xu=null,Lb=null;function Bb(){Lb=Xu=hg=null}function $b(d){var p=fg.current;xr(fg),d._currentValue=p}function Vb(d,p,y){for(;d!==null;){var S=d.alternate;if((d.childLanes&p)!==p?(d.childLanes|=p,S!==null&&(S.childLanes|=p)):S!==null&&(S.childLanes&p)!==p&&(S.childLanes|=p),d===y)break;d=d.return}}function Yu(d,p){hg=d,Lb=Xu=null,d=d.dependencies,d!==null&&d.firstContext!==null&&((d.lanes&p)!==0&&(Pi=!0),d.firstContext=null)}function da(d){var p=d._currentValue;if(Lb!==d)if(d={context:d,memoizedValue:p,next:null},Xu===null){if(hg===null)throw Error(r(308));Xu=d,hg.dependencies={lanes:0,firstContext:d}}else Xu=Xu.next=d;return p}var yc=null;function Ub(d){yc===null?yc=[d]:yc.push(d)}function X4(d,p,y,S){var j=p.interleaved;return j===null?(y.next=y,Ub(p)):(y.next=j.next,j.next=y),p.interleaved=y,is(d,S)}function is(d,p){d.lanes|=p;var y=d.alternate;for(y!==null&&(y.lanes|=p),y=d,d=d.return;d!==null;)d.childLanes|=p,y=d.alternate,y!==null&&(y.childLanes|=p),y=d,d=d.return;return y.tag===3?y.stateNode:null}var nl=!1;function zb(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Y4(d,p){d=d.updateQueue,p.updateQueue===d&&(p.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,effects:d.effects})}function as(d,p){return{eventTime:d,lane:p,tag:0,payload:null,callback:null,next:null}}function il(d,p,y){var S=d.updateQueue;if(S===null)return null;if(S=S.shared,(Lt&2)!==0){var j=S.pending;return j===null?p.next=p:(p.next=j.next,j.next=p),S.pending=p,is(d,y)}return j=S.interleaved,j===null?(p.next=p,Ub(S)):(p.next=j.next,j.next=p),S.interleaved=p,is(d,y)}function pg(d,p,y){if(p=p.updateQueue,p!==null&&(p=p.shared,(y&4194240)!==0)){var S=p.lanes;S&=d.pendingLanes,y|=S,p.lanes=y,nb(d,y)}}function Z4(d,p){var y=d.updateQueue,S=d.alternate;if(S!==null&&(S=S.updateQueue,y===S)){var j=null,O=null;if(y=y.firstBaseUpdate,y!==null){do{var M={eventTime:y.eventTime,lane:y.lane,tag:y.tag,payload:y.payload,callback:y.callback,next:null};O===null?j=O=M:O=O.next=M,y=y.next}while(y!==null);O===null?j=O=p:O=O.next=p}else j=O=p;y={baseState:S.baseState,firstBaseUpdate:j,lastBaseUpdate:O,shared:S.shared,effects:S.effects},d.updateQueue=y;return}d=y.lastBaseUpdate,d===null?y.firstBaseUpdate=p:d.next=p,y.lastBaseUpdate=p}function mg(d,p,y,S){var j=d.updateQueue;nl=!1;var O=j.firstBaseUpdate,M=j.lastBaseUpdate,H=j.shared.pending;if(H!==null){j.shared.pending=null;var J=H,se=J.next;J.next=null,M===null?O=se:M.next=se,M=J;var be=d.alternate;be!==null&&(be=be.updateQueue,H=be.lastBaseUpdate,H!==M&&(H===null?be.firstBaseUpdate=se:H.next=se,be.lastBaseUpdate=J))}if(O!==null){var Se=j.baseState;M=0,be=se=J=null,H=O;do{var xe=H.lane,Ue=H.eventTime;if((S&xe)===xe){be!==null&&(be=be.next={eventTime:Ue,lane:0,tag:H.tag,payload:H.payload,callback:H.callback,next:null});e:{var Ke=d,Ze=H;switch(xe=p,Ue=y,Ze.tag){case 1:if(Ke=Ze.payload,typeof Ke==\"function\"){Se=Ke.call(Ue,Se,xe);break e}Se=Ke;break e;case 3:Ke.flags=Ke.flags&-65537|128;case 0:if(Ke=Ze.payload,xe=typeof Ke==\"function\"?Ke.call(Ue,Se,xe):Ke,xe==null)break e;Se=ne({},Se,xe);break e;case 2:nl=!0}}H.callback!==null&&H.lane!==0&&(d.flags|=64,xe=j.effects,xe===null?j.effects=[H]:xe.push(H))}else Ue={eventTime:Ue,lane:xe,tag:H.tag,payload:H.payload,callback:H.callback,next:null},be===null?(se=be=Ue,J=Se):be=be.next=Ue,M|=xe;if(H=H.next,H===null){if(H=j.shared.pending,H===null)break;xe=H,H=xe.next,xe.next=null,j.lastBaseUpdate=xe,j.shared.pending=null}}while(!0);if(be===null&&(J=Se),j.baseState=J,j.firstBaseUpdate=se,j.lastBaseUpdate=be,p=j.shared.interleaved,p!==null){j=p;do M|=j.lane,j=j.next;while(j!==p)}else O===null&&(j.shared.lanes=0);wc|=M,d.lanes=M,d.memoizedState=Se}}function Q4(d,p,y){if(d=p.effects,p.effects=null,d!==null)for(p=0;p<d.length;p++){var S=d[p],j=S.callback;if(j!==null){if(S.callback=null,S=y,typeof j!=\"function\")throw Error(r(191,j));j.call(S)}}}var Dh={},wo=el(Dh),Rh=el(Dh),Fh=el(Dh);function xc(d){if(d===Dh)throw Error(r(174));return d}function Wb(d,p){switch(hr(Fh,p),hr(Rh,d),hr(wo,Dh),d=p.nodeType,d){case 9:case 11:p=(p=p.documentElement)?p.namespaceURI:gt(null,\"\");break;default:d=d===8?p.parentNode:p,p=d.namespaceURI||null,d=d.tagName,p=gt(p,d)}xr(wo),hr(wo,p)}function Zu(){xr(wo),xr(Rh),xr(Fh)}function J4(d){xc(Fh.current);var p=xc(wo.current),y=gt(p,d.type);p!==y&&(hr(Rh,d),hr(wo,y))}function qb(d){Rh.current===d&&(xr(wo),xr(Rh))}var Pr=el(0);function gg(d){for(var p=d;p!==null;){if(p.tag===13){var y=p.memoizedState;if(y!==null&&(y=y.dehydrated,y===null||y.data===\"$?\"||y.data===\"$!\"))return p}else if(p.tag===19&&p.memoizedProps.revealOrder!==void 0){if((p.flags&128)!==0)return p}else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return null;p=p.return}p.sibling.return=p.return,p=p.sibling}return null}var Hb=[];function Gb(){for(var d=0;d<Hb.length;d++)Hb[d]._workInProgressVersionPrimary=null;Hb.length=0}var vg=N.ReactCurrentDispatcher,Kb=N.ReactCurrentBatchConfig,bc=0,Or=null,cn=null,_n=null,yg=!1,Lh=!1,Bh=0,nte=0;function Gn(){throw Error(r(321))}function Xb(d,p){if(p===null)return!1;for(var y=0;y<p.length&&y<d.length;y++)if(!Fa(d[y],p[y]))return!1;return!0}function Yb(d,p,y,S,j,O){if(bc=O,Or=p,p.memoizedState=null,p.updateQueue=null,p.lanes=0,vg.current=d===null||d.memoizedState===null?ste:lte,d=y(S,j),Lh){O=0;do{if(Lh=!1,Bh=0,25<=O)throw Error(r(301));O+=1,_n=cn=null,p.updateQueue=null,vg.current=cte,d=y(S,j)}while(Lh)}if(vg.current=wg,p=cn!==null&&cn.next!==null,bc=0,_n=cn=Or=null,yg=!1,p)throw Error(r(300));return d}function Zb(){var d=Bh!==0;return Bh=0,d}function So(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _n===null?Or.memoizedState=_n=d:_n=_n.next=d,_n}function fa(){if(cn===null){var d=Or.alternate;d=d!==null?d.memoizedState:null}else d=cn.next;var p=_n===null?Or.memoizedState:_n.next;if(p!==null)_n=p,cn=d;else{if(d===null)throw Error(r(310));cn=d,d={memoizedState:cn.memoizedState,baseState:cn.baseState,baseQueue:cn.baseQueue,queue:cn.queue,next:null},_n===null?Or.memoizedState=_n=d:_n=_n.next=d}return _n}function $h(d,p){return typeof p==\"function\"?p(d):p}function Qb(d){var p=fa(),y=p.queue;if(y===null)throw Error(r(311));y.lastRenderedReducer=d;var S=cn,j=S.baseQueue,O=y.pending;if(O!==null){if(j!==null){var M=j.next;j.next=O.next,O.next=M}S.baseQueue=j=O,y.pending=null}if(j!==null){O=j.next,S=S.baseState;var H=M=null,J=null,se=O;do{var be=se.lane;if((bc&be)===be)J!==null&&(J=J.next={lane:0,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null}),S=se.hasEagerState?se.eagerState:d(S,se.action);else{var Se={lane:be,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null};J===null?(H=J=Se,M=S):J=J.next=Se,Or.lanes|=be,wc|=be}se=se.next}while(se!==null&&se!==O);J===null?M=S:J.next=H,Fa(S,p.memoizedState)||(Pi=!0),p.memoizedState=S,p.baseState=M,p.baseQueue=J,y.lastRenderedState=S}if(d=y.interleaved,d!==null){j=d;do O=j.lane,Or.lanes|=O,wc|=O,j=j.next;while(j!==d)}else j===null&&(y.lanes=0);return[p.memoizedState,y.dispatch]}function Jb(d){var p=fa(),y=p.queue;if(y===null)throw Error(r(311));y.lastRenderedReducer=d;var S=y.dispatch,j=y.pending,O=p.memoizedState;if(j!==null){y.pending=null;var M=j=j.next;do O=d(O,M.action),M=M.next;while(M!==j);Fa(O,p.memoizedState)||(Pi=!0),p.memoizedState=O,p.baseQueue===null&&(p.baseState=O),y.lastRenderedState=O}return[O,S]}function eO(){}function tO(d,p){var y=Or,S=fa(),j=p(),O=!Fa(S.memoizedState,j);if(O&&(S.memoizedState=j,Pi=!0),S=S.queue,ew(iO.bind(null,y,S,d),[d]),S.getSnapshot!==p||O||_n!==null&&_n.memoizedState.tag&1){if(y.flags|=2048,Vh(9,nO.bind(null,y,S,j,p),void 0,null),Cn===null)throw Error(r(349));(bc&30)!==0||rO(y,p,j)}return j}function rO(d,p,y){d.flags|=16384,d={getSnapshot:p,value:y},p=Or.updateQueue,p===null?(p={lastEffect:null,stores:null},Or.updateQueue=p,p.stores=[d]):(y=p.stores,y===null?p.stores=[d]:y.push(d))}function nO(d,p,y,S){p.value=y,p.getSnapshot=S,aO(p)&&oO(d)}function iO(d,p,y){return y(function(){aO(p)&&oO(d)})}function aO(d){var p=d.getSnapshot;d=d.value;try{var y=p();return!Fa(d,y)}catch{return!0}}function oO(d){var p=is(d,1);p!==null&&Ua(p,d,1,-1)}function sO(d){var p=So();return typeof d==\"function\"&&(d=d()),p.memoizedState=p.baseState=d,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$h,lastRenderedState:d},p.queue=d,d=d.dispatch=ote.bind(null,Or,d),[p.memoizedState,d]}function Vh(d,p,y,S){return d={tag:d,create:p,destroy:y,deps:S,next:null},p=Or.updateQueue,p===null?(p={lastEffect:null,stores:null},Or.updateQueue=p,p.lastEffect=d.next=d):(y=p.lastEffect,y===null?p.lastEffect=d.next=d:(S=y.next,y.next=d,d.next=S,p.lastEffect=d)),d}function lO(){return fa().memoizedState}function xg(d,p,y,S){var j=So();Or.flags|=d,j.memoizedState=Vh(1|p,y,void 0,S===void 0?null:S)}function bg(d,p,y,S){var j=fa();S=S===void 0?null:S;var O=void 0;if(cn!==null){var M=cn.memoizedState;if(O=M.destroy,S!==null&&Xb(S,M.deps)){j.memoizedState=Vh(p,y,O,S);return}}Or.flags|=d,j.memoizedState=Vh(1|p,y,O,S)}function cO(d,p){return xg(8390656,8,d,p)}function ew(d,p){return bg(2048,8,d,p)}function uO(d,p){return bg(4,2,d,p)}function dO(d,p){return bg(4,4,d,p)}function fO(d,p){if(typeof p==\"function\")return d=d(),p(d),function(){p(null)};if(p!=null)return d=d(),p.current=d,function(){p.current=null}}function hO(d,p,y){return y=y!=null?y.concat([d]):null,bg(4,4,fO.bind(null,p,d),y)}function tw(){}function pO(d,p){var y=fa();p=p===void 0?null:p;var S=y.memoizedState;return S!==null&&p!==null&&Xb(p,S[1])?S[0]:(y.memoizedState=[d,p],d)}function mO(d,p){var y=fa();p=p===void 0?null:p;var S=y.memoizedState;return S!==null&&p!==null&&Xb(p,S[1])?S[0]:(d=d(),y.memoizedState=[d,p],d)}function gO(d,p,y){return(bc&21)===0?(d.baseState&&(d.baseState=!1,Pi=!0),d.memoizedState=y):(Fa(y,p)||(y=HP(),Or.lanes|=y,wc|=y,d.baseState=!0),p)}function ite(d,p){var y=Qt;Qt=y!==0&&4>y?y:4,d(!0);var S=Kb.transition;Kb.transition={};try{d(!1),p()}finally{Qt=y,Kb.transition=S}}function vO(){return fa().memoizedState}function ate(d,p,y){var S=ll(d);if(y={lane:S,action:y,hasEagerState:!1,eagerState:null,next:null},yO(d))xO(p,y);else if(y=X4(d,p,y,S),y!==null){var j=ai();Ua(y,d,S,j),bO(y,p,S)}}function ote(d,p,y){var S=ll(d),j={lane:S,action:y,hasEagerState:!1,eagerState:null,next:null};if(yO(d))xO(p,j);else{var O=d.alternate;if(d.lanes===0&&(O===null||O.lanes===0)&&(O=p.lastRenderedReducer,O!==null))try{var M=p.lastRenderedState,H=O(M,y);if(j.hasEagerState=!0,j.eagerState=H,Fa(H,M)){var J=p.interleaved;J===null?(j.next=j,Ub(p)):(j.next=J.next,J.next=j),p.interleaved=j;return}}catch{}finally{}y=X4(d,p,j,S),y!==null&&(j=ai(),Ua(y,d,S,j),bO(y,p,S))}}function yO(d){var p=d.alternate;return d===Or||p!==null&&p===Or}function xO(d,p){Lh=yg=!0;var y=d.pending;y===null?p.next=p:(p.next=y.next,y.next=p),d.pending=p}function bO(d,p,y){if((y&4194240)!==0){var S=p.lanes;S&=d.pendingLanes,y|=S,p.lanes=y,nb(d,y)}}var wg={readContext:da,useCallback:Gn,useContext:Gn,useEffect:Gn,useImperativeHandle:Gn,useInsertionEffect:Gn,useLayoutEffect:Gn,useMemo:Gn,useReducer:Gn,useRef:Gn,useState:Gn,useDebugValue:Gn,useDeferredValue:Gn,useTransition:Gn,useMutableSource:Gn,useSyncExternalStore:Gn,useId:Gn,unstable_isNewReconciler:!1},ste={readContext:da,useCallback:function(d,p){return So().memoizedState=[d,p===void 0?null:p],d},useContext:da,useEffect:cO,useImperativeHandle:function(d,p,y){return y=y!=null?y.concat([d]):null,xg(4194308,4,fO.bind(null,p,d),y)},useLayoutEffect:function(d,p){return xg(4194308,4,d,p)},useInsertionEffect:function(d,p){return xg(4,2,d,p)},useMemo:function(d,p){var y=So();return p=p===void 0?null:p,d=d(),y.memoizedState=[d,p],d},useReducer:function(d,p,y){var S=So();return p=y!==void 0?y(p):p,S.memoizedState=S.baseState=p,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:p},S.queue=d,d=d.dispatch=ate.bind(null,Or,d),[S.memoizedState,d]},useRef:function(d){var p=So();return d={current:d},p.memoizedState=d},useState:sO,useDebugValue:tw,useDeferredValue:function(d){return So().memoizedState=d},useTransition:function(){var d=sO(!1),p=d[0];return d=ite.bind(null,d[1]),So().memoizedState=d,[p,d]},useMutableSource:function(){},useSyncExternalStore:function(d,p,y){var S=Or,j=So();if(Ar){if(y===void 0)throw Error(r(407));y=y()}else{if(y=p(),Cn===null)throw Error(r(349));(bc&30)!==0||rO(S,p,y)}j.memoizedState=y;var O={value:y,getSnapshot:p};return j.queue=O,cO(iO.bind(null,S,O,d),[d]),S.flags|=2048,Vh(9,nO.bind(null,S,O,y,p),void 0,null),y},useId:function(){var d=So(),p=Cn.identifierPrefix;if(Ar){var y=ns,S=rs;y=(S&~(1<<32-Ra(S)-1)).toString(32)+y,p=\":\"+p+\"R\"+y,y=Bh++,0<y&&(p+=\"H\"+y.toString(32)),p+=\":\"}else y=nte++,p=\":\"+p+\"r\"+y.toString(32)+\":\";return d.memoizedState=p},unstable_isNewReconciler:!1},lte={readContext:da,useCallback:pO,useContext:da,useEffect:ew,useImperativeHandle:hO,useInsertionEffect:uO,useLayoutEffect:dO,useMemo:mO,useReducer:Qb,useRef:lO,useState:function(){return Qb($h)},useDebugValue:tw,useDeferredValue:function(d){var p=fa();return gO(p,cn.memoizedState,d)},useTransition:function(){var d=Qb($h)[0],p=fa().memoizedState;return[d,p]},useMutableSource:eO,useSyncExternalStore:tO,useId:vO,unstable_isNewReconciler:!1},cte={readContext:da,useCallback:pO,useContext:da,useEffect:ew,useImperativeHandle:hO,useInsertionEffect:uO,useLayoutEffect:dO,useMemo:mO,useReducer:Jb,useRef:lO,useState:function(){return Jb($h)},useDebugValue:tw,useDeferredValue:function(d){var p=fa();return cn===null?p.memoizedState=d:gO(p,cn.memoizedState,d)},useTransition:function(){var d=Jb($h)[0],p=fa().memoizedState;return[d,p]},useMutableSource:eO,useSyncExternalStore:tO,useId:vO,unstable_isNewReconciler:!1};function Ba(d,p){if(d&&d.defaultProps){p=ne({},p),d=d.defaultProps;for(var y in d)p[y]===void 0&&(p[y]=d[y]);return p}return p}function rw(d,p,y,S){p=d.memoizedState,y=y(S,p),y=y==null?p:ne({},p,y),d.memoizedState=y,d.lanes===0&&(d.updateQueue.baseState=y)}var Sg={isMounted:function(d){return(d=d._reactInternals)?hc(d)===d:!1},enqueueSetState:function(d,p,y){d=d._reactInternals;var S=ai(),j=ll(d),O=as(S,j);O.payload=p,y!=null&&(O.callback=y),p=il(d,O,j),p!==null&&(Ua(p,d,j,S),pg(p,d,j))},enqueueReplaceState:function(d,p,y){d=d._reactInternals;var S=ai(),j=ll(d),O=as(S,j);O.tag=1,O.payload=p,y!=null&&(O.callback=y),p=il(d,O,j),p!==null&&(Ua(p,d,j,S),pg(p,d,j))},enqueueForceUpdate:function(d,p){d=d._reactInternals;var y=ai(),S=ll(d),j=as(y,S);j.tag=2,p!=null&&(j.callback=p),p=il(d,j,S),p!==null&&(Ua(p,d,S,y),pg(p,d,S))}};function wO(d,p,y,S,j,O,M){return d=d.stateNode,typeof d.shouldComponentUpdate==\"function\"?d.shouldComponentUpdate(S,O,M):p.prototype&&p.prototype.isPureReactComponent?!Eh(y,S)||!Eh(j,O):!0}function SO(d,p,y){var S=!1,j=tl,O=p.contextType;return typeof O==\"object\"&&O!==null?O=da(O):(j=Ti(p)?mc:Hn.current,S=p.contextTypes,O=(S=S!=null)?Wu(d,j):tl),p=new p(y,O),d.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=Sg,d.stateNode=p,p._reactInternals=d,S&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=j,d.__reactInternalMemoizedMaskedChildContext=O),p}function _O(d,p,y,S){d=p.state,typeof p.componentWillReceiveProps==\"function\"&&p.componentWillReceiveProps(y,S),typeof p.UNSAFE_componentWillReceiveProps==\"function\"&&p.UNSAFE_componentWillReceiveProps(y,S),p.state!==d&&Sg.enqueueReplaceState(p,p.state,null)}function nw(d,p,y,S){var j=d.stateNode;j.props=y,j.state=d.memoizedState,j.refs={},zb(d);var O=p.contextType;typeof O==\"object\"&&O!==null?j.context=da(O):(O=Ti(p)?mc:Hn.current,j.context=Wu(d,O)),j.state=d.memoizedState,O=p.getDerivedStateFromProps,typeof O==\"function\"&&(rw(d,p,O,y),j.state=d.memoizedState),typeof p.getDerivedStateFromProps==\"function\"||typeof j.getSnapshotBeforeUpdate==\"function\"||typeof j.UNSAFE_componentWillMount!=\"function\"&&typeof j.componentWillMount!=\"function\"||(p=j.state,typeof j.componentWillMount==\"function\"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount==\"function\"&&j.UNSAFE_componentWillMount(),p!==j.state&&Sg.enqueueReplaceState(j,j.state,null),mg(d,y,j,S),j.state=d.memoizedState),typeof j.componentDidMount==\"function\"&&(d.flags|=4194308)}function Qu(d,p){try{var y=\"\",S=p;do y+=Fe(S),S=S.return;while(S);var j=y}catch(O){j=`\nError generating stack: `+O.message+`\n`+O.stack}return{value:d,source:p,stack:j,digest:null}}function iw(d,p,y){return{value:d,source:null,stack:y??null,digest:p??null}}function aw(d,p){try{console.error(p.value)}catch(y){setTimeout(function(){throw y})}}var ute=typeof WeakMap==\"function\"?WeakMap:Map;function CO(d,p,y){y=as(-1,y),y.tag=3,y.payload={element:null};var S=p.value;return y.callback=function(){Tg||(Tg=!0,bw=S),aw(d,p)},y}function AO(d,p,y){y=as(-1,y),y.tag=3;var S=d.type.getDerivedStateFromError;if(typeof S==\"function\"){var j=p.value;y.payload=function(){return S(j)},y.callback=function(){aw(d,p)}}var O=d.stateNode;return O!==null&&typeof O.componentDidCatch==\"function\"&&(y.callback=function(){aw(d,p),typeof S!=\"function\"&&(ol===null?ol=new Set([this]):ol.add(this));var M=p.stack;this.componentDidCatch(p.value,{componentStack:M!==null?M:\"\"})}),y}function NO(d,p,y){var S=d.pingCache;if(S===null){S=d.pingCache=new ute;var j=new Set;S.set(p,j)}else j=S.get(p),j===void 0&&(j=new Set,S.set(p,j));j.has(y)||(j.add(y),d=Cte.bind(null,d,p,y),p.then(d,d))}function EO(d){do{var p;if((p=d.tag===13)&&(p=d.memoizedState,p=p!==null?p.dehydrated!==null:!0),p)return d;d=d.return}while(d!==null);return null}function jO(d,p,y,S,j){return(d.mode&1)===0?(d===p?d.flags|=65536:(d.flags|=128,y.flags|=131072,y.flags&=-52805,y.tag===1&&(y.alternate===null?y.tag=17:(p=as(-1,1),p.tag=2,il(y,p,1))),y.lanes|=1),d):(d.flags|=65536,d.lanes=j,d)}var dte=N.ReactCurrentOwner,Pi=!1;function ii(d,p,y,S){p.child=d===null?K4(p,null,y,S):Ku(p,d.child,y,S)}function TO(d,p,y,S,j){y=y.render;var O=p.ref;return Yu(p,j),S=Yb(d,p,y,S,O,j),y=Zb(),d!==null&&!Pi?(p.updateQueue=d.updateQueue,p.flags&=-2053,d.lanes&=~j,os(d,p,j)):(Ar&&y&&Ib(p),p.flags|=1,ii(d,p,S,j),p.child)}function PO(d,p,y,S,j){if(d===null){var O=y.type;return typeof O==\"function\"&&!Ew(O)&&O.defaultProps===void 0&&y.compare===null&&y.defaultProps===void 0?(p.tag=15,p.type=O,OO(d,p,O,S,j)):(d=Dg(y.type,null,S,p,p.mode,j),d.ref=p.ref,d.return=p,p.child=d)}if(O=d.child,(d.lanes&j)===0){var M=O.memoizedProps;if(y=y.compare,y=y!==null?y:Eh,y(M,S)&&d.ref===p.ref)return os(d,p,j)}return p.flags|=1,d=ul(O,S),d.ref=p.ref,d.return=p,p.child=d}function OO(d,p,y,S,j){if(d!==null){var O=d.memoizedProps;if(Eh(O,S)&&d.ref===p.ref)if(Pi=!1,p.pendingProps=S=O,(d.lanes&j)!==0)(d.flags&131072)!==0&&(Pi=!0);else return p.lanes=d.lanes,os(d,p,j)}return ow(d,p,y,S,j)}function kO(d,p,y){var S=p.pendingProps,j=S.children,O=d!==null?d.memoizedState:null;if(S.mode===\"hidden\")if((p.mode&1)===0)p.memoizedState={baseLanes:0,cachePool:null,transitions:null},hr(ed,Hi),Hi|=y;else{if((y&1073741824)===0)return d=O!==null?O.baseLanes|y:y,p.lanes=p.childLanes=1073741824,p.memoizedState={baseLanes:d,cachePool:null,transitions:null},p.updateQueue=null,hr(ed,Hi),Hi|=d,null;p.memoizedState={baseLanes:0,cachePool:null,transitions:null},S=O!==null?O.baseLanes:y,hr(ed,Hi),Hi|=S}else O!==null?(S=O.baseLanes|y,p.memoizedState=null):S=y,hr(ed,Hi),Hi|=S;return ii(d,p,j,y),p.child}function IO(d,p){var y=p.ref;(d===null&&y!==null||d!==null&&d.ref!==y)&&(p.flags|=512,p.flags|=2097152)}function ow(d,p,y,S,j){var O=Ti(y)?mc:Hn.current;return O=Wu(p,O),Yu(p,j),y=Yb(d,p,y,S,O,j),S=Zb(),d!==null&&!Pi?(p.updateQueue=d.updateQueue,p.flags&=-2053,d.lanes&=~j,os(d,p,j)):(Ar&&S&&Ib(p),p.flags|=1,ii(d,p,y,j),p.child)}function MO(d,p,y,S,j){if(Ti(y)){var O=!0;og(p)}else O=!1;if(Yu(p,j),p.stateNode===null)Cg(d,p),SO(p,y,S),nw(p,y,S,j),S=!0;else if(d===null){var M=p.stateNode,H=p.memoizedProps;M.props=H;var J=M.context,se=y.contextType;typeof se==\"object\"&&se!==null?se=da(se):(se=Ti(y)?mc:Hn.current,se=Wu(p,se));var be=y.getDerivedStateFromProps,Se=typeof be==\"function\"||typeof M.getSnapshotBeforeUpdate==\"function\";Se||typeof M.UNSAFE_componentWillReceiveProps!=\"function\"&&typeof M.componentWillReceiveProps!=\"function\"||(H!==S||J!==se)&&_O(p,M,S,se),nl=!1;var xe=p.memoizedState;M.state=xe,mg(p,S,M,j),J=p.memoizedState,H!==S||xe!==J||ji.current||nl?(typeof be==\"function\"&&(rw(p,y,be,S),J=p.memoizedState),(H=nl||wO(p,y,H,S,xe,J,se))?(Se||typeof M.UNSAFE_componentWillMount!=\"function\"&&typeof M.componentWillMount!=\"function\"||(typeof M.componentWillMount==\"function\"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount==\"function\"&&M.UNSAFE_componentWillMount()),typeof M.componentDidMount==\"function\"&&(p.flags|=4194308)):(typeof M.componentDidMount==\"function\"&&(p.flags|=4194308),p.memoizedProps=S,p.memoizedState=J),M.props=S,M.state=J,M.context=se,S=H):(typeof M.componentDidMount==\"function\"&&(p.flags|=4194308),S=!1)}else{M=p.stateNode,Y4(d,p),H=p.memoizedProps,se=p.type===p.elementType?H:Ba(p.type,H),M.props=se,Se=p.pendingProps,xe=M.context,J=y.contextType,typeof J==\"object\"&&J!==null?J=da(J):(J=Ti(y)?mc:Hn.current,J=Wu(p,J));var Ue=y.getDerivedStateFromProps;(be=typeof Ue==\"function\"||typeof M.getSnapshotBeforeUpdate==\"function\")||typeof M.UNSAFE_componentWillReceiveProps!=\"function\"&&typeof M.componentWillReceiveProps!=\"function\"||(H!==Se||xe!==J)&&_O(p,M,S,J),nl=!1,xe=p.memoizedState,M.state=xe,mg(p,S,M,j);var Ke=p.memoizedState;H!==Se||xe!==Ke||ji.current||nl?(typeof Ue==\"function\"&&(rw(p,y,Ue,S),Ke=p.memoizedState),(se=nl||wO(p,y,se,S,xe,Ke,J)||!1)?(be||typeof M.UNSAFE_componentWillUpdate!=\"function\"&&typeof M.componentWillUpdate!=\"function\"||(typeof M.componentWillUpdate==\"function\"&&M.componentWillUpdate(S,Ke,J),typeof M.UNSAFE_componentWillUpdate==\"function\"&&M.UNSAFE_componentWillUpdate(S,Ke,J)),typeof M.componentDidUpdate==\"function\"&&(p.flags|=4),typeof M.getSnapshotBeforeUpdate==\"function\"&&(p.flags|=1024)):(typeof M.componentDidUpdate!=\"function\"||H===d.memoizedProps&&xe===d.memoizedState||(p.flags|=4),typeof M.getSnapshotBeforeUpdate!=\"function\"||H===d.memoizedProps&&xe===d.memoizedState||(p.flags|=1024),p.memoizedProps=S,p.memoizedState=Ke),M.props=S,M.state=Ke,M.context=J,S=se):(typeof M.componentDidUpdate!=\"function\"||H===d.memoizedProps&&xe===d.memoizedState||(p.flags|=4),typeof M.getSnapshotBeforeUpdate!=\"function\"||H===d.memoizedProps&&xe===d.memoizedState||(p.flags|=1024),S=!1)}return sw(d,p,y,S,O,j)}function sw(d,p,y,S,j,O){IO(d,p);var M=(p.flags&128)!==0;if(!S&&!M)return j&&B4(p,y,!1),os(d,p,O);S=p.stateNode,dte.current=p;var H=M&&typeof y.getDerivedStateFromError!=\"function\"?null:S.render();return p.flags|=1,d!==null&&M?(p.child=Ku(p,d.child,null,O),p.child=Ku(p,null,H,O)):ii(d,p,H,O),p.memoizedState=S.state,j&&B4(p,y,!0),p.child}function DO(d){var p=d.stateNode;p.pendingContext?F4(d,p.pendingContext,p.pendingContext!==p.context):p.context&&F4(d,p.context,!1),Wb(d,p.containerInfo)}function RO(d,p,y,S,j){return Gu(),Fb(j),p.flags|=256,ii(d,p,y,S),p.child}var lw={dehydrated:null,treeContext:null,retryLane:0};function cw(d){return{baseLanes:d,cachePool:null,transitions:null}}function FO(d,p,y){var S=p.pendingProps,j=Pr.current,O=!1,M=(p.flags&128)!==0,H;if((H=M)||(H=d!==null&&d.memoizedState===null?!1:(j&2)!==0),H?(O=!0,p.flags&=-129):(d===null||d.memoizedState!==null)&&(j|=1),hr(Pr,j&1),d===null)return Rb(p),d=p.memoizedState,d!==null&&(d=d.dehydrated,d!==null)?((p.mode&1)===0?p.lanes=1:d.data===\"$!\"?p.lanes=8:p.lanes=1073741824,null):(M=S.children,d=S.fallback,O?(S=p.mode,O=p.child,M={mode:\"hidden\",children:M},(S&1)===0&&O!==null?(O.childLanes=0,O.pendingProps=M):O=Rg(M,S,0,null),d=Ac(d,S,y,null),O.return=p,d.return=p,O.sibling=d,p.child=O,p.child.memoizedState=cw(y),p.memoizedState=lw,d):uw(p,M));if(j=d.memoizedState,j!==null&&(H=j.dehydrated,H!==null))return fte(d,p,M,S,H,j,y);if(O){O=S.fallback,M=p.mode,j=d.child,H=j.sibling;var J={mode:\"hidden\",children:S.children};return(M&1)===0&&p.child!==j?(S=p.child,S.childLanes=0,S.pendingProps=J,p.deletions=null):(S=ul(j,J),S.subtreeFlags=j.subtreeFlags&14680064),H!==null?O=ul(H,O):(O=Ac(O,M,y,null),O.flags|=2),O.return=p,S.return=p,S.sibling=O,p.child=S,S=O,O=p.child,M=d.child.memoizedState,M=M===null?cw(y):{baseLanes:M.baseLanes|y,cachePool:null,transitions:M.transitions},O.memoizedState=M,O.childLanes=d.childLanes&~y,p.memoizedState=lw,S}return O=d.child,d=O.sibling,S=ul(O,{mode:\"visible\",children:S.children}),(p.mode&1)===0&&(S.lanes=y),S.return=p,S.sibling=null,d!==null&&(y=p.deletions,y===null?(p.deletions=[d],p.flags|=16):y.push(d)),p.child=S,p.memoizedState=null,S}function uw(d,p){return p=Rg({mode:\"visible\",children:p},d.mode,0,null),p.return=d,d.child=p}function _g(d,p,y,S){return S!==null&&Fb(S),Ku(p,d.child,null,y),d=uw(p,p.pendingProps.children),d.flags|=2,p.memoizedState=null,d}function fte(d,p,y,S,j,O,M){if(y)return p.flags&256?(p.flags&=-257,S=iw(Error(r(422))),_g(d,p,M,S)):p.memoizedState!==null?(p.child=d.child,p.flags|=128,null):(O=S.fallback,j=p.mode,S=Rg({mode:\"visible\",children:S.children},j,0,null),O=Ac(O,j,M,null),O.flags|=2,S.return=p,O.return=p,S.sibling=O,p.child=S,(p.mode&1)!==0&&Ku(p,d.child,null,M),p.child.memoizedState=cw(M),p.memoizedState=lw,O);if((p.mode&1)===0)return _g(d,p,M,null);if(j.data===\"$!\"){if(S=j.nextSibling&&j.nextSibling.dataset,S)var H=S.dgst;return S=H,O=Error(r(419)),S=iw(O,S,void 0),_g(d,p,M,S)}if(H=(M&d.childLanes)!==0,Pi||H){if(S=Cn,S!==null){switch(M&-M){case 4:j=2;break;case 16:j=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:j=32;break;case 536870912:j=268435456;break;default:j=0}j=(j&(S.suspendedLanes|M))!==0?0:j,j!==0&&j!==O.retryLane&&(O.retryLane=j,is(d,j),Ua(S,d,j,-1))}return Nw(),S=iw(Error(r(421))),_g(d,p,M,S)}return j.data===\"$?\"?(p.flags|=128,p.child=d.child,p=Ate.bind(null,d),j._reactRetry=p,null):(d=O.treeContext,qi=Js(j.nextSibling),Wi=p,Ar=!0,La=null,d!==null&&(ca[ua++]=rs,ca[ua++]=ns,ca[ua++]=gc,rs=d.id,ns=d.overflow,gc=p),p=uw(p,S.children),p.flags|=4096,p)}function LO(d,p,y){d.lanes|=p;var S=d.alternate;S!==null&&(S.lanes|=p),Vb(d.return,p,y)}function dw(d,p,y,S,j){var O=d.memoizedState;O===null?d.memoizedState={isBackwards:p,rendering:null,renderingStartTime:0,last:S,tail:y,tailMode:j}:(O.isBackwards=p,O.rendering=null,O.renderingStartTime=0,O.last=S,O.tail=y,O.tailMode=j)}function BO(d,p,y){var S=p.pendingProps,j=S.revealOrder,O=S.tail;if(ii(d,p,S.children,y),S=Pr.current,(S&2)!==0)S=S&1|2,p.flags|=128;else{if(d!==null&&(d.flags&128)!==0)e:for(d=p.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&LO(d,y,p);else if(d.tag===19)LO(d,y,p);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===p)break e;for(;d.sibling===null;){if(d.return===null||d.return===p)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}S&=1}if(hr(Pr,S),(p.mode&1)===0)p.memoizedState=null;else switch(j){case\"forwards\":for(y=p.child,j=null;y!==null;)d=y.alternate,d!==null&&gg(d)===null&&(j=y),y=y.sibling;y=j,y===null?(j=p.child,p.child=null):(j=y.sibling,y.sibling=null),dw(p,!1,j,y,O);break;case\"backwards\":for(y=null,j=p.child,p.child=null;j!==null;){if(d=j.alternate,d!==null&&gg(d)===null){p.child=j;break}d=j.sibling,j.sibling=y,y=j,j=d}dw(p,!0,y,null,O);break;case\"together\":dw(p,!1,null,null,void 0);break;default:p.memoizedState=null}return p.child}function Cg(d,p){(p.mode&1)===0&&d!==null&&(d.alternate=null,p.alternate=null,p.flags|=2)}function os(d,p,y){if(d!==null&&(p.dependencies=d.dependencies),wc|=p.lanes,(y&p.childLanes)===0)return null;if(d!==null&&p.child!==d.child)throw Error(r(153));if(p.child!==null){for(d=p.child,y=ul(d,d.pendingProps),p.child=y,y.return=p;d.sibling!==null;)d=d.sibling,y=y.sibling=ul(d,d.pendingProps),y.return=p;y.sibling=null}return p.child}function hte(d,p,y){switch(p.tag){case 3:DO(p),Gu();break;case 5:J4(p);break;case 1:Ti(p.type)&&og(p);break;case 4:Wb(p,p.stateNode.containerInfo);break;case 10:var S=p.type._context,j=p.memoizedProps.value;hr(fg,S._currentValue),S._currentValue=j;break;case 13:if(S=p.memoizedState,S!==null)return S.dehydrated!==null?(hr(Pr,Pr.current&1),p.flags|=128,null):(y&p.child.childLanes)!==0?FO(d,p,y):(hr(Pr,Pr.current&1),d=os(d,p,y),d!==null?d.sibling:null);hr(Pr,Pr.current&1);break;case 19:if(S=(y&p.childLanes)!==0,(d.flags&128)!==0){if(S)return BO(d,p,y);p.flags|=128}if(j=p.memoizedState,j!==null&&(j.rendering=null,j.tail=null,j.lastEffect=null),hr(Pr,Pr.current),S)break;return null;case 22:case 23:return p.lanes=0,kO(d,p,y)}return os(d,p,y)}var $O,fw,VO,UO;$O=function(d,p){for(var y=p.child;y!==null;){if(y.tag===5||y.tag===6)d.appendChild(y.stateNode);else if(y.tag!==4&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===p)break;for(;y.sibling===null;){if(y.return===null||y.return===p)return;y=y.return}y.sibling.return=y.return,y=y.sibling}},fw=function(){},VO=function(d,p,y,S){var j=d.memoizedProps;if(j!==S){d=p.stateNode,xc(wo.current);var O=null;switch(y){case\"input\":j=le(d,j),S=le(d,S),O=[];break;case\"select\":j=ne({},j,{value:void 0}),S=ne({},S,{value:void 0}),O=[];break;case\"textarea\":j=Q(d,j),S=Q(d,S),O=[];break;default:typeof j.onClick!=\"function\"&&typeof S.onClick==\"function\"&&(d.onclick=ng)}ve(y,S);var M;y=null;for(se in j)if(!S.hasOwnProperty(se)&&j.hasOwnProperty(se)&&j[se]!=null)if(se===\"style\"){var H=j[se];for(M in H)H.hasOwnProperty(M)&&(y||(y={}),y[M]=\"\")}else se!==\"dangerouslySetInnerHTML\"&&se!==\"children\"&&se!==\"suppressContentEditableWarning\"&&se!==\"suppressHydrationWarning\"&&se!==\"autoFocus\"&&(i.hasOwnProperty(se)?O||(O=[]):(O=O||[]).push(se,null));for(se in S){var J=S[se];if(H=j!=null?j[se]:void 0,S.hasOwnProperty(se)&&J!==H&&(J!=null||H!=null))if(se===\"style\")if(H){for(M in H)!H.hasOwnProperty(M)||J&&J.hasOwnProperty(M)||(y||(y={}),y[M]=\"\");for(M in J)J.hasOwnProperty(M)&&H[M]!==J[M]&&(y||(y={}),y[M]=J[M])}else y||(O||(O=[]),O.push(se,y)),y=J;else se===\"dangerouslySetInnerHTML\"?(J=J?J.__html:void 0,H=H?H.__html:void 0,J!=null&&H!==J&&(O=O||[]).push(se,J)):se===\"children\"?typeof J!=\"string\"&&typeof J!=\"number\"||(O=O||[]).push(se,\"\"+J):se!==\"suppressContentEditableWarning\"&&se!==\"suppressHydrationWarning\"&&(i.hasOwnProperty(se)?(J!=null&&se===\"onScroll\"&&yr(\"scroll\",d),O||H===J||(O=[])):(O=O||[]).push(se,J))}y&&(O=O||[]).push(\"style\",y);var se=O;(p.updateQueue=se)&&(p.flags|=4)}},UO=function(d,p,y,S){y!==S&&(p.flags|=4)};function Uh(d,p){if(!Ar)switch(d.tailMode){case\"hidden\":p=d.tail;for(var y=null;p!==null;)p.alternate!==null&&(y=p),p=p.sibling;y===null?d.tail=null:y.sibling=null;break;case\"collapsed\":y=d.tail;for(var S=null;y!==null;)y.alternate!==null&&(S=y),y=y.sibling;S===null?p||d.tail===null?d.tail=null:d.tail.sibling=null:S.sibling=null}}function Kn(d){var p=d.alternate!==null&&d.alternate.child===d.child,y=0,S=0;if(p)for(var j=d.child;j!==null;)y|=j.lanes|j.childLanes,S|=j.subtreeFlags&14680064,S|=j.flags&14680064,j.return=d,j=j.sibling;else for(j=d.child;j!==null;)y|=j.lanes|j.childLanes,S|=j.subtreeFlags,S|=j.flags,j.return=d,j=j.sibling;return d.subtreeFlags|=S,d.childLanes=y,p}function pte(d,p,y){var S=p.pendingProps;switch(Mb(p),p.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kn(p),null;case 1:return Ti(p.type)&&ag(),Kn(p),null;case 3:return S=p.stateNode,Zu(),xr(ji),xr(Hn),Gb(),S.pendingContext&&(S.context=S.pendingContext,S.pendingContext=null),(d===null||d.child===null)&&(ug(p)?p.flags|=4:d===null||d.memoizedState.isDehydrated&&(p.flags&256)===0||(p.flags|=1024,La!==null&&(_w(La),La=null))),fw(d,p),Kn(p),null;case 5:qb(p);var j=xc(Fh.current);if(y=p.type,d!==null&&p.stateNode!=null)VO(d,p,y,S,j),d.ref!==p.ref&&(p.flags|=512,p.flags|=2097152);else{if(!S){if(p.stateNode===null)throw Error(r(166));return Kn(p),null}if(d=xc(wo.current),ug(p)){S=p.stateNode,y=p.type;var O=p.memoizedProps;switch(S[bo]=p,S[kh]=O,d=(p.mode&1)!==0,y){case\"dialog\":yr(\"cancel\",S),yr(\"close\",S);break;case\"iframe\":case\"object\":case\"embed\":yr(\"load\",S);break;case\"video\":case\"audio\":for(j=0;j<Th.length;j++)yr(Th[j],S);break;case\"source\":yr(\"error\",S);break;case\"img\":case\"image\":case\"link\":yr(\"error\",S),yr(\"load\",S);break;case\"details\":yr(\"toggle\",S);break;case\"input\":qe(S,O),yr(\"invalid\",S);break;case\"select\":S._wrapperState={wasMultiple:!!O.multiple},yr(\"invalid\",S);break;case\"textarea\":ue(S,O),yr(\"invalid\",S)}ve(y,O),j=null;for(var M in O)if(O.hasOwnProperty(M)){var H=O[M];M===\"children\"?typeof H==\"string\"?S.textContent!==H&&(O.suppressHydrationWarning!==!0&&rg(S.textContent,H,d),j=[\"children\",H]):typeof H==\"number\"&&S.textContent!==\"\"+H&&(O.suppressHydrationWarning!==!0&&rg(S.textContent,H,d),j=[\"children\",\"\"+H]):i.hasOwnProperty(M)&&H!=null&&M===\"onScroll\"&&yr(\"scroll\",S)}switch(y){case\"input\":we(S),sr(S,O,!0);break;case\"textarea\":we(S),ge(S);break;case\"select\":case\"option\":break;default:typeof O.onClick==\"function\"&&(S.onclick=ng)}S=j,p.updateQueue=S,S!==null&&(p.flags|=4)}else{M=j.nodeType===9?j:j.ownerDocument,d===\"http://www.w3.org/1999/xhtml\"&&(d=Ve(y)),d===\"http://www.w3.org/1999/xhtml\"?y===\"script\"?(d=M.createElement(\"div\"),d.innerHTML=\"<script><\\/script>\",d=d.removeChild(d.firstChild)):typeof S.is==\"string\"?d=M.createElement(y,{is:S.is}):(d=M.createElement(y),y===\"select\"&&(M=d,S.multiple?M.multiple=!0:S.size&&(M.size=S.size))):d=M.createElementNS(d,y),d[bo]=p,d[kh]=S,$O(d,p,!1,!1),p.stateNode=d;e:{switch(M=We(y,S),y){case\"dialog\":yr(\"cancel\",d),yr(\"close\",d),j=S;break;case\"iframe\":case\"object\":case\"embed\":yr(\"load\",d),j=S;break;case\"video\":case\"audio\":for(j=0;j<Th.length;j++)yr(Th[j],d);j=S;break;case\"source\":yr(\"error\",d),j=S;break;case\"img\":case\"image\":case\"link\":yr(\"error\",d),yr(\"load\",d),j=S;break;case\"details\":yr(\"toggle\",d),j=S;break;case\"input\":qe(d,S),j=le(d,S),yr(\"invalid\",d);break;case\"option\":j=S;break;case\"select\":d._wrapperState={wasMultiple:!!S.multiple},j=ne({},S,{value:void 0}),yr(\"invalid\",d);break;case\"textarea\":ue(d,S),j=Q(d,S),yr(\"invalid\",d);break;default:j=S}ve(y,j),H=j;for(O in H)if(H.hasOwnProperty(O)){var J=H[O];O===\"style\"?qs(d,J):O===\"dangerouslySetInnerHTML\"?(J=J?J.__html:void 0,J!=null&&lr(d,J)):O===\"children\"?typeof J==\"string\"?(y!==\"textarea\"||J!==\"\")&&Ei(d,J):typeof J==\"number\"&&Ei(d,\"\"+J):O!==\"suppressContentEditableWarning\"&&O!==\"suppressHydrationWarning\"&&O!==\"autoFocus\"&&(i.hasOwnProperty(O)?J!=null&&O===\"onScroll\"&&yr(\"scroll\",d):J!=null&&_(d,O,J,M))}switch(y){case\"input\":we(d),sr(d,S,!1);break;case\"textarea\":we(d),ge(d);break;case\"option\":S.value!=null&&d.setAttribute(\"value\",\"\"+Ae(S.value));break;case\"select\":d.multiple=!!S.multiple,O=S.value,O!=null?$(d,!!S.multiple,O,!1):S.defaultValue!=null&&$(d,!!S.multiple,S.defaultValue,!0);break;default:typeof j.onClick==\"function\"&&(d.onclick=ng)}switch(y){case\"button\":case\"input\":case\"select\":case\"textarea\":S=!!S.autoFocus;break e;case\"img\":S=!0;break e;default:S=!1}}S&&(p.flags|=4)}p.ref!==null&&(p.flags|=512,p.flags|=2097152)}return Kn(p),null;case 6:if(d&&p.stateNode!=null)UO(d,p,d.memoizedProps,S);else{if(typeof S!=\"string\"&&p.stateNode===null)throw Error(r(166));if(y=xc(Fh.current),xc(wo.current),ug(p)){if(S=p.stateNode,y=p.memoizedProps,S[bo]=p,(O=S.nodeValue!==y)&&(d=Wi,d!==null))switch(d.tag){case 3:rg(S.nodeValue,y,(d.mode&1)!==0);break;case 5:d.memoizedProps.suppressHydrationWarning!==!0&&rg(S.nodeValue,y,(d.mode&1)!==0)}O&&(p.flags|=4)}else S=(y.nodeType===9?y:y.ownerDocument).createTextNode(S),S[bo]=p,p.stateNode=S}return Kn(p),null;case 13:if(xr(Pr),S=p.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(Ar&&qi!==null&&(p.mode&1)!==0&&(p.flags&128)===0)q4(),Gu(),p.flags|=98560,O=!1;else if(O=ug(p),S!==null&&S.dehydrated!==null){if(d===null){if(!O)throw Error(r(318));if(O=p.memoizedState,O=O!==null?O.dehydrated:null,!O)throw Error(r(317));O[bo]=p}else Gu(),(p.flags&128)===0&&(p.memoizedState=null),p.flags|=4;Kn(p),O=!1}else La!==null&&(_w(La),La=null),O=!0;if(!O)return p.flags&65536?p:null}return(p.flags&128)!==0?(p.lanes=y,p):(S=S!==null,S!==(d!==null&&d.memoizedState!==null)&&S&&(p.child.flags|=8192,(p.mode&1)!==0&&(d===null||(Pr.current&1)!==0?un===0&&(un=3):Nw())),p.updateQueue!==null&&(p.flags|=4),Kn(p),null);case 4:return Zu(),fw(d,p),d===null&&Ph(p.stateNode.containerInfo),Kn(p),null;case 10:return $b(p.type._context),Kn(p),null;case 17:return Ti(p.type)&&ag(),Kn(p),null;case 19:if(xr(Pr),O=p.memoizedState,O===null)return Kn(p),null;if(S=(p.flags&128)!==0,M=O.rendering,M===null)if(S)Uh(O,!1);else{if(un!==0||d!==null&&(d.flags&128)!==0)for(d=p.child;d!==null;){if(M=gg(d),M!==null){for(p.flags|=128,Uh(O,!1),S=M.updateQueue,S!==null&&(p.updateQueue=S,p.flags|=4),p.subtreeFlags=0,S=y,y=p.child;y!==null;)O=y,d=S,O.flags&=14680066,M=O.alternate,M===null?(O.childLanes=0,O.lanes=d,O.child=null,O.subtreeFlags=0,O.memoizedProps=null,O.memoizedState=null,O.updateQueue=null,O.dependencies=null,O.stateNode=null):(O.childLanes=M.childLanes,O.lanes=M.lanes,O.child=M.child,O.subtreeFlags=0,O.deletions=null,O.memoizedProps=M.memoizedProps,O.memoizedState=M.memoizedState,O.updateQueue=M.updateQueue,O.type=M.type,d=M.dependencies,O.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),y=y.sibling;return hr(Pr,Pr.current&1|2),p.child}d=d.sibling}O.tail!==null&&qr()>td&&(p.flags|=128,S=!0,Uh(O,!1),p.lanes=4194304)}else{if(!S)if(d=gg(M),d!==null){if(p.flags|=128,S=!0,y=d.updateQueue,y!==null&&(p.updateQueue=y,p.flags|=4),Uh(O,!0),O.tail===null&&O.tailMode===\"hidden\"&&!M.alternate&&!Ar)return Kn(p),null}else 2*qr()-O.renderingStartTime>td&&y!==1073741824&&(p.flags|=128,S=!0,Uh(O,!1),p.lanes=4194304);O.isBackwards?(M.sibling=p.child,p.child=M):(y=O.last,y!==null?y.sibling=M:p.child=M,O.last=M)}return O.tail!==null?(p=O.tail,O.rendering=p,O.tail=p.sibling,O.renderingStartTime=qr(),p.sibling=null,y=Pr.current,hr(Pr,S?y&1|2:y&1),p):(Kn(p),null);case 22:case 23:return Aw(),S=p.memoizedState!==null,d!==null&&d.memoizedState!==null!==S&&(p.flags|=8192),S&&(p.mode&1)!==0?(Hi&1073741824)!==0&&(Kn(p),p.subtreeFlags&6&&(p.flags|=8192)):Kn(p),null;case 24:return null;case 25:return null}throw Error(r(156,p.tag))}function mte(d,p){switch(Mb(p),p.tag){case 1:return Ti(p.type)&&ag(),d=p.flags,d&65536?(p.flags=d&-65537|128,p):null;case 3:return Zu(),xr(ji),xr(Hn),Gb(),d=p.flags,(d&65536)!==0&&(d&128)===0?(p.flags=d&-65537|128,p):null;case 5:return qb(p),null;case 13:if(xr(Pr),d=p.memoizedState,d!==null&&d.dehydrated!==null){if(p.alternate===null)throw Error(r(340));Gu()}return d=p.flags,d&65536?(p.flags=d&-65537|128,p):null;case 19:return xr(Pr),null;case 4:return Zu(),null;case 10:return $b(p.type._context),null;case 22:case 23:return Aw(),null;case 24:return null;default:return null}}var Ag=!1,Xn=!1,gte=typeof WeakSet==\"function\"?WeakSet:Set,He=null;function Ju(d,p){var y=d.ref;if(y!==null)if(typeof y==\"function\")try{y(null)}catch(S){Fr(d,p,S)}else y.current=null}function hw(d,p,y){try{y()}catch(S){Fr(d,p,S)}}var zO=!1;function vte(d,p){if(Ab=q0,d=w4(),vb(d)){if(\"selectionStart\"in d)var y={start:d.selectionStart,end:d.selectionEnd};else e:{y=(y=d.ownerDocument)&&y.defaultView||window;var S=y.getSelection&&y.getSelection();if(S&&S.rangeCount!==0){y=S.anchorNode;var j=S.anchorOffset,O=S.focusNode;S=S.focusOffset;try{y.nodeType,O.nodeType}catch{y=null;break e}var M=0,H=-1,J=-1,se=0,be=0,Se=d,xe=null;t:for(;;){for(var Ue;Se!==y||j!==0&&Se.nodeType!==3||(H=M+j),Se!==O||S!==0&&Se.nodeType!==3||(J=M+S),Se.nodeType===3&&(M+=Se.nodeValue.length),(Ue=Se.firstChild)!==null;)xe=Se,Se=Ue;for(;;){if(Se===d)break t;if(xe===y&&++se===j&&(H=M),xe===O&&++be===S&&(J=M),(Ue=Se.nextSibling)!==null)break;Se=xe,xe=Se.parentNode}Se=Ue}y=H===-1||J===-1?null:{start:H,end:J}}else y=null}y=y||{start:0,end:0}}else y=null;for(Nb={focusedElem:d,selectionRange:y},q0=!1,He=p;He!==null;)if(p=He,d=p.child,(p.subtreeFlags&1028)!==0&&d!==null)d.return=p,He=d;else for(;He!==null;){p=He;try{var Ke=p.alternate;if((p.flags&1024)!==0)switch(p.tag){case 0:case 11:case 15:break;case 1:if(Ke!==null){var Ze=Ke.memoizedProps,Hr=Ke.memoizedState,ie=p.stateNode,ee=ie.getSnapshotBeforeUpdate(p.elementType===p.type?Ze:Ba(p.type,Ze),Hr);ie.__reactInternalSnapshotBeforeUpdate=ee}break;case 3:var oe=p.stateNode.containerInfo;oe.nodeType===1?oe.textContent=\"\":oe.nodeType===9&&oe.documentElement&&oe.removeChild(oe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Te){Fr(p,p.return,Te)}if(d=p.sibling,d!==null){d.return=p.return,He=d;break}He=p.return}return Ke=zO,zO=!1,Ke}function zh(d,p,y){var S=p.updateQueue;if(S=S!==null?S.lastEffect:null,S!==null){var j=S=S.next;do{if((j.tag&d)===d){var O=j.destroy;j.destroy=void 0,O!==void 0&&hw(p,y,O)}j=j.next}while(j!==S)}}function Ng(d,p){if(p=p.updateQueue,p=p!==null?p.lastEffect:null,p!==null){var y=p=p.next;do{if((y.tag&d)===d){var S=y.create;y.destroy=S()}y=y.next}while(y!==p)}}function pw(d){var p=d.ref;if(p!==null){var y=d.stateNode;switch(d.tag){case 5:d=y;break;default:d=y}typeof p==\"function\"?p(d):p.current=d}}function WO(d){var p=d.alternate;p!==null&&(d.alternate=null,WO(p)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(p=d.stateNode,p!==null&&(delete p[bo],delete p[kh],delete p[Pb],delete p[Jee],delete p[ete])),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}function qO(d){return d.tag===5||d.tag===3||d.tag===4}function HO(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||qO(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function mw(d,p,y){var S=d.tag;if(S===5||S===6)d=d.stateNode,p?y.nodeType===8?y.parentNode.insertBefore(d,p):y.insertBefore(d,p):(y.nodeType===8?(p=y.parentNode,p.insertBefore(d,y)):(p=y,p.appendChild(d)),y=y._reactRootContainer,y!=null||p.onclick!==null||(p.onclick=ng));else if(S!==4&&(d=d.child,d!==null))for(mw(d,p,y),d=d.sibling;d!==null;)mw(d,p,y),d=d.sibling}function gw(d,p,y){var S=d.tag;if(S===5||S===6)d=d.stateNode,p?y.insertBefore(d,p):y.appendChild(d);else if(S!==4&&(d=d.child,d!==null))for(gw(d,p,y),d=d.sibling;d!==null;)gw(d,p,y),d=d.sibling}var Dn=null,$a=!1;function al(d,p,y){for(y=y.child;y!==null;)GO(d,p,y),y=y.sibling}function GO(d,p,y){if(xo&&typeof xo.onCommitFiberUnmount==\"function\")try{xo.onCommitFiberUnmount(B0,y)}catch{}switch(y.tag){case 5:Xn||Ju(y,p);case 6:var S=Dn,j=$a;Dn=null,al(d,p,y),Dn=S,$a=j,Dn!==null&&($a?(d=Dn,y=y.stateNode,d.nodeType===8?d.parentNode.removeChild(y):d.removeChild(y)):Dn.removeChild(y.stateNode));break;case 18:Dn!==null&&($a?(d=Dn,y=y.stateNode,d.nodeType===8?Tb(d.parentNode,y):d.nodeType===1&&Tb(d,y),wh(d)):Tb(Dn,y.stateNode));break;case 4:S=Dn,j=$a,Dn=y.stateNode.containerInfo,$a=!0,al(d,p,y),Dn=S,$a=j;break;case 0:case 11:case 14:case 15:if(!Xn&&(S=y.updateQueue,S!==null&&(S=S.lastEffect,S!==null))){j=S=S.next;do{var O=j,M=O.destroy;O=O.tag,M!==void 0&&((O&2)!==0||(O&4)!==0)&&hw(y,p,M),j=j.next}while(j!==S)}al(d,p,y);break;case 1:if(!Xn&&(Ju(y,p),S=y.stateNode,typeof S.componentWillUnmount==\"function\"))try{S.props=y.memoizedProps,S.state=y.memoizedState,S.componentWillUnmount()}catch(H){Fr(y,p,H)}al(d,p,y);break;case 21:al(d,p,y);break;case 22:y.mode&1?(Xn=(S=Xn)||y.memoizedState!==null,al(d,p,y),Xn=S):al(d,p,y);break;default:al(d,p,y)}}function KO(d){var p=d.updateQueue;if(p!==null){d.updateQueue=null;var y=d.stateNode;y===null&&(y=d.stateNode=new gte),p.forEach(function(S){var j=Nte.bind(null,d,S);y.has(S)||(y.add(S),S.then(j,j))})}}function Va(d,p){var y=p.deletions;if(y!==null)for(var S=0;S<y.length;S++){var j=y[S];try{var O=d,M=p,H=M;e:for(;H!==null;){switch(H.tag){case 5:Dn=H.stateNode,$a=!1;break e;case 3:Dn=H.stateNode.containerInfo,$a=!0;break e;case 4:Dn=H.stateNode.containerInfo,$a=!0;break e}H=H.return}if(Dn===null)throw Error(r(160));GO(O,M,j),Dn=null,$a=!1;var J=j.alternate;J!==null&&(J.return=null),j.return=null}catch(se){Fr(j,p,se)}}if(p.subtreeFlags&12854)for(p=p.child;p!==null;)XO(p,d),p=p.sibling}function XO(d,p){var y=d.alternate,S=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:if(Va(p,d),_o(d),S&4){try{zh(3,d,d.return),Ng(3,d)}catch(Ze){Fr(d,d.return,Ze)}try{zh(5,d,d.return)}catch(Ze){Fr(d,d.return,Ze)}}break;case 1:Va(p,d),_o(d),S&512&&y!==null&&Ju(y,y.return);break;case 5:if(Va(p,d),_o(d),S&512&&y!==null&&Ju(y,y.return),d.flags&32){var j=d.stateNode;try{Ei(j,\"\")}catch(Ze){Fr(d,d.return,Ze)}}if(S&4&&(j=d.stateNode,j!=null)){var O=d.memoizedProps,M=y!==null?y.memoizedProps:O,H=d.type,J=d.updateQueue;if(d.updateQueue=null,J!==null)try{H===\"input\"&&O.type===\"radio\"&&O.name!=null&&tt(j,O),We(H,M);var se=We(H,O);for(M=0;M<J.length;M+=2){var be=J[M],Se=J[M+1];be===\"style\"?qs(j,Se):be===\"dangerouslySetInnerHTML\"?lr(j,Se):be===\"children\"?Ei(j,Se):_(j,be,Se,se)}switch(H){case\"input\":ke(j,O);break;case\"textarea\":pe(j,O);break;case\"select\":var xe=j._wrapperState.wasMultiple;j._wrapperState.wasMultiple=!!O.multiple;var Ue=O.value;Ue!=null?$(j,!!O.multiple,Ue,!1):xe!==!!O.multiple&&(O.defaultValue!=null?$(j,!!O.multiple,O.defaultValue,!0):$(j,!!O.multiple,O.multiple?[]:\"\",!1))}j[kh]=O}catch(Ze){Fr(d,d.return,Ze)}}break;case 6:if(Va(p,d),_o(d),S&4){if(d.stateNode===null)throw Error(r(162));j=d.stateNode,O=d.memoizedProps;try{j.nodeValue=O}catch(Ze){Fr(d,d.return,Ze)}}break;case 3:if(Va(p,d),_o(d),S&4&&y!==null&&y.memoizedState.isDehydrated)try{wh(p.containerInfo)}catch(Ze){Fr(d,d.return,Ze)}break;case 4:Va(p,d),_o(d);break;case 13:Va(p,d),_o(d),j=d.child,j.flags&8192&&(O=j.memoizedState!==null,j.stateNode.isHidden=O,!O||j.alternate!==null&&j.alternate.memoizedState!==null||(xw=qr())),S&4&&KO(d);break;case 22:if(be=y!==null&&y.memoizedState!==null,d.mode&1?(Xn=(se=Xn)||be,Va(p,d),Xn=se):Va(p,d),_o(d),S&8192){if(se=d.memoizedState!==null,(d.stateNode.isHidden=se)&&!be&&(d.mode&1)!==0)for(He=d,be=d.child;be!==null;){for(Se=He=be;He!==null;){switch(xe=He,Ue=xe.child,xe.tag){case 0:case 11:case 14:case 15:zh(4,xe,xe.return);break;case 1:Ju(xe,xe.return);var Ke=xe.stateNode;if(typeof Ke.componentWillUnmount==\"function\"){S=xe,y=xe.return;try{p=S,Ke.props=p.memoizedProps,Ke.state=p.memoizedState,Ke.componentWillUnmount()}catch(Ze){Fr(S,y,Ze)}}break;case 5:Ju(xe,xe.return);break;case 22:if(xe.memoizedState!==null){QO(Se);continue}}Ue!==null?(Ue.return=xe,He=Ue):QO(Se)}be=be.sibling}e:for(be=null,Se=d;;){if(Se.tag===5){if(be===null){be=Se;try{j=Se.stateNode,se?(O=j.style,typeof O.setProperty==\"function\"?O.setProperty(\"display\",\"none\",\"important\"):O.display=\"none\"):(H=Se.stateNode,J=Se.memoizedProps.style,M=J!=null&&J.hasOwnProperty(\"display\")?J.display:null,H.style.display=yo(\"display\",M))}catch(Ze){Fr(d,d.return,Ze)}}}else if(Se.tag===6){if(be===null)try{Se.stateNode.nodeValue=se?\"\":Se.memoizedProps}catch(Ze){Fr(d,d.return,Ze)}}else if((Se.tag!==22&&Se.tag!==23||Se.memoizedState===null||Se===d)&&Se.child!==null){Se.child.return=Se,Se=Se.child;continue}if(Se===d)break e;for(;Se.sibling===null;){if(Se.return===null||Se.return===d)break e;be===Se&&(be=null),Se=Se.return}be===Se&&(be=null),Se.sibling.return=Se.return,Se=Se.sibling}}break;case 19:Va(p,d),_o(d),S&4&&KO(d);break;case 21:break;default:Va(p,d),_o(d)}}function _o(d){var p=d.flags;if(p&2){try{e:{for(var y=d.return;y!==null;){if(qO(y)){var S=y;break e}y=y.return}throw Error(r(160))}switch(S.tag){case 5:var j=S.stateNode;S.flags&32&&(Ei(j,\"\"),S.flags&=-33);var O=HO(d);gw(d,O,j);break;case 3:case 4:var M=S.stateNode.containerInfo,H=HO(d);mw(d,H,M);break;default:throw Error(r(161))}}catch(J){Fr(d,d.return,J)}d.flags&=-3}p&4096&&(d.flags&=-4097)}function yte(d,p,y){He=d,YO(d)}function YO(d,p,y){for(var S=(d.mode&1)!==0;He!==null;){var j=He,O=j.child;if(j.tag===22&&S){var M=j.memoizedState!==null||Ag;if(!M){var H=j.alternate,J=H!==null&&H.memoizedState!==null||Xn;H=Ag;var se=Xn;if(Ag=M,(Xn=J)&&!se)for(He=j;He!==null;)M=He,J=M.child,M.tag===22&&M.memoizedState!==null?JO(j):J!==null?(J.return=M,He=J):JO(j);for(;O!==null;)He=O,YO(O),O=O.sibling;He=j,Ag=H,Xn=se}ZO(d)}else(j.subtreeFlags&8772)!==0&&O!==null?(O.return=j,He=O):ZO(d)}}function ZO(d){for(;He!==null;){var p=He;if((p.flags&8772)!==0){var y=p.alternate;try{if((p.flags&8772)!==0)switch(p.tag){case 0:case 11:case 15:Xn||Ng(5,p);break;case 1:var S=p.stateNode;if(p.flags&4&&!Xn)if(y===null)S.componentDidMount();else{var j=p.elementType===p.type?y.memoizedProps:Ba(p.type,y.memoizedProps);S.componentDidUpdate(j,y.memoizedState,S.__reactInternalSnapshotBeforeUpdate)}var O=p.updateQueue;O!==null&&Q4(p,O,S);break;case 3:var M=p.updateQueue;if(M!==null){if(y=null,p.child!==null)switch(p.child.tag){case 5:y=p.child.stateNode;break;case 1:y=p.child.stateNode}Q4(p,M,y)}break;case 5:var H=p.stateNode;if(y===null&&p.flags&4){y=H;var J=p.memoizedProps;switch(p.type){case\"button\":case\"input\":case\"select\":case\"textarea\":J.autoFocus&&y.focus();break;case\"img\":J.src&&(y.src=J.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(p.memoizedState===null){var se=p.alternate;if(se!==null){var be=se.memoizedState;if(be!==null){var Se=be.dehydrated;Se!==null&&wh(Se)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Xn||p.flags&512&&pw(p)}catch(xe){Fr(p,p.return,xe)}}if(p===d){He=null;break}if(y=p.sibling,y!==null){y.return=p.return,He=y;break}He=p.return}}function QO(d){for(;He!==null;){var p=He;if(p===d){He=null;break}var y=p.sibling;if(y!==null){y.return=p.return,He=y;break}He=p.return}}function JO(d){for(;He!==null;){var p=He;try{switch(p.tag){case 0:case 11:case 15:var y=p.return;try{Ng(4,p)}catch(J){Fr(p,y,J)}break;case 1:var S=p.stateNode;if(typeof S.componentDidMount==\"function\"){var j=p.return;try{S.componentDidMount()}catch(J){Fr(p,j,J)}}var O=p.return;try{pw(p)}catch(J){Fr(p,O,J)}break;case 5:var M=p.return;try{pw(p)}catch(J){Fr(p,M,J)}}}catch(J){Fr(p,p.return,J)}if(p===d){He=null;break}var H=p.sibling;if(H!==null){H.return=p.return,He=H;break}He=p.return}}var xte=Math.ceil,Eg=N.ReactCurrentDispatcher,vw=N.ReactCurrentOwner,ha=N.ReactCurrentBatchConfig,Lt=0,Cn=null,Qr=null,Rn=0,Hi=0,ed=el(0),un=0,Wh=null,wc=0,jg=0,yw=0,qh=null,Oi=null,xw=0,td=1/0,ss=null,Tg=!1,bw=null,ol=null,Pg=!1,sl=null,Og=0,Hh=0,ww=null,kg=-1,Ig=0;function ai(){return(Lt&6)!==0?qr():kg!==-1?kg:kg=qr()}function ll(d){return(d.mode&1)===0?1:(Lt&2)!==0&&Rn!==0?Rn&-Rn:rte.transition!==null?(Ig===0&&(Ig=HP()),Ig):(d=Qt,d!==0||(d=window.event,d=d===void 0?16:t4(d.type)),d)}function Ua(d,p,y,S){if(50<Hh)throw Hh=0,ww=null,Error(r(185));gh(d,y,S),((Lt&2)===0||d!==Cn)&&(d===Cn&&((Lt&2)===0&&(jg|=y),un===4&&cl(d,Rn)),ki(d,S),y===1&&Lt===0&&(p.mode&1)===0&&(td=qr()+500,sg&&rl()))}function ki(d,p){var y=d.callbackNode;ree(d,p);var S=U0(d,d===Cn?Rn:0);if(S===0)y!==null&&zP(y),d.callbackNode=null,d.callbackPriority=0;else if(p=S&-S,d.callbackPriority!==p){if(y!=null&&zP(y),p===1)d.tag===0?tte(tk.bind(null,d)):$4(tk.bind(null,d)),Zee(function(){(Lt&6)===0&&rl()}),y=null;else{switch(GP(S)){case 1:y=eb;break;case 4:y=WP;break;case 16:y=L0;break;case 536870912:y=qP;break;default:y=L0}y=ck(y,ek.bind(null,d))}d.callbackPriority=p,d.callbackNode=y}}function ek(d,p){if(kg=-1,Ig=0,(Lt&6)!==0)throw Error(r(327));var y=d.callbackNode;if(rd()&&d.callbackNode!==y)return null;var S=U0(d,d===Cn?Rn:0);if(S===0)return null;if((S&30)!==0||(S&d.expiredLanes)!==0||p)p=Mg(d,S);else{p=S;var j=Lt;Lt|=2;var O=nk();(Cn!==d||Rn!==p)&&(ss=null,td=qr()+500,_c(d,p));do try{Ste();break}catch(H){rk(d,H)}while(!0);Bb(),Eg.current=O,Lt=j,Qr!==null?p=0:(Cn=null,Rn=0,p=un)}if(p!==0){if(p===2&&(j=tb(d),j!==0&&(S=j,p=Sw(d,j))),p===1)throw y=Wh,_c(d,0),cl(d,S),ki(d,qr()),y;if(p===6)cl(d,S);else{if(j=d.current.alternate,(S&30)===0&&!bte(j)&&(p=Mg(d,S),p===2&&(O=tb(d),O!==0&&(S=O,p=Sw(d,O))),p===1))throw y=Wh,_c(d,0),cl(d,S),ki(d,qr()),y;switch(d.finishedWork=j,d.finishedLanes=S,p){case 0:case 1:throw Error(r(345));case 2:Cc(d,Oi,ss);break;case 3:if(cl(d,S),(S&130023424)===S&&(p=xw+500-qr(),10<p)){if(U0(d,0)!==0)break;if(j=d.suspendedLanes,(j&S)!==S){ai(),d.pingedLanes|=d.suspendedLanes&j;break}d.timeoutHandle=jb(Cc.bind(null,d,Oi,ss),p);break}Cc(d,Oi,ss);break;case 4:if(cl(d,S),(S&4194240)===S)break;for(p=d.eventTimes,j=-1;0<S;){var M=31-Ra(S);O=1<<M,M=p[M],M>j&&(j=M),S&=~O}if(S=j,S=qr()-S,S=(120>S?120:480>S?480:1080>S?1080:1920>S?1920:3e3>S?3e3:4320>S?4320:1960*xte(S/1960))-S,10<S){d.timeoutHandle=jb(Cc.bind(null,d,Oi,ss),S);break}Cc(d,Oi,ss);break;case 5:Cc(d,Oi,ss);break;default:throw Error(r(329))}}}return ki(d,qr()),d.callbackNode===y?ek.bind(null,d):null}function Sw(d,p){var y=qh;return d.current.memoizedState.isDehydrated&&(_c(d,p).flags|=256),d=Mg(d,p),d!==2&&(p=Oi,Oi=y,p!==null&&_w(p)),d}function _w(d){Oi===null?Oi=d:Oi.push.apply(Oi,d)}function bte(d){for(var p=d;;){if(p.flags&16384){var y=p.updateQueue;if(y!==null&&(y=y.stores,y!==null))for(var S=0;S<y.length;S++){var j=y[S],O=j.getSnapshot;j=j.value;try{if(!Fa(O(),j))return!1}catch{return!1}}}if(y=p.child,p.subtreeFlags&16384&&y!==null)y.return=p,p=y;else{if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return!0;p=p.return}p.sibling.return=p.return,p=p.sibling}}return!0}function cl(d,p){for(p&=~yw,p&=~jg,d.suspendedLanes|=p,d.pingedLanes&=~p,d=d.expirationTimes;0<p;){var y=31-Ra(p),S=1<<y;d[y]=-1,p&=~S}}function tk(d){if((Lt&6)!==0)throw Error(r(327));rd();var p=U0(d,0);if((p&1)===0)return ki(d,qr()),null;var y=Mg(d,p);if(d.tag!==0&&y===2){var S=tb(d);S!==0&&(p=S,y=Sw(d,S))}if(y===1)throw y=Wh,_c(d,0),cl(d,p),ki(d,qr()),y;if(y===6)throw Error(r(345));return d.finishedWork=d.current.alternate,d.finishedLanes=p,Cc(d,Oi,ss),ki(d,qr()),null}function Cw(d,p){var y=Lt;Lt|=1;try{return d(p)}finally{Lt=y,Lt===0&&(td=qr()+500,sg&&rl())}}function Sc(d){sl!==null&&sl.tag===0&&(Lt&6)===0&&rd();var p=Lt;Lt|=1;var y=ha.transition,S=Qt;try{if(ha.transition=null,Qt=1,d)return d()}finally{Qt=S,ha.transition=y,Lt=p,(Lt&6)===0&&rl()}}function Aw(){Hi=ed.current,xr(ed)}function _c(d,p){d.finishedWork=null,d.finishedLanes=0;var y=d.timeoutHandle;if(y!==-1&&(d.timeoutHandle=-1,Yee(y)),Qr!==null)for(y=Qr.return;y!==null;){var S=y;switch(Mb(S),S.tag){case 1:S=S.type.childContextTypes,S!=null&&ag();break;case 3:Zu(),xr(ji),xr(Hn),Gb();break;case 5:qb(S);break;case 4:Zu();break;case 13:xr(Pr);break;case 19:xr(Pr);break;case 10:$b(S.type._context);break;case 22:case 23:Aw()}y=y.return}if(Cn=d,Qr=d=ul(d.current,null),Rn=Hi=p,un=0,Wh=null,yw=jg=wc=0,Oi=qh=null,yc!==null){for(p=0;p<yc.length;p++)if(y=yc[p],S=y.interleaved,S!==null){y.interleaved=null;var j=S.next,O=y.pending;if(O!==null){var M=O.next;O.next=j,S.next=M}y.pending=S}yc=null}return d}function rk(d,p){do{var y=Qr;try{if(Bb(),vg.current=wg,yg){for(var S=Or.memoizedState;S!==null;){var j=S.queue;j!==null&&(j.pending=null),S=S.next}yg=!1}if(bc=0,_n=cn=Or=null,Lh=!1,Bh=0,vw.current=null,y===null||y.return===null){un=1,Wh=p,Qr=null;break}e:{var O=d,M=y.return,H=y,J=p;if(p=Rn,H.flags|=32768,J!==null&&typeof J==\"object\"&&typeof J.then==\"function\"){var se=J,be=H,Se=be.tag;if((be.mode&1)===0&&(Se===0||Se===11||Se===15)){var xe=be.alternate;xe?(be.updateQueue=xe.updateQueue,be.memoizedState=xe.memoizedState,be.lanes=xe.lanes):(be.updateQueue=null,be.memoizedState=null)}var Ue=EO(M);if(Ue!==null){Ue.flags&=-257,jO(Ue,M,H,O,p),Ue.mode&1&&NO(O,se,p),p=Ue,J=se;var Ke=p.updateQueue;if(Ke===null){var Ze=new Set;Ze.add(J),p.updateQueue=Ze}else Ke.add(J);break e}else{if((p&1)===0){NO(O,se,p),Nw();break e}J=Error(r(426))}}else if(Ar&&H.mode&1){var Hr=EO(M);if(Hr!==null){(Hr.flags&65536)===0&&(Hr.flags|=256),jO(Hr,M,H,O,p),Fb(Qu(J,H));break e}}O=J=Qu(J,H),un!==4&&(un=2),qh===null?qh=[O]:qh.push(O),O=M;do{switch(O.tag){case 3:O.flags|=65536,p&=-p,O.lanes|=p;var ie=CO(O,J,p);Z4(O,ie);break e;case 1:H=J;var ee=O.type,oe=O.stateNode;if((O.flags&128)===0&&(typeof ee.getDerivedStateFromError==\"function\"||oe!==null&&typeof oe.componentDidCatch==\"function\"&&(ol===null||!ol.has(oe)))){O.flags|=65536,p&=-p,O.lanes|=p;var Te=AO(O,H,p);Z4(O,Te);break e}}O=O.return}while(O!==null)}ak(y)}catch(Je){p=Je,Qr===y&&y!==null&&(Qr=y=y.return);continue}break}while(!0)}function nk(){var d=Eg.current;return Eg.current=wg,d===null?wg:d}function Nw(){(un===0||un===3||un===2)&&(un=4),Cn===null||(wc&268435455)===0&&(jg&268435455)===0||cl(Cn,Rn)}function Mg(d,p){var y=Lt;Lt|=2;var S=nk();(Cn!==d||Rn!==p)&&(ss=null,_c(d,p));do try{wte();break}catch(j){rk(d,j)}while(!0);if(Bb(),Lt=y,Eg.current=S,Qr!==null)throw Error(r(261));return Cn=null,Rn=0,un}function wte(){for(;Qr!==null;)ik(Qr)}function Ste(){for(;Qr!==null&&!GJ();)ik(Qr)}function ik(d){var p=lk(d.alternate,d,Hi);d.memoizedProps=d.pendingProps,p===null?ak(d):Qr=p,vw.current=null}function ak(d){var p=d;do{var y=p.alternate;if(d=p.return,(p.flags&32768)===0){if(y=pte(y,p,Hi),y!==null){Qr=y;return}}else{if(y=mte(y,p),y!==null){y.flags&=32767,Qr=y;return}if(d!==null)d.flags|=32768,d.subtreeFlags=0,d.deletions=null;else{un=6,Qr=null;return}}if(p=p.sibling,p!==null){Qr=p;return}Qr=p=d}while(p!==null);un===0&&(un=5)}function Cc(d,p,y){var S=Qt,j=ha.transition;try{ha.transition=null,Qt=1,_te(d,p,y,S)}finally{ha.transition=j,Qt=S}return null}function _te(d,p,y,S){do rd();while(sl!==null);if((Lt&6)!==0)throw Error(r(327));y=d.finishedWork;var j=d.finishedLanes;if(y===null)return null;if(d.finishedWork=null,d.finishedLanes=0,y===d.current)throw Error(r(177));d.callbackNode=null,d.callbackPriority=0;var O=y.lanes|y.childLanes;if(nee(d,O),d===Cn&&(Qr=Cn=null,Rn=0),(y.subtreeFlags&2064)===0&&(y.flags&2064)===0||Pg||(Pg=!0,ck(L0,function(){return rd(),null})),O=(y.flags&15990)!==0,(y.subtreeFlags&15990)!==0||O){O=ha.transition,ha.transition=null;var M=Qt;Qt=1;var H=Lt;Lt|=4,vw.current=null,vte(d,y),XO(y,d),zee(Nb),q0=!!Ab,Nb=Ab=null,d.current=y,yte(y),KJ(),Lt=H,Qt=M,ha.transition=O}else d.current=y;if(Pg&&(Pg=!1,sl=d,Og=j),O=d.pendingLanes,O===0&&(ol=null),ZJ(y.stateNode),ki(d,qr()),p!==null)for(S=d.onRecoverableError,y=0;y<p.length;y++)j=p[y],S(j.value,{componentStack:j.stack,digest:j.digest});if(Tg)throw Tg=!1,d=bw,bw=null,d;return(Og&1)!==0&&d.tag!==0&&rd(),O=d.pendingLanes,(O&1)!==0?d===ww?Hh++:(Hh=0,ww=d):Hh=0,rl(),null}function rd(){if(sl!==null){var d=GP(Og),p=ha.transition,y=Qt;try{if(ha.transition=null,Qt=16>d?16:d,sl===null)var S=!1;else{if(d=sl,sl=null,Og=0,(Lt&6)!==0)throw Error(r(331));var j=Lt;for(Lt|=4,He=d.current;He!==null;){var O=He,M=O.child;if((He.flags&16)!==0){var H=O.deletions;if(H!==null){for(var J=0;J<H.length;J++){var se=H[J];for(He=se;He!==null;){var be=He;switch(be.tag){case 0:case 11:case 15:zh(8,be,O)}var Se=be.child;if(Se!==null)Se.return=be,He=Se;else for(;He!==null;){be=He;var xe=be.sibling,Ue=be.return;if(WO(be),be===se){He=null;break}if(xe!==null){xe.return=Ue,He=xe;break}He=Ue}}}var Ke=O.alternate;if(Ke!==null){var Ze=Ke.child;if(Ze!==null){Ke.child=null;do{var Hr=Ze.sibling;Ze.sibling=null,Ze=Hr}while(Ze!==null)}}He=O}}if((O.subtreeFlags&2064)!==0&&M!==null)M.return=O,He=M;else e:for(;He!==null;){if(O=He,(O.flags&2048)!==0)switch(O.tag){case 0:case 11:case 15:zh(9,O,O.return)}var ie=O.sibling;if(ie!==null){ie.return=O.return,He=ie;break e}He=O.return}}var ee=d.current;for(He=ee;He!==null;){M=He;var oe=M.child;if((M.subtreeFlags&2064)!==0&&oe!==null)oe.return=M,He=oe;else e:for(M=ee;He!==null;){if(H=He,(H.flags&2048)!==0)try{switch(H.tag){case 0:case 11:case 15:Ng(9,H)}}catch(Je){Fr(H,H.return,Je)}if(H===M){He=null;break e}var Te=H.sibling;if(Te!==null){Te.return=H.return,He=Te;break e}He=H.return}}if(Lt=j,rl(),xo&&typeof xo.onPostCommitFiberRoot==\"function\")try{xo.onPostCommitFiberRoot(B0,d)}catch{}S=!0}return S}finally{Qt=y,ha.transition=p}}return!1}function ok(d,p,y){p=Qu(y,p),p=CO(d,p,1),d=il(d,p,1),p=ai(),d!==null&&(gh(d,1,p),ki(d,p))}function Fr(d,p,y){if(d.tag===3)ok(d,d,y);else for(;p!==null;){if(p.tag===3){ok(p,d,y);break}else if(p.tag===1){var S=p.stateNode;if(typeof p.type.getDerivedStateFromError==\"function\"||typeof S.componentDidCatch==\"function\"&&(ol===null||!ol.has(S))){d=Qu(y,d),d=AO(p,d,1),p=il(p,d,1),d=ai(),p!==null&&(gh(p,1,d),ki(p,d));break}}p=p.return}}function Cte(d,p,y){var S=d.pingCache;S!==null&&S.delete(p),p=ai(),d.pingedLanes|=d.suspendedLanes&y,Cn===d&&(Rn&y)===y&&(un===4||un===3&&(Rn&130023424)===Rn&&500>qr()-xw?_c(d,0):yw|=y),ki(d,p)}function sk(d,p){p===0&&((d.mode&1)===0?p=1:(p=V0,V0<<=1,(V0&130023424)===0&&(V0=4194304)));var y=ai();d=is(d,p),d!==null&&(gh(d,p,y),ki(d,y))}function Ate(d){var p=d.memoizedState,y=0;p!==null&&(y=p.retryLane),sk(d,y)}function Nte(d,p){var y=0;switch(d.tag){case 13:var S=d.stateNode,j=d.memoizedState;j!==null&&(y=j.retryLane);break;case 19:S=d.stateNode;break;default:throw Error(r(314))}S!==null&&S.delete(p),sk(d,y)}var lk;lk=function(d,p,y){if(d!==null)if(d.memoizedProps!==p.pendingProps||ji.current)Pi=!0;else{if((d.lanes&y)===0&&(p.flags&128)===0)return Pi=!1,hte(d,p,y);Pi=(d.flags&131072)!==0}else Pi=!1,Ar&&(p.flags&1048576)!==0&&V4(p,cg,p.index);switch(p.lanes=0,p.tag){case 2:var S=p.type;Cg(d,p),d=p.pendingProps;var j=Wu(p,Hn.current);Yu(p,y),j=Yb(null,p,S,d,j,y);var O=Zb();return p.flags|=1,typeof j==\"object\"&&j!==null&&typeof j.render==\"function\"&&j.$$typeof===void 0?(p.tag=1,p.memoizedState=null,p.updateQueue=null,Ti(S)?(O=!0,og(p)):O=!1,p.memoizedState=j.state!==null&&j.state!==void 0?j.state:null,zb(p),j.updater=Sg,p.stateNode=j,j._reactInternals=p,nw(p,S,d,y),p=sw(null,p,S,!0,O,y)):(p.tag=0,Ar&&O&&Ib(p),ii(null,p,j,y),p=p.child),p;case 16:S=p.elementType;e:{switch(Cg(d,p),d=p.pendingProps,j=S._init,S=j(S._payload),p.type=S,j=p.tag=jte(S),d=Ba(S,d),j){case 0:p=ow(null,p,S,d,y);break e;case 1:p=MO(null,p,S,d,y);break e;case 11:p=TO(null,p,S,d,y);break e;case 14:p=PO(null,p,S,Ba(S.type,d),y);break e}throw Error(r(306,S,\"\"))}return p;case 0:return S=p.type,j=p.pendingProps,j=p.elementType===S?j:Ba(S,j),ow(d,p,S,j,y);case 1:return S=p.type,j=p.pendingProps,j=p.elementType===S?j:Ba(S,j),MO(d,p,S,j,y);case 3:e:{if(DO(p),d===null)throw Error(r(387));S=p.pendingProps,O=p.memoizedState,j=O.element,Y4(d,p),mg(p,S,null,y);var M=p.memoizedState;if(S=M.element,O.isDehydrated)if(O={element:S,isDehydrated:!1,cache:M.cache,pendingSuspenseBoundaries:M.pendingSuspenseBoundaries,transitions:M.transitions},p.updateQueue.baseState=O,p.memoizedState=O,p.flags&256){j=Qu(Error(r(423)),p),p=RO(d,p,S,y,j);break e}else if(S!==j){j=Qu(Error(r(424)),p),p=RO(d,p,S,y,j);break e}else for(qi=Js(p.stateNode.containerInfo.firstChild),Wi=p,Ar=!0,La=null,y=K4(p,null,S,y),p.child=y;y;)y.flags=y.flags&-3|4096,y=y.sibling;else{if(Gu(),S===j){p=os(d,p,y);break e}ii(d,p,S,y)}p=p.child}return p;case 5:return J4(p),d===null&&Rb(p),S=p.type,j=p.pendingProps,O=d!==null?d.memoizedProps:null,M=j.children,Eb(S,j)?M=null:O!==null&&Eb(S,O)&&(p.flags|=32),IO(d,p),ii(d,p,M,y),p.child;case 6:return d===null&&Rb(p),null;case 13:return FO(d,p,y);case 4:return Wb(p,p.stateNode.containerInfo),S=p.pendingProps,d===null?p.child=Ku(p,null,S,y):ii(d,p,S,y),p.child;case 11:return S=p.type,j=p.pendingProps,j=p.elementType===S?j:Ba(S,j),TO(d,p,S,j,y);case 7:return ii(d,p,p.pendingProps,y),p.child;case 8:return ii(d,p,p.pendingProps.children,y),p.child;case 12:return ii(d,p,p.pendingProps.children,y),p.child;case 10:e:{if(S=p.type._context,j=p.pendingProps,O=p.memoizedProps,M=j.value,hr(fg,S._currentValue),S._currentValue=M,O!==null)if(Fa(O.value,M)){if(O.children===j.children&&!ji.current){p=os(d,p,y);break e}}else for(O=p.child,O!==null&&(O.return=p);O!==null;){var H=O.dependencies;if(H!==null){M=O.child;for(var J=H.firstContext;J!==null;){if(J.context===S){if(O.tag===1){J=as(-1,y&-y),J.tag=2;var se=O.updateQueue;if(se!==null){se=se.shared;var be=se.pending;be===null?J.next=J:(J.next=be.next,be.next=J),se.pending=J}}O.lanes|=y,J=O.alternate,J!==null&&(J.lanes|=y),Vb(O.return,y,p),H.lanes|=y;break}J=J.next}}else if(O.tag===10)M=O.type===p.type?null:O.child;else if(O.tag===18){if(M=O.return,M===null)throw Error(r(341));M.lanes|=y,H=M.alternate,H!==null&&(H.lanes|=y),Vb(M,y,p),M=O.sibling}else M=O.child;if(M!==null)M.return=O;else for(M=O;M!==null;){if(M===p){M=null;break}if(O=M.sibling,O!==null){O.return=M.return,M=O;break}M=M.return}O=M}ii(d,p,j.children,y),p=p.child}return p;case 9:return j=p.type,S=p.pendingProps.children,Yu(p,y),j=da(j),S=S(j),p.flags|=1,ii(d,p,S,y),p.child;case 14:return S=p.type,j=Ba(S,p.pendingProps),j=Ba(S.type,j),PO(d,p,S,j,y);case 15:return OO(d,p,p.type,p.pendingProps,y);case 17:return S=p.type,j=p.pendingProps,j=p.elementType===S?j:Ba(S,j),Cg(d,p),p.tag=1,Ti(S)?(d=!0,og(p)):d=!1,Yu(p,y),SO(p,S,j),nw(p,S,j,y),sw(null,p,S,!0,d,y);case 19:return BO(d,p,y);case 22:return kO(d,p,y)}throw Error(r(156,p.tag))};function ck(d,p){return UP(d,p)}function Ete(d,p,y,S){this.tag=d,this.key=y,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=p,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=S,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pa(d,p,y,S){return new Ete(d,p,y,S)}function Ew(d){return d=d.prototype,!(!d||!d.isReactComponent)}function jte(d){if(typeof d==\"function\")return Ew(d)?1:0;if(d!=null){if(d=d.$$typeof,d===D)return 11;if(d===W)return 14}return 2}function ul(d,p){var y=d.alternate;return y===null?(y=pa(d.tag,p,d.key,d.mode),y.elementType=d.elementType,y.type=d.type,y.stateNode=d.stateNode,y.alternate=d,d.alternate=y):(y.pendingProps=p,y.type=d.type,y.flags=0,y.subtreeFlags=0,y.deletions=null),y.flags=d.flags&14680064,y.childLanes=d.childLanes,y.lanes=d.lanes,y.child=d.child,y.memoizedProps=d.memoizedProps,y.memoizedState=d.memoizedState,y.updateQueue=d.updateQueue,p=d.dependencies,y.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext},y.sibling=d.sibling,y.index=d.index,y.ref=d.ref,y}function Dg(d,p,y,S,j,O){var M=2;if(S=d,typeof d==\"function\")Ew(d)&&(M=1);else if(typeof d==\"string\")M=5;else e:switch(d){case P:return Ac(y.children,j,O,p);case k:M=8,j|=8;break;case I:return d=pa(12,y,p,j|2),d.elementType=I,d.lanes=O,d;case L:return d=pa(13,y,p,j),d.elementType=L,d.lanes=O,d;case q:return d=pa(19,y,p,j),d.elementType=q,d.lanes=O,d;case K:return Rg(y,j,O,p);default:if(typeof d==\"object\"&&d!==null)switch(d.$$typeof){case R:M=10;break e;case F:M=9;break e;case D:M=11;break e;case W:M=14;break e;case V:M=16,S=null;break e}throw Error(r(130,d==null?d:typeof d,\"\"))}return p=pa(M,y,p,j),p.elementType=d,p.type=S,p.lanes=O,p}function Ac(d,p,y,S){return d=pa(7,d,S,p),d.lanes=y,d}function Rg(d,p,y,S){return d=pa(22,d,S,p),d.elementType=K,d.lanes=y,d.stateNode={isHidden:!1},d}function jw(d,p,y){return d=pa(6,d,null,p),d.lanes=y,d}function Tw(d,p,y){return p=pa(4,d.children!==null?d.children:[],d.key,p),p.lanes=y,p.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},p}function Tte(d,p,y,S,j){this.tag=p,this.containerInfo=d,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=rb(0),this.expirationTimes=rb(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rb(0),this.identifierPrefix=S,this.onRecoverableError=j,this.mutableSourceEagerHydrationData=null}function Pw(d,p,y,S,j,O,M,H,J){return d=new Tte(d,p,y,H,J),p===1?(p=1,O===!0&&(p|=8)):p=0,O=pa(3,null,null,p),d.current=O,O.stateNode=d,O.memoizedState={element:S,isDehydrated:y,cache:null,transitions:null,pendingSuspenseBoundaries:null},zb(O),d}function Pte(d,p,y){var S=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:T,key:S==null?null:\"\"+S,children:d,containerInfo:p,implementation:y}}function uk(d){if(!d)return tl;d=d._reactInternals;e:{if(hc(d)!==d||d.tag!==1)throw Error(r(170));var p=d;do{switch(p.tag){case 3:p=p.stateNode.context;break e;case 1:if(Ti(p.type)){p=p.stateNode.__reactInternalMemoizedMergedChildContext;break e}}p=p.return}while(p!==null);throw Error(r(171))}if(d.tag===1){var y=d.type;if(Ti(y))return L4(d,y,p)}return p}function dk(d,p,y,S,j,O,M,H,J){return d=Pw(y,S,!0,d,j,O,M,H,J),d.context=uk(null),y=d.current,S=ai(),j=ll(y),O=as(S,j),O.callback=p??null,il(y,O,j),d.current.lanes=j,gh(d,j,S),ki(d,S),d}function Fg(d,p,y,S){var j=p.current,O=ai(),M=ll(j);return y=uk(y),p.context===null?p.context=y:p.pendingContext=y,p=as(O,M),p.payload={element:d},S=S===void 0?null:S,S!==null&&(p.callback=S),d=il(j,p,M),d!==null&&(Ua(d,j,M,O),pg(d,j,M)),M}function Lg(d){if(d=d.current,!d.child)return null;switch(d.child.tag){case 5:return d.child.stateNode;default:return d.child.stateNode}}function fk(d,p){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var y=d.retryLane;d.retryLane=y!==0&&y<p?y:p}}function Ow(d,p){fk(d,p),(d=d.alternate)&&fk(d,p)}function Ote(){return null}var hk=typeof reportError==\"function\"?reportError:function(d){console.error(d)};function kw(d){this._internalRoot=d}Bg.prototype.render=kw.prototype.render=function(d){var p=this._internalRoot;if(p===null)throw Error(r(409));Fg(d,p,null,null)},Bg.prototype.unmount=kw.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var p=d.containerInfo;Sc(function(){Fg(null,d,null,null)}),p[es]=null}};function Bg(d){this._internalRoot=d}Bg.prototype.unstable_scheduleHydration=function(d){if(d){var p=YP();d={blockedOn:null,target:d,priority:p};for(var y=0;y<Ys.length&&p!==0&&p<Ys[y].priority;y++);Ys.splice(y,0,d),y===0&&JP(d)}};function Iw(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function $g(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11&&(d.nodeType!==8||d.nodeValue!==\" react-mount-point-unstable \"))}function pk(){}function kte(d,p,y,S,j){if(j){if(typeof S==\"function\"){var O=S;S=function(){var se=Lg(M);O.call(se)}}var M=dk(p,S,d,0,null,!1,!1,\"\",pk);return d._reactRootContainer=M,d[es]=M.current,Ph(d.nodeType===8?d.parentNode:d),Sc(),M}for(;j=d.lastChild;)d.removeChild(j);if(typeof S==\"function\"){var H=S;S=function(){var se=Lg(J);H.call(se)}}var J=Pw(d,0,!1,null,null,!1,!1,\"\",pk);return d._reactRootContainer=J,d[es]=J.current,Ph(d.nodeType===8?d.parentNode:d),Sc(function(){Fg(p,J,y,S)}),J}function Vg(d,p,y,S,j){var O=y._reactRootContainer;if(O){var M=O;if(typeof j==\"function\"){var H=j;j=function(){var J=Lg(M);H.call(J)}}Fg(p,M,d,j)}else M=kte(y,p,d,j,S);return Lg(M)}KP=function(d){switch(d.tag){case 3:var p=d.stateNode;if(p.current.memoizedState.isDehydrated){var y=mh(p.pendingLanes);y!==0&&(nb(p,y|1),ki(p,qr()),(Lt&6)===0&&(td=qr()+500,rl()))}break;case 13:Sc(function(){var S=is(d,1);if(S!==null){var j=ai();Ua(S,d,1,j)}}),Ow(d,1)}},ib=function(d){if(d.tag===13){var p=is(d,134217728);if(p!==null){var y=ai();Ua(p,d,134217728,y)}Ow(d,134217728)}},XP=function(d){if(d.tag===13){var p=ll(d),y=is(d,p);if(y!==null){var S=ai();Ua(y,d,p,S)}Ow(d,p)}},YP=function(){return Qt},ZP=function(d,p){var y=Qt;try{return Qt=d,p()}finally{Qt=y}},Da=function(d,p,y){switch(p){case\"input\":if(ke(d,y),p=y.name,y.type===\"radio\"&&p!=null){for(y=d;y.parentNode;)y=y.parentNode;for(y=y.querySelectorAll(\"input[name=\"+JSON.stringify(\"\"+p)+'][type=\"radio\"]'),p=0;p<y.length;p++){var S=y[p];if(S!==d&&S.form===d.form){var j=ig(S);if(!j)throw Error(r(90));ce(S),ke(S,j)}}}break;case\"textarea\":pe(d,y);break;case\"select\":p=y.value,p!=null&&$(d,!!y.multiple,p,!1)}},DP=Cw,RP=Sc;var Ite={usingClientEntryPoint:!1,Events:[Ih,Uu,ig,Hs,MP,Cw]},Gh={findFiberByHostInstance:pc,bundleType:0,version:\"18.3.1\",rendererPackageName:\"react-dom\"},Mte={bundleType:Gh.bundleType,version:Gh.version,rendererPackageName:Gh.rendererPackageName,rendererConfig:Gh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:N.ReactCurrentDispatcher,findHostInstanceByFiber:function(d){return d=$P(d),d===null?null:d.stateNode},findFiberByHostInstance:Gh.findFiberByHostInstance||Ote,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:\"18.3.1-next-f1338f8080-20240426\"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<\"u\"){var Ug=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ug.isDisabled&&Ug.supportsFiber)try{B0=Ug.inject(Mte),xo=Ug}catch{}}return Ii.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ite,Ii.createPortal=function(d,p){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Iw(p))throw Error(r(200));return Pte(d,p,null,y)},Ii.createRoot=function(d,p){if(!Iw(d))throw Error(r(299));var y=!1,S=\"\",j=hk;return p!=null&&(p.unstable_strictMode===!0&&(y=!0),p.identifierPrefix!==void 0&&(S=p.identifierPrefix),p.onRecoverableError!==void 0&&(j=p.onRecoverableError)),p=Pw(d,1,!1,null,null,y,!1,S,j),d[es]=p.current,Ph(d.nodeType===8?d.parentNode:d),new kw(p)},Ii.findDOMNode=function(d){if(d==null)return null;if(d.nodeType===1)return d;var p=d._reactInternals;if(p===void 0)throw typeof d.render==\"function\"?Error(r(188)):(d=Object.keys(d).join(\",\"),Error(r(268,d)));return d=$P(p),d=d===null?null:d.stateNode,d},Ii.flushSync=function(d){return Sc(d)},Ii.hydrate=function(d,p,y){if(!$g(p))throw Error(r(200));return Vg(null,d,p,!0,y)},Ii.hydrateRoot=function(d,p,y){if(!Iw(d))throw Error(r(405));var S=y!=null&&y.hydratedSources||null,j=!1,O=\"\",M=hk;if(y!=null&&(y.unstable_strictMode===!0&&(j=!0),y.identifierPrefix!==void 0&&(O=y.identifierPrefix),y.onRecoverableError!==void 0&&(M=y.onRecoverableError)),p=dk(p,null,d,1,y??null,j,!1,O,M),d[es]=p.current,Ph(d),S)for(d=0;d<S.length;d++)y=S[d],j=y._getVersion,j=j(y._source),p.mutableSourceEagerHydrationData==null?p.mutableSourceEagerHydrationData=[y,j]:p.mutableSourceEagerHydrationData.push(y,j);return new Bg(p)},Ii.render=function(d,p,y){if(!$g(p))throw Error(r(200));return Vg(null,d,p,!1,y)},Ii.unmountComponentAtNode=function(d){if(!$g(d))throw Error(r(40));return d._reactRootContainer?(Sc(function(){Vg(null,null,d,!1,function(){d._reactRootContainer=null,d[es]=null})}),!0):!1},Ii.unstable_batchedUpdates=Cw,Ii.unstable_renderSubtreeIntoContainer=function(d,p,y,S){if(!$g(y))throw Error(r(200));if(d==null||d._reactInternals===void 0)throw Error(r(38));return Vg(d,p,y,!1,S)},Ii.version=\"18.3.1-next-f1338f8080-20240426\",Ii}var _k;function OV(){if(_k)return Fw.exports;_k=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>\"u\"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!=\"function\"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Fw.exports=Wte(),Fw.exports}var Ck;function qte(){if(Ck)return qg;Ck=1;var t=OV();return qg.createRoot=t.createRoot,qg.hydrateRoot=t.hydrateRoot,qg}var Hte=qte(),zf=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Gte={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},Cl,_j,MF,Kte=(MF=class{constructor(){rt(this,Cl,Gte);rt(this,_j,!1)}setTimeoutProvider(t){Le(this,Cl,t)}setTimeout(t,e){return Z(this,Cl).setTimeout(t,e)}clearTimeout(t){Z(this,Cl).clearTimeout(t)}setInterval(t,e){return Z(this,Cl).setInterval(t,e)}clearInterval(t){Z(this,Cl).clearInterval(t)}},Cl=new WeakMap,_j=new WeakMap,MF),Bc=new Kte;function Xte(t){setTimeout(t,0)}var su=typeof window>\"u\"||\"Deno\"in globalThis;function gi(){}function Yte(t,e){return typeof t==\"function\"?t(e):t}function MA(t){return typeof t==\"number\"&&t>=0&&t!==1/0}function kV(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Rl(t,e){return typeof t==\"function\"?t(e):t}function _a(t,e){return typeof t==\"function\"?t(e):t}function Ak(t,e){const{type:r=\"all\",exact:n,fetchStatus:i,predicate:a,queryKey:o,stale:s}=t;if(o){if(n){if(e.queryHash!==Cj(o,e.options))return!1}else if(!Wp(e.queryKey,o))return!1}if(r!==\"all\"){const c=e.isActive();if(r===\"active\"&&!c||r===\"inactive\"&&c)return!1}return!(typeof s==\"boolean\"&&e.isStale()!==s||i&&i!==e.state.fetchStatus||a&&!a(e))}function Nk(t,e){const{exact:r,status:n,predicate:i,mutationKey:a}=t;if(a){if(!e.options.mutationKey)return!1;if(r){if(lu(e.options.mutationKey)!==lu(a))return!1}else if(!Wp(e.options.mutationKey,a))return!1}return!(n&&e.state.status!==n||i&&!i(e))}function Cj(t,e){return((e==null?void 0:e.queryKeyHashFn)||lu)(t)}function lu(t){return JSON.stringify(t,(e,r)=>DA(r)?Object.keys(r).sort().reduce((n,i)=>(n[i]=r[i],n),{}):r)}function Wp(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t==\"object\"&&typeof e==\"object\"?Object.keys(e).every(r=>Wp(t[r],e[r])):!1}var Zte=Object.prototype.hasOwnProperty;function IV(t,e){if(t===e)return t;const r=Ek(t)&&Ek(e);if(!r&&!(DA(t)&&DA(e)))return e;const i=(r?t:Object.keys(t)).length,a=r?e:Object.keys(e),o=a.length,s=r?new Array(o):{};let c=0;for(let u=0;u<o;u++){const f=r?u:a[u],h=t[f],m=e[f];if(h===m){s[f]=h,(r?u<i:Zte.call(t,f))&&c++;continue}if(h===null||m===null||typeof h!=\"object\"||typeof m!=\"object\"){s[f]=m;continue}const g=IV(h,m);s[f]=g,g===h&&c++}return i===o&&c===i?t:s}function $v(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}function Ek(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function DA(t){if(!jk(t))return!1;const e=t.constructor;if(e===void 0)return!0;const r=e.prototype;return!(!jk(r)||!r.hasOwnProperty(\"isPrototypeOf\")||Object.getPrototypeOf(t)!==Object.prototype)}function jk(t){return Object.prototype.toString.call(t)===\"[object Object]\"}function Qte(t){return new Promise(e=>{Bc.setTimeout(e,t)})}function RA(t,e,r){return typeof r.structuralSharing==\"function\"?r.structuralSharing(t,e):r.structuralSharing!==!1?IV(t,e):e}function Jte(t,e,r=0){const n=[...t,e];return r&&n.length>r?n.slice(1):n}function ere(t,e,r=0){const n=[e,...t];return r&&n.length>r?n.slice(0,-1):n}var Aj=Symbol();function MV(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===Aj?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function DV(t,e){return typeof t==\"function\"?t(...e):!!t}var Kc,Al,Gd,DF,tre=(DF=class extends zf{constructor(){super();rt(this,Kc);rt(this,Al);rt(this,Gd);Le(this,Gd,e=>{if(!su&&window.addEventListener){const r=()=>e();return window.addEventListener(\"visibilitychange\",r,!1),()=>{window.removeEventListener(\"visibilitychange\",r)}}})}onSubscribe(){Z(this,Al)||this.setEventListener(Z(this,Gd))}onUnsubscribe(){var e;this.hasListeners()||((e=Z(this,Al))==null||e.call(this),Le(this,Al,void 0))}setEventListener(e){var r;Le(this,Gd,e),(r=Z(this,Al))==null||r.call(this),Le(this,Al,e(n=>{typeof n==\"boolean\"?this.setFocused(n):this.onFocus()}))}setFocused(e){Z(this,Kc)!==e&&(Le(this,Kc,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(r=>{r(e)})}isFocused(){var e;return typeof Z(this,Kc)==\"boolean\"?Z(this,Kc):((e=globalThis.document)==null?void 0:e.visibilityState)!==\"hidden\"}},Kc=new WeakMap,Al=new WeakMap,Gd=new WeakMap,DF),Nj=new tre;function FA(){let t,e;const r=new Promise((i,a)=>{t=i,e=a});r.status=\"pending\",r.catch(()=>{});function n(i){Object.assign(r,i),delete r.resolve,delete r.reject}return r.resolve=i=>{n({status:\"fulfilled\",value:i}),t(i)},r.reject=i=>{n({status:\"rejected\",reason:i}),e(i)},r}var rre=Xte;function nre(){let t=[],e=0,r=s=>{s()},n=s=>{s()},i=rre;const a=s=>{e?t.push(s):i(()=>{r(s)})},o=()=>{const s=t;t=[],s.length&&i(()=>{n(()=>{s.forEach(c=>{r(c)})})})};return{batch:s=>{let c;e++;try{c=s()}finally{e--,e||o()}return c},batchCalls:s=>(...c)=>{a(()=>{s(...c)})},schedule:a,setNotifyFunction:s=>{r=s},setBatchNotifyFunction:s=>{n=s},setScheduler:s=>{i=s}}}var vn=nre(),Kd,Nl,Xd,RF,ire=(RF=class extends zf{constructor(){super();rt(this,Kd,!0);rt(this,Nl);rt(this,Xd);Le(this,Xd,e=>{if(!su&&window.addEventListener){const r=()=>e(!0),n=()=>e(!1);return window.addEventListener(\"online\",r,!1),window.addEventListener(\"offline\",n,!1),()=>{window.removeEventListener(\"online\",r),window.removeEventListener(\"offline\",n)}}})}onSubscribe(){Z(this,Nl)||this.setEventListener(Z(this,Xd))}onUnsubscribe(){var e;this.hasListeners()||((e=Z(this,Nl))==null||e.call(this),Le(this,Nl,void 0))}setEventListener(e){var r;Le(this,Xd,e),(r=Z(this,Nl))==null||r.call(this),Le(this,Nl,e(this.setOnline.bind(this)))}setOnline(e){Z(this,Kd)!==e&&(Le(this,Kd,e),this.listeners.forEach(n=>{n(e)}))}isOnline(){return Z(this,Kd)}},Kd=new WeakMap,Nl=new WeakMap,Xd=new WeakMap,RF),Vv=new ire;function are(t){return Math.min(1e3*2**t,3e4)}function RV(t){return(t??\"online\")===\"online\"?Vv.isOnline():!0}var LA=class extends Error{constructor(t){super(\"CancelledError\"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function FV(t){let e=!1,r=0,n;const i=FA(),a=()=>i.status!==\"pending\",o=v=>{var b;if(!a()){const w=new LA(v);m(w),(b=t.onCancel)==null||b.call(t,w)}},s=()=>{e=!0},c=()=>{e=!1},u=()=>Nj.isFocused()&&(t.networkMode===\"always\"||Vv.isOnline())&&t.canRun(),f=()=>RV(t.networkMode)&&t.canRun(),h=v=>{a()||(n==null||n(),i.resolve(v))},m=v=>{a()||(n==null||n(),i.reject(v))},g=()=>new Promise(v=>{var b;n=w=>{(a()||u())&&v(w)},(b=t.onPause)==null||b.call(t)}).then(()=>{var v;n=void 0,a()||(v=t.onContinue)==null||v.call(t)}),x=()=>{if(a())return;let v;const b=r===0?t.initialPromise:void 0;try{v=b??t.fn()}catch(w){v=Promise.reject(w)}Promise.resolve(v).then(h).catch(w=>{var T;if(a())return;const C=t.retry??(su?0:3),_=t.retryDelay??are,N=typeof _==\"function\"?_(r,w):_,A=C===!0||typeof C==\"number\"&&r<C||typeof C==\"function\"&&C(r,w);if(e||!A){m(w);return}r++,(T=t.onFail)==null||T.call(t,r,w),Qte(N).then(()=>u()?void 0:g()).then(()=>{e?m(w):x()})})};return{promise:i,status:()=>i.status,cancel:o,continue:()=>(n==null||n(),i),cancelRetry:s,continueRetry:c,canStart:f,start:()=>(f()?x():g().then(x),i)}}var Xc,FF,LV=(FF=class{constructor(){rt(this,Xc)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),MA(this.gcTime)&&Le(this,Xc,Bc.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(su?1/0:300*1e3))}clearGcTimeout(){Z(this,Xc)&&(Bc.clearTimeout(Z(this,Xc)),Le(this,Xc,void 0))}},Xc=new WeakMap,FF),Yc,Yd,wa,Zc,jn,t0,Qc,Ga,ds,LF,ore=(LF=class extends LV{constructor(e){super();rt(this,Ga);rt(this,Yc);rt(this,Yd);rt(this,wa);rt(this,Zc);rt(this,jn);rt(this,t0);rt(this,Qc);Le(this,Qc,!1),Le(this,t0,e.defaultOptions),this.setOptions(e.options),this.observers=[],Le(this,Zc,e.client),Le(this,wa,Z(this,Zc).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,Le(this,Yc,Tk(this.options)),this.state=e.state??Z(this,Yc),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=Z(this,jn))==null?void 0:e.promise}setOptions(e){if(this.options={...Z(this,t0),...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=Tk(this.options);r.data!==void 0&&(this.setData(r.data,{updatedAt:r.dataUpdatedAt,manual:!0}),Le(this,Yc,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus===\"idle\"&&Z(this,wa).remove(this)}setData(e,r){const n=RA(this.state.data,e,this.options);return St(this,Ga,ds).call(this,{data:n,type:\"success\",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(e,r){St(this,Ga,ds).call(this,{type:\"setState\",state:e,setStateOptions:r})}cancel(e){var n,i;const r=(n=Z(this,jn))==null?void 0:n.promise;return(i=Z(this,jn))==null||i.cancel(e),r?r.then(gi).catch(gi):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Z(this,Yc))}isActive(){return this.observers.some(e=>_a(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Aj||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>Rl(e.options.staleTime,this)===\"static\"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e===\"static\"?!1:this.state.isInvalidated?!0:!kV(this.state.dataUpdatedAt,e)}onFocus(){var r;const e=this.observers.find(n=>n.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(r=Z(this,jn))==null||r.continue()}onOnline(){var r;const e=this.observers.find(n=>n.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(r=Z(this,jn))==null||r.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),Z(this,wa).notify({type:\"observerAdded\",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(r=>r!==e),this.observers.length||(Z(this,jn)&&(Z(this,Qc)?Z(this,jn).cancel({revert:!0}):Z(this,jn).cancelRetry()),this.scheduleGc()),Z(this,wa).notify({type:\"observerRemoved\",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||St(this,Ga,ds).call(this,{type:\"invalidate\"})}async fetch(e,r){var c,u,f,h,m,g,x,v,b,w,C,_;if(this.state.fetchStatus!==\"idle\"&&((c=Z(this,jn))==null?void 0:c.status())!==\"rejected\"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(Z(this,jn))return Z(this,jn).continueRetry(),Z(this,jn).promise}if(e&&this.setOptions(e),!this.options.queryFn){const N=this.observers.find(A=>A.options.queryFn);N&&this.setOptions(N.options)}const n=new AbortController,i=N=>{Object.defineProperty(N,\"signal\",{enumerable:!0,get:()=>(Le(this,Qc,!0),n.signal)})},a=()=>{const N=MV(this.options,r),T=(()=>{const P={client:Z(this,Zc),queryKey:this.queryKey,meta:this.meta};return i(P),P})();return Le(this,Qc,!1),this.options.persister?this.options.persister(N,T,this):N(T)},s=(()=>{const N={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:Z(this,Zc),state:this.state,fetchFn:a};return i(N),N})();(u=this.options.behavior)==null||u.onFetch(s,this),Le(this,Yd,this.state),(this.state.fetchStatus===\"idle\"||this.state.fetchMeta!==((f=s.fetchOptions)==null?void 0:f.meta))&&St(this,Ga,ds).call(this,{type:\"fetch\",meta:(h=s.fetchOptions)==null?void 0:h.meta}),Le(this,jn,FV({initialPromise:r==null?void 0:r.initialPromise,fn:s.fetchFn,onCancel:N=>{N instanceof LA&&N.revert&&this.setState({...Z(this,Yd),fetchStatus:\"idle\"}),n.abort()},onFail:(N,A)=>{St(this,Ga,ds).call(this,{type:\"failed\",failureCount:N,error:A})},onPause:()=>{St(this,Ga,ds).call(this,{type:\"pause\"})},onContinue:()=>{St(this,Ga,ds).call(this,{type:\"continue\"})},retry:s.options.retry,retryDelay:s.options.retryDelay,networkMode:s.options.networkMode,canRun:()=>!0}));try{const N=await Z(this,jn).start();if(N===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(N),(g=(m=Z(this,wa).config).onSuccess)==null||g.call(m,N,this),(v=(x=Z(this,wa).config).onSettled)==null||v.call(x,N,this.state.error,this),N}catch(N){if(N instanceof LA){if(N.silent)return Z(this,jn).promise;if(N.revert){if(this.state.data===void 0)throw N;return this.state.data}}throw St(this,Ga,ds).call(this,{type:\"error\",error:N}),(w=(b=Z(this,wa).config).onError)==null||w.call(b,N,this),(_=(C=Z(this,wa).config).onSettled)==null||_.call(C,this.state.data,N,this),N}finally{this.scheduleGc()}}},Yc=new WeakMap,Yd=new WeakMap,wa=new WeakMap,Zc=new WeakMap,jn=new WeakMap,t0=new WeakMap,Qc=new WeakMap,Ga=new WeakSet,ds=function(e){const r=n=>{switch(e.type){case\"failed\":return{...n,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case\"pause\":return{...n,fetchStatus:\"paused\"};case\"continue\":return{...n,fetchStatus:\"fetching\"};case\"fetch\":return{...n,...BV(n.data,this.options),fetchMeta:e.meta??null};case\"success\":const i={...n,data:e.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:\"success\",...!e.manual&&{fetchStatus:\"idle\",fetchFailureCount:0,fetchFailureReason:null}};return Le(this,Yd,e.manual?i:void 0),i;case\"error\":const a=e.error;return{...n,error:a,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:\"idle\",status:\"error\"};case\"invalidate\":return{...n,isInvalidated:!0};case\"setState\":return{...n,...e.state}}};this.state=r(this.state),vn.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),Z(this,wa).notify({query:this,type:\"updated\",action:e})})},LF);function BV(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:RV(e.networkMode)?\"fetching\":\"paused\",...t===void 0&&{error:null,status:\"pending\"}}}function Tk(t){const e=typeof t.initialData==\"function\"?t.initialData():t.initialData,r=e!==void 0,n=r?typeof t.initialDataUpdatedAt==\"function\"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?\"success\":\"pending\",fetchStatus:\"idle\"}}var Mi,Ot,r0,ui,Jc,Zd,ps,El,n0,Qd,Jd,eu,tu,jl,ef,Zt,gp,BA,$A,VA,UA,zA,WA,qA,$V,BF,sre=(BF=class extends zf{constructor(e,r){super();rt(this,Zt);rt(this,Mi);rt(this,Ot);rt(this,r0);rt(this,ui);rt(this,Jc);rt(this,Zd);rt(this,ps);rt(this,El);rt(this,n0);rt(this,Qd);rt(this,Jd);rt(this,eu);rt(this,tu);rt(this,jl);rt(this,ef,new Set);this.options=r,Le(this,Mi,e),Le(this,El,null),Le(this,ps,FA()),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(Z(this,Ot).addObserver(this),Pk(Z(this,Ot),this.options)?St(this,Zt,gp).call(this):this.updateResult(),St(this,Zt,UA).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return HA(Z(this,Ot),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return HA(Z(this,Ot),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,St(this,Zt,zA).call(this),St(this,Zt,WA).call(this),Z(this,Ot).removeObserver(this)}setOptions(e){const r=this.options,n=Z(this,Ot);if(this.options=Z(this,Mi).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!=\"boolean\"&&typeof this.options.enabled!=\"function\"&&typeof _a(this.options.enabled,Z(this,Ot))!=\"boolean\")throw new Error(\"Expected enabled to be a boolean or a callback that returns a boolean\");St(this,Zt,qA).call(this),Z(this,Ot).setOptions(this.options),r._defaulted&&!$v(this.options,r)&&Z(this,Mi).getQueryCache().notify({type:\"observerOptionsUpdated\",query:Z(this,Ot),observer:this});const i=this.hasListeners();i&&Ok(Z(this,Ot),n,this.options,r)&&St(this,Zt,gp).call(this),this.updateResult(),i&&(Z(this,Ot)!==n||_a(this.options.enabled,Z(this,Ot))!==_a(r.enabled,Z(this,Ot))||Rl(this.options.staleTime,Z(this,Ot))!==Rl(r.staleTime,Z(this,Ot)))&&St(this,Zt,BA).call(this);const a=St(this,Zt,$A).call(this);i&&(Z(this,Ot)!==n||_a(this.options.enabled,Z(this,Ot))!==_a(r.enabled,Z(this,Ot))||a!==Z(this,jl))&&St(this,Zt,VA).call(this,a)}getOptimisticResult(e){const r=Z(this,Mi).getQueryCache().build(Z(this,Mi),e),n=this.createResult(r,e);return cre(this,n)&&(Le(this,ui,n),Le(this,Zd,this.options),Le(this,Jc,Z(this,Ot).state)),n}getCurrentResult(){return Z(this,ui)}trackResult(e,r){return new Proxy(e,{get:(n,i)=>(this.trackProp(i),r==null||r(i),i===\"promise\"&&!this.options.experimental_prefetchInRender&&Z(this,ps).status===\"pending\"&&Z(this,ps).reject(new Error(\"experimental_prefetchInRender feature flag is not enabled\")),Reflect.get(n,i))})}trackProp(e){Z(this,ef).add(e)}getCurrentQuery(){return Z(this,Ot)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const r=Z(this,Mi).defaultQueryOptions(e),n=Z(this,Mi).getQueryCache().build(Z(this,Mi),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(e){return St(this,Zt,gp).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),Z(this,ui)))}createResult(e,r){var I;const n=Z(this,Ot),i=this.options,a=Z(this,ui),o=Z(this,Jc),s=Z(this,Zd),u=e!==n?e.state:Z(this,r0),{state:f}=e;let h={...f},m=!1,g;if(r._optimisticResults){const R=this.hasListeners(),F=!R&&Pk(e,r),D=R&&Ok(e,n,r,i);(F||D)&&(h={...h,...BV(f.data,e.options)}),r._optimisticResults===\"isRestoring\"&&(h.fetchStatus=\"idle\")}let{error:x,errorUpdatedAt:v,status:b}=h;g=h.data;let w=!1;if(r.placeholderData!==void 0&&g===void 0&&b===\"pending\"){let R;a!=null&&a.isPlaceholderData&&r.placeholderData===(s==null?void 0:s.placeholderData)?(R=a.data,w=!0):R=typeof r.placeholderData==\"function\"?r.placeholderData((I=Z(this,Jd))==null?void 0:I.state.data,Z(this,Jd)):r.placeholderData,R!==void 0&&(b=\"success\",g=RA(a==null?void 0:a.data,R,r),m=!0)}if(r.select&&g!==void 0&&!w)if(a&&g===(o==null?void 0:o.data)&&r.select===Z(this,n0))g=Z(this,Qd);else try{Le(this,n0,r.select),g=r.select(g),g=RA(a==null?void 0:a.data,g,r),Le(this,Qd,g),Le(this,El,null)}catch(R){Le(this,El,R)}Z(this,El)&&(x=Z(this,El),g=Z(this,Qd),v=Date.now(),b=\"error\");const C=h.fetchStatus===\"fetching\",_=b===\"pending\",N=b===\"error\",A=_&&C,T=g!==void 0,k={status:b,fetchStatus:h.fetchStatus,isPending:_,isSuccess:b===\"success\",isError:N,isInitialLoading:A,isLoading:A,data:g,dataUpdatedAt:h.dataUpdatedAt,error:x,errorUpdatedAt:v,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>u.dataUpdateCount||h.errorUpdateCount>u.errorUpdateCount,isFetching:C,isRefetching:C&&!_,isLoadingError:N&&!T,isPaused:h.fetchStatus===\"paused\",isPlaceholderData:m,isRefetchError:N&&T,isStale:Ej(e,r),refetch:this.refetch,promise:Z(this,ps),isEnabled:_a(r.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const R=L=>{k.status===\"error\"?L.reject(k.error):k.data!==void 0&&L.resolve(k.data)},F=()=>{const L=Le(this,ps,k.promise=FA());R(L)},D=Z(this,ps);switch(D.status){case\"pending\":e.queryHash===n.queryHash&&R(D);break;case\"fulfilled\":(k.status===\"error\"||k.data!==D.value)&&F();break;case\"rejected\":(k.status!==\"error\"||k.error!==D.reason)&&F();break}}return k}updateResult(){const e=Z(this,ui),r=this.createResult(Z(this,Ot),this.options);if(Le(this,Jc,Z(this,Ot).state),Le(this,Zd,this.options),Z(this,Jc).data!==void 0&&Le(this,Jd,Z(this,Ot)),$v(r,e))return;Le(this,ui,r);const n=()=>{if(!e)return!0;const{notifyOnChangeProps:i}=this.options,a=typeof i==\"function\"?i():i;if(a===\"all\"||!a&&!Z(this,ef).size)return!0;const o=new Set(a??Z(this,ef));return this.options.throwOnError&&o.add(\"error\"),Object.keys(Z(this,ui)).some(s=>{const c=s;return Z(this,ui)[c]!==e[c]&&o.has(c)})};St(this,Zt,$V).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&St(this,Zt,UA).call(this)}},Mi=new WeakMap,Ot=new WeakMap,r0=new WeakMap,ui=new WeakMap,Jc=new WeakMap,Zd=new WeakMap,ps=new WeakMap,El=new WeakMap,n0=new WeakMap,Qd=new WeakMap,Jd=new WeakMap,eu=new WeakMap,tu=new WeakMap,jl=new WeakMap,ef=new WeakMap,Zt=new WeakSet,gp=function(e){St(this,Zt,qA).call(this);let r=Z(this,Ot).fetch(this.options,e);return e!=null&&e.throwOnError||(r=r.catch(gi)),r},BA=function(){St(this,Zt,zA).call(this);const e=Rl(this.options.staleTime,Z(this,Ot));if(su||Z(this,ui).isStale||!MA(e))return;const n=kV(Z(this,ui).dataUpdatedAt,e)+1;Le(this,eu,Bc.setTimeout(()=>{Z(this,ui).isStale||this.updateResult()},n))},$A=function(){return(typeof this.options.refetchInterval==\"function\"?this.options.refetchInterval(Z(this,Ot)):this.options.refetchInterval)??!1},VA=function(e){St(this,Zt,WA).call(this),Le(this,jl,e),!(su||_a(this.options.enabled,Z(this,Ot))===!1||!MA(Z(this,jl))||Z(this,jl)===0)&&Le(this,tu,Bc.setInterval(()=>{(this.options.refetchIntervalInBackground||Nj.isFocused())&&St(this,Zt,gp).call(this)},Z(this,jl)))},UA=function(){St(this,Zt,BA).call(this),St(this,Zt,VA).call(this,St(this,Zt,$A).call(this))},zA=function(){Z(this,eu)&&(Bc.clearTimeout(Z(this,eu)),Le(this,eu,void 0))},WA=function(){Z(this,tu)&&(Bc.clearInterval(Z(this,tu)),Le(this,tu,void 0))},qA=function(){const e=Z(this,Mi).getQueryCache().build(Z(this,Mi),this.options);if(e===Z(this,Ot))return;const r=Z(this,Ot);Le(this,Ot,e),Le(this,r0,e.state),this.hasListeners()&&(r==null||r.removeObserver(this),e.addObserver(this))},$V=function(e){vn.batch(()=>{e.listeners&&this.listeners.forEach(r=>{r(Z(this,ui))}),Z(this,Mi).getQueryCache().notify({query:Z(this,Ot),type:\"observerResultsUpdated\"})})},BF);function lre(t,e){return _a(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status===\"error\"&&e.retryOnMount===!1)}function Pk(t,e){return lre(t,e)||t.state.data!==void 0&&HA(t,e,e.refetchOnMount)}function HA(t,e,r){if(_a(e.enabled,t)!==!1&&Rl(e.staleTime,t)!==\"static\"){const n=typeof r==\"function\"?r(t):r;return n===\"always\"||n!==!1&&Ej(t,e)}return!1}function Ok(t,e,r,n){return(t!==e||_a(n.enabled,t)===!1)&&(!r.suspense||t.state.status!==\"error\")&&Ej(t,r)}function Ej(t,e){return _a(e.enabled,t)!==!1&&t.isStaleByTime(Rl(e.staleTime,t))}function cre(t,e){return!$v(t.getCurrentResult(),e)}function kk(t){return{onFetch:(e,r)=>{var f,h,m,g,x;const n=e.options,i=(m=(h=(f=e.fetchOptions)==null?void 0:f.meta)==null?void 0:h.fetchMore)==null?void 0:m.direction,a=((g=e.state.data)==null?void 0:g.pages)||[],o=((x=e.state.data)==null?void 0:x.pageParams)||[];let s={pages:[],pageParams:[]},c=0;const u=async()=>{let v=!1;const b=_=>{Object.defineProperty(_,\"signal\",{enumerable:!0,get:()=>(e.signal.aborted?v=!0:e.signal.addEventListener(\"abort\",()=>{v=!0}),e.signal)})},w=MV(e.options,e.fetchOptions),C=async(_,N,A)=>{if(v)return Promise.reject();if(N==null&&_.pages.length)return Promise.resolve(_);const P=(()=>{const F={client:e.client,queryKey:e.queryKey,pageParam:N,direction:A?\"backward\":\"forward\",meta:e.options.meta};return b(F),F})(),k=await w(P),{maxPages:I}=e.options,R=A?ere:Jte;return{pages:R(_.pages,k,I),pageParams:R(_.pageParams,N,I)}};if(i&&a.length){const _=i===\"backward\",N=_?ure:Ik,A={pages:a,pageParams:o},T=N(n,A);s=await C(A,T,_)}else{const _=t??a.length;do{const N=c===0?o[0]??n.initialPageParam:Ik(n,s);if(c>0&&N==null)break;s=await C(s,N),c++}while(c<_)}return s};e.options.persister?e.fetchFn=()=>{var v,b;return(b=(v=e.options).persister)==null?void 0:b.call(v,u,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},r)}:e.fetchFn=u}}}function Ik(t,{pages:e,pageParams:r}){const n=e.length-1;return e.length>0?t.getNextPageParam(e[n],e,r[n],r):void 0}function ure(t,{pages:e,pageParams:r}){var n;return e.length>0?(n=t.getPreviousPageParam)==null?void 0:n.call(t,e[0],e,r[0],r):void 0}var i0,Ao,di,ru,No,yl,$F,dre=($F=class extends LV{constructor(e){super();rt(this,No);rt(this,i0);rt(this,Ao);rt(this,di);rt(this,ru);Le(this,i0,e.client),this.mutationId=e.mutationId,Le(this,di,e.mutationCache),Le(this,Ao,[]),this.state=e.state||VV(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){Z(this,Ao).includes(e)||(Z(this,Ao).push(e),this.clearGcTimeout(),Z(this,di).notify({type:\"observerAdded\",mutation:this,observer:e}))}removeObserver(e){Le(this,Ao,Z(this,Ao).filter(r=>r!==e)),this.scheduleGc(),Z(this,di).notify({type:\"observerRemoved\",mutation:this,observer:e})}optionalRemove(){Z(this,Ao).length||(this.state.status===\"pending\"?this.scheduleGc():Z(this,di).remove(this))}continue(){var e;return((e=Z(this,ru))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var o,s,c,u,f,h,m,g,x,v,b,w,C,_,N,A,T,P,k,I;const r=()=>{St(this,No,yl).call(this,{type:\"continue\"})},n={client:Z(this,i0),meta:this.options.meta,mutationKey:this.options.mutationKey};Le(this,ru,FV({fn:()=>this.options.mutationFn?this.options.mutationFn(e,n):Promise.reject(new Error(\"No mutationFn found\")),onFail:(R,F)=>{St(this,No,yl).call(this,{type:\"failed\",failureCount:R,error:F})},onPause:()=>{St(this,No,yl).call(this,{type:\"pause\"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Z(this,di).canRun(this)}));const i=this.state.status===\"pending\",a=!Z(this,ru).canStart();try{if(i)r();else{St(this,No,yl).call(this,{type:\"pending\",variables:e,isPaused:a}),await((s=(o=Z(this,di).config).onMutate)==null?void 0:s.call(o,e,this,n));const F=await((u=(c=this.options).onMutate)==null?void 0:u.call(c,e,n));F!==this.state.context&&St(this,No,yl).call(this,{type:\"pending\",context:F,variables:e,isPaused:a})}const R=await Z(this,ru).start();return await((h=(f=Z(this,di).config).onSuccess)==null?void 0:h.call(f,R,e,this.state.context,this,n)),await((g=(m=this.options).onSuccess)==null?void 0:g.call(m,R,e,this.state.context,n)),await((v=(x=Z(this,di).config).onSettled)==null?void 0:v.call(x,R,null,this.state.variables,this.state.context,this,n)),await((w=(b=this.options).onSettled)==null?void 0:w.call(b,R,null,e,this.state.context,n)),St(this,No,yl).call(this,{type:\"success\",data:R}),R}catch(R){try{throw await((_=(C=Z(this,di).config).onError)==null?void 0:_.call(C,R,e,this.state.context,this,n)),await((A=(N=this.options).onError)==null?void 0:A.call(N,R,e,this.state.context,n)),await((P=(T=Z(this,di).config).onSettled)==null?void 0:P.call(T,void 0,R,this.state.variables,this.state.context,this,n)),await((I=(k=this.options).onSettled)==null?void 0:I.call(k,void 0,R,e,this.state.context,n)),R}finally{St(this,No,yl).call(this,{type:\"error\",error:R})}}finally{Z(this,di).runNext(this)}}},i0=new WeakMap,Ao=new WeakMap,di=new WeakMap,ru=new WeakMap,No=new WeakSet,yl=function(e){const r=n=>{switch(e.type){case\"failed\":return{...n,failureCount:e.failureCount,failureReason:e.error};case\"pause\":return{...n,isPaused:!0};case\"continue\":return{...n,isPaused:!1};case\"pending\":return{...n,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:\"pending\",variables:e.variables,submittedAt:Date.now()};case\"success\":return{...n,data:e.data,failureCount:0,failureReason:null,error:null,status:\"success\",isPaused:!1};case\"error\":return{...n,data:void 0,error:e.error,failureCount:n.failureCount+1,failureReason:e.error,isPaused:!1,status:\"error\"}}};this.state=r(this.state),vn.batch(()=>{Z(this,Ao).forEach(n=>{n.onMutationUpdate(e)}),Z(this,di).notify({mutation:this,type:\"updated\",action:e})})},$F);function VV(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:\"idle\",variables:void 0,submittedAt:0}}var ms,Ka,a0,VF,fre=(VF=class extends zf{constructor(e={}){super();rt(this,ms);rt(this,Ka);rt(this,a0);this.config=e,Le(this,ms,new Set),Le(this,Ka,new Map),Le(this,a0,0)}build(e,r,n){const i=new dre({client:e,mutationCache:this,mutationId:++zg(this,a0)._,options:e.defaultMutationOptions(r),state:n});return this.add(i),i}add(e){Z(this,ms).add(e);const r=Hg(e);if(typeof r==\"string\"){const n=Z(this,Ka).get(r);n?n.push(e):Z(this,Ka).set(r,[e])}this.notify({type:\"added\",mutation:e})}remove(e){if(Z(this,ms).delete(e)){const r=Hg(e);if(typeof r==\"string\"){const n=Z(this,Ka).get(r);if(n)if(n.length>1){const i=n.indexOf(e);i!==-1&&n.splice(i,1)}else n[0]===e&&Z(this,Ka).delete(r)}}this.notify({type:\"removed\",mutation:e})}canRun(e){const r=Hg(e);if(typeof r==\"string\"){const n=Z(this,Ka).get(r),i=n==null?void 0:n.find(a=>a.state.status===\"pending\");return!i||i===e}else return!0}runNext(e){var n;const r=Hg(e);if(typeof r==\"string\"){const i=(n=Z(this,Ka).get(r))==null?void 0:n.find(a=>a!==e&&a.state.isPaused);return(i==null?void 0:i.continue())??Promise.resolve()}else return Promise.resolve()}clear(){vn.batch(()=>{Z(this,ms).forEach(e=>{this.notify({type:\"removed\",mutation:e})}),Z(this,ms).clear(),Z(this,Ka).clear()})}getAll(){return Array.from(Z(this,ms))}find(e){const r={exact:!0,...e};return this.getAll().find(n=>Nk(r,n))}findAll(e={}){return this.getAll().filter(r=>Nk(e,r))}notify(e){vn.batch(()=>{this.listeners.forEach(r=>{r(e)})})}resumePausedMutations(){const e=this.getAll().filter(r=>r.state.isPaused);return vn.batch(()=>Promise.all(e.map(r=>r.continue().catch(gi))))}},ms=new WeakMap,Ka=new WeakMap,a0=new WeakMap,VF);function Hg(t){var e;return(e=t.options.scope)==null?void 0:e.id}var gs,Tl,Di,vs,Os,Cv,GA,UF,hre=(UF=class extends zf{constructor(r,n){super();rt(this,Os);rt(this,gs);rt(this,Tl);rt(this,Di);rt(this,vs);Le(this,gs,r),this.setOptions(n),this.bindMethods(),St(this,Os,Cv).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var i;const n=this.options;this.options=Z(this,gs).defaultMutationOptions(r),$v(this.options,n)||Z(this,gs).getMutationCache().notify({type:\"observerOptionsUpdated\",mutation:Z(this,Di),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&lu(n.mutationKey)!==lu(this.options.mutationKey)?this.reset():((i=Z(this,Di))==null?void 0:i.state.status)===\"pending\"&&Z(this,Di).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=Z(this,Di))==null||r.removeObserver(this)}onMutationUpdate(r){St(this,Os,Cv).call(this),St(this,Os,GA).call(this,r)}getCurrentResult(){return Z(this,Tl)}reset(){var r;(r=Z(this,Di))==null||r.removeObserver(this),Le(this,Di,void 0),St(this,Os,Cv).call(this),St(this,Os,GA).call(this)}mutate(r,n){var i;return Le(this,vs,n),(i=Z(this,Di))==null||i.removeObserver(this),Le(this,Di,Z(this,gs).getMutationCache().build(Z(this,gs),this.options)),Z(this,Di).addObserver(this),Z(this,Di).execute(r)}},gs=new WeakMap,Tl=new WeakMap,Di=new WeakMap,vs=new WeakMap,Os=new WeakSet,Cv=function(){var n;const r=((n=Z(this,Di))==null?void 0:n.state)??VV();Le(this,Tl,{...r,isPending:r.status===\"pending\",isSuccess:r.status===\"success\",isError:r.status===\"error\",isIdle:r.status===\"idle\",mutate:this.mutate,reset:this.reset})},GA=function(r){vn.batch(()=>{var n,i,a,o,s,c,u,f;if(Z(this,vs)&&this.hasListeners()){const h=Z(this,Tl).variables,m=Z(this,Tl).context,g={client:Z(this,gs),meta:this.options.meta,mutationKey:this.options.mutationKey};(r==null?void 0:r.type)===\"success\"?((i=(n=Z(this,vs)).onSuccess)==null||i.call(n,r.data,h,m,g),(o=(a=Z(this,vs)).onSettled)==null||o.call(a,r.data,null,h,m,g)):(r==null?void 0:r.type)===\"error\"&&((c=(s=Z(this,vs)).onError)==null||c.call(s,r.error,h,m,g),(f=(u=Z(this,vs)).onSettled)==null||f.call(u,void 0,r.error,h,m,g))}this.listeners.forEach(h=>{h(Z(this,Tl))})})},UF),Eo,zF,pre=(zF=class extends zf{constructor(e={}){super();rt(this,Eo);this.config=e,Le(this,Eo,new Map)}build(e,r,n){const i=r.queryKey,a=r.queryHash??Cj(i,r);let o=this.get(a);return o||(o=new ore({client:e,queryKey:i,queryHash:a,options:e.defaultQueryOptions(r),state:n,defaultOptions:e.getQueryDefaults(i)}),this.add(o)),o}add(e){Z(this,Eo).has(e.queryHash)||(Z(this,Eo).set(e.queryHash,e),this.notify({type:\"added\",query:e}))}remove(e){const r=Z(this,Eo).get(e.queryHash);r&&(e.destroy(),r===e&&Z(this,Eo).delete(e.queryHash),this.notify({type:\"removed\",query:e}))}clear(){vn.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return Z(this,Eo).get(e)}getAll(){return[...Z(this,Eo).values()]}find(e){const r={exact:!0,...e};return this.getAll().find(n=>Ak(r,n))}findAll(e={}){const r=this.getAll();return Object.keys(e).length>0?r.filter(n=>Ak(e,n)):r}notify(e){vn.batch(()=>{this.listeners.forEach(r=>{r(e)})})}onFocus(){vn.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){vn.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Eo=new WeakMap,zF),Lr,Pl,Ol,tf,rf,kl,nf,af,WF,mre=(WF=class{constructor(t={}){rt(this,Lr);rt(this,Pl);rt(this,Ol);rt(this,tf);rt(this,rf);rt(this,kl);rt(this,nf);rt(this,af);Le(this,Lr,t.queryCache||new pre),Le(this,Pl,t.mutationCache||new fre),Le(this,Ol,t.defaultOptions||{}),Le(this,tf,new Map),Le(this,rf,new Map),Le(this,kl,0)}mount(){zg(this,kl)._++,Z(this,kl)===1&&(Le(this,nf,Nj.subscribe(async t=>{t&&(await this.resumePausedMutations(),Z(this,Lr).onFocus())})),Le(this,af,Vv.subscribe(async t=>{t&&(await this.resumePausedMutations(),Z(this,Lr).onOnline())})))}unmount(){var t,e;zg(this,kl)._--,Z(this,kl)===0&&((t=Z(this,nf))==null||t.call(this),Le(this,nf,void 0),(e=Z(this,af))==null||e.call(this),Le(this,af,void 0))}isFetching(t){return Z(this,Lr).findAll({...t,fetchStatus:\"fetching\"}).length}isMutating(t){return Z(this,Pl).findAll({...t,status:\"pending\"}).length}getQueryData(t){var r;const e=this.defaultQueryOptions({queryKey:t});return(r=Z(this,Lr).get(e.queryHash))==null?void 0:r.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),r=Z(this,Lr).build(this,e),n=r.state.data;return n===void 0?this.fetchQuery(t):(t.revalidateIfStale&&r.isStaleByTime(Rl(e.staleTime,r))&&this.prefetchQuery(e),Promise.resolve(n))}getQueriesData(t){return Z(this,Lr).findAll(t).map(({queryKey:e,state:r})=>{const n=r.data;return[e,n]})}setQueryData(t,e,r){const n=this.defaultQueryOptions({queryKey:t}),i=Z(this,Lr).get(n.queryHash),a=i==null?void 0:i.state.data,o=Yte(e,a);if(o!==void 0)return Z(this,Lr).build(this,n).setData(o,{...r,manual:!0})}setQueriesData(t,e,r){return vn.batch(()=>Z(this,Lr).findAll(t).map(({queryKey:n})=>[n,this.setQueryData(n,e,r)]))}getQueryState(t){var r;const e=this.defaultQueryOptions({queryKey:t});return(r=Z(this,Lr).get(e.queryHash))==null?void 0:r.state}removeQueries(t){const e=Z(this,Lr);vn.batch(()=>{e.findAll(t).forEach(r=>{e.remove(r)})})}resetQueries(t,e){const r=Z(this,Lr);return vn.batch(()=>(r.findAll(t).forEach(n=>{n.reset()}),this.refetchQueries({type:\"active\",...t},e)))}cancelQueries(t,e={}){const r={revert:!0,...e},n=vn.batch(()=>Z(this,Lr).findAll(t).map(i=>i.cancel(r)));return Promise.all(n).then(gi).catch(gi)}invalidateQueries(t,e={}){return vn.batch(()=>(Z(this,Lr).findAll(t).forEach(r=>{r.invalidate()}),(t==null?void 0:t.refetchType)===\"none\"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??\"active\"},e)))}refetchQueries(t,e={}){const r={...e,cancelRefetch:e.cancelRefetch??!0},n=vn.batch(()=>Z(this,Lr).findAll(t).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let a=i.fetch(void 0,r);return r.throwOnError||(a=a.catch(gi)),i.state.fetchStatus===\"paused\"?Promise.resolve():a}));return Promise.all(n).then(gi)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const r=Z(this,Lr).build(this,e);return r.isStaleByTime(Rl(e.staleTime,r))?r.fetch(e):Promise.resolve(r.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(gi).catch(gi)}fetchInfiniteQuery(t){return t.behavior=kk(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(gi).catch(gi)}ensureInfiniteQueryData(t){return t.behavior=kk(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return Vv.isOnline()?Z(this,Pl).resumePausedMutations():Promise.resolve()}getQueryCache(){return Z(this,Lr)}getMutationCache(){return Z(this,Pl)}getDefaultOptions(){return Z(this,Ol)}setDefaultOptions(t){Le(this,Ol,t)}setQueryDefaults(t,e){Z(this,tf).set(lu(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...Z(this,tf).values()],r={};return e.forEach(n=>{Wp(t,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(t,e){Z(this,rf).set(lu(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...Z(this,rf).values()],r={};return e.forEach(n=>{Wp(t,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(t){if(t._defaulted)return t;const e={...Z(this,Ol).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Cj(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!==\"always\"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode=\"offlineFirst\"),e.queryFn===Aj&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...Z(this,Ol).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){Z(this,Lr).clear(),Z(this,Pl).clear()}},Lr=new WeakMap,Pl=new WeakMap,Ol=new WeakMap,tf=new WeakMap,rf=new WeakMap,kl=new WeakMap,nf=new WeakMap,af=new WeakMap,WF),E=jx();const G=or(E),jj=Lte({__proto__:null,default:G},[E]);var UV=E.createContext(void 0),la=t=>{const e=E.useContext(UV);if(!e)throw new Error(\"No QueryClient set, use QueryClientProvider to set one\");return e},gre=({client:t,children:e})=>(E.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),l.jsx(UV.Provider,{value:t,children:e})),zV=E.createContext(!1),vre=()=>E.useContext(zV);zV.Provider;function yre(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var xre=E.createContext(yre()),bre=()=>E.useContext(xre),wre=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},Sre=t=>{E.useEffect(()=>{t.clearReset()},[t])},_re=({result:t,errorResetBoundary:e,throwOnError:r,query:n,suspense:i})=>t.isError&&!e.isReset()&&!t.isFetching&&n&&(i&&t.data===void 0||DV(r,[t.error,n])),Cre=t=>{if(t.suspense){const r=i=>i===\"static\"?i:Math.max(i??1e3,1e3),n=t.staleTime;t.staleTime=typeof n==\"function\"?(...i)=>r(n(...i)):r(n),typeof t.gcTime==\"number\"&&(t.gcTime=Math.max(t.gcTime,1e3))}},Are=(t,e)=>t.isLoading&&t.isFetching&&!e,Nre=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,Mk=(t,e,r)=>e.fetchOptimistic(t).catch(()=>{r.clearReset()});function Ere(t,e,r){var h,m,g,x,v;const n=vre(),i=bre(),a=la(),o=a.defaultQueryOptions(t);(m=(h=a.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||m.call(h,o),o._optimisticResults=n?\"isRestoring\":\"optimistic\",Cre(o),wre(o,i),Sre(i);const s=!a.getQueryCache().get(o.queryHash),[c]=E.useState(()=>new e(a,o)),u=c.getOptimisticResult(o),f=!n&&t.subscribed!==!1;if(E.useSyncExternalStore(E.useCallback(b=>{const w=f?c.subscribe(vn.batchCalls(b)):gi;return c.updateResult(),w},[c,f]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),E.useEffect(()=>{c.setOptions(o)},[o,c]),Nre(o,u))throw Mk(o,c,i);if(_re({result:u,errorResetBoundary:i,throwOnError:o.throwOnError,query:a.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw u.error;if((x=(g=a.getDefaultOptions().queries)==null?void 0:g._experimental_afterQuery)==null||x.call(g,o,u),o.experimental_prefetchInRender&&!su&&Are(u,n)){const b=s?Mk(o,c,i):(v=a.getQueryCache().get(o.queryHash))==null?void 0:v.promise;b==null||b.catch(gi).finally(()=>{c.updateResult()})}return o.notifyOnChangeProps?u:c.trackResult(u)}function Tr(t,e){return Ere(t,sre)}function Wr(t,e){const r=la(),[n]=E.useState(()=>new hre(r,t));E.useEffect(()=>{n.setOptions(t)},[n,t]);const i=E.useSyncExternalStore(E.useCallback(o=>n.subscribe(vn.batchCalls(o)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),a=E.useCallback((o,s)=>{n.mutate(o,s).catch(gi)},[n]);if(i.error&&DV(n.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:a,mutateAsync:i.mutate}}async function WV(t){if(!t.ok){const e=await t.text()||t.statusText;throw new Error(`${t.status}: ${e}`)}}async function Sr(t,e,r){const n=await fetch(e,{method:t,headers:r?{\"Content-Type\":\"application/json\"}:{},body:r?JSON.stringify(r):void 0,credentials:\"include\"});return await WV(n),n}const Uv=({on401:t})=>async({queryKey:e})=>{const r=await fetch(e.join(\"/\"),{credentials:\"include\"});return t===\"returnNull\"&&r.status===401?null:(await WV(r),await r.json())},qV=new mre({defaultOptions:{queries:{queryFn:Uv({on401:\"throw\"}),refetchInterval:!1,refetchOnWindowFocus:!1,refetchOnMount:!1,staleTime:300*1e3,retry:!1},mutations:{retry:!1}}});class jre extends E.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return console.error(\"ðŸš¨ React Error Boundary caught error:\",e),{hasError:!0,error:e}}componentDidCatch(e,r){console.error(\"ðŸš¨ Error details:\",e,r)}render(){return this.state.hasError?this.props.fallback||l.jsx(\"div\",{className:\"min-h-screen flex items-center justify-center p-4\",style:{background:\"var(--bg-gradient)\"},children:l.jsxs(\"div\",{className:\"bg-white/10 backdrop-blur-sm rounded-xl p-6 max-w-md text-center\",children:[l.jsx(\"h2\",{className:\"text-xl font-bold text-white mb-2\",children:\"âš ï¸ Something went wrong\"}),l.jsx(\"p\",{className:\"text-gray-300 mb-4\",children:\"The app encountered an error. Please refresh the page.\"}),l.jsx(\"button\",{onClick:()=>window.location.reload(),className:\"bg-blue-600 hover:bg-blue-500 text-white px-6 py-2 rounded-lg font-medium\",children:\"Reload App\"})]})}):this.props.children}}function Tre(t,e){if(t instanceof RegExp)return{keys:!1,pattern:t};var r,n,i,a,o=[],s=\"\",c=t.split(\"/\");for(c[0]||c.shift();i=c.shift();)r=i[0],r===\"*\"?(o.push(r),s+=i[1]===\"?\"?\"(?:/(.*))?\":\"/(.*)\"):r===\":\"?(n=i.indexOf(\"?\",1),a=i.indexOf(\".\",1),o.push(i.substring(1,~n?n:~a?a:i.length)),s+=~n&&!~a?\"(?:/([^/]+?))?\":\"/([^/]+?)\",~a&&(s+=(~n?\"?\":\"\")+\"\\\\\"+i.substring(a))):s+=\"/\"+i;return{keys:o,pattern:new RegExp(\"^\"+s+(e?\"(?=$|/)\":\"/?$\"),\"i\")}}var $w={exports:{}},Vw={};/**\n * @license React\n * use-sync-external-store-shim.production.js\n *\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */var Dk;function Pre(){if(Dk)return Vw;Dk=1;var t=jx();function e(h,m){return h===m&&(h!==0||1/h===1/m)||h!==h&&m!==m}var r=typeof Object.is==\"function\"?Object.is:e,n=t.useState,i=t.useEffect,a=t.useLayoutEffect,o=t.useDebugValue;function s(h,m){var g=m(),x=n({inst:{value:g,getSnapshot:m}}),v=x[0].inst,b=x[1];return a(function(){v.value=g,v.getSnapshot=m,c(v)&&b({inst:v})},[h,g,m]),i(function(){return c(v)&&b({inst:v}),h(function(){c(v)&&b({inst:v})})},[h]),o(g),g}function c(h){var m=h.getSnapshot;h=h.value;try{var g=m();return!r(h,g)}catch{return!0}}function u(h,m){return m()}var f=typeof window>\"u\"||typeof window.document>\"u\"||typeof window.document.createElement>\"u\"?u:s;return Vw.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:f,Vw}var Rk;function Ore(){return Rk||(Rk=1,$w.exports=Pre()),$w.exports}var kre=Ore();const Ire=jj.useInsertionEffect,Mre=typeof window<\"u\"&&typeof window.document<\"u\"&&typeof window.document.createElement<\"u\",Dre=Mre?E.useLayoutEffect:E.useEffect,Rre=Ire||Dre,HV=t=>{const e=E.useRef([t,(...r)=>e[0](...r)]).current;return Rre(()=>{e[0]=t}),e[1]},Fre=\"popstate\",Tj=\"pushState\",Pj=\"replaceState\",Lre=\"hashchange\",Fk=[Fre,Tj,Pj,Lre],Bre=t=>{for(const e of Fk)addEventListener(e,t);return()=>{for(const e of Fk)removeEventListener(e,t)}},GV=(t,e)=>kre.useSyncExternalStore(Bre,t,e),$re=()=>location.search,Vre=({ssrSearch:t=\"\"}={})=>GV($re,()=>t),Lk=()=>location.pathname,Ure=({ssrPath:t}={})=>GV(Lk,t?()=>t:Lk),zre=(t,{replace:e=!1,state:r=null}={})=>history[e?Pj:Tj](r,\"\",t),Wre=(t={})=>[Ure(t),zre],Bk=Symbol.for(\"wouter_v3\");if(typeof history<\"u\"&&typeof window[Bk]>\"u\"){for(const t of[Tj,Pj]){const e=history[t];history[t]=function(){const r=e.apply(this,arguments),n=new Event(t);return n.arguments=arguments,dispatchEvent(n),r}}Object.defineProperty(window,Bk,{value:!0})}const qre=(t,e)=>e.toLowerCase().indexOf(t.toLowerCase())?\"~\"+e:e.slice(t.length)||\"/\",KV=(t=\"\")=>t===\"/\"?\"\":t,Hre=(t,e)=>t[0]===\"~\"?t.slice(1):KV(e)+t,Gre=(t=\"\",e)=>qre($k(KV(t)),$k(e)),$k=t=>{try{return decodeURI(t)}catch{return t}},XV={hook:Wre,searchHook:Vre,parser:Tre,base:\"\",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:t=>t},YV=E.createContext(XV),o0=()=>E.useContext(YV),ZV={},QV=E.createContext(ZV),Kre=()=>E.useContext(QV),Tx=t=>{const[e,r]=t.hook(t);return[Gre(t.base,e),HV((n,i)=>r(Hre(n,t.base),i))]},Oj=()=>Tx(o0()),JV=(t,e,r,n)=>{const{pattern:i,keys:a}=e instanceof RegExp?{keys:!1,pattern:e}:t(e||\"*\",n),o=i.exec(r)||[],[s,...c]=o;return s!==void 0?[!0,(()=>{const u=a!==!1?Object.fromEntries(a.map((h,m)=>[h,c[m]])):o.groups;let f={...c};return u&&Object.assign(f,u),f})(),...n?[s]:[]]:[!1,null]},Xre=({children:t,...e})=>{var f,h;const r=o0(),n=e.hook?XV:r;let i=n;const[a,o]=((f=e.ssrPath)==null?void 0:f.split(\"?\"))??[];o&&(e.ssrSearch=o,e.ssrPath=a),e.hrefs=e.hrefs??((h=e.hook)==null?void 0:h.hrefs);let s=E.useRef({}),c=s.current,u=c;for(let m in n){const g=m===\"base\"?n[m]+(e[m]||\"\"):e[m]||n[m];c===u&&g!==u[m]&&(s.current=u={...u}),u[m]=g,(g!==n[m]||g!==i[m])&&(i=u)}return E.createElement(YV.Provider,{value:i,children:t})},Vk=({children:t,component:e},r)=>e?E.createElement(e,{params:r}):typeof t==\"function\"?t(r):t,Yre=t=>{let e=E.useRef(ZV);const r=e.current;return e.current=Object.keys(t).length!==Object.keys(r).length||Object.entries(t).some(([n,i])=>i!==r[n])?t:r},Jr=({path:t,nest:e,match:r,...n})=>{const i=o0(),[a]=Tx(i),[o,s,c]=r??JV(i.parser,t,a,e),u=Yre({...Kre(),...s});if(!o)return null;const f=c?E.createElement(Xre,{base:c},Vk(n,u)):Vk(n,u);return E.createElement(QV.Provider,{value:u,children:f})},nr=E.forwardRef((t,e)=>{const r=o0(),[n,i]=Tx(r),{to:a=\"\",href:o=a,onClick:s,asChild:c,children:u,className:f,replace:h,state:m,...g}=t,x=HV(b=>{b.ctrlKey||b.metaKey||b.altKey||b.shiftKey||b.button!==0||(s==null||s(b),b.defaultPrevented||(b.preventDefault(),i(o,t)))}),v=r.hrefs(o[0]===\"~\"?o.slice(1):r.base+o,r);return c&&E.isValidElement(u)?E.cloneElement(u,{onClick:x,href:v}):E.createElement(\"a\",{...g,onClick:x,href:v,className:f!=null&&f.call?f(n===o):f,children:u,ref:e})}),eU=t=>Array.isArray(t)?t.flatMap(e=>eU(e&&e.type===E.Fragment?e.props.children:e)):[t],Zre=({children:t,location:e})=>{const r=o0(),[n]=Tx(r);for(const i of eU(t)){let a=0;if(E.isValidElement(i)&&(a=JV(r.parser,i.props.path,e||n,i.props.nest))[0])return E.cloneElement(i,{match:a})}return null};function Wf(){const{data:t,isLoading:e,error:r}=Tr({queryKey:[\"/api/user\"],queryFn:Uv({on401:\"returnNull\"}),retry:!1,refetchOnWindowFocus:!1,refetchOnMount:!1,staleTime:3e5});return r&&console.error(\"âš ï¸ Auth check error (non-fatal):\",r),{user:t,isLoading:e,isAuthenticated:!!t,requiresLogin:!t&&!e}}const Qre=\"modulepreload\",Jre=function(t){return\"/\"+t},Uk={},qf=function(e,r,n){let i=Promise.resolve();if(r&&r.length>0){let o=function(u){return Promise.all(u.map(f=>Promise.resolve(f).then(h=>({status:\"fulfilled\",value:h}),h=>({status:\"rejected\",reason:h}))))};document.getElementsByTagName(\"link\");const s=document.querySelector(\"meta[property=csp-nonce]\"),c=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute(\"nonce\"));i=o(r.map(u=>{if(u=Jre(u),u in Uk)return;Uk[u]=!0;const f=u.endsWith(\".css\"),h=f?'[rel=\"stylesheet\"]':\"\";if(document.querySelector(`link[href=\"${u}\"]${h}`))return;const m=document.createElement(\"link\");if(m.rel=f?\"stylesheet\":Qre,f||(m.as=\"script\"),m.crossOrigin=\"\",m.href=u,c&&m.setAttribute(\"nonce\",c),document.head.appendChild(m),f)return new Promise((g,x)=>{m.addEventListener(\"load\",g),m.addEventListener(\"error\",()=>x(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(o){const s=new Event(\"vite:preloadError\",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o}return i.then(o=>{for(const s of o||[])s.status===\"rejected\"&&a(s.reason);return e().catch(a)})};/*! Capacitor: https://capacitorjs.com/ - MIT License */var of;(function(t){t.Unimplemented=\"UNIMPLEMENTED\",t.Unavailable=\"UNAVAILABLE\"})(of||(of={}));class Od extends Error{constructor(e,r,n){super(e),this.message=e,this.code=r,this.data=n}}const ene=t=>{var e,r;return t!=null&&t.androidBridge?\"android\":!((r=(e=t==null?void 0:t.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||r===void 0)&&r.bridge?\"ios\":\"web\"},tne=t=>{const e=t.CapacitorCustomPlatform||null,r=t.Capacitor||{},n=r.Plugins=r.Plugins||{},i=()=>e!==null?e.name:ene(t),a=()=>i()!==\"web\",o=h=>{const m=u.get(h);return!!(m!=null&&m.platforms.has(i())||s(h))},s=h=>{var m;return(m=r.PluginHeaders)===null||m===void 0?void 0:m.find(g=>g.name===h)},c=h=>t.console.error(h),u=new Map,f=(h,m={})=>{const g=u.get(h);if(g)return console.warn(`Capacitor plugin \"${h}\" already registered. Cannot register plugins twice.`),g.proxy;const x=i(),v=s(h);let b;const w=async()=>(!b&&x in m?b=typeof m[x]==\"function\"?b=await m[x]():b=m[x]:e!==null&&!b&&\"web\"in m&&(b=typeof m.web==\"function\"?b=await m.web():b=m.web),b),C=(k,I)=>{var R,F;if(v){const D=v==null?void 0:v.methods.find(L=>I===L.name);if(D)return D.rtype===\"promise\"?L=>r.nativePromise(h,I.toString(),L):(L,q)=>r.nativeCallback(h,I.toString(),L,q);if(k)return(R=k[I])===null||R===void 0?void 0:R.bind(k)}else{if(k)return(F=k[I])===null||F===void 0?void 0:F.bind(k);throw new Od(`\"${h}\" plugin is not implemented on ${x}`,of.Unimplemented)}},_=k=>{let I;const R=(...F)=>{const D=w().then(L=>{const q=C(L,k);if(q){const W=q(...F);return I=W==null?void 0:W.remove,W}else throw new Od(`\"${h}.${k}()\" is not implemented on ${x}`,of.Unimplemented)});return k===\"addListener\"&&(D.remove=async()=>I()),D};return R.toString=()=>`${k.toString()}() { [capacitor code] }`,Object.defineProperty(R,\"name\",{value:k,writable:!1,configurable:!1}),R},N=_(\"addListener\"),A=_(\"removeListener\"),T=(k,I)=>{const R=N({eventName:k},I),F=async()=>{const L=await R;A({eventName:k,callbackId:L},I)},D=new Promise(L=>R.then(()=>L({remove:F})));return D.remove=async()=>{console.warn(\"Using addListener() without 'await' is deprecated.\"),await F()},D},P=new Proxy({},{get(k,I){switch(I){case\"$$typeof\":return;case\"toJSON\":return()=>({});case\"addListener\":return v?T:N;case\"removeListener\":return A;default:return _(I)}}});return n[h]=P,u.set(h,{name:h,proxy:P,platforms:new Set([...Object.keys(m),...v?[x]:[]])}),P};return r.convertFileSrc||(r.convertFileSrc=h=>h),r.getPlatform=i,r.handleError=c,r.isNativePlatform=a,r.isPluginAvailable=o,r.registerPlugin=f,r.Exception=Od,r.DEBUG=!!r.DEBUG,r.isLoggingEnabled=!!r.isLoggingEnabled,r},rne=t=>t.Capacitor=tne(t),Pn=rne(typeof globalThis<\"u\"?globalThis:typeof self<\"u\"?self:typeof window<\"u\"?window:typeof global<\"u\"?global:{}),Nu=Pn.registerPlugin;class kj{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,r){let n=!1;this.listeners[e]||(this.listeners[e]=[],n=!0),this.listeners[e].push(r);const a=this.windowListeners[e];a&&!a.registered&&this.addWindowListener(a),n&&this.sendRetainedArgumentsForEvent(e);const o=async()=>this.removeListener(e,r);return Promise.resolve({remove:o})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,r,n){const i=this.listeners[e];if(!i){if(n){let a=this.retainedEventArguments[e];a||(a=[]),a.push(r),this.retainedEventArguments[e]=a}return}i.forEach(a=>a(r))}hasListeners(e){var r;return!!(!((r=this.listeners[e])===null||r===void 0)&&r.length)}registerWindowListener(e,r){this.windowListeners[r]={registered:!1,windowEventName:e,pluginEventName:r,handler:n=>{this.notifyListeners(r,n)}}}unimplemented(e=\"not implemented\"){return new Pn.Exception(e,of.Unimplemented)}unavailable(e=\"not available\"){return new Pn.Exception(e,of.Unavailable)}async removeListener(e,r){const n=this.listeners[e];if(!n)return;const i=n.indexOf(r);this.listeners[e].splice(i,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const r=this.retainedEventArguments[e];r&&(delete this.retainedEventArguments[e],r.forEach(n=>{this.notifyListeners(e,n)}))}}const zk=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Wk=t=>t.replace(/(%[\\dA-F]{2})+/gi,decodeURIComponent);class nne extends kj{async getCookies(){const e=document.cookie,r={};return e.split(\";\").forEach(n=>{if(n.length<=0)return;let[i,a]=n.replace(/=/,\"CAP_COOKIE\").split(\"CAP_COOKIE\");i=Wk(i).trim(),a=Wk(a).trim(),r[i]=a}),r}async setCookie(e){try{const r=zk(e.key),n=zk(e.value),i=`; expires=${(e.expires||\"\").replace(\"expires=\",\"\")}`,a=(e.path||\"/\").replace(\"path=\",\"\"),o=e.url!=null&&e.url.length>0?`domain=${e.url}`:\"\";document.cookie=`${r}=${n||\"\"}${i}; path=${a}; ${o};`}catch(r){return Promise.reject(r)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(r){return Promise.reject(r)}}async clearCookies(){try{const e=document.cookie.split(\";\")||[];for(const r of e)document.cookie=r.replace(/^ +/,\"\").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}Nu(\"CapacitorCookies\",{web:()=>new nne});const ine=async t=>new Promise((e,r)=>{const n=new FileReader;n.onload=()=>{const i=n.result;e(i.indexOf(\",\")>=0?i.split(\",\")[1]:i)},n.onerror=i=>r(i),n.readAsDataURL(t)}),ane=(t={})=>{const e=Object.keys(t);return Object.keys(t).map(i=>i.toLocaleLowerCase()).reduce((i,a,o)=>(i[a]=t[e[o]],i),{})},one=(t,e=!0)=>t?Object.entries(t).reduce((n,i)=>{const[a,o]=i;let s,c;return Array.isArray(o)?(c=\"\",o.forEach(u=>{s=e?encodeURIComponent(u):u,c+=`${a}=${s}&`}),c.slice(0,-1)):(s=e?encodeURIComponent(o):o,c=`${a}=${s}`),`${n}&${c}`},\"\").substr(1):null,sne=(t,e={})=>{const r=Object.assign({method:t.method||\"GET\",headers:t.headers},e),i=ane(t.headers)[\"content-type\"]||\"\";if(typeof t.data==\"string\")r.body=t.data;else if(i.includes(\"application/x-www-form-urlencoded\")){const a=new URLSearchParams;for(const[o,s]of Object.entries(t.data||{}))a.set(o,s);r.body=a.toString()}else if(i.includes(\"multipart/form-data\")||t.data instanceof FormData){const a=new FormData;if(t.data instanceof FormData)t.data.forEach((s,c)=>{a.append(c,s)});else for(const s of Object.keys(t.data))a.append(s,t.data[s]);r.body=a;const o=new Headers(r.headers);o.delete(\"content-type\"),r.headers=o}else(i.includes(\"application/json\")||typeof t.data==\"object\")&&(r.body=JSON.stringify(t.data));return r};class lne extends kj{async request(e){const r=sne(e,e.webFetchExtra),n=one(e.params,e.shouldEncodeUrlParams),i=n?`${e.url}?${n}`:e.url,a=await fetch(i,r),o=a.headers.get(\"content-type\")||\"\";let{responseType:s=\"text\"}=a.ok?e:{};o.includes(\"application/json\")&&(s=\"json\");let c,u;switch(s){case\"arraybuffer\":case\"blob\":u=await a.blob(),c=await ine(u);break;case\"json\":c=await a.json();break;case\"document\":case\"text\":default:c=await a.text()}const f={};return a.headers.forEach((h,m)=>{f[m]=h}),{data:c,headers:f,status:a.status,url:a.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:\"GET\"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:\"POST\"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:\"PUT\"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:\"PATCH\"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:\"DELETE\"}))}}Nu(\"CapacitorHttp\",{web:()=>new lne});const cne=Nu(\"App\",{web:()=>qf(()=>import(\"./web-B1u9ZI0p.js\"),[]).then(t=>new t.AppWeb)}),qp=Nu(\"Browser\",{web:()=>qf(()=>import(\"./web-xwe1Y9Sz.js\"),[]).then(t=>new t.BrowserWeb)}),une=1,dne=1e6;let Uw=0;function fne(){return Uw=(Uw+1)%Number.MAX_SAFE_INTEGER,Uw.toString()}const zw=new Map,qk=t=>{if(zw.has(t))return;const e=setTimeout(()=>{zw.delete(t),Tp({type:\"REMOVE_TOAST\",toastId:t})},dne);zw.set(t,e)},hne=(t,e)=>{switch(e.type){case\"ADD_TOAST\":return{...t,toasts:[e.toast,...t.toasts].slice(0,une)};case\"UPDATE_TOAST\":return{...t,toasts:t.toasts.map(r=>r.id===e.toast.id?{...r,...e.toast}:r)};case\"DISMISS_TOAST\":{const{toastId:r}=e;return r?qk(r):t.toasts.forEach(n=>{qk(n.id)}),{...t,toasts:t.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case\"REMOVE_TOAST\":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(r=>r.id!==e.toastId)}}},Av=[];let Nv={toasts:[]};function Tp(t){Nv=hne(Nv,t),Av.forEach(e=>{e(Nv)})}function pne({...t}){const e=fne(),r=i=>Tp({type:\"UPDATE_TOAST\",toast:{...i,id:e}}),n=()=>Tp({type:\"DISMISS_TOAST\",toastId:e});return Tp({type:\"ADD_TOAST\",toast:{...t,id:e,open:!0,onOpenChange:i=>{i||n()}}}),{id:e,dismiss:n,update:r}}function Wn(){const[t,e]=E.useState(Nv);return E.useEffect(()=>(Av.push(e),()=>{const r=Av.indexOf(e);r>-1&&Av.splice(r,1)}),[t]),{...t,toast:pne,dismiss:r=>Tp({type:\"DISMISS_TOAST\",toastId:r})}}/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const mne=t=>t.replace(/([a-z0-9])([A-Z])/g,\"$1-$2\").toLowerCase(),tU=(...t)=>t.filter((e,r,n)=>!!e&&n.indexOf(e)===r).join(\" \");/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */var gne={xmlns:\"http://www.w3.org/2000/svg\",width:24,height:24,viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:2,strokeLinecap:\"round\",strokeLinejoin:\"round\"};/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const vne=E.forwardRef(({color:t=\"currentColor\",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i=\"\",children:a,iconNode:o,...s},c)=>E.createElement(\"svg\",{ref:c,...gne,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:tU(\"lucide\",i),...s},[...o.map(([u,f])=>E.createElement(u,f)),...Array.isArray(a)?a:[a]]));/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Ne=(t,e)=>{const r=E.forwardRef(({className:n,...i},a)=>E.createElement(vne,{ref:a,iconNode:e,className:tU(`lucide-${mne(t)}`,n),...i}));return r.displayName=`${t}`,r};/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Ev=Ne(\"Activity\",[[\"path\",{d:\"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2\",key:\"169zse\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const zv=Ne(\"Apple\",[[\"path\",{d:\"M12 20.94c1.5 0 2.75 1.06 4 1.06 3 0 6-8 6-12.22A4.91 4.91 0 0 0 17 5c-2.22 0-4 1.44-5 2-1-.56-2.78-2-5-2a4.9 4.9 0 0 0-5 4.78C2 14 5 22 8 22c1.25 0 2.5-1.06 4-1.06Z\",key:\"3s7exb\"}],[\"path\",{d:\"M10 2c1 .5 2 2 2 5\",key:\"fcco2y\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Ko=Ne(\"ArrowLeft\",[[\"path\",{d:\"m12 19-7-7 7-7\",key:\"1l729n\"}],[\"path\",{d:\"M19 12H5\",key:\"x3x0zl\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const yne=Ne(\"ArrowRight\",[[\"path\",{d:\"M5 12h14\",key:\"1ays0h\"}],[\"path\",{d:\"m12 5 7 7-7 7\",key:\"xquz4c\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const xne=Ne(\"AudioLines\",[[\"path\",{d:\"M2 10v3\",key:\"1fnikh\"}],[\"path\",{d:\"M6 6v11\",key:\"11sgs0\"}],[\"path\",{d:\"M10 3v18\",key:\"yhl04a\"}],[\"path\",{d:\"M14 8v7\",key:\"3a1oy3\"}],[\"path\",{d:\"M18 5v13\",key:\"123xd1\"}],[\"path\",{d:\"M22 10v3\",key:\"154ddg\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const sf=Ne(\"Award\",[[\"path\",{d:\"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526\",key:\"1yiouv\"}],[\"circle\",{cx:\"12\",cy:\"8\",r:\"6\",key:\"1vp47v\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Hp=Ne(\"Beef\",[[\"circle\",{cx:\"12.5\",cy:\"8.5\",r:\"2.5\",key:\"9738u8\"}],[\"path\",{d:\"M12.5 2a6.5 6.5 0 0 0-6.22 4.6c-1.1 3.13-.78 3.9-3.18 6.08A3 3 0 0 0 5 18c4 0 8.4-1.8 11.4-4.3A6.5 6.5 0 0 0 12.5 2Z\",key:\"o0f6za\"}],[\"path\",{d:\"m18.5 6 2.19 4.5a6.48 6.48 0 0 1 .31 2 6.49 6.49 0 0 1-2.6 5.2C15.4 20.2 11 22 7 22a3 3 0 0 1-2.68-1.66L2.4 16.5\",key:\"k7p6i0\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const KA=Ne(\"Beer\",[[\"path\",{d:\"M17 11h1a3 3 0 0 1 0 6h-1\",key:\"1yp76v\"}],[\"path\",{d:\"M9 12v6\",key:\"1u1cab\"}],[\"path\",{d:\"M13 12v6\",key:\"1sugkk\"}],[\"path\",{d:\"M14 7.5c-1 0-1.44.5-3 .5s-2-.5-3-.5-1.72.5-2.5.5a2.5 2.5 0 0 1 0-5c.78 0 1.57.5 2.5.5S9.44 2 11 2s2 1.5 3 1.5 1.72-.5 2.5-.5a2.5 2.5 0 0 1 0 5c-.78 0-1.5-.5-2.5-.5Z\",key:\"1510fo\"}],[\"path\",{d:\"M5 8v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V8\",key:\"19jb7n\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Hk=Ne(\"Bell\",[[\"path\",{d:\"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9\",key:\"1qo2s2\"}],[\"path\",{d:\"M10.3 21a1.94 1.94 0 0 0 3.4 0\",key:\"qgo35s\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Wv=Ne(\"BookOpen\",[[\"path\",{d:\"M12 7v14\",key:\"1akyts\"}],[\"path\",{d:\"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z\",key:\"ruj8y\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Px=Ne(\"Book\",[[\"path\",{d:\"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20\",key:\"k3hazp\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const bne=Ne(\"Bookmark\",[[\"path\",{d:\"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z\",key:\"1fy3hk\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Gk=Ne(\"Bot\",[[\"path\",{d:\"M12 8V4H8\",key:\"hb8ula\"}],[\"rect\",{width:\"16\",height:\"12\",x:\"4\",y:\"8\",rx:\"2\",key:\"enze0r\"}],[\"path\",{d:\"M2 14h2\",key:\"vft8re\"}],[\"path\",{d:\"M20 14h2\",key:\"4cs60a\"}],[\"path\",{d:\"M15 13v2\",key:\"1xurst\"}],[\"path\",{d:\"M9 13v2\",key:\"rq6x2g\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const cu=Ne(\"Brain\",[[\"path\",{d:\"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z\",key:\"l5xja\"}],[\"path\",{d:\"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z\",key:\"ep3f8r\"}],[\"path\",{d:\"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4\",key:\"1p4c4q\"}],[\"path\",{d:\"M17.599 6.5a3 3 0 0 0 .399-1.375\",key:\"tmeiqw\"}],[\"path\",{d:\"M6.003 5.125A3 3 0 0 0 6.401 6.5\",key:\"105sqy\"}],[\"path\",{d:\"M3.477 10.896a4 4 0 0 1 .585-.396\",key:\"ql3yin\"}],[\"path\",{d:\"M19.938 10.5a4 4 0 0 1 .585.396\",key:\"1qfode\"}],[\"path\",{d:\"M6 18a4 4 0 0 1-1.967-.516\",key:\"2e4loj\"}],[\"path\",{d:\"M19.967 17.484A4 4 0 0 1 18 18\",key:\"159ez6\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const lf=Ne(\"Calculator\",[[\"rect\",{width:\"16\",height:\"20\",x:\"4\",y:\"2\",rx:\"2\",key:\"1nb95v\"}],[\"line\",{x1:\"8\",x2:\"16\",y1:\"6\",y2:\"6\",key:\"x4nwl0\"}],[\"line\",{x1:\"16\",x2:\"16\",y1:\"14\",y2:\"18\",key:\"wjye3r\"}],[\"path\",{d:\"M16 10h.01\",key:\"1m94wz\"}],[\"path\",{d:\"M12 10h.01\",key:\"1nrarc\"}],[\"path\",{d:\"M8 10h.01\",key:\"19clt8\"}],[\"path\",{d:\"M12 14h.01\",key:\"1etili\"}],[\"path\",{d:\"M8 14h.01\",key:\"6423bh\"}],[\"path\",{d:\"M12 18h.01\",key:\"mhygvu\"}],[\"path\",{d:\"M8 18h.01\",key:\"lrp35t\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const no=Ne(\"Calendar\",[[\"path\",{d:\"M8 2v4\",key:\"1cmpym\"}],[\"path\",{d:\"M16 2v4\",key:\"4m81vk\"}],[\"rect\",{width:\"18\",height:\"18\",x:\"3\",y:\"4\",rx:\"2\",key:\"1hopcy\"}],[\"path\",{d:\"M3 10h18\",key:\"8toen8\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Do=Ne(\"Camera\",[[\"path\",{d:\"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z\",key:\"1tc9qg\"}],[\"circle\",{cx:\"12\",cy:\"13\",r:\"3\",key:\"1vg3eu\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const wne=Ne(\"ChartPie\",[[\"path\",{d:\"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z\",key:\"pzmjnu\"}],[\"path\",{d:\"M21.21 15.89A10 10 0 1 1 8 2.83\",key:\"k2fpak\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Cs=Ne(\"Check\",[[\"path\",{d:\"M20 6 9 17l-5-5\",key:\"1gmf2c\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Ta=Ne(\"ChefHat\",[[\"path\",{d:\"M17 21a1 1 0 0 0 1-1v-5.35c0-.457.316-.844.727-1.041a4 4 0 0 0-2.134-7.589 5 5 0 0 0-9.186 0 4 4 0 0 0-2.134 7.588c.411.198.727.585.727 1.041V20a1 1 0 0 0 1 1Z\",key:\"1qvrer\"}],[\"path\",{d:\"M6 17h12\",key:\"1jwigz\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const bs=Ne(\"ChevronDown\",[[\"path\",{d:\"m6 9 6 6 6-6\",key:\"qrunsl\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Gg=Ne(\"ChevronRight\",[[\"path\",{d:\"m9 18 6-6-6-6\",key:\"mthhwq\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Ij=Ne(\"ChevronUp\",[[\"path\",{d:\"m18 15-6-6-6 6\",key:\"153udz\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const rU=Ne(\"CircleAlert\",[[\"circle\",{cx:\"12\",cy:\"12\",r:\"10\",key:\"1mglay\"}],[\"line\",{x1:\"12\",x2:\"12\",y1:\"8\",y2:\"12\",key:\"1pkeuh\"}],[\"line\",{x1:\"12\",x2:\"12.01\",y1:\"16\",y2:\"16\",key:\"4dfq90\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Yi=Ne(\"CircleCheckBig\",[[\"path\",{d:\"M21.801 10A10 10 0 1 1 17 3.335\",key:\"yps3ct\"}],[\"path\",{d:\"m9 11 3 3L22 4\",key:\"1pflzl\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Mj=Ne(\"CircleHelp\",[[\"circle\",{cx:\"12\",cy:\"12\",r:\"10\",key:\"1mglay\"}],[\"path\",{d:\"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3\",key:\"1u773s\"}],[\"path\",{d:\"M12 17h.01\",key:\"p32p05\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const md=Ne(\"CircleX\",[[\"circle\",{cx:\"12\",cy:\"12\",r:\"10\",key:\"1mglay\"}],[\"path\",{d:\"m15 9-6 6\",key:\"1uzhvr\"}],[\"path\",{d:\"m9 9 6 6\",key:\"z0biqf\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const s0=Ne(\"Clock\",[[\"circle\",{cx:\"12\",cy:\"12\",r:\"10\",key:\"1mglay\"}],[\"polyline\",{points:\"12 6 12 12 16 14\",key:\"68esgv\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const kd=Ne(\"Coffee\",[[\"path\",{d:\"M10 2v2\",key:\"7u0qdc\"}],[\"path\",{d:\"M14 2v2\",key:\"6buw04\"}],[\"path\",{d:\"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1\",key:\"pwadti\"}],[\"path\",{d:\"M6 2v2\",key:\"colzsn\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const nU=Ne(\"Download\",[[\"path\",{d:\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\",key:\"ih7n3h\"}],[\"polyline\",{points:\"7 10 12 15 17 10\",key:\"2ggqvy\"}],[\"line\",{x1:\"12\",x2:\"12\",y1:\"15\",y2:\"3\",key:\"1vk2je\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const lo=Ne(\"Droplets\",[[\"path\",{d:\"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z\",key:\"1ptgy4\"}],[\"path\",{d:\"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97\",key:\"1sl1rz\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Dj=Ne(\"ExternalLink\",[[\"path\",{d:\"M15 3h6v6\",key:\"1q9fwt\"}],[\"path\",{d:\"M10 14 21 3\",key:\"gplh6r\"}],[\"path\",{d:\"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6\",key:\"a6xqqp\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const iU=Ne(\"FileText\",[[\"path\",{d:\"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z\",key:\"1rqfz7\"}],[\"path\",{d:\"M14 2v4a2 2 0 0 0 2 2h4\",key:\"tnqrlb\"}],[\"path\",{d:\"M10 9H8\",key:\"b1mrlr\"}],[\"path\",{d:\"M16 13H8\",key:\"t4e002\"}],[\"path\",{d:\"M16 17H8\",key:\"z1uh3a\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Rj=Ne(\"Filter\",[[\"polygon\",{points:\"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3\",key:\"1yg77f\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Ul=Ne(\"Flame\",[[\"path\",{d:\"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z\",key:\"96xj49\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const XA=Ne(\"GlassWater\",[[\"path\",{d:\"M15.2 22H8.8a2 2 0 0 1-2-1.79L5 3h14l-1.81 17.21A2 2 0 0 1 15.2 22Z\",key:\"48rfw3\"}],[\"path\",{d:\"M6 12a5 5 0 0 1 6 0 5 5 0 0 0 6 0\",key:\"mjntcy\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Gp=Ne(\"Heart\",[[\"path\",{d:\"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z\",key:\"c3ymky\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const aU=Ne(\"History\",[[\"path\",{d:\"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8\",key:\"1357e3\"}],[\"path\",{d:\"M3 3v5h5\",key:\"1xhq8a\"}],[\"path\",{d:\"M12 7v5l4 2\",key:\"1fdv2h\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Kk=Ne(\"Image\",[[\"rect\",{width:\"18\",height:\"18\",x:\"3\",y:\"3\",rx:\"2\",ry:\"2\",key:\"1m3agn\"}],[\"circle\",{cx:\"9\",cy:\"9\",r:\"2\",key:\"af1f0g\"}],[\"path\",{d:\"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21\",key:\"1xmnt7\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Sne=Ne(\"Images\",[[\"path\",{d:\"M18 22H4a2 2 0 0 1-2-2V6\",key:\"pblm9e\"}],[\"path\",{d:\"m22 13-1.296-1.296a2.41 2.41 0 0 0-3.408 0L11 18\",key:\"nf6bnh\"}],[\"circle\",{cx:\"12\",cy:\"8\",r:\"2\",key:\"1822b1\"}],[\"rect\",{width:\"16\",height:\"16\",x:\"6\",y:\"2\",rx:\"2\",key:\"12espp\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Il=Ne(\"Info\",[[\"circle\",{cx:\"12\",cy:\"12\",r:\"10\",key:\"1mglay\"}],[\"path\",{d:\"M12 16v-4\",key:\"1dtifu\"}],[\"path\",{d:\"M12 8h.01\",key:\"e9boi3\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const oU=Ne(\"Keyboard\",[[\"path\",{d:\"M10 8h.01\",key:\"1r9ogq\"}],[\"path\",{d:\"M12 12h.01\",key:\"1mp3jc\"}],[\"path\",{d:\"M14 8h.01\",key:\"1primd\"}],[\"path\",{d:\"M16 12h.01\",key:\"1l6xoz\"}],[\"path\",{d:\"M18 8h.01\",key:\"emo2bl\"}],[\"path\",{d:\"M6 8h.01\",key:\"x9i8wu\"}],[\"path\",{d:\"M7 16h10\",key:\"wp8him\"}],[\"path\",{d:\"M8 12h.01\",key:\"czm47f\"}],[\"rect\",{width:\"20\",height:\"16\",x:\"2\",y:\"4\",rx:\"2\",key:\"18n3k1\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const zl=Ne(\"Lightbulb\",[[\"path\",{d:\"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5\",key:\"1gvzjb\"}],[\"path\",{d:\"M9 18h6\",key:\"x1upvd\"}],[\"path\",{d:\"M10 22h4\",key:\"ceow96\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Xk=Ne(\"LogIn\",[[\"path\",{d:\"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4\",key:\"u53s6r\"}],[\"polyline\",{points:\"10 17 15 12 10 7\",key:\"1ail0h\"}],[\"line\",{x1:\"15\",x2:\"3\",y1:\"12\",y2:\"12\",key:\"v6grx8\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const sU=Ne(\"LogOut\",[[\"path\",{d:\"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4\",key:\"1uf3rs\"}],[\"polyline\",{points:\"16 17 21 12 16 7\",key:\"1gabdz\"}],[\"line\",{x1:\"21\",x2:\"9\",y1:\"12\",y2:\"12\",key:\"1uyos4\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const _ne=Ne(\"MessageCircle\",[[\"path\",{d:\"M7.9 20A9 9 0 1 0 4 16.1L2 22Z\",key:\"vv11sd\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Cne=Ne(\"MessageSquare\",[[\"path\",{d:\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\",key:\"1lielz\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Hf=Ne(\"MicOff\",[[\"line\",{x1:\"2\",x2:\"22\",y1:\"2\",y2:\"22\",key:\"a6p6uj\"}],[\"path\",{d:\"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2\",key:\"80xlxr\"}],[\"path\",{d:\"M5 10v2a7 7 0 0 0 12 5\",key:\"p2k8kg\"}],[\"path\",{d:\"M15 9.34V5a3 3 0 0 0-5.68-1.33\",key:\"1gzdoj\"}],[\"path\",{d:\"M9 9v3a3 3 0 0 0 5.12 2.12\",key:\"r2i35w\"}],[\"line\",{x1:\"12\",x2:\"12\",y1:\"19\",y2:\"22\",key:\"x3vr5v\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const _i=Ne(\"Mic\",[[\"path\",{d:\"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z\",key:\"131961\"}],[\"path\",{d:\"M19 10v2a7 7 0 0 1-14 0v-2\",key:\"1vc78b\"}],[\"line\",{x1:\"12\",x2:\"12\",y1:\"19\",y2:\"22\",key:\"x3vr5v\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const lU=Ne(\"Minus\",[[\"path\",{d:\"M5 12h14\",key:\"1ays0h\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Ane=Ne(\"Monitor\",[[\"rect\",{width:\"20\",height:\"14\",x:\"2\",y:\"3\",rx:\"2\",key:\"48i651\"}],[\"line\",{x1:\"8\",x2:\"16\",y1:\"21\",y2:\"21\",key:\"1svkeh\"}],[\"line\",{x1:\"12\",x2:\"12\",y1:\"17\",y2:\"21\",key:\"vw1qmm\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Nne=Ne(\"Pause\",[[\"rect\",{x:\"14\",y:\"4\",width:\"4\",height:\"16\",rx:\"1\",key:\"zuxfzm\"}],[\"rect\",{x:\"6\",y:\"4\",width:\"4\",height:\"16\",rx:\"1\",key:\"1okwgv\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Xh=Ne(\"PenLine\",[[\"path\",{d:\"M12 20h9\",key:\"t2du7b\"}],[\"path\",{d:\"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z\",key:\"1ykcvy\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const YA=Ne(\"Pen\",[[\"path\",{d:\"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z\",key:\"1a8usu\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const ZA=Ne(\"Play\",[[\"polygon\",{points:\"6 3 20 12 6 21 6 3\",key:\"1oa8hb\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const xi=Ne(\"Plus\",[[\"path\",{d:\"M5 12h14\",key:\"1ays0h\"}],[\"path\",{d:\"M12 5v14\",key:\"s699le\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const cU=Ne(\"QrCode\",[[\"rect\",{width:\"5\",height:\"5\",x:\"3\",y:\"3\",rx:\"1\",key:\"1tu5fj\"}],[\"rect\",{width:\"5\",height:\"5\",x:\"16\",y:\"3\",rx:\"1\",key:\"1v8r4q\"}],[\"rect\",{width:\"5\",height:\"5\",x:\"3\",y:\"16\",rx:\"1\",key:\"1x03jg\"}],[\"path\",{d:\"M21 16h-3a2 2 0 0 0-2 2v3\",key:\"177gqh\"}],[\"path\",{d:\"M21 21v.01\",key:\"ents32\"}],[\"path\",{d:\"M12 7v3a2 2 0 0 1-2 2H7\",key:\"8crl2c\"}],[\"path\",{d:\"M3 12h.01\",key:\"nlz23k\"}],[\"path\",{d:\"M12 3h.01\",key:\"n36tog\"}],[\"path\",{d:\"M12 16v.01\",key:\"133mhm\"}],[\"path\",{d:\"M16 12h1\",key:\"1slzba\"}],[\"path\",{d:\"M21 12v.01\",key:\"1lwtk9\"}],[\"path\",{d:\"M12 21v-1\",key:\"1880an\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Ml=Ne(\"RefreshCw\",[[\"path\",{d:\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\",key:\"v9h5vc\"}],[\"path\",{d:\"M21 3v5h-5\",key:\"1q7to0\"}],[\"path\",{d:\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\",key:\"3uifl3\"}],[\"path\",{d:\"M8 16H3v5\",key:\"1cv678\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Ene=Ne(\"RotateCcw\",[[\"path\",{d:\"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8\",key:\"1357e3\"}],[\"path\",{d:\"M3 3v5h5\",key:\"1xhq8a\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Fj=Ne(\"Save\",[[\"path\",{d:\"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z\",key:\"1c8476\"}],[\"path\",{d:\"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7\",key:\"1ydtos\"}],[\"path\",{d:\"M7 3v4a1 1 0 0 0 1 1h7\",key:\"t51u73\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const cf=Ne(\"Scale\",[[\"path\",{d:\"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z\",key:\"7g6ntu\"}],[\"path\",{d:\"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z\",key:\"ijws7r\"}],[\"path\",{d:\"M7 21h10\",key:\"1b0cd5\"}],[\"path\",{d:\"M12 3v18\",key:\"108xh3\"}],[\"path\",{d:\"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2\",key:\"3gwbw2\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const jne=Ne(\"Search\",[[\"circle\",{cx:\"11\",cy:\"11\",r:\"8\",key:\"4ej97u\"}],[\"path\",{d:\"m21 21-4.3-4.3\",key:\"1qie3q\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Tne=Ne(\"Send\",[[\"path\",{d:\"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z\",key:\"1ffxy3\"}],[\"path\",{d:\"m21.854 2.147-10.94 10.939\",key:\"12cjpa\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Pne=Ne(\"Share2\",[[\"circle\",{cx:\"18\",cy:\"5\",r:\"3\",key:\"gq8acd\"}],[\"circle\",{cx:\"6\",cy:\"12\",r:\"3\",key:\"w7nqdw\"}],[\"circle\",{cx:\"18\",cy:\"19\",r:\"3\",key:\"1xt0gg\"}],[\"line\",{x1:\"8.59\",x2:\"15.42\",y1:\"13.51\",y2:\"17.49\",key:\"47mynk\"}],[\"line\",{x1:\"15.41\",x2:\"8.59\",y1:\"6.51\",y2:\"10.49\",key:\"1n3mei\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const QA=Ne(\"Shield\",[[\"path\",{d:\"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z\",key:\"oel41y\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const One=Ne(\"Smartphone\",[[\"rect\",{width:\"14\",height:\"20\",x:\"5\",y:\"2\",rx:\"2\",ry:\"2\",key:\"1yt0o3\"}],[\"path\",{d:\"M12 18h.01\",key:\"mhygvu\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const gd=Ne(\"Sparkles\",[[\"path\",{d:\"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z\",key:\"4pj2yx\"}],[\"path\",{d:\"M20 3v4\",key:\"1olli1\"}],[\"path\",{d:\"M22 5h-4\",key:\"1gvqau\"}],[\"path\",{d:\"M4 17v2\",key:\"vumght\"}],[\"path\",{d:\"M5 18H3\",key:\"zchphs\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const kne=Ne(\"SquarePen\",[[\"path\",{d:\"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\",key:\"1m0v6g\"}],[\"path\",{d:\"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z\",key:\"ohrbg2\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const uU=Ne(\"Square\",[[\"rect\",{width:\"18\",height:\"18\",x:\"3\",y:\"3\",rx:\"2\",key:\"afitv7\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Yk=Ne(\"Star\",[[\"polygon\",{points:\"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2\",key:\"8f66p6\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Ine=Ne(\"StickyNote\",[[\"path\",{d:\"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z\",key:\"qazsjp\"}],[\"path\",{d:\"M15 3v4a2 2 0 0 0 2 2h4\",key:\"40519r\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const qv=Ne(\"Syringe\",[[\"path\",{d:\"m18 2 4 4\",key:\"22kx64\"}],[\"path\",{d:\"m17 7 3-3\",key:\"1w1zoj\"}],[\"path\",{d:\"M19 9 8.7 19.3c-1 1-2.5 1-3.4 0l-.6-.6c-1-1-1-2.5 0-3.4L15 5\",key:\"1exhtz\"}],[\"path\",{d:\"m9 11 4 4\",key:\"rovt3i\"}],[\"path\",{d:\"m5 19-3 3\",key:\"59f2uf\"}],[\"path\",{d:\"m14 4 6 6\",key:\"yqp9t2\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const ri=Ne(\"Target\",[[\"circle\",{cx:\"12\",cy:\"12\",r:\"10\",key:\"1mglay\"}],[\"circle\",{cx:\"12\",cy:\"12\",r:\"6\",key:\"1vlfrh\"}],[\"circle\",{cx:\"12\",cy:\"12\",r:\"2\",key:\"1c9p78\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const dU=Ne(\"TestTubeDiagonal\",[[\"path\",{d:\"M21 7 6.82 21.18a2.83 2.83 0 0 1-3.99-.01a2.83 2.83 0 0 1 0-4L17 3\",key:\"1ub6xw\"}],[\"path\",{d:\"m16 2 6 6\",key:\"1gw87d\"}],[\"path\",{d:\"M12 16H4\",key:\"1cjfip\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Id=Ne(\"Trash2\",[[\"path\",{d:\"M3 6h18\",key:\"d0wm0j\"}],[\"path\",{d:\"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6\",key:\"4alrt4\"}],[\"path\",{d:\"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2\",key:\"v07s0e\"}],[\"line\",{x1:\"10\",x2:\"10\",y1:\"11\",y2:\"17\",key:\"1uufr5\"}],[\"line\",{x1:\"14\",x2:\"14\",y1:\"11\",y2:\"17\",key:\"xtxkd\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Hv=Ne(\"TrendingDown\",[[\"polyline\",{points:\"22 17 13.5 8.5 8.5 13.5 2 7\",key:\"1r2t7k\"}],[\"polyline\",{points:\"16 17 22 17 22 11\",key:\"11uiuu\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Li=Ne(\"TrendingUp\",[[\"polyline\",{points:\"22 7 13.5 15.5 8.5 10.5 2 17\",key:\"126l90\"}],[\"polyline\",{points:\"16 7 22 7 22 13\",key:\"kwv8wd\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const ys=Ne(\"TriangleAlert\",[[\"path\",{d:\"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3\",key:\"wmoenq\"}],[\"path\",{d:\"M12 9v4\",key:\"juzpu7\"}],[\"path\",{d:\"M12 17h.01\",key:\"p32p05\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const jv=Ne(\"Trophy\",[[\"path\",{d:\"M6 9H4.5a2.5 2.5 0 0 1 0-5H6\",key:\"17hqa7\"}],[\"path\",{d:\"M18 9h1.5a2.5 2.5 0 0 0 0-5H18\",key:\"lmptdp\"}],[\"path\",{d:\"M4 22h16\",key:\"57wxv0\"}],[\"path\",{d:\"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22\",key:\"1nw9bq\"}],[\"path\",{d:\"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22\",key:\"1np0yb\"}],[\"path\",{d:\"M18 2H6v7a6 6 0 0 0 12 0V2Z\",key:\"u46fv3\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Mne=Ne(\"Type\",[[\"polyline\",{points:\"4 7 4 4 20 4 20 7\",key:\"1nosan\"}],[\"line\",{x1:\"9\",x2:\"15\",y1:\"20\",y2:\"20\",key:\"swin9y\"}],[\"line\",{x1:\"12\",x2:\"12\",y1:\"4\",y2:\"20\",key:\"1tx1rr\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Md=Ne(\"User\",[[\"path\",{d:\"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2\",key:\"975kel\"}],[\"circle\",{cx:\"12\",cy:\"7\",r:\"4\",key:\"17ys0d\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const JA=Ne(\"Users\",[[\"path\",{d:\"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2\",key:\"1yyitq\"}],[\"circle\",{cx:\"9\",cy:\"7\",r:\"4\",key:\"nufk8\"}],[\"path\",{d:\"M22 21v-2a4 4 0 0 0-3-3.87\",key:\"kshegd\"}],[\"path\",{d:\"M16 3.13a4 4 0 0 1 0 7.75\",key:\"1da9ce\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const uu=Ne(\"Utensils\",[[\"path\",{d:\"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2\",key:\"cjf0a3\"}],[\"path\",{d:\"M7 2v20\",key:\"1473qp\"}],[\"path\",{d:\"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7\",key:\"j28e5\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Lj=Ne(\"Volume2\",[[\"path\",{d:\"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z\",key:\"uqj9uw\"}],[\"path\",{d:\"M16 9a5 5 0 0 1 0 6\",key:\"1q6k2b\"}],[\"path\",{d:\"M19.364 18.364a9 9 0 0 0 0-12.728\",key:\"ijwkga\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Dne=Ne(\"VolumeX\",[[\"path\",{d:\"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z\",key:\"uqj9uw\"}],[\"line\",{x1:\"22\",x2:\"16\",y1:\"9\",y2:\"15\",key:\"1ewh16\"}],[\"line\",{x1:\"16\",x2:\"22\",y1:\"9\",y2:\"15\",key:\"5ykzw1\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Kp=Ne(\"Wheat\",[[\"path\",{d:\"M2 22 16 8\",key:\"60hf96\"}],[\"path\",{d:\"M3.47 12.53 5 11l1.53 1.53a3.5 3.5 0 0 1 0 4.94L5 19l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z\",key:\"1rdhi6\"}],[\"path\",{d:\"M7.47 8.53 9 7l1.53 1.53a3.5 3.5 0 0 1 0 4.94L9 15l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z\",key:\"1sdzmb\"}],[\"path\",{d:\"M11.47 4.53 13 3l1.53 1.53a3.5 3.5 0 0 1 0 4.94L13 11l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z\",key:\"eoatbi\"}],[\"path\",{d:\"M20 2h2v2a4 4 0 0 1-4 4h-2V6a4 4 0 0 1 4-4Z\",key:\"19rau1\"}],[\"path\",{d:\"M11.47 17.47 13 19l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L5 19l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z\",key:\"tc8ph9\"}],[\"path\",{d:\"M15.47 13.47 17 15l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L9 15l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z\",key:\"2m8kc5\"}],[\"path\",{d:\"M19.47 9.47 21 11l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L13 11l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z\",key:\"vex3ng\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Za=Ne(\"Wine\",[[\"path\",{d:\"M8 22h8\",key:\"rmew8v\"}],[\"path\",{d:\"M7 10h10\",key:\"1101jm\"}],[\"path\",{d:\"M12 15v7\",key:\"t2xh3l\"}],[\"path\",{d:\"M12 15a5 5 0 0 0 5-5c0-2-.5-4-2-8H9c-1.5 4-2 6-2 8a5 5 0 0 0 5 5Z\",key:\"10ffi3\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Wl=Ne(\"X\",[[\"path\",{d:\"M18 6 6 18\",key:\"1bl5f8\"}],[\"path\",{d:\"m6 6 12 12\",key:\"d8bk6v\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Rne=Ne(\"ZapOff\",[[\"path\",{d:\"M10.513 4.856 13.12 2.17a.5.5 0 0 1 .86.46l-1.377 4.317\",key:\"193nxd\"}],[\"path\",{d:\"M15.656 10H20a1 1 0 0 1 .78 1.63l-1.72 1.773\",key:\"27a7lr\"}],[\"path\",{d:\"M16.273 16.273 10.88 21.83a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14H4a1 1 0 0 1-.78-1.63l4.507-4.643\",key:\"1e0qe9\"}],[\"path\",{d:\"m2 2 20 20\",key:\"1ooewy\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const du=Ne(\"Zap\",[[\"path\",{d:\"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z\",key:\"1xq2db\"}]]),Fne=\"/assets/platemate-logo-D4AL1-s7.png\";function fU(){const t=Pn.isNativePlatform(),e=Pn.getPlatform();return{isNative:t,platform:e}}async function eN(){const t=fU();if(console.log(\"ðŸ” Launch signup - isNative:\",t.isNative,\"platform:\",t.platform),t.isNative){console.log(\"ðŸ“± Mobile: Opening OAuth signup in system browser with deep-link return\");const n=`https://nutri-snap-1-georgebrennan93.replit.app/api/signup?returnUrl=${encodeURIComponent(\"platemate://auth-complete\")}`;console.log(\"ðŸ”— Signup URL:\",n),console.log(\"ðŸ” Browser plugin available:\",typeof qp<\"u\");try{console.log(\"ðŸš€ Calling Browser.open()...\");const i=await qp.open({url:n,windowName:\"_system\",toolbarColor:\"#8B5CF6\",presentationStyle:\"popover\"});console.log(\"âœ… Browser.open() returned:\",i)}catch(i){console.error(\"âŒ Failed to open OAuth signup browser:\",i),alert(`Error opening browser: ${i instanceof Error?i.message:String(i)}`)}}else console.log(\"ðŸŒ Web: Navigating to OAuth signup\"),window.location.href=\"/api/signup\"}async function tN(){const t=fU();if(console.log(\"ðŸ” Launch login - isNative:\",t.isNative,\"platform:\",t.platform),t.isNative){console.log(\"ðŸ“± Mobile: Opening OAuth in system browser with deep-link return\");const n=`https://nutri-snap-1-georgebrennan93.replit.app/api/login?returnUrl=${encodeURIComponent(\"platemate://auth-complete\")}`;console.log(\"ðŸ”— Login URL:\",n),console.log(\"ðŸ” Browser plugin available:\",typeof qp<\"u\");try{console.log(\"ðŸš€ Calling Browser.open()...\");const i=await qp.open({url:n,windowName:\"_system\",toolbarColor:\"#8B5CF6\",presentationStyle:\"popover\"});console.log(\"âœ… Browser.open() returned:\",i)}catch(i){console.error(\"âŒ Failed to open OAuth browser:\",i),alert(`Error opening browser: ${i instanceof Error?i.message:String(i)}`)}}else console.log(\"ðŸŒ Web: Navigating to OAuth login\"),window.location.href=\"/api/login\"}function Bj(){const{user:t,isAuthenticated:e}=Wf(),[r,n]=E.useState(!1),i=E.useRef(null);return E.useEffect(()=>{const a=o=>{i.current&&!i.current.contains(o.target)&&n(!1)};return r&&document.addEventListener(\"mousedown\",a),()=>{document.removeEventListener(\"mousedown\",a)}},[r]),l.jsx(\"header\",{className:\"modern-card glass-enhanced border-b border-border/50 p-4 backdrop-blur-md sticky top-0 z-50\",children:l.jsxs(\"div\",{className:\"max-w-md mx-auto flex items-center justify-between\",children:[l.jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[l.jsx(\"div\",{className:\"w-12 h-12 rounded-xl overflow-hidden shadow-lg\",children:l.jsx(\"img\",{src:Fne,alt:\"PlateMate Logo\",className:\"w-full h-full object-contain\",\"data-testid\":\"logo-platemate\"})}),l.jsxs(\"div\",{className:\"flex flex-col\",children:[l.jsx(\"h1\",{className:\"text-2xl font-bold gradient-text\",children:\"PlateMate\"}),l.jsx(\"p\",{className:\"text-xs text-muted-foreground\",children:\"Voice-powered nutrition companion\"})]})]}),l.jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[!e&&l.jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[l.jsx(\"button\",{className:\"p-2 px-4 rounded-xl bg-gradient-to-br from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-medium text-sm backdrop-blur-sm hover:scale-105 smooth-transition border border-blue-400/30 shadow-md\",\"data-testid\":\"button-login\",title:\"Sign in with Replit\",onClick:tN,children:\"Sign In\"}),l.jsx(\"button\",{className:\"p-2 px-4 rounded-xl bg-gradient-to-br from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-medium text-sm backdrop-blur-sm hover:scale-105 smooth-transition border border-green-400/30 shadow-md\",\"data-testid\":\"button-signup\",title:\"Create a Replit account\",onClick:eN,children:\"Sign Up\"})]}),e&&t&&l.jsxs(\"div\",{className:\"relative mr-2\",ref:i,children:[l.jsxs(\"button\",{onClick:()=>n(!r),className:\"flex items-center space-x-1 p-3 rounded-xl bg-gradient-to-br from-white/10 to-white/5 dark:from-gray-800/50 dark:to-gray-700/30 backdrop-blur-sm hover:scale-110 smooth-transition border border-white/10 dark:border-gray-700/30\",\"data-testid\":\"button-profile\",title:\"Profile\",children:[l.jsx(Md,{className:\"h-5 w-5 text-foreground/80\"}),r?l.jsx(Ij,{className:\"h-3 w-3 text-foreground/60\"}):l.jsx(bs,{className:\"h-3 w-3 text-foreground/60\"})]}),r&&l.jsxs(\"div\",{className:\"absolute top-full right-0 mt-2 bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 p-3 min-w-[200px] backdrop-blur-md z-50\",children:[l.jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[l.jsx(Md,{className:\"h-4 w-4 text-foreground/80\"}),l.jsx(\"span\",{className:\"text-sm font-medium text-foreground/90\",children:(t==null?void 0:t.firstName)||(t==null?void 0:t.email)||\"User\"})]}),(t==null?void 0:t.email)&&(t==null?void 0:t.firstName)&&l.jsx(\"div\",{className:\"text-xs text-foreground/60 mt-1 ml-6\",children:t==null?void 0:t.email})]})]}),l.jsx(\"button\",{className:\"p-3 rounded-xl bg-gradient-to-br from-white/10 to-white/5 dark:from-gray-800/50 dark:to-gray-700/30 backdrop-blur-sm hover:scale-110 smooth-transition border border-white/10 dark:border-gray-700/30\",\"data-testid\":\"button-history\",title:\"View History\",children:l.jsx(aU,{className:\"h-5 w-5 text-foreground/80\"})}),e&&l.jsx(\"a\",{href:\"/api/logout\",children:l.jsx(\"button\",{className:\"p-3 rounded-xl bg-gradient-to-br from-red-100/50 to-red-200/30 dark:from-red-900/20 dark:to-red-800/10 backdrop-blur-sm hover:scale-110 smooth-transition border border-red-200/30 dark:border-red-700/20 hover:from-red-200/70 hover:to-red-300/50\",\"data-testid\":\"button-logout\",title:\"Logout\",children:l.jsx(sU,{className:\"h-5 w-5 text-red-600 dark:text-red-400\"})})})]})]})})}class Lne{constructor(){this.audioContext=null,this.sounds=new Map,this.enabled=!0,this.loadSoundSettings()}loadSoundSettings(){const e=localStorage.getItem(\"platemate-sounds-enabled\");this.enabled=e!==\"false\"}async initialize(){try{this.audioContext=new(window.AudioContext||window.webkitAudioContext),await this.generateSounds(),console.log(\"âœ“ Sound service initialized\")}catch(e){console.warn(\"Sound initialization failed:\",e)}}async generateSounds(){if(!this.audioContext)return;const e={notification:()=>this.generateTone(800,.3,\"sine\"),success:()=>this.generateChord([523,659,784],.4),error:()=>this.generateTone(200,.5,\"square\"),click:()=>this.generateTone(1e3,.1,\"sine\"),scan:()=>this.generateSweep(600,1200,.3),achievement:()=>this.generateMelody([523,659,784,1047],.6),reminder:()=>this.generateGentleTone(440,.5)};for(const[r,n]of Object.entries(e))try{const i=n();this.sounds.set(r,i)}catch(i){console.warn(`Failed to generate ${r} sound:`,i)}}generateTone(e,r,n=\"sine\"){if(!this.audioContext)throw new Error(\"Audio context not initialized\");const i=this.audioContext.sampleRate,a=i*r,o=this.audioContext.createBuffer(1,a,i),s=o.getChannelData(0);for(let c=0;c<a;c++){const u=c/i;let f=0;switch(n){case\"sine\":f=Math.sin(2*Math.PI*e*u);break;case\"square\":f=Math.sin(2*Math.PI*e*u)>0?1:-1;break;case\"triangle\":f=2/Math.PI*Math.asin(Math.sin(2*Math.PI*e*u));break}const h=Math.sin(Math.PI*c/a);s[c]=f*h*.3}return o}generateChord(e,r){if(!this.audioContext)throw new Error(\"Audio context not initialized\");const n=this.audioContext.sampleRate,i=n*r,a=this.audioContext.createBuffer(1,i,n),o=a.getChannelData(0);for(let s=0;s<i;s++){const c=s/n;let u=0;for(const h of e)u+=Math.sin(2*Math.PI*h*c)/e.length;const f=Math.sin(Math.PI*s/i);o[s]=u*f*.3}return a}generateSweep(e,r,n){if(!this.audioContext)throw new Error(\"Audio context not initialized\");const i=this.audioContext.sampleRate,a=i*n,o=this.audioContext.createBuffer(1,a,i),s=o.getChannelData(0);for(let c=0;c<a;c++){const u=c/a,f=e+(r-e)*u,h=c/i,m=Math.sin(2*Math.PI*f*h),g=Math.sin(Math.PI*c/a);s[c]=m*g*.2}return o}generateMelody(e,r){if(!this.audioContext)throw new Error(\"Audio context not initialized\");const n=this.audioContext.sampleRate,i=n*r,a=i/e.length,o=this.audioContext.createBuffer(1,i,n),s=o.getChannelData(0);return e.forEach((c,u)=>{const f=Math.floor(u*a),h=Math.floor((u+1)*a);for(let m=f;m<h&&m<i;m++){const g=m-f,x=h-f,v=g/n,b=Math.sin(2*Math.PI*c*v),w=Math.sin(Math.PI*g/x);s[m]=b*w*.25}}),o}generateGentleTone(e,r){if(!this.audioContext)throw new Error(\"Audio context not initialized\");const n=this.audioContext.sampleRate,i=n*r,a=this.audioContext.createBuffer(1,i,n),o=a.getChannelData(0);for(let s=0;s<i;s++){const c=s/n,u=Math.sin(2*Math.PI*e*c),f=Math.sin(2*Math.PI*e*2*c)*.3,h=Math.sin(2*Math.PI*e*3*c)*.1;let m=u+f+h;const g=Math.pow(Math.sin(Math.PI*s/i),2);o[s]=m*g*.2}return a}async play(e,r=1){if(!(!this.enabled||!this.audioContext||!this.sounds.has(e)))try{this.audioContext.state===\"suspended\"&&await this.audioContext.resume();const n=this.sounds.get(e),i=this.audioContext.createBufferSource(),a=this.audioContext.createGain();i.buffer=n,a.gain.value=Math.min(Math.max(r,0),1)*.5,i.connect(a),a.connect(this.audioContext.destination),i.start()}catch(n){console.warn(`Failed to play ${e} sound:`,n)}}setEnabled(e){this.enabled=e,localStorage.setItem(\"platemate-sounds-enabled\",e.toString())}isEnabled(){return this.enabled}async playSuccess(){await this.play(\"success\")}async playError(){await this.play(\"error\")}async playClick(){await this.play(\"click\",.3)}async playNotification(){await this.play(\"notification\")}async playAchievement(){await this.play(\"achievement\")}async playScan(){await this.play(\"scan\")}async playReminder(){await this.play(\"reminder\")}}const Nr=new Lne;var To;(function(t){t.Prompt=\"PROMPT\",t.Camera=\"CAMERA\",t.Photos=\"PHOTOS\"})(To||(To={}));var Pp;(function(t){t.Rear=\"REAR\",t.Front=\"FRONT\"})(Pp||(Pp={}));var uf;(function(t){t.Uri=\"uri\",t.Base64=\"base64\",t.DataUrl=\"dataUrl\"})(uf||(uf={}));class Bne extends kj{async getPhoto(e){return new Promise(async(r,n)=>{if(e.webUseInput||e.source===To.Photos)this.fileInputExperience(e,r,n);else if(e.source===To.Prompt){let i=document.querySelector(\"pwa-action-sheet\");i||(i=document.createElement(\"pwa-action-sheet\"),document.body.appendChild(i)),i.header=e.promptLabelHeader||\"Photo\",i.cancelable=!1,i.options=[{title:e.promptLabelPhoto||\"From Photos\"},{title:e.promptLabelPicture||\"Take Picture\"}],i.addEventListener(\"onSelection\",async a=>{a.detail===0?this.fileInputExperience(e,r,n):this.cameraExperience(e,r,n)})}else this.cameraExperience(e,r,n)})}async pickImages(e){return new Promise(async(r,n)=>{this.multipleFileInputExperience(r,n)})}async cameraExperience(e,r,n){if(customElements.get(\"pwa-camera-modal\")){const i=document.createElement(\"pwa-camera-modal\");i.facingMode=e.direction===Pp.Front?\"user\":\"environment\",document.body.appendChild(i);try{await i.componentOnReady(),i.addEventListener(\"onPhoto\",async a=>{const o=a.detail;o===null?n(new Od(\"User cancelled photos app\")):o instanceof Error?n(o):r(await this._getCameraPhoto(o,e)),i.dismiss(),document.body.removeChild(i)}),i.present()}catch{this.fileInputExperience(e,r,n)}}else console.error(\"Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements.\"),this.fileInputExperience(e,r,n)}fileInputExperience(e,r,n){let i=document.querySelector(\"#_capacitor-camera-input\");const a=()=>{var o;(o=i.parentNode)===null||o===void 0||o.removeChild(i)};i||(i=document.createElement(\"input\"),i.id=\"_capacitor-camera-input\",i.type=\"file\",i.hidden=!0,document.body.appendChild(i),i.addEventListener(\"change\",o=>{const s=i.files[0];let c=\"jpeg\";if(s.type===\"image/png\"?c=\"png\":s.type===\"image/gif\"&&(c=\"gif\"),e.resultType===\"dataUrl\"||e.resultType===\"base64\"){const u=new FileReader;u.addEventListener(\"load\",()=>{if(e.resultType===\"dataUrl\")r({dataUrl:u.result,format:c});else if(e.resultType===\"base64\"){const f=u.result.split(\",\")[1];r({base64String:f,format:c})}a()}),u.readAsDataURL(s)}else r({webPath:URL.createObjectURL(s),format:c}),a()}),i.addEventListener(\"cancel\",o=>{n(new Od(\"User cancelled photos app\")),a()})),i.accept=\"image/*\",i.capture=!0,e.source===To.Photos||e.source===To.Prompt?i.removeAttribute(\"capture\"):e.direction===Pp.Front?i.capture=\"user\":e.direction===Pp.Rear&&(i.capture=\"environment\"),i.click()}multipleFileInputExperience(e,r){let n=document.querySelector(\"#_capacitor-camera-input-multiple\");const i=()=>{var a;(a=n.parentNode)===null||a===void 0||a.removeChild(n)};n||(n=document.createElement(\"input\"),n.id=\"_capacitor-camera-input-multiple\",n.type=\"file\",n.hidden=!0,n.multiple=!0,document.body.appendChild(n),n.addEventListener(\"change\",a=>{const o=[];for(let s=0;s<n.files.length;s++){const c=n.files[s];let u=\"jpeg\";c.type===\"image/png\"?u=\"png\":c.type===\"image/gif\"&&(u=\"gif\"),o.push({webPath:URL.createObjectURL(c),format:u})}e({photos:o}),i()}),n.addEventListener(\"cancel\",a=>{r(new Od(\"User cancelled photos app\")),i()})),n.accept=\"image/*\",n.click()}_getCameraPhoto(e,r){return new Promise((n,i)=>{const a=new FileReader,o=e.type.split(\"/\")[1];r.resultType===\"uri\"?n({webPath:URL.createObjectURL(e),format:o,saved:!1}):(a.readAsDataURL(e),a.onloadend=()=>{const s=a.result;r.resultType===\"dataUrl\"?n({dataUrl:s,format:o,saved:!1}):n({base64String:s.split(\",\")[1],format:o,saved:!1})},a.onerror=s=>{i(s)})})}async checkPermissions(){if(typeof navigator>\"u\"||!navigator.permissions)throw this.unavailable(\"Permissions API not available in this browser\");try{return{camera:(await window.navigator.permissions.query({name:\"camera\"})).state,photos:\"granted\"}}catch{throw this.unavailable(\"Camera permissions are not available in this browser\")}}async requestPermissions(){throw this.unimplemented(\"Not implemented on web.\")}async pickLimitedLibraryPhotos(){throw this.unavailable(\"Not implemented on web.\")}async getLimitedLibraryPhotos(){throw this.unavailable(\"Not implemented on web.\")}}const vp=Nu(\"Camera\",{web:()=>new Bne}),hU=Nu(\"Device\",{web:()=>qf(()=>import(\"./web-B1Qu9IHK.js\"),[]).then(t=>new t.DeviceWeb)});class vd{constructor(){this.cameraStream=null,this.microphoneStream=null,this.mediaRecorder=null,this.recordingChunks=[],this.audioContext=null,this.isMediaRecorderSupported=!1,this.availableCameras=[],this.currentCameraIndex=0,this.isMediaRecorderSupported=this.checkMediaRecorderSupport()}static getInstance(){return vd.instance||(vd.instance=new vd),vd.instance}isMediaSupported(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}isSecureContext(){return window.isSecureContext||location.protocol===\"https:\"||location.hostname===\"localhost\"}checkMediaRecorderSupport(){if(typeof MediaRecorder>\"u\")return console.warn(\"âš ï¸ MediaRecorder not available in this browser\"),!1;const r=[\"audio/webm;codecs=opus\",\"audio/webm\",\"audio/mp4\",\"audio/ogg;codecs=opus\",\"audio/wav\"].find(n=>MediaRecorder.isTypeSupported(n));return r?(console.log(\"âœ… MediaRecorder supported with type:\",r),!0):(console.warn(\"âš ï¸ No supported MediaRecorder MIME types found\"),!1)}async getAvailableCameras(){if(!this.isMediaSupported())return[];try{const e=await navigator.mediaDevices.enumerateDevices();return this.availableCameras=e.filter(r=>r.kind===\"videoinput\"),console.log(\"ðŸ“¹ Available cameras:\",this.availableCameras.map(r=>({label:r.label||\"Camera\",deviceId:r.deviceId.substring(0,8)+\"...\"}))),this.availableCameras}catch(e){return console.error(\"âŒ Failed to enumerate cameras:\",e),[]}}async checkPermissions(){const e={camera:!1,microphone:!1};if(!this.isMediaSupported())return e;try{const r=await navigator.permissions.query({name:\"camera\"});e.camera=r.state===\"granted\"}catch(r){console.warn(\"Could not check camera permission:\",r)}try{const r=await navigator.permissions.query({name:\"microphone\"});e.microphone=r.state===\"granted\"}catch(r){console.warn(\"Could not check microphone permission:\",r)}return e}async startCamera(e,r={}){if(!this.isMediaSupported())throw new Error(\"Camera not supported in this browser\");try{this.cameraStream&&this.stopCamera();const n={video:{width:{ideal:r.width||1280,max:1920},height:{ideal:r.height||720,max:1080},facingMode:r.facingMode||\"environment\",aspectRatio:r.aspectRatio||16/9},audio:!1};return console.log(\"ðŸŽ¥ Requesting camera with constraints:\",n),this.cameraStream=await navigator.mediaDevices.getUserMedia(n),console.log(\"ðŸ“¹ Camera stream started successfully:\",{tracks:this.cameraStream.getTracks().length,videoTracks:this.cameraStream.getVideoTracks().length}),e.srcObject=this.cameraStream,e.playsInline=!0,e.muted=!0,await new Promise((i,a)=>{e.onloadedmetadata=()=>{console.log(\"ðŸ“ Video dimensions:\",{videoWidth:e.videoWidth,videoHeight:e.videoHeight}),i(void 0)},e.onerror=a,e.play().catch(a)}),this.cameraStream}catch(n){throw console.error(\"âŒ Camera access failed:\",n),this.handleMediaError(n,\"camera\"),n}}stopCamera(){this.cameraStream&&(console.log(\"â¹ï¸ Stopping camera stream\"),this.cameraStream.getTracks().forEach(e=>{e.stop(),console.log(`ðŸ”´ Stopped ${e.kind} track`)}),this.cameraStream=null)}async capturePhotoFromStream(e,r=.9){if(!this.cameraStream||!e.videoWidth)throw console.error(\"âŒ No active camera stream or video not ready\"),new Error(\"No active camera stream or video not ready\");try{const n=document.createElement(\"canvas\"),i=n.getContext(\"2d\");if(!i)throw new Error(\"Could not get canvas context\");return n.width=e.videoWidth,n.height=e.videoHeight,i.drawImage(e,0,0,n.width,n.height),console.log(\"ðŸ“¸ Photo captured from stream:\",{width:n.width,height:n.height,quality:r}),new Promise((a,o)=>{n.toBlob(s=>{s?a(s):o(new Error(\"Failed to create photo blob\"))},\"image/jpeg\",r)})}catch(n){throw console.error(\"âŒ Failed to capture photo:\",n),n}}async switchCamera(e){if(!this.cameraStream)throw new Error(\"No active camera stream to switch\");try{if(this.availableCameras.length===0&&await this.getAvailableCameras(),this.availableCameras.length<2)throw new Error(\"Only one camera available, cannot switch\");this.currentCameraIndex=(this.currentCameraIndex+1)%this.availableCameras.length;const r=this.availableCameras[this.currentCameraIndex];console.log(\"ðŸ”„ Switching to camera:\",{index:this.currentCameraIndex,label:r.label||\"Unknown Camera\",deviceId:r.deviceId.substring(0,8)+\"...\"}),this.stopCamera(),await this.startCameraWithDeviceId(e,r.deviceId)}catch(r){console.error(\"âŒ Failed to switch camera:\",r),await this.fallbackSwitchCamera(e)}}async fallbackSwitchCamera(e){var o;const r=(o=this.cameraStream)==null?void 0:o.getVideoTracks()[0];if(!r)throw new Error(\"No video track found for fallback switch\");const i=r.getConstraints().facingMode,a=i===\"user\"?\"environment\":\"user\";console.log(\"ðŸ”„ Fallback camera switch from\",i,\"to\",a),this.stopCamera(),await this.startCamera(e,{facingMode:a})}async startCameraWithDeviceId(e,r){const n={video:{deviceId:{exact:r},width:{ideal:1280,max:1920},height:{ideal:720,max:1080}},audio:!1};return console.log(\"ðŸ“¹ Starting camera with device ID:\",r.substring(0,8)+\"...\"),this.cameraStream=await navigator.mediaDevices.getUserMedia(n),e.srcObject=this.cameraStream,e.playsInline=!0,e.muted=!0,await new Promise((i,a)=>{e.onloadedmetadata=i,e.onerror=a,e.play().catch(a)}),this.cameraStream}async startMicrophoneRecording(e={}){if(!this.isMediaSupported())throw new Error(\"Microphone not supported in this browser\");try{this.microphoneStream&&this.stopMicrophone();const r={audio:{echoCancellation:e.echoCancellation??!0,noiseSuppression:e.noiseSuppression??!0,autoGainControl:e.autoGainControl??!0,sampleRate:e.sampleRate||44100},video:!1};return console.log(\"ðŸŽ¤ Requesting microphone with constraints:\",r),this.microphoneStream=await navigator.mediaDevices.getUserMedia(r),console.log(\"ðŸŽ™ï¸ Microphone stream started successfully:\",{tracks:this.microphoneStream.getTracks().length,audioTracks:this.microphoneStream.getAudioTracks().length}),this.microphoneStream}catch(r){throw console.error(\"âŒ Microphone access failed:\",r),this.handleMediaError(r,\"microphone\"),r}}async startAudioRecording(){if(this.microphoneStream||await this.startMicrophoneRecording(),!this.microphoneStream)throw new Error(\"No microphone stream available\");try{this.recordingChunks=[],this.isMediaRecorderSupported?await this.startMediaRecorderRecording():await this.startWebAudioRecording()}catch(e){throw console.error(\"âŒ Failed to start audio recording:\",e),e}}async startMediaRecorderRecording(){if(!this.microphoneStream)throw new Error(\"No microphone stream available\");this.mediaRecorder=new MediaRecorder(this.microphoneStream,{mimeType:this.getSupportedMimeType()}),console.log(\"ðŸŽ¬ Starting audio recording with MediaRecorder\"),this.mediaRecorder.ondataavailable=e=>{e.data.size>0&&(this.recordingChunks.push(e.data),console.log(\"ðŸ“Š Audio chunk received:\",e.data.size,\"bytes\"))},this.mediaRecorder.start(100)}async startWebAudioRecording(){if(!this.microphoneStream)throw new Error(\"No microphone stream available\");try{this.audioContext=new(window.AudioContext||window.webkitAudioContext),console.log(\"ðŸŽ¤ Starting Web Audio API recording (iOS Safari fallback)\");const e=this.audioContext.createMediaStreamSource(this.microphoneStream);this.audioContext.audioWorklet?await this.setupAudioWorkletRecording(e):this.setupScriptProcessorRecording(e)}catch(e){throw console.error(\"âŒ Failed to start Web Audio recording:\",e),e}}async setupAudioWorkletRecording(e){this.setupScriptProcessorRecording(e)}setupScriptProcessorRecording(e){if(!this.audioContext)return;const r=4096,n=this.audioContext.sampleRate,i=[],a=this.audioContext.createScriptProcessor(r,1,1);a.onaudioprocess=o=>{const c=o.inputBuffer.getChannelData(0);for(let u=0;u<c.length;u++)i.push(c[u])},e.connect(a),a.connect(this.audioContext.destination),this.scriptProcessor=a,this.recordedSamples=i,this.sampleRate=n,console.log(\"ðŸŽ™ï¸ ScriptProcessor recording setup complete\")}async stopAudioRecording(){if(this.isMediaRecorderSupported&&this.mediaRecorder)return this.stopMediaRecorderRecording();if(this.audioContext)return this.stopWebAudioRecording();throw new Error(\"No active recording to stop\")}stopMediaRecorderRecording(){return new Promise((e,r)=>{if(!this.mediaRecorder){r(new Error(\"No MediaRecorder active\"));return}this.mediaRecorder.onstop=()=>{console.log(\"â¹ï¸ MediaRecorder recording stopped, combining chunks...\");const n=new Blob(this.recordingChunks,{type:this.getSupportedMimeType()});console.log(\"ðŸŽµ Audio recording completed:\",{size:n.size,type:n.type,chunks:this.recordingChunks.length}),e(n)},this.mediaRecorder.stop()})}stopWebAudioRecording(){return new Promise((e,r)=>{try{const n=this.scriptProcessor,i=this.recordedSamples,a=this.sampleRate;if(!n||!i||!a){r(new Error(\"Web Audio recording data not found\"));return}console.log(\"â¹ï¸ Web Audio recording stopped, converting to WAV...\",{samples:i.length,sampleRate:a}),n.disconnect();const o=this.convertSamplesToWAV(i,a);console.log(\"ðŸŽµ Web Audio recording converted to WAV:\",{size:o.size,type:o.type}),delete this.scriptProcessor,delete this.recordedSamples,delete this.sampleRate,e(o)}catch(n){console.error(\"âŒ Failed to stop Web Audio recording:\",n),r(n)}})}convertSamplesToWAV(e,r){const n=e.length,i=new ArrayBuffer(44+n*2),a=new DataView(i),o=(c,u)=>{for(let f=0;f<u.length;f++)a.setUint8(c+f,u.charCodeAt(f))};o(0,\"RIFF\"),a.setUint32(4,36+n*2,!0),o(8,\"WAVE\"),o(12,\"fmt \"),a.setUint32(16,16,!0),a.setUint16(20,1,!0),a.setUint16(22,1,!0),a.setUint32(24,r,!0),a.setUint32(28,r*2,!0),a.setUint16(32,2,!0),a.setUint16(34,16,!0),o(36,\"data\"),a.setUint32(40,n*2,!0);let s=44;for(let c=0;c<n;c++){const u=Math.max(-1,Math.min(1,e[c]));a.setInt16(s,u*32767,!0),s+=2}return new Blob([i],{type:\"audio/wav\"})}stopMicrophone(){this.microphoneStream&&(console.log(\"â¹ï¸ Stopping microphone stream\"),this.microphoneStream.getTracks().forEach(e=>{e.stop(),console.log(`ðŸ”´ Stopped ${e.kind} track`)}),this.microphoneStream=null),this.mediaRecorder&&this.mediaRecorder.state!==\"inactive\"&&this.mediaRecorder.stop()}playAudio(e){const r=URL.createObjectURL(e),n=new Audio(r);return n.play().catch(i=>{console.error(\"âŒ Failed to play audio:\",i)}),n.addEventListener(\"ended\",()=>{URL.revokeObjectURL(r)}),n}getSupportedMimeType(){const e=[\"audio/webm;codecs=opus\",\"audio/webm\",\"audio/mp4\",\"audio/ogg;codecs=opus\",\"audio/wav\"];for(const r of e)if(MediaRecorder.isTypeSupported(r))return console.log(\"ðŸŽ¯ Using MIME type:\",r),r;return console.warn(\"âš ï¸ No supported MIME type found, using default\"),\"audio/webm\"}handleMediaError(e,r){let n=`Unable to access ${r}`;e.name===\"NotAllowedError\"?n=`${r.charAt(0).toUpperCase()+r.slice(1)} access was denied. Please allow ${r} permissions in your browser settings.`:e.name===\"NotFoundError\"?n=`No ${r} found on this device.`:e.name===\"NotSupportedError\"?n=`${r.charAt(0).toUpperCase()+r.slice(1)} is not supported in this browser.`:e.name===\"NotReadableError\"?n=`${r.charAt(0).toUpperCase()+r.slice(1)} is being used by another application.`:e.name===\"OverconstrainedError\"?n=`${r.charAt(0).toUpperCase()+r.slice(1)} settings are not supported on this device.`:e.name===\"SecurityError\"&&(n=`${r.charAt(0).toUpperCase()+r.slice(1)} access blocked for security reasons. Please use HTTPS.`),console.error(`âŒ ${r} error:`,n,e)}async takePhoto(e={}){Pn.isNativePlatform()?console.log(\"ðŸ“± Native platform - using native camera\"):console.log(\"ðŸ“± Web platform - using Capacitor Camera for web\");const r={quality:e.quality||90,allowEditing:e.allowEditing||!1,resultType:e.resultType||uf.Uri,source:e.source||To.Camera};try{const n=await vp.getPhoto(r);return console.log(\"ðŸ“¸ Photo captured successfully:\",{format:n.format,webPath:n.webPath?\"available\":\"none\"}),n}catch(n){throw console.error(\"âŒ Camera error:\",n),new Error(`Failed to take photo: ${n}`)}}async selectFromGallery(e={}){console.log(\"ðŸ–¼ï¸ Selecting from photo gallery...\");const r={quality:e.quality||90,allowEditing:e.allowEditing||!1,resultType:e.resultType||uf.Uri,source:To.Photos};try{const n=await vp.getPhoto(r);return console.log(\"ðŸ“· Gallery photo selected successfully\"),n}catch(n){throw console.error(\"âŒ Gallery selection error:\",n),new Error(`Failed to select from gallery: ${n}`)}}async checkCameraPermissions(){try{const e=await vp.checkPermissions();if(console.log(\"ðŸ“‹ Camera permissions status:\",e),e.camera===\"granted\"&&e.photos===\"granted\")return!0;const r=await vp.requestPermissions();return console.log(\"ðŸ“‹ Permission request result:\",r),r.camera===\"granted\"&&r.photos===\"granted\"}catch(e){return console.error(\"âŒ Permission check error:\",e),!1}}async getDeviceInfo(){try{const e=await hU.getInfo();return console.log(\"ðŸ“± Device info:\",{platform:e.platform,isVirtual:e.isVirtual,model:e.model}),e}catch(e){return console.error(\"âŒ Device info error:\",e),null}}isNativePlatform(){return Pn.isNativePlatform()}isPlatform(e){return Pn.getPlatform()===e}cleanup(){this.stopCamera(),this.stopMicrophone(),this.mediaRecorder&&(this.mediaRecorder=null),this.recordingChunks=[],console.log(\"ðŸ§¹ Media service cleaned up\")}}const Br=vd.getInstance();function ht(t,e,{checkForDefaultPrevented:r=!0}={}){return function(i){if(t==null||t(i),r===!1||!i.defaultPrevented)return e==null?void 0:e(i)}}function Zk(t,e){if(typeof t==\"function\")return t(e);t!=null&&(t.current=e)}function pU(...t){return e=>{let r=!1;const n=t.map(i=>{const a=Zk(i,e);return!r&&typeof a==\"function\"&&(r=!0),a});if(r)return()=>{for(let i=0;i<n.length;i++){const a=n[i];typeof a==\"function\"?a():Zk(t[i],null)}}}}function Dt(...t){return E.useCallback(pU(...t),t)}function $ne(t,e){const r=E.createContext(e),n=a=>{const{children:o,...s}=a,c=E.useMemo(()=>s,Object.values(s));return l.jsx(r.Provider,{value:c,children:o})};n.displayName=t+\"Provider\";function i(a){const o=E.useContext(r);if(o)return o;if(e!==void 0)return e;throw new Error(`\\`${a}\\` must be used within \\`${t}\\``)}return[n,i]}function Ia(t,e=[]){let r=[];function n(a,o){const s=E.createContext(o),c=r.length;r=[...r,o];const u=h=>{var w;const{scope:m,children:g,...x}=h,v=((w=m==null?void 0:m[t])==null?void 0:w[c])||s,b=E.useMemo(()=>x,Object.values(x));return l.jsx(v.Provider,{value:b,children:g})};u.displayName=a+\"Provider\";function f(h,m){var v;const g=((v=m==null?void 0:m[t])==null?void 0:v[c])||s,x=E.useContext(g);if(x)return x;if(o!==void 0)return o;throw new Error(`\\`${h}\\` must be used within \\`${a}\\``)}return[u,f]}const i=()=>{const a=r.map(o=>E.createContext(o));return function(s){const c=(s==null?void 0:s[t])||a;return E.useMemo(()=>({[`__scope${t}`]:{...s,[t]:c}}),[s,c])}};return i.scopeName=t,[n,Vne(i,...e)]}function Vne(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const n=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(a){const o=n.reduce((s,{useScope:c,scopeName:u})=>{const h=c(a)[`__scope${u}`];return{...s,...h}},{});return E.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return r.scopeName=e.scopeName,r}var zn=globalThis!=null&&globalThis.document?E.useLayoutEffect:()=>{},Une=jj[\" useId \".trim().toString()]||(()=>{}),zne=0;function Ro(t){const[e,r]=E.useState(Une());return zn(()=>{r(n=>n??String(zne++))},[t]),e?`radix-${e}`:\"\"}var Wne=jj[\" useInsertionEffect \".trim().toString()]||zn;function ks({prop:t,defaultProp:e,onChange:r=()=>{},caller:n}){const[i,a,o]=qne({defaultProp:e,onChange:r}),s=t!==void 0,c=s?t:i;{const f=E.useRef(t!==void 0);E.useEffect(()=>{const h=f.current;h!==s&&console.warn(`${n} is changing from ${h?\"controlled\":\"uncontrolled\"} to ${s?\"controlled\":\"uncontrolled\"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),f.current=s},[s,n])}const u=E.useCallback(f=>{var h;if(s){const m=Hne(f)?f(t):f;m!==t&&((h=o.current)==null||h.call(o,m))}else a(f)},[s,t,a,o]);return[c,u]}function qne({defaultProp:t,onChange:e}){const[r,n]=E.useState(t),i=E.useRef(r),a=E.useRef(e);return Wne(()=>{a.current=e},[e]),E.useEffect(()=>{var o;i.current!==r&&((o=a.current)==null||o.call(a,r),i.current=r)},[r,i]),[r,n,a]}function Hne(t){return typeof t==\"function\"}var l0=OV();const Gne=or(l0);function fu(t){const e=Kne(t),r=E.forwardRef((n,i)=>{const{children:a,...o}=n,s=E.Children.toArray(a),c=s.find(Yne);if(c){const u=c.props.children,f=s.map(h=>h===c?E.Children.count(u)>1?E.Children.only(null):E.isValidElement(u)?u.props.children:null:h);return l.jsx(e,{...o,ref:i,children:E.isValidElement(u)?E.cloneElement(u,void 0,f):null})}return l.jsx(e,{...o,ref:i,children:a})});return r.displayName=`${t}.Slot`,r}var mU=fu(\"Slot\");function Kne(t){const e=E.forwardRef((r,n)=>{const{children:i,...a}=r;if(E.isValidElement(i)){const o=Qne(i),s=Zne(a,i.props);return i.type!==E.Fragment&&(s.ref=n?pU(n,o):o),E.cloneElement(i,s)}return E.Children.count(i)>1?E.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var gU=Symbol(\"radix.slottable\");function Xne(t){const e=({children:r})=>l.jsx(l.Fragment,{children:r});return e.displayName=`${t}.Slottable`,e.__radixId=gU,e}function Yne(t){return E.isValidElement(t)&&typeof t.type==\"function\"&&\"__radixId\"in t.type&&t.type.__radixId===gU}function Zne(t,e){const r={...e};for(const n in e){const i=t[n],a=e[n];/^on[A-Z]/.test(n)?i&&a?r[n]=(...s)=>{const c=a(...s);return i(...s),c}:i&&(r[n]=i):n===\"style\"?r[n]={...i,...a}:n===\"className\"&&(r[n]=[i,a].filter(Boolean).join(\" \"))}return{...t,...r}}function Qne(t){var n,i;let e=(n=Object.getOwnPropertyDescriptor(t.props,\"ref\"))==null?void 0:n.get,r=e&&\"isReactWarning\"in e&&e.isReactWarning;return r?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,\"ref\"))==null?void 0:i.get,r=e&&\"isReactWarning\"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var Jne=[\"a\",\"button\",\"div\",\"form\",\"h2\",\"h3\",\"img\",\"input\",\"label\",\"li\",\"nav\",\"ol\",\"p\",\"select\",\"span\",\"svg\",\"ul\"],pt=Jne.reduce((t,e)=>{const r=fu(`Primitive.${e}`),n=E.forwardRef((i,a)=>{const{asChild:o,...s}=i,c=o?r:e;return typeof window<\"u\"&&(window[Symbol.for(\"radix-ui\")]=!0),l.jsx(c,{...s,ref:a})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function eie(t,e){t&&l0.flushSync(()=>t.dispatchEvent(e))}function ql(t){const e=E.useRef(t);return E.useEffect(()=>{e.current=t}),E.useMemo(()=>(...r)=>{var n;return(n=e.current)==null?void 0:n.call(e,...r)},[])}function tie(t,e=globalThis==null?void 0:globalThis.document){const r=ql(t);E.useEffect(()=>{const n=i=>{i.key===\"Escape\"&&r(i)};return e.addEventListener(\"keydown\",n,{capture:!0}),()=>e.removeEventListener(\"keydown\",n,{capture:!0})},[r,e])}var rie=\"DismissableLayer\",rN=\"dismissableLayer.update\",nie=\"dismissableLayer.pointerDownOutside\",iie=\"dismissableLayer.focusOutside\",Qk,vU=E.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Ox=E.forwardRef((t,e)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:i,onFocusOutside:a,onInteractOutside:o,onDismiss:s,...c}=t,u=E.useContext(vU),[f,h]=E.useState(null),m=(f==null?void 0:f.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,g]=E.useState({}),x=Dt(e,P=>h(P)),v=Array.from(u.layers),[b]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),w=v.indexOf(b),C=f?v.indexOf(f):-1,_=u.layersWithOutsidePointerEventsDisabled.size>0,N=C>=w,A=sie(P=>{const k=P.target,I=[...u.branches].some(R=>R.contains(k));!N||I||(i==null||i(P),o==null||o(P),P.defaultPrevented||s==null||s())},m),T=lie(P=>{const k=P.target;[...u.branches].some(R=>R.contains(k))||(a==null||a(P),o==null||o(P),P.defaultPrevented||s==null||s())},m);return tie(P=>{C===u.layers.size-1&&(n==null||n(P),!P.defaultPrevented&&s&&(P.preventDefault(),s()))},m),E.useEffect(()=>{if(f)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(Qk=m.body.style.pointerEvents,m.body.style.pointerEvents=\"none\"),u.layersWithOutsidePointerEventsDisabled.add(f)),u.layers.add(f),Jk(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(m.body.style.pointerEvents=Qk)}},[f,m,r,u]),E.useEffect(()=>()=>{f&&(u.layers.delete(f),u.layersWithOutsidePointerEventsDisabled.delete(f),Jk())},[f,u]),E.useEffect(()=>{const P=()=>g({});return document.addEventListener(rN,P),()=>document.removeEventListener(rN,P)},[]),l.jsx(pt.div,{...c,ref:x,style:{pointerEvents:_?N?\"auto\":\"none\":void 0,...t.style},onFocusCapture:ht(t.onFocusCapture,T.onFocusCapture),onBlurCapture:ht(t.onBlurCapture,T.onBlurCapture),onPointerDownCapture:ht(t.onPointerDownCapture,A.onPointerDownCapture)})});Ox.displayName=rie;var aie=\"DismissableLayerBranch\",oie=E.forwardRef((t,e)=>{const r=E.useContext(vU),n=E.useRef(null),i=Dt(e,n);return E.useEffect(()=>{const a=n.current;if(a)return r.branches.add(a),()=>{r.branches.delete(a)}},[r.branches]),l.jsx(pt.div,{...t,ref:i})});oie.displayName=aie;function sie(t,e=globalThis==null?void 0:globalThis.document){const r=ql(t),n=E.useRef(!1),i=E.useRef(()=>{});return E.useEffect(()=>{const a=s=>{if(s.target&&!n.current){let c=function(){yU(nie,r,u,{discrete:!0})};const u={originalEvent:s};s.pointerType===\"touch\"?(e.removeEventListener(\"click\",i.current),i.current=c,e.addEventListener(\"click\",i.current,{once:!0})):c()}else e.removeEventListener(\"click\",i.current);n.current=!1},o=window.setTimeout(()=>{e.addEventListener(\"pointerdown\",a)},0);return()=>{window.clearTimeout(o),e.removeEventListener(\"pointerdown\",a),e.removeEventListener(\"click\",i.current)}},[e,r]),{onPointerDownCapture:()=>n.current=!0}}function lie(t,e=globalThis==null?void 0:globalThis.document){const r=ql(t),n=E.useRef(!1);return E.useEffect(()=>{const i=a=>{a.target&&!n.current&&yU(iie,r,{originalEvent:a},{discrete:!1})};return e.addEventListener(\"focusin\",i),()=>e.removeEventListener(\"focusin\",i)},[e,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function Jk(){const t=new CustomEvent(rN);document.dispatchEvent(t)}function yU(t,e,r,{discrete:n}){const i=r.originalEvent.target,a=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});e&&i.addEventListener(t,e,{once:!0}),n?eie(i,a):i.dispatchEvent(a)}var Ww=\"focusScope.autoFocusOnMount\",qw=\"focusScope.autoFocusOnUnmount\",eI={bubbles:!1,cancelable:!0},cie=\"FocusScope\",kx=E.forwardRef((t,e)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:i,onUnmountAutoFocus:a,...o}=t,[s,c]=E.useState(null),u=ql(i),f=ql(a),h=E.useRef(null),m=Dt(e,v=>c(v)),g=E.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;E.useEffect(()=>{if(n){let v=function(_){if(g.paused||!s)return;const N=_.target;s.contains(N)?h.current=N:xl(h.current,{select:!0})},b=function(_){if(g.paused||!s)return;const N=_.relatedTarget;N!==null&&(s.contains(N)||xl(h.current,{select:!0}))},w=function(_){if(document.activeElement===document.body)for(const A of _)A.removedNodes.length>0&&xl(s)};document.addEventListener(\"focusin\",v),document.addEventListener(\"focusout\",b);const C=new MutationObserver(w);return s&&C.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener(\"focusin\",v),document.removeEventListener(\"focusout\",b),C.disconnect()}}},[n,s,g.paused]),E.useEffect(()=>{if(s){rI.add(g);const v=document.activeElement;if(!s.contains(v)){const w=new CustomEvent(Ww,eI);s.addEventListener(Ww,u),s.dispatchEvent(w),w.defaultPrevented||(uie(mie(xU(s)),{select:!0}),document.activeElement===v&&xl(s))}return()=>{s.removeEventListener(Ww,u),setTimeout(()=>{const w=new CustomEvent(qw,eI);s.addEventListener(qw,f),s.dispatchEvent(w),w.defaultPrevented||xl(v??document.body,{select:!0}),s.removeEventListener(qw,f),rI.remove(g)},0)}}},[s,u,f,g]);const x=E.useCallback(v=>{if(!r&&!n||g.paused)return;const b=v.key===\"Tab\"&&!v.altKey&&!v.ctrlKey&&!v.metaKey,w=document.activeElement;if(b&&w){const C=v.currentTarget,[_,N]=die(C);_&&N?!v.shiftKey&&w===N?(v.preventDefault(),r&&xl(_,{select:!0})):v.shiftKey&&w===_&&(v.preventDefault(),r&&xl(N,{select:!0})):w===C&&v.preventDefault()}},[r,n,g.paused]);return l.jsx(pt.div,{tabIndex:-1,...o,ref:m,onKeyDown:x})});kx.displayName=cie;function uie(t,{select:e=!1}={}){const r=document.activeElement;for(const n of t)if(xl(n,{select:e}),document.activeElement!==r)return}function die(t){const e=xU(t),r=tI(e,t),n=tI(e.reverse(),t);return[r,n]}function xU(t){const e=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const i=n.tagName===\"INPUT\"&&n.type===\"hidden\";return n.disabled||n.hidden||i?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)e.push(r.currentNode);return e}function tI(t,e){for(const r of t)if(!fie(r,{upTo:e}))return r}function fie(t,{upTo:e}){if(getComputedStyle(t).visibility===\"hidden\")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display===\"none\")return!0;t=t.parentElement}return!1}function hie(t){return t instanceof HTMLInputElement&&\"select\"in t}function xl(t,{select:e=!1}={}){if(t&&t.focus){const r=document.activeElement;t.focus({preventScroll:!0}),t!==r&&hie(t)&&e&&t.select()}}var rI=pie();function pie(){let t=[];return{add(e){const r=t[0];e!==r&&(r==null||r.pause()),t=nI(t,e),t.unshift(e)},remove(e){var r;t=nI(t,e),(r=t[0])==null||r.resume()}}}function nI(t,e){const r=[...t],n=r.indexOf(e);return n!==-1&&r.splice(n,1),r}function mie(t){return t.filter(e=>e.tagName!==\"A\")}var gie=\"Portal\",Ix=E.forwardRef((t,e)=>{var s;const{container:r,...n}=t,[i,a]=E.useState(!1);zn(()=>a(!0),[]);const o=r||i&&((s=globalThis==null?void 0:globalThis.document)==null?void 0:s.body);return o?Gne.createPortal(l.jsx(pt.div,{...n,ref:e}),o):null});Ix.displayName=gie;function vie(t,e){return E.useReducer((r,n)=>e[r][n]??r,t)}var tc=t=>{const{present:e,children:r}=t,n=yie(e),i=typeof r==\"function\"?r({present:n.isPresent}):E.Children.only(r),a=Dt(n.ref,xie(i));return typeof r==\"function\"||n.isPresent?E.cloneElement(i,{ref:a}):null};tc.displayName=\"Presence\";function yie(t){const[e,r]=E.useState(),n=E.useRef(null),i=E.useRef(t),a=E.useRef(\"none\"),o=t?\"mounted\":\"unmounted\",[s,c]=vie(o,{mounted:{UNMOUNT:\"unmounted\",ANIMATION_OUT:\"unmountSuspended\"},unmountSuspended:{MOUNT:\"mounted\",ANIMATION_END:\"unmounted\"},unmounted:{MOUNT:\"mounted\"}});return E.useEffect(()=>{const u=Kg(n.current);a.current=s===\"mounted\"?u:\"none\"},[s]),zn(()=>{const u=n.current,f=i.current;if(f!==t){const m=a.current,g=Kg(u);t?c(\"MOUNT\"):g===\"none\"||(u==null?void 0:u.display)===\"none\"?c(\"UNMOUNT\"):c(f&&m!==g?\"ANIMATION_OUT\":\"UNMOUNT\"),i.current=t}},[t,c]),zn(()=>{if(e){let u;const f=e.ownerDocument.defaultView??window,h=g=>{const v=Kg(n.current).includes(CSS.escape(g.animationName));if(g.target===e&&v&&(c(\"ANIMATION_END\"),!i.current)){const b=e.style.animationFillMode;e.style.animationFillMode=\"forwards\",u=f.setTimeout(()=>{e.style.animationFillMode===\"forwards\"&&(e.style.animationFillMode=b)})}},m=g=>{g.target===e&&(a.current=Kg(n.current))};return e.addEventListener(\"animationstart\",m),e.addEventListener(\"animationcancel\",h),e.addEventListener(\"animationend\",h),()=>{f.clearTimeout(u),e.removeEventListener(\"animationstart\",m),e.removeEventListener(\"animationcancel\",h),e.removeEventListener(\"animationend\",h)}}else c(\"ANIMATION_END\")},[e,c]),{isPresent:[\"mounted\",\"unmountSuspended\"].includes(s),ref:E.useCallback(u=>{n.current=u?getComputedStyle(u):null,r(u)},[])}}function Kg(t){return(t==null?void 0:t.animationName)||\"none\"}function xie(t){var n,i;let e=(n=Object.getOwnPropertyDescriptor(t.props,\"ref\"))==null?void 0:n.get,r=e&&\"isReactWarning\"in e&&e.isReactWarning;return r?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,\"ref\"))==null?void 0:i.get,r=e&&\"isReactWarning\"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var Hw=0;function $j(){E.useEffect(()=>{const t=document.querySelectorAll(\"[data-radix-focus-guard]\");return document.body.insertAdjacentElement(\"afterbegin\",t[0]??iI()),document.body.insertAdjacentElement(\"beforeend\",t[1]??iI()),Hw++,()=>{Hw===1&&document.querySelectorAll(\"[data-radix-focus-guard]\").forEach(e=>e.remove()),Hw--}},[])}function iI(){const t=document.createElement(\"span\");return t.setAttribute(\"data-radix-focus-guard\",\"\"),t.tabIndex=0,t.style.outline=\"none\",t.style.opacity=\"0\",t.style.position=\"fixed\",t.style.pointerEvents=\"none\",t}var jo=function(){return jo=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},jo.apply(this,arguments)};function bU(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols==\"function\")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function bie(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,a;n<i;n++)(a||!(n in e))&&(a||(a=Array.prototype.slice.call(e,0,n)),a[n]=e[n]);return t.concat(a||Array.prototype.slice.call(e))}var Tv=\"right-scroll-bar-position\",Pv=\"width-before-scroll-bar\",wie=\"with-scroll-bars-hidden\",Sie=\"--removed-body-scroll-bar-size\";function Gw(t,e){return typeof t==\"function\"?t(e):t&&(t.current=e),t}function _ie(t,e){var r=E.useState(function(){return{value:t,callback:e,facade:{get current(){return r.value},set current(n){var i=r.value;i!==n&&(r.value=n,r.callback(n,i))}}}})[0];return r.callback=e,r.facade}var Cie=typeof window<\"u\"?E.useLayoutEffect:E.useEffect,aI=new WeakMap;function Aie(t,e){var r=_ie(null,function(n){return t.forEach(function(i){return Gw(i,n)})});return Cie(function(){var n=aI.get(r);if(n){var i=new Set(n),a=new Set(t),o=r.current;i.forEach(function(s){a.has(s)||Gw(s,null)}),a.forEach(function(s){i.has(s)||Gw(s,o)})}aI.set(r,t)},[t]),r}function Nie(t){return t}function Eie(t,e){e===void 0&&(e=Nie);var r=[],n=!1,i={read:function(){if(n)throw new Error(\"Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.\");return r.length?r[r.length-1]:t},useMedium:function(a){var o=e(a,n);return r.push(o),function(){r=r.filter(function(s){return s!==o})}},assignSyncMedium:function(a){for(n=!0;r.length;){var o=r;r=[],o.forEach(a)}r={push:function(s){return a(s)},filter:function(){return r}}},assignMedium:function(a){n=!0;var o=[];if(r.length){var s=r;r=[],s.forEach(a),o=r}var c=function(){var f=o;o=[],f.forEach(a)},u=function(){return Promise.resolve().then(c)};u(),r={push:function(f){o.push(f),u()},filter:function(f){return o=o.filter(f),r}}}};return i}function jie(t){t===void 0&&(t={});var e=Eie(null);return e.options=jo({async:!0,ssr:!1},t),e}var wU=function(t){var e=t.sideCar,r=bU(t,[\"sideCar\"]);if(!e)throw new Error(\"Sidecar: please provide `sideCar` property to import the right car\");var n=e.read();if(!n)throw new Error(\"Sidecar medium not found\");return E.createElement(n,jo({},r))};wU.isSideCarExport=!0;function Tie(t,e){return t.useMedium(e),wU}var SU=jie(),Kw=function(){},Mx=E.forwardRef(function(t,e){var r=E.useRef(null),n=E.useState({onScrollCapture:Kw,onWheelCapture:Kw,onTouchMoveCapture:Kw}),i=n[0],a=n[1],o=t.forwardProps,s=t.children,c=t.className,u=t.removeScrollBar,f=t.enabled,h=t.shards,m=t.sideCar,g=t.noRelative,x=t.noIsolation,v=t.inert,b=t.allowPinchZoom,w=t.as,C=w===void 0?\"div\":w,_=t.gapMode,N=bU(t,[\"forwardProps\",\"children\",\"className\",\"removeScrollBar\",\"enabled\",\"shards\",\"sideCar\",\"noRelative\",\"noIsolation\",\"inert\",\"allowPinchZoom\",\"as\",\"gapMode\"]),A=m,T=Aie([r,e]),P=jo(jo({},N),i);return E.createElement(E.Fragment,null,f&&E.createElement(A,{sideCar:SU,removeScrollBar:u,shards:h,noRelative:g,noIsolation:x,inert:v,setCallbacks:a,allowPinchZoom:!!b,lockRef:r,gapMode:_}),o?E.cloneElement(E.Children.only(s),jo(jo({},P),{ref:T})):E.createElement(C,jo({},P,{className:c,ref:T}),s))});Mx.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Mx.classNames={fullWidth:Pv,zeroRight:Tv};var Pie=function(){if(typeof __webpack_nonce__<\"u\")return __webpack_nonce__};function Oie(){if(!document)return null;var t=document.createElement(\"style\");t.type=\"text/css\";var e=Pie();return e&&t.setAttribute(\"nonce\",e),t}function kie(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function Iie(t){var e=document.head||document.getElementsByTagName(\"head\")[0];e.appendChild(t)}var Mie=function(){var t=0,e=null;return{add:function(r){t==0&&(e=Oie())&&(kie(e,r),Iie(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},Die=function(){var t=Mie();return function(e,r){E.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&r])}},_U=function(){var t=Die(),e=function(r){var n=r.styles,i=r.dynamic;return t(n,i),null};return e},Rie={left:0,top:0,right:0,gap:0},Xw=function(t){return parseInt(t||\"\",10)||0},Fie=function(t){var e=window.getComputedStyle(document.body),r=e[t===\"padding\"?\"paddingLeft\":\"marginLeft\"],n=e[t===\"padding\"?\"paddingTop\":\"marginTop\"],i=e[t===\"padding\"?\"paddingRight\":\"marginRight\"];return[Xw(r),Xw(n),Xw(i)]},Lie=function(t){if(t===void 0&&(t=\"margin\"),typeof window>\"u\")return Rie;var e=Fie(t),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,n-r+e[2]-e[0])}},Bie=_U(),Dd=\"data-scroll-locked\",$ie=function(t,e,r,n){var i=t.left,a=t.top,o=t.right,s=t.gap;return r===void 0&&(r=\"margin\"),`\n  .`.concat(wie,` {\n   overflow: hidden `).concat(n,`;\n   padding-right: `).concat(s,\"px \").concat(n,`;\n  }\n  body[`).concat(Dd,`] {\n    overflow: hidden `).concat(n,`;\n    overscroll-behavior: contain;\n    `).concat([e&&\"position: relative \".concat(n,\";\"),r===\"margin\"&&`\n    padding-left: `.concat(i,`px;\n    padding-top: `).concat(a,`px;\n    padding-right: `).concat(o,`px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: `).concat(s,\"px \").concat(n,`;\n    `),r===\"padding\"&&\"padding-right: \".concat(s,\"px \").concat(n,\";\")].filter(Boolean).join(\"\"),`\n  }\n  \n  .`).concat(Tv,` {\n    right: `).concat(s,\"px \").concat(n,`;\n  }\n  \n  .`).concat(Pv,` {\n    margin-right: `).concat(s,\"px \").concat(n,`;\n  }\n  \n  .`).concat(Tv,\" .\").concat(Tv,` {\n    right: 0 `).concat(n,`;\n  }\n  \n  .`).concat(Pv,\" .\").concat(Pv,` {\n    margin-right: 0 `).concat(n,`;\n  }\n  \n  body[`).concat(Dd,`] {\n    `).concat(Sie,\": \").concat(s,`px;\n  }\n`)},oI=function(){var t=parseInt(document.body.getAttribute(Dd)||\"0\",10);return isFinite(t)?t:0},Vie=function(){E.useEffect(function(){return document.body.setAttribute(Dd,(oI()+1).toString()),function(){var t=oI()-1;t<=0?document.body.removeAttribute(Dd):document.body.setAttribute(Dd,t.toString())}},[])},Uie=function(t){var e=t.noRelative,r=t.noImportant,n=t.gapMode,i=n===void 0?\"margin\":n;Vie();var a=E.useMemo(function(){return Lie(i)},[i]);return E.createElement(Bie,{styles:$ie(a,!e,i,r?\"\":\"!important\")})},nN=!1;if(typeof window<\"u\")try{var Xg=Object.defineProperty({},\"passive\",{get:function(){return nN=!0,!0}});window.addEventListener(\"test\",Xg,Xg),window.removeEventListener(\"test\",Xg,Xg)}catch{nN=!1}var nd=nN?{passive:!1}:!1,zie=function(t){return t.tagName===\"TEXTAREA\"},CU=function(t,e){if(!(t instanceof Element))return!1;var r=window.getComputedStyle(t);return r[e]!==\"hidden\"&&!(r.overflowY===r.overflowX&&!zie(t)&&r[e]===\"visible\")},Wie=function(t){return CU(t,\"overflowY\")},qie=function(t){return CU(t,\"overflowX\")},sI=function(t,e){var r=e.ownerDocument,n=e;do{typeof ShadowRoot<\"u\"&&n instanceof ShadowRoot&&(n=n.host);var i=AU(t,n);if(i){var a=NU(t,n),o=a[1],s=a[2];if(o>s)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},Hie=function(t){var e=t.scrollTop,r=t.scrollHeight,n=t.clientHeight;return[e,r,n]},Gie=function(t){var e=t.scrollLeft,r=t.scrollWidth,n=t.clientWidth;return[e,r,n]},AU=function(t,e){return t===\"v\"?Wie(e):qie(e)},NU=function(t,e){return t===\"v\"?Hie(e):Gie(e)},Kie=function(t,e){return t===\"h\"&&e===\"rtl\"?-1:1},Xie=function(t,e,r,n,i){var a=Kie(t,window.getComputedStyle(e).direction),o=a*n,s=r.target,c=e.contains(s),u=!1,f=o>0,h=0,m=0;do{if(!s)break;var g=NU(t,s),x=g[0],v=g[1],b=g[2],w=v-b-a*x;(x||w)&&AU(t,s)&&(h+=w,m+=x);var C=s.parentNode;s=C&&C.nodeType===Node.DOCUMENT_FRAGMENT_NODE?C.host:C}while(!c&&s!==document.body||c&&(e.contains(s)||e===s));return(f&&Math.abs(h)<1||!f&&Math.abs(m)<1)&&(u=!0),u},Yg=function(t){return\"changedTouches\"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},lI=function(t){return[t.deltaX,t.deltaY]},cI=function(t){return t&&\"current\"in t?t.current:t},Yie=function(t,e){return t[0]===e[0]&&t[1]===e[1]},Zie=function(t){return`\n  .block-interactivity-`.concat(t,` {pointer-events: none;}\n  .allow-interactivity-`).concat(t,` {pointer-events: all;}\n`)},Qie=0,id=[];function Jie(t){var e=E.useRef([]),r=E.useRef([0,0]),n=E.useRef(),i=E.useState(Qie++)[0],a=E.useState(_U)[0],o=E.useRef(t);E.useEffect(function(){o.current=t},[t]),E.useEffect(function(){if(t.inert){document.body.classList.add(\"block-interactivity-\".concat(i));var v=bie([t.lockRef.current],(t.shards||[]).map(cI),!0).filter(Boolean);return v.forEach(function(b){return b.classList.add(\"allow-interactivity-\".concat(i))}),function(){document.body.classList.remove(\"block-interactivity-\".concat(i)),v.forEach(function(b){return b.classList.remove(\"allow-interactivity-\".concat(i))})}}},[t.inert,t.lockRef.current,t.shards]);var s=E.useCallback(function(v,b){if(\"touches\"in v&&v.touches.length===2||v.type===\"wheel\"&&v.ctrlKey)return!o.current.allowPinchZoom;var w=Yg(v),C=r.current,_=\"deltaX\"in v?v.deltaX:C[0]-w[0],N=\"deltaY\"in v?v.deltaY:C[1]-w[1],A,T=v.target,P=Math.abs(_)>Math.abs(N)?\"h\":\"v\";if(\"touches\"in v&&P===\"h\"&&T.type===\"range\")return!1;var k=sI(P,T);if(!k)return!0;if(k?A=P:(A=P===\"v\"?\"h\":\"v\",k=sI(P,T)),!k)return!1;if(!n.current&&\"changedTouches\"in v&&(_||N)&&(n.current=A),!A)return!0;var I=n.current||A;return Xie(I,b,v,I===\"h\"?_:N)},[]),c=E.useCallback(function(v){var b=v;if(!(!id.length||id[id.length-1]!==a)){var w=\"deltaY\"in b?lI(b):Yg(b),C=e.current.filter(function(A){return A.name===b.type&&(A.target===b.target||b.target===A.shadowParent)&&Yie(A.delta,w)})[0];if(C&&C.should){b.cancelable&&b.preventDefault();return}if(!C){var _=(o.current.shards||[]).map(cI).filter(Boolean).filter(function(A){return A.contains(b.target)}),N=_.length>0?s(b,_[0]):!o.current.noIsolation;N&&b.cancelable&&b.preventDefault()}}},[]),u=E.useCallback(function(v,b,w,C){var _={name:v,delta:b,target:w,should:C,shadowParent:eae(w)};e.current.push(_),setTimeout(function(){e.current=e.current.filter(function(N){return N!==_})},1)},[]),f=E.useCallback(function(v){r.current=Yg(v),n.current=void 0},[]),h=E.useCallback(function(v){u(v.type,lI(v),v.target,s(v,t.lockRef.current))},[]),m=E.useCallback(function(v){u(v.type,Yg(v),v.target,s(v,t.lockRef.current))},[]);E.useEffect(function(){return id.push(a),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:m}),document.addEventListener(\"wheel\",c,nd),document.addEventListener(\"touchmove\",c,nd),document.addEventListener(\"touchstart\",f,nd),function(){id=id.filter(function(v){return v!==a}),document.removeEventListener(\"wheel\",c,nd),document.removeEventListener(\"touchmove\",c,nd),document.removeEventListener(\"touchstart\",f,nd)}},[]);var g=t.removeScrollBar,x=t.inert;return E.createElement(E.Fragment,null,x?E.createElement(a,{styles:Zie(i)}):null,g?E.createElement(Uie,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function eae(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const tae=Tie(SU,Jie);var Dx=E.forwardRef(function(t,e){return E.createElement(Mx,jo({},t,{ref:e,sideCar:tae}))});Dx.classNames=Mx.classNames;var rae=function(t){if(typeof document>\"u\")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},ad=new WeakMap,Zg=new WeakMap,Qg={},Yw=0,EU=function(t){return t&&(t.host||EU(t.parentNode))},nae=function(t,e){return e.map(function(r){if(t.contains(r))return r;var n=EU(r);return n&&t.contains(n)?n:(console.error(\"aria-hidden\",r,\"in not contained inside\",t,\". Doing nothing\"),null)}).filter(function(r){return!!r})},iae=function(t,e,r,n){var i=nae(e,Array.isArray(t)?t:[t]);Qg[r]||(Qg[r]=new WeakMap);var a=Qg[r],o=[],s=new Set,c=new Set(i),u=function(h){!h||s.has(h)||(s.add(h),u(h.parentNode))};i.forEach(u);var f=function(h){!h||c.has(h)||Array.prototype.forEach.call(h.children,function(m){if(s.has(m))f(m);else try{var g=m.getAttribute(n),x=g!==null&&g!==\"false\",v=(ad.get(m)||0)+1,b=(a.get(m)||0)+1;ad.set(m,v),a.set(m,b),o.push(m),v===1&&x&&Zg.set(m,!0),b===1&&m.setAttribute(r,\"true\"),x||m.setAttribute(n,\"true\")}catch(w){console.error(\"aria-hidden: cannot operate on \",m,w)}})};return f(e),s.clear(),Yw++,function(){o.forEach(function(h){var m=ad.get(h)-1,g=a.get(h)-1;ad.set(h,m),a.set(h,g),m||(Zg.has(h)||h.removeAttribute(n),Zg.delete(h)),g||h.removeAttribute(r)}),Yw--,Yw||(ad=new WeakMap,ad=new WeakMap,Zg=new WeakMap,Qg={})}},Vj=function(t,e,r){r===void 0&&(r=\"data-aria-hidden\");var n=Array.from(Array.isArray(t)?t:[t]),i=rae(t);return i?(n.push.apply(n,Array.from(i.querySelectorAll(\"[aria-live], script\"))),iae(n,i,r,\"aria-hidden\")):function(){return null}},Rx=\"Dialog\",[jU,TU]=Ia(Rx),[aae,mo]=jU(Rx),PU=t=>{const{__scopeDialog:e,children:r,open:n,defaultOpen:i,onOpenChange:a,modal:o=!0}=t,s=E.useRef(null),c=E.useRef(null),[u,f]=ks({prop:n,defaultProp:i??!1,onChange:a,caller:Rx});return l.jsx(aae,{scope:e,triggerRef:s,contentRef:c,contentId:Ro(),titleId:Ro(),descriptionId:Ro(),open:u,onOpenChange:f,onOpenToggle:E.useCallback(()=>f(h=>!h),[f]),modal:o,children:r})};PU.displayName=Rx;var OU=\"DialogTrigger\",kU=E.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,i=mo(OU,r),a=Dt(e,i.triggerRef);return l.jsx(pt.button,{type:\"button\",\"aria-haspopup\":\"dialog\",\"aria-expanded\":i.open,\"aria-controls\":i.contentId,\"data-state\":Wj(i.open),...n,ref:a,onClick:ht(t.onClick,i.onOpenToggle)})});kU.displayName=OU;var Uj=\"DialogPortal\",[oae,IU]=jU(Uj,{forceMount:void 0}),MU=t=>{const{__scopeDialog:e,forceMount:r,children:n,container:i}=t,a=mo(Uj,e);return l.jsx(oae,{scope:e,forceMount:r,children:E.Children.map(n,o=>l.jsx(tc,{present:r||a.open,children:l.jsx(Ix,{asChild:!0,container:i,children:o})}))})};MU.displayName=Uj;var Gv=\"DialogOverlay\",DU=E.forwardRef((t,e)=>{const r=IU(Gv,t.__scopeDialog),{forceMount:n=r.forceMount,...i}=t,a=mo(Gv,t.__scopeDialog);return a.modal?l.jsx(tc,{present:n||a.open,children:l.jsx(lae,{...i,ref:e})}):null});DU.displayName=Gv;var sae=fu(\"DialogOverlay.RemoveScroll\"),lae=E.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,i=mo(Gv,r);return l.jsx(Dx,{as:sae,allowPinchZoom:!0,shards:[i.contentRef],children:l.jsx(pt.div,{\"data-state\":Wj(i.open),...n,ref:e,style:{pointerEvents:\"auto\",...n.style}})})}),hu=\"DialogContent\",RU=E.forwardRef((t,e)=>{const r=IU(hu,t.__scopeDialog),{forceMount:n=r.forceMount,...i}=t,a=mo(hu,t.__scopeDialog);return l.jsx(tc,{present:n||a.open,children:a.modal?l.jsx(cae,{...i,ref:e}):l.jsx(uae,{...i,ref:e})})});RU.displayName=hu;var cae=E.forwardRef((t,e)=>{const r=mo(hu,t.__scopeDialog),n=E.useRef(null),i=Dt(e,r.contentRef,n);return E.useEffect(()=>{const a=n.current;if(a)return Vj(a)},[]),l.jsx(FU,{...t,ref:i,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ht(t.onCloseAutoFocus,a=>{var o;a.preventDefault(),(o=r.triggerRef.current)==null||o.focus()}),onPointerDownOutside:ht(t.onPointerDownOutside,a=>{const o=a.detail.originalEvent,s=o.button===0&&o.ctrlKey===!0;(o.button===2||s)&&a.preventDefault()}),onFocusOutside:ht(t.onFocusOutside,a=>a.preventDefault())})}),uae=E.forwardRef((t,e)=>{const r=mo(hu,t.__scopeDialog),n=E.useRef(!1),i=E.useRef(!1);return l.jsx(FU,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{var o,s;(o=t.onCloseAutoFocus)==null||o.call(t,a),a.defaultPrevented||(n.current||(s=r.triggerRef.current)==null||s.focus(),a.preventDefault()),n.current=!1,i.current=!1},onInteractOutside:a=>{var c,u;(c=t.onInteractOutside)==null||c.call(t,a),a.defaultPrevented||(n.current=!0,a.detail.originalEvent.type===\"pointerdown\"&&(i.current=!0));const o=a.target;((u=r.triggerRef.current)==null?void 0:u.contains(o))&&a.preventDefault(),a.detail.originalEvent.type===\"focusin\"&&i.current&&a.preventDefault()}})}),FU=E.forwardRef((t,e)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:i,onCloseAutoFocus:a,...o}=t,s=mo(hu,r),c=E.useRef(null),u=Dt(e,c);return $j(),l.jsxs(l.Fragment,{children:[l.jsx(kx,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:i,onUnmountAutoFocus:a,children:l.jsx(Ox,{role:\"dialog\",id:s.contentId,\"aria-describedby\":s.descriptionId,\"aria-labelledby\":s.titleId,\"data-state\":Wj(s.open),...o,ref:u,onDismiss:()=>s.onOpenChange(!1)})}),l.jsxs(l.Fragment,{children:[l.jsx(fae,{titleId:s.titleId}),l.jsx(pae,{contentRef:c,descriptionId:s.descriptionId})]})]})}),zj=\"DialogTitle\",LU=E.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,i=mo(zj,r);return l.jsx(pt.h2,{id:i.titleId,...n,ref:e})});LU.displayName=zj;var BU=\"DialogDescription\",$U=E.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,i=mo(BU,r);return l.jsx(pt.p,{id:i.descriptionId,...n,ref:e})});$U.displayName=BU;var VU=\"DialogClose\",UU=E.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,i=mo(VU,r);return l.jsx(pt.button,{type:\"button\",...n,ref:e,onClick:ht(t.onClick,()=>i.onOpenChange(!1))})});UU.displayName=VU;function Wj(t){return t?\"open\":\"closed\"}var zU=\"DialogTitleWarning\",[dae,WU]=$ne(zU,{contentName:hu,titleName:zj,docsSlug:\"dialog\"}),fae=({titleId:t})=>{const e=WU(zU),r=`\\`${e.contentName}\\` requires a \\`${e.titleName}\\` for the component to be accessible for screen reader users.\n\nIf you want to hide the \\`${e.titleName}\\`, you can wrap it with our VisuallyHidden component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return E.useEffect(()=>{t&&(document.getElementById(t)||console.error(r))},[r,t]),null},hae=\"DialogDescriptionWarning\",pae=({contentRef:t,descriptionId:e})=>{const n=`Warning: Missing \\`Description\\` or \\`aria-describedby={undefined}\\` for {${WU(hae).contentName}}.`;return E.useEffect(()=>{var a;const i=(a=t.current)==null?void 0:a.getAttribute(\"aria-describedby\");e&&i&&(document.getElementById(e)||console.warn(n))},[n,t,e]),null},qU=PU,HU=kU,GU=MU,qj=DU,Hj=RU,Gj=LU,Kj=$U,Xj=UU;function KU(t){var e,r,n=\"\";if(typeof t==\"string\"||typeof t==\"number\")n+=t;else if(typeof t==\"object\")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=KU(t[e]))&&(n&&(n+=\" \"),n+=r)}else for(r in t)t[r]&&(n&&(n+=\" \"),n+=r);return n}function Mt(){for(var t,e,r=0,n=\"\",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=KU(t))&&(n&&(n+=\" \"),n+=e);return n}const Yj=\"-\",mae=t=>{const e=vae(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:o=>{const s=o.split(Yj);return s[0]===\"\"&&s.length!==1&&s.shift(),XU(s,e)||gae(o)},getConflictingClassGroupIds:(o,s)=>{const c=r[o]||[];return s&&n[o]?[...c,...n[o]]:c}}},XU=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const r=t[0],n=e.nextPart.get(r),i=n?XU(t.slice(1),n):void 0;if(i)return i;if(e.validators.length===0)return;const a=t.join(Yj);return(o=e.validators.find(({validator:s})=>s(a)))==null?void 0:o.classGroupId},uI=/^\\[(.+)\\]$/,gae=t=>{if(uI.test(t)){const e=uI.exec(t)[1],r=e==null?void 0:e.substring(0,e.indexOf(\":\"));if(r)return\"arbitrary..\"+r}},vae=t=>{const{theme:e,prefix:r}=t,n={nextPart:new Map,validators:[]};return xae(Object.entries(t.classGroups),r).forEach(([a,o])=>{iN(o,n,a,e)}),n},iN=(t,e,r,n)=>{t.forEach(i=>{if(typeof i==\"string\"){const a=i===\"\"?e:dI(e,i);a.classGroupId=r;return}if(typeof i==\"function\"){if(yae(i)){iN(i(n),e,r,n);return}e.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([a,o])=>{iN(o,dI(e,a),r,n)})})},dI=(t,e)=>{let r=t;return e.split(Yj).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},yae=t=>t.isThemeGetter,xae=(t,e)=>e?t.map(([r,n])=>{const i=n.map(a=>typeof a==\"string\"?e+a:typeof a==\"object\"?Object.fromEntries(Object.entries(a).map(([o,s])=>[e+o,s])):a);return[r,i]}):t,bae=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,n=new Map;const i=(a,o)=>{r.set(a,o),e++,e>t&&(e=0,n=r,r=new Map)};return{get(a){let o=r.get(a);if(o!==void 0)return o;if((o=n.get(a))!==void 0)return i(a,o),o},set(a,o){r.has(a)?r.set(a,o):i(a,o)}}},YU=\"!\",wae=t=>{const{separator:e,experimentalParseClassName:r}=t,n=e.length===1,i=e[0],a=e.length,o=s=>{const c=[];let u=0,f=0,h;for(let b=0;b<s.length;b++){let w=s[b];if(u===0){if(w===i&&(n||s.slice(b,b+a)===e)){c.push(s.slice(f,b)),f=b+a;continue}if(w===\"/\"){h=b;continue}}w===\"[\"?u++:w===\"]\"&&u--}const m=c.length===0?s:s.substring(f),g=m.startsWith(YU),x=g?m.substring(1):m,v=h&&h>f?h-f:void 0;return{modifiers:c,hasImportantModifier:g,baseClassName:x,maybePostfixModifierPosition:v}};return r?s=>r({className:s,parseClassName:o}):o},Sae=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(n=>{n[0]===\"[\"?(e.push(...r.sort(),n),r=[]):r.push(n)}),e.push(...r.sort()),e},_ae=t=>({cache:bae(t.cacheSize),parseClassName:wae(t),...mae(t)}),Cae=/\\s+/,Aae=(t,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i}=e,a=[],o=t.trim().split(Cae);let s=\"\";for(let c=o.length-1;c>=0;c-=1){const u=o[c],{modifiers:f,hasImportantModifier:h,baseClassName:m,maybePostfixModifierPosition:g}=r(u);let x=!!g,v=n(x?m.substring(0,g):m);if(!v){if(!x){s=u+(s.length>0?\" \"+s:s);continue}if(v=n(m),!v){s=u+(s.length>0?\" \"+s:s);continue}x=!1}const b=Sae(f).join(\":\"),w=h?b+YU:b,C=w+v;if(a.includes(C))continue;a.push(C);const _=i(v,x);for(let N=0;N<_.length;++N){const A=_[N];a.push(w+A)}s=u+(s.length>0?\" \"+s:s)}return s};function Nae(){let t=0,e,r,n=\"\";for(;t<arguments.length;)(e=arguments[t++])&&(r=ZU(e))&&(n&&(n+=\" \"),n+=r);return n}const ZU=t=>{if(typeof t==\"string\")return t;let e,r=\"\";for(let n=0;n<t.length;n++)t[n]&&(e=ZU(t[n]))&&(r&&(r+=\" \"),r+=e);return r};function Eae(t,...e){let r,n,i,a=o;function o(c){const u=e.reduce((f,h)=>h(f),t());return r=_ae(u),n=r.cache.get,i=r.cache.set,a=s,s(c)}function s(c){const u=n(c);if(u)return u;const f=Aae(c,r);return i(c,f),f}return function(){return a(Nae.apply(null,arguments))}}const br=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},QU=/^\\[(?:([a-z-]+):)?(.+)\\]$/i,jae=/^\\d+\\/\\d+$/,Tae=new Set([\"px\",\"full\",\"screen\"]),Pae=/^(\\d+(\\.\\d+)?)?(xs|sm|md|lg|xl)$/,Oae=/\\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\\b(calc|min|max|clamp)\\(.+\\)|^0$/,kae=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\\(.+\\)$/,Iae=/^(inset_)?-?((\\d+)?\\.?(\\d+)[a-z]+|0)_-?((\\d+)?\\.?(\\d+)[a-z]+|0)/,Mae=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\\(.+\\)$/,ls=t=>Rd(t)||Tae.has(t)||jae.test(t),fl=t=>Gf(t,\"length\",Uae),Rd=t=>!!t&&!Number.isNaN(Number(t)),Zw=t=>Gf(t,\"number\",Rd),Yh=t=>!!t&&Number.isInteger(Number(t)),Dae=t=>t.endsWith(\"%\")&&Rd(t.slice(0,-1)),bt=t=>QU.test(t),hl=t=>Pae.test(t),Rae=new Set([\"length\",\"size\",\"percentage\"]),Fae=t=>Gf(t,Rae,JU),Lae=t=>Gf(t,\"position\",JU),Bae=new Set([\"image\",\"url\"]),$ae=t=>Gf(t,Bae,Wae),Vae=t=>Gf(t,\"\",zae),Zh=()=>!0,Gf=(t,e,r)=>{const n=QU.exec(t);return n?n[1]?typeof e==\"string\"?n[1]===e:e.has(n[1]):r(n[2]):!1},Uae=t=>Oae.test(t)&&!kae.test(t),JU=()=>!1,zae=t=>Iae.test(t),Wae=t=>Mae.test(t),qae=()=>{const t=br(\"colors\"),e=br(\"spacing\"),r=br(\"blur\"),n=br(\"brightness\"),i=br(\"borderColor\"),a=br(\"borderRadius\"),o=br(\"borderSpacing\"),s=br(\"borderWidth\"),c=br(\"contrast\"),u=br(\"grayscale\"),f=br(\"hueRotate\"),h=br(\"invert\"),m=br(\"gap\"),g=br(\"gradientColorStops\"),x=br(\"gradientColorStopPositions\"),v=br(\"inset\"),b=br(\"margin\"),w=br(\"opacity\"),C=br(\"padding\"),_=br(\"saturate\"),N=br(\"scale\"),A=br(\"sepia\"),T=br(\"skew\"),P=br(\"space\"),k=br(\"translate\"),I=()=>[\"auto\",\"contain\",\"none\"],R=()=>[\"auto\",\"hidden\",\"clip\",\"visible\",\"scroll\"],F=()=>[\"auto\",bt,e],D=()=>[bt,e],L=()=>[\"\",ls,fl],q=()=>[\"auto\",Rd,bt],W=()=>[\"bottom\",\"center\",\"left\",\"left-bottom\",\"left-top\",\"right\",\"right-bottom\",\"right-top\",\"top\"],V=()=>[\"solid\",\"dashed\",\"dotted\",\"double\",\"none\"],K=()=>[\"normal\",\"multiply\",\"screen\",\"overlay\",\"darken\",\"lighten\",\"color-dodge\",\"color-burn\",\"hard-light\",\"soft-light\",\"difference\",\"exclusion\",\"hue\",\"saturation\",\"color\",\"luminosity\"],z=()=>[\"start\",\"end\",\"center\",\"between\",\"around\",\"evenly\",\"stretch\"],re=()=>[\"\",\"0\",bt],ne=()=>[\"auto\",\"avoid\",\"all\",\"avoid-page\",\"page\",\"left\",\"right\",\"column\"],U=()=>[Rd,bt];return{cacheSize:500,separator:\":\",theme:{colors:[Zh],spacing:[ls,fl],blur:[\"none\",\"\",hl,bt],brightness:U(),borderColor:[t],borderRadius:[\"none\",\"\",\"full\",hl,bt],borderSpacing:D(),borderWidth:L(),contrast:U(),grayscale:re(),hueRotate:U(),invert:re(),gap:D(),gradientColorStops:[t],gradientColorStopPositions:[Dae,fl],inset:F(),margin:F(),opacity:U(),padding:D(),saturate:U(),scale:U(),sepia:re(),skew:U(),space:D(),translate:D()},classGroups:{aspect:[{aspect:[\"auto\",\"square\",\"video\",bt]}],container:[\"container\"],columns:[{columns:[hl]}],\"break-after\":[{\"break-after\":ne()}],\"break-before\":[{\"break-before\":ne()}],\"break-inside\":[{\"break-inside\":[\"auto\",\"avoid\",\"avoid-page\",\"avoid-column\"]}],\"box-decoration\":[{\"box-decoration\":[\"slice\",\"clone\"]}],box:[{box:[\"border\",\"content\"]}],display:[\"block\",\"inline-block\",\"inline\",\"flex\",\"inline-flex\",\"table\",\"inline-table\",\"table-caption\",\"table-cell\",\"table-column\",\"table-column-group\",\"table-footer-group\",\"table-header-group\",\"table-row-group\",\"table-row\",\"flow-root\",\"grid\",\"inline-grid\",\"contents\",\"list-item\",\"hidden\"],float:[{float:[\"right\",\"left\",\"none\",\"start\",\"end\"]}],clear:[{clear:[\"left\",\"right\",\"both\",\"none\",\"start\",\"end\"]}],isolation:[\"isolate\",\"isolation-auto\"],\"object-fit\":[{object:[\"contain\",\"cover\",\"fill\",\"none\",\"scale-down\"]}],\"object-position\":[{object:[...W(),bt]}],overflow:[{overflow:R()}],\"overflow-x\":[{\"overflow-x\":R()}],\"overflow-y\":[{\"overflow-y\":R()}],overscroll:[{overscroll:I()}],\"overscroll-x\":[{\"overscroll-x\":I()}],\"overscroll-y\":[{\"overscroll-y\":I()}],position:[\"static\",\"fixed\",\"absolute\",\"relative\",\"sticky\"],inset:[{inset:[v]}],\"inset-x\":[{\"inset-x\":[v]}],\"inset-y\":[{\"inset-y\":[v]}],start:[{start:[v]}],end:[{end:[v]}],top:[{top:[v]}],right:[{right:[v]}],bottom:[{bottom:[v]}],left:[{left:[v]}],visibility:[\"visible\",\"invisible\",\"collapse\"],z:[{z:[\"auto\",Yh,bt]}],basis:[{basis:F()}],\"flex-direction\":[{flex:[\"row\",\"row-reverse\",\"col\",\"col-reverse\"]}],\"flex-wrap\":[{flex:[\"wrap\",\"wrap-reverse\",\"nowrap\"]}],flex:[{flex:[\"1\",\"auto\",\"initial\",\"none\",bt]}],grow:[{grow:re()}],shrink:[{shrink:re()}],order:[{order:[\"first\",\"last\",\"none\",Yh,bt]}],\"grid-cols\":[{\"grid-cols\":[Zh]}],\"col-start-end\":[{col:[\"auto\",{span:[\"full\",Yh,bt]},bt]}],\"col-start\":[{\"col-start\":q()}],\"col-end\":[{\"col-end\":q()}],\"grid-rows\":[{\"grid-rows\":[Zh]}],\"row-start-end\":[{row:[\"auto\",{span:[Yh,bt]},bt]}],\"row-start\":[{\"row-start\":q()}],\"row-end\":[{\"row-end\":q()}],\"grid-flow\":[{\"grid-flow\":[\"row\",\"col\",\"dense\",\"row-dense\",\"col-dense\"]}],\"auto-cols\":[{\"auto-cols\":[\"auto\",\"min\",\"max\",\"fr\",bt]}],\"auto-rows\":[{\"auto-rows\":[\"auto\",\"min\",\"max\",\"fr\",bt]}],gap:[{gap:[m]}],\"gap-x\":[{\"gap-x\":[m]}],\"gap-y\":[{\"gap-y\":[m]}],\"justify-content\":[{justify:[\"normal\",...z()]}],\"justify-items\":[{\"justify-items\":[\"start\",\"end\",\"center\",\"stretch\"]}],\"justify-self\":[{\"justify-self\":[\"auto\",\"start\",\"end\",\"center\",\"stretch\"]}],\"align-content\":[{content:[\"normal\",...z(),\"baseline\"]}],\"align-items\":[{items:[\"start\",\"end\",\"center\",\"baseline\",\"stretch\"]}],\"align-self\":[{self:[\"auto\",\"start\",\"end\",\"center\",\"stretch\",\"baseline\"]}],\"place-content\":[{\"place-content\":[...z(),\"baseline\"]}],\"place-items\":[{\"place-items\":[\"start\",\"end\",\"center\",\"baseline\",\"stretch\"]}],\"place-self\":[{\"place-self\":[\"auto\",\"start\",\"end\",\"center\",\"stretch\"]}],p:[{p:[C]}],px:[{px:[C]}],py:[{py:[C]}],ps:[{ps:[C]}],pe:[{pe:[C]}],pt:[{pt:[C]}],pr:[{pr:[C]}],pb:[{pb:[C]}],pl:[{pl:[C]}],m:[{m:[b]}],mx:[{mx:[b]}],my:[{my:[b]}],ms:[{ms:[b]}],me:[{me:[b]}],mt:[{mt:[b]}],mr:[{mr:[b]}],mb:[{mb:[b]}],ml:[{ml:[b]}],\"space-x\":[{\"space-x\":[P]}],\"space-x-reverse\":[\"space-x-reverse\"],\"space-y\":[{\"space-y\":[P]}],\"space-y-reverse\":[\"space-y-reverse\"],w:[{w:[\"auto\",\"min\",\"max\",\"fit\",\"svw\",\"lvw\",\"dvw\",bt,e]}],\"min-w\":[{\"min-w\":[bt,e,\"min\",\"max\",\"fit\"]}],\"max-w\":[{\"max-w\":[bt,e,\"none\",\"full\",\"min\",\"max\",\"fit\",\"prose\",{screen:[hl]},hl]}],h:[{h:[bt,e,\"auto\",\"min\",\"max\",\"fit\",\"svh\",\"lvh\",\"dvh\"]}],\"min-h\":[{\"min-h\":[bt,e,\"min\",\"max\",\"fit\",\"svh\",\"lvh\",\"dvh\"]}],\"max-h\":[{\"max-h\":[bt,e,\"min\",\"max\",\"fit\",\"svh\",\"lvh\",\"dvh\"]}],size:[{size:[bt,e,\"auto\",\"min\",\"max\",\"fit\"]}],\"font-size\":[{text:[\"base\",hl,fl]}],\"font-smoothing\":[\"antialiased\",\"subpixel-antialiased\"],\"font-style\":[\"italic\",\"not-italic\"],\"font-weight\":[{font:[\"thin\",\"extralight\",\"light\",\"normal\",\"medium\",\"semibold\",\"bold\",\"extrabold\",\"black\",Zw]}],\"font-family\":[{font:[Zh]}],\"fvn-normal\":[\"normal-nums\"],\"fvn-ordinal\":[\"ordinal\"],\"fvn-slashed-zero\":[\"slashed-zero\"],\"fvn-figure\":[\"lining-nums\",\"oldstyle-nums\"],\"fvn-spacing\":[\"proportional-nums\",\"tabular-nums\"],\"fvn-fraction\":[\"diagonal-fractions\",\"stacked-fractions\"],tracking:[{tracking:[\"tighter\",\"tight\",\"normal\",\"wide\",\"wider\",\"widest\",bt]}],\"line-clamp\":[{\"line-clamp\":[\"none\",Rd,Zw]}],leading:[{leading:[\"none\",\"tight\",\"snug\",\"normal\",\"relaxed\",\"loose\",ls,bt]}],\"list-image\":[{\"list-image\":[\"none\",bt]}],\"list-style-type\":[{list:[\"none\",\"disc\",\"decimal\",bt]}],\"list-style-position\":[{list:[\"inside\",\"outside\"]}],\"placeholder-color\":[{placeholder:[t]}],\"placeholder-opacity\":[{\"placeholder-opacity\":[w]}],\"text-alignment\":[{text:[\"left\",\"center\",\"right\",\"justify\",\"start\",\"end\"]}],\"text-color\":[{text:[t]}],\"text-opacity\":[{\"text-opacity\":[w]}],\"text-decoration\":[\"underline\",\"overline\",\"line-through\",\"no-underline\"],\"text-decoration-style\":[{decoration:[...V(),\"wavy\"]}],\"text-decoration-thickness\":[{decoration:[\"auto\",\"from-font\",ls,fl]}],\"underline-offset\":[{\"underline-offset\":[\"auto\",ls,bt]}],\"text-decoration-color\":[{decoration:[t]}],\"text-transform\":[\"uppercase\",\"lowercase\",\"capitalize\",\"normal-case\"],\"text-overflow\":[\"truncate\",\"text-ellipsis\",\"text-clip\"],\"text-wrap\":[{text:[\"wrap\",\"nowrap\",\"balance\",\"pretty\"]}],indent:[{indent:D()}],\"vertical-align\":[{align:[\"baseline\",\"top\",\"middle\",\"bottom\",\"text-top\",\"text-bottom\",\"sub\",\"super\",bt]}],whitespace:[{whitespace:[\"normal\",\"nowrap\",\"pre\",\"pre-line\",\"pre-wrap\",\"break-spaces\"]}],break:[{break:[\"normal\",\"words\",\"all\",\"keep\"]}],hyphens:[{hyphens:[\"none\",\"manual\",\"auto\"]}],content:[{content:[\"none\",bt]}],\"bg-attachment\":[{bg:[\"fixed\",\"local\",\"scroll\"]}],\"bg-clip\":[{\"bg-clip\":[\"border\",\"padding\",\"content\",\"text\"]}],\"bg-opacity\":[{\"bg-opacity\":[w]}],\"bg-origin\":[{\"bg-origin\":[\"border\",\"padding\",\"content\"]}],\"bg-position\":[{bg:[...W(),Lae]}],\"bg-repeat\":[{bg:[\"no-repeat\",{repeat:[\"\",\"x\",\"y\",\"round\",\"space\"]}]}],\"bg-size\":[{bg:[\"auto\",\"cover\",\"contain\",Fae]}],\"bg-image\":[{bg:[\"none\",{\"gradient-to\":[\"t\",\"tr\",\"r\",\"br\",\"b\",\"bl\",\"l\",\"tl\"]},$ae]}],\"bg-color\":[{bg:[t]}],\"gradient-from-pos\":[{from:[x]}],\"gradient-via-pos\":[{via:[x]}],\"gradient-to-pos\":[{to:[x]}],\"gradient-from\":[{from:[g]}],\"gradient-via\":[{via:[g]}],\"gradient-to\":[{to:[g]}],rounded:[{rounded:[a]}],\"rounded-s\":[{\"rounded-s\":[a]}],\"rounded-e\":[{\"rounded-e\":[a]}],\"rounded-t\":[{\"rounded-t\":[a]}],\"rounded-r\":[{\"rounded-r\":[a]}],\"rounded-b\":[{\"rounded-b\":[a]}],\"rounded-l\":[{\"rounded-l\":[a]}],\"rounded-ss\":[{\"rounded-ss\":[a]}],\"rounded-se\":[{\"rounded-se\":[a]}],\"rounded-ee\":[{\"rounded-ee\":[a]}],\"rounded-es\":[{\"rounded-es\":[a]}],\"rounded-tl\":[{\"rounded-tl\":[a]}],\"rounded-tr\":[{\"rounded-tr\":[a]}],\"rounded-br\":[{\"rounded-br\":[a]}],\"rounded-bl\":[{\"rounded-bl\":[a]}],\"border-w\":[{border:[s]}],\"border-w-x\":[{\"border-x\":[s]}],\"border-w-y\":[{\"border-y\":[s]}],\"border-w-s\":[{\"border-s\":[s]}],\"border-w-e\":[{\"border-e\":[s]}],\"border-w-t\":[{\"border-t\":[s]}],\"border-w-r\":[{\"border-r\":[s]}],\"border-w-b\":[{\"border-b\":[s]}],\"border-w-l\":[{\"border-l\":[s]}],\"border-opacity\":[{\"border-opacity\":[w]}],\"border-style\":[{border:[...V(),\"hidden\"]}],\"divide-x\":[{\"divide-x\":[s]}],\"divide-x-reverse\":[\"divide-x-reverse\"],\"divide-y\":[{\"divide-y\":[s]}],\"divide-y-reverse\":[\"divide-y-reverse\"],\"divide-opacity\":[{\"divide-opacity\":[w]}],\"divide-style\":[{divide:V()}],\"border-color\":[{border:[i]}],\"border-color-x\":[{\"border-x\":[i]}],\"border-color-y\":[{\"border-y\":[i]}],\"border-color-s\":[{\"border-s\":[i]}],\"border-color-e\":[{\"border-e\":[i]}],\"border-color-t\":[{\"border-t\":[i]}],\"border-color-r\":[{\"border-r\":[i]}],\"border-color-b\":[{\"border-b\":[i]}],\"border-color-l\":[{\"border-l\":[i]}],\"divide-color\":[{divide:[i]}],\"outline-style\":[{outline:[\"\",...V()]}],\"outline-offset\":[{\"outline-offset\":[ls,bt]}],\"outline-w\":[{outline:[ls,fl]}],\"outline-color\":[{outline:[t]}],\"ring-w\":[{ring:L()}],\"ring-w-inset\":[\"ring-inset\"],\"ring-color\":[{ring:[t]}],\"ring-opacity\":[{\"ring-opacity\":[w]}],\"ring-offset-w\":[{\"ring-offset\":[ls,fl]}],\"ring-offset-color\":[{\"ring-offset\":[t]}],shadow:[{shadow:[\"\",\"inner\",\"none\",hl,Vae]}],\"shadow-color\":[{shadow:[Zh]}],opacity:[{opacity:[w]}],\"mix-blend\":[{\"mix-blend\":[...K(),\"plus-lighter\",\"plus-darker\"]}],\"bg-blend\":[{\"bg-blend\":K()}],filter:[{filter:[\"\",\"none\"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],\"drop-shadow\":[{\"drop-shadow\":[\"\",\"none\",hl,bt]}],grayscale:[{grayscale:[u]}],\"hue-rotate\":[{\"hue-rotate\":[f]}],invert:[{invert:[h]}],saturate:[{saturate:[_]}],sepia:[{sepia:[A]}],\"backdrop-filter\":[{\"backdrop-filter\":[\"\",\"none\"]}],\"backdrop-blur\":[{\"backdrop-blur\":[r]}],\"backdrop-brightness\":[{\"backdrop-brightness\":[n]}],\"backdrop-contrast\":[{\"backdrop-contrast\":[c]}],\"backdrop-grayscale\":[{\"backdrop-grayscale\":[u]}],\"backdrop-hue-rotate\":[{\"backdrop-hue-rotate\":[f]}],\"backdrop-invert\":[{\"backdrop-invert\":[h]}],\"backdrop-opacity\":[{\"backdrop-opacity\":[w]}],\"backdrop-saturate\":[{\"backdrop-saturate\":[_]}],\"backdrop-sepia\":[{\"backdrop-sepia\":[A]}],\"border-collapse\":[{border:[\"collapse\",\"separate\"]}],\"border-spacing\":[{\"border-spacing\":[o]}],\"border-spacing-x\":[{\"border-spacing-x\":[o]}],\"border-spacing-y\":[{\"border-spacing-y\":[o]}],\"table-layout\":[{table:[\"auto\",\"fixed\"]}],caption:[{caption:[\"top\",\"bottom\"]}],transition:[{transition:[\"none\",\"all\",\"\",\"colors\",\"opacity\",\"shadow\",\"transform\",bt]}],duration:[{duration:U()}],ease:[{ease:[\"linear\",\"in\",\"out\",\"in-out\",bt]}],delay:[{delay:U()}],animate:[{animate:[\"none\",\"spin\",\"ping\",\"pulse\",\"bounce\",bt]}],transform:[{transform:[\"\",\"gpu\",\"none\"]}],scale:[{scale:[N]}],\"scale-x\":[{\"scale-x\":[N]}],\"scale-y\":[{\"scale-y\":[N]}],rotate:[{rotate:[Yh,bt]}],\"translate-x\":[{\"translate-x\":[k]}],\"translate-y\":[{\"translate-y\":[k]}],\"skew-x\":[{\"skew-x\":[T]}],\"skew-y\":[{\"skew-y\":[T]}],\"transform-origin\":[{origin:[\"center\",\"top\",\"top-right\",\"right\",\"bottom-right\",\"bottom\",\"bottom-left\",\"left\",\"top-left\",bt]}],accent:[{accent:[\"auto\",t]}],appearance:[{appearance:[\"none\",\"auto\"]}],cursor:[{cursor:[\"auto\",\"default\",\"pointer\",\"wait\",\"text\",\"move\",\"help\",\"not-allowed\",\"none\",\"context-menu\",\"progress\",\"cell\",\"crosshair\",\"vertical-text\",\"alias\",\"copy\",\"no-drop\",\"grab\",\"grabbing\",\"all-scroll\",\"col-resize\",\"row-resize\",\"n-resize\",\"e-resize\",\"s-resize\",\"w-resize\",\"ne-resize\",\"nw-resize\",\"se-resize\",\"sw-resize\",\"ew-resize\",\"ns-resize\",\"nesw-resize\",\"nwse-resize\",\"zoom-in\",\"zoom-out\",bt]}],\"caret-color\":[{caret:[t]}],\"pointer-events\":[{\"pointer-events\":[\"none\",\"auto\"]}],resize:[{resize:[\"none\",\"y\",\"x\",\"\"]}],\"scroll-behavior\":[{scroll:[\"auto\",\"smooth\"]}],\"scroll-m\":[{\"scroll-m\":D()}],\"scroll-mx\":[{\"scroll-mx\":D()}],\"scroll-my\":[{\"scroll-my\":D()}],\"scroll-ms\":[{\"scroll-ms\":D()}],\"scroll-me\":[{\"scroll-me\":D()}],\"scroll-mt\":[{\"scroll-mt\":D()}],\"scroll-mr\":[{\"scroll-mr\":D()}],\"scroll-mb\":[{\"scroll-mb\":D()}],\"scroll-ml\":[{\"scroll-ml\":D()}],\"scroll-p\":[{\"scroll-p\":D()}],\"scroll-px\":[{\"scroll-px\":D()}],\"scroll-py\":[{\"scroll-py\":D()}],\"scroll-ps\":[{\"scroll-ps\":D()}],\"scroll-pe\":[{\"scroll-pe\":D()}],\"scroll-pt\":[{\"scroll-pt\":D()}],\"scroll-pr\":[{\"scroll-pr\":D()}],\"scroll-pb\":[{\"scroll-pb\":D()}],\"scroll-pl\":[{\"scroll-pl\":D()}],\"snap-align\":[{snap:[\"start\",\"end\",\"center\",\"align-none\"]}],\"snap-stop\":[{snap:[\"normal\",\"always\"]}],\"snap-type\":[{snap:[\"none\",\"x\",\"y\",\"both\"]}],\"snap-strictness\":[{snap:[\"mandatory\",\"proximity\"]}],touch:[{touch:[\"auto\",\"none\",\"manipulation\"]}],\"touch-x\":[{\"touch-pan\":[\"x\",\"left\",\"right\"]}],\"touch-y\":[{\"touch-pan\":[\"y\",\"up\",\"down\"]}],\"touch-pz\":[\"touch-pinch-zoom\"],select:[{select:[\"none\",\"text\",\"all\",\"auto\"]}],\"will-change\":[{\"will-change\":[\"auto\",\"scroll\",\"contents\",\"transform\",bt]}],fill:[{fill:[t,\"none\"]}],\"stroke-w\":[{stroke:[ls,fl,Zw]}],stroke:[{stroke:[t,\"none\"]}],sr:[\"sr-only\",\"not-sr-only\"],\"forced-color-adjust\":[{\"forced-color-adjust\":[\"auto\",\"none\"]}]},conflictingClassGroups:{overflow:[\"overflow-x\",\"overflow-y\"],overscroll:[\"overscroll-x\",\"overscroll-y\"],inset:[\"inset-x\",\"inset-y\",\"start\",\"end\",\"top\",\"right\",\"bottom\",\"left\"],\"inset-x\":[\"right\",\"left\"],\"inset-y\":[\"top\",\"bottom\"],flex:[\"basis\",\"grow\",\"shrink\"],gap:[\"gap-x\",\"gap-y\"],p:[\"px\",\"py\",\"ps\",\"pe\",\"pt\",\"pr\",\"pb\",\"pl\"],px:[\"pr\",\"pl\"],py:[\"pt\",\"pb\"],m:[\"mx\",\"my\",\"ms\",\"me\",\"mt\",\"mr\",\"mb\",\"ml\"],mx:[\"mr\",\"ml\"],my:[\"mt\",\"mb\"],size:[\"w\",\"h\"],\"font-size\":[\"leading\"],\"fvn-normal\":[\"fvn-ordinal\",\"fvn-slashed-zero\",\"fvn-figure\",\"fvn-spacing\",\"fvn-fraction\"],\"fvn-ordinal\":[\"fvn-normal\"],\"fvn-slashed-zero\":[\"fvn-normal\"],\"fvn-figure\":[\"fvn-normal\"],\"fvn-spacing\":[\"fvn-normal\"],\"fvn-fraction\":[\"fvn-normal\"],\"line-clamp\":[\"display\",\"overflow\"],rounded:[\"rounded-s\",\"rounded-e\",\"rounded-t\",\"rounded-r\",\"rounded-b\",\"rounded-l\",\"rounded-ss\",\"rounded-se\",\"rounded-ee\",\"rounded-es\",\"rounded-tl\",\"rounded-tr\",\"rounded-br\",\"rounded-bl\"],\"rounded-s\":[\"rounded-ss\",\"rounded-es\"],\"rounded-e\":[\"rounded-se\",\"rounded-ee\"],\"rounded-t\":[\"rounded-tl\",\"rounded-tr\"],\"rounded-r\":[\"rounded-tr\",\"rounded-br\"],\"rounded-b\":[\"rounded-br\",\"rounded-bl\"],\"rounded-l\":[\"rounded-tl\",\"rounded-bl\"],\"border-spacing\":[\"border-spacing-x\",\"border-spacing-y\"],\"border-w\":[\"border-w-s\",\"border-w-e\",\"border-w-t\",\"border-w-r\",\"border-w-b\",\"border-w-l\"],\"border-w-x\":[\"border-w-r\",\"border-w-l\"],\"border-w-y\":[\"border-w-t\",\"border-w-b\"],\"border-color\":[\"border-color-s\",\"border-color-e\",\"border-color-t\",\"border-color-r\",\"border-color-b\",\"border-color-l\"],\"border-color-x\":[\"border-color-r\",\"border-color-l\"],\"border-color-y\":[\"border-color-t\",\"border-color-b\"],\"scroll-m\":[\"scroll-mx\",\"scroll-my\",\"scroll-ms\",\"scroll-me\",\"scroll-mt\",\"scroll-mr\",\"scroll-mb\",\"scroll-ml\"],\"scroll-mx\":[\"scroll-mr\",\"scroll-ml\"],\"scroll-my\":[\"scroll-mt\",\"scroll-mb\"],\"scroll-p\":[\"scroll-px\",\"scroll-py\",\"scroll-ps\",\"scroll-pe\",\"scroll-pt\",\"scroll-pr\",\"scroll-pb\",\"scroll-pl\"],\"scroll-px\":[\"scroll-pr\",\"scroll-pl\"],\"scroll-py\":[\"scroll-pt\",\"scroll-pb\"],touch:[\"touch-x\",\"touch-y\",\"touch-pz\"],\"touch-x\":[\"touch\"],\"touch-y\":[\"touch\"],\"touch-pz\":[\"touch\"]},conflictingClassGroupModifiers:{\"font-size\":[\"leading\"]}}},Hae=Eae(qae);function dt(...t){return Hae(Mt(t))}const Zj=qU,Gae=HU,Kae=GU,ez=E.forwardRef(({className:t,...e},r)=>l.jsx(qj,{ref:r,className:dt(\"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",t),...e}));ez.displayName=qj.displayName;const Fx=E.forwardRef(({className:t,children:e,...r},n)=>l.jsxs(Kae,{children:[l.jsx(ez,{}),l.jsxs(Hj,{ref:n,className:dt(\"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border-2 border-gray-300 bg-white dark:bg-gray-800 text-gray-900 dark:text-white p-6 shadow-2xl backdrop-blur-sm duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",t),...r,children:[e,l.jsxs(Xj,{className:\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\",children:[l.jsx(Wl,{className:\"h-4 w-4\"}),l.jsx(\"span\",{className:\"sr-only\",children:\"Close\"})]})]})]}));Fx.displayName=Hj.displayName;const Qj=({className:t,...e})=>l.jsx(\"div\",{className:dt(\"flex flex-col space-y-1.5 text-center sm:text-left\",t),...e});Qj.displayName=\"DialogHeader\";const Lx=E.forwardRef(({className:t,...e},r)=>l.jsx(Gj,{ref:r,className:dt(\"text-lg font-semibold leading-none tracking-tight\",t),...e}));Lx.displayName=Gj.displayName;const Bx=E.forwardRef(({className:t,...e},r)=>l.jsx(Kj,{ref:r,className:dt(\"text-sm font-medium text-gray-700 dark:text-gray-300\",t),...e}));Bx.displayName=Kj.displayName;const fI=t=>typeof t==\"boolean\"?`${t}`:t===0?\"0\":t,hI=Mt,$x=(t,e)=>r=>{var n;if((e==null?void 0:e.variants)==null)return hI(t,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:i,defaultVariants:a}=e,o=Object.keys(i).map(u=>{const f=r==null?void 0:r[u],h=a==null?void 0:a[u];if(f===null)return null;const m=fI(f)||fI(h);return i[u][m]}),s=r&&Object.entries(r).reduce((u,f)=>{let[h,m]=f;return m===void 0||(u[h]=m),u},{}),c=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((u,f)=>{let{class:h,className:m,...g}=f;return Object.entries(g).every(x=>{let[v,b]=x;return Array.isArray(b)?b.includes({...a,...s}[v]):{...a,...s}[v]===b})?[...u,h,m]:u},[]);return hI(t,o,c,r==null?void 0:r.class,r==null?void 0:r.className)},Jj=$x(\"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",{variants:{variant:{default:\"bg-primary text-primary-foreground hover:bg-primary/90\",destructive:\"bg-destructive text-destructive-foreground hover:bg-destructive/90\",outline:\"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",secondary:\"bg-secondary text-secondary-foreground hover:bg-secondary/80\",ghost:\"hover:bg-accent hover:text-accent-foreground\",link:\"text-primary underline-offset-4 hover:underline\"},size:{default:\"h-10 px-4 py-2\",sm:\"h-9 rounded-md px-3\",lg:\"h-11 rounded-md px-8\",icon:\"h-10 w-10\"}},defaultVariants:{variant:\"default\",size:\"default\"}}),Oe=E.forwardRef(({className:t,variant:e,size:r,asChild:n=!1,...i},a)=>{const o=n?mU:\"button\";return l.jsx(o,{className:dt(Jj({variant:e,size:r,className:t})),ref:a,...i})});Oe.displayName=\"Button\";function Xae(t,e){var r=Object.setPrototypeOf;r?r(t,e):t.__proto__=e}function Yae(t,e){e===void 0&&(e=t.constructor);var r=Error.captureStackTrace;r&&r(t,e)}var Zae=(function(){var t=function(r,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(i[o]=a[o])},t(r,n)};return function(e,r){if(typeof r!=\"function\"&&r!==null)throw new TypeError(\"Class extends value \"+String(r)+\" is not a constructor or null\");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),Qae=(function(t){Zae(e,t);function e(r,n){var i=this.constructor,a=t.call(this,r,n)||this;return Object.defineProperty(a,\"name\",{value:i.name,enumerable:!1,configurable:!0}),Xae(a,i.prototype),Yae(a),a}return e})(Error),Jae=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),Ni=(function(t){Jae(e,t);function e(r){r===void 0&&(r=void 0);var n=t.call(this,r)||this;return n.message=r,n}return e.prototype.getKind=function(){var r=this.constructor;return r.kind},e.kind=\"Exception\",e})(Qae),eoe=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),$r=(function(t){eoe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind=\"ArgumentException\",e})(Ni),toe=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),it=(function(t){toe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind=\"IllegalArgumentException\",e})(Ni),e3=(function(){function t(e){if(this.binarizer=e,e===null)throw new it(\"Binarizer must be non-null.\")}return t.prototype.getWidth=function(){return this.binarizer.getWidth()},t.prototype.getHeight=function(){return this.binarizer.getHeight()},t.prototype.getBlackRow=function(e,r){return this.binarizer.getBlackRow(e,r)},t.prototype.getBlackMatrix=function(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix},t.prototype.isCropSupported=function(){return this.binarizer.getLuminanceSource().isCropSupported()},t.prototype.crop=function(e,r,n,i){var a=this.binarizer.getLuminanceSource().crop(e,r,n,i);return new t(this.binarizer.createBinarizer(a))},t.prototype.isRotateSupported=function(){return this.binarizer.getLuminanceSource().isRotateSupported()},t.prototype.rotateCounterClockwise=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new t(this.binarizer.createBinarizer(e))},t.prototype.rotateCounterClockwise45=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new t(this.binarizer.createBinarizer(e))},t.prototype.toString=function(){try{return this.getBlackMatrix().toString()}catch{return\"\"}},t})(),roe=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),Yr=(function(t){roe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.getChecksumInstance=function(){return new e},e.kind=\"ChecksumException\",e})(Ni),tz=(function(){function t(e){this.source=e}return t.prototype.getLuminanceSource=function(){return this.source},t.prototype.getWidth=function(){return this.source.getWidth()},t.prototype.getHeight=function(){return this.source.getHeight()},t})(),cr=(function(){function t(){}return t.arraycopy=function(e,r,n,i,a){for(;a--;)n[i++]=e[r++]},t.currentTimeMillis=function(){return Date.now()},t})(),noe=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),t3=(function(t){noe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind=\"IndexOutOfBoundsException\",e})(Ni),ioe=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),pI=(function(t){ioe(e,t);function e(r,n){r===void 0&&(r=void 0),n===void 0&&(n=void 0);var i=t.call(this,n)||this;return i.index=r,i.message=n,i}return e.kind=\"ArrayIndexOutOfBoundsException\",e})(t3),aoe=function(t){var e=typeof Symbol==\"function\"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length==\"number\")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")},an=(function(){function t(){}return t.fill=function(e,r){for(var n=0,i=e.length;n<i;n++)e[n]=r},t.fillWithin=function(e,r,n,i){t.rangeCheck(e.length,r,n);for(var a=r;a<n;a++)e[a]=i},t.rangeCheck=function(e,r,n){if(r>n)throw new it(\"fromIndex(\"+r+\") > toIndex(\"+n+\")\");if(r<0)throw new pI(r);if(n>e)throw new pI(n)},t.asList=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e},t.create=function(e,r,n){var i=Array.from({length:e});return i.map(function(a){return Array.from({length:r}).fill(n)})},t.createInt32Array=function(e,r,n){var i=Array.from({length:e});return i.map(function(a){return Int32Array.from({length:r}).fill(n)})},t.equals=function(e,r){if(!e||!r||!e.length||!r.length||e.length!==r.length)return!1;for(var n=0,i=e.length;n<i;n++)if(e[n]!==r[n])return!1;return!0},t.hashCode=function(e){var r,n;if(e===null)return 0;var i=1;try{for(var a=aoe(e),o=a.next();!o.done;o=a.next()){var s=o.value;i=31*i+s}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return i},t.fillUint8Array=function(e,r){for(var n=0;n!==e.length;n++)e[n]=r},t.copyOf=function(e,r){return e.slice(0,r)},t.copyOfUint8Array=function(e,r){if(e.length<=r){var n=new Uint8Array(r);return n.set(e),n}return e.slice(0,r)},t.copyOfRange=function(e,r,n){var i=n-r,a=new Int32Array(i);return cr.arraycopy(e,r,a,0,i),a},t.binarySearch=function(e,r,n){n===void 0&&(n=t.numberComparator);for(var i=0,a=e.length-1;i<=a;){var o=a+i>>1,s=n(r,e[o]);if(s>0)i=o+1;else if(s<0)a=o-1;else return o}return-i-1},t.numberComparator=function(e,r){return e-r},t})(),At=(function(){function t(){}return t.numberOfTrailingZeros=function(e){var r;if(e===0)return 32;var n=31;return r=e<<16,r!==0&&(n-=16,e=r),r=e<<8,r!==0&&(n-=8,e=r),r=e<<4,r!==0&&(n-=4,e=r),r=e<<2,r!==0&&(n-=2,e=r),n-(e<<1>>>31)},t.numberOfLeadingZeros=function(e){if(e===0)return 32;var r=1;return e>>>16||(r+=16,e<<=16),e>>>24||(r+=8,e<<=8),e>>>28||(r+=4,e<<=4),e>>>30||(r+=2,e<<=2),r-=e>>>31,r},t.toHexString=function(e){return e.toString(16)},t.toBinaryString=function(e){return String(parseInt(String(e),2))},t.bitCount=function(e){return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),e=e+(e>>>4)&252645135,e=e+(e>>>8),e=e+(e>>>16),e&63},t.truncDivision=function(e,r){return Math.trunc(e/r)},t.parseInt=function(e,r){return r===void 0&&(r=void 0),parseInt(e,r)},t.MIN_VALUE_32_BITS=-2147483648,t.MAX_VALUE=Number.MAX_SAFE_INTEGER,t})(),yn=(function(){function t(e,r){e===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,r==null?this.bits=t.makeArray(e):this.bits=r)}return t.prototype.getSize=function(){return this.size},t.prototype.getSizeInBytes=function(){return Math.floor((this.size+7)/8)},t.prototype.ensureCapacity=function(e){if(e>this.bits.length*32){var r=t.makeArray(e);cr.arraycopy(this.bits,0,r,0,this.bits.length),this.bits=r}},t.prototype.get=function(e){return(this.bits[Math.floor(e/32)]&1<<(e&31))!==0},t.prototype.set=function(e){this.bits[Math.floor(e/32)]|=1<<(e&31)},t.prototype.flip=function(e){this.bits[Math.floor(e/32)]^=1<<(e&31)},t.prototype.getNextSet=function(e){var r=this.size;if(e>=r)return r;var n=this.bits,i=Math.floor(e/32),a=n[i];a&=~((1<<(e&31))-1);for(var o=n.length;a===0;){if(++i===o)return r;a=n[i]}var s=i*32+At.numberOfTrailingZeros(a);return s>r?r:s},t.prototype.getNextUnset=function(e){var r=this.size;if(e>=r)return r;var n=this.bits,i=Math.floor(e/32),a=~n[i];a&=~((1<<(e&31))-1);for(var o=n.length;a===0;){if(++i===o)return r;a=~n[i]}var s=i*32+At.numberOfTrailingZeros(a);return s>r?r:s},t.prototype.setBulk=function(e,r){this.bits[Math.floor(e/32)]=r},t.prototype.setRange=function(e,r){if(r<e||e<0||r>this.size)throw new it;if(r!==e){r--;for(var n=Math.floor(e/32),i=Math.floor(r/32),a=this.bits,o=n;o<=i;o++){var s=o>n?0:e&31,c=o<i?31:r&31,u=(2<<c)-(1<<s);a[o]|=u}}},t.prototype.clear=function(){for(var e=this.bits.length,r=this.bits,n=0;n<e;n++)r[n]=0},t.prototype.isRange=function(e,r,n){if(r<e||e<0||r>this.size)throw new it;if(r===e)return!0;r--;for(var i=Math.floor(e/32),a=Math.floor(r/32),o=this.bits,s=i;s<=a;s++){var c=s>i?0:e&31,u=s<a?31:r&31,f=(2<<u)-(1<<c)&4294967295;if((o[s]&f)!==(n?f:0))return!1}return!0},t.prototype.appendBit=function(e){this.ensureCapacity(this.size+1),e&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++},t.prototype.appendBits=function(e,r){if(r<0||r>32)throw new it(\"Num bits must be between 0 and 32\");this.ensureCapacity(this.size+r);for(var n=r;n>0;n--)this.appendBit((e>>n-1&1)===1)},t.prototype.appendBitArray=function(e){var r=e.size;this.ensureCapacity(this.size+r);for(var n=0;n<r;n++)this.appendBit(e.get(n))},t.prototype.xor=function(e){if(this.size!==e.size)throw new it(\"Sizes don't match\");for(var r=this.bits,n=0,i=r.length;n<i;n++)r[n]^=e.bits[n]},t.prototype.toBytes=function(e,r,n,i){for(var a=0;a<i;a++){for(var o=0,s=0;s<8;s++)this.get(e)&&(o|=1<<7-s),e++;r[n+a]=o}},t.prototype.getBitArray=function(){return this.bits},t.prototype.reverse=function(){for(var e=new Int32Array(this.bits.length),r=Math.floor((this.size-1)/32),n=r+1,i=this.bits,a=0;a<n;a++){var o=i[a];o=o>>1&1431655765|(o&1431655765)<<1,o=o>>2&858993459|(o&858993459)<<2,o=o>>4&252645135|(o&252645135)<<4,o=o>>8&16711935|(o&16711935)<<8,o=o>>16&65535|(o&65535)<<16,e[r-a]=o}if(this.size!==n*32){for(var s=n*32-this.size,c=e[0]>>>s,a=1;a<n;a++){var u=e[a];c|=u<<32-s,e[a-1]=c,c=u>>>s}e[n-1]=c}this.bits=e},t.makeArray=function(e){return new Int32Array(Math.floor((e+31)/32))},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.size===r.size&&an.equals(this.bits,r.bits)},t.prototype.hashCode=function(){return 31*this.size+an.hashCode(this.bits)},t.prototype.toString=function(){for(var e=\"\",r=0,n=this.size;r<n;r++)(r&7)===0&&(e+=\" \"),e+=this.get(r)?\"X\":\".\";return e},t.prototype.clone=function(){return new t(this.size,this.bits.slice())},t.prototype.toArray=function(){for(var e=[],r=0,n=this.size;r<n;r++)e.push(this.get(r));return e},t})(),aN;(function(t){t[t.OTHER=0]=\"OTHER\",t[t.PURE_BARCODE=1]=\"PURE_BARCODE\",t[t.POSSIBLE_FORMATS=2]=\"POSSIBLE_FORMATS\",t[t.TRY_HARDER=3]=\"TRY_HARDER\",t[t.CHARACTER_SET=4]=\"CHARACTER_SET\",t[t.ALLOWED_LENGTHS=5]=\"ALLOWED_LENGTHS\",t[t.ASSUME_CODE_39_CHECK_DIGIT=6]=\"ASSUME_CODE_39_CHECK_DIGIT\",t[t.ENABLE_CODE_39_EXTENDED_MODE=7]=\"ENABLE_CODE_39_EXTENDED_MODE\",t[t.ASSUME_GS1=8]=\"ASSUME_GS1\",t[t.RETURN_CODABAR_START_END=9]=\"RETURN_CODABAR_START_END\",t[t.NEED_RESULT_POINT_CALLBACK=10]=\"NEED_RESULT_POINT_CALLBACK\",t[t.ALLOWED_EAN_EXTENSIONS=11]=\"ALLOWED_EAN_EXTENSIONS\"})(aN||(aN={}));const ur=aN;var ooe=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),Pe=(function(t){ooe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.getFormatInstance=function(){return new e},e.kind=\"FormatException\",e})(Ni),soe=function(t){var e=typeof Symbol==\"function\"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length==\"number\")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")},Jt;(function(t){t[t.Cp437=0]=\"Cp437\",t[t.ISO8859_1=1]=\"ISO8859_1\",t[t.ISO8859_2=2]=\"ISO8859_2\",t[t.ISO8859_3=3]=\"ISO8859_3\",t[t.ISO8859_4=4]=\"ISO8859_4\",t[t.ISO8859_5=5]=\"ISO8859_5\",t[t.ISO8859_6=6]=\"ISO8859_6\",t[t.ISO8859_7=7]=\"ISO8859_7\",t[t.ISO8859_8=8]=\"ISO8859_8\",t[t.ISO8859_9=9]=\"ISO8859_9\",t[t.ISO8859_10=10]=\"ISO8859_10\",t[t.ISO8859_11=11]=\"ISO8859_11\",t[t.ISO8859_13=12]=\"ISO8859_13\",t[t.ISO8859_14=13]=\"ISO8859_14\",t[t.ISO8859_15=14]=\"ISO8859_15\",t[t.ISO8859_16=15]=\"ISO8859_16\",t[t.SJIS=16]=\"SJIS\",t[t.Cp1250=17]=\"Cp1250\",t[t.Cp1251=18]=\"Cp1251\",t[t.Cp1252=19]=\"Cp1252\",t[t.Cp1256=20]=\"Cp1256\",t[t.UnicodeBigUnmarked=21]=\"UnicodeBigUnmarked\",t[t.UTF8=22]=\"UTF8\",t[t.ASCII=23]=\"ASCII\",t[t.Big5=24]=\"Big5\",t[t.GB18030=25]=\"GB18030\",t[t.EUC_KR=26]=\"EUC_KR\"})(Jt||(Jt={}));var nn=(function(){function t(e,r,n){for(var i,a,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];this.valueIdentifier=e,this.name=n,typeof r==\"number\"?this.values=Int32Array.from([r]):this.values=r,this.otherEncodingNames=o,t.VALUE_IDENTIFIER_TO_ECI.set(e,this),t.NAME_TO_ECI.set(n,this);for(var c=this.values,u=0,f=c.length;u!==f;u++){var h=c[u];t.VALUES_TO_ECI.set(h,this)}try{for(var m=soe(o),g=m.next();!g.done;g=m.next()){var x=g.value;t.NAME_TO_ECI.set(x,this)}}catch(v){i={error:v}}finally{try{g&&!g.done&&(a=m.return)&&a.call(m)}finally{if(i)throw i.error}}}return t.prototype.getValueIdentifier=function(){return this.valueIdentifier},t.prototype.getName=function(){return this.name},t.prototype.getValue=function(){return this.values[0]},t.getCharacterSetECIByValue=function(e){if(e<0||e>=900)throw new Pe(\"incorect value\");var r=t.VALUES_TO_ECI.get(e);if(r===void 0)throw new Pe(\"incorect value\");return r},t.getCharacterSetECIByName=function(e){var r=t.NAME_TO_ECI.get(e);if(r===void 0)throw new Pe(\"incorect value\");return r},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.getName()===r.getName()},t.VALUE_IDENTIFIER_TO_ECI=new Map,t.VALUES_TO_ECI=new Map,t.NAME_TO_ECI=new Map,t.Cp437=new t(Jt.Cp437,Int32Array.from([0,2]),\"Cp437\"),t.ISO8859_1=new t(Jt.ISO8859_1,Int32Array.from([1,3]),\"ISO-8859-1\",\"ISO88591\",\"ISO8859_1\"),t.ISO8859_2=new t(Jt.ISO8859_2,4,\"ISO-8859-2\",\"ISO88592\",\"ISO8859_2\"),t.ISO8859_3=new t(Jt.ISO8859_3,5,\"ISO-8859-3\",\"ISO88593\",\"ISO8859_3\"),t.ISO8859_4=new t(Jt.ISO8859_4,6,\"ISO-8859-4\",\"ISO88594\",\"ISO8859_4\"),t.ISO8859_5=new t(Jt.ISO8859_5,7,\"ISO-8859-5\",\"ISO88595\",\"ISO8859_5\"),t.ISO8859_6=new t(Jt.ISO8859_6,8,\"ISO-8859-6\",\"ISO88596\",\"ISO8859_6\"),t.ISO8859_7=new t(Jt.ISO8859_7,9,\"ISO-8859-7\",\"ISO88597\",\"ISO8859_7\"),t.ISO8859_8=new t(Jt.ISO8859_8,10,\"ISO-8859-8\",\"ISO88598\",\"ISO8859_8\"),t.ISO8859_9=new t(Jt.ISO8859_9,11,\"ISO-8859-9\",\"ISO88599\",\"ISO8859_9\"),t.ISO8859_10=new t(Jt.ISO8859_10,12,\"ISO-8859-10\",\"ISO885910\",\"ISO8859_10\"),t.ISO8859_11=new t(Jt.ISO8859_11,13,\"ISO-8859-11\",\"ISO885911\",\"ISO8859_11\"),t.ISO8859_13=new t(Jt.ISO8859_13,15,\"ISO-8859-13\",\"ISO885913\",\"ISO8859_13\"),t.ISO8859_14=new t(Jt.ISO8859_14,16,\"ISO-8859-14\",\"ISO885914\",\"ISO8859_14\"),t.ISO8859_15=new t(Jt.ISO8859_15,17,\"ISO-8859-15\",\"ISO885915\",\"ISO8859_15\"),t.ISO8859_16=new t(Jt.ISO8859_16,18,\"ISO-8859-16\",\"ISO885916\",\"ISO8859_16\"),t.SJIS=new t(Jt.SJIS,20,\"SJIS\",\"Shift_JIS\"),t.Cp1250=new t(Jt.Cp1250,21,\"Cp1250\",\"windows-1250\"),t.Cp1251=new t(Jt.Cp1251,22,\"Cp1251\",\"windows-1251\"),t.Cp1252=new t(Jt.Cp1252,23,\"Cp1252\",\"windows-1252\"),t.Cp1256=new t(Jt.Cp1256,24,\"Cp1256\",\"windows-1256\"),t.UnicodeBigUnmarked=new t(Jt.UnicodeBigUnmarked,25,\"UnicodeBigUnmarked\",\"UTF-16BE\",\"UnicodeBig\"),t.UTF8=new t(Jt.UTF8,26,\"UTF8\",\"UTF-8\"),t.ASCII=new t(Jt.ASCII,Int32Array.from([27,170]),\"ASCII\",\"US-ASCII\"),t.Big5=new t(Jt.Big5,28,\"Big5\"),t.GB18030=new t(Jt.GB18030,29,\"GB18030\",\"GB2312\",\"EUC_CN\",\"GBK\"),t.EUC_KR=new t(Jt.EUC_KR,30,\"EUC_KR\",\"EUC-KR\"),t})(),loe=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),Op=(function(t){loe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind=\"UnsupportedOperationException\",e})(Ni),ta=(function(){function t(){}return t.decode=function(e,r){var n=this.encodingName(r);return this.customDecoder?this.customDecoder(e,n):typeof TextDecoder>\"u\"||this.shouldDecodeOnFallback(n)?this.decodeFallback(e,n):new TextDecoder(n).decode(e)},t.shouldDecodeOnFallback=function(e){return!t.isBrowser()&&e===\"ISO-8859-1\"},t.encode=function(e,r){var n=this.encodingName(r);return this.customEncoder?this.customEncoder(e,n):typeof TextEncoder>\"u\"?this.encodeFallback(e):new TextEncoder().encode(e)},t.isBrowser=function(){return typeof window<\"u\"&&{}.toString.call(window)===\"[object Window]\"},t.encodingName=function(e){return typeof e==\"string\"?e:e.getName()},t.encodingCharacterSet=function(e){return e instanceof nn?e:nn.getCharacterSetECIByName(e)},t.decodeFallback=function(e,r){var n=this.encodingCharacterSet(r);if(t.isDecodeFallbackSupported(n)){for(var i=\"\",a=0,o=e.length;a<o;a++){var s=e[a].toString(16);s.length<2&&(s=\"0\"+s),i+=\"%\"+s}return decodeURIComponent(i)}if(n.equals(nn.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(e.buffer));throw new Op(\"Encoding \"+this.encodingName(r)+\" not supported by fallback.\")},t.isDecodeFallbackSupported=function(e){return e.equals(nn.UTF8)||e.equals(nn.ISO8859_1)||e.equals(nn.ASCII)},t.encodeFallback=function(e){for(var r=btoa(unescape(encodeURIComponent(e))),n=r.split(\"\"),i=[],a=0;a<n.length;a++)i.push(n[a].charCodeAt(0));return new Uint8Array(i)},t})(),kt=(function(){function t(){}return t.castAsNonUtf8Char=function(e,r){r===void 0&&(r=null);var n=r?r.getName():this.ISO88591;return ta.decode(new Uint8Array([e]),n)},t.guessEncoding=function(e,r){if(r!=null&&r.get(ur.CHARACTER_SET)!==void 0)return r.get(ur.CHARACTER_SET).toString();for(var n=e.length,i=!0,a=!0,o=!0,s=0,c=0,u=0,f=0,h=0,m=0,g=0,x=0,v=0,b=0,w=0,C=e.length>3&&e[0]===239&&e[1]===187&&e[2]===191,_=0;_<n&&(i||a||o);_++){var N=e[_]&255;o&&(s>0?(N&128)===0?o=!1:s--:(N&128)!==0&&((N&64)===0?o=!1:(s++,(N&32)===0?c++:(s++,(N&16)===0?u++:(s++,(N&8)===0?f++:o=!1))))),i&&(N>127&&N<160?i=!1:N>159&&(N<192||N===215||N===247)&&w++),a&&(h>0?N<64||N===127||N>252?a=!1:h--:N===128||N===160||N>239?a=!1:N>160&&N<224?(m++,x=0,g++,g>v&&(v=g)):N>127?(h++,g=0,x++,x>b&&(b=x)):(g=0,x=0))}return o&&s>0&&(o=!1),a&&h>0&&(a=!1),o&&(C||c+u+f>0)?t.UTF8:a&&(t.ASSUME_SHIFT_JIS||v>=3||b>=3)?t.SHIFT_JIS:i&&a?v===2&&m===2||w*10>=n?t.SHIFT_JIS:t.ISO88591:i?t.ISO88591:a?t.SHIFT_JIS:o?t.UTF8:t.PLATFORM_DEFAULT_ENCODING},t.format=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var i=-1;function a(s,c,u,f,h,m){if(s===\"%%\")return\"%\";if(r[++i]!==void 0){s=f?parseInt(f.substr(1)):void 0;var g=h?parseInt(h.substr(1)):void 0,x;switch(m){case\"s\":x=r[i];break;case\"c\":x=r[i][0];break;case\"f\":x=parseFloat(r[i]).toFixed(s);break;case\"p\":x=parseFloat(r[i]).toPrecision(s);break;case\"e\":x=parseFloat(r[i]).toExponential(s);break;case\"x\":x=parseInt(r[i]).toString(g||16);break;case\"d\":x=parseFloat(parseInt(r[i],g||10).toPrecision(s)).toFixed(0);break}x=typeof x==\"object\"?JSON.stringify(x):(+x).toString(g);for(var v=parseInt(u),b=u&&u[0]+\"\"==\"0\"?\"0\":\" \";x.length<v;)x=c!==void 0?x+b:b+x;return x}}var o=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(o,a)},t.getBytes=function(e,r){return ta.encode(e,r)},t.getCharCode=function(e,r){return r===void 0&&(r=0),e.charCodeAt(r)},t.getCharAt=function(e){return String.fromCharCode(e)},t.SHIFT_JIS=nn.SJIS.getName(),t.GB2312=\"GB2312\",t.ISO88591=nn.ISO8859_1.getName(),t.EUC_JP=\"EUC_JP\",t.UTF8=nn.UTF8.getName(),t.PLATFORM_DEFAULT_ENCODING=t.UTF8,t.ASSUME_SHIFT_JIS=!1,t})(),_t=(function(){function t(e){e===void 0&&(e=\"\"),this.value=e}return t.prototype.enableDecoding=function(e){return this.encoding=e,this},t.prototype.append=function(e){return typeof e==\"string\"?this.value+=e.toString():this.encoding?this.value+=kt.castAsNonUtf8Char(e,this.encoding):this.value+=String.fromCharCode(e),this},t.prototype.appendChars=function(e,r,n){for(var i=r;r<r+n;i++)this.append(e[i]);return this},t.prototype.length=function(){return this.value.length},t.prototype.charAt=function(e){return this.value.charAt(e)},t.prototype.deleteCharAt=function(e){this.value=this.value.substr(0,e)+this.value.substring(e+1)},t.prototype.setCharAt=function(e,r){this.value=this.value.substr(0,e)+r+this.value.substr(e+1)},t.prototype.substring=function(e,r){return this.value.substring(e,r)},t.prototype.setLengthToZero=function(){this.value=\"\"},t.prototype.toString=function(){return this.value},t.prototype.insert=function(e,r){this.value=this.value.substring(0,e)+r+this.value.substring(e)},t})(),uo=(function(){function t(e,r,n,i){if(this.width=e,this.height=r,this.rowSize=n,this.bits=i,r==null&&(r=e),this.height=r,e<1||r<1)throw new it(\"Both dimensions must be greater than 0\");n==null&&(n=Math.floor((e+31)/32)),this.rowSize=n,i==null&&(this.bits=new Int32Array(this.rowSize*this.height))}return t.parseFromBooleanArray=function(e){for(var r=e.length,n=e[0].length,i=new t(n,r),a=0;a<r;a++)for(var o=e[a],s=0;s<n;s++)o[s]&&i.set(s,a);return i},t.parseFromString=function(e,r,n){if(e===null)throw new it(\"stringRepresentation cannot be null\");for(var i=new Array(e.length),a=0,o=0,s=-1,c=0,u=0;u<e.length;)if(e.charAt(u)===`\n`||e.charAt(u)===\"\\r\"){if(a>o){if(s===-1)s=a-o;else if(a-o!==s)throw new it(\"row lengths do not match\");o=a,c++}u++}else if(e.substring(u,u+r.length)===r)u+=r.length,i[a]=!0,a++;else if(e.substring(u,u+n.length)===n)u+=n.length,i[a]=!1,a++;else throw new it(\"illegal character encountered: \"+e.substring(u));if(a>o){if(s===-1)s=a-o;else if(a-o!==s)throw new it(\"row lengths do not match\");c++}for(var f=new t(s,c),h=0;h<a;h++)i[h]&&f.set(Math.floor(h%s),Math.floor(h/s));return f},t.prototype.get=function(e,r){var n=r*this.rowSize+Math.floor(e/32);return(this.bits[n]>>>(e&31)&1)!==0},t.prototype.set=function(e,r){var n=r*this.rowSize+Math.floor(e/32);this.bits[n]|=1<<(e&31)&4294967295},t.prototype.unset=function(e,r){var n=r*this.rowSize+Math.floor(e/32);this.bits[n]&=~(1<<(e&31)&4294967295)},t.prototype.flip=function(e,r){var n=r*this.rowSize+Math.floor(e/32);this.bits[n]^=1<<(e&31)&4294967295},t.prototype.xor=function(e){if(this.width!==e.getWidth()||this.height!==e.getHeight()||this.rowSize!==e.getRowSize())throw new it(\"input matrix dimensions do not match\");for(var r=new yn(Math.floor(this.width/32)+1),n=this.rowSize,i=this.bits,a=0,o=this.height;a<o;a++)for(var s=a*n,c=e.getRow(a,r).getBitArray(),u=0;u<n;u++)i[s+u]^=c[u]},t.prototype.clear=function(){for(var e=this.bits,r=e.length,n=0;n<r;n++)e[n]=0},t.prototype.setRegion=function(e,r,n,i){if(r<0||e<0)throw new it(\"Left and top must be nonnegative\");if(i<1||n<1)throw new it(\"Height and width must be at least 1\");var a=e+n,o=r+i;if(o>this.height||a>this.width)throw new it(\"The region must fit inside the matrix\");for(var s=this.rowSize,c=this.bits,u=r;u<o;u++)for(var f=u*s,h=e;h<a;h++)c[f+Math.floor(h/32)]|=1<<(h&31)&4294967295},t.prototype.getRow=function(e,r){r==null||r.getSize()<this.width?r=new yn(this.width):r.clear();for(var n=this.rowSize,i=this.bits,a=e*n,o=0;o<n;o++)r.setBulk(o*32,i[a+o]);return r},t.prototype.setRow=function(e,r){cr.arraycopy(r.getBitArray(),0,this.bits,e*this.rowSize,this.rowSize)},t.prototype.rotate180=function(){for(var e=this.getWidth(),r=this.getHeight(),n=new yn(e),i=new yn(e),a=0,o=Math.floor((r+1)/2);a<o;a++)n=this.getRow(a,n),i=this.getRow(r-1-a,i),n.reverse(),i.reverse(),this.setRow(a,i),this.setRow(r-1-a,n)},t.prototype.getEnclosingRectangle=function(){for(var e=this.width,r=this.height,n=this.rowSize,i=this.bits,a=e,o=r,s=-1,c=-1,u=0;u<r;u++)for(var f=0;f<n;f++){var h=i[u*n+f];if(h!==0){if(u<o&&(o=u),u>c&&(c=u),f*32<a){for(var m=0;(h<<31-m&4294967295)===0;)m++;f*32+m<a&&(a=f*32+m)}if(f*32+31>s){for(var m=31;!(h>>>m);)m--;f*32+m>s&&(s=f*32+m)}}}return s<a||c<o?null:Int32Array.from([a,o,s-a+1,c-o+1])},t.prototype.getTopLeftOnBit=function(){for(var e=this.rowSize,r=this.bits,n=0;n<r.length&&r[n]===0;)n++;if(n===r.length)return null;for(var i=n/e,a=n%e*32,o=r[n],s=0;(o<<31-s&4294967295)===0;)s++;return a+=s,Int32Array.from([a,i])},t.prototype.getBottomRightOnBit=function(){for(var e=this.rowSize,r=this.bits,n=r.length-1;n>=0&&r[n]===0;)n--;if(n<0)return null;for(var i=Math.floor(n/e),a=Math.floor(n%e)*32,o=r[n],s=31;!(o>>>s);)s--;return a+=s,Int32Array.from([a,i])},t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.getRowSize=function(){return this.rowSize},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.width===r.width&&this.height===r.height&&this.rowSize===r.rowSize&&an.equals(this.bits,r.bits)},t.prototype.hashCode=function(){var e=this.width;return e=31*e+this.width,e=31*e+this.height,e=31*e+this.rowSize,e=31*e+an.hashCode(this.bits),e},t.prototype.toString=function(e,r,n){return e===void 0&&(e=\"X \"),r===void 0&&(r=\"  \"),n===void 0&&(n=`\n`),this.buildToString(e,r,n)},t.prototype.buildToString=function(e,r,n){for(var i=new _t,a=0,o=this.height;a<o;a++){for(var s=0,c=this.width;s<c;s++)i.append(this.get(s,a)?e:r);i.append(n)}return i.toString()},t.prototype.clone=function(){return new t(this.width,this.height,this.rowSize,this.bits.slice())},t})(),coe=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),de=(function(t){coe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.getNotFoundInstance=function(){return new e},e.kind=\"NotFoundException\",e})(Ni),uoe=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),rz=(function(t){uoe(e,t);function e(r){var n=t.call(this,r)||this;return n.luminances=e.EMPTY,n.buckets=new Int32Array(e.LUMINANCE_BUCKETS),n}return e.prototype.getBlackRow=function(r,n){var i=this.getLuminanceSource(),a=i.getWidth();n==null||n.getSize()<a?n=new yn(a):n.clear(),this.initArrays(a);for(var o=i.getRow(r,this.luminances),s=this.buckets,c=0;c<a;c++)s[(o[c]&255)>>e.LUMINANCE_SHIFT]++;var u=e.estimateBlackPoint(s);if(a<3)for(var c=0;c<a;c++)(o[c]&255)<u&&n.set(c);else for(var f=o[0]&255,h=o[1]&255,c=1;c<a-1;c++){var m=o[c+1]&255;(h*4-f-m)/2<u&&n.set(c),f=h,h=m}return n},e.prototype.getBlackMatrix=function(){var r=this.getLuminanceSource(),n=r.getWidth(),i=r.getHeight(),a=new uo(n,i);this.initArrays(n);for(var o=this.buckets,s=1;s<5;s++)for(var c=Math.floor(i*s/5),u=r.getRow(c,this.luminances),f=Math.floor(n*4/5),h=Math.floor(n/5);h<f;h++){var m=u[h]&255;o[m>>e.LUMINANCE_SHIFT]++}for(var g=e.estimateBlackPoint(o),x=r.getMatrix(),s=0;s<i;s++)for(var v=s*n,h=0;h<n;h++){var m=x[v+h]&255;m<g&&a.set(h,s)}return a},e.prototype.createBinarizer=function(r){return new e(r)},e.prototype.initArrays=function(r){this.luminances.length<r&&(this.luminances=new Uint8ClampedArray(r));for(var n=this.buckets,i=0;i<e.LUMINANCE_BUCKETS;i++)n[i]=0},e.estimateBlackPoint=function(r){for(var n=r.length,i=0,a=0,o=0,s=0;s<n;s++)r[s]>o&&(a=s,o=r[s]),r[s]>i&&(i=r[s]);for(var c=0,u=0,s=0;s<n;s++){var f=s-a,h=r[s]*f*f;h>u&&(c=s,u=h)}if(a>c){var m=a;a=c,c=m}if(c-a<=n/16)throw new de;for(var g=c-1,x=-1,s=c-1;s>a;s--){var v=s-a,h=v*v*(c-s)*(i-r[s]);h>x&&(g=s,x=h)}return g<<e.LUMINANCE_SHIFT},e.LUMINANCE_BITS=5,e.LUMINANCE_SHIFT=8-e.LUMINANCE_BITS,e.LUMINANCE_BUCKETS=1<<e.LUMINANCE_BITS,e.EMPTY=Uint8ClampedArray.from([0]),e})(tz),doe=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),r3=(function(t){doe(e,t);function e(r){var n=t.call(this,r)||this;return n.matrix=null,n}return e.prototype.getBlackMatrix=function(){if(this.matrix!==null)return this.matrix;var r=this.getLuminanceSource(),n=r.getWidth(),i=r.getHeight();if(n>=e.MINIMUM_DIMENSION&&i>=e.MINIMUM_DIMENSION){var a=r.getMatrix(),o=n>>e.BLOCK_SIZE_POWER;(n&e.BLOCK_SIZE_MASK)!==0&&o++;var s=i>>e.BLOCK_SIZE_POWER;(i&e.BLOCK_SIZE_MASK)!==0&&s++;var c=e.calculateBlackPoints(a,o,s,n,i),u=new uo(n,i);e.calculateThresholdForBlock(a,o,s,n,i,c,u),this.matrix=u}else this.matrix=t.prototype.getBlackMatrix.call(this);return this.matrix},e.prototype.createBinarizer=function(r){return new e(r)},e.calculateThresholdForBlock=function(r,n,i,a,o,s,c){for(var u=o-e.BLOCK_SIZE,f=a-e.BLOCK_SIZE,h=0;h<i;h++){var m=h<<e.BLOCK_SIZE_POWER;m>u&&(m=u);for(var g=e.cap(h,2,i-3),x=0;x<n;x++){var v=x<<e.BLOCK_SIZE_POWER;v>f&&(v=f);for(var b=e.cap(x,2,n-3),w=0,C=-2;C<=2;C++){var _=s[g+C];w+=_[b-2]+_[b-1]+_[b]+_[b+1]+_[b+2]}var N=w/25;e.thresholdBlock(r,v,m,N,a,c)}}},e.cap=function(r,n,i){return r<n?n:r>i?i:r},e.thresholdBlock=function(r,n,i,a,o,s){for(var c=0,u=i*o+n;c<e.BLOCK_SIZE;c++,u+=o)for(var f=0;f<e.BLOCK_SIZE;f++)(r[u+f]&255)<=a&&s.set(n+f,i+c)},e.calculateBlackPoints=function(r,n,i,a,o){for(var s=o-e.BLOCK_SIZE,c=a-e.BLOCK_SIZE,u=new Array(i),f=0;f<i;f++){u[f]=new Int32Array(n);var h=f<<e.BLOCK_SIZE_POWER;h>s&&(h=s);for(var m=0;m<n;m++){var g=m<<e.BLOCK_SIZE_POWER;g>c&&(g=c);for(var x=0,v=255,b=0,w=0,C=h*a+g;w<e.BLOCK_SIZE;w++,C+=a){for(var _=0;_<e.BLOCK_SIZE;_++){var N=r[C+_]&255;x+=N,N<v&&(v=N),N>b&&(b=N)}if(b-v>e.MIN_DYNAMIC_RANGE)for(w++,C+=a;w<e.BLOCK_SIZE;w++,C+=a)for(var _=0;_<e.BLOCK_SIZE;_++)x+=r[C+_]&255}var A=x>>e.BLOCK_SIZE_POWER*2;if(b-v<=e.MIN_DYNAMIC_RANGE&&(A=v/2,f>0&&m>0)){var T=(u[f-1][m]+2*u[f][m-1]+u[f-1][m-1])/4;v<T&&(A=T)}u[f][m]=A}}return u},e.BLOCK_SIZE_POWER=3,e.BLOCK_SIZE=1<<e.BLOCK_SIZE_POWER,e.BLOCK_SIZE_MASK=e.BLOCK_SIZE-1,e.MINIMUM_DIMENSION=e.BLOCK_SIZE*5,e.MIN_DYNAMIC_RANGE=24,e})(rz),Kf=(function(){function t(e,r){this.width=e,this.height=r}return t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.isCropSupported=function(){return!1},t.prototype.crop=function(e,r,n,i){throw new Op(\"This luminance source does not support cropping.\")},t.prototype.isRotateSupported=function(){return!1},t.prototype.rotateCounterClockwise=function(){throw new Op(\"This luminance source does not support rotation by 90 degrees.\")},t.prototype.rotateCounterClockwise45=function(){throw new Op(\"This luminance source does not support rotation by 45 degrees.\")},t.prototype.toString=function(){for(var e=new Uint8ClampedArray(this.width),r=new _t,n=0;n<this.height;n++){for(var i=this.getRow(n,e),a=0;a<this.width;a++){var o=i[a]&255,s=void 0;o<64?s=\"#\":o<128?s=\"+\":o<192?s=\".\":s=\" \",r.append(s)}r.append(`\n`)}return r.toString()},t})(),foe=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),c0=(function(t){foe(e,t);function e(r){var n=t.call(this,r.getWidth(),r.getHeight())||this;return n.delegate=r,n}return e.prototype.getRow=function(r,n){for(var i=this.delegate.getRow(r,n),a=this.getWidth(),o=0;o<a;o++)i[o]=255-(i[o]&255);return i},e.prototype.getMatrix=function(){for(var r=this.delegate.getMatrix(),n=this.getWidth()*this.getHeight(),i=new Uint8ClampedArray(n),a=0;a<n;a++)i[a]=255-(r[a]&255);return i},e.prototype.isCropSupported=function(){return this.delegate.isCropSupported()},e.prototype.crop=function(r,n,i,a){return new e(this.delegate.crop(r,n,i,a))},e.prototype.isRotateSupported=function(){return this.delegate.isRotateSupported()},e.prototype.invert=function(){return this.delegate},e.prototype.rotateCounterClockwise=function(){return new e(this.delegate.rotateCounterClockwise())},e.prototype.rotateCounterClockwise45=function(){return new e(this.delegate.rotateCounterClockwise45())},e})(Kf),hoe=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),nz=(function(t){hoe(e,t);function e(r,n){n===void 0&&(n=!1);var i=t.call(this,r.width,r.height)||this;return i.canvas=r,i.tempCanvasElement=null,i.buffer=e.makeBufferFromCanvasImageData(r,n),i}return e.makeBufferFromCanvasImageData=function(r,n){n===void 0&&(n=!1);var i=r.getContext(\"2d\").getImageData(0,0,r.wid","size_bytes":360000},"client/src/services/scanner-service.ts":{"content":"import { BrowserMultiFormatReader } from '@zxing/browser';\nimport { Capacitor } from '@capacitor/core';\n\nexport interface ScannerResult {\n  barcode: string;\n  format: string;\n}\n\nexport interface ScannerError {\n  type: 'permission' | 'not_supported' | 'not_found' | 'unknown';\n  message: string;\n}\n\n// Add image-based barcode scanning\nexport async function scanBarcodeFromImage(imageFile: File | HTMLImageElement): Promise<ScannerResult> {\n  console.log('ðŸ“· Starting barcode detection from image...');\n  console.log('ðŸ” Browser capabilities check:', {\n    hasBarcodeDetector: 'BarcodeDetector' in window,\n    hasZXing: typeof BrowserMultiFormatReader !== 'undefined',\n    userAgent: navigator.userAgent,\n    isSecureContext: window.isSecureContext\n  });\n  \n  let imageElement: HTMLImageElement;\n  \n  if (imageFile instanceof File) {\n    console.log('ðŸ“ Processing File:', {\n      name: imageFile.name,\n      size: imageFile.size,\n      type: imageFile.type\n    });\n    \n    imageElement = new Image();\n    const imageUrl = URL.createObjectURL(imageFile);\n    \n    await new Promise((resolve, reject) => {\n      imageElement.onload = () => {\n        console.log('ðŸ–¼ï¸ Image loaded successfully:', {\n          width: imageElement.width,\n          height: imageElement.height,\n          naturalWidth: imageElement.naturalWidth,\n          naturalHeight: imageElement.naturalHeight\n        });\n        resolve(imageElement);\n      };\n      imageElement.onerror = (error) => {\n        console.error('âŒ Image load error:', error);\n        reject(error);\n      };\n      imageElement.src = imageUrl;\n    });\n  } else {\n    imageElement = imageFile;\n    console.log('ðŸ–¼ï¸ Using provided image element:', {\n      width: imageElement.width,\n      height: imageElement.height\n    });\n  }\n  \n  // Try BarcodeDetector API first (Chrome, Edge, Android Chrome)\n  if ('BarcodeDetector' in window) {\n    console.log('ðŸ” Using BarcodeDetector API for image scanning');\n    try {\n      const detector = new (window as any).BarcodeDetector({\n        formats: ['code_128', 'code_39', 'code_93', 'codabar', 'data_matrix', 'ean_13', 'ean_8', 'itf', 'pdf417', 'qr_code', 'upc_a', 'upc_e']\n      });\n      console.log('ðŸ” BarcodeDetector created successfully');\n      \n      const barcodes = await detector.detect(imageElement);\n      console.log('ðŸ” BarcodeDetector scan results:', {\n        barcodesFound: barcodes?.length || 0,\n        barcodes: barcodes?.map((b: any) => ({\n          rawValue: b.rawValue,\n          format: b.format,\n          boundingBox: b.boundingBox\n        }))\n      });\n      \n      if (barcodes && barcodes.length > 0) {\n        const barcode = barcodes[0];\n        console.log('âœ… Barcode detected from image:', barcode.rawValue);\n        const normalized = normalizeBarcodeValue(barcode.rawValue);\n        if (normalized) {\n          console.log('âœ… Normalized barcode:', normalized);\n          return {\n            barcode: normalized,\n            format: barcode.format || 'unknown'\n          };\n        } else {\n          console.log('âŒ Failed to normalize barcode:', barcode.rawValue);\n        }\n      } else {\n        console.log('âŒ No barcodes detected by BarcodeDetector API');\n      }\n    } catch (error) {\n      console.error('âŒ BarcodeDetector failed:', error);\n    }\n  }\n  \n  // Fallback to ZXing for image scanning\n  console.log('ðŸ“· Using ZXing for image barcode detection');\n  try {\n    const { BrowserMultiFormatReader } = await import('@zxing/library');\n    console.log('ðŸ“š ZXing library imported successfully');\n    \n    const reader = new BrowserMultiFormatReader();\n    console.log('ðŸ“– BrowserMultiFormatReader created');\n    \n    const result = await reader.decodeFromImageElement(imageElement);\n    console.log('âœ… ZXing detected barcode from image:', {\n      text: result.getText(),\n      format: result.getBarcodeFormat()?.toString()\n    });\n    \n    const normalized = normalizeBarcodeValue(result.getText());\n    console.log('ðŸ”„ Barcode normalization:', {\n      original: result.getText(),\n      normalized\n    });\n    \n    if (normalized) {\n      return {\n        barcode: normalized,\n        format: result.getBarcodeFormat()?.toString() || 'unknown'\n      };\n    }\n    throw new Error(`Invalid barcode format detected: ${result.getText()}`);\n  } catch (error) {\n    console.error('âŒ ZXing barcode detection failed:', error);\n    throw new Error('No barcode detected in image. Make sure the barcode is clearly visible and well-lit.');\n  } finally {\n    // Clean up object URL if we created one\n    if (imageFile instanceof File) {\n      URL.revokeObjectURL(imageElement.src);\n      console.log('ðŸ§¹ Cleaned up object URL');\n    }\n  }\n}\n\n// Helper function to normalize barcode values\nfunction normalizeBarcodeValue(barcode: string): string | null {\n  console.log('ðŸ”„ Normalizing barcode:', barcode);\n  \n  // Remove any non-digit characters\n  const digits = barcode.replace(/\\D/g, '');\n  console.log('ðŸ”¢ Extracted digits:', digits);\n  \n  // Validate length (8-14 digits for most retail barcodes)\n  if (digits.length < 8 || digits.length > 14) {\n    console.log(`âŒ Invalid barcode length: ${digits.length} (expected 8-14)`);\n    return null;\n  }\n\n  // Handle UPC-A to EAN-13 conversion (add leading zero)\n  if (digits.length === 12) {\n    const converted = '0' + digits;\n    console.log('ðŸ”„ UPC-A to EAN-13 conversion:', converted);\n    return converted;\n  }\n\n  console.log('âœ… Normalized barcode:', digits);\n  return digits;\n}\n\nexport interface ScannerService {\n  startScanning(videoElement: HTMLVideoElement, stream?: MediaStream): Promise<void>;\n  stopScanning(): void;\n  isScanning(): boolean;\n  toggleTorch(): Promise<boolean>;\n  isTorchSupported(): Promise<boolean>;\n}\n\nclass WebBarcodeScanner implements ScannerService {\n  private reader: BrowserMultiFormatReader | null = null;\n  private stream: MediaStream | null = null;\n  private isActive = false;\n  private torchEnabled = false;\n  private track: MediaStreamTrack | null = null;\n  private onDetected?: (result: ScannerResult) => void;\n  private onError?: (error: ScannerError) => void;\n\n  constructor(\n    onDetected: (result: ScannerResult) => void,\n    onError: (error: ScannerError) => void\n  ) {\n    this.onDetected = onDetected;\n    this.onError = onError;\n  }\n\n  async startScanning(videoElement: HTMLVideoElement, stream?: MediaStream): Promise<void> {\n    try {\n      console.log('ðŸŽ¥ Starting camera scanner...');\n      \n      // If stream is provided, use it directly\n      if (stream) {\n        console.log('âœ… Using pre-authorized camera stream');\n        this.stream = stream;\n        this.track = this.stream.getVideoTracks()[0];\n        \n        // Try BarcodeDetector API first (Chrome, Edge, Android Chrome)\n        if ('BarcodeDetector' in window) {\n          console.log('ðŸ“± Using BarcodeDetector API');\n          await this.startBarcodeDetectorScanning(videoElement, stream);\n          return;\n        }\n\n        // Fallback to ZXing\n        console.log('ðŸ“· Using ZXing fallback');\n        await this.startZXingScanning(videoElement, stream);\n        return;\n      }\n      \n      // Legacy path - should not be used anymore\n      console.log('âš ï¸ WARNING: Camera stream not provided, requesting access...');\n      console.log('ðŸ” Security context:', {\n        isSecureContext: window.isSecureContext,\n        location: window.location.href,\n        protocol: window.location.protocol\n      });\n\n      // Check if we're in a secure context\n      if (!window.isSecureContext) {\n        throw new Error('Camera access requires HTTPS');\n      }\n\n      // Check if getUserMedia is available\n      if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\n        throw new Error('Camera API not available in this browser');\n      }\n\n      // Try BarcodeDetector API first (Chrome, Edge, Android Chrome)\n      if ('BarcodeDetector' in window) {\n        console.log('ðŸ“± Using BarcodeDetector API');\n        await this.startBarcodeDetectorScanning(videoElement);\n        return;\n      }\n\n      // Fallback to ZXing\n      console.log('ðŸ“· Using ZXing fallback');\n      await this.startZXingScanning(videoElement);\n    } catch (error) {\n      this.handleError(error);\n    }\n  }\n\n  private async startBarcodeDetectorScanning(videoElement: HTMLVideoElement, stream?: MediaStream): Promise<void> {\n    try {\n      // Use provided stream or request new one\n      if (!stream) {\n        console.log('ðŸ“· Requesting camera access with simple constraints...');\n        this.stream = await navigator.mediaDevices.getUserMedia({ video: true });\n        this.track = this.stream.getVideoTracks()[0];\n      } else {\n        // Stream already set in startScanning\n        console.log('âœ… Using provided camera stream');\n      }\n      \n      console.log('âœ… Camera access successful! Track details:', {\n        label: this.track?.label,\n        kind: this.track?.kind,\n        readyState: this.track?.readyState,\n        enabled: this.track?.enabled\n      });\n      \n      videoElement.srcObject = this.stream;\n      videoElement.playsInline = true;\n      videoElement.muted = true;\n      videoElement.autoplay = true;\n      \n      // Wait for video to be ready\n      await new Promise((resolve, reject) => {\n        videoElement.addEventListener('loadedmetadata', resolve, { once: true });\n        videoElement.addEventListener('error', reject, { once: true });\n        setTimeout(reject, 5000); // 5 second timeout\n      });\n      \n      await videoElement.play();\n      this.isActive = true;\n\n      // Create BarcodeDetector with supported formats\n      const barcodeDetector = new (window as any).BarcodeDetector({\n        formats: ['ean_13', 'ean_8', 'upc_a', 'upc_e', 'code_128', 'code_39', 'qr_code']\n      });\n\n      console.log('ðŸ” Starting barcode detection...');\n      // Start detection loop\n      this.detectBarcodes(barcodeDetector, videoElement);\n      \n    } catch (error) {\n      console.log('âŒ Camera access failed:', error);\n      throw error;\n    }\n  }\n\n  private async detectBarcodes(detector: any, videoElement: HTMLVideoElement): Promise<void> {\n    if (!this.isActive) return;\n\n    try {\n      const barcodes = await detector.detect(videoElement);\n      if (barcodes.length > 0) {\n        const barcode = barcodes[0];\n        console.log('ðŸ” RAW BARCODE DETECTED:', {\n          rawValue: barcode.rawValue,\n          format: barcode.format,\n          length: barcode.rawValue?.length\n        });\n        \n        // QR codes contain URLs/text - return raw value without normalization\n        if (barcode.format === 'qr_code') {\n          console.log('âœ… QR CODE ACCEPTED:', barcode.rawValue);\n          this.onDetected?.({\n            barcode: barcode.rawValue,\n            format: barcode.format\n          });\n          return; // Stop scanning on detection\n        }\n        \n        // Product barcodes need normalization\n        const normalized = this.normalizeBarcode(barcode.rawValue);\n        console.log('ðŸ”„ NORMALIZATION RESULT:', {\n          original: barcode.rawValue,\n          normalized: normalized,\n          accepted: normalized !== null\n        });\n        \n        if (normalized) {\n          console.log('âœ… BARCODE ACCEPTED:', normalized);\n          this.onDetected?.({\n            barcode: normalized,\n            format: barcode.format\n          });\n          return; // Stop scanning on detection\n        } else {\n          console.log('âŒ BARCODE REJECTED - continuing scan...');\n        }\n      }\n    } catch (error) {\n      console.log('Barcode detection error:', error);\n    }\n\n    // Continue scanning\n    if (this.isActive) {\n      requestAnimationFrame(() => this.detectBarcodes(detector, videoElement));\n    }\n  }\n\n  private async startZXingScanning(videoElement: HTMLVideoElement, stream?: MediaStream): Promise<void> {\n    try {\n      // Use provided stream or request new one\n      if (!stream) {\n        const constraints = {\n          video: {\n            facingMode: 'environment',\n            width: { ideal: 1280 },\n            height: { ideal: 720 }\n          }\n        };\n        this.stream = await navigator.mediaDevices.getUserMedia(constraints);\n        this.track = this.stream.getVideoTracks()[0];\n      }\n      // else stream already set in startScanning\n      \n      videoElement.srcObject = this.stream;\n      videoElement.playsInline = true;\n      videoElement.muted = true;\n      await videoElement.play();\n      \n      this.reader = new BrowserMultiFormatReader();\n      this.isActive = true;\n\n      // Start decoding from video element\n      const scanLoop = async () => {\n        if (!this.isActive) return;\n        \n        try {\n          const result = await this.reader!.decodeOnceFromVideoElement(videoElement);\n          if (result) {\n            const format = result.getBarcodeFormat().toString();\n            const rawValue = result.getText();\n            \n            // QR codes contain URLs/text - return raw value without normalization\n            if (format === 'QR_CODE') {\n              this.onDetected?.({\n                barcode: rawValue,\n                format: format\n              });\n              return; // Stop scanning on success\n            }\n            \n            // Product barcodes need normalization\n            const normalized = this.normalizeBarcode(rawValue);\n            if (normalized) {\n              this.onDetected?.({\n                barcode: normalized,\n                format: format\n              });\n              return; // Stop scanning on success\n            }\n          }\n        } catch (error) {\n          // Continue scanning on error (no barcode detected)\n        }\n        \n        // Continue scanning\n        if (this.isActive) {\n          setTimeout(scanLoop, 100);\n        }\n      };\n      \n      scanLoop();\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  private normalizeBarcode(barcode: string): string | null {\n    // Remove any non-digit characters\n    const digits = barcode.replace(/\\D/g, '');\n    \n    // Validate length (8-14 digits for most retail barcodes)\n    if (digits.length < 8 || digits.length > 14) {\n      return null;\n    }\n\n    // Handle UPC-A to EAN-13 conversion (add leading zero)\n    if (digits.length === 12) {\n      return '0' + digits;\n    }\n\n    return digits;\n  }\n\n  private handleError(error: any): void {\n    console.log('ðŸ” Scanner error details:', {\n      name: error.name,\n      message: error.message,\n      code: error.code,\n      constraint: error.constraint,\n      stack: error.stack?.split('\\n')[0]\n    });\n\n    let scannerError: ScannerError;\n\n    if (error.name === 'NotAllowedError') {\n      scannerError = {\n        type: 'permission',\n        message: 'Camera access was blocked. Please check your browser settings and allow camera access for this site.'\n      };\n    } else if (error.name === 'NotFoundError') {\n      scannerError = {\n        type: 'not_found',\n        message: 'No camera found. Please make sure your device has a camera.'\n      };\n    } else if (error.name === 'NotSupportedError') {\n      scannerError = {\n        type: 'not_supported',\n        message: 'Camera not supported. This feature requires a modern browser with camera support.'\n      };\n    } else if (!window.isSecureContext) {\n      scannerError = {\n        type: 'not_supported',\n        message: 'Camera requires a secure connection (HTTPS). Please check your connection.'\n      };\n    } else {\n      scannerError = {\n        type: 'unknown',\n        message: `Camera error: ${error.message || 'Unknown error occurred'}`\n      };\n    }\n\n    this.onError?.(scannerError);\n  }\n\n  stopScanning(): void {\n    this.isActive = false;\n\n    // Stop ZXing reader\n    if (this.reader) {\n      this.reader = null;\n    }\n\n    // Stop video stream\n    if (this.stream) {\n      this.stream.getTracks().forEach(track => track.stop());\n      this.stream = null;\n      this.track = null;\n    }\n  }\n\n  isScanning(): boolean {\n    return this.isActive;\n  }\n\n  async toggleTorch(): Promise<boolean> {\n    if (!this.track) return false;\n\n    try {\n      const capabilities = this.track.getCapabilities() as any;\n      if (!capabilities.torch) return false;\n\n      this.torchEnabled = !this.torchEnabled;\n      await this.track.applyConstraints({\n        advanced: [{ torch: this.torchEnabled } as any]\n      });\n\n      return this.torchEnabled;\n    } catch (error) {\n      console.log('Torch toggle failed:', error);\n      return false;\n    }\n  }\n\n  async isTorchSupported(): Promise<boolean> {\n    if (!this.track) return false;\n    \n    try {\n      const capabilities = this.track.getCapabilities() as any;\n      return 'torch' in capabilities;\n    } catch {\n      return false;\n    }\n  }\n}\n\n// Native Capacitor Scanner for iOS/Android apps\nclass NativeBarcodeScanner implements ScannerService {\n  private isActive = false;\n  private onDetected?: (result: ScannerResult) => void;\n  private onError?: (error: ScannerError) => void;\n  private torchEnabled = false;\n\n  constructor(\n    onDetected: (result: ScannerResult) => void,\n    onError: (error: ScannerError) => void\n  ) {\n    this.onDetected = onDetected;\n    this.onError = onError;\n  }\n\n  async startScanning(videoElement: HTMLVideoElement, stream?: MediaStream): Promise<void> {\n    try {\n      console.log('ðŸ“± Starting native barcode scanner...');\n      \n      // Import the Capacitor plugin\n      const { BarcodeScanner } = await import('@capacitor-mlkit/barcode-scanning');\n      \n      // Request camera permission\n      const permissionResult = await BarcodeScanner.requestPermissions();\n      if (permissionResult.camera !== 'granted') {\n        throw new Error('Camera permission denied');\n      }\n      \n      this.isActive = true;\n      \n      // Hide the webview to show native camera\n      document.body.classList.add('barcode-scanner-active');\n      \n      // Start scanning\n      const result = await BarcodeScanner.scan({\n        formats: [] // Empty array scans all formats including QR codes\n      });\n      \n      this.isActive = false;\n      document.body.classList.remove('barcode-scanner-active');\n      \n      if (result.barcodes && result.barcodes.length > 0) {\n        const barcode = result.barcodes[0];\n        console.log('âœ… Native scanner detected:', {\n          rawValue: barcode.rawValue,\n          format: barcode.format\n        });\n        \n        // QR codes return raw value (format can be FORMAT_QR_CODE or QR_CODE)\n        if (barcode.format?.includes('QR')) {\n          this.onDetected?.({\n            barcode: barcode.rawValue || '',\n            format: 'qr_code'\n          });\n          return;\n        }\n        \n        // Product barcodes need normalization\n        const normalized = normalizeBarcodeValue(barcode.rawValue || '');\n        if (normalized) {\n          this.onDetected?.({\n            barcode: normalized,\n            format: barcode.format?.toLowerCase().replace('format_', '') || 'unknown'\n          });\n        }\n      }\n    } catch (error: any) {\n      console.error('âŒ Native scanner error:', error);\n      this.isActive = false;\n      document.body.classList.remove('barcode-scanner-active');\n      \n      this.onError?.({\n        type: error.message?.includes('permission') ? 'permission' : 'unknown',\n        message: error.message || 'Failed to scan barcode'\n      });\n    }\n  }\n\n  stopScanning(): void {\n    this.isActive = false;\n    document.body.classList.remove('barcode-scanner-active');\n    \n    // Stop the native scanner\n    import('@capacitor-mlkit/barcode-scanning').then(({ BarcodeScanner }) => {\n      BarcodeScanner.stopScan().catch(() => {\n        // Ignore errors on stop\n      });\n    });\n  }\n\n  isScanning(): boolean {\n    return this.isActive;\n  }\n\n  async toggleTorch(): Promise<boolean> {\n    try {\n      const { BarcodeScanner } = await import('@capacitor-mlkit/barcode-scanning');\n      this.torchEnabled = !this.torchEnabled;\n      await BarcodeScanner.toggleTorch();\n      return this.torchEnabled;\n    } catch {\n      return false;\n    }\n  }\n\n  async isTorchSupported(): Promise<boolean> {\n    try {\n      const { BarcodeScanner } = await import('@capacitor-mlkit/barcode-scanning');\n      const result = await BarcodeScanner.isTorchAvailable();\n      return result.available;\n    } catch {\n      return false;\n    }\n  }\n}\n\n// Export factory function\nexport function createBarcodeScanner(\n  onDetected: (result: ScannerResult) => void,\n  onError: (error: ScannerError) => void\n): ScannerService {\n  // Use native scanner on mobile platforms\n  if (Capacitor.isNativePlatform()) {\n    console.log('ðŸ“± Creating native barcode scanner for mobile app');\n    return new NativeBarcodeScanner(onDetected, onError);\n  }\n  \n  // Use web scanner on browsers\n  console.log('ðŸŒ Creating web barcode scanner for browser');\n  return new WebBarcodeScanner(onDetected, onError);\n}","size_bytes":20858},"client/src/pages/CoachingPage.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Link } from \"wouter\";\nimport { ArrowLeft, Heart, Brain, Lightbulb, RefreshCw, Star, Trophy, Zap, Calendar, Bell, BookOpen, Clock, Check, TestTube2, Sparkles, Settings, User } from \"lucide-react\";\nimport { useState, useEffect } from \"react\";\nimport { notificationService } from \"@/lib/notification-service\";\nimport { soundService } from \"@/lib/sound-service\";\nimport { DropdownNavigation } from \"@/components/dropdown-navigation\";\nimport { BottomHelpSection } from \"@/components/bottom-help-section\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { SoundSettings } from \"@/components/sound-settings\";\n\ninterface DailyCoaching {\n  motivation: string;\n  nutritionTip: string;\n  medicationTip?: string;\n  encouragement: string;\n  todaysFocus: string;\n  streak: number;\n  achievement?: string;\n}\n\ninterface EducationalTip {\n  id: string;\n  title: string;\n  content: string;\n  category: 'nutrition' | 'medication' | 'motivation';\n  importance: 'high' | 'medium' | 'low';\n}\n\nexport function CoachingPage() {\n  const { toast } = useToast();\n  const [selectedCategory, setSelectedCategory] = useState<'all' | 'nutrition' | 'medication' | 'motivation'>('all');\n  const [showReminderSetup, setShowReminderSetup] = useState(false);\n  const [reminderTime, setReminderTime] = useState('09:00');\n  const [reminderEnabled, setReminderEnabled] = useState(false);\n\n  // Load reminder settings from localStorage on component mount\n  useEffect(() => {\n    const savedTime = localStorage.getItem('platemate-reminder-time');\n    const savedEnabled = localStorage.getItem('platemate-reminder-enabled');\n    \n    if (savedTime) {\n      setReminderTime(savedTime);\n    }\n    if (savedEnabled === 'true') {\n      setReminderEnabled(true);\n    }\n\n    // Initialize notification service and resume web notifications\n    notificationService.initialize().then((hasPermission) => {\n      if (hasPermission) {\n        notificationService.resumeWebNotifications();\n      }\n    });\n  }, []);\n\n  // Save reminder settings to localStorage whenever they change\n  const saveReminderTime = (time: string) => {\n    setReminderTime(time);\n    localStorage.setItem('platemate-reminder-time', time);\n  };\n\n  const saveReminderEnabled = async (enabled: boolean) => {\n    setReminderEnabled(enabled);\n    localStorage.setItem('platemate-reminder-enabled', enabled.toString());\n\n    // Schedule or cancel notifications\n    try {\n      await notificationService.scheduleDaily({\n        title: 'PlateMate Daily Coaching',\n        body: 'ðŸŒŸ Your daily motivation and nutrition tips are ready!',\n        time: reminderTime,\n        enabled\n      });\n    } catch (error) {\n      console.error('Failed to schedule notification:', error);\n      toast({\n        title: \"Notification Error\",\n        description: \"Failed to set up notifications. Please check your browser permissions.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const { data: coaching, isLoading: coachingLoading, error: coachingError, refetch: refetchCoaching } = useQuery<DailyCoaching>({\n    queryKey: ['/api/coaching/daily'],\n    retry: 3,\n    retryDelay: 1000,\n  });\n\n  const { data: tips, isLoading: tipsLoading } = useQuery<EducationalTip[]>({\n    queryKey: [`/api/coaching/tips?category=${selectedCategory}`],\n  });\n\n  const generateCoachingMutation = useMutation({\n    mutationFn: async () => {\n      const response = await apiRequest('POST', '/api/coaching/generate');\n      return await response.json();\n    },\n    onSuccess: () => {\n      soundService.playSuccess();\n      toast({\n        title: \"New Coaching Generated!\",\n        description: \"Your daily motivation and tips have been updated.\",\n      });\n      refetchCoaching();\n    },\n    onError: (error: Error) => {\n      soundService.playError();\n      toast({\n        title: \"Error\",\n        description: \"Failed to generate new coaching content. Please try again.\",\n        variant: \"destructive\",\n      });\n      console.error(\"Error generating coaching:\", error);\n    },\n  });\n\n  const setupReminders = async () => {\n    if (showReminderSetup) {\n      try {\n        // Save reminder settings and schedule notifications\n        await saveReminderEnabled(true);\n        setShowReminderSetup(false);\n        await soundService.playSuccess();\n        toast({\n          title: \"Reminders Set!\",\n          description: `Daily coaching reminders will be sent at ${reminderTime}`,\n        });\n      } catch (error) {\n        console.error('Failed to setup reminders:', error);\n        await soundService.playError();\n        toast({\n          title: \"Setup Failed\",\n          description: \"Could not set up reminders. Please check notification permissions.\",\n          variant: \"destructive\",\n        });\n      }\n    } else {\n      setShowReminderSetup(true);\n    }\n  };\n\n  const toggleReminders = async (enabled: boolean) => {\n    try {\n      await saveReminderEnabled(enabled);\n      if (enabled) {\n        toast({\n          title: \"Reminders Enabled\",\n          description: \"You'll receive daily coaching notifications\",\n        });\n      } else {\n        toast({\n          title: \"Reminders Disabled\",\n          description: \"Daily coaching notifications turned off\",\n        });\n      }\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to update reminder settings\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const testNotification = async () => {\n    try {\n      await notificationService.showTestNotification();\n      await soundService.playSuccess();\n      toast({\n        title: \"Test Notification Sent!\",\n        description: \"Check if you received the notification\",\n      });\n    } catch (error) {\n      await soundService.playError();\n      toast({\n        title: \"Test Failed\",\n        description: \"Could not send test notification. Check permissions.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const categories = [\n    { id: 'all', label: 'All Tips', icon: BookOpen },\n    { id: 'nutrition', label: 'Nutrition', icon: Heart },\n    { id: 'medication', label: 'Medication', icon: Zap },\n    { id: 'motivation', label: 'Motivation', icon: Trophy }\n  ];\n\n  return (\n    <div className=\"min-h-screen text-foreground pb-20\" style={{background: 'var(--bg-gradient)'}}>\n      {/* Header */}\n      <div className=\"bg-card border-b\">\n        <div className=\"max-w-md mx-auto px-4 py-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-3\">\n              <Link href=\"/scan\">\n                <button \n                  className=\"p-2 hover:bg-muted rounded-lg transition-colors\"\n                  data-testid=\"button-back-to-home\"\n                >\n                  <ArrowLeft className=\"h-5 w-5\" />\n                </button>\n              </Link>\n              <h1 className=\"text-xl font-bold\">AI Coaching</h1>\n            </div>\n            <Trophy className=\"h-5 w-5 text-primary\" />\n          </div>\n        </div>\n      </div>\n\n      <div className=\"max-w-md mx-auto p-4 space-y-6\">\n        \n        {/* Coach Settings */}\n        <div className=\"grid grid-cols-2 gap-3\">\n          <Link href=\"/coach-personality\">\n            <Card className=\"cursor-pointer hover:shadow-lg transition-all hover:scale-105 bg-gradient-to-br from-purple-500 to-violet-600 text-white border-0\">\n              <CardContent className=\"p-4 flex flex-col items-center text-center space-y-2\">\n                <Sparkles className=\"h-8 w-8\" />\n                <div>\n                  <div className=\"font-semibold\">Personality</div>\n                  <div className=\"text-xs opacity-90\">Choose coaching style</div>\n                </div>\n              </CardContent>\n            </Card>\n          </Link>\n          \n          <Link href=\"/coach-profile\">\n            <Card className=\"cursor-pointer hover:shadow-lg transition-all hover:scale-105 bg-gradient-to-br from-purple-500 to-violet-600 text-white border-0\">\n              <CardContent className=\"p-4 flex flex-col items-center text-center space-y-2\">\n                <User className=\"h-8 w-8\" />\n                <div>\n                  <div className=\"font-semibold\">Profile</div>\n                  <div className=\"text-xs opacity-90\">Personal details</div>\n                </div>\n              </CardContent>\n            </Card>\n          </Link>\n        </div>\n        \n        {/* Daily Coaching Card */}\n        <Card className=\"health-card border-l-4 border-l-primary\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-2\">\n                <Star className=\"h-5 w-5 text-yellow-500\" />\n                Today's Coaching\n              </div>\n              <Button\n                onClick={() => generateCoachingMutation.mutate()}\n                disabled={generateCoachingMutation.isPending || coachingLoading}\n                variant=\"outline\"\n                size=\"sm\"\n                data-testid=\"button-generate-coaching\"\n              >\n                {generateCoachingMutation.isPending ? (\n                  <RefreshCw className=\"h-4 w-4 animate-spin\" />\n                ) : (\n                  <RefreshCw className=\"h-4 w-4\" />\n                )}\n              </Button>\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            {coachingLoading ? (\n              <div className=\"space-y-3\">\n                <div className=\"h-4 bg-muted rounded animate-pulse\" />\n                <div className=\"h-4 bg-muted rounded animate-pulse w-3/4\" />\n                <div className=\"h-4 bg-muted rounded animate-pulse w-1/2\" />\n              </div>\n            ) : coaching ? (\n              <>\n                {/* Streak Counter */}\n                {coaching.streak > 0 && (\n                  <div className=\"flex items-center gap-2 p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800\">\n                    <Trophy className=\"h-5 w-5 text-yellow-600\" />\n                    <span className=\"font-semibold text-yellow-800 dark:text-yellow-200\">\n                      {coaching.streak} day streak! Keep it up!\n                    </span>\n                  </div>\n                )}\n\n                {/* Achievement */}\n                {coaching.achievement && (\n                  <div className=\"flex items-center gap-2 p-3 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800\">\n                    <Star className=\"h-5 w-5 text-green-600\" />\n                    <span className=\"font-semibold text-green-800 dark:text-green-200\">\n                      Achievement: {coaching.achievement}\n                    </span>\n                  </div>\n                )}\n\n                {/* Daily Motivation */}\n                <div className=\"space-y-2\">\n                  <div className=\"flex items-center gap-2\">\n                    <Heart className=\"h-4 w-4 text-red-500\" />\n                    <span className=\"font-medium text-sm\">Daily Motivation</span>\n                  </div>\n                  <p className=\"text-sm text-muted-foreground leading-relaxed\">\n                    {coaching.motivation}\n                  </p>\n                </div>\n\n                {/* Today's Focus */}\n                <div className=\"space-y-2\">\n                  <div className=\"flex items-center gap-2\">\n                    <Calendar className=\"h-4 w-4 text-blue-500\" />\n                    <span className=\"font-medium text-sm\">Today's Focus</span>\n                  </div>\n                  <p className=\"text-sm text-muted-foreground leading-relaxed\">\n                    {coaching.todaysFocus}\n                  </p>\n                </div>\n\n                {/* Nutrition Tip */}\n                <div className=\"space-y-2\">\n                  <div className=\"flex items-center gap-2\">\n                    <Lightbulb className=\"h-4 w-4 text-green-500\" />\n                    <span className=\"font-medium text-sm\">Nutrition Tip</span>\n                  </div>\n                  <p className=\"text-sm text-muted-foreground leading-relaxed\">\n                    {coaching.nutritionTip}\n                  </p>\n                </div>\n\n                {/* Medication Tip */}\n                {coaching.medicationTip && (\n                  <div className=\"space-y-2\">\n                    <div className=\"flex items-center gap-2\">\n                      <Zap className=\"h-4 w-4 text-purple-500\" />\n                      <span className=\"font-medium text-sm\">Medication Insight</span>\n                    </div>\n                    <p className=\"text-sm text-muted-foreground leading-relaxed\">\n                      {coaching.medicationTip}\n                    </p>\n                  </div>\n                )}\n\n                {/* Encouragement */}\n                <div className=\"space-y-2\">\n                  <div className=\"flex items-center gap-2\">\n                    <Brain className=\"h-4 w-4 text-indigo-500\" />\n                    <span className=\"font-medium text-sm\">Encouragement</span>\n                  </div>\n                  <p className=\"text-sm text-muted-foreground leading-relaxed\">\n                    {coaching.encouragement}\n                  </p>\n                </div>\n              </>\n            ) : coachingError ? (\n              <div className=\"text-center space-y-4 py-8\">\n                <div className=\"text-6xl\">ðŸ¤–</div>\n                <div className=\"space-y-2\">\n                  <h3 className=\"font-semibold text-lg\">AI Coach Unavailable</h3>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Having trouble connecting to your AI coach. Try generating new content!\n                  </p>\n                </div>\n                <Button \n                  onClick={() => generateCoachingMutation.mutate()}\n                  disabled={generateCoachingMutation.isPending}\n                  className=\"w-full\"\n                >\n                  {generateCoachingMutation.isPending ? (\n                    <>\n                      <RefreshCw className=\"h-4 w-4 mr-2 animate-spin\" />\n                      Generating...\n                    </>\n                  ) : (\n                    <>\n                      <Sparkles className=\"h-4 w-4 mr-2\" />\n                      Generate Daily Coaching\n                    </>\n                  )}\n                </Button>\n              </div>\n            ) : (\n              <div className=\"text-center space-y-4 py-8\">\n                <div className=\"text-6xl\">âœ¨</div>\n                <div className=\"space-y-2\">\n                  <h3 className=\"font-semibold text-lg\">Welcome to AI Coaching!</h3>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Get personalized daily motivation, nutrition tips, and encouragement.\n                  </p>\n                </div>\n                <Button \n                  onClick={() => generateCoachingMutation.mutate()}\n                  disabled={generateCoachingMutation.isPending}\n                  className=\"w-full\"\n                  size=\"lg\"\n                >\n                  {generateCoachingMutation.isPending ? (\n                    <>\n                      <RefreshCw className=\"h-4 w-4 mr-2 animate-spin\" />\n                      Generating Your Coaching...\n                    </>\n                  ) : (\n                    <>\n                      <Sparkles className=\"h-4 w-4 mr-2\" />\n                      Start Your Daily Coaching\n                    </>\n                  )}\n                </Button>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Sound Settings */}\n        <SoundSettings />\n\n        {/* Educational Tips Section */}\n        <Card className=\"health-card\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <BookOpen className=\"h-5 w-5 text-primary\" />\n              Educational Tips\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            {/* Category Filter */}\n            <div className=\"flex gap-2 overflow-x-auto pb-2\">\n              {categories.map((category) => {\n                const Icon = category.icon;\n                return (\n                  <Button\n                    key={category.id}\n                    onClick={() => setSelectedCategory(category.id as any)}\n                    variant={selectedCategory === category.id ? \"default\" : \"outline\"}\n                    size=\"sm\"\n                    className=\"flex items-center gap-2 whitespace-nowrap\"\n                    data-testid={`filter-${category.id}`}\n                  >\n                    <Icon className=\"h-4 w-4\" />\n                    {category.label}\n                  </Button>\n                );\n              })}\n            </div>\n\n            {/* Tips List */}\n            {tipsLoading ? (\n              <div className=\"space-y-3\">\n                {[1, 2, 3].map((i) => (\n                  <div key={i} className=\"p-4 border rounded-lg space-y-2\">\n                    <div className=\"h-4 bg-muted rounded animate-pulse w-3/4\" />\n                    <div className=\"h-3 bg-muted rounded animate-pulse\" />\n                    <div className=\"h-3 bg-muted rounded animate-pulse w-1/2\" />\n                  </div>\n                ))}\n              </div>\n            ) : tips && tips.length > 0 ? (\n              <div className=\"space-y-3\">\n                {tips.map((tip) => (\n                  <div key={tip.id} className=\"p-4 border rounded-lg space-y-2 hover:bg-muted/50 transition-colors\">\n                    <div className=\"flex items-start justify-between gap-2\">\n                      <h3 className=\"font-medium text-sm\">{tip.title}</h3>\n                      <div className=\"flex gap-1\">\n                        <Badge \n                          variant={tip.category === 'nutrition' ? 'default' : tip.category === 'medication' ? 'secondary' : 'outline'}\n                          className=\"text-xs\"\n                        >\n                          {tip.category}\n                        </Badge>\n                        {tip.importance === 'high' && (\n                          <Badge variant=\"destructive\" className=\"text-xs\">\n                            Important\n                          </Badge>\n                        )}\n                      </div>\n                    </div>\n                    <p className=\"text-sm text-muted-foreground leading-relaxed\">\n                      {tip.content}\n                    </p>\n                  </div>\n                ))}\n              </div>\n            ) : (\n              <p className=\"text-sm text-muted-foreground text-center py-4\">\n                No tips available for the selected category.\n              </p>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Reminder Settings */}\n        <Card className=\"health-card\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-2\">\n                <Bell className=\"h-5 w-5 text-primary\" />\n                ðŸŒŸ Daily Motivation\n              </div>\n              {reminderEnabled && (\n                <div className=\"flex items-center gap-1 text-green-600\">\n                  <Check className=\"h-4 w-4\" />\n                  <span className=\"text-sm font-medium\">Active</span>\n                </div>\n              )}\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            {!showReminderSetup ? (\n              <>\n                <div className=\"space-y-2\">\n                  <p className=\"text-sm text-muted-foreground\">\n                    Get daily motivation and inspiring quotes delivered at your preferred time.\n                  </p>\n                  <div className=\"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800\">\n                    <div className=\"flex items-start gap-2\">\n                      <Bell className=\"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0\" />\n                      <div className=\"text-xs text-blue-700 dark:text-blue-300\">\n                        <strong>Notification Info:</strong> For browser notifications, click \"Test\" and allow notifications when prompted. Don't worry - you'll still get in-app motivation even without browser permission!\n                      </div>\n                    </div>\n                  </div>\n                </div>\n                {reminderEnabled ? (\n                  <div className=\"space-y-3\">\n                    <div className=\"flex items-center justify-between p-3 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800\">\n                      <div className=\"flex items-center gap-2\">\n                        <Clock className=\"h-4 w-4 text-green-600\" />\n                        <span className=\"text-sm font-medium text-green-800 dark:text-green-200\">\n                          Daily motivation at {reminderTime}\n                        </span>\n                      </div>\n                      <Switch\n                        checked={reminderEnabled}\n                        onCheckedChange={toggleReminders}\n                        data-testid=\"switch-reminders\"\n                      />\n                    </div>\n                    <div className=\"flex gap-2\">\n                      <Button \n                        variant=\"outline\" \n                        onClick={() => setShowReminderSetup(true)}\n                        className=\"flex-1\"\n                        data-testid=\"button-change-time\"\n                      >\n                        Change Time\n                      </Button>\n                      <Button \n                        onClick={testNotification}\n                        variant=\"outline\"\n                        className=\"flex-1\"\n                        data-testid=\"button-test-notification-active\"\n                        title=\"Test notification (will request permission if needed)\"\n                      >\n                        Test\n                      </Button>\n                    </div>\n                  </div>\n                ) : (\n                  <div className=\"flex items-center gap-2\">\n                    <Input\n                      type=\"time\"\n                      value={reminderTime}\n                      onChange={(e) => saveReminderTime(e.target.value)}\n                      className=\"flex-1\"\n                      data-testid=\"input-quick-time\"\n                    />\n                    <Button \n                      onClick={setupReminders}\n                      className=\"px-6\"\n                      data-testid=\"button-set-reminders\"\n                    >\n                      Set\n                    </Button>\n                    <Button \n                      onClick={testNotification}\n                      variant=\"outline\"\n                      size=\"sm\"\n                      className=\"px-3\"\n                      data-testid=\"button-test-notification\"\n                      title=\"Test notification (will request permission if needed)\"\n                    >\n                      <TestTube2 className=\"h-4 w-4\" />\n                    </Button>\n                  </div>\n                )}\n              </>\n            ) : (\n              <div className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"reminder-time\">Motivation Time</Label>\n                  <Input\n                    id=\"motivation-time\"\n                    type=\"time\"\n                    value={reminderTime}\n                    onChange={(e) => saveReminderTime(e.target.value)}\n                    data-testid=\"input-motivation-time\"\n                  />\n                </div>\n                <div className=\"flex items-center space-x-2\">\n                  <Switch\n                    id=\"enable-reminders\"\n                    checked={true}\n                    data-testid=\"switch-enable-reminders\"\n                  />\n                  <Label htmlFor=\"enable-reminders\" className=\"text-sm\">\n                    Enable daily motivation\n                  </Label>\n                </div>\n                <div className=\"flex gap-2\">\n                  <Button \n                    onClick={setupReminders}\n                    className=\"flex-1\"\n                    data-testid=\"button-save-reminders\"\n                  >\n                    <Check className=\"h-4 w-4 mr-2\" />\n                    Save\n                  </Button>\n                  <Button \n                    variant=\"outline\"\n                    onClick={() => setShowReminderSetup(false)}\n                    className=\"flex-1\"\n                    data-testid=\"button-cancel-reminders\"\n                  >\n                    Cancel\n                  </Button>\n                </div>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n\n      <DropdownNavigation />\n      \n      {/* Bottom Help Section */}\n      <BottomHelpSection />\n    </div>\n  );\n}\n\nexport default CoachingPage;","size_bytes":25590},"CAMERA_TEST_INSTRUCTIONS.md":{"content":"# Camera Test Instructions for Android Build\n\n## Pre-Test Setup\n\n### 1. Build the Android APK\n```bash\n# In your Replit workspace\nnpx cap sync android\nnpx cap open android\n```\n\n### 2. In Android Studio\n- Build > Build Bundle(s) / APK(s) > Build APK(s)\n- Wait for build to complete\n- Install APK on your Android device\n\n## Testing Steps\n\n### Step 1: Navigate to Camera Test Page\n1. Open the PlateMate app on your Android device\n2. Navigate to `/camera-test` route or access from the navigation menu\n\n### Step 2: Run Diagnostics\n1. Tap \"ðŸ” Run Platform Diagnostics\" button\n2. **Expected Results:**\n   - Platform: Should show `android` (NOT `web`)\n   - Is Native Platform: Should show `true`\n   - Camera Plugin Available: Should show `true`\n   - Available Plugins should include: Camera, Device, Filesystem, etc.\n\n**âš ï¸ If platform shows `web`:** The Capacitor bridge is not properly initialized - rebuild required\n\n### Step 3: Check Camera Permissions\n1. Tap \"ðŸ” Check Camera Permissions\" button\n2. If permissions not granted, tap again to request\n3. **Expected Result:** Permission status should show `granted`\n\n### Step 4: Test Native Camera\n1. Tap \"ðŸ“· Test Native Camera\" button\n2. **Expected Behavior:**\n   - Should launch native Android camera (NOT browser camera prompt)\n   - Camera UI should be Android's native camera interface\n   - After taking photo, it should return to app with preview\n\n**âš ï¸ If browser camera prompt appears:** Capacitor Camera is falling back to web - bridge mismatch\n\n### Step 5: Verify Image Capture\n1. After taking photo, verify it displays in the \"Captured Photo\" section\n2. Format should be `jpeg` or `png`\n3. Image should be clear and display correctly\n\n## Debugging Failed Tests\n\n### If Platform Shows \"web\" Instead of \"android\":\n```bash\n# Clean rebuild process\nrm -rf node_modules dist android/app/build\nnpm install\nnpm run build\nnpx cap sync android\n# Rebuild APK in Android Studio\n```\n\n### If Camera Opens in Browser Instead of Native:\n```bash\n# Check Capacitor plugin sync\nnpx cap sync android\n# Verify camera plugin version\nnpm list @capacitor/camera\n# Should show 7.0.2\n```\n\n### If Permission Errors Occur:\n1. Check `AndroidManifest.xml` has camera permissions\n2. Manually grant permissions in Android Settings\n3. Verify app is running in secure context (HTTPS in WebView)\n\n### Get Android Logs:\n```bash\n# Connect device via USB\nadb logcat | grep -E \"Capacitor|Camera|platemate|chromium\"\n\n# Filter for errors only\nadb logcat | grep -E \"ERROR|FATAL\"\n```\n\n## Success Criteria\n\nâœ… **Camera Test Passes When:**\n1. Platform detection shows `android` (not `web`)\n2. `isNativePlatform` returns `true`\n3. Camera plugin launches Android's native camera interface\n4. Photos are successfully captured and displayed\n5. No WebView camera fallback occurs\n\n## Troubleshooting Common Issues\n\n| Issue | Cause | Solution |\n|-------|-------|----------|\n| Platform shows \"web\" | Capacitor bridge mismatch | Clean rebuild with `npx cap sync android` |\n| Browser camera appears | HTML fallback triggered | Verify Capacitor.isNativePlatform() returns true |\n| Permission denied | Android permissions | Grant camera permission in Android Settings |\n| Black screen | WebView security | Ensure app uses HTTPS in production |\n\n## After Successful Test\n\nOnce all tests pass on the test page:\n1. The native camera bridge is working correctly\n2. Safe to test the full camera functionality in main app\n3. Build production APK for deployment\n\n## Additional Notes\n\n- **Development vs Production:** Auth cookies may behave differently in dev\n- **WebView Context:** Android WebView has stricter security than mobile browser\n- **Capacitor Version:** Ensure all @capacitor packages use 7.x.x consistently\n","size_bytes":3722},"client/src/pages/CameraTestPage.tsx":{"content":"import { useState, useEffect, useRef } from \"react\";\nimport { Camera, CameraResultType, CameraSource, Photo } from '@capacitor/camera';\nimport { Device } from '@capacitor/device';\nimport { Capacitor } from '@capacitor/core';\nimport { mediaService } from '@/lib/media-service';\nimport { useToast } from \"@/hooks/use-toast\";\nimport { AppHeader } from \"@/components/app-header\";\nimport { \n  Camera as CameraIcon, \n  Image, \n  RotateCcw, \n  Download, \n  Info, \n  CheckCircle, \n  XCircle, \n  Smartphone, \n  Monitor,\n  RefreshCw,\n  Play,\n  Square\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\n\ninterface DeviceInfo {\n  platform: string;\n  model: string;\n  operatingSystem: string;\n  osVersion: string;\n  manufacturer: string;\n  isVirtual: boolean;\n}\n\ninterface PermissionStatus {\n  camera: boolean;\n  photos: boolean;\n  checked: boolean;\n}\n\nexport default function CameraTestPage() {\n  const { toast } = useToast();\n  const videoRef = useRef<HTMLVideoElement>(null);\n  \n  // State\n  const [deviceInfo, setDeviceInfo] = useState<DeviceInfo | null>(null);\n  const [permissions, setPermissions] = useState<PermissionStatus>({\n    camera: false,\n    photos: false,\n    checked: false\n  });\n  const [capturedPhoto, setCapturedPhoto] = useState<Photo | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isCameraActive, setIsCameraActive] = useState(false);\n  const [availableCameras, setAvailableCameras] = useState<MediaDeviceInfo[]>([]);\n  const [isNativePlatform, setIsNativePlatform] = useState(false);\n\n  // Initialize component\n  useEffect(() => {\n    const initializeCamera = async () => {\n      try {\n        // Get device info\n        const info = await Device.getInfo();\n        setDeviceInfo(info as DeviceInfo);\n        setIsNativePlatform(Capacitor.isNativePlatform());\n\n        // Check permissions\n        await checkPermissions();\n\n        // Get available cameras\n        const cameras = await mediaService.getAvailableCameras();\n        setAvailableCameras(cameras);\n\n      } catch (error) {\n        console.error('Failed to initialize camera:', error);\n        toast({\n          title: \"Initialization Failed\",\n          description: \"Could not initialize camera functionality\",\n          variant: \"destructive\",\n        });\n      }\n    };\n\n    initializeCamera();\n\n    // Cleanup on unmount\n    return () => {\n      if (isCameraActive) {\n        mediaService.stopCamera();\n        setIsCameraActive(false);\n      }\n    };\n  }, [toast, isCameraActive]);\n\n  const checkPermissions = async () => {\n    try {\n      const mediaPermissions = await mediaService.checkPermissions();\n      setPermissions({\n        camera: mediaPermissions.camera,\n        photos: mediaPermissions.camera, // For simplicity, using camera permission for photos\n        checked: true\n      });\n    } catch (error) {\n      console.error('Permission check failed:', error);\n      setPermissions({ camera: false, photos: false, checked: true });\n    }\n  };\n\n  const handleTakePhoto = async () => {\n    setIsLoading(true);\n    try {\n      const photo = await mediaService.takePhoto({\n        quality: 90,\n        allowEditing: false,\n        resultType: CameraResultType.Uri,\n        source: CameraSource.Camera,\n      });\n\n      setCapturedPhoto(photo);\n      toast({\n        title: \"Photo Captured! ðŸ“¸\",\n        description: `Successfully captured photo using ${isNativePlatform ? 'native' : 'web'} camera`,\n      });\n    } catch (error) {\n      console.error('Failed to take photo:', error);\n      toast({\n        title: \"Camera Error\",\n        description: `Failed to capture photo: ${error}`,\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleSelectFromGallery = async () => {\n    setIsLoading(true);\n    try {\n      const photo = await mediaService.selectFromGallery({\n        quality: 90,\n        allowEditing: false,\n      });\n\n      setCapturedPhoto(photo);\n      toast({\n        title: \"Photo Selected! ðŸ–¼ï¸\",\n        description: `Successfully selected photo from ${isNativePlatform ? 'gallery' : 'files'}`,\n      });\n    } catch (error) {\n      console.error('Failed to select photo:', error);\n      toast({\n        title: \"Gallery Error\",\n        description: `Failed to select photo: ${error}`,\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleStartLivePreview = async () => {\n    if (isCameraActive) {\n      mediaService.stopCamera();\n      setIsCameraActive(false);\n      return;\n    }\n\n    if (!videoRef.current) {\n      toast({\n        title: \"Video Error\",\n        description: \"Video element not available\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    try {\n      setIsLoading(true);\n      await mediaService.startCamera(videoRef.current);\n      setIsCameraActive(true);\n      \n      toast({\n        title: \"Live Preview Started! ðŸ“¹\",\n        description: \"Camera stream is now active\",\n      });\n    } catch (error) {\n      console.error('Failed to start camera:', error);\n      toast({\n        title: \"Camera Error\",\n        description: `Failed to start camera: ${error}`,\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleSwitchCamera = async () => {\n    if (!isCameraActive || !videoRef.current) {\n      toast({\n        title: \"Camera Error\",\n        description: \"Start live preview first to switch cameras\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    try {\n      setIsLoading(true);\n      await mediaService.switchCamera(videoRef.current);\n      \n      toast({\n        title: \"Camera Switched! ðŸ”„\",\n        description: \"Successfully switched to the next available camera\",\n      });\n    } catch (error) {\n      console.error('Failed to switch camera:', error);\n      toast({\n        title: \"Switch Error\",\n        description: `Failed to switch camera: ${error}`,\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleCaptureFromStream = async () => {\n    if (!isCameraActive || !videoRef.current) {\n      toast({\n        title: \"Camera Error\",\n        description: \"Start live preview first to capture from stream\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    try {\n      setIsLoading(true);\n      const blob = await mediaService.capturePhotoFromStream(videoRef.current);\n      \n      // Convert blob to data URL for display\n      const reader = new FileReader();\n      reader.onload = () => {\n        const dataUrl = reader.result as string;\n        setCapturedPhoto({\n          webPath: dataUrl,\n          format: 'jpeg'\n        } as Photo);\n      };\n      reader.readAsDataURL(blob);\n\n      toast({\n        title: \"Stream Captured! ðŸ“¸\",\n        description: \"Successfully captured photo from live stream\",\n      });\n    } catch (error) {\n      console.error('Failed to capture from stream:', error);\n      toast({\n        title: \"Capture Error\",\n        description: `Failed to capture from stream: ${error}`,\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const downloadPhoto = () => {\n    if (!capturedPhoto?.webPath) return;\n\n    const link = document.createElement('a');\n    link.href = capturedPhoto.webPath;\n    link.download = `platemate-photo-${Date.now()}.jpg`;\n    link.click();\n\n    toast({\n      title: \"Photo Downloaded! ðŸ’¾\",\n      description: \"Photo has been saved to your downloads\",\n    });\n  };\n\n  return (\n    <div className=\"min-h-screen text-foreground\" style={{background: 'var(--bg-gradient)'}}>\n      <AppHeader />\n      \n      <div className=\"max-w-4xl mx-auto px-4 py-6 space-y-6\">\n        {/* Header */}\n        <div className=\"text-center space-y-2\">\n          <h1 className=\"text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 dark:from-blue-400 dark:to-purple-400 bg-clip-text text-transparent\">\n            Camera Test\n          </h1>\n          <p className=\"text-lg text-muted-foreground\">\n            Test Capacitor Camera API functionality\n          </p>\n        </div>\n\n        {/* Device Info Card */}\n        <Card className=\"bg-white/60 dark:bg-gray-800/60 backdrop-blur-xl border-white/20 shadow-xl\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Info className=\"h-5 w-5\" />\n              Device Information\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div className=\"space-y-3\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"font-medium\">Platform:</span>\n                  <Badge variant={isNativePlatform ? \"default\" : \"secondary\"} className=\"flex items-center gap-1\">\n                    {isNativePlatform ? <Smartphone className=\"h-3 w-3\" /> : <Monitor className=\"h-3 w-3\" />}\n                    {deviceInfo?.platform || 'Unknown'}\n                  </Badge>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"font-medium\">Model:</span>\n                  <span className=\"text-sm\">{deviceInfo?.model || 'Unknown'}</span>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"font-medium\">OS:</span>\n                  <span className=\"text-sm\">{deviceInfo?.operatingSystem} {deviceInfo?.osVersion}</span>\n                </div>\n              </div>\n              <div className=\"space-y-3\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"font-medium\">Camera Permission:</span>\n                  <Badge variant={permissions.camera ? \"default\" : \"destructive\"} className=\"flex items-center gap-1\">\n                    {permissions.camera ? <CheckCircle className=\"h-3 w-3\" /> : <XCircle className=\"h-3 w-3\" />}\n                    {permissions.camera ? 'Granted' : 'Denied'}\n                  </Badge>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"font-medium\">Available Cameras:</span>\n                  <span className=\"text-sm\">{availableCameras.length}</span>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"font-medium\">Secure Context:</span>\n                  <Badge variant={mediaService.isSecureContext() ? \"default\" : \"destructive\"} className=\"flex items-center gap-1\">\n                    {mediaService.isSecureContext() ? <CheckCircle className=\"h-3 w-3\" /> : <XCircle className=\"h-3 w-3\" />}\n                    {mediaService.isSecureContext() ? 'Yes' : 'No'}\n                  </Badge>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Camera Controls */}\n        <Card className=\"bg-white/60 dark:bg-gray-800/60 backdrop-blur-xl border-white/20 shadow-xl\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <CameraIcon className=\"h-5 w-5\" />\n              Camera Controls\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            {/* Primary Actions */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <Button\n                onClick={handleTakePhoto}\n                disabled={isLoading}\n                className=\"h-12 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-semibold\"\n                data-testid=\"button-take-photo\"\n              >\n                <CameraIcon className=\"mr-2 h-4 w-4\" />\n                {isLoading ? 'Taking Photo...' : 'Take Photo'}\n              </Button>\n\n              <Button\n                onClick={handleSelectFromGallery}\n                disabled={isLoading}\n                variant=\"outline\"\n                className=\"h-12 border-2 border-purple-200 dark:border-purple-700 hover:bg-purple-50 dark:hover:bg-purple-900/20\"\n                data-testid=\"button-select-gallery\"\n              >\n                <Image className=\"mr-2 h-4 w-4\" />\n                {isLoading ? 'Selecting...' : 'Select from Gallery'}\n              </Button>\n            </div>\n\n            {/* Live Preview Controls */}\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3\">\n              <Button\n                onClick={handleStartLivePreview}\n                disabled={isLoading}\n                variant={isCameraActive ? \"destructive\" : \"default\"}\n                className=\"h-10\"\n                data-testid=\"button-live-preview\"\n              >\n                {isCameraActive ? <Square className=\"mr-2 h-4 w-4\" /> : <Play className=\"mr-2 h-4 w-4\" />}\n                {isCameraActive ? 'Stop Preview' : 'Live Preview'}\n              </Button>\n\n              <Button\n                onClick={handleSwitchCamera}\n                disabled={isLoading || !isCameraActive}\n                variant=\"outline\"\n                className=\"h-10\"\n                data-testid=\"button-switch-camera\"\n              >\n                <RotateCcw className=\"mr-2 h-4 w-4\" />\n                Switch Camera\n              </Button>\n\n              <Button\n                onClick={handleCaptureFromStream}\n                disabled={isLoading || !isCameraActive}\n                variant=\"outline\"\n                className=\"h-10\"\n                data-testid=\"button-capture-stream\"\n              >\n                <CameraIcon className=\"mr-2 h-4 w-4\" />\n                Capture Stream\n              </Button>\n            </div>\n\n            {/* Refresh Permissions */}\n            <Button\n              onClick={checkPermissions}\n              disabled={isLoading}\n              variant=\"ghost\"\n              className=\"w-full h-10\"\n              data-testid=\"button-refresh-permissions\"\n            >\n              <RefreshCw className=\"mr-2 h-4 w-4\" />\n              Refresh Permissions\n            </Button>\n          </CardContent>\n        </Card>\n\n        {/* Live Preview */}\n        {isCameraActive && (\n          <Card className=\"bg-white/60 dark:bg-gray-800/60 backdrop-blur-xl border-white/20 shadow-xl\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Play className=\"h-5 w-5\" />\n                Live Preview\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"relative rounded-xl overflow-hidden bg-black\">\n                <video\n                  ref={videoRef}\n                  className=\"w-full h-64 object-cover\"\n                  playsInline\n                  muted\n                  data-testid=\"video-preview\"\n                />\n                {isLoading && (\n                  <div className=\"absolute inset-0 bg-black/50 flex items-center justify-center\">\n                    <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-white\"></div>\n                  </div>\n                )}\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Photo Display */}\n        {capturedPhoto && (\n          <Card className=\"bg-white/60 dark:bg-gray-800/60 backdrop-blur-xl border-white/20 shadow-xl\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center justify-between\">\n                <div className=\"flex items-center gap-2\">\n                  <Image className=\"h-5 w-5\" />\n                  Captured Photo\n                </div>\n                <Button\n                  onClick={downloadPhoto}\n                  variant=\"outline\"\n                  size=\"sm\"\n                  data-testid=\"button-download-photo\"\n                >\n                  <Download className=\"mr-2 h-4 w-4\" />\n                  Download\n                </Button>\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"rounded-xl overflow-hidden bg-gray-100 dark:bg-gray-800\">\n                <img\n                  src={capturedPhoto.webPath}\n                  alt=\"Captured\"\n                  className=\"w-full h-auto max-h-96 object-contain\"\n                  data-testid=\"img-captured-photo\"\n                />\n              </div>\n              <div className=\"mt-4 text-sm text-muted-foreground\">\n                <p><strong>Format:</strong> {capturedPhoto.format}</p>\n                <p><strong>Path:</strong> {capturedPhoto.webPath ? 'Available' : 'Not available'}</p>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n    </div>\n  );\n}","size_bytes":16891},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\nimport emailAuthRoutes from \"./email-auth\";\nimport { appTokenMiddleware } from \"./middleware/app-token-middleware\";\n\nconst app = express();\n\n// Disable ETags globally to prevent 304 Not Modified responses\napp.set('etag', false);\n\napp.use(express.json());\napp.use(express.urlencoded({ extended: false }));\n\n// Serve static files from public directory (before token middleware)\napp.use(express.static('public'));\n\n// App token validation middleware (now in BLOCKING mode)\napp.use(appTokenMiddleware);\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"â€¦\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n// Register email/password authentication routes\napp.use(\"/api\", emailAuthRoutes);\n\n(async () => {\n  const server = await registerRoutes(app);\n  \n  // Initialize gamification challenges in database\n  try {\n    const { challengeService } = await import(\"./services/challenge-service\");\n    await challengeService.initializeChallenges();\n  } catch (error) {\n    console.error(\"Failed to initialize challenges:\", error);\n  }\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  \n  // Force development mode for now to show live changes\n  // Only use deployment mode when NODE_ENV is production\n  const isDeployment = process.env.NODE_ENV === \"production\";\n  \n  if (!isDeployment) {\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || '5000', 10);\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    log(`serving on port ${port}`);\n  });\n})();\n","size_bytes":2993},"client/src/components/nutrition-calculator.tsx":{"content":"import React from 'react';\nimport { Calculator, Target, Plus, Minus, ChefHat, Coffee, Utensils, Apple, Beef, Wheat, Droplets, Flame } from 'lucide-react';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Badge } from '@/components/ui/badge';\nimport { Progress } from '@/components/ui/progress';\nimport { useQuery } from '@tanstack/react-query';\n\ninterface NutritionGoals {\n  dailyCalories: number | null;\n  dailyProtein: number | null;\n  dailyCarbs: number | null;\n  dailyFat: number | null;\n  dailyWater: number | null;\n}\n\ninterface ConsumedNutrition {\n  calories: number;\n  protein: number;\n  carbs: number;\n  fat: number;\n  water: number;\n}\n\ninterface FoodSuggestion {\n  name: string;\n  portion: string;\n  calories: number;\n  protein: number;\n  carbs: number;\n  fat: number;\n  icon: string;\n}\n\nconst commonFoods: FoodSuggestion[] = [\n  { name: \"Grilled Chicken Breast\", portion: \"100g\", calories: 165, protein: 31, carbs: 0, fat: 3.6, icon: \"ðŸ”\" },\n  { name: \"Brown Rice\", portion: \"1 cup cooked\", calories: 216, protein: 5, carbs: 45, fat: 1.8, icon: \"ðŸš\" },\n  { name: \"Greek Yogurt\", portion: \"1 cup\", calories: 130, protein: 23, carbs: 9, fat: 0, icon: \"ðŸ¥›\" },\n  { name: \"Banana\", portion: \"1 medium\", calories: 105, protein: 1.3, carbs: 27, fat: 0.4, icon: \"ðŸŒ\" },\n  { name: \"Almonds\", portion: \"1 oz (23 nuts)\", calories: 164, protein: 6, carbs: 6, fat: 14, icon: \"ðŸ¥œ\" },\n  { name: \"Salmon Fillet\", portion: \"100g\", calories: 208, protein: 25, carbs: 0, fat: 12, icon: \"ðŸŸ\" },\n  { name: \"Sweet Potato\", portion: \"1 medium baked\", calories: 112, protein: 2, carbs: 26, fat: 0.1, icon: \"ðŸ \" },\n  { name: \"Broccoli\", portion: \"1 cup\", calories: 25, protein: 3, carbs: 5, fat: 0.3, icon: \"ðŸ¥¦\" },\n  { name: \"Oatmeal\", portion: \"1 cup cooked\", calories: 154, protein: 6, carbs: 28, fat: 3, icon: \"ðŸ¥£\" },\n  { name: \"Eggs\", portion: \"2 large\", calories: 140, protein: 12, carbs: 1, fat: 10, icon: \"ðŸ¥š\" },\n];\n\ninterface NutritionCalculatorProps {\n  goals?: NutritionGoals;\n  consumed: ConsumedNutrition;\n}\n\nexport function NutritionCalculator({ goals, consumed }: NutritionCalculatorProps) {\n  const [plannedMeals, setPlannedMeals] = React.useState<FoodSuggestion[]>([]);\n  const [customFood, setCustomFood] = React.useState({\n    name: '',\n    calories: 0,\n    protein: 0,\n    carbs: 0,\n    fat: 0,\n  });\n\n  // Debug logging\n  React.useEffect(() => {\n    console.log('Calculator received data:', { goals, consumed });\n  }, [goals, consumed]);\n\n  const defaultGoals = {\n    dailyCalories: 2000,\n    dailyProtein: 150,\n    dailyCarbs: 250,\n    dailyFat: 65,\n    dailyWater: 2000,\n  };\n\n  const currentGoals = goals ? {\n    dailyCalories: goals.dailyCalories || defaultGoals.dailyCalories,\n    dailyProtein: goals.dailyProtein || defaultGoals.dailyProtein,\n    dailyCarbs: goals.dailyCarbs || defaultGoals.dailyCarbs,\n    dailyFat: goals.dailyFat || defaultGoals.dailyFat,\n    dailyWater: goals.dailyWater || defaultGoals.dailyWater,\n  } : defaultGoals;\n\n  // Calculate remaining nutrients needed\n  const remaining = {\n    calories: Math.max(0, currentGoals.dailyCalories - consumed.calories),\n    protein: Math.max(0, currentGoals.dailyProtein - consumed.protein),\n    carbs: Math.max(0, currentGoals.dailyCarbs - consumed.carbs),\n    fat: Math.max(0, currentGoals.dailyFat - consumed.fat),\n    water: Math.max(0, currentGoals.dailyWater - consumed.water),\n  };\n\n  // Calculate totals including planned meals\n  const plannedTotals = plannedMeals.reduce((total, meal) => ({\n    calories: total.calories + meal.calories,\n    protein: total.protein + meal.protein,\n    carbs: total.carbs + meal.carbs,\n    fat: total.fat + meal.fat,\n  }), { calories: 0, protein: 0, carbs: 0, fat: 0 });\n\n  const projectedTotals = {\n    calories: consumed.calories + plannedTotals.calories,\n    protein: consumed.protein + plannedTotals.protein,\n    carbs: consumed.carbs + plannedTotals.carbs,\n    fat: consumed.fat + plannedTotals.fat,\n  };\n\n  const addPlannedMeal = (food: FoodSuggestion) => {\n    setPlannedMeals([...plannedMeals, food]);\n  };\n\n  const removePlannedMeal = (index: number) => {\n    setPlannedMeals(plannedMeals.filter((_, i) => i !== index));\n  };\n\n  const addCustomFood = () => {\n    if (customFood.name && customFood.calories > 0) {\n      addPlannedMeal({\n        ...customFood,\n        portion: \"custom portion\",\n        icon: \"ðŸ½ï¸\"\n      });\n      setCustomFood({ name: '', calories: 0, protein: 0, carbs: 0, fat: 0 });\n    }\n  };\n\n  // Smart food suggestions based on remaining nutrients\n  const getSmartSuggestions = (): FoodSuggestion[] => {\n    const suggestions: FoodSuggestion[] = [];\n    \n    if (remaining.protein > 20) {\n      const chicken = commonFoods.find(f => f.name === \"Grilled Chicken Breast\");\n      const yogurt = commonFoods.find(f => f.name === \"Greek Yogurt\");\n      if (chicken) suggestions.push(chicken);\n      if (yogurt) suggestions.push(yogurt);\n    }\n    \n    if (remaining.carbs > 30) {\n      const rice = commonFoods.find(f => f.name === \"Brown Rice\");\n      const potato = commonFoods.find(f => f.name === \"Sweet Potato\");\n      if (rice) suggestions.push(rice);\n      if (potato) suggestions.push(potato);\n    }\n    \n    if (remaining.fat > 10) {\n      const almonds = commonFoods.find(f => f.name === \"Almonds\");\n      const salmon = commonFoods.find(f => f.name === \"Salmon Fillet\");\n      if (almonds) suggestions.push(almonds);\n      if (salmon) suggestions.push(salmon);\n    }\n    \n    if (remaining.calories > 200) {\n      const oatmeal = commonFoods.find(f => f.name === \"Oatmeal\");\n      if (oatmeal) suggestions.push(oatmeal);\n    }\n    \n    return suggestions.slice(0, 4);\n  };\n\n  const calculateProgress = (current: number, target: number) => {\n    return Math.min((current / target) * 100, 100);\n  };\n\n  return (\n    <div className=\"max-w-6xl mx-auto p-6 space-y-6\">\n      <div className=\"text-center mb-8\">\n        <h1 className=\"text-3xl font-bold mb-2 flex items-center justify-center gap-2 text-white\">\n          <Calculator className=\"h-8 w-8 text-white\" />\n          Nutrition Planner\n        </h1>\n        <p className=\"text-white/90 text-base mb-3\">\n          See what nutrients you still need today and plan meals to reach your goals\n        </p>\n        <p className=\"text-white/70 text-sm max-w-2xl mx-auto\">\n          Already logged breakfast and lunch? This tool shows what's left to eat for the day based on your nutrition targets.\n        </p>\n      </div>\n\n      <Tabs defaultValue=\"remaining\" className=\"w-full\">\n        <TabsList className=\"grid w-full grid-cols-2 sm:grid-cols-4\">\n          <TabsTrigger value=\"remaining\" data-testid=\"tab-remaining\">Remaining</TabsTrigger>\n          <TabsTrigger value=\"planner\" data-testid=\"tab-planner\">Meal Planner</TabsTrigger>\n          <TabsTrigger value=\"suggestions\" data-testid=\"tab-suggestions\">Smart Suggestions</TabsTrigger>\n          <TabsTrigger value=\"scenarios\" data-testid=\"tab-scenarios\">Scenarios</TabsTrigger>\n        </TabsList>\n\n        {/* Remaining Nutrients Tab */}\n        <TabsContent value=\"remaining\" className=\"space-y-6\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Target className=\"h-5 w-5\" />\n                Remaining to Reach Goals\n              </CardTitle>\n              <CardDescription>\n                How much more you need to eat today to hit your targets\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                <div className=\"text-center p-4 bg-red-50 dark:bg-red-900/20 rounded-lg\" data-testid=\"remaining-calories\">\n                  <Flame className=\"h-8 w-8 mx-auto text-red-600 mb-2\" />\n                  <div className=\"text-2xl font-bold text-red-600\">{remaining.calories}</div>\n                  <div className=\"text-sm text-muted-foreground\">calories left</div>\n                </div>\n                <div className=\"text-center p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg\" data-testid=\"remaining-protein\">\n                  <Beef className=\"h-8 w-8 mx-auto text-blue-600 mb-2\" />\n                  <div className=\"text-2xl font-bold text-blue-600\">{remaining.protein}g</div>\n                  <div className=\"text-sm text-muted-foreground\">protein left</div>\n                </div>\n                <div className=\"text-center p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg\" data-testid=\"remaining-carbs\">\n                  <Wheat className=\"h-8 w-8 mx-auto text-yellow-600 mb-2\" />\n                  <div className=\"text-2xl font-bold text-yellow-600\">{remaining.carbs}g</div>\n                  <div className=\"text-sm text-muted-foreground\">carbs left</div>\n                </div>\n                <div className=\"text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-lg\" data-testid=\"remaining-fat\">\n                  <Droplets className=\"h-8 w-8 mx-auto text-green-600 mb-2\" />\n                  <div className=\"text-2xl font-bold text-green-600\">{remaining.fat}g</div>\n                  <div className=\"text-sm text-muted-foreground\">fat left</div>\n                </div>\n              </div>\n              \n              {remaining.calories <= 0 && remaining.protein <= 0 && remaining.carbs <= 0 && remaining.fat <= 0 ? (\n                <div className=\"mt-6 p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg text-center\">\n                  <div className=\"text-green-800 dark:text-green-200 font-medium\">\n                    ðŸŽ‰ Congratulations! You've reached all your nutrition goals for today!\n                  </div>\n                </div>\n              ) : (\n                <div className=\"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg text-center\">\n                  <div className=\"text-blue-800 dark:text-blue-200 font-medium\">\n                    ðŸ’¡ You have <span className=\"font-bold\">{Math.round(remaining.calories + remaining.protein*4 + remaining.carbs*4 + remaining.fat*9)}</span> total calories remaining across all nutrients\n                  </div>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        {/* Meal Planner Tab */}\n        <TabsContent value=\"planner\" className=\"space-y-6\">\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <ChefHat className=\"h-5 w-5\" />\n                  Plan Your Meals\n                </CardTitle>\n                <CardDescription>\n                  Add foods to see how they'll affect your daily totals\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Quick Add Common Foods</Label>\n                  <div className=\"grid grid-cols-1 gap-2\">\n                    {commonFoods.slice(0, 6).map((food, index) => (\n                      <Button\n                        key={index}\n                        variant=\"outline\"\n                        className=\"justify-start h-auto p-3\"\n                        onClick={() => addPlannedMeal(food)}\n                        data-testid={`add-food-${food.name.replace(/\\s+/g, '-').toLowerCase()}`}\n                      >\n                        <span className=\"text-lg mr-2\">{food.icon}</span>\n                        <div className=\"text-left\">\n                          <div className=\"font-medium\">{food.name}</div>\n                          <div className=\"text-xs text-muted-foreground\">\n                            {food.calories} cal, {food.protein}g protein\n                          </div>\n                        </div>\n                      </Button>\n                    ))}\n                  </div>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>Custom Food</Label>\n                  <div className=\"grid grid-cols-2 gap-2\">\n                    <Input\n                      placeholder=\"Food name\"\n                      value={customFood.name}\n                      onChange={(e) => setCustomFood({...customFood, name: e.target.value})}\n                      data-testid=\"input-custom-food-name\"\n                    />\n                    <Input\n                      type=\"number\"\n                      placeholder=\"Calories\"\n                      value={customFood.calories || ''}\n                      onChange={(e) => setCustomFood({...customFood, calories: parseInt(e.target.value) || 0})}\n                      data-testid=\"input-custom-calories\"\n                    />\n                    <Input\n                      type=\"number\"\n                      placeholder=\"Protein (g)\"\n                      value={customFood.protein || ''}\n                      onChange={(e) => setCustomFood({...customFood, protein: parseInt(e.target.value) || 0})}\n                      data-testid=\"input-custom-protein\"\n                    />\n                    <Input\n                      type=\"number\"\n                      placeholder=\"Carbs (g)\"\n                      value={customFood.carbs || ''}\n                      onChange={(e) => setCustomFood({...customFood, carbs: parseInt(e.target.value) || 0})}\n                      data-testid=\"input-custom-carbs\"\n                    />\n                  </div>\n                  <Button onClick={addCustomFood} className=\"w-full\" data-testid=\"button-add-custom-food\">\n                    <Plus className=\"h-4 w-4 mr-2\" />\n                    Add Custom Food\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Planned Meals</CardTitle>\n                <CardDescription>\n                  Foods you're planning to eat today\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                {plannedMeals.length === 0 ? (\n                  <div className=\"text-center text-muted-foreground py-8\">\n                    <Utensils className=\"h-12 w-12 mx-auto mb-2 opacity-50\" />\n                    <p>No meals planned yet</p>\n                    <p className=\"text-sm\">Add foods to see how they affect your goals</p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-2\">\n                    {plannedMeals.map((meal, index) => (\n                      <div key={index} className=\"flex items-center justify-between p-3 bg-muted rounded-lg\" data-testid={`planned-meal-${index}`}>\n                        <div className=\"flex items-center gap-3\">\n                          <span className=\"text-lg\">{meal.icon}</span>\n                          <div>\n                            <div className=\"font-medium\">{meal.name}</div>\n                            <div className=\"text-xs text-muted-foreground\">\n                              {meal.calories} cal, {meal.protein}g protein, {meal.carbs}g carbs, {meal.fat}g fat\n                            </div>\n                          </div>\n                        </div>\n                        <Button\n                          size=\"sm\"\n                          variant=\"ghost\"\n                          onClick={() => removePlannedMeal(index)}\n                          data-testid={`remove-meal-${index}`}\n                        >\n                          <Minus className=\"h-4 w-4\" />\n                        </Button>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Projected Totals */}\n          {plannedMeals.length > 0 && (\n            <Card>\n              <CardHeader>\n                <CardTitle>Projected Daily Totals</CardTitle>\n                <CardDescription>\n                  Your nutrition if you eat everything planned\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                  {[\n                    { label: 'Calories', current: projectedTotals.calories, target: currentGoals.dailyCalories, icon: Flame, color: 'red' },\n                    { label: 'Protein', current: projectedTotals.protein, target: currentGoals.dailyProtein, icon: Beef, color: 'blue' },\n                    { label: 'Carbs', current: projectedTotals.carbs, target: currentGoals.dailyCarbs, icon: Wheat, color: 'yellow' },\n                    { label: 'Fat', current: projectedTotals.fat, target: currentGoals.dailyFat, icon: Droplets, color: 'green' },\n                  ].map(({ label, current, target, icon: Icon, color }) => {\n                    const progress = calculateProgress(current, target);\n                    return (\n                      <div key={label} className=\"text-center\" data-testid={`projected-${label.toLowerCase()}`}>\n                        <Icon className={`h-6 w-6 mx-auto mb-2 text-${color}-600`} />\n                        <div className=\"text-lg font-bold\">{Math.round(current)}</div>\n                        <div className=\"text-xs text-muted-foreground\">/ {target}</div>\n                        <Progress value={progress} className=\"h-2 mt-2\" />\n                        <div className={`text-xs mt-1 ${progress >= 100 ? 'text-green-600' : 'text-muted-foreground'}`}>\n                          {Math.round(progress)}%\n                        </div>\n                      </div>\n                    );\n                  })}\n                </div>\n              </CardContent>\n            </Card>\n          )}\n        </TabsContent>\n\n        {/* Smart Suggestions Tab */}\n        <TabsContent value=\"suggestions\" className=\"space-y-6\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Apple className=\"h-5 w-5\" />\n                Smart Food Suggestions\n              </CardTitle>\n              <CardDescription>\n                Based on your remaining nutrient needs\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                {getSmartSuggestions().map((food, index) => (\n                  <div key={index} className=\"p-4 border rounded-lg\" data-testid={`suggestion-${index}`}>\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <div className=\"flex items-center gap-2\">\n                        <span className=\"text-xl\">{food.icon}</span>\n                        <div>\n                          <div className=\"font-medium\">{food.name}</div>\n                          <div className=\"text-xs text-muted-foreground\">{food.portion}</div>\n                        </div>\n                      </div>\n                      <Button\n                        size=\"sm\"\n                        onClick={() => addPlannedMeal(food)}\n                        data-testid={`add-suggested-${index}`}\n                      >\n                        <Plus className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                    <div className=\"grid grid-cols-4 gap-2 text-xs\">\n                      <div className=\"text-center\">\n                        <div className=\"font-medium\">{food.calories}</div>\n                        <div className=\"text-muted-foreground\">cal</div>\n                      </div>\n                      <div className=\"text-center\">\n                        <div className=\"font-medium\">{food.protein}g</div>\n                        <div className=\"text-muted-foreground\">protein</div>\n                      </div>\n                      <div className=\"text-center\">\n                        <div className=\"font-medium\">{food.carbs}g</div>\n                        <div className=\"text-muted-foreground\">carbs</div>\n                      </div>\n                      <div className=\"text-center\">\n                        <div className=\"font-medium\">{food.fat}g</div>\n                        <div className=\"text-muted-foreground\">fat</div>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n              \n              {getSmartSuggestions().length === 0 && (\n                <div className=\"text-center text-muted-foreground py-8\">\n                  <Apple className=\"h-12 w-12 mx-auto mb-2 opacity-50\" />\n                  <p>Great job! You're close to reaching all your goals.</p>\n                  <p className=\"text-sm\">No specific food suggestions needed right now.</p>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        {/* Scenarios Tab */}\n        <TabsContent value=\"scenarios\" className=\"space-y-6\">\n          <Card>\n            <CardHeader>\n              <CardTitle>Goal Achievement Scenarios</CardTitle>\n              <CardDescription>\n                Different ways to reach your remaining targets\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-4\">\n                {remaining.calories > 100 && (\n                  <div className=\"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg\">\n                    <h4 className=\"font-medium mb-2\">High Protein Scenario</h4>\n                    <p className=\"text-sm text-muted-foreground mb-3\">\n                      To get {remaining.calories} calories with emphasis on protein:\n                    </p>\n                    <div className=\"grid grid-cols-2 gap-2 text-sm\">\n                      <div>â€¢ Greek yogurt (1 cup) = 130 cal, 23g protein</div>\n                      <div>â€¢ Chicken breast (50g) = 83 cal, 15g protein</div>\n                      <div>â€¢ Almonds (15g) = 87 cal, 3g protein</div>\n                      <div>â€¢ Banana (1 medium) = 105 cal, 1g protein</div>\n                    </div>\n                  </div>\n                )}\n                \n                {remaining.carbs > 30 && (\n                  <div className=\"p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg\">\n                    <h4 className=\"font-medium mb-2\">Carb-Focused Scenario</h4>\n                    <p className=\"text-sm text-muted-foreground mb-3\">\n                      To get {remaining.carbs}g carbs while staying within calories:\n                    </p>\n                    <div className=\"grid grid-cols-2 gap-2 text-sm\">\n                      <div>â€¢ Brown rice (1 cup) = 216 cal, 45g carbs</div>\n                      <div>â€¢ Sweet potato (1 medium) = 112 cal, 26g carbs</div>\n                      <div>â€¢ Oatmeal (1 cup) = 154 cal, 28g carbs</div>\n                      <div>â€¢ Apple (1 medium) = 95 cal, 25g carbs</div>\n                    </div>\n                  </div>\n                )}\n                \n                {remaining.fat > 10 && (\n                  <div className=\"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg\">\n                    <h4 className=\"font-medium mb-2\">Healthy Fats Scenario</h4>\n                    <p className=\"text-sm text-muted-foreground mb-3\">\n                      To get {remaining.fat}g healthy fats:\n                    </p>\n                    <div className=\"grid grid-cols-2 gap-2 text-sm\">\n                      <div>â€¢ Avocado (1/2 medium) = 160 cal, 15g fat</div>\n                      <div>â€¢ Olive oil (1 tbsp) = 119 cal, 14g fat</div>\n                      <div>â€¢ Salmon (100g) = 208 cal, 12g fat</div>\n                      <div>â€¢ Nuts (1 oz) = 164 cal, 14g fat</div>\n                    </div>\n                  </div>\n                )}\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n}","size_bytes":24287},"client/src/components/sound-settings.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Button } from \"@/components/ui/button\";\nimport { Label } from \"@/components/ui/label\";\nimport { Volume2, VolumeX, TestTube2 } from \"lucide-react\";\nimport { soundService } from \"@/lib/sound-service\";\n\nexport function SoundSettings() {\n  const [soundEnabled, setSoundEnabled] = useState(true);\n\n  useEffect(() => {\n    setSoundEnabled(soundService.isEnabled());\n  }, []);\n\n  const handleToggleSound = (enabled: boolean) => {\n    setSoundEnabled(enabled);\n    soundService.setEnabled(enabled);\n    \n    if (enabled) {\n      // Play a welcome sound when enabling\n      soundService.playSuccess();\n    }\n  };\n\n  const testSounds = async () => {\n    await soundService.playClick();\n    setTimeout(() => soundService.playSuccess(), 300);\n    setTimeout(() => soundService.playNotification(), 600);\n  };\n\n  return (\n    <Card className=\"w-full\">\n      <CardHeader>\n        <CardTitle className=\"flex items-center space-x-2\">\n          {soundEnabled ? (\n            <Volume2 className=\"h-5 w-5 text-blue-600\" />\n          ) : (\n            <VolumeX className=\"h-5 w-5 text-gray-400\" />\n          )}\n          <span>Sound Effects</span>\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"space-y-1\">\n            <Label htmlFor=\"sound-toggle\">Enable sound effects</Label>\n            <p className=\"text-sm text-muted-foreground\">\n              Play sounds for notifications, button clicks, and feedback\n            </p>\n          </div>\n          <Switch\n            id=\"sound-toggle\"\n            checked={soundEnabled}\n            onCheckedChange={handleToggleSound}\n            data-testid=\"switch-sound-enabled\"\n          />\n        </div>\n\n        {soundEnabled && (\n          <div className=\"pt-2 border-t\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={testSounds}\n              className=\"flex items-center space-x-2\"\n              data-testid=\"button-test-sounds\"\n            >\n              <TestTube2 className=\"h-4 w-4\" />\n              <span>Test Sounds</span>\n            </Button>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":2406},"client/src/components/weight-form.tsx":{"content":"import { useState, useRef } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { format } from \"date-fns\";\nimport { z } from \"zod\";\nimport { Calendar, Save, Target, Camera, Image as ImageIcon, X } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { buildApiUrl } from '@/lib/api-config';\nimport { insertWeightEntrySchema } from \"@shared/schema\";\n\n// Form schema with unit-aware validation (omit server-side fields)\nconst weightFormSchema = insertWeightEntrySchema.extend({\n  weight: z.number().min(1, \"Weight must be greater than 0\"),\n  unit: z.enum([\"kg\", \"lb\"]).default(\"kg\"),\n}).omit({ \n  weightGrams: true, // Remove weightGrams since we'll calculate it\n  userId: true, // Remove userId since it's added server-side\n}).refine((data) => {\n  // Unit-aware validation\n  if (data.unit === \"kg\") {\n    return data.weight >= 20 && data.weight <= 300;\n  } else { // lb\n    return data.weight >= 44 && data.weight <= 660; // 20-300kg in lb\n  }\n}, {\n  message: \"Weight must be reasonable for the selected unit\",\n  path: [\"weight\"],\n});\n\ntype WeightFormData = z.infer<typeof weightFormSchema>;\n\ninterface WeightFormProps {\n  onSuccess?: () => void;\n  compact?: boolean;\n}\n\nexport function WeightForm({ onSuccess, compact = false }: WeightFormProps) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [unit, setUnit] = useState<\"kg\" | \"lb\">(\"kg\");\n  const [progressPhoto, setProgressPhoto] = useState<File | null>(null);\n  const [progressPhotoPreview, setProgressPhotoPreview] = useState<string | null>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const form = useForm<WeightFormData>({\n    resolver: zodResolver(weightFormSchema),\n    defaultValues: {\n      weight: 0,\n      unit: \"kg\",\n      loggedAt: format(new Date(), \"yyyy-MM-dd\"),\n      notes: \"\",\n    },\n  });\n\n  const handlePhotoSelect = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      setProgressPhoto(file);\n      \n      // Create preview\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        setProgressPhotoPreview(reader.result as string);\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n\n  const handleRemovePhoto = () => {\n    setProgressPhoto(null);\n    setProgressPhotoPreview(null);\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n\n  const createWeightMutation = useMutation({\n    mutationFn: async (data: WeightFormData) => {\n      // Convert weight to grams based on unit\n      const weightInGrams = data.unit === \"kg\" \n        ? Math.round(data.weight * 1000) \n        : Math.round(data.weight * 453.592); // 1 lb = 453.592g\n\n      // Create FormData for file upload\n      const formData = new FormData();\n      formData.append('weightGrams', weightInGrams.toString());\n      formData.append('loggedAt', data.loggedAt.toString());\n      if (data.notes) {\n        formData.append('notes', data.notes);\n      }\n      if (progressPhoto) {\n        formData.append('progressPhoto', progressPhoto);\n      }\n\n      const token = localStorage.getItem('auth_token');\n      const headers: Record<string, string> = {};\n      \n      if (token) {\n        headers['Authorization'] = `Bearer ${token}`;\n      }\n\n      return fetch(buildApiUrl('/api/weights'), {\n        method: 'POST',\n        body: formData,\n        credentials: 'include',\n        headers,\n      }).then(async (res) => {\n        if (!res.ok) {\n          const error = await res.json();\n          throw new Error(error.error || 'Failed to save weight entry');\n        }\n        return res.json();\n      });\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Weight Logged\",\n        description: \"Your weight entry has been saved successfully.\",\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/weights'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges/points'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/challenges/streak'] });\n      \n      // Reset form with proper default values - delay to avoid validation conflicts\n      setTimeout(() => {\n        form.reset({\n          weight: 0,\n          unit: \"kg\", \n          loggedAt: format(new Date(), \"yyyy-MM-dd\"),\n          notes: \"\",\n        });\n        setUnit(\"kg\"); // Sync unit state with form\n        handleRemovePhoto(); // Clear progress photo\n      }, 100);\n      \n      onSuccess?.();\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to save weight entry\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: WeightFormData) => {\n    createWeightMutation.mutate(data);\n  };\n\n  const handleUnitChange = (newUnit: \"kg\" | \"lb\") => {\n    const currentWeight = form.getValues(\"weight\");\n    \n    // Only convert if units are actually different and weight is valid\n    if (currentWeight > 0 && unit !== newUnit) {\n      const convertedWeight = unit === \"kg\" && newUnit === \"lb\"\n        ? currentWeight * 2.20462 // kg to lb\n        : unit === \"lb\" && newUnit === \"kg\"\n        ? currentWeight * 0.453592 // lb to kg\n        : currentWeight; // fallback - no conversion\n      \n      form.setValue(\"weight\", Math.round(convertedWeight * 10) / 10);\n    }\n    \n    // Update unit state\n    setUnit(newUnit);\n    form.setValue(\"unit\", newUnit);\n  };\n\n  return (\n    <div className={compact ? \"space-y-3\" : \"bg-card border rounded-xl p-6\"}>\n      {!compact && (\n        <div className=\"flex items-center space-x-2 mb-4\">\n          <Target className=\"h-5 w-5 text-purple-600\" />\n          <h3 className=\"text-lg font-medium\">Log Today's Weight</h3>\n        </div>\n      )}\n\n      <form onSubmit={form.handleSubmit(onSubmit)} className={compact ? \"space-y-3\" : \"space-y-4\"}>\n        {/* Date Input */}\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"loggedAt\" data-testid=\"label-log-date\">Date</Label>\n          <div className=\"relative\">\n            <Input\n              id=\"loggedAt\"\n              type=\"date\"\n              {...form.register(\"loggedAt\")}\n              className=\"pr-10\"\n              data-testid=\"input-log-date\"\n            />\n            <Calendar className=\"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground pointer-events-none\" />\n          </div>\n          {form.formState.errors.loggedAt && (\n            <p className=\"text-sm text-red-500\" data-testid=\"error-log-date\">\n              {form.formState.errors.loggedAt.message}\n            </p>\n          )}\n        </div>\n\n        {/* Weight Input with Unit Selector */}\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"weight\" data-testid=\"label-weight\">Weight</Label>\n          <div className=\"flex space-x-2\">\n            <Input\n              id=\"weight\"\n              type=\"number\"\n              step=\"0.1\"\n              min=\"0\"\n              placeholder={`Enter weight in ${unit}`}\n              {...form.register(\"weight\", { valueAsNumber: true })}\n              className=\"flex-1\"\n              data-testid=\"input-weight\"\n              onFocus={(e) => {\n                if (e.target.value === \"0\") {\n                  e.target.value = \"\";\n                }\n              }}\n            />\n            <Select value={unit} onValueChange={handleUnitChange}>\n              <SelectTrigger className=\"w-20\" data-testid=\"select-weight-unit\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"kg\">kg</SelectItem>\n                <SelectItem value=\"lb\">lb</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n          {form.formState.errors.weight && (\n            <p className=\"text-sm text-red-500\" data-testid=\"error-weight\">\n              {form.formState.errors.weight.message}\n            </p>\n          )}\n        </div>\n\n        {/* Notes Input */}\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"notes\" data-testid=\"label-notes\">Notes (Optional)</Label>\n          <Textarea\n            id=\"notes\"\n            placeholder=\"Add notes about your weigh-in...\"\n            {...form.register(\"notes\")}\n            rows={3}\n            data-testid=\"input-notes\"\n          />\n          {form.formState.errors.notes && (\n            <p className=\"text-sm text-red-500\" data-testid=\"error-notes\">\n              {form.formState.errors.notes.message}\n            </p>\n          )}\n        </div>\n\n        {/* Progress Photo Upload */}\n        <div className=\"space-y-2\">\n          <Label data-testid=\"label-progress-photo\">Progress Photo (Optional)</Label>\n          <p className=\"text-sm text-muted-foreground mb-2\">\n            Add a photo to track your visual progress\n          </p>\n          \n          {progressPhotoPreview ? (\n            <div className=\"relative inline-block\">\n              <img \n                src={progressPhotoPreview} \n                alt=\"Progress preview\" \n                className=\"w-full max-w-xs h-48 object-cover rounded-lg border-2 border-gray-200 dark:border-gray-700\"\n                data-testid=\"img-progress-preview\"\n              />\n              <button\n                type=\"button\"\n                onClick={handleRemovePhoto}\n                className=\"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 shadow-lg\"\n                data-testid=\"button-remove-photo\"\n              >\n                <X className=\"h-4 w-4\" />\n              </button>\n            </div>\n          ) : (\n            <div className=\"flex gap-2\">\n              <input\n                ref={fileInputRef}\n                type=\"file\"\n                accept=\"image/*\"\n                capture=\"environment\"\n                onChange={handlePhotoSelect}\n                className=\"hidden\"\n                data-testid=\"input-photo-file\"\n              />\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={() => fileInputRef.current?.click()}\n                className=\"flex-1\"\n                data-testid=\"button-take-photo\"\n              >\n                <Camera className=\"h-4 w-4 mr-2\" />\n                Take Photo\n              </Button>\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={() => {\n                  if (fileInputRef.current) {\n                    fileInputRef.current.removeAttribute('capture');\n                    fileInputRef.current.click();\n                  }\n                }}\n                className=\"flex-1\"\n                data-testid=\"button-upload-photo\"\n              >\n                <ImageIcon className=\"h-4 w-4 mr-2\" />\n                Upload Photo\n              </Button>\n            </div>\n          )}\n        </div>\n\n        {/* Submit Button */}\n        <div className=\"sticky bottom-0 left-0 right-0 bg-white dark:bg-gray-900 border-t border-gray-200 dark:border-gray-700 pt-4 mt-6 -mx-6 -mb-6 px-6 pb-6 z-50 shadow-lg\">\n          <Button\n            type=\"submit\"\n            disabled={createWeightMutation.isPending}\n            className=\"w-full bg-gradient-to-r from-purple-600 to-violet-600 hover:from-purple-700 hover:to-violet-700 text-white font-medium py-3 px-4 rounded-lg shadow-md transition-colors\"\n            data-testid=\"button-save-weight\"\n          >\n            {createWeightMutation.isPending ? (\n              <span className=\"text-white\">Saving...</span>\n            ) : (\n              <span className=\"flex items-center justify-center text-white\">\n                <Save className=\"h-4 w-4 mr-2\" />\n                Save Weight Entry\n              </span>\n            )}\n          </Button>\n        </div>\n      </form>\n    </div>\n  );\n}","size_bytes":12308},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"client/src/hooks/useAuth.ts":{"content":"import { useState, useEffect } from \"react\";\n\nexport function useAuth() {\n  const [user, setUser] = useState<{ email: string } | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    // Check for stored auth token and user\n    const token = localStorage.getItem(\"auth_token\");\n    const storedUser = localStorage.getItem(\"auth_user\");\n\n    if (token && storedUser) {\n      try {\n        const userData = JSON.parse(storedUser);\n        setUser(userData);\n      } catch (error) {\n        console.error('Failed to parse user data:', error);\n        localStorage.removeItem(\"auth_token\");\n        localStorage.removeItem(\"auth_user\");\n      }\n    }\n\n    setIsLoading(false);\n  }, []);\n\n  return {\n    user,\n    isLoading,\n    isAuthenticated: !!user,\n    requiresLogin: !user && !isLoading,\n  };\n}","size_bytes":830},"client/src/App.tsx":{"content":"import { Switch, Route, useLocation } from \"wouter\";\nimport { useEffect } from \"react\";\nimport { useAuth } from \"./hooks/useAuth\";\nimport { App as CapacitorApp } from '@capacitor/app';\nimport { Browser } from '@capacitor/browser';\nimport { queryClient } from \"./lib/queryClient\";\nimport { soundService } from \"./lib/sound-service\";\nimport { useSubscription } from \"./contexts/SubscriptionContext\";\n\n// âœ… Pages in your /pages folder\nimport CameraPage from \"./pages/CameraPage\";\nimport CameraTestPage from \"./pages/CameraTestPage\";\nimport VoicePage from \"./pages/VoicePage\";\nimport LandingPage from \"./pages/LandingPage\";\nimport LoginPage from \"./pages/LoginPage\";\nimport RegisterPage from \"./pages/RegisterPage\";\nimport ForgotPasswordPage from \"./pages/ForgotPasswordPage\";\nimport Home from \"./pages/home\";\nimport DiaryPage from \"./pages/DiaryPage\";\nimport DietAdvicePage from \"./pages/DietAdvicePage\";\nimport CalculatorTestPage from \"./pages/CalculatorTestPage\";\nimport { ActivityPage } from \"./pages/ActivityPage\";\nimport RecipesPage from \"./pages/RecipesPage\";\nimport CoachingPage from \"./pages/CoachingPage\";\nimport GoalsPage from \"./pages/GoalsPage\";\nimport RewardsPage from \"./pages/RewardsPage\";\nimport InjectionAdvicePage from \"./pages/InjectionAdvicePage\";\nimport HelpPage from \"./pages/HelpPage\";\nimport { InsightsPage } from \"./pages/InsightsPage\";\nimport { ChallengesPage } from \"./pages/ChallengesPage\";\nimport { MenuAnalysisPage } from \"./pages/MenuAnalysisPage\";\nimport AICoachPage from \"./pages/AICoachPage\";\nimport ProfilePage from \"./pages/ProfilePage\";\nimport { ProgressPhotosPage } from \"./pages/ProgressPhotosPage\";\nimport { CoachPersonalityPage } from \"./pages/CoachPersonalityPage\";\nimport { CoachProfilePage } from \"./pages/CoachProfilePage\";\nimport ShiftPlannerPage from \"./pages/ShiftPlannerPage\";\nimport SubscriptionPage from \"./pages/subscription\";\nimport BlockedAccess from \"./pages/BlockedAccess\";\nimport NotFound from \"./pages/not-found\";\n\n// Scroll to top component - automatically scrolls to top on route change\nfunction ScrollToTop() {\n  const [location] = useLocation();\n  \n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, [location]);\n  \n  return null;\n}\n\n// Root route component that checks authentication\nfunction RootRoute() {\n  const { isAuthenticated, isLoading } = useAuth();\n  \n  // Show loading while checking auth status\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\" style={{background: 'var(--bg-gradient)'}}>\n        <div className=\"text-white text-center\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-white mx-auto mb-4\"></div>\n          <p>Loading...</p>\n        </div>\n      </div>\n    );\n  }\n  \n  // Show appropriate page based on authentication\n  return isAuthenticated ? <Home /> : <LandingPage />;\n}\n\nfunction App() {\n  useEffect(() => {\n    // Initialize sound service\n    soundService.initialize().catch(err => \n      console.error('Sound service initialization failed:', err)\n    );\n    \n    // Set up deep-link handler for mobile OAuth return\n    let listenerHandle: any;\n    \n    // Wrap the whole setup in try-catch to prevent any crashes\n    try {\n      CapacitorApp.addListener('appUrlOpen', async (event) => {\n        try {\n          const url = event.url;\n          \n          // Check if this is an auth-complete callback\n          if (url.startsWith('platemate://auth-complete')) {\n            try {\n              // Parse the URL to get the token\n              const urlObj = new URL(url);\n              const token = urlObj.searchParams.get('token');\n              \n              if (!token) {\n                console.error('No token found in deep-link URL');\n                return;\n              }\n              \n              // Exchange the token for a session cookie (use absolute URL for mobile)\n              const baseUrl = window.location.origin;\n              const consumeUrl = `${baseUrl}/api/session/consume`;\n              \n              const response = await fetch(consumeUrl, {\n                method: 'POST',\n                headers: {\n                  'Content-Type': 'application/json',\n                },\n                credentials: 'include',\n                body: JSON.stringify({ token }),\n              });\n              \n              if (!response.ok) {\n                console.error('Failed to consume session token:', response.statusText);\n                return;\n              }\n              \n              const result = await response.json();\n              \n              // Close the browser window\n              try {\n                await Browser.close();\n              } catch (closeError) {\n                // Browser may already be closed\n              }\n              \n              // Invalidate auth queries to refresh the UI\n              await queryClient.invalidateQueries({ queryKey: ['/api/user'] });\n              \n            } catch (error) {\n              console.error('Error handling auth callback:', error);\n            }\n          }\n        } catch (error) {\n          console.error('Error in deep-link handler:', error);\n        }\n      }).then(handle => {\n        listenerHandle = handle;\n      }).catch(error => {\n        console.error('Error setting up deep-link listener:', error);\n      });\n    } catch (error) {\n      console.error('Error in deep-link setup:', error);\n    }\n    \n    // Clean up listener on unmount\n    return () => {\n      try {\n        if (listenerHandle) {\n          listenerHandle.remove();\n        }\n      } catch (error) {\n        console.error('Error removing deep-link listener:', error);\n      }\n    };\n  }, []);\n\n  return (\n    <>\n      <ScrollToTop />\n      <Switch>\n        {/* Public routes */}\n        <Route path=\"/subscription\" component={SubscriptionPage} />\n        <Route path=\"/landing\" component={LandingPage} />\n        <Route path=\"/login\" component={LoginPage} />\n        <Route path=\"/register\" component={RegisterPage} />\n        <Route path=\"/forgot-password\" component={ForgotPasswordPage} />\n        <Route path=\"/blocked-access\" component={BlockedAccess} />\n        \n        {/* Protected routes - all require active subscription */}\n        <Route path=\"/\" component={RootRoute} />\n        <Route path=\"/scan\" component={CameraPage} />\n        <Route path=\"/home\" component={Home} />\n        <Route path=\"/diary\" component={DiaryPage} />\n        <Route path=\"/calculator-test\" component={CalculatorTestPage} />\n        <Route path=\"/activity\" component={ActivityPage} />\n        <Route path=\"/advice\" component={DietAdvicePage} />\n        <Route path=\"/ai-advice\" component={DietAdvicePage} />\n        <Route path=\"/diet-advice\" component={DietAdvicePage} />\n        <Route path=\"/recipes\" component={RecipesPage} />\n        <Route path=\"/coaching\" component={CoachingPage} />\n        <Route path=\"/ai-coach\" component={AICoachPage} />\n        <Route path=\"/goals\" component={GoalsPage} />\n        <Route path=\"/profile\" component={ProfilePage} />\n        <Route path=\"/rewards\" component={RewardsPage} />\n        <Route path=\"/injection-advice\" component={InjectionAdvicePage} />\n        <Route path=\"/help\" component={HelpPage} />\n        <Route path=\"/insights\" component={InsightsPage} />\n        <Route path=\"/challenges\" component={ChallengesPage} />\n        <Route path=\"/menu-analysis\" component={MenuAnalysisPage} />\n        <Route path=\"/progress-photos\" component={ProgressPhotosPage} />\n        <Route path=\"/coach-personality\" component={CoachPersonalityPage} />\n        <Route path=\"/coach-profile\" component={CoachProfilePage} />\n        <Route path=\"/shift-planner\" component={ShiftPlannerPage} />\n        <Route path=\"/camera\" component={CameraTestPage} />\n        <Route path=\"/food-camera\" component={CameraPage} />\n        <Route path=\"/voice\" component={VoicePage} />\n        <Route component={NotFound} />\n      </Switch>\n    </>\n  );\n}\n\nexport default App;","size_bytes":7952},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"android/app/src/main/assets/public/assets/web-B1Qu9IHK.js":{"content":"import{W as w}from\"./index-BQFIQdpH.js\";class y extends w{async getId(){return{identifier:this.getUid()}}async getInfo(){if(typeof navigator>\"u\"||!navigator.userAgent)throw this.unavailable(\"Device API not available in this browser\");const e=navigator.userAgent,i=this.parseUa(e);return{model:i.model,platform:\"web\",operatingSystem:i.operatingSystem,osVersion:i.osVersion,manufacturer:navigator.vendor,isVirtual:!1,webViewVersion:i.browserVersion}}async getBatteryInfo(){if(typeof navigator>\"u\"||!navigator.getBattery)throw this.unavailable(\"Device API not available in this browser\");let e={};try{e=await navigator.getBattery()}catch{}return{batteryLevel:e.level,isCharging:e.charging}}async getLanguageCode(){return{value:navigator.language.split(\"-\")[0].toLowerCase()}}async getLanguageTag(){return{value:navigator.language}}parseUa(e){const i={},r=e.indexOf(\"(\")+1;let a=e.indexOf(\") AppleWebKit\");e.indexOf(\") Gecko\")!==-1&&(a=e.indexOf(\") Gecko\"));const s=e.substring(r,a);if(e.indexOf(\"Android\")!==-1){const t=s.replace(\"; wv\",\"\").split(\"; \").pop();t&&(i.model=t.split(\" Build\")[0]),i.osVersion=s.split(\"; \")[1]}else if(i.model=s.split(\"; \")[0],typeof navigator<\"u\"&&navigator.oscpu)i.osVersion=navigator.oscpu;else if(e.indexOf(\"Windows\")!==-1)i.osVersion=s;else{const t=s.split(\"; \").pop();if(t){const n=t.replace(\" like Mac OS X\",\"\").split(\" \");i.osVersion=n[n.length-1].replace(/_/g,\".\")}}/android/i.test(e)?i.operatingSystem=\"android\":/iPad|iPhone|iPod/.test(e)&&!window.MSStream?i.operatingSystem=\"ios\":/Win/.test(e)?i.operatingSystem=\"windows\":/Mac/i.test(e)?i.operatingSystem=\"mac\":i.operatingSystem=\"unknown\";const l=!!window.ApplePaySession,x=!!window.chrome,p=/Firefox/.test(e),d=/Edg/.test(e),g=/FxiOS/.test(e),c=/CriOS/.test(e),f=/EdgiOS/.test(e);if(l||x&&!d||g||c||f){let t;g?t=\"FxiOS\":c?t=\"CriOS\":f?t=\"EdgiOS\":l?t=\"Version\":t=\"Chrome\";const n=e.split(\" \");for(const o of n)if(o.includes(t)){const v=o.split(\"/\")[1];i.browserVersion=v}}else if(p||d){const o=e.split(\"\").reverse().join(\"\").split(\"/\")[0].split(\"\").reverse().join(\"\");i.browserVersion=o}return i}getUid(){if(typeof window<\"u\"&&window.localStorage){let e=window.localStorage.getItem(\"_capuid\");return e||(e=this.uuid4(),window.localStorage.setItem(\"_capuid\",e),e)}return this.uuid4()}uuid4(){return\"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g,function(e){const i=Math.random()*16|0;return(e===\"x\"?i:i&3|8).toString(16)})}}export{y as DeviceWeb};\n","size_bytes":2440},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border-2 border-gray-300 bg-gray-900 dark:bg-gray-100 text-white dark:text-gray-900 px-3 py-1.5 text-sm font-medium shadow-2xl backdrop-blur-sm animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1281},"client/src/components/speech-indicator.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Mic, MicOff, Volume2, Brain, CheckCircle } from 'lucide-react';\n\ninterface SpeechIndicatorState {\n  isListening: boolean;\n  lastCommand?: string;\n  confidence?: number;\n  showCommand?: boolean;\n}\n\nexport function SpeechIndicator() {\n  const [state, setState] = useState<SpeechIndicatorState>({\n    isListening: false\n  });\n\n  useEffect(() => {\n    // Global function to update speech listening state\n    (window as any).setSpeechListening = (isListening: boolean) => {\n      setState(prev => ({ ...prev, isListening }));\n    };\n\n    // Global function to show recognized command\n    (window as any).showSpeechCommand = (command: string, confidence: number) => {\n      setState(prev => ({\n        ...prev,\n        lastCommand: command,\n        confidence,\n        showCommand: true\n      }));\n\n      // Hide command after 3 seconds\n      setTimeout(() => {\n        setState(prev => ({ ...prev, showCommand: false }));\n      }, 3000);\n    };\n\n    return () => {\n      delete (window as any).setSpeechListening;\n      delete (window as any).showSpeechCommand;\n    };\n  }, []);\n\n  return (\n    <>\n      {/* Listening Indicator */}\n      <AnimatePresence>\n        {state.isListening && (\n          <motion.div\n            initial={{ scale: 0, opacity: 0 }}\n            animate={{ scale: 1, opacity: 1 }}\n            exit={{ scale: 0, opacity: 0 }}\n            className=\"fixed top-20 right-4 z-50\"\n          >\n            <div className=\"bg-red-500 text-white p-3 rounded-full shadow-lg backdrop-blur-sm\">\n              <motion.div\n                animate={{ scale: [1, 1.2, 1] }}\n                transition={{ duration: 1, repeat: Infinity }}\n              >\n                <Mic className=\"h-6 w-6\" />\n              </motion.div>\n            </div>\n            \n            {/* Listening text */}\n            <div className=\"absolute top-full right-0 mt-2 bg-black/80 text-white text-sm px-3 py-1 rounded-lg whitespace-nowrap\">\n              ðŸŽ¤ Listening...\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* Command Recognition Feedback */}\n      <AnimatePresence>\n        {state.showCommand && state.lastCommand && (\n          <motion.div\n            initial={{ y: -50, opacity: 0 }}\n            animate={{ y: 0, opacity: 1 }}\n            exit={{ y: -50, opacity: 0 }}\n            className=\"fixed top-20 left-1/2 -translate-x-1/2 z-50\"\n          >\n            <div className=\"bg-green-500 text-white p-4 rounded-xl shadow-lg backdrop-blur-sm max-w-sm\">\n              <div className=\"flex items-center space-x-3\">\n                <CheckCircle className=\"h-6 w-6 flex-shrink-0\" />\n                <div>\n                  <div className=\"font-medium text-sm\">Command Recognized</div>\n                  <div className=\"text-xs opacity-90 capitalize\">\n                    {state.lastCommand.replace(/-/g, ' ')}\n                  </div>\n                  <div className=\"text-xs opacity-75 mt-1\">\n                    Confidence: {Math.round((state.confidence || 0) * 100)}%\n                  </div>\n                </div>\n              </div>\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* Permanent Speech Control Button */}\n      <div className=\"fixed bottom-24 right-4 z-40\">\n        <SpeechControlButton />\n      </div>\n    </>\n  );\n}\n\nfunction SpeechControlButton() {\n  const [isListening, setIsListening] = useState(false);\n  const [isEnabled, setIsEnabled] = useState(false);\n\n  useEffect(() => {\n    // Import speech service dynamically to avoid SSR issues\n    import('@/lib/speech-service').then(({ speechService }) => {\n      setIsEnabled(speechService.isSupported());\n      \n      // Update listening state when speech service changes\n      const updateState = () => {\n        setIsListening(speechService.isCurrentlyListening());\n      };\n      \n      // Check state periodically\n      const interval = setInterval(updateState, 500);\n      \n      // Update immediately\n      updateState();\n      \n      return () => clearInterval(interval);\n    });\n  }, []);\n\n  const toggleSpeechListening = async () => {\n    const { speechService } = await import('@/lib/speech-service');\n    \n    if (isListening) {\n      speechService.stopListening();\n      setIsListening(false);\n    } else {\n      // Start listening without continuous mode (single command)\n      const started = await speechService.startListening(false);\n      if (started) {\n        setIsListening(true);\n      }\n    }\n  };\n\n  if (!isEnabled) {\n    return null; // Don't show button if speech is not supported\n  }\n\n  return (\n    <motion.button\n      initial={{ scale: 0 }}\n      animate={{ scale: 1 }}\n      whileHover={{ scale: 1.1 }}\n      whileTap={{ scale: 0.9 }}\n      onClick={toggleSpeechListening}\n      className={`p-4 rounded-full shadow-lg backdrop-blur-sm border transition-all duration-300 ${\n        isListening\n          ? 'bg-red-500 text-white border-red-400 animate-pulse'\n          : 'bg-white/90 dark:bg-gray-800/90 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600 hover:bg-blue-50 dark:hover:bg-blue-900/20'\n      }`}\n      title={isListening ? 'Stop voice control' : 'Start voice control'}\n      data-testid=\"button-speech-control\"\n    >\n      <motion.div\n        animate={isListening ? { scale: [1, 1.2, 1] } : { scale: [1, 1.2, 1] }}\n        transition={{ duration: 0.8, repeat: Infinity, repeatType: \"reverse\" }}\n      >\n        {isListening ? (\n          <MicOff className=\"h-6 w-6\" />\n        ) : (\n          <Mic className=\"h-6 w-6\" />\n        )}\n      </motion.div>\n    </motion.button>\n  );\n}","size_bytes":5703},"client/src/lib/camera-service.ts":{"content":"// client/src/lib/camera-service.ts\nexport async function startCamera(videoElement: HTMLVideoElement) {\n  try {\n    const stream = await navigator.mediaDevices.getUserMedia({ video: true });\n    videoElement.srcObject = stream;\n    await videoElement.play();\n  } catch (err) {\n    console.error(\"Camera error:\", err);\n    alert(\"Unable to access camera. Please allow camera permissions.\");\n  }\n}\n\nexport function stopCamera(videoElement: HTMLVideoElement) {\n  const stream = videoElement.srcObject as MediaStream | null;\n  if (stream) {\n    stream.getTracks().forEach(track => track.stop());\n  }\n  videoElement.srcObject = null;\n}","size_bytes":630},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"server/ai-providers/ai-manager.ts":{"content":"import { AIProvider, FoodAnalysisResult, FoodDetectionResult, DietAdviceResult, DiaryEntry, ProviderError, ProviderStatus, DailyCoaching, EducationalTip } from \"./types\";\nimport { OpenAIProvider } from \"./openai-provider\";\nimport { GeminiProvider } from \"./gemini-provider\";\nimport { HuggingFaceProvider } from \"./huggingface-provider\";\nimport { usdaService } from \"../services/usda-service\";\nimport { openFoodFactsService } from \"../services/openfoodfacts-service\";\nimport { imageAnalysisCache } from \"../services/image-analysis-cache\";\n\nexport class AIManager {\n  private providers: AIProvider[] = [];\n  private fallbackData: {\n    foodAnalysis: FoodAnalysisResult;\n    dietAdvice: DietAdviceResult;\n    dailyCoaching: DailyCoaching;\n    educationalTips: EducationalTip[];\n  };\n\n  constructor() {\n    // Initialize providers in priority order (Gemini first, HuggingFace second, OpenAI fallback)\n    this.providers = [\n      new GeminiProvider(),\n      new HuggingFaceProvider(),\n      new OpenAIProvider()\n    ].sort((a, b) => a.priority - b.priority);\n\n    // Define fallback data for when all providers fail\n    this.fallbackData = {\n      foodAnalysis: {\n        imageUrl: '',\n        confidence: 50,\n        totalCalories: 250,\n        totalProtein: 12,\n        totalCarbs: 25,\n        totalFat: 10,\n        detectedFoods: [\n          {\n            name: \"Mixed Meal\",\n            portion: \"1 serving\",\n            calories: 250,\n            protein: 12,\n            carbs: 25,\n            fat: 10,\n            icon: \"apple-alt\"\n          }\n        ]\n      },\n      dietAdvice: {\n        personalizedAdvice: [\n          \"Keep tracking your meals to understand your eating patterns better.\",\n          \"Focus on maintaining consistent meal timing throughout the day.\"\n        ],\n        nutritionGoals: [\n          \"Aim for balanced meals with protein, healthy fats, and complex carbs.\",\n          \"Include 5-7 servings of fruits and vegetables daily.\"\n        ],\n        improvements: [\n          \"Consider adding more variety to your food choices.\",\n          \"Stay hydrated by drinking water throughout the day.\"\n        ],\n        generalTips: [\n          \"Plan your meals ahead to make healthier choices.\",\n          \"Listen to your body's hunger and fullness cues.\"\n        ],\n        mealIdeas: [\n          {\n            mealType: \"breakfast\" as const,\n            name: \"Protein-Packed Overnight Oats\",\n            description: \"Creamy oats with Greek yogurt, berries, and nuts for sustained energy\",\n            calories: 350,\n            protein: 18,\n            carbs: 42,\n            fat: 12,\n            ingredients: [\"rolled oats\", \"Greek yogurt\", \"mixed berries\", \"almonds\", \"chia seeds\"],\n            benefits: \"High in protein and fiber to keep you full and energized throughout the morning\",\n            recipeLink: \"https://www.allrecipes.com/recipe/276934/overnight-oats/\",\n            cookingInstructions: [\n              \"Mix 1/2 cup rolled oats with 1/2 cup Greek yogurt in a jar\",\n              \"Add 1 tbsp chia seeds and 1/4 cup milk, stir well\",\n              \"Refrigerate overnight or at least 4 hours\",\n              \"Top with berries and chopped almonds before serving\"\n            ]\n          },\n          {\n            mealType: \"lunch\" as const,\n            name: \"Mediterranean Quinoa Bowl\",\n            description: \"Nutritious bowl with quinoa, vegetables, and lean protein\",\n            calories: 420,\n            protein: 25,\n            carbs: 48,\n            fat: 15,\n            ingredients: [\"quinoa\", \"grilled chicken\", \"cucumber\", \"tomatoes\", \"feta cheese\", \"olive oil\"],\n            benefits: \"Balanced nutrients with healthy fats and complete proteins for sustained energy\",\n            recipeLink: \"https://www.bbcgoodfood.com/recipes/mediterranean-quinoa-salad\",\n            cookingInstructions: [\n              \"Cook 1/2 cup quinoa according to package directions and let cool\",\n              \"Grill 4oz chicken breast and slice into strips\",\n              \"Dice cucumber and tomatoes, crumble feta cheese\",\n              \"Combine all ingredients and drizzle with olive oil and lemon\"\n            ]\n          },\n          {\n            mealType: \"dinner\" as const,\n            name: \"Baked Salmon with Sweet Potato\",\n            description: \"Omega-3 rich salmon with roasted vegetables and complex carbs\",\n            calories: 480,\n            protein: 35,\n            carbs: 32,\n            fat: 22,\n            ingredients: [\"salmon fillet\", \"sweet potato\", \"broccoli\", \"olive oil\", \"herbs\"],\n            benefits: \"Rich in omega-3s and antioxidants to support heart health and recovery\",\n            recipeLink: \"https://www.foodnetwork.com/recipes/baked-salmon-with-sweet-potato\",\n            cookingInstructions: [\n              \"Preheat oven to 400Â°F and line baking sheet with parchment\",\n              \"Cut sweet potato into cubes and toss with olive oil, roast 20 minutes\",\n              \"Season salmon with herbs and bake alongside vegetables for 12-15 minutes\",\n              \"Steam broccoli for 4-5 minutes and serve everything together\"\n            ]\n          },\n          {\n            mealType: \"snack\" as const,\n            name: \"Apple with Almond Butter\",\n            description: \"Simple, satisfying snack with natural sweetness and healthy fats\",\n            calories: 200,\n            protein: 8,\n            carbs: 20,\n            fat: 12,\n            ingredients: [\"apple\", \"almond butter\"],\n            benefits: \"Combines fiber and healthy fats for stable blood sugar and lasting satiety\",\n            recipeLink: \"https://www.eatingwell.com/recipe/276009/apple-with-almond-butter/\",\n            cookingInstructions: [\n              \"Wash and core a medium apple, slice into 8 wedges\",\n              \"Measure 2 tablespoons natural almond butter\",\n              \"Arrange apple slices on plate with almond butter for dipping\",\n              \"Sprinkle with cinnamon for extra flavor (optional)\"\n            ]\n          }\n        ]\n      },\n      dailyCoaching: {\n        motivation: \"You're on a great journey toward better health! Every food choice you track helps you understand your body better.\",\n        nutritionTip: \"Try to include protein, healthy fats, and fiber in every meal to keep you satisfied longer.\",\n        encouragement: \"Remember, progress isn't always perfect, but consistency is key. You're doing great!\",\n        todaysFocus: \"Focus on staying hydrated and eating mindfully today.\",\n        streak: 0,\n        medicationTip: \"If you're using GLP-1 medications, eat slowly and stop when you feel satisfied.\"\n      },\n      educationalTips: [\n        {\n          id: \"tip-1\",\n          title: \"Protein Power\",\n          content: \"Including protein in every meal helps maintain stable blood sugar levels and keeps you feeling full longer. Aim for 20-30 grams per meal.\",\n          category: \"nutrition\",\n          importance: \"high\"\n        },\n        {\n          id: \"tip-2\", \n          title: \"Meal Timing with GLP-1\",\n          content: \"Take your GLP-1 medication at the same time each day and eat slowly during meals to help your body recognize fullness signals.\",\n          category: \"medication\",\n          importance: \"high\"\n        },\n        {\n          id: \"tip-3\",\n          title: \"Building Healthy Habits\",\n          content: \"Start small with one healthy change at a time. Consistency beats perfection when building lasting habits.\",\n          category: \"motivation\",\n          importance: \"medium\"\n        }\n      ]\n    };\n  }\n\n  /**\n   * Enhanced food analysis workflow with caching: Check cache first, then AI detection with portions + USDA nutrition lookup\n   */\n  async analyzeFoodImage(imagePath: string): Promise<FoodAnalysisResult> {\n    const startTime = Date.now();\n    \n    try {\n      // Step 1: Check cache first to avoid duplicate analysis\n      const cachedResult = await imageAnalysisCache.get(imagePath);\n      \n      if (cachedResult) {\n        return cachedResult;\n      }\n      \n      const analysisStartTime = Date.now();\n      \n      // Step 2: Get full AI analysis with portions using legacy providers  \n      const fullAnalysis = await this.legacyAnalyzeFoodImage(imagePath);\n      \n      // Step 3: Extract food names for USDA lookup\n      const foodNames = fullAnalysis.detectedFoods.map(food => food.name);\n      \n      // Step 4: Get accurate nutrition from USDA for detected foods\n      const nutritionData = await this.getNutritionFromUSDA(foodNames);\n      \n      // Step 5: Combine AI portions with USDA nutrition data\n      const finalResult = await this.combineAIPortionsWithUSDANutrition(imagePath, fullAnalysis, nutritionData);\n      \n      // Step 6: Store result in cache for future use\n      try {\n        await imageAnalysisCache.set(imagePath, finalResult);\n      } catch (cacheError: any) {\n        console.warn('Failed to store result in cache (non-critical):', cacheError.message);\n        // Don't fail the analysis if cache storage fails\n      }\n      \n      return finalResult;\n      \n    } catch (error: any) {\n      console.warn('Enhanced analysis failed, falling back to simple legacy method:', error.message);\n      \n      // Try cache for legacy method as well\n      try {\n        const cachedLegacyResult = await imageAnalysisCache.get(imagePath);\n        if (cachedLegacyResult) {\n          return cachedLegacyResult;\n        }\n      } catch (legacyCacheError) {\n        console.warn('Cache check failed for legacy fallback:', legacyCacheError);\n      }\n      \n      // Run legacy analysis and cache the result\n      const legacyResult = await this.legacyAnalyzeFoodImage(imagePath);\n      \n      // Try to cache legacy result too\n      try {\n        await imageAnalysisCache.set(imagePath, legacyResult);\n      } catch (legacyCacheError) {\n        console.warn('Failed to cache legacy result:', legacyCacheError);\n      }\n      \n      return legacyResult;\n    }\n  }\n\n  /**\n   * Extract text from an image using AI vision (for menu scanning)\n   */\n  async extractTextFromImage(imagePath: string, prompt: string): Promise<string> {\n    const availableProviders = this.getAvailableProviders();\n    \n    // Try each available provider\n    for (const provider of availableProviders) {\n      for (let attempt = 1; attempt <= provider.maxRetries; attempt++) {\n        try {\n          // Use provider-specific vision APIs for text extraction\n          if (provider.name === 'openai' && (provider as any).client) {\n            const response = await (provider as any).client.chat.completions.create({\n              model: 'gpt-4o',\n              messages: [\n                {\n                  role: 'user',\n                  content: [\n                    { type: 'text', text: prompt },\n                    { type: 'image_url', image_url: { url: imagePath } }\n                  ]\n                }\n              ],\n              max_tokens: 2000\n            });\n            \n            const extractedText = response.choices[0]?.message?.content || '';\n            if (extractedText) {\n              return extractedText;\n            }\n          }\n          \n          // Fallback for Gemini provider\n          if (provider.name === 'gemini' && (provider as any).model) {\n            const response = await (provider as any).model.generateContent([\n              prompt,\n              {\n                inlineData: {\n                  data: imagePath.split(',')[1], // Extract base64 data from data URI\n                  mimeType: imagePath.match(/data:([^;]+);/)?.[1] || 'image/jpeg'\n                }\n              }\n            ]);\n            \n            const extractedText = response.response.text();\n            if (extractedText) {\n              return extractedText;\n            }\n          }\n          \n        } catch (error: any) {\n          console.error(`Text extraction error with ${provider.name}:`, error.message);\n          \n          // If it's a rate limit error, move to next provider immediately\n          if (error.isRateLimit) {\n            console.log(`Rate limit hit on ${provider.name}, trying next provider`);\n            break;\n          }\n          \n          // If it's the last attempt with this provider, continue to next provider\n          if (attempt === provider.maxRetries) {\n            console.log(`Max retries reached for ${provider.name}, trying next provider`);\n            break;\n          }\n          \n          // Wait before retry (exponential backoff)\n          const waitTime = Math.min(1000 * Math.pow(2, attempt - 1), 5000);\n          console.log(`Retrying ${provider.name} in ${waitTime}ms...`);\n          await this.sleep(waitTime);\n        }\n      }\n    }\n\n    // All providers failed\n    throw new Error('All AI providers failed to extract text from image');\n  }\n\n  /**\n   * Detect food names from image using AI providers\n   */\n  async detectFoodNamesFromImage(imagePath: string): Promise<FoodDetectionResult> {\n    const availableProviders = this.getAvailableProviders();\n    \n    // Try each available provider\n    for (const provider of availableProviders) {\n      for (let attempt = 1; attempt <= provider.maxRetries; attempt++) {\n        try {\n          const result = await provider.detectFoodNames(imagePath);\n          return result;\n          \n        } catch (error: any) {\n          // If it's a rate limit error, move to next provider immediately\n          if (error.isRateLimit) {\n            break;\n          }\n          \n          // If it's the last attempt with this provider, continue to next provider\n          if (attempt === provider.maxRetries) {\n            break;\n          }\n          \n          // Wait before retry (exponential backoff)\n          const waitTime = Math.min(1000 * Math.pow(2, attempt - 1), 5000);\n          await this.sleep(waitTime);\n        }\n      }\n    }\n\n    // All providers failed, return fallback\n    console.warn('All AI providers failed for food detection, using fallback');\n    return {\n      confidence: 0,\n      detectedFoodNames: ['Mixed Food'], // Generic fallback\n      referenceObjects: []\n    };\n  }\n\n  /**\n   * Get nutrition data from USDA for detected food names\n   */\n  async getNutritionFromUSDA(foodNames: string[]): Promise<Map<string, any>> {\n    try {\n      const nutritionMap = await usdaService.findMultipleMatches(foodNames);\n      return nutritionMap;\n      \n    } catch (error: any) {\n      console.warn('USDA nutrition lookup failed:', error.message);\n      return new Map(); // Return empty map on failure\n    }\n  }\n\n  /**\n   * Try OpenFoodFacts as fallback when USDA doesn't have data\n   */\n  async tryOpenFoodFactsFallback(foodName: string): Promise<{ name: string; nutrition: any } | null> {\n    try {\n      const results = await openFoodFactsService.getNutritionData([foodName]);\n      \n      if (results && results.length > 0 && results[0].nutrition_per_100g !== \"not found\") {\n        const nutrition = results[0].nutrition_per_100g as any;\n        \n        return {\n          name: foodName,\n          nutrition: {\n            calories: nutrition.calories || 0,\n            protein: nutrition.protein || 0,\n            carbs: nutrition.carbs || 0,\n            fat: nutrition.fat || 0\n          }\n        };\n      }\n      \n      return null;\n      \n    } catch (error: any) {\n      console.warn(`OpenFoodFacts fallback failed for ${foodName}:`, error.message);\n      return null;\n    }\n  }\n\n  /**\n   * Combine AI detection results with USDA nutrition data\n   */\n  async combineDetectionWithNutrition(\n    imagePath: string, \n    detection: FoodDetectionResult, \n    nutritionMap: Map<string, any>\n  ): Promise<FoodAnalysisResult> {\n    const detectedFoods = [];\n    let totalCalories = 0;\n    let totalProtein = 0;\n    let totalCarbs = 0;\n    let totalFat = 0;\n\n    // Process each detected food\n    for (const foodName of detection.detectedFoodNames) {\n      const usdaData = nutritionMap.get(foodName);\n      \n      if (usdaData) {\n        // Use accurate USDA nutrition data\n        const food = {\n          name: usdaData.usdaFood.description,\n          portion: '100g', // Default portion - could be enhanced with AI portion estimation\n          calories: usdaData.nutrition.calories,\n          protein: Math.round(usdaData.nutrition.protein),\n          carbs: Math.round(usdaData.nutrition.carbs),\n          fat: Math.round(usdaData.nutrition.fat),\n          icon: this.getFoodIcon(foodName)\n        };\n        \n        detectedFoods.push(food);\n        totalCalories += food.calories;\n        totalProtein += food.protein;\n        totalCarbs += food.carbs;\n        totalFat += food.fat;\n        \n      } else {\n        // Try OpenFoodFacts as fallback\n        const offData = await this.tryOpenFoodFactsFallback(foodName);\n        \n        if (offData) {\n          const food = {\n            name: offData.name,\n            portion: '100g',\n            calories: offData.nutrition.calories,\n            protein: Math.round(offData.nutrition.protein),\n            carbs: Math.round(offData.nutrition.carbs),\n            fat: Math.round(offData.nutrition.fat),\n            icon: this.getFoodIcon(foodName)\n          };\n          \n          detectedFoods.push(food);\n          totalCalories += food.calories;\n          totalProtein += food.protein;\n          totalCarbs += food.carbs;\n          totalFat += food.fat;\n          \n        } else {\n          // Final hardcoded fallback\n          const fallbackFood = {\n            name: foodName,\n            portion: '1 serving',\n            calories: 150, // Conservative estimate\n            protein: 8,\n            carbs: 15,\n            fat: 6,\n            icon: this.getFoodIcon(foodName)\n          };\n          \n          detectedFoods.push(fallbackFood);\n          totalCalories += fallbackFood.calories;\n          totalProtein += fallbackFood.protein;\n          totalCarbs += fallbackFood.carbs;\n          totalFat += fallbackFood.fat;\n          \n\n        }\n      }\n    }\n\n    return {\n      imageUrl: imagePath,\n      confidence: detection.confidence,\n      totalCalories,\n      totalProtein,\n      totalCarbs,\n      totalFat,\n      detectedFoods\n    };\n  }\n\n  /**\n   * Combine AI portions with USDA nutrition data for accurate analysis\n   */\n  async combineAIPortionsWithUSDANutrition(\n    imagePath: string,\n    aiAnalysis: FoodAnalysisResult,\n    nutritionMap: Map<string, any>\n  ): Promise<FoodAnalysisResult> {\n    const detectedFoods = [];\n    let totalCalories = 0;\n    let totalProtein = 0;\n    let totalCarbs = 0;\n    let totalFat = 0;\n\n    // Process each AI-detected food with portion estimates\n    for (const aiFood of aiAnalysis.detectedFoods) {\n      // Try to match with USDA nutrition data\n      const usdaData = nutritionMap.get(aiFood.name);\n      \n      if (usdaData) {\n        // Convert AI portion to grams for scaling\n        const portionGrams = this.convertPortionToGrams(aiFood.portion, aiFood.name);\n        const scaleFactor = portionGrams / 100; // USDA data is per 100g\n        \n        \n        // Scale USDA nutrition to AI-estimated portion\n        const food = {\n          name: usdaData.usdaFood.description,\n          portion: aiFood.portion, // Keep original AI portion estimate\n          calories: Math.round(usdaData.nutrition.calories * scaleFactor),\n          protein: Math.round(usdaData.nutrition.protein * scaleFactor),\n          carbs: Math.round(usdaData.nutrition.carbs * scaleFactor),\n          fat: Math.round(usdaData.nutrition.fat * scaleFactor),\n          icon: aiFood.icon || this.getFoodIcon(aiFood.name)\n        };\n        \n        detectedFoods.push(food);\n        totalCalories += food.calories;\n        totalProtein += food.protein;\n        totalCarbs += food.carbs;\n        totalFat += food.fat;\n        \n      } else {\n        // Try OpenFoodFacts as fallback\n        const offData = await this.tryOpenFoodFactsFallback(aiFood.name);\n        \n        if (offData) {\n          // Convert AI portion to grams for scaling\n          const portionGrams = this.convertPortionToGrams(aiFood.portion, aiFood.name);\n          const scaleFactor = portionGrams / 100; // OpenFoodFacts data is per 100g\n          \n          const food = {\n            name: offData.name,\n            portion: aiFood.portion,\n            calories: Math.round(offData.nutrition.calories * scaleFactor),\n            protein: Math.round(offData.nutrition.protein * scaleFactor),\n            carbs: Math.round(offData.nutrition.carbs * scaleFactor),\n            fat: Math.round(offData.nutrition.fat * scaleFactor),\n            icon: aiFood.icon || this.getFoodIcon(aiFood.name)\n          };\n          \n          detectedFoods.push(food);\n          totalCalories += food.calories;\n          totalProtein += food.protein;\n          totalCarbs += food.carbs;\n          totalFat += food.fat;\n          \n        } else {\n          // Final fallback: Use AI nutrition data if no USDA or OpenFoodFacts match found\n          detectedFoods.push(aiFood);\n          totalCalories += aiFood.calories;\n          totalProtein += aiFood.protein;\n          totalCarbs += aiFood.carbs;\n          totalFat += aiFood.fat;\n          \n        }\n      }\n    }\n\n    return {\n      imageUrl: imagePath,\n      confidence: aiAnalysis.confidence,\n      totalCalories,\n      totalProtein,\n      totalCarbs,\n      totalFat,\n      detectedFoods\n    };\n  }\n\n  /**\n   * Format portion text to be more user-friendly and informative\n   * Examples: \"Jacket potato\" â†’ \"1 medium (200g)\", \"2 jacket potatoes\" â†’ \"2 medium (400g)\"\n   * Explicit weights: \"200g potato\" â†’ \"200g\" (honors explicit weight)\n   */\n  private formatPortionText(portion: string, foodName: string, portionGrams: number): string {\n    const portionLower = portion.toLowerCase().trim();\n    const foodLower = foodName.toLowerCase();\n    \n    // CRITICAL: If portion already contains explicit weight units, honor them and return as-is\n    if (/\\d+\\s*(g|kg|oz|ml)\\b/.test(portionLower)) {\n      return portion; // Honor explicit weights like \"200g potato\"\n    }\n    \n    // CRITICAL: If portion has volume/serving units, honor them (don't convert cups to potato sizes)\n    if (/\\b(cup|serving|tbsp|tsp|piece)\\b/i.test(portionLower)) {\n      if (!portionLower.includes('g') && !portionLower.includes('gram')) {\n        return `${portion} (${portionGrams}g)`;\n      }\n      return portion;\n    }\n    \n    // For WHOLE potatoes only (jacket potato, baked potato, or plain \"potato\")\n    // NOT processed potato dishes (mashed, salad, etc.)\n    const isWholePotato = portionLower.includes('potato') && \n                          !foodLower.includes('chip') && \n                          !foodLower.includes('fries') && \n                          !foodLower.includes('sweet') &&\n                          !foodLower.includes('mashed') &&\n                          !foodLower.includes('salad') &&\n                          !foodLower.includes('soup');\n    \n    if (isWholePotato) {\n      \n      // Extract count from the portion text\n      const numMatch = portionLower.match(/(\\d+(?:\\.\\d+)?)/);\n      const num = numMatch ? parseFloat(numMatch[1]) : 1;\n      \n      // If size is already specified, keep it\n      if (portionLower.includes('small') || portionLower.includes('medium') || portionLower.includes('large')) {\n        return `${portion} (${portionGrams}g)`;\n      }\n      \n      // Otherwise, add the size based on grams PER potato\n      const gramsPerPotato = num > 1 ? portionGrams / num : portionGrams;\n      let size = 'medium';\n      if (gramsPerPotato < 175) size = 'small';\n      else if (gramsPerPotato > 250) size = 'large';\n      \n      // Format with count\n      const countText = num > 1 ? `${num}` : '1';\n      return `${countText} ${size} (${portionGrams}g)`;\n    }\n    \n    // For other foods, just add grams if not already present\n    if (!portionLower.includes('g') && !portionLower.includes('gram')) {\n      return `${portion} (${portionGrams}g)`;\n    }\n    \n    return portion;\n  }\n\n  /**\n   * Enhanced portion normalization: Convert all portion descriptions to grams\n   * This ensures consistent 100g baseline scaling for all nutrition data\n   */\n  private convertPortionToGrams(portion: string, foodName?: string): number {\n    const portionLower = portion.toLowerCase().trim();\n    const foodLower = foodName?.toLowerCase() || '';\n    \n    // STEP 0: Check for count-based foods FIRST (before weight measurements)\n    // Extract count numbers for contextual conversions\n    const numMatch = portionLower.match(/(\\d+(?:\\.\\d+)?)/);\n    const num = numMatch ? parseFloat(numMatch[1]) : 1;\n    \n    // Specific egg handling (highest priority)\n    // Use word boundaries to avoid false matches with \"eggplant\", \"veggie\", etc.\n    const eggPattern = /\\beggs?\\b/i;\n    const isEgg = eggPattern.test(foodLower) || eggPattern.test(portionLower);\n    if (isEgg) {\n      if (portionLower.includes('large')) return num * 50; // Large egg â‰ˆ 50g\n      if (portionLower.includes('medium')) return num * 44; // Medium egg â‰ˆ 44g  \n      if (portionLower.includes('small')) return num * 38; // Small egg â‰ˆ 38g\n      // Default egg size if no size specified\n      return num * 50; // Default to large egg â‰ˆ 50g\n    }\n    \n    // STEP 1: Handle explicit weight/volume measurements FIRST (before special food handling)\n    const kgMatch = portionLower.match(/(\\d+(?:\\.\\d+)?)\\s*kg(?:\\s|$)/);\n    if (kgMatch) {\n      const result = parseFloat(kgMatch[1]) * 1000;\n\n      return result;\n    }\n    \n    // Match grams - allow \"100g chicken\", \"100 g chicken\", and \"(225g)\"\n    const gramsMatch = portionLower.match(/(\\d+(?:\\.\\d+)?)\\s*(?:grams?|g)(?:\\s|$|\\))/);\n    if (gramsMatch) {\n      const result = parseFloat(gramsMatch[1]);\n\n      return result;\n    }\n    \n    const ozMatch = portionLower.match(/(\\d+(?:\\.\\d+)?)\\s*oz(?:\\s|$)/);\n    if (ozMatch) {\n      const result = parseFloat(ozMatch[1]) * 28.35; // 1 oz = 28.35g\n      return result;\n    }\n    \n    const mlMatch = portionLower.match(/(\\d+(?:\\.\\d+)?)\\s*ml(?:\\s|$)/);\n    if (mlMatch) {\n      const result = parseFloat(mlMatch[1]); // Assume 1ml â‰ˆ 1g for most foods\n      return result;\n    }\n    \n    // Contextual UK/British food portions\n    if (portionLower.includes('rasher') || portionLower.includes('rashers')) {\n      if (foodLower.includes('back bacon') || foodLower.includes('bacon back')) {\n        return num * 28; // Back bacon rasher â‰ˆ 28g\n      }\n      if (foodLower.includes('streaky bacon') || foodLower.includes('bacon streaky')) {\n        return num * 15; // Streaky bacon rasher â‰ˆ 15g  \n      }\n      if (foodLower.includes('bacon')) {\n        return num * 20; // Default bacon rasher â‰ˆ 20g\n      }\n    }\n    \n    // UK Black pudding / Blood sausage slices\n    if (portionLower.includes('slice') && (foodLower.includes('black pudding') || foodLower.includes('blood sausage'))) {\n      return num * 45; // Black pudding slice â‰ˆ 45g\n    }\n    \n    // Sausage links\n    if (portionLower.includes('link') || portionLower.includes('links')) {\n      if (foodLower.includes('sausage')) {\n        return num * 45; // Sausage link â‰ˆ 45g\n      }\n    }\n    \n    // UK Crisps/Chips handling - Standard single-serve packets are 25g in the UK\n    const isUKCrisp = foodLower.includes('crisps') || \n                     (foodLower.includes('chips') && !foodLower.includes('fish') && !foodLower.includes('wood'));\n    \n    if (isUKCrisp || \n        portionLower.includes('crisps') || \n        (portionLower.includes('chips') && !portionLower.includes('fish'))) {\n      \n      // Handle specific UK crisp portion terms\n      if (portionLower.includes('packet') || portionLower.includes('bag') || \n          portionLower.includes('single serve') || portionLower.includes('individual')) {\n        return num * 25; // UK single-serve crisp packet â‰ˆ 25g\n      }\n      \n      // Handle sharing/multi-serve bags\n      if (portionLower.includes('sharing') || portionLower.includes('family') || \n          portionLower.includes('multi') || portionLower.includes('large bag')) {\n        return num * 150; // UK sharing bag â‰ˆ 150g\n      }\n      \n      // Default UK crisp portion (assume standard single-serve if no specific size mentioned)\n      return num * 25; // Default UK crisp portion â‰ˆ 25g\n    }\n    \n    // Volume conversions (rough estimates)\n    if (portionLower.includes('cup')) {\n      return num * 240; // 1 cup â‰ˆ 240g\n    }\n    if (portionLower.includes('tbsp') || portionLower.includes('tablespoon')) {\n      return num * 15; // 1 tbsp â‰ˆ 15g\n    }\n    if (portionLower.includes('tsp') || portionLower.includes('teaspoon')) {\n      return num * 5; // 1 tsp â‰ˆ 5g\n    }\n    \n    // Hash brown differentiation\n    if (portionLower.includes('hash brown') || (foodLower.includes('hash brown') && portionLower.includes('piece'))) {\n      if (portionLower.includes('round') || portionLower.includes('rounds') || portionLower.includes('tater tot')) {\n        return num * 12; // Hash brown rounds â‰ˆ 12g each\n      }\n      if (portionLower.includes('patty') || portionLower.includes('patties')) {\n        return num * 55; // Hash brown patty â‰ˆ 55g each  \n      }\n      return num * 55; // Default hash brown patty size\n    }\n    \n    // Bacon-specific slice handling (must be before general slice handling)\n    if (portionLower.includes('slice') && \n        (foodLower.includes('bacon') || portionLower.includes('bacon'))) {\n      // Bacon slices are much lighter than general slices\n      return num * 12; // Bacon slice â‰ˆ 12g\n    }\n    \n    // Toast/Bread specific slice handling (UK standard)\n    // Use word boundaries to avoid matching \"breaded\", \"breadcrumbs\", \"gingerbread\", etc.\n    const toastBreadPattern = /\\b(toast|bread)\\b/i;\n    const isBreadOrToast = toastBreadPattern.test(foodLower);\n    const isNotBreadVariant = !/(breaded|breadcrumbs|gingerbread|cornbread|shortbread)/i.test(foodLower);\n    \n    if (isBreadOrToast && isNotBreadVariant) {\n      // Toast and bread default to slices, even without \"slice\" in portion text\n      // UK standard: 1 slice of toast â‰ˆ 30g, 1 slice of bread â‰ˆ 30g\n      return num * 30; // Slice of toast/bread â‰ˆ 30g\n    }\n    \n    // Common portion conversions (estimates)\n    if (portionLower.includes('slice')) {\n      return num * 30; // Average slice â‰ˆ 30g (bread, cheese, etc.)\n    }\n    if (portionLower.includes('piece') || portionLower.includes('item')) {\n      return num * 50; // Average piece â‰ˆ 50g\n    }\n    if (portionLower.includes('serving')) {\n      return num * 150; // Average serving â‰ˆ 150g\n    }\n    \n    // Potato handling (jacket potato, baked potato, etc.) - AFTER explicit measurements\n    // Use word boundaries to avoid matching \"potato chips\", \"sweet potato\", etc.\n    const potatoPattern = /\\b(jacket|baked)\\s+potato\\b|\\bpotato(es)?\\b/i;\n    const isPotato = potatoPattern.test(foodLower) || potatoPattern.test(portionLower);\n    if (isPotato && !foodLower.includes('chip') && !foodLower.includes('fries') && !foodLower.includes('sweet')) {\n      if (portionLower.includes('large')) return num * 300; // Large potato â‰ˆ 300g\n      if (portionLower.includes('medium')) return num * 200; // Medium potato â‰ˆ 200g\n      if (portionLower.includes('small')) return num * 150; // Small potato â‰ˆ 150g\n      // Default to medium if no size specified\n      return num * 200; // Default medium potato â‰ˆ 200g\n    }\n    \n    // Generic small/medium/large (after food-specific handlers)\n    if (portionLower.includes('small')) {\n      return 75; // Small portion â‰ˆ 75g\n    }\n    if (portionLower.includes('medium')) {\n      return 150; // Medium portion â‰ˆ 150g\n    }\n    if (portionLower.includes('large')) {\n      return 300; // Large portion â‰ˆ 300g\n    }\n    \n    // STEP 3: Enhanced food-specific standardized portions\n    const standardPortions = [\n      // Fast Food / Burgers (restaurant-specific weights)\n      { keywords: ['big mac'], portion: num * 195, label: 'Big Mac' },\n      { keywords: ['quarter pounder', 'quarterpounder'], portion: num * 200, label: 'Quarter Pounder' },\n      { keywords: ['whopper'], portion: num * 290, label: 'Whopper' },\n      { keywords: ['cheeseburger'], portion: num * 120, label: 'cheeseburger' },\n      { keywords: ['hamburger', 'burger'], portion: num * 110, label: 'hamburger' },\n      \n      // Proteins  \n      { keywords: ['chicken breast', 'chicken fillet'], portion: num * 150, label: 'chicken breast' },\n      { keywords: ['fish fillet', 'salmon fillet'], portion: num * 120, label: 'fish fillet' },\n      { keywords: ['steak', 'beef steak'], portion: num * 200, label: 'beef steak' },\n      \n      // Breads & Grains\n      { keywords: ['bread slice'], portion: num * 28, label: 'bread slice' },\n      { keywords: ['bagel'], portion: num * 95, label: 'bagel' },\n      { keywords: ['muffin'], portion: num * 60, label: 'muffin' },\n      { keywords: ['toast slice'], portion: num * 25, label: 'toast slice' },\n      \n      // Cereals (UK specific)\n      { keywords: ['weetabix', 'weetbix', 'weet-bix'], portion: num * 19, label: 'Weetabix biscuit' },\n      \n      // Fruits\n      { keywords: ['apple', 'medium apple'], portion: num * 180, label: 'apple' },\n      { keywords: ['banana', 'medium banana'], portion: num * 120, label: 'banana' },\n      { keywords: ['orange'], portion: num * 150, label: 'orange' },\n      \n      // Vegetables\n      { keywords: ['potato', 'medium potato'], portion: num * 170, label: 'potato' },\n      { keywords: ['carrot', 'medium carrot'], portion: num * 60, label: 'carrot' },\n      \n      // Dairy\n      { keywords: ['cheese slice'], portion: num * 20, label: 'cheese slice' },\n      { keywords: ['yogurt cup'], portion: num * 170, label: 'yogurt cup' },\n      \n      // Snacks & Crisps (UK standard single-serve portions)\n      { keywords: ['crisps', 'potato chips', 'chips packet', 'crisp packet'], portion: num * 25, label: 'UK crisps' },\n      { keywords: ['prawn cocktail crisps', 'salt vinegar crisps', 'cheese onion crisps'], portion: num * 25, label: 'UK flavored crisps' },\n      { keywords: ['ready salted crisps', 'smoky bacon crisps', 'roast chicken crisps'], portion: num * 25, label: 'UK flavored crisps' }\n    ];\n    \n    for (const standard of standardPortions) {\n      if (standard.keywords.some(keyword => portionLower.includes(keyword) || foodLower.includes(keyword))) {\n        return standard.portion;\n      }\n    }\n\n    // Default fallback with improved logging\n    const fallbackGrams = Math.max(50, num * 25); // Conservative default minimum 50g\n    return fallbackGrams;\n  }\n\n  /**\n   * Get appropriate icon for food type\n   */\n  private getFoodIcon(foodName: string): string {\n    const lowerName = foodName.toLowerCase();\n    \n    if (lowerName.includes('apple') || lowerName.includes('fruit')) return 'ðŸŽ';\n    if (lowerName.includes('banana')) return 'ðŸŒ';\n    if (lowerName.includes('chicken') || lowerName.includes('poultry')) return 'ðŸ—';\n    if (lowerName.includes('fish') || lowerName.includes('salmon')) return 'ðŸŸ';\n    if (lowerName.includes('beef') || lowerName.includes('meat')) return 'ðŸ¥©';\n    if (lowerName.includes('rice') || lowerName.includes('grain')) return 'ðŸš';\n    if (lowerName.includes('bread') || lowerName.includes('toast')) return 'ðŸž';\n    if (lowerName.includes('egg')) return 'ðŸ¥š';\n    if (lowerName.includes('vegetable') || lowerName.includes('broccoli') || lowerName.includes('carrot')) return 'ðŸ¥•';\n    if (lowerName.includes('salad') || lowerName.includes('lettuce')) return 'ðŸ¥—';\n    \n    return 'ðŸ½ï¸'; // Default food icon\n  }\n\n  /**\n   * Legacy food analysis method (fallback when enhanced method fails)\n   */\n  async legacyAnalyzeFoodImage(imagePath: string): Promise<FoodAnalysisResult> {\n    const availableProviders = this.getAvailableProviders();\n    \n    // Try each available provider\n    for (const provider of availableProviders) {\n      for (let attempt = 1; attempt <= provider.maxRetries; attempt++) {\n        try {\n          \n          const result = await provider.analyzeFoodImage(imagePath);\n          \n          return {\n            ...result,\n            imageUrl: imagePath // Ensure imageUrl is set\n          };\n          \n        } catch (error: any) {\n          \n          // If it's a rate limit error, mark provider as temporarily unavailable\n          if (error.isRateLimit) {\n\n            break; // Move to next provider immediately\n          }\n          \n          // If it's the last attempt with this provider, continue to next provider\n          if (attempt === provider.maxRetries) {\n\n            break;\n          }\n          \n          // Wait before retry (exponential backoff)\n          const waitTime = Math.min(1000 * Math.pow(2, attempt - 1), 5000);\n          await this.sleep(waitTime);\n        }\n      }\n    }\n\n    // All providers failed, return helpful fallback data\n    console.warn(\"All AI providers failed, returning user-friendly fallback data\");\n    return {\n      ...this.fallbackData.foodAnalysis,\n      imageUrl: imagePath,\n      confidence: 0,\n      detectedFoods: [\n        {\n          name: \"Mixed Food\",\n          portion: \"1 serving\",\n          calories: 300,\n          protein: 15,\n          carbs: 30,\n          fat: 12,\n          icon: \"ðŸ½ï¸\"\n        },\n        {\n          name: \"Estimated Portion\",\n          portion: \"Medium size\",\n          calories: 200,\n          protein: 8,\n          carbs: 20,\n          fat: 8,\n          icon: \"ðŸ“\"\n        }\n      ],\n      totalCalories: 500,\n      totalProtein: 23,\n      totalCarbs: 50,\n      totalFat: 20,\n      isAITemporarilyUnavailable: true // Add this flag for frontend to show message\n    };\n  }\n\n  /**\n   * Enhanced text analysis workflow: AI parsing + USDA nutrition lookup\n   * @param foodDescription The food description from user\n   * @param clientTimeInfo Optional client time info for timezone-aware analysis\n   */\n  async analyzeFoodText(foodDescription: string, clientTimeInfo?: { timeString: string, timeOfDay: string, hours: number, minutes: number }): Promise<FoodAnalysisResult> {\n    try {\n      // Step 1: Parse food items with portions from text description\n      const foodItems = await this.parseFoodNamesFromText(foodDescription);\n      \n      // Step 1.5: Expand UK compound meals into components for accurate nutrition\n      const expandedFoodItems = this.expandCompoundMeals(foodItems);\n      \n      // Step 2: Get accurate nutrition from USDA for parsed foods\n      const foodNames = expandedFoodItems.map(item => item.name);\n      const nutritionData = await this.getNutritionFromUSDA(foodNames);\n      \n      // Step 3: Combine results into comprehensive analysis\n      return this.combineTextWithNutrition(foodDescription, expandedFoodItems, nutritionData);\n      \n    } catch (error: any) {\n      console.warn('Enhanced text analysis failed, falling back to legacy method:', error.message);\n      return this.legacyAnalyzeFoodText(foodDescription, clientTimeInfo);\n    }\n  }\n\n  /**\n   * Check if two words are similar (handles common typos)\n   * Uses simple character difference counting\n   */\n  private isSimilarWord(word1: string, word2: string): boolean {\n    // Same word\n    if (word1 === word2) return true;\n    \n    // Too different in length\n    if (Math.abs(word1.length - word2.length) > 2) return false;\n    \n    // Count matching characters\n    const shorter = word1.length < word2.length ? word1 : word2;\n    const longer = word1.length >= word2.length ? word1 : word2;\n    \n    let matchCount = 0;\n    for (let i = 0; i < shorter.length; i++) {\n      if (shorter[i] === longer[i] || \n          (i < longer.length - 1 && shorter[i] === longer[i + 1]) || // transposition\n          (i > 0 && shorter[i] === longer[i - 1])) { // transposition\n        matchCount++;\n      }\n    }\n    \n    // Words are similar if 70%+ characters match\n    return matchCount >= shorter.length * 0.7;\n  }\n\n  /**\n   * Expand UK compound meals into USDA-friendly components\n   * Uses precise USDA search terms to ensure accurate nutrition data\n   * e.g., \"fish and chips\" â†’ [\"fish battered fried\", \"french fries\"]\n   */\n  expandCompoundMeals(foodItems: Array<{name: string, portion: string}>): Array<{name: string, portion: string}> {\n    const expandedItems: Array<{name: string, portion: string}> = [];\n    \n    // Map UK compound meals to USDA-friendly component names\n    // Use terms that will match well in USDA database\n    const MEAL_COMPONENTS: { [key: string]: Array<{name: string, portion: string}> } = {\n      'fish and chips': [\n        { name: 'fish battered fried cod', portion: '1 fillet (180g)' },\n        { name: 'french fries fried', portion: '1 serving (200g)' }\n      ],\n      'sausage and chips': [\n        { name: 'pork sausage cooked', portion: '2 sausages (100g)' },\n        { name: 'french fries fried', portion: '1 serving (200g)' }\n      ],\n      'egg and chips': [\n        { name: 'egg fried', portion: '2 eggs (100g)' },\n        { name: 'french fries fried', portion: '1 serving (200g)' }\n      ],\n      'bangers and mash': [\n        { name: 'pork sausage cooked', portion: '2 sausages (100g)' },\n        { name: 'mashed potato', portion: '1 cup (200g)' }\n      ],\n      'beans on toast': [\n        { name: 'baked beans canned', portion: '1 cup (200g)' },\n        { name: 'bread white toasted', portion: '2 slices (60g)' }\n      ],\n      'bread and butter': [\n        { name: 'bread white', portion: '2 slices (60g)' },\n        { name: 'butter salted', portion: '2 tbsp (30g)' }\n      ],\n      'full english breakfast': [\n        { name: 'egg fried', portion: '2 eggs (100g)' },\n        { name: 'bacon cooked', portion: '2 rashers (24g)' },\n        { name: 'pork sausage cooked', portion: '2 sausages (100g)' },\n        { name: 'baked beans canned', portion: '1/2 cup (100g)' },\n        { name: 'bread white toasted', portion: '1 slice (30g)' },\n        { name: 'mushrooms cooked', portion: '1/2 cup (50g)' }\n      ],\n      'full english': [\n        { name: 'egg fried', portion: '2 eggs (100g)' },\n        { name: 'bacon cooked', portion: '2 rashers (24g)' },\n        { name: 'pork sausage cooked', portion: '2 sausages (100g)' },\n        { name: 'baked beans canned', portion: '1/2 cup (100g)' },\n        { name: 'bread white toasted', portion: '1 slice (30g)' },\n        { name: 'mushrooms cooked', portion: '1/2 cup (50g)' }\n      ],\n      'jacket potato': [\n        { name: 'potato baked', portion: '1 medium (200g)' }\n      ],\n      'baked potato': [\n        { name: 'potato baked', portion: '1 medium (200g)' }\n      ],\n      'jam toast': [\n        { name: 'bread white toasted', portion: '2 slices (60g)' },\n        { name: 'jam strawberry', portion: '2 tbsp (40g)' }\n      ],\n      'marmalade toast': [\n        { name: 'bread white toasted', portion: '2 slices (60g)' },\n        { name: 'marmalade orange', portion: '2 tbsp (40g)' }\n      ],\n      'butter toast': [\n        { name: 'bread white toasted', portion: '2 slices (60g)' },\n        { name: 'butter salted', portion: '2 tbsp (30g)' }\n      ],\n      'honey toast': [\n        { name: 'bread white toasted', portion: '2 slices (60g)' },\n        { name: 'honey', portion: '2 tbsp (40g)' }\n      ],\n      'peanut butter toast': [\n        { name: 'bread white toasted', portion: '2 slices (60g)' },\n        { name: 'peanut butter', portion: '2 tbsp (32g)' }\n      ]\n    };\n    \n    for (const item of foodItems) {\n      const lowerName = item.name.toLowerCase().trim();\n      const lowerPortion = item.portion.toLowerCase();\n      \n      // Detect portion size modifiers\n      let sizeMultiplier = 1.0;\n      if (lowerPortion.includes('half') || lowerPortion.includes('1/2')) {\n        sizeMultiplier = 0.5;\n      } else if (lowerPortion.includes('small')) {\n        sizeMultiplier = 0.75;\n      } else if (lowerPortion.includes('large') || lowerPortion.includes('big')) {\n        sizeMultiplier = 1.25;\n      } else if (lowerPortion.includes('extra large') || lowerPortion.includes('xl')) {\n        sizeMultiplier = 1.5;\n      }\n      \n      // Check if this is a compound meal that needs expansion\n      // Use fuzzy matching to handle typos\n      let components = MEAL_COMPONENTS[lowerName];\n      \n      // If no exact match, try fuzzy matching for common typos\n      if (!components) {\n        // Check each compound meal pattern\n        for (const [mealName, mealComponents] of Object.entries(MEAL_COMPONENTS)) {\n          // Extract key words from both strings\n          const mealWords = mealName.split(/\\s+/);\n          const nameWords = lowerName.split(/\\s+/);\n          \n          // Count how many words are similar (allowing for minor typos)\n          let matches = 0;\n          for (const mealWord of mealWords) {\n            for (const nameWord of nameWords) {\n              // Check if words are similar (either exact match or close typo)\n              if (mealWord === nameWord || \n                  this.isSimilarWord(mealWord, nameWord)) {\n                matches++;\n                break;\n              }\n            }\n          }\n          \n          // If most words match, consider it the same meal\n          if (matches >= mealWords.length - 1 && matches >= mealWords.length * 0.6) {\n            console.log(`ðŸ” Fuzzy matched \"${lowerName}\" â†’ \"${mealName}\" (${matches}/${mealWords.length} words matched)`);\n            components = mealComponents;\n            break;\n          }\n        }\n      }\n      \n      if (components) {\n        console.log(`ðŸ½ï¸ Expanding \"${item.name}\" into ${components.length} USDA-friendly components (size multiplier: ${sizeMultiplier}x)`);\n        \n        // Scale component portions based on detected size\n        const scaledComponents = components.map(comp => {\n          // Extract grams from portion (e.g., \"1 fillet (180g)\" â†’ 180)\n          const gramsMatch = comp.portion.match(/\\((\\d+)g\\)/);\n          if (gramsMatch) {\n            const baseGrams = parseInt(gramsMatch[1]);\n            const scaledGrams = Math.round(baseGrams * sizeMultiplier);\n            const scaledPortion = comp.portion.replace(/\\(\\d+g\\)/, `(${scaledGrams}g)`);\n            return {\n              ...comp,\n              portion: scaledPortion\n            };\n          }\n          return comp;\n        });\n        \n        expandedItems.push(...scaledComponents);\n      } else {\n        // Not a compound meal, keep as is\n        expandedItems.push(item);\n      }\n    }\n    \n    return expandedItems;\n  }\n\n  /**\n   * Parse food items with individual portions from text description\n   */\n  async parseFoodNamesFromText(foodDescription: string): Promise<Array<{name: string, portion: string}>> {\n    console.log(`ðŸ“ Parsing food items from text: \"${foodDescription}\"`);\n    \n    // UK FOOD PROTECTION: These are compound names that should NEVER be split during parsing\n    // They will be expanded into USDA-friendly components later\n    const UK_COMPOUND_FOODS = [\n      'fish and chips',\n      'sausage and chips',\n      'egg and chips',\n      'bangers and mash',\n      'jacket potato',\n      'baked potato',\n      'beans on toast',\n      'bread and butter',\n      'full english breakfast',\n      'full english',\n      'jam toast',\n      'marmalade toast',\n      'butter toast',\n      'honey toast',\n      'peanut butter toast'\n    ];\n    \n    // STEP 0: Protect UK compound foods by temporarily replacing them with placeholders\n    let protectedText = foodDescription;\n    const replacements: Array<{placeholder: string, original: string}> = [];\n    \n    UK_COMPOUND_FOODS.forEach((ukFood, index) => {\n      // Case-insensitive search with word boundaries\n      const regex = new RegExp(`\\\\b${ukFood}\\\\b`, 'gi');\n      const matches = protectedText.match(regex);\n      \n      if (matches) {\n        matches.forEach(match => {\n          const placeholder = `__UK_FOOD_${index}__`;\n          protectedText = protectedText.replace(match, placeholder);\n          replacements.push({ placeholder, original: match });\n          console.log(`ðŸ‡¬ðŸ‡§ Protected UK food: \"${match}\" â†’ \"${placeholder}\"`);\n        });\n      }\n    });\n    \n    // STEP 1: First split on common separators (and, with, comma)\n    // Examples: \"2 slices of bacon, 2 sausages and 2 eggs\" â†’ [\"2 slices of bacon\", \"2 sausages\", \"2 eggs\"]\n    //           \"chicken with rice\" â†’ [\"chicken\", \"rice\"]\n    const separatorRegex = /\\s*(?:,|and|with)\\s+/i;\n    let rawParts = protectedText.split(separatorRegex).map(p => p.trim()).filter(p => p.length > 0);\n    \n    // STEP 1.1: Restore UK compound foods from placeholders\n    rawParts = rawParts.map(part => {\n      let restoredPart = part;\n      replacements.forEach(({placeholder, original}) => {\n        restoredPart = restoredPart.replace(placeholder, original);\n      });\n      return restoredPart;\n    });\n    \n    // STEP 1.5: Further split parts that contain multiple food items indicated by quantity words\n    // Examples: \"two slices of Bacon two sausages\" â†’ [\"two slices of Bacon\", \"two sausages\"]\n    // BUT preserve: \"two 100 gram chicken breasts\", \"two large eight ounce steaks\"\n    const furtherSplitParts: string[] = [];\n    for (const part of rawParts) {\n      // Look for quantity words that start a new food item\n      const quantityWords = /\\b(one|two|three|four|five|six|seven|eight|nine|ten)\\s+/gi;\n      const matches = Array.from(part.matchAll(quantityWords));\n      \n      if (matches.length > 1) {\n        const splits: string[] = [];\n        let lastIndex = 0;\n        \n        for (let i = 1; i < matches.length; i++) {\n          const match = matches[i];\n          if (match.index !== undefined) {\n            // Get the word(s) immediately before this quantity word\n            const textBefore = part.substring(lastIndex, match.index).trim();\n            const lastWords = textBefore.split(/\\s+/).slice(-3).join(' ').toLowerCase();\n            \n            // Words that indicate we're still in a measurement/size description for the same food\n            const portionDescriptors = /\\b(slice|slices|piece|pieces|serving|servings|cup|cups|bowl|bowls|plate|plates|of|the|a|an|large|medium|small|jumbo|extra|gram|grams|g|oz|ounce|ounces|ml|milliliter|milliliters|liter|liters|l|inch|inches|thick|cut|bone|boneless|in)\\b/i;\n            \n            // If the last word(s) before this number are ALL portion descriptors, it's likely still the same food\n            // Otherwise, if there's a food noun (non-descriptor word), split here\n            const wordsBeforeArray = lastWords.split(/\\s+/);\n            const hasNonDescriptor = wordsBeforeArray.some(word => \n              word.length > 2 && !portionDescriptors.test(word) && !/^\\d+$/.test(word)\n            );\n            \n            if (hasNonDescriptor) {\n              // Found a food word before this number, so this is a new food item\n              splits.push(part.substring(lastIndex, match.index).trim());\n              lastIndex = match.index;\n            }\n          }\n        }\n        \n        if (splits.length > 0) {\n          splits.push(part.substring(lastIndex).trim());\n          furtherSplitParts.push(...splits.filter(s => s.length > 0));\n        } else {\n          furtherSplitParts.push(part);\n        }\n      } else {\n        furtherSplitParts.push(part);\n      }\n    }\n    \n    rawParts = furtherSplitParts;\n    console.log(`ðŸ”ª Split into ${rawParts.length} parts:`, rawParts);\n    \n    // STEP 2: For each part, extract the food name AND keep the portion info\n    const foodItems: Array<{name: string, portion: string}> = [];\n    \n    for (const part of rawParts) {\n      // Keep the original part as the portion (includes quantity like \"2 slices of bacon\")\n      const portionText = part;\n      \n      // Clean up the food name for USDA lookup (e.g., \"2 slices of bacon\" â†’ \"bacon\")\n      let cleanedName = part\n        .replace(/^\\d+\\s+/, '') // Remove leading numbers\n        .replace(/^(one|two|three|four|five|six|seven|eight|nine|ten)\\s+/i, '') // Remove word numbers\n        .replace(/\\b(small|medium|large|extra\\s+large|jumbo)\\s+/gi, '') // Remove size descriptors\n        .replace(/\\b(slice|slices|piece|pieces|serving|servings|cup|cups|bowl|bowls|of|the)\\b/gi, '') // Remove portion words\n        .trim();\n      \n      // If we cleaned too much, use the original part\n      if (cleanedName.length < 2) {\n        cleanedName = part;\n      }\n      \n      console.log(`  ðŸ§¹ Extracted from \"${part}\" â†’ name: \"${cleanedName}\", portion: \"${portionText}\"`);\n      foodItems.push({ name: cleanedName, portion: portionText });\n    }\n    \n    console.log(`âœ… Final parsed food items:`, foodItems);\n    return foodItems.length > 0 ? foodItems : [{ name: foodDescription.trim(), portion: foodDescription.trim() }];\n  }\n\n  /**\n   * Combine text input with USDA nutrition data\n   */\n  async combineTextWithNutrition(\n    originalText: string,\n    foodItems: Array<{name: string, portion: string}>, \n    nutritionMap: Map<string, any>\n  ): Promise<FoodAnalysisResult> {\n    const detectedFoods = [];\n    let totalCalories = 0;\n    let totalProtein = 0;\n    let totalCarbs = 0;\n    let totalFat = 0;\n\n    // Process each parsed food item with its individual portion\n    for (const foodItem of foodItems) {\n      const usdaData = nutritionMap.get(foodItem.name);\n      \n      if (usdaData) {\n        // Convert the INDIVIDUAL portion text to grams for scaling\n        // e.g., for bacon: \"2 slices of bacon\" â†’ 24g\n        // e.g., for eggs: \"2 eggs\" â†’ 100g\n        const portionGrams = this.convertPortionToGrams(foodItem.portion, foodItem.name);\n        const scaleFactor = portionGrams / 100; // USDA data is per 100g\n        \n        // Create human-readable portion text with grams\n        const portionText = this.formatPortionText(foodItem.portion, foodItem.name, portionGrams);\n        \n        // Use accurate USDA nutrition data scaled by the individual portion\n        const food = {\n          name: usdaData.usdaFood.description,\n          portion: portionText, // Use formatted portion (e.g., \"1 medium (200g)\")\n          calories: Math.round(usdaData.nutrition.calories * scaleFactor),\n          protein: Math.round(usdaData.nutrition.protein * scaleFactor),\n          carbs: Math.round(usdaData.nutrition.carbs * scaleFactor),\n          fat: Math.round(usdaData.nutrition.fat * scaleFactor),\n          icon: this.getFoodIcon(foodItem.name)\n        };\n        \n        detectedFoods.push(food);\n        totalCalories += food.calories;\n        totalProtein += food.protein;\n        totalCarbs += food.carbs;\n        totalFat += food.fat;\n        \n      } else {\n        // Try OpenFoodFacts as fallback\n        const offData = await this.tryOpenFoodFactsFallback(foodItem.name);\n        \n        if (offData) {\n          // Convert individual portion text to grams for scaling\n          const portionGrams = this.convertPortionToGrams(foodItem.portion, foodItem.name);\n          const scaleFactor = portionGrams / 100; // OpenFoodFacts data is per 100g\n          \n          // Create human-readable portion text with grams\n          const portionText = this.formatPortionText(foodItem.portion, foodItem.name, portionGrams);\n          \n          const food = {\n            name: offData.name,\n            portion: portionText, // Use formatted portion\n            calories: Math.round(offData.nutrition.calories * scaleFactor),\n            protein: Math.round(offData.nutrition.protein * scaleFactor),\n            carbs: Math.round(offData.nutrition.carbs * scaleFactor),\n            fat: Math.round(offData.nutrition.fat * scaleFactor),\n            icon: this.getFoodIcon(foodItem.name)\n          };\n          \n          detectedFoods.push(food);\n          totalCalories += food.calories;\n          totalProtein += food.protein;\n          totalCarbs += food.carbs;\n          totalFat += food.fat;\n          \n        } else {\n          // Final hardcoded fallback\n          const fallbackFood = {\n            name: foodItem.name,\n            portion: foodItem.portion || '1 serving',\n            calories: 150, // Conservative estimate\n            protein: 8,\n            carbs: 15,\n            fat: 6,\n            icon: this.getFoodIcon(foodItem.name)\n          };\n          \n          detectedFoods.push(fallbackFood);\n          totalCalories += fallbackFood.calories;\n          totalProtein += fallbackFood.protein;\n          totalCarbs += fallbackFood.carbs;\n          totalFat += fallbackFood.fat;\n          \n\n        }\n      }\n    }\n\n    console.log(`ðŸ“Š combineTextWithNutrition returning ${detectedFoods.length} foods:`, \n      detectedFoods.map(f => `${f.name} (${f.calories} cal)`));\n    \n    return {\n      imageUrl: `voice-input-${Date.now()}.txt`,\n      confidence: nutritionMap.size > 0 ? 90 : 50, // Higher confidence if USDA data found\n      totalCalories,\n      totalProtein,\n      totalCarbs,\n      totalFat,\n      detectedFoods\n    };\n  }\n\n  /**\n   * Legacy text analysis method (fallback when enhanced method fails)\n   */\n  async legacyAnalyzeFoodText(foodDescription: string, clientTimeInfo?: { timeString: string, timeOfDay: string, hours: number, minutes: number }): Promise<FoodAnalysisResult> {\n    const availableProviders = this.getAvailableProviders();\n    \n    // Try each available provider in priority order\n    for (const provider of availableProviders) {\n      for (let attempt = 1; attempt <= provider.maxRetries; attempt++) {\n        try {\n          \n          const result = await provider.analyzeFoodText(foodDescription, clientTimeInfo);\n          \n          return {\n            ...result,\n            imageUrl: `voice-input-${Date.now()}.txt` // Placeholder for text input\n          };\n          \n        } catch (error: any) {\n          \n          // If it's a rate limit error, mark provider as temporarily unavailable\n          if (error.isRateLimit) {\n\n            break; // Move to next provider immediately\n          }\n          \n          // If it's the last attempt with this provider, continue to next provider\n          if (attempt === provider.maxRetries) {\n\n            break;\n          }\n          \n          // Wait before retry (exponential backoff)\n          const waitTime = Math.min(1000 * Math.pow(2, attempt - 1), 5000);\n          await this.sleep(waitTime);\n        }\n      }\n    }\n\n    // All providers failed, return helpful fallback data based on the food description\n    console.warn(\"All AI providers failed for text analysis, returning fallback data\");\n    \n    // Try to extract basic info from the input for a more helpful fallback\n    const lowerDesc = foodDescription.toLowerCase();\n    let fallbackFood = \"Mixed Food\";\n    let fallbackCalories = 200;\n    let fallbackProtein = 10;\n    let fallbackCarbs = 20;\n    let fallbackFat = 8;\n    let fallbackIcon = \"ðŸ½ï¸\";\n\n    // Simple keyword matching for better fallbacks\n    if (lowerDesc.includes('apple')) {\n      fallbackFood = \"Apple\";\n      fallbackCalories = 80;\n      fallbackProtein = 0;\n      fallbackCarbs = 21;\n      fallbackFat = 0;\n      fallbackIcon = \"ðŸŽ\";\n    } else if (lowerDesc.includes('banana')) {\n      fallbackFood = \"Banana\";\n      fallbackCalories = 105;\n      fallbackProtein = 1;\n      fallbackCarbs = 27;\n      fallbackFat = 0;\n      fallbackIcon = \"ðŸŒ\";\n    } else if (lowerDesc.includes('salmon') || lowerDesc.includes('fish')) {\n      fallbackFood = \"Fish/Salmon\";\n      fallbackCalories = 200;\n      fallbackProtein = 25;\n      fallbackCarbs = 0;\n      fallbackFat = 12;\n      fallbackIcon = \"ðŸŸ\";\n    } else if (lowerDesc.includes('chicken')) {\n      fallbackFood = \"Chicken\";\n      fallbackCalories = 165;\n      fallbackProtein = 31;\n      fallbackCarbs = 0;\n      fallbackFat = 4;\n      fallbackIcon = \"ðŸ—\";\n    } else if (lowerDesc.includes('rice')) {\n      fallbackFood = \"Rice\";\n      fallbackCalories = 130;\n      fallbackProtein = 3;\n      fallbackCarbs = 28;\n      fallbackFat = 0;\n      fallbackIcon = \"ðŸš\";\n    }\n\n    return {\n      imageUrl: `voice-input-${Date.now()}.txt`,\n      confidence: 0,\n      detectedFoods: [\n        {\n          name: fallbackFood,\n          portion: \"estimated portion\",\n          calories: fallbackCalories,\n          protein: fallbackProtein,\n          carbs: fallbackCarbs,\n          fat: fallbackFat,\n          icon: fallbackIcon\n        }\n      ],\n      totalCalories: fallbackCalories,\n      totalProtein: fallbackProtein,\n      totalCarbs: fallbackCarbs,\n      totalFat: fallbackFat,\n      isAITemporarilyUnavailable: true // Add this flag for frontend to show message\n    };\n  }\n\n  /**\n   * Generate diet advice using the best available provider with intelligent fallback\n   */\n  async generateDietAdvice(entries: DiaryEntry[], userProfile?: any): Promise<DietAdviceResult> {\n    const availableProviders = this.getAvailableProviders();\n    \n    // Try each available provider\n    for (const provider of availableProviders) {\n      for (let attempt = 1; attempt <= provider.maxRetries; attempt++) {\n        try {\n          \n          const result = await provider.generateDietAdvice(entries, userProfile);\n          \n          return result;\n          \n        } catch (error: any) {\n          \n          // If it's a rate limit error, mark provider as temporarily unavailable\n          if (error.isRateLimit) {\n\n            break; // Move to next provider immediately\n          }\n          \n          // If it's the last attempt with this provider, continue to next provider\n          if (attempt === provider.maxRetries) {\n\n            break;\n          }\n          \n          // Wait before retry (exponential backoff)\n          const waitTime = Math.min(1000 * Math.pow(2, attempt - 1), 5000);\n          await this.sleep(waitTime);\n        }\n      }\n    }\n\n    // All providers failed, return fallback advice\n    console.warn(\"All AI providers failed for diet advice, returning fallback data\");\n    return this.fallbackData.dietAdvice;\n  }\n\n  /**\n   * Answer a custom nutrition question based on user's diary data, profile, memory, and personality\n   */\n  async answerNutritionQuestion(\n    question: string, \n    userEntries: DiaryEntry[], \n    userProfile?: any, \n    nutritionGoals?: any,\n    coachMemory?: any,\n    personality?: any\n  ): Promise<string> {\n    const availableProviders = this.getAvailableProviders();\n    \n    // Try each available provider\n    for (const provider of availableProviders) {\n      for (let attempt = 1; attempt <= provider.maxRetries; attempt++) {\n        try {\n          \n          const response = await provider.answerNutritionQuestion(\n            question, \n            userEntries, \n            userProfile, \n            nutritionGoals,\n            coachMemory,\n            personality\n          );\n          \n          return response;\n          \n        } catch (error: any) {\n          \n          // If it's a rate limit error, try next provider immediately\n          if (error.isRateLimit) {\n\n            break;\n          }\n          \n          // If it's the last attempt with this provider, continue to next provider\n          if (attempt === provider.maxRetries) {\n\n            break;\n          }\n          \n          // Wait before retry (exponential backoff)\n          const waitTime = Math.min(1000 * Math.pow(2, attempt - 1), 5000);\n          await this.sleep(waitTime);\n        }\n      }\n    }\n\n    // All providers failed, return a helpful fallback response\n    console.warn(\"All AI providers failed for custom question, returning fallback response\");\n    return \"I'm sorry, I'm having trouble accessing my AI services right now. Please try asking your question again in a moment, or consult with a healthcare professional for personalized nutrition advice.\";\n  }\n\n  /**\n   * Answer a custom nutrition question with comprehensive user context\n   * This version uses the full user context aggregated by the user context service\n   */\n  async answerNutritionQuestionWithContext(\n    question: string,\n    userContext: any,\n    coachMemory?: any,\n    personality?: any,\n    clientTimeInfo?: { timeString: string, timeOfDay: string, hours: number, minutes: number }\n  ): Promise<string> {\n    const availableProviders = this.getAvailableProviders();\n    \n    // Import the user context service\n    const { userContextService } = await import('../services/user-context-service');\n    \n    // Format context for AI prompt\n    const contextString = userContextService.formatContextForAI(userContext);\n    \n    // Try each available provider\n    for (const provider of availableProviders) {\n      for (let attempt = 1; attempt <= provider.maxRetries; attempt++) {\n        try {\n          // Build comprehensive prompt with user context\n          let fullPrompt = question;\n          \n          // Add formatted user context to the prompt\n          if (contextString) {\n            fullPrompt = `${question}\\n\\n=== USER DATA CONTEXT ===\\n${contextString}\\n=== END CONTEXT ===\\n\\nPlease provide personalized advice based on the user's specific data and patterns above.`;\n          }\n          \n          // Use the existing answerNutritionQuestion method but with enriched context\n          const response = await provider.answerNutritionQuestion(\n            fullPrompt,\n            userContext.recentDiary || [],\n            userContext.profile || undefined,\n            userContext.nutritionGoals || undefined,\n            coachMemory,\n            personality,\n            clientTimeInfo\n          );\n          \n          return response;\n          \n        } catch (error: any) {\n          // If it's a rate limit error, try next provider immediately\n          if (error.isRateLimit) {\n            break;\n          }\n          \n          // If it's the last attempt with this provider, continue to next provider\n          if (attempt === provider.maxRetries) {\n            break;\n          }\n          \n          // Wait before retry (exponential backoff)\n          const waitTime = Math.min(1000 * Math.pow(2, attempt - 1), 5000);\n          await this.sleep(waitTime);\n        }\n      }\n    }\n\n    // All providers failed, return a helpful fallback response\n    console.warn(\"All AI providers failed for custom question with context, returning fallback response\");\n    return \"I'm currently experiencing high demand on our free AI services (Gemini and HuggingFace are temporarily busy). Your question is important! Please try again in a few moments - the services usually clear up quickly. In the meantime, you can still track your meals, view your progress, and explore your nutrition data. For urgent nutrition advice, please consult with a healthcare professional.\";\n  }\n\n  /**\n   * Generate daily coaching content using the best available provider\n   */\n  async generateDailyCoaching(entries: DiaryEntry[], userProfile?: any): Promise<DailyCoaching> {\n    const availableProviders = this.getAvailableProviders();\n    \n    // Try each available provider\n    for (const provider of availableProviders) {\n      for (let attempt = 1; attempt <= provider.maxRetries; attempt++) {\n        try {\n          \n          const result = await provider.generateDailyCoaching(entries, userProfile);\n          \n          return result;\n\n        } catch (error: any) {\n          const isLastAttempt = attempt === provider.maxRetries;\n          const isLastProvider = provider === availableProviders[availableProviders.length - 1];\n          \n          \n          // If it's a rate limit error, try next provider immediately\n          if (error.isRateLimit) {\n\n            break;\n          }\n          \n          // If it's the last attempt with this provider but not the last provider, try next\n          if (isLastAttempt && !isLastProvider) {\n            console.log(`Max retries reached for ${provider.name}, trying next provider`);\n            break;\n          }\n          \n          // If it's a temporary error and not the last attempt, retry with delay\n          if (error.isTemporary && !isLastAttempt) {\n            const delay = Math.min(1000 * Math.pow(2, attempt - 1), 10000); // Exponential backoff\n            console.log(`Retrying ${provider.name} in ${delay}ms...`);\n            await this.sleep(delay);\n            continue;\n          }\n          \n          // If this is the last provider and last attempt, return fallback\n          if (isLastProvider && isLastAttempt) {\n            console.log('All providers failed for daily coaching, returning fallback data');\n            return this.fallbackData.dailyCoaching;\n          }\n        }\n      }\n    }\n\n    // Fallback data (should not reach here due to logic above, but just in case)\n    return this.fallbackData.dailyCoaching;\n  }\n\n  /**\n   * Generate educational tips using the best available provider\n   */\n  async generateEducationalTips(category: 'all' | 'nutrition' | 'medication' | 'motivation'): Promise<EducationalTip[]> {\n    const availableProviders = this.getAvailableProviders();\n    \n    // Try each available provider\n    for (const provider of availableProviders) {\n      for (let attempt = 1; attempt <= provider.maxRetries; attempt++) {\n        try {\n          console.log(`Attempting educational tips with ${provider.name} (attempt ${attempt}/${provider.maxRetries})`);\n          \n          const result = await provider.generateEducationalTips(category);\n          \n          return result;\n\n        } catch (error: any) {\n          const isLastAttempt = attempt === provider.maxRetries;\n          const isLastProvider = provider === availableProviders[availableProviders.length - 1];\n          \n          console.log(`âœ— Educational tips failed with ${provider.name} (attempt ${attempt}): ${error.message}`);\n          \n          // If it's a rate limit error, try next provider immediately\n          if (error.isRateLimit) {\n\n            break;\n          }\n          \n          // If it's the last attempt with this provider but not the last provider, try next\n          if (isLastAttempt && !isLastProvider) {\n            console.log(`Max retries reached for ${provider.name}, trying next provider`);\n            break;\n          }\n          \n          // If it's a temporary error and not the last attempt, retry with delay\n          if (error.isTemporary && !isLastAttempt) {\n            const delay = Math.min(1000 * Math.pow(2, attempt - 1), 10000); // Exponential backoff\n            console.log(`Retrying ${provider.name} in ${delay}ms...`);\n            await this.sleep(delay);\n            continue;\n          }\n          \n          // If this is the last provider and last attempt, return fallback\n          if (isLastProvider && isLastAttempt) {\n            console.log('All providers failed for educational tips, returning fallback data');\n            // Filter fallback tips by category\n            const filteredTips = category === 'all' \n              ? this.fallbackData.educationalTips \n              : this.fallbackData.educationalTips.filter(tip => tip.category === category);\n            return filteredTips;\n          }\n        }\n      }\n    }\n\n    // Fallback data (should not reach here due to logic above, but just in case)\n    const filteredTips = category === 'all' \n      ? this.fallbackData.educationalTips \n      : this.fallbackData.educationalTips.filter(tip => tip.category === category);\n    return filteredTips;\n  }\n\n  /**\n   * Get list of available providers sorted by priority\n   */\n  private getAvailableProviders(): AIProvider[] {\n    return this.providers\n      .filter(provider => provider.isAvailable())\n      .sort((a, b) => a.priority - b.priority);\n  }\n\n  /**\n   * Generate recipes based on dietary requirements\n   */\n  async generateRecipes(dietaryFilter: string = \"\", userProfile: any = null): Promise<any[]> {\n    const availableProviders = this.getAvailableProviders();\n    \n    // Try each available provider\n    for (const provider of availableProviders) {\n      for (let attempt = 1; attempt <= provider.maxRetries; attempt++) {\n        try {\n          console.log(`Attempting recipe generation with ${provider.name} (attempt ${attempt}/${provider.maxRetries})`);\n          \n          // Check if provider has generateRecipes method\n          if ('generateRecipes' in provider && typeof (provider as any).generateRecipes === 'function') {\n            const result = await (provider as any).generateRecipes(dietaryFilter, userProfile);\n            return result;\n          } else {\n            console.log(`${provider.name} does not support recipe generation, trying next provider`);\n            break;\n          }\n        } catch (error: any) {\n          console.error(`âœ— Recipe generation failed with ${provider.name} (attempt ${attempt}):`, error.message);\n          \n          // Check if it's a rate limit error\n          if (error.message?.includes('rate limit') || error.message?.includes('quota') || error.status === 429) {\n\n            break;\n          }\n          \n          // If this was the last attempt for this provider, move to next\n          if (attempt === provider.maxRetries) {\n\n            break;\n          }\n          \n          // Wait before retry (exponential backoff)\n          const waitTime = Math.min(1000 * Math.pow(2, attempt - 1), 5000);\n          await this.sleep(waitTime);\n        }\n      }\n    }\n\n    // All providers failed, return fallback recipes\n    console.log(\"All AI providers failed for recipe generation, returning fallback recipes\");\n    return this.getFallbackRecipes(dietaryFilter);\n  }\n\n  /**\n   * Get fallback recipes when AI providers are unavailable\n   */\n  private getFallbackRecipes(dietaryFilter: string): any[] {\n    const baseRecipes = [\n      {\n        id: \"fallback-1\",\n        name: \"Grilled Chicken Salad\",\n        description: \"Fresh mixed greens with grilled chicken breast, vegetables, and olive oil dressing\",\n        calories: 320,\n        protein: 28,\n        carbs: 12,\n        fat: 18,\n        servings: 1,\n        prepTime: 15,\n        cookTime: 10,\n        difficulty: \"Easy\" as const,\n        ingredients: [\"chicken breast\", \"mixed greens\", \"tomatoes\", \"cucumbers\", \"olive oil\", \"lemon juice\"],\n        instructions: [\n          \"Season and grill chicken breast until cooked through\",\n          \"Mix greens, tomatoes, and cucumbers in a bowl\",\n          \"Slice chicken and place on top of salad\",\n          \"Drizzle with olive oil and lemon juice\"\n        ],\n        tags: [\"healthy\", \"protein\", \"low-carb\"],\n        dietaryInfo: [\"High Protein\", \"Gluten Free\"]\n      },\n      {\n        id: \"fallback-2\",\n        name: \"Vegetable Stir Fry\",\n        description: \"Colorful mixed vegetables stir-fried with garlic and ginger\",\n        calories: 180,\n        protein: 6,\n        carbs: 25,\n        fat: 8,\n        servings: 2,\n        prepTime: 10,\n        cookTime: 8,\n        difficulty: \"Easy\" as const,\n        ingredients: [\"broccoli\", \"bell peppers\", \"carrots\", \"snap peas\", \"garlic\", \"ginger\", \"soy sauce\", \"sesame oil\"],\n        instructions: [\n          \"Heat oil in a large pan or wok\",\n          \"Add garlic and ginger, stir for 30 seconds\",\n          \"Add vegetables and stir-fry for 5-6 minutes\",\n          \"Season with soy sauce and serve hot\"\n        ],\n        tags: [\"vegetarian\", \"vegan\", \"quick\"],\n        dietaryInfo: [\"Vegan\", \"Vegetarian\", \"High Fiber\"]\n      },\n      {\n        id: \"fallback-3\",\n        name: \"Quinoa Bowl\",\n        description: \"Nutritious quinoa bowl with roasted vegetables and tahini dressing\",\n        calories: 420,\n        protein: 15,\n        carbs: 55,\n        fat: 16,\n        servings: 1,\n        prepTime: 20,\n        cookTime: 25,\n        difficulty: \"Medium\" as const,\n        ingredients: [\"quinoa\", \"sweet potato\", \"chickpeas\", \"spinach\", \"tahini\", \"lemon juice\", \"olive oil\"],\n        instructions: [\n          \"Cook quinoa according to package instructions\",\n          \"Roast diced sweet potato and chickpeas at 400Â°F for 20 minutes\",\n          \"Mix tahini, lemon juice, and olive oil for dressing\",\n          \"Combine quinoa, roasted vegetables, spinach, and dressing\"\n        ],\n        tags: [\"vegetarian\", \"healthy\", \"protein\"],\n        dietaryInfo: [\"Vegetarian\", \"High Protein\", \"High Fiber\", \"Gluten Free\"]\n      }\n    ];\n\n    // Filter recipes based on dietary requirements\n    if (!dietaryFilter) {\n      return baseRecipes;\n    }\n\n    return baseRecipes.filter(recipe => {\n      const filterLower = dietaryFilter.toLowerCase().replace('-', ' ');\n      return recipe.dietaryInfo.some(diet => \n        diet.toLowerCase().includes(filterLower) || \n        filterLower.includes(diet.toLowerCase())\n      );\n    });\n  }\n\n  /**\n   * Analyze restaurant menu text and recommend meals based on user goals\n   */\n  async analyzeMenu(menuText: string, nutritionGoals: {\n    dailyCalories: number;\n    proteinGrams: number;\n    carbsGrams: number;\n    fatGrams: number;\n  }): Promise<{\n    recommendations: Array<{\n      name: string;\n      description: string;\n      calories: number;\n      protein: number;\n      carbs: number;\n      fat: number;\n      matchScore: number;\n      matchReason: string;\n    }>;\n  }> {\n    const availableProviders = this.getAvailableProviders();\n    \n    if (availableProviders.length === 0) {\n      // Fallback: return placeholder recommendations\n      return {\n        recommendations: [\n          {\n            name: \"Grilled Chicken Salad\",\n            description: \"Lean protein with mixed greens and vegetables\",\n            calories: 350,\n            protein: 35,\n            carbs: 20,\n            fat: 12,\n            matchScore: 85,\n            matchReason: \"High protein, balanced macros\"\n          },\n          {\n            name: \"Salmon Bowl\",\n            description: \"Grilled salmon with quinoa and roasted vegetables\",\n            calories: 480,\n            protein: 32,\n            carbs: 45,\n            fat: 18,\n            matchScore: 78,\n            matchReason: \"Good balance of protein and healthy fats\"\n          }\n        ]\n      };\n    }\n\n    // Try each provider until one succeeds\n    for (const provider of availableProviders) {\n      try {\n        const prompt = `You are a nutrition expert analyzing a restaurant menu. The user has the following nutrition goals:\n- Daily Calories: ${nutritionGoals.dailyCalories}\n- Protein: ${nutritionGoals.proteinGrams}g\n- Carbs: ${nutritionGoals.carbsGrams}g\n- Fat: ${nutritionGoals.fatGrams}g\n\nMenu text:\n${menuText}\n\nAnalyze this menu and recommend the top 5 meals that best match the user's nutrition goals. For each meal:\n1. Extract the meal name and description from the menu\n2. Estimate the nutritional content (calories, protein, carbs, fat)\n3. Calculate how well it matches the user's goals (matchScore 0-100)\n4. Explain why it's a good match\n\nReturn ONLY a valid JSON object in this exact format:\n{\n  \"recommendations\": [\n    {\n      \"name\": \"Meal Name\",\n      \"description\": \"Brief description from menu\",\n      \"calories\": 450,\n      \"protein\": 30,\n      \"carbs\": 35,\n      \"fat\": 15,\n      \"matchScore\": 85,\n      \"matchReason\": \"Why this meal matches user goals\"\n    }\n  ]\n}`;\n\n        // Use analyzeFoodText but extract JSON from the response\n        // This is a workaround since we don't have a direct generateText method\n        const textResult = await provider.analyzeFoodText(prompt);\n        \n        // Try to extract JSON from the confidence or other fields if AI embedded it\n        // For now, we'll use a simple heuristic approach\n        const response = JSON.stringify(textResult);\n        \n        // Actually, let's just return structured data based on the detectedFoods\n        // This won't be perfect but it's a fallback\n        if (textResult.detectedFoods && textResult.detectedFoods.length > 0) {\n          const recommendations = textResult.detectedFoods.slice(0, 5).map((food, index) => ({\n            name: food.name,\n            description: `${food.portion} - estimated from menu`,\n            calories: food.calories,\n            protein: food.protein,\n            carbs: food.carbs,\n            fat: food.fat,\n            matchScore: 100 - (index * 5), // Descending score\n            matchReason: `Matches your nutritional goals`\n          }));\n          \n          return { recommendations };\n        }\n        \n        throw new Error(\"Could not parse menu analysis\");\n      } catch (error: any) {\n        console.warn(`Menu analysis failed with ${provider.name}:`, error.message);\n        continue;\n      }\n    }\n\n    // All providers failed, return fallback\n    return {\n      recommendations: [\n        {\n          name: \"Grilled Chicken Salad\",\n          description: \"Lean protein with mixed greens and vegetables\",\n          calories: 350,\n          protein: 35,\n          carbs: 20,\n          fat: 12,\n          matchScore: 85,\n          matchReason: \"High protein, balanced macros\"\n        },\n        {\n          name: \"Salmon Bowl\",\n          description: \"Grilled salmon with quinoa and roasted vegetables\",\n          calories: 480,\n          protein: 32,\n          carbs: 45,\n          fat: 18,\n          matchScore: 78,\n          matchReason: \"Good balance of protein and healthy fats\"\n        }\n      ]\n    };\n  }\n\n  /**\n   * Get the first available provider from a preferred list (case-insensitive)\n   */\n  public getFirstAvailableProvider(preferredNames: string[]): AIProvider | null {\n    for (const name of preferredNames) {\n      const provider = this.providers.find(\n        p => p.name.toLowerCase() === name.toLowerCase() && p.isAvailable()\n      );\n      if (provider) {\n        return provider;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Get status of all providers for monitoring\n   */\n  public getProviderStatuses(): ProviderStatus[] {\n    return this.providers.map(provider => provider.getStatus());\n  }\n\n  /**\n   * Get overall system health\n   */\n  public getSystemHealth(): {\n    healthy: boolean;\n    availableProviders: number;\n    totalProviders: number;\n    statuses: ProviderStatus[];\n  } {\n    const statuses = this.getProviderStatuses();\n    const availableCount = statuses.filter(status => status.available).length;\n    \n    return {\n      healthy: availableCount > 0,\n      availableProviders: availableCount,\n      totalProviders: this.providers.length,\n      statuses\n    };\n  }\n\n  /**\n   * Reset error counts for all providers (useful for recovery)\n   */\n  public resetProviders(): void {\n    this.providers.forEach(provider => {\n      (provider as any).errorCount = 0;\n      (provider as any).lastError = undefined;\n    });\n    console.log(\"All providers reset\");\n  }\n\n  /**\n   * Add a new provider to the system\n   */\n  public addProvider(provider: AIProvider): void {\n    this.providers.push(provider);\n    this.providers.sort((a, b) => a.priority - b.priority);\n    console.log(`Added provider: ${provider.name} with priority ${provider.priority}`);\n  }\n\n  /**\n   * Remove a provider from the system\n   */\n  public removeProvider(providerName: string): boolean {\n    const index = this.providers.findIndex(p => p.name === providerName);\n    if (index !== -1) {\n      this.providers.splice(index, 1);\n      console.log(`Removed provider: ${providerName}`);\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Simple sleep utility\n   */\n  private sleep(ms: number): Promise<void> {\n    return new Promise(resolve => setTimeout(resolve, ms));\n  }\n\n  /**\n   * Get recommended provider for next request (for load balancing)\n   */\n  public getRecommendedProvider(): AIProvider | null {\n    const available = this.getAvailableProviders();\n    if (available.length === 0) return null;\n    \n    // For now, just return the highest priority available provider\n    // In the future, could implement more sophisticated load balancing\n    return available[0];\n  }\n}\n\n// Singleton instance\nexport const aiManager = new AIManager();","size_bytes":83536},"client/src/components/app-header.tsx":{"content":"import { History, LogOut, User, ChevronDown, ChevronUp } from \"lucide-react\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport type { User as UserType } from \"@shared/schema\";\nimport platemateLogo from \"@/assets/platemate-logo.png\";\nimport { useState, useRef, useEffect } from \"react\";\nimport { launchSignup, launchLogin } from \"@/lib/auth-launcher\";\n\nexport function AppHeader() {\n  const { user, isAuthenticated } = useAuth();\n  const [showProfile, setShowProfile] = useState(false);\n  const profileRef = useRef<HTMLDivElement>(null);\n\n  // Close dropdown when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (profileRef.current && !profileRef.current.contains(event.target as Node)) {\n        setShowProfile(false);\n      }\n    };\n\n    if (showProfile) {\n      document.addEventListener('mousedown', handleClickOutside);\n    }\n\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [showProfile]);\n\n  return (\n    <header className=\"modern-card glass-enhanced border-b border-border/50 p-4 backdrop-blur-md sticky top-0 z-50\">\n      <div className=\"max-w-md mx-auto flex items-center justify-between\">\n        <div className=\"flex items-center space-x-3\">\n          <div className=\"w-12 h-12 rounded-xl overflow-hidden shadow-lg\">\n            <img \n              src={platemateLogo} \n              alt=\"PlateMate Logo\" \n              className=\"w-full h-full object-contain\"\n              data-testid=\"logo-platemate\"\n            />\n          </div>\n          <div className=\"flex flex-col\">\n            <h1 className=\"text-2xl font-bold gradient-text\">PlateMate</h1>\n            <p className=\"text-xs text-muted-foreground\">Voice-powered nutrition companion</p>\n          </div>\n        </div>\n        <div className=\"flex items-center space-x-2\">\n          {!isAuthenticated && (\n            <div className=\"flex items-center space-x-2\">\n              <button \n                className=\"p-2 px-4 rounded-xl bg-gradient-to-br from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-medium text-sm backdrop-blur-sm hover:scale-105 smooth-transition border border-blue-400/30 shadow-md\"\n                data-testid=\"button-login\"\n                aria-label=\"Sign in with Replit\"\n                title=\"Sign in with Replit\"\n                onClick={launchLogin}\n              >\n                Sign In\n              </button>\n              <button \n                className=\"p-2 px-4 rounded-xl bg-gradient-to-br from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-medium text-sm backdrop-blur-sm hover:scale-105 smooth-transition border border-green-400/30 shadow-md\"\n                data-testid=\"button-signup\"\n                aria-label=\"Create a Replit account\"\n                title=\"Create a Replit account\"\n                onClick={launchSignup}\n              >\n                Sign Up\n              </button>\n            </div>\n          )}\n          {isAuthenticated && user && (\n            <div className=\"relative mr-2\" ref={profileRef}>\n              <button\n                onClick={() => setShowProfile(!showProfile)}\n                className=\"flex items-center space-x-1 p-3 rounded-xl bg-gradient-to-br from-white/10 to-white/5 dark:from-gray-800/50 dark:to-gray-700/30 backdrop-blur-sm hover:scale-110 smooth-transition border border-white/10 dark:border-gray-700/30\"\n                data-testid=\"button-profile\"\n                aria-label={showProfile ? \"Close profile menu\" : \"Open profile menu\"}\n                aria-expanded={showProfile}\n                aria-haspopup=\"true\"\n                title=\"Profile\"\n              >\n                <User className=\"h-5 w-5 text-foreground/80\" aria-hidden=\"true\" />\n                {showProfile ? (\n                  <ChevronUp className=\"h-3 w-3 text-foreground/60\" aria-hidden=\"true\" />\n                ) : (\n                  <ChevronDown className=\"h-3 w-3 text-foreground/60\" aria-hidden=\"true\" />\n                )}\n              </button>\n              \n              {showProfile && (\n                <div \n                  className=\"absolute top-full right-0 mt-2 bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 p-3 min-w-[200px] backdrop-blur-md z-50\"\n                  role=\"menu\"\n                  aria-label=\"User profile information\"\n                >\n                  <div className=\"flex items-center space-x-2\">\n                    <User className=\"h-4 w-4 text-foreground/80\" aria-hidden=\"true\" />\n                    <span className=\"text-sm font-medium text-foreground/90\">\n                      {(user as UserType)?.firstName || (user as UserType)?.email || 'User'}\n                    </span>\n                  </div>\n                  {(user as UserType)?.email && (user as UserType)?.firstName && (\n                    <div className=\"text-xs text-foreground/60 mt-1 ml-6\">\n                      {(user as UserType)?.email}\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n          )}\n          <button \n            className=\"p-3 rounded-xl bg-gradient-to-br from-white/10 to-white/5 dark:from-gray-800/50 dark:to-gray-700/30 backdrop-blur-sm hover:scale-110 smooth-transition border border-white/10 dark:border-gray-700/30\"\n            data-testid=\"button-history\"\n            aria-label=\"View history\"\n            title=\"View History\"\n          >\n            <History className=\"h-5 w-5 text-foreground/80\" aria-hidden=\"true\" />\n          </button>\n          {isAuthenticated && (\n            <button \n              className=\"p-3 rounded-xl bg-gradient-to-br from-red-100/50 to-red-200/30 dark:from-red-900/20 dark:to-red-800/10 backdrop-blur-sm hover:scale-110 smooth-transition border border-red-200/30 dark:border-red-700/20 hover:from-red-200/70 hover:to-red-300/50\"\n              data-testid=\"button-logout\"\n              aria-label=\"Logout from PlateMate\"\n              title=\"Logout\"\n              onClick={() => {\n                localStorage.removeItem('auth_token');\n                localStorage.removeItem('auth_user');\n                window.location.href = '/landing';\n              }}\n            >\n              <LogOut className=\"h-5 w-5 text-red-600 dark:text-red-400\" aria-hidden=\"true\" />\n            </button>\n          )}\n        </div>\n      </div>\n    </header>\n  );\n}","size_bytes":6448},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","size_bytes":1858},"client/src/components/processing-state.tsx":{"content":"import { Brain } from \"lucide-react\";\nimport { motion } from \"framer-motion\";\n\nexport function ProcessingState() {\n  return (\n    <div className=\"p-6 text-center\">\n      <motion.div \n        className=\"bg-card rounded-xl shadow-lg p-8\"\n        initial={{ scale: 0.95, opacity: 0 }}\n        animate={{ scale: 1, opacity: 1 }}\n        transition={{ duration: 0.3 }}\n      >\n        <div className=\"relative w-16 h-16 mx-auto mb-4\">\n          {/* Animated pulse rings */}\n          <motion.div\n            className=\"absolute inset-0 rounded-full bg-purple-500/30\"\n            animate={{\n              scale: [1, 1.5, 1],\n              opacity: [0.5, 0, 0.5],\n            }}\n            transition={{\n              duration: 2,\n              repeat: Infinity,\n              ease: \"easeInOut\",\n            }}\n          />\n          <motion.div\n            className=\"absolute inset-0 rounded-full bg-orange-500/30\"\n            animate={{\n              scale: [1, 1.5, 1],\n              opacity: [0.5, 0, 0.5],\n            }}\n            transition={{\n              duration: 2,\n              repeat: Infinity,\n              ease: \"easeInOut\",\n              delay: 0.5,\n            }}\n          />\n          \n          {/* Brain icon */}\n          <motion.div \n            className=\"absolute inset-0 bg-gradient-to-br from-purple-500/20 to-orange-500/20 rounded-full flex items-center justify-center\"\n            animate={{ rotate: [0, 10, -10, 0] }}\n            transition={{\n              duration: 3,\n              repeat: Infinity,\n              ease: \"easeInOut\",\n            }}\n          >\n            <Brain className=\"text-purple-600 h-8 w-8\" />\n          </motion.div>\n        </div>\n\n        <motion.h3 \n          className=\"text-lg font-semibold mb-2\" \n          data-testid=\"text-processing-title\"\n          initial={{ y: 10, opacity: 0 }}\n          animate={{ y: 0, opacity: 1 }}\n          transition={{ delay: 0.2 }}\n        >\n          Analyzing your meal...\n        </motion.h3>\n        \n        <motion.p \n          className=\"text-muted-foreground mb-4\" \n          data-testid=\"text-processing-description\"\n          initial={{ y: 10, opacity: 0 }}\n          animate={{ y: 0, opacity: 1 }}\n          transition={{ delay: 0.3 }}\n        >\n          Our AI is identifying food items and calculating nutrition\n        </motion.p>\n        \n        <div className=\"w-full bg-muted rounded-full h-2 mb-2 overflow-hidden\">\n          <motion.div \n            className=\"bg-gradient-to-r from-purple-500 to-orange-500 h-2 rounded-full\" \n            data-testid=\"progress-analysis\"\n            initial={{ width: '0%' }}\n            animate={{ width: '100%' }}\n            transition={{\n              duration: 3,\n              ease: \"easeInOut\",\n              repeat: Infinity,\n            }}\n          />\n        </div>\n        \n        <motion.p \n          className=\"text-sm text-muted-foreground\" \n          data-testid=\"text-processing-status\"\n          animate={{ opacity: [0.5, 1, 0.5] }}\n          transition={{\n            duration: 2,\n            repeat: Infinity,\n            ease: \"easeInOut\",\n          }}\n        >\n          Processing image...\n        </motion.p>\n      </motion.div>\n    </div>\n  );\n}\n","size_bytes":3221},"android/app/src/androidTest/java/com/getcapacitor/myapp/ExampleInstrumentedTest.java":{"content":"package com.getcapacitor.myapp;\n\nimport static org.junit.Assert.*;\n\nimport android.content.Context;\nimport androidx.test.ext.junit.runners.AndroidJUnit4;\nimport androidx.test.platform.app.InstrumentationRegistry;\nimport org.junit.Test;\nimport org.junit.runner.RunWith;\n\n/**\n * Instrumented test, which will execute on an Android device.\n *\n * @see <a href=\"http://d.android.com/tools/testing\">Testing documentation</a>\n */\n@RunWith(AndroidJUnit4.class)\npublic class ExampleInstrumentedTest {\n\n    @Test\n    public void useAppContext() throws Exception {\n        // Context of the app under test.\n        Context appContext = InstrumentationRegistry.getInstrumentation().getTargetContext();\n\n        assertEquals(\"com.getcapacitor.app\", appContext.getPackageName());\n    }\n}\n","size_bytes":774},"client/src/components/drinks-bar.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { soundService } from \"@/lib/sound-service\";\nimport { Button } from \"@/components/ui/button\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Droplets, Coffee, Wine, Plus, Check, GlassWater, Beer } from \"lucide-react\";\nimport type { InsertDrinkEntry } from \"@shared/schema\";\n\nconst drinkPresets = {\n  water: { name: \"Water\", calories: 0, caffeine: 0, sugar: 0, alcoholContent: 0, icon: GlassWater, defaultAmount: 250 },\n  coffee: { name: \"Coffee\", calories: 5, caffeine: 95, sugar: 0, alcoholContent: 0, icon: Coffee, defaultAmount: 240 },\n  tea: { name: \"Tea\", calories: 2, caffeine: 40, sugar: 0, alcoholContent: 0, icon: Coffee, defaultAmount: 240 },\n  juice: { name: \"Orange Juice\", calories: 112, caffeine: 0, sugar: 21, alcoholContent: 0, icon: Wine, defaultAmount: 240 },\n  soda: { name: \"Soda\", calories: 150, caffeine: 34, sugar: 39, alcoholContent: 0, icon: Wine, defaultAmount: 355 },\n  sports_drink: { name: \"Sports Drink\", calories: 80, caffeine: 0, sugar: 21, alcoholContent: 0, icon: Droplets, defaultAmount: 355 },\n  beer: { name: \"Beer\", calories: 150, caffeine: 0, sugar: 13, alcoholContent: 5, icon: Beer, defaultAmount: 355 },\n  wine: { name: \"Wine\", calories: 125, caffeine: 0, sugar: 4, alcoholContent: 12, icon: Wine, defaultAmount: 150 },\n  spirits: { name: \"Spirits\", calories: 97, caffeine: 0, sugar: 0, alcoholContent: 40, icon: Wine, defaultAmount: 44 },\n  cocktail: { name: \"Cocktail\", calories: 200, caffeine: 0, sugar: 15, alcoholContent: 15, icon: Wine, defaultAmount: 150 },\n  other: { name: \"Custom Drink\", calories: 0, caffeine: 0, sugar: 0, alcoholContent: 0, icon: Plus, defaultAmount: 250 }\n};\n\nexport function DrinksBar() {\n  const [selectedDrink, setSelectedDrink] = useState<string>(\"\");\n  const [customName, setCustomName] = useState(\"\");\n  const [amount, setAmount] = useState(\"\");\n  const [isExpanded, setIsExpanded] = useState(false);\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const { user, isAuthenticated, isLoading } = useAuth();\n\n  const addDrinkMutation = useMutation({\n    mutationFn: async (drink: InsertDrinkEntry) => {\n      await apiRequest('POST', '/api/drinks', drink);\n    },\n    onSuccess: () => {\n      soundService.playSuccess();\n      toast({\n        title: \"Drink Logged!\",\n        description: \"Your drink has been added to your records.\",\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/drinks'] });\n      // Reset form\n      setSelectedDrink(\"\");\n      setCustomName(\"\");\n      setAmount(\"\");\n      setIsExpanded(false);\n    },\n    onError: (error: Error) => {\n      soundService.playError();\n      toast({\n        title: \"Error\",\n        description: \"Failed to log drink. Please try again.\",\n        variant: \"destructive\",\n      });\n      console.error(\"Error logging drink:\", error);\n    },\n  });\n\n  const calculateAlcoholUnits = (amount: number, alcoholContent: number): number => {\n    // Formula: (amount in ml Ã— alcohol content %) / 1000 = units of alcohol\n    return Math.round((amount * alcoholContent) / 1000);\n  };\n\n  const handleQuickAdd = (drinkType: keyof typeof drinkPresets) => {\n    const preset = drinkPresets[drinkType];\n    const alcoholUnits = calculateAlcoholUnits(preset.defaultAmount, preset.alcoholContent);\n    \n    const drink: InsertDrinkEntry = {\n      userId: 'anonymous-user',\n      drinkName: preset.name,\n      drinkType,\n      amount: preset.defaultAmount,\n      calories: preset.calories,\n      caffeine: preset.caffeine,\n      sugar: preset.sugar,\n      alcoholContent: preset.alcoholContent,\n      alcoholUnits,\n      loggedAt: new Date().toISOString(),\n    };\n    addDrinkMutation.mutate(drink);\n  };\n\n  const handleCustomAdd = () => {\n    if (!selectedDrink || !amount) return;\n    \n    const preset = drinkPresets[selectedDrink as keyof typeof drinkPresets];\n    const amountNum = parseInt(amount);\n    \n    // Calculate nutrition values based on amount ratio\n    const ratio = amountNum / preset.defaultAmount;\n    const alcoholUnits = calculateAlcoholUnits(amountNum, preset.alcoholContent);\n    \n    const drink: InsertDrinkEntry = {\n      userId: 'anonymous-user',\n      drinkName: selectedDrink === 'other' ? customName : preset.name,\n      drinkType: selectedDrink as any,\n      amount: amountNum,\n      calories: Math.round(preset.calories * ratio),\n      caffeine: Math.round(preset.caffeine * ratio),\n      sugar: Math.round(preset.sugar * ratio),\n      alcoholContent: preset.alcoholContent,\n      alcoholUnits,\n      loggedAt: new Date().toISOString(),\n    };\n    \n    addDrinkMutation.mutate(drink);\n  };\n\n  if (!isExpanded) {\n    return (\n      <div className=\"mx-4 mb-4 bg-gradient-to-br from-slate-800 via-gray-800 to-slate-900 rounded-3xl p-6 shadow-2xl border border-slate-700/50\">\n        {/* Header */}\n        <div className=\"text-center mb-6\">\n          <div className=\"flex items-center justify-center space-x-3 mb-2\">\n            <div className=\"p-3 bg-gradient-to-br from-blue-500 to-cyan-500 rounded-2xl shadow-lg\">\n              <Droplets className=\"h-6 w-6 text-white\" />\n            </div>\n            <h3 className=\"text-white text-xl font-bold\">Quick Drinks</h3>\n          </div>\n          <p className=\"text-gray-300 text-sm\">Log your beverages instantly</p>\n        </div>\n\n        {/* Quick Drink Buttons */}\n        <div className=\"grid grid-cols-2 gap-4 mb-6\">\n          {/* Water */}\n          <button\n            onClick={() => handleQuickAdd('water')}\n            disabled={addDrinkMutation.isPending}\n            className=\"bg-gradient-to-br from-blue-600/90 to-cyan-600/90 hover:from-blue-500/90 hover:to-cyan-500/90 text-white p-4 rounded-2xl flex flex-col items-center justify-center space-y-2 transition-all duration-300 shadow-xl hover:scale-105 hover:shadow-blue-500/25 border border-blue-400/20 backdrop-blur-sm min-h-[80px]\"\n            data-testid=\"button-quick-water\"\n          >\n            <GlassWater className=\"h-7 w-7\" />\n            <span className=\"text-sm font-semibold\">Water</span>\n            <span className=\"text-xs opacity-75\">250ml</span>\n          </button>\n          \n          {/* Coffee */}\n          <button\n            onClick={() => handleQuickAdd('coffee')}\n            disabled={addDrinkMutation.isPending}\n            className=\"bg-gradient-to-br from-amber-600/90 to-orange-600/90 hover:from-amber-500/90 hover:to-orange-500/90 text-white p-4 rounded-2xl flex flex-col items-center justify-center space-y-2 transition-all duration-300 shadow-xl hover:scale-105 hover:shadow-amber-500/25 border border-amber-400/20 backdrop-blur-sm min-h-[80px]\"\n            data-testid=\"button-quick-coffee\"\n          >\n            <Coffee className=\"h-7 w-7\" />\n            <span className=\"text-sm font-semibold\">Coffee</span>\n            <span className=\"text-xs opacity-75\">240ml</span>\n          </button>\n          \n          {/* Beer */}\n          <button\n            onClick={() => handleQuickAdd('beer')}\n            disabled={addDrinkMutation.isPending}\n            className=\"bg-gradient-to-br from-yellow-600/90 to-amber-600/90 hover:from-yellow-500/90 hover:to-amber-500/90 text-white p-4 rounded-2xl flex flex-col items-center justify-center space-y-2 transition-all duration-300 shadow-xl hover:scale-105 hover:shadow-yellow-500/25 border border-yellow-400/20 backdrop-blur-sm min-h-[80px]\"\n            data-testid=\"button-quick-beer\"\n          >\n            <Beer className=\"h-7 w-7\" />\n            <span className=\"text-sm font-semibold\">Beer</span>\n            <span className=\"text-xs opacity-75\">355ml</span>\n          </button>\n          \n          {/* Wine */}\n          <button\n            onClick={() => handleQuickAdd('wine')}\n            disabled={addDrinkMutation.isPending}\n            className=\"bg-gradient-to-br from-purple-600/90 to-pink-600/90 hover:from-purple-500/90 hover:to-pink-500/90 text-white p-4 rounded-2xl flex flex-col items-center justify-center space-y-2 transition-all duration-300 shadow-xl hover:scale-105 hover:shadow-purple-500/25 border border-purple-400/20 backdrop-blur-sm min-h-[80px]\"\n            data-testid=\"button-quick-wine\"\n          >\n            <Wine className=\"h-7 w-7\" />\n            <span className=\"text-sm font-semibold\">Wine</span>\n            <span className=\"text-xs opacity-75\">150ml</span>\n          </button>\n        </div>\n        \n        {/* More Options Button */}\n        <button\n          onClick={() => setIsExpanded(true)}\n          className=\"w-full bg-gradient-to-r from-slate-700/90 to-slate-800/90 hover:from-slate-600/90 hover:to-slate-700/90 text-white py-4 px-6 rounded-2xl font-semibold transition-all duration-300 shadow-xl hover:scale-[1.02] hover:shadow-slate-500/25 border border-white/10 backdrop-blur-xl flex items-center justify-center space-x-3\"\n          data-testid=\"button-more-drinks\"\n        >\n          <Plus className=\"h-5 w-5\" />\n          <span>More Drinks & Custom Amounts</span>\n        </button>\n      </div>\n    );\n  }\n\n  return (\n    <Card className=\"mx-4 mb-4 bg-gradient-to-br from-blue-50 to-cyan-50 dark:from-blue-950/50 dark:to-cyan-950/50 border-blue-200 dark:border-blue-800 shadow-lg\">\n      <CardHeader className=\"pb-4\">\n        <CardTitle className=\"flex items-center justify-between text-lg\">\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"p-2 bg-blue-500 rounded-full shadow-md\">\n              <Droplets className=\"h-5 w-5 text-white\" />\n            </div>\n            <span className=\"bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent font-bold\">Log a Drink</span>\n          </div>\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={() => setIsExpanded(false)}\n            className=\"hover:bg-red-100 dark:hover:bg-red-900/30 text-gray-500 hover:text-red-600 rounded-full h-8 w-8 p-0\"\n            data-testid=\"button-collapse-drinks\"\n          >\n            Ã—\n          </Button>\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-5\">\n        {/* Non-Alcoholic Drinks */}\n        <div>\n          <h4 className=\"font-semibold text-sm mb-3 text-blue-700 dark:text-blue-300 flex items-center space-x-2\">\n            <Droplets className=\"h-4 w-4\" />\n            <span>Non-Alcoholic</span>\n          </h4>\n          <div className=\"grid grid-cols-4 gap-2\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => handleQuickAdd('water')}\n              disabled={addDrinkMutation.isPending}\n              className=\"flex flex-col items-center space-y-1 h-16 bg-gradient-to-br from-blue-100 to-cyan-100 dark:from-blue-900/30 dark:to-cyan-900/30 border-blue-300 hover:from-blue-200 hover:to-cyan-200 hover:shadow-md transition-all duration-200 text-blue-700 dark:text-blue-300\"\n              data-testid=\"button-quick-water-expanded\"\n            >\n              <GlassWater className=\"h-4 w-4\" />\n              <span className=\"text-xs font-medium\">Water</span>\n            </Button>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => handleQuickAdd('coffee')}\n              disabled={addDrinkMutation.isPending}\n              className=\"flex flex-col items-center space-y-1 h-16 bg-gradient-to-br from-amber-100 to-orange-100 dark:from-amber-900/30 dark:to-orange-900/30 border-amber-300 hover:from-amber-200 hover:to-orange-200 hover:shadow-md transition-all duration-200 text-amber-700 dark:text-amber-300\"\n              data-testid=\"button-quick-coffee-expanded\"\n            >\n              <Coffee className=\"h-4 w-4\" />\n              <span className=\"text-xs font-medium\">Coffee</span>\n            </Button>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => handleQuickAdd('tea')}\n              disabled={addDrinkMutation.isPending}\n              className=\"flex flex-col items-center space-y-1 h-16 bg-gradient-to-br from-green-100 to-emerald-100 dark:from-green-900/30 dark:to-emerald-900/30 border-green-300 hover:from-green-200 hover:to-emerald-200 hover:shadow-md transition-all duration-200 text-green-700 dark:text-green-300\"\n              data-testid=\"button-quick-tea\"\n            >\n              <Coffee className=\"h-4 w-4\" />\n              <span className=\"text-xs font-medium\">Tea</span>\n            </Button>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => handleQuickAdd('soda')}\n              disabled={addDrinkMutation.isPending}\n              className=\"flex flex-col items-center space-y-1 h-16 bg-gradient-to-br from-red-100 to-pink-100 dark:from-red-900/30 dark:to-pink-900/30 border-red-300 hover:from-red-200 hover:to-pink-200 hover:shadow-md transition-all duration-200 text-red-700 dark:text-red-300\"\n              data-testid=\"button-quick-soda\"\n            >\n              <Wine className=\"h-4 w-4\" />\n              <span className=\"text-xs font-medium\">Soda</span>\n            </Button>\n          </div>\n        </div>\n\n        {/* Alcohol Section */}\n        <div className=\"bg-gradient-to-r from-amber-50 to-orange-50 dark:from-amber-950/50 dark:to-orange-950/50 rounded-lg p-4 border border-amber-200 dark:border-amber-800\">\n          <h4 className=\"font-semibold text-sm mb-3 text-amber-700 dark:text-amber-300 flex items-center space-x-2\">\n            <Wine className=\"h-4 w-4\" />\n            <span>Alcoholic Drinks</span>\n          </h4>\n          <div className=\"grid grid-cols-4 gap-2\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => handleQuickAdd('beer')}\n              disabled={addDrinkMutation.isPending}\n              className=\"flex flex-col items-center space-y-1 h-16 bg-gradient-to-br from-yellow-100 to-amber-100 dark:from-yellow-900/40 dark:to-amber-900/40 border-yellow-300 hover:from-yellow-200 hover:to-amber-200 hover:shadow-md transition-all duration-200 text-yellow-700 dark:text-yellow-300\"\n              data-testid=\"button-quick-beer-expanded\"\n            >\n              <Beer className=\"h-4 w-4\" />\n              <span className=\"text-xs font-medium\">Beer</span>\n            </Button>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => handleQuickAdd('wine')}\n              disabled={addDrinkMutation.isPending}\n              className=\"flex flex-col items-center space-y-1 h-16 bg-gradient-to-br from-purple-100 to-pink-100 dark:from-purple-900/40 dark:to-pink-900/40 border-purple-300 hover:from-purple-200 hover:to-pink-200 hover:shadow-md transition-all duration-200 text-purple-700 dark:text-purple-300\"\n              data-testid=\"button-quick-wine-expanded\"\n            >\n              <Wine className=\"h-4 w-4\" />\n              <span className=\"text-xs font-medium\">Wine</span>\n            </Button>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => handleQuickAdd('spirits')}\n              disabled={addDrinkMutation.isPending}\n              className=\"flex flex-col items-center space-y-1 h-16 bg-gradient-to-br from-red-100 to-rose-100 dark:from-red-900/40 dark:to-rose-900/40 border-red-300 hover:from-red-200 hover:to-rose-200 hover:shadow-md transition-all duration-200 text-red-700 dark:text-red-300\"\n              data-testid=\"button-quick-spirits\"\n            >\n              <Wine className=\"h-4 w-4\" />\n              <span className=\"text-xs font-medium\">Spirits</span>\n            </Button>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => handleQuickAdd('cocktail')}\n              disabled={addDrinkMutation.isPending}\n              className=\"flex flex-col items-center space-y-1 h-16 bg-gradient-to-br from-pink-100 to-rose-100 dark:from-pink-900/40 dark:to-rose-900/40 border-pink-300 hover:from-pink-200 hover:to-rose-200 hover:shadow-md transition-all duration-200 text-pink-700 dark:text-pink-300\"\n              data-testid=\"button-quick-cocktail\"\n            >\n              <Wine className=\"h-4 w-4\" />\n              <span className=\"text-xs font-medium\">Cocktail</span>\n            </Button>\n          </div>\n        </div>\n\n        {/* Custom drink form */}\n        <div className=\"bg-gradient-to-r from-slate-50 to-gray-50 dark:from-slate-950/50 dark:to-gray-950/50 rounded-lg p-4 border border-slate-200 dark:border-slate-800\">\n          <h4 className=\"font-semibold text-sm mb-4 text-slate-700 dark:text-slate-300 flex items-center space-x-2\">\n            <Plus className=\"h-4 w-4\" />\n            <span>Custom Amount & Type</span>\n          </h4>\n          <div className=\"grid grid-cols-2 gap-3 mb-3\">\n            <Select value={selectedDrink} onValueChange={setSelectedDrink}>\n              <SelectTrigger className=\"bg-white dark:bg-slate-900 border-slate-300 dark:border-slate-700 shadow-sm\" data-testid=\"select-drink-type\">\n                <SelectValue placeholder=\"Select drink\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"water\">ðŸ’§ Water</SelectItem>\n                <SelectItem value=\"coffee\">â˜• Coffee</SelectItem>\n                <SelectItem value=\"tea\">ðŸµ Tea</SelectItem>\n                <SelectItem value=\"juice\">ðŸ§ƒ Juice</SelectItem>\n                <SelectItem value=\"soda\">ðŸ¥¤ Soda</SelectItem>\n                <SelectItem value=\"sports_drink\">âš¡ Sports Drink</SelectItem>\n                <SelectItem value=\"beer\">ðŸº Beer</SelectItem>\n                <SelectItem value=\"wine\">ðŸ· Wine</SelectItem>\n                <SelectItem value=\"spirits\">ðŸ¥ƒ Spirits</SelectItem>\n                <SelectItem value=\"cocktail\">ðŸ¸ Cocktail</SelectItem>\n                <SelectItem value=\"other\">ðŸŽ¯ Other</SelectItem>\n              </SelectContent>\n            </Select>\n            <Input\n              type=\"number\"\n              placeholder=\"Amount (ml)\"\n              value={amount}\n              onChange={(e) => setAmount(e.target.value)}\n              className=\"bg-white dark:bg-slate-900 border-slate-300 dark:border-slate-700 shadow-sm\"\n              data-testid=\"input-drink-amount\"\n            />\n          </div>\n          \n          {selectedDrink === 'other' && (\n            <div className=\"mb-3\">\n              <Input\n                placeholder=\"Enter drink name...\"\n                value={customName}\n                onChange={(e) => setCustomName(e.target.value)}\n                className=\"bg-white dark:bg-slate-900 border-slate-300 dark:border-slate-700 shadow-sm\"\n                data-testid=\"input-custom-drink-name\"\n              />\n            </div>\n          )}\n\n          <Button\n            onClick={handleCustomAdd}\n            disabled={!selectedDrink || !amount || addDrinkMutation.isPending || (selectedDrink === 'other' && !customName)}\n            className=\"w-full bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white shadow-md hover:shadow-lg transition-all duration-200\"\n            data-testid=\"button-log-custom-drink\"\n          >\n            {addDrinkMutation.isPending ? (\n              \"Logging...\"\n            ) : (\n              <>\n                <Check className=\"h-4 w-4 mr-2\" />\n                Log Custom Drink\n              </>\n            )}\n          </Button>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":19824},"client/src/components/weekly-analytics.tsx":{"content":"import React from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { format, subDays, startOfWeek, endOfWeek, eachDayOfInterval } from \"date-fns\";\nimport { TrendingUp, TrendingDown, Award, Calendar } from \"lucide-react\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Progress } from \"@/components/ui/progress\";\nimport type { DiaryEntryWithAnalysis, DrinkEntry, NutritionGoals } from \"@shared/schema\";\nimport { calculateDailyNutrition } from \"@/lib/nutrition-calculator\";\n\ninterface WeeklyAnalyticsProps {\n  goals: NutritionGoals | undefined;\n}\n\nexport function WeeklyAnalytics({ goals }: WeeklyAnalyticsProps) {\n  const { data: diaryEntries = [] } = useQuery<DiaryEntryWithAnalysis[]>({\n    queryKey: ['/api/diary'],\n  });\n\n  const { data: drinkEntries = [] } = useQuery<DrinkEntry[]>({\n    queryKey: ['/api/drinks'],\n  });\n\n  // Calculate weekly nutrition data\n  const getWeeklyData = () => {\n    const now = new Date();\n    const weekStart = startOfWeek(now, { weekStartsOn: 1 }); // Monday start\n    const weekEnd = endOfWeek(now, { weekStartsOn: 1 });\n    const weekDays = eachDayOfInterval({ start: weekStart, end: weekEnd });\n\n    return weekDays.map(day => {\n      // Use standardized nutrition calculation function\n      const nutrition = calculateDailyNutrition(diaryEntries, drinkEntries, day);\n\n      return {\n        date: day,\n        nutrition,\n        goals: goals ? {\n          calories: goals.dailyCalories || 2000,\n          protein: goals.dailyProtein || 150,\n          carbs: goals.dailyCarbs || 250,\n          fat: goals.dailyFat || 65,\n          water: goals.dailyWater || 2000,\n        } : null,\n      };\n    });\n  };\n\n  const weeklyData = getWeeklyData();\n  \n  // Calculate weekly averages and achievements\n  const weeklyStats = React.useMemo(() => {\n    if (!goals || weeklyData.length === 0) return null;\n\n    const totals = weeklyData.reduce((acc, day) => ({\n      calories: acc.calories + day.nutrition.calories,\n      protein: acc.protein + day.nutrition.protein,\n      carbs: acc.carbs + day.nutrition.carbs,\n      fat: acc.fat + day.nutrition.fat,\n      water: acc.water + day.nutrition.water,\n    }), { calories: 0, protein: 0, carbs: 0, fat: 0, water: 0 });\n\n    const averages = {\n      calories: totals.calories / weeklyData.length,\n      protein: totals.protein / weeklyData.length,\n      carbs: totals.carbs / weeklyData.length,\n      fat: totals.fat / weeklyData.length,\n      water: totals.water / weeklyData.length,\n    };\n\n    const goalAchievements = weeklyData.map(day => ({\n      calories: day.goals ? (day.nutrition.calories / day.goals.calories) >= 0.9 : false,\n      protein: day.goals ? (day.nutrition.protein / day.goals.protein) >= 0.9 : false,\n      carbs: day.goals ? (day.nutrition.carbs / day.goals.carbs) >= 0.9 : false,\n      fat: day.goals ? (day.nutrition.fat / day.goals.fat) >= 0.9 : false,\n      water: day.goals ? (day.nutrition.water / day.goals.water) >= 0.9 : false,\n    }));\n\n    const achievementRates = {\n      calories: (goalAchievements.filter(day => day.calories).length / weeklyData.length) * 100,\n      protein: (goalAchievements.filter(day => day.protein).length / weeklyData.length) * 100,\n      carbs: (goalAchievements.filter(day => day.carbs).length / weeklyData.length) * 100,\n      fat: (goalAchievements.filter(day => day.fat).length / weeklyData.length) * 100,\n      water: (goalAchievements.filter(day => day.water).length / weeklyData.length) * 100,\n    };\n\n    return {\n      averages,\n      achievementRates,\n      totalGoalsAchieved: goalAchievements.reduce((total, day) => \n        total + (Object.values(day).filter(Boolean).length), 0\n      ),\n      daysTracked: weeklyData.filter(day => day.nutrition.calories > 0).length,\n    };\n  }, [weeklyData, goals]);\n\n  if (!goals || !weeklyStats) {\n    return (\n      <Card>\n        <CardContent className=\"p-6 text-center\">\n          <div className=\"text-muted-foreground\">\n            Set nutrition goals to see your weekly analytics\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center space-x-2\">\n            <Calendar className=\"h-5 w-5 text-primary\" />\n            <CardTitle className=\"text-lg\">This Week's Progress</CardTitle>\n          </div>\n          <CardDescription>\n            Your nutrition achievements for {format(weeklyData[0].date, 'MMM d')} - {format(weeklyData[6].date, 'MMM d')}\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          {/* Summary Stats */}\n          <div className=\"grid grid-cols-2 gap-4 text-center\">\n            <div className=\"space-y-1\">\n              <div className=\"text-2xl font-bold text-primary\" data-testid=\"days-tracked\">\n                {weeklyStats.daysTracked}\n              </div>\n              <div className=\"text-sm text-muted-foreground\">Days Tracked</div>\n            </div>\n            <div className=\"space-y-1\">\n              <div className=\"text-2xl font-bold text-green-600\" data-testid=\"goals-achieved\">\n                {weeklyStats.totalGoalsAchieved}\n              </div>\n              <div className=\"text-sm text-muted-foreground\">Goals Achieved</div>\n            </div>\n          </div>\n\n          {/* Achievement Rates */}\n          <div className=\"space-y-3\">\n            <h4 className=\"font-medium\">Goal Achievement Rates</h4>\n            {[\n              { key: 'calories', label: 'Calories', target: goals.dailyCalories },\n              { key: 'protein', label: 'Protein', target: goals.dailyProtein },\n              { key: 'carbs', label: 'Carbs', target: goals.dailyCarbs },\n              { key: 'fat', label: 'Fat', target: goals.dailyFat },\n              { key: 'water', label: 'Water', target: goals.dailyWater },\n            ].map(({ key, label, target }) => {\n              const rate = weeklyStats.achievementRates[key as keyof typeof weeklyStats.achievementRates];\n              const average = weeklyStats.averages[key as keyof typeof weeklyStats.averages];\n              \n              return (\n                <div key={key} className=\"space-y-2\" data-testid={`weekly-${key}`}>\n                  <div className=\"flex items-center justify-between text-sm\">\n                    <span className=\"font-medium\">{label}</span>\n                    <div className=\"flex items-center space-x-2\">\n                      <span className=\"text-muted-foreground\">\n                        {Math.round(average)} / {target} avg\n                      </span>\n                      {rate >= 80 ? (\n                        <TrendingUp className=\"h-4 w-4 text-green-600\" />\n                      ) : rate >= 50 ? (\n                        <TrendingUp className=\"h-4 w-4 text-yellow-600\" />\n                      ) : (\n                        <TrendingDown className=\"h-4 w-4 text-red-600\" />\n                      )}\n                    </div>\n                  </div>\n                  <Progress \n                    value={rate} \n                    className=\"h-2\"\n                    data-testid={`weekly-${key}-progress`}\n                  />\n                  <div className=\"flex justify-between text-xs text-muted-foreground\">\n                    <span>{Math.round(rate)}% of days on target</span>\n                    {rate >= 80 && (\n                      <span className=\"text-green-600 font-medium flex items-center space-x-1\">\n                        <Award className=\"h-3 w-3\" />\n                        <span>Great!</span>\n                      </span>\n                    )}\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Daily Overview */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"text-lg\">Daily Overview</CardTitle>\n          <CardDescription>Quick view of this week's daily progress</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid grid-cols-7 gap-2\">\n            {weeklyData.map((day, index) => {\n              const isToday = day.date.toDateString() === new Date().toDateString();\n              const hasData = day.nutrition.calories > 0;\n              const calorieProgress = day.goals ? (day.nutrition.calories / day.goals.calories) * 100 : 0;\n              \n              return (\n                <div \n                  key={day.date.toISOString()} \n                  className={`text-center p-2 rounded-lg border ${\n                    isToday ? 'bg-primary/10 border-primary' : 'bg-card'\n                  }`}\n                  data-testid={`day-${index}`}\n                >\n                  <div className=\"text-xs font-medium\">\n                    {format(day.date, 'EEE')}\n                  </div>\n                  <div className=\"text-xs text-muted-foreground mb-1\">\n                    {format(day.date, 'd')}\n                  </div>\n                  <div className=\"w-6 h-6 mx-auto rounded-full border-2 flex items-center justify-center\">\n                    {hasData ? (\n                      <div \n                        className={`w-4 h-4 rounded-full ${\n                          calorieProgress >= 90 ? 'bg-green-500' :\n                          calorieProgress >= 70 ? 'bg-yellow-500' :\n                          calorieProgress > 0 ? 'bg-blue-500' : 'bg-gray-300'\n                        }`}\n                        title={`${Math.round(day.nutrition.calories)} calories`}\n                      />\n                    ) : (\n                      <div className=\"w-4 h-4 rounded-full bg-gray-200\" />\n                    )}\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n          <div className=\"mt-4 text-xs text-muted-foreground text-center\">\n            ðŸŸ¢ Goal achieved â€¢ ðŸŸ¡ Partial progress â€¢ ðŸ”µ Some progress â€¢ âšª No data\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":10036},"client/src/lib/image-compression.ts":{"content":"/**\n * Client-side image compression utility for fast AI analysis\n * Compresses images before upload to dramatically reduce latency\n */\n\nexport interface CompressionOptions {\n  maxWidth?: number;\n  maxHeight?: number;\n  quality?: number;\n  maxSizeKB?: number;\n}\n\nexport interface PreprocessingOptions {\n  enhanceContrast?: boolean;\n  blurBackground?: boolean;\n  centerCrop?: boolean;\n  contrastAmount?: number;\n  blurRadius?: number;\n  cropRatio?: number;\n}\n\nconst DEFAULT_OPTIONS: Required<CompressionOptions> = {\n  maxWidth: 800,\n  maxHeight: 800,\n  quality: 0.8,\n  maxSizeKB: 500\n};\n\n/**\n * Compresses an image file for fast upload and AI analysis\n * @param file The original image file\n * @param options Compression options\n * @returns Compressed image file\n */\nexport async function compressImage(\n  file: File,\n  options: CompressionOptions = {}\n): Promise<File> {\n  const opts = { ...DEFAULT_OPTIONS, ...options };\n\n  // Skip compression if file is already small enough\n  const fileSizeKB = file.size / 1024;\n  if (fileSizeKB <= opts.maxSizeKB) {\n    console.log('ðŸ“¦ Image already small enough, skipping compression:', {\n      size: `${fileSizeKB.toFixed(1)}KB`,\n      maxSize: `${opts.maxSizeKB}KB`\n    });\n    return file;\n  }\n\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n\n    reader.onload = (e) => {\n      const img = new Image();\n      \n      img.onload = () => {\n        try {\n          // Calculate new dimensions while maintaining aspect ratio\n          let { width, height } = img;\n          \n          if (width > opts.maxWidth || height > opts.maxHeight) {\n            const aspectRatio = width / height;\n            \n            if (width > height) {\n              width = opts.maxWidth;\n              height = width / aspectRatio;\n            } else {\n              height = opts.maxHeight;\n              width = height * aspectRatio;\n            }\n          }\n\n          // Create canvas for compression\n          const canvas = document.createElement('canvas');\n          canvas.width = width;\n          canvas.height = height;\n          \n          const ctx = canvas.getContext('2d');\n          if (!ctx) {\n            reject(new Error('Failed to get canvas context'));\n            return;\n          }\n\n          // Draw image with high quality\n          ctx.imageSmoothingEnabled = true;\n          ctx.imageSmoothingQuality = 'high';\n          ctx.drawImage(img, 0, 0, width, height);\n\n          // Determine output format (preserve PNG for transparency/detail)\n          const outputType = file.type === 'image/png' ? 'image/png' : 'image/jpeg';\n          \n          // Convert to blob with compression\n          canvas.toBlob(\n            (blob) => {\n              if (!blob) {\n                reject(new Error('Failed to compress image'));\n                return;\n              }\n\n              // Check if we need to compress more aggressively\n              const sizeKB = blob.size / 1024;\n              \n              if (sizeKB > opts.maxSizeKB && opts.quality > 0.6) {\n                // Recursively compress with lower quality (min 0.6 to preserve detail)\n                const newFile = new File([blob], file.name, { type: outputType });\n                compressImage(newFile, {\n                  ...opts,\n                  quality: opts.quality - 0.1\n                }).then(resolve).catch(reject);\n                return;\n              }\n\n              // Create compressed file\n              const compressedFile = new File([blob], file.name, {\n                type: outputType,\n                lastModified: Date.now(),\n              });\n\n              console.log('ðŸ“¦ Image compression:', {\n                originalSize: `${(file.size / 1024).toFixed(1)}KB`,\n                compressedSize: `${(compressedFile.size / 1024).toFixed(1)}KB`,\n                reduction: `${(((file.size - compressedFile.size) / file.size) * 100).toFixed(1)}%`,\n                dimensions: `${width}x${height}`,\n                format: outputType\n              });\n\n              resolve(compressedFile);\n            },\n            outputType,\n            opts.quality\n          );\n        } catch (error) {\n          reject(error);\n        }\n      };\n\n      img.onerror = () => reject(new Error('Failed to load image'));\n      img.src = e.target?.result as string;\n    };\n\n    reader.onerror = () => reject(new Error('Failed to read file'));\n    reader.readAsDataURL(file);\n  });\n}\n\n/**\n * Quick compression for immediate analysis (prioritizes speed over size)\n */\nexport async function quickCompress(file: File): Promise<File> {\n  return compressImage(file, {\n    maxWidth: 600,\n    maxHeight: 600,\n    quality: 0.75,\n    maxSizeKB: 300\n  });\n}\n\n/**\n * Preprocesses an image to enhance food recognition accuracy\n * Applies contrast enhancement, background blur, and center crop\n */\nexport async function preprocessImage(\n  file: File,\n  options: PreprocessingOptions = {}\n): Promise<File> {\n  const opts = {\n    enhanceContrast: true,\n    blurBackground: true,\n    centerCrop: false,\n    contrastAmount: 1.3,\n    blurRadius: 10,\n    cropRatio: 0.85,\n    ...options\n  };\n\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n\n    reader.onload = (e) => {\n      const img = new Image();\n      \n      img.onload = () => {\n        try {\n          const { width, height } = img;\n          \n          // Create canvas\n          const canvas = document.createElement('canvas');\n          let finalWidth = width;\n          let finalHeight = height;\n          \n          // Apply center crop if enabled\n          if (opts.centerCrop) {\n            const minDimension = Math.min(width, height);\n            finalWidth = finalHeight = Math.floor(minDimension * opts.cropRatio);\n          }\n          \n          canvas.width = finalWidth;\n          canvas.height = finalHeight;\n          \n          const ctx = canvas.getContext('2d', { willReadFrequently: true });\n          if (!ctx) {\n            reject(new Error('Failed to get canvas context'));\n            return;\n          }\n\n          // Calculate crop offset for centering\n          const offsetX = opts.centerCrop ? (width - finalWidth) / 2 : 0;\n          const offsetY = opts.centerCrop ? (height - finalHeight) / 2 : 0;\n\n          // Draw base image (cropped if needed)\n          if (opts.centerCrop) {\n            ctx.drawImage(\n              img,\n              offsetX, offsetY, finalWidth, finalHeight,\n              0, 0, finalWidth, finalHeight\n            );\n          } else {\n            ctx.drawImage(img, 0, 0, width, height);\n          }\n\n          // Apply background blur effect (center sharp, edges blurred)\n          if (opts.blurBackground) {\n            // Save original sharp image\n            const sharpCanvas = document.createElement('canvas');\n            sharpCanvas.width = finalWidth;\n            sharpCanvas.height = finalHeight;\n            const sharpCtx = sharpCanvas.getContext('2d');\n            \n            if (sharpCtx) {\n              sharpCtx.drawImage(canvas, 0, 0);\n              \n              // Apply blur to main canvas\n              ctx.filter = `blur(${opts.blurRadius}px)`;\n              ctx.drawImage(canvas, 0, 0);\n              ctx.filter = 'none';\n              \n              // Create radial gradient mask (center sharp at 1, edges blurred at 0)\n              const centerX = finalWidth / 2;\n              const centerY = finalHeight / 2;\n              const radius = Math.min(finalWidth, finalHeight) * 0.45;\n              \n              const maskCanvas = document.createElement('canvas');\n              maskCanvas.width = finalWidth;\n              maskCanvas.height = finalHeight;\n              const maskCtx = maskCanvas.getContext('2d');\n              \n              if (maskCtx) {\n                const gradient = maskCtx.createRadialGradient(\n                  centerX, centerY, radius * 0.4,\n                  centerX, centerY, radius\n                );\n                gradient.addColorStop(0, 'rgba(0,0,0,1)');\n                gradient.addColorStop(1, 'rgba(0,0,0,0)');\n                \n                maskCtx.fillStyle = gradient;\n                maskCtx.fillRect(0, 0, finalWidth, finalHeight);\n                \n                // Composite sharp center over blurred background using mask\n                sharpCtx.globalCompositeOperation = 'destination-in';\n                sharpCtx.drawImage(maskCanvas, 0, 0);\n                \n                // Draw masked sharp image over blurred background\n                ctx.globalCompositeOperation = 'source-over';\n                ctx.drawImage(sharpCanvas, 0, 0);\n              }\n            }\n          }\n\n          // Apply contrast enhancement\n          if (opts.enhanceContrast) {\n            const imageData = ctx.getImageData(0, 0, finalWidth, finalHeight);\n            const data = imageData.data;\n            const factor = (259 * (opts.contrastAmount * 100 + 255)) / (255 * (259 - opts.contrastAmount * 100));\n            \n            for (let i = 0; i < data.length; i += 4) {\n              data[i] = Math.min(255, Math.max(0, factor * (data[i] - 128) + 128));     // R\n              data[i + 1] = Math.min(255, Math.max(0, factor * (data[i + 1] - 128) + 128)); // G\n              data[i + 2] = Math.min(255, Math.max(0, factor * (data[i + 2] - 128) + 128)); // B\n            }\n            \n            ctx.putImageData(imageData, 0, 0);\n          }\n\n          // Convert to blob\n          const outputType = file.type === 'image/png' ? 'image/png' : 'image/jpeg';\n          canvas.toBlob(\n            (blob) => {\n              if (!blob) {\n                reject(new Error('Failed to preprocess image'));\n                return;\n              }\n\n              const processedFile = new File([blob], file.name, {\n                type: outputType,\n                lastModified: Date.now(),\n              });\n\n              console.log('ðŸŽ¨ Image preprocessing:', {\n                originalSize: `${(file.size / 1024).toFixed(1)}KB`,\n                processedSize: `${(processedFile.size / 1024).toFixed(1)}KB`,\n                dimensions: `${finalWidth}x${finalHeight}`,\n                contrast: opts.enhanceContrast,\n                blur: opts.blurBackground,\n                crop: opts.centerCrop\n              });\n\n              resolve(processedFile);\n            },\n            outputType,\n            0.92\n          );\n        } catch (error) {\n          reject(error);\n        }\n      };\n\n      img.onerror = () => reject(new Error('Failed to load image'));\n      img.src = e.target?.result as string;\n    };\n\n    reader.onerror = () => reject(new Error('Failed to read file'));\n    reader.readAsDataURL(file);\n  });\n}\n\n/**\n * Combined preprocessing and compression for optimal AI analysis\n */\nexport async function preprocessAndCompress(\n  file: File,\n  preprocessOpts?: PreprocessingOptions,\n  compressOpts?: CompressionOptions\n): Promise<File> {\n  // First preprocess to enhance image quality\n  const preprocessed = await preprocessImage(file, preprocessOpts);\n  \n  // Then compress for fast upload\n  return compressImage(preprocessed, compressOpts);\n}\n","size_bytes":11122},"ios/App/App/public/assets/web-B2h_UMIc.js":{"content":"import{W as w}from\"./index-BfQ6GJWf.js\";class y extends w{async getId(){return{identifier:this.getUid()}}async getInfo(){if(typeof navigator>\"u\"||!navigator.userAgent)throw this.unavailable(\"Device API not available in this browser\");const e=navigator.userAgent,i=this.parseUa(e);return{model:i.model,platform:\"web\",operatingSystem:i.operatingSystem,osVersion:i.osVersion,manufacturer:navigator.vendor,isVirtual:!1,webViewVersion:i.browserVersion}}async getBatteryInfo(){if(typeof navigator>\"u\"||!navigator.getBattery)throw this.unavailable(\"Device API not available in this browser\");let e={};try{e=await navigator.getBattery()}catch{}return{batteryLevel:e.level,isCharging:e.charging}}async getLanguageCode(){return{value:navigator.language.split(\"-\")[0].toLowerCase()}}async getLanguageTag(){return{value:navigator.language}}parseUa(e){const i={},r=e.indexOf(\"(\")+1;let a=e.indexOf(\") AppleWebKit\");e.indexOf(\") Gecko\")!==-1&&(a=e.indexOf(\") Gecko\"));const s=e.substring(r,a);if(e.indexOf(\"Android\")!==-1){const t=s.replace(\"; wv\",\"\").split(\"; \").pop();t&&(i.model=t.split(\" Build\")[0]),i.osVersion=s.split(\"; \")[1]}else if(i.model=s.split(\"; \")[0],typeof navigator<\"u\"&&navigator.oscpu)i.osVersion=navigator.oscpu;else if(e.indexOf(\"Windows\")!==-1)i.osVersion=s;else{const t=s.split(\"; \").pop();if(t){const n=t.replace(\" like Mac OS X\",\"\").split(\" \");i.osVersion=n[n.length-1].replace(/_/g,\".\")}}/android/i.test(e)?i.operatingSystem=\"android\":/iPad|iPhone|iPod/.test(e)&&!window.MSStream?i.operatingSystem=\"ios\":/Win/.test(e)?i.operatingSystem=\"windows\":/Mac/i.test(e)?i.operatingSystem=\"mac\":i.operatingSystem=\"unknown\";const l=!!window.ApplePaySession,x=!!window.chrome,p=/Firefox/.test(e),d=/Edg/.test(e),g=/FxiOS/.test(e),c=/CriOS/.test(e),f=/EdgiOS/.test(e);if(l||x&&!d||g||c||f){let t;g?t=\"FxiOS\":c?t=\"CriOS\":f?t=\"EdgiOS\":l?t=\"Version\":t=\"Chrome\";const n=e.split(\" \");for(const o of n)if(o.includes(t)){const v=o.split(\"/\")[1];i.browserVersion=v}}else if(p||d){const o=e.split(\"\").reverse().join(\"\").split(\"/\")[0].split(\"\").reverse().join(\"\");i.browserVersion=o}return i}getUid(){if(typeof window<\"u\"&&window.localStorage){let e=window.localStorage.getItem(\"_capuid\");return e||(e=this.uuid4(),window.localStorage.setItem(\"_capuid\",e),e)}return this.uuid4()}uuid4(){return\"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g,function(e){const i=Math.random()*16|0;return(e===\"x\"?i:i&3|8).toString(16)})}}export{y as DeviceWeb};\n","size_bytes":2440},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","size_bytes":756},"client/src/pages/CalculatorTestPage.tsx":{"content":"import { ComprehensiveCalculatorTest } from '@/components/comprehensive-calculator-test';\n\nexport default function CalculatorTestPage() {\n  return (\n    <div className=\"min-h-screen text-foreground p-4\" style={{background: 'var(--bg-gradient)'}}>\n      <div className=\"max-w-6xl mx-auto\">\n        <div className=\"text-center mb-8\">\n          <h1 className=\"text-3xl font-bold text-gray-900 dark:text-white mb-2\">\n            Comprehensive Calculator Verification\n          </h1>\n          <p className=\"text-lg text-gray-600 dark:text-gray-300\">\n            End-to-end testing of calculation logic, macro validation, medication adjustments, and live calculator verification\n          </p>\n        </div>\n        \n        <ComprehensiveCalculatorTest />\n      </div>\n    </div>\n  );\n}","size_bytes":783},"shared/schema.ts":{"content":"import { sql } from \"drizzle-orm\";\nimport { pgTable, text, varchar, jsonb, timestamp, integer, index } from \"drizzle-orm/pg-core\";\nimport { relations } from \"drizzle-orm\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\n// Session storage table for authentication\nexport const sessions = pgTable(\n  \"sessions\",\n  {\n    sid: varchar(\"sid\").primaryKey(),\n    sess: jsonb(\"sess\").notNull(),\n    expire: timestamp(\"expire\").notNull(),\n  },\n  (table) => [index(\"IDX_session_expire\").on(table.expire)],\n);\n\n// User storage table for authentication\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: varchar(\"email\").unique(),\n  passwordHash: varchar(\"password_hash\"), // For email/password authentication\n  firstName: varchar(\"first_name\"),\n  lastName: varchar(\"last_name\"),\n  profileImageUrl: varchar(\"profile_image_url\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// User profile table for physical stats and goals\nexport const userProfiles = pgTable(\"user_profiles\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().unique().references(() => users.id),\n  age: integer(\"age\"),\n  sex: varchar(\"sex\"), // 'male' or 'female'\n  heightCm: integer(\"height_cm\"), // height in centimeters\n  currentWeightKg: integer(\"current_weight_kg\"), // current weight in kg\n  goalWeightKg: integer(\"goal_weight_kg\"), // goal weight in kg\n  activityLevel: varchar(\"activity_level\"), // sedentary, lightly_active, moderately_active, very_active, extra_active\n  weightGoal: varchar(\"weight_goal\"), // lose_weight, maintain_weight, gain_weight\n  weeklyWeightChangeKg: integer(\"weekly_weight_change_kg\"), // target kg per week (can be negative for loss)\n  medication: varchar(\"medication\"), // weight loss medication if any\n  // AI Coach personalization fields\n  name: text(\"name\"), // user's full name\n  nickname: text(\"nickname\"), // preferred name for AI Coach to use\n  dietaryRequirements: text(\"dietary_requirements\").array(), // vegetarian, vegan, keto, paleo, etc.\n  allergies: text(\"allergies\").array(), // nuts, dairy, gluten, shellfish, etc.\n  foodDislikes: text(\"food_dislikes\"), // foods user doesn't like\n  healthConditions: text(\"health_conditions\"), // diabetes, hypertension, etc.\n  // Shift pattern fields for frontline workers\n  defaultShiftType: varchar(\"default_shift_type\"), // regular, early_shift, late_shift, night_shift, long_shift, custom\n  customShiftStart: varchar(\"custom_shift_start\"), // HH:MM format for custom shifts\n  customShiftEnd: varchar(\"custom_shift_end\"), // HH:MM format for custom shifts\n  customBreakWindows: text(\"custom_break_windows\").array(), // Array of HH:MM times for breaks\n  enableDailyShiftCheckIn: integer(\"enable_daily_shift_check_in\").default(0), // 0 = disabled, 1 = enabled\n  todayShiftType: varchar(\"today_shift_type\"), // Override for today's shift\n  todayShiftDate: varchar(\"today_shift_date\"), // Date string (YYYY-MM-DD) for today's override\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const nutritionGoals = pgTable(\"nutrition_goals\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().unique().references(() => users.id),\n  dailyCalories: integer(\"daily_calories\").default(2000),\n  dailyProtein: integer(\"daily_protein\").default(150), // in grams\n  dailyCarbs: integer(\"daily_carbs\").default(250), // in grams\n  dailyFat: integer(\"daily_fat\").default(65), // in grams\n  dailyWater: integer(\"daily_water\").default(2500), // in ml (default 2500, adjusted based on health conditions)\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// Weekly shift schedule for advance meal planning\nexport const shiftSchedules = pgTable(\"shift_schedules\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  shiftDate: varchar(\"shift_date\").notNull(), // YYYY-MM-DD format\n  shiftType: varchar(\"shift_type\").notNull(), // day_off, regular, early_shift, late_shift, night_shift, long_shift, custom\n  customShiftStart: varchar(\"custom_shift_start\"), // HH:MM format for custom shifts\n  customShiftEnd: varchar(\"custom_shift_end\"), // HH:MM format for custom shifts\n  breakWindows: text(\"break_windows\").array(), // Array of HH:MM times for break windows\n  mealPlanGenerated: integer(\"meal_plan_generated\").default(0), // 0 = not generated, 1 = generated\n  mealPlanData: jsonb(\"meal_plan_data\"), // Stores AI-generated meal plan\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const foodAnalyses = pgTable(\"food_analyses\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  imageUrl: text(\"image_url\").notNull(),\n  confidence: integer(\"confidence\").notNull(), // 0-100\n  totalCalories: integer(\"total_calories\").notNull(),\n  totalProtein: integer(\"total_protein\").notNull(), // in grams (rounded)\n  totalCarbs: integer(\"total_carbs\").notNull(), // in grams (rounded)\n  totalFat: integer(\"total_fat\").notNull(), // in grams (rounded)\n  detectedFoods: jsonb(\"detected_foods\").notNull().$type<DetectedFood[]>(),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\n// Pending food confirmations for low confidence detections (<80%)\nexport const foodConfirmations = pgTable(\"food_confirmations\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  imageUrl: text(\"image_url\").notNull(),\n  originalConfidence: integer(\"original_confidence\").notNull(), // Original AI confidence (0-100)\n  suggestedFoods: jsonb(\"suggested_foods\").notNull().$type<DetectedFood[]>(), // AI's food suggestions\n  alternativeOptions: jsonb(\"alternative_options\").$type<DetectedFood[]>(), // Other USDA options for manual selection\n  status: varchar(\"status\").notNull().default(\"pending\"), // pending, confirmed, rejected\n  finalFoods: jsonb(\"final_foods\").$type<DetectedFood[]>(), // User-confirmed or modified foods\n  userFeedback: text(\"user_feedback\"), // Optional user feedback on why they changed the selection\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n  confirmedAt: timestamp(\"confirmed_at\"), // When user confirmed/rejected\n});\n\nexport const diaryEntries = pgTable(\"diary_entries\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  analysisId: varchar(\"analysis_id\").notNull().references(() => foodAnalyses.id),\n  mealType: varchar(\"meal_type\").notNull(), // breakfast, lunch, dinner, snack, custom\n  customMealName: text(\"custom_meal_name\"), // for custom meal types\n  mealDate: timestamp(\"meal_date\").notNull(), // when the meal was eaten\n  notes: text(\"notes\"), // optional user notes\n  portionMultiplier: integer(\"portion_multiplier\").default(100), // 100 = 1.0x serving (stored as integer percentage)\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const waterIntake = pgTable(\"water_intake\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  amountMl: integer(\"amount_ml\").notNull(), // fluid amount in ml\n  drinkType: varchar(\"drink_type\").notNull().default(\"water\"), // water, coffee, tea, wine, beer, custom\n  drinkName: varchar(\"drink_name\").notNull().default(\"Water\"), // display name for the drink\n  loggedAt: timestamp(\"logged_at\").notNull(), // when the fluid was consumed\n  loggedDate: varchar(\"logged_date\").notNull(), // YYYY-MM-DD format for easy querying\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const drinkEntries = pgTable(\"drink_entries\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  drinkName: varchar(\"drink_name\").notNull(),\n  drinkType: varchar(\"drink_type\").notNull(), // water, coffee, tea, juice, soda, etc.\n  amount: integer(\"amount\").notNull(), // in ml\n  calories: integer(\"calories\").default(0),\n  caffeine: integer(\"caffeine\").default(0), // in mg\n  sugar: integer(\"sugar\").default(0), // in grams\n  alcoholContent: integer(\"alcohol_content\").default(0), // alcohol by volume percentage (e.g., 5 for 5%)\n  alcoholUnits: integer(\"alcohol_units\").default(0), // calculated alcohol units (ml * abv / 1000)\n  loggedAt: timestamp(\"logged_at\").notNull(), // when the drink was consumed\n  notes: text(\"notes\"), // optional user notes\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const weightEntries = pgTable(\"weight_entries\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  weightGrams: integer(\"weight_grams\").notNull(), // weight in grams for decimal precision\n  loggedAt: timestamp(\"logged_at\").notNull(), // when the weight was recorded\n  notes: text(\"notes\"), // optional user notes\n  imageUrl: text(\"image_url\"), // optional progress photo\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const stepEntries = pgTable(\"step_entries\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  stepCount: integer(\"step_count\").notNull(), // total steps for the day\n  loggedDate: timestamp(\"logged_date\").notNull(), // date of step count (start of day)\n  source: varchar(\"source\").default(\"device\"), // 'device' for health API, 'manual' for user entry\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(), // updated when step count changes during the day\n});\n\n// Simple food entries for mobile app compatibility\nexport const simpleFoodEntries = pgTable(\"simple_food_entries\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  food: text(\"food\").notNull(), // food name/description\n  amount: text(\"amount\").notNull(), // amount with unit (e.g., \"8g\", \"1 cup\")\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const reflections = pgTable(\"reflections\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  reflectionPeriod: varchar(\"reflection_period\").notNull(), // 'daily' or 'weekly'\n  periodStart: timestamp(\"period_start\").notNull(), // start of the period being reflected on\n  periodEnd: timestamp(\"period_end\").notNull(), // end of the period being reflected on\n  wentWell: text(\"went_well\").notNull(), // what went well (AI generated)\n  couldImprove: text(\"could_improve\").notNull(), // what could improve (AI generated)\n  actionSteps: text(\"action_steps\").notNull().array(), // array of action items\n  sentimentScore: integer(\"sentiment_score\").notNull(), // 0-100, overall positivity\n  aiProvider: varchar(\"ai_provider\").notNull(), // 'openai' or 'gemini'\n  aiModel: varchar(\"ai_model\").notNull(), // specific model used\n  status: varchar(\"status\").notNull().default(\"final\"), // 'draft' or 'final'\n  sharedAt: timestamp(\"shared_at\"), // when shared to social media\n  shareChannel: varchar(\"share_channel\"), // 'facebook', 'twitter', etc.\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\n// Gamification: Predefined challenges\nexport const challenges = pgTable(\"challenges\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  challengeKey: varchar(\"challenge_key\").notNull().unique(), // unique identifier for code reference\n  name: varchar(\"name\").notNull(),\n  description: text(\"description\").notNull(),\n  challengeType: varchar(\"challenge_type\").notNull(), // 'streak', 'count', 'goal'\n  targetCount: integer(\"target_count\").notNull(), // target value to complete\n  rewardPoints: integer(\"reward_points\").notNull().default(10),\n  rewardBadge: varchar(\"reward_badge\"), // badge/emoji awarded\n  difficulty: varchar(\"difficulty\").notNull().default(\"medium\"), // 'easy', 'medium', 'hard'\n  isActive: integer(\"is_active\").notNull().default(1), // 1 = active, 0 = disabled\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\n// Gamification: User progress on challenges\nexport const userChallengeProgress = pgTable(\"user_challenge_progress\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  challengeId: varchar(\"challenge_id\").notNull().references(() => challenges.id),\n  currentCount: integer(\"current_count\").notNull().default(0),\n  isCompleted: integer(\"is_completed\").notNull().default(0), // 0 = in progress, 1 = completed\n  completedAt: timestamp(\"completed_at\"),\n  lastUpdatedAt: timestamp(\"last_updated_at\").notNull().defaultNow(),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\n// Saved Recipes: User's favorite recipes\nexport const savedRecipes = pgTable(\"saved_recipes\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  recipeId: varchar(\"recipe_id\").notNull(), // AI-generated recipe ID or external recipe ID\n  recipeName: varchar(\"recipe_name\").notNull(),\n  recipeData: jsonb(\"recipe_data\").notNull().$type<{\n    name: string;\n    description: string;\n    calories: number;\n    protein: number;\n    carbs: number;\n    fat: number;\n    servings: number;\n    prepTime: number;\n    cookTime: number;\n    difficulty: \"Easy\" | \"Medium\" | \"Hard\";\n    ingredients: string[];\n    instructions: string[];\n    tags: string[];\n    dietaryInfo: string[];\n    recipeLink?: string;\n  }>(),\n  savedAt: timestamp(\"saved_at\").notNull().defaultNow(),\n});\n\n// AI Coach Memory: Personalized companion memory system\nexport const aiCoachMemory = pgTable(\"ai_coach_memory\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().unique().references(() => users.id),\n  \n  // Personal Details\n  age: integer(\"age\"),\n  occupation: text(\"occupation\"),\n  lifestyleDetails: text(\"lifestyle_details\"), // night shifts, ex-military, nurse, etc.\n  \n  // Interests and Hobbies\n  interests: text(\"interests\").array(), // gym, football, mental health, music, cars, kids, gaming\n  \n  // AI Personality Configuration\n  selectedPersonality: varchar(\"selected_personality\").notNull().default(\"zen\"), // military, gym_bro, zen, clinical, dark_humour\n  motivationalStyle: varchar(\"motivational_style\").default(\"positive\"), // positive, tough_love, humour, inspirational\n  \n  // Goals Beyond Nutrition\n  fitnessGoals: text(\"fitness_goals\"), // strength, cardio, flexibility, etc.\n  stressGoals: text(\"stress_goals\"), // work-life balance, mindfulness, etc.\n  sleepGoals: text(\"sleep_goals\"), // better sleep quality, consistent schedule\n  mentalHealthGoals: text(\"mental_health_goals\"), // anxiety management, confidence building\n  \n  // Mood Tracking\n  recentMoods: jsonb(\"recent_moods\").$type<Array<{\n    date: string;\n    mood: string; // tired, stressed, motivated, excited, low, energized\n    sentiment: number; // -100 to 100\n  }>>().default([]),\n  \n  // Conversation Context\n  lastInteraction: timestamp(\"last_interaction\"),\n  conversationTopics: text(\"conversation_topics\").array(), // recent topics discussed\n  \n  // Additional Context\n  workSchedule: text(\"work_schedule\"), // day shifts, night shifts, rotating, etc.\n  exerciseFrequency: text(\"exercise_frequency\"), // daily, 3x week, weekend warrior\n  \n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(),\n});\n\n// Shopping List: User's shopping list items\nexport const shoppingListItems = pgTable(\"shopping_list_items\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  itemName: text(\"item_name\").notNull(),\n  checked: integer(\"checked\").notNull().default(0), // 0 = unchecked, 1 = checked\n  source: varchar(\"source\").notNull().default(\"custom\"), // 'custom' or 'recipe'\n  recipeId: varchar(\"recipe_id\"), // Reference to recipe if from recipe\n  recipeName: text(\"recipe_name\"), // Recipe name for display\n  quantity: text(\"quantity\"), // For recipe ingredients (e.g., \"2\", \"1/2\")\n  unit: text(\"unit\"), // For recipe ingredients (e.g., \"cups\", \"tbsp\")\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const DetectedFoodSchema = z.object({\n  name: z.string(),\n  portion: z.string(),\n  calories: z.number(),\n  protein: z.number(),\n  carbs: z.number(),\n  fat: z.number(),\n  icon: z.string(),\n});\n\nexport type DetectedFood = z.infer<typeof DetectedFoodSchema>;\n\nexport const insertFoodAnalysisSchema = createInsertSchema(foodAnalyses).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const updateFoodAnalysisSchema = z.object({\n  detectedFoods: z.array(DetectedFoodSchema).min(1, \"At least one food item is required\"),\n});\n\nexport type InsertFoodAnalysis = z.infer<typeof insertFoodAnalysisSchema> & {\n  isAITemporarilyUnavailable?: boolean;\n};\nexport type UpdateFoodAnalysis = z.infer<typeof updateFoodAnalysisSchema>;\nexport type FoodAnalysis = typeof foodAnalyses.$inferSelect & {\n  isAITemporarilyUnavailable?: boolean;\n};\n\nexport const insertDiaryEntrySchema = createInsertSchema(diaryEntries).omit({\n  id: true,\n  createdAt: true,\n}).extend({\n  mealType: z.enum([\"breakfast\", \"lunch\", \"dinner\", \"snack\", \"custom\"]),\n  mealDate: z.string().or(z.date()), // Accept string or Date\n  notes: z.string().optional(),\n  portionMultiplier: z.number().int().min(10).max(1000).default(100).optional(), // 100 = 1.0x serving\n});\n\nexport const updateDiaryEntrySchema = insertDiaryEntrySchema.partial().extend({\n  customMealName: z.string().optional(), // For custom meal types\n  portionMultiplier: z.number().int().min(10).max(1000).optional(), // 100 = 1.0x serving (10% to 10x)\n});\n\nexport const insertWaterIntakeSchema = createInsertSchema(waterIntake).omit({\n  id: true,\n  createdAt: true,\n}).extend({\n  loggedAt: z.string().or(z.date()), // Accept string or Date\n  loggedDate: z.string(), // YYYY-MM-DD format\n  drinkType: z.enum([\"water\", \"coffee\", \"tea\", \"wine\", \"beer\", \"custom\"]).default(\"water\"),\n  drinkName: z.string().default(\"Water\"),\n});\n\nexport const insertDrinkEntrySchema = createInsertSchema(drinkEntries).omit({\n  id: true,\n  createdAt: true,\n}).extend({\n  drinkType: z.enum([\"water\", \"coffee\", \"tea\", \"juice\", \"soda\", \"sports_drink\", \"beer\", \"wine\", \"spirits\", \"cocktail\", \"other\"]),\n  loggedAt: z.string().or(z.date()), // Accept string or Date\n  notes: z.string().optional(),\n});\n\nexport const insertNutritionGoalsSchema = createInsertSchema(nutritionGoals).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertShiftScheduleSchema = createInsertSchema(shiftSchedules).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n}).extend({\n  shiftDate: z.string(), // YYYY-MM-DD format\n  shiftType: z.enum([\"day_off\", \"regular\", \"early_shift\", \"late_shift\", \"night_shift\", \"long_shift\", \"custom\"]),\n  customShiftStart: z.string().nullable().optional(),\n  customShiftEnd: z.string().nullable().optional(),\n  breakWindows: z.array(z.string()).nullable().optional(),\n  mealPlanGenerated: z.number().int().min(0).max(1).default(0).optional(),\n  mealPlanData: z.any().optional(), // JSON data for meal plan\n});\n\nexport const updateShiftScheduleSchema = insertShiftScheduleSchema.partial().omit({\n  userId: true, // Cannot change user ownership\n});\n\nexport const insertUserProfileSchema = createInsertSchema(userProfiles).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n}).extend({\n  sex: z.enum([\"male\", \"female\"]).optional(),\n  activityLevel: z.enum([\"sedentary\", \"lightly_active\", \"moderately_active\", \"very_active\", \"extra_active\"]).optional(),\n  weightGoal: z.enum([\"lose_weight\", \"maintain_weight\", \"gain_weight\"]).optional(),\n  medication: z.enum([\"none\", \"ozempic\", \"wegovy\", \"mounjaro\", \"other_glp1\"]).optional(),\n  name: z.string().nullable().optional(),\n  nickname: z.string().nullable().optional(),\n  dietaryRequirements: z.array(z.string()).optional(),\n  allergies: z.array(z.string()).optional(),\n  foodDislikes: z.string().nullable().optional(),\n  healthConditions: z.string().nullable().optional(),\n  defaultShiftType: z.enum([\"regular\", \"early_shift\", \"late_shift\", \"night_shift\", \"long_shift\", \"custom\"]).optional(),\n  customShiftStart: z.string().nullable().optional(),\n  customShiftEnd: z.string().nullable().optional(),\n  customBreakWindows: z.array(z.string()).nullable().optional(),\n  enableDailyShiftCheckIn: z.number().int().min(0).max(1).optional(),\n  todayShiftType: z.enum([\"regular\", \"early_shift\", \"late_shift\", \"night_shift\", \"long_shift\", \"custom\", \"day_off\"]).optional(),\n  todayShiftDate: z.string().optional(),\n});\n\nexport type UpsertUser = typeof users.$inferInsert;\nexport type User = typeof users.$inferSelect;\nexport type InsertDiaryEntry = z.infer<typeof insertDiaryEntrySchema>;\nexport type UpdateDiaryEntry = z.infer<typeof updateDiaryEntrySchema>;\nexport type DiaryEntry = typeof diaryEntries.$inferSelect;\nexport type InsertWaterIntake = z.infer<typeof insertWaterIntakeSchema>;\nexport type WaterIntake = typeof waterIntake.$inferSelect;\nexport type InsertDrinkEntry = z.infer<typeof insertDrinkEntrySchema>;\nexport type DrinkEntry = typeof drinkEntries.$inferSelect;\nexport type InsertNutritionGoals = z.infer<typeof insertNutritionGoalsSchema>;\nexport type NutritionGoals = typeof nutritionGoals.$inferSelect;\nexport type InsertShiftSchedule = z.infer<typeof insertShiftScheduleSchema>;\nexport type UpdateShiftSchedule = z.infer<typeof updateShiftScheduleSchema>;\nexport type ShiftSchedule = typeof shiftSchedules.$inferSelect;\nexport type InsertUserProfile = z.infer<typeof insertUserProfileSchema>;\nexport type UserProfile = typeof userProfiles.$inferSelect;\n\nexport const insertWeightEntrySchema = createInsertSchema(weightEntries).omit({\n  id: true,\n  createdAt: true,\n}).extend({\n  loggedAt: z.string().or(z.date()), // Accept string or Date\n  notes: z.string().optional(),\n  imageUrl: z.string().nullable().optional(),\n});\n\nexport const updateWeightEntrySchema = insertWeightEntrySchema.partial().omit({\n  userId: true, // Cannot change user ownership\n});\n\nexport type InsertWeightEntry = z.infer<typeof insertWeightEntrySchema>;\nexport type WeightEntry = typeof weightEntries.$inferSelect;\n\nexport const insertStepEntrySchema = createInsertSchema(stepEntries).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n}).extend({\n  loggedDate: z.string().or(z.date()), // Accept string or Date\n  source: z.enum([\"device\", \"manual\"]).default(\"device\"),\n});\n\nexport const updateStepEntrySchema = insertStepEntrySchema.partial().omit({\n  userId: true, // Cannot change user ownership\n});\n\nexport type InsertStepEntry = z.infer<typeof insertStepEntrySchema>;\nexport type UpdateStepEntry = z.infer<typeof updateStepEntrySchema>;\nexport type StepEntry = typeof stepEntries.$inferSelect;\n\n// Food confirmation schemas for confidence threshold workflow\nexport const insertFoodConfirmationSchema = createInsertSchema(foodConfirmations).omit({\n  id: true,\n  createdAt: true,\n  confirmedAt: true,\n}).extend({\n  status: z.enum([\"pending\", \"confirmed\", \"rejected\"]).default(\"pending\"),\n  userFeedback: z.string().optional(),\n});\n\nexport const updateFoodConfirmationSchema = z.object({\n  status: z.enum([\"confirmed\", \"rejected\"]),\n  finalFoods: z.array(DetectedFoodSchema).min(1, \"At least one food item is required\"),\n  userFeedback: z.string().optional(),\n});\n\nexport type InsertFoodConfirmation = z.infer<typeof insertFoodConfirmationSchema>;\nexport type UpdateFoodConfirmation = z.infer<typeof updateFoodConfirmationSchema>;\nexport type FoodConfirmation = typeof foodConfirmations.$inferSelect;\n\n// Simple food entry schemas for mobile app compatibility\nexport const insertSimpleFoodEntrySchema = createInsertSchema(simpleFoodEntries).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type SimpleFoodEntry = typeof simpleFoodEntries.$inferSelect;\nexport type InsertSimpleFoodEntry = z.infer<typeof insertSimpleFoodEntrySchema>;\n\nexport const insertReflectionSchema = createInsertSchema(reflections).omit({\n  id: true,\n  createdAt: true,\n}).extend({\n  reflectionPeriod: z.enum([\"daily\", \"weekly\"]),\n  periodStart: z.string().or(z.date()),\n  periodEnd: z.string().or(z.date()),\n  status: z.enum([\"draft\", \"final\"]).default(\"final\"),\n  shareChannel: z.enum([\"facebook\", \"twitter\", \"instagram\"]).optional(),\n});\n\nexport type InsertReflection = z.infer<typeof insertReflectionSchema>;\nexport type Reflection = typeof reflections.$inferSelect;\n\n// Gamification schemas\nexport const insertChallengeSchema = createInsertSchema(challenges).omit({\n  id: true,\n  createdAt: true,\n}).extend({\n  challengeType: z.enum([\"streak\", \"count\", \"goal\"]),\n  difficulty: z.enum([\"easy\", \"medium\", \"hard\"]).default(\"medium\"),\n});\n\nexport const insertUserChallengeProgressSchema = createInsertSchema(userChallengeProgress).omit({\n  id: true,\n  createdAt: true,\n  lastUpdatedAt: true,\n});\n\nexport type InsertChallenge = z.infer<typeof insertChallengeSchema>;\nexport type Challenge = typeof challenges.$inferSelect;\nexport type InsertUserChallengeProgress = z.infer<typeof insertUserChallengeProgressSchema>;\nexport type UserChallengeProgress = typeof userChallengeProgress.$inferSelect;\n\n// Type for challenge with progress (for frontend display)\nexport type ChallengeWithProgress = Challenge & {\n  progress?: UserChallengeProgress;\n};\n\n// Saved recipes schemas\nexport const insertSavedRecipeSchema = createInsertSchema(savedRecipes).omit({\n  id: true,\n  savedAt: true,\n});\n\nexport type InsertSavedRecipe = z.infer<typeof insertSavedRecipeSchema>;\nexport type SavedRecipe = typeof savedRecipes.$inferSelect;\n\n// AI Coach Memory schemas\nexport const insertAiCoachMemorySchema = createInsertSchema(aiCoachMemory).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n}).extend({\n  selectedPersonality: z.enum([\"military\", \"gym_bro\", \"zen\", \"clinical\", \"dark_humour\"]).default(\"zen\"),\n  motivationalStyle: z.enum([\"positive\", \"tough_love\", \"humour\", \"inspirational\"]).optional(),\n  age: z.number().int().positive().optional(),\n  occupation: z.string().optional(),\n  lifestyleDetails: z.string().optional(),\n  interests: z.array(z.string()).optional(),\n  fitnessGoals: z.string().optional(),\n  stressGoals: z.string().optional(),\n  sleepGoals: z.string().optional(),\n  mentalHealthGoals: z.string().optional(),\n  workSchedule: z.string().optional(),\n  exerciseFrequency: z.string().optional(),\n  conversationTopics: z.array(z.string()).optional(),\n});\n\nexport const updateAiCoachMemorySchema = insertAiCoachMemorySchema.partial().omit({\n  userId: true,\n});\n\nexport type InsertAiCoachMemory = z.infer<typeof insertAiCoachMemorySchema>;\nexport type UpdateAiCoachMemory = z.infer<typeof updateAiCoachMemorySchema>;\nexport type AiCoachMemory = typeof aiCoachMemory.$inferSelect;\n\n// Shopping list schemas\nexport const insertShoppingListItemSchema = createInsertSchema(shoppingListItems).omit({\n  id: true,\n  createdAt: true,\n}).extend({\n  source: z.enum([\"custom\", \"recipe\"]).default(\"custom\"),\n  checked: z.number().int().min(0).max(1).default(0),\n});\n\nexport const updateShoppingListItemSchema = z.object({\n  itemName: z.string().optional(),\n  checked: z.number().int().min(0).max(1).optional(),\n  quantity: z.string().optional(),\n  unit: z.string().optional(),\n});\n\nexport type InsertShoppingListItem = z.infer<typeof insertShoppingListItemSchema>;\nexport type UpdateShoppingListItem = z.infer<typeof updateShoppingListItemSchema>;\nexport type ShoppingListItem = typeof shoppingListItems.$inferSelect;\n\n// Relations\nexport const usersRelations = relations(users, ({ many, one }) => ({\n  diaryEntries: many(diaryEntries),\n  drinkEntries: many(drinkEntries),\n  weightEntries: many(weightEntries),\n  stepEntries: many(stepEntries),\n  simpleFoodEntries: many(simpleFoodEntries),\n  reflections: many(reflections),\n  challengeProgress: many(userChallengeProgress),\n  shoppingListItems: many(shoppingListItems),\n  nutritionGoals: one(nutritionGoals),\n  profile: one(userProfiles),\n}));\n\nexport const userProfilesRelations = relations(userProfiles, ({ one }) => ({\n  user: one(users, {\n    fields: [userProfiles.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const nutritionGoalsRelations = relations(nutritionGoals, ({ one }) => ({\n  user: one(users, {\n    fields: [nutritionGoals.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const foodAnalysesRelations = relations(foodAnalyses, ({ many }) => ({\n  diaryEntries: many(diaryEntries),\n}));\n\nexport const diaryEntriesRelations = relations(diaryEntries, ({ one }) => ({\n  user: one(users, {\n    fields: [diaryEntries.userId],\n    references: [users.id],\n  }),\n  analysis: one(foodAnalyses, {\n    fields: [diaryEntries.analysisId],\n    references: [foodAnalyses.id],\n  }),\n}));\n\nexport const drinkEntriesRelations = relations(drinkEntries, ({ one }) => ({\n  user: one(users, {\n    fields: [drinkEntries.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const weightEntriesRelations = relations(weightEntries, ({ one }) => ({\n  user: one(users, {\n    fields: [weightEntries.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const stepEntriesRelations = relations(stepEntries, ({ one }) => ({\n  user: one(users, {\n    fields: [stepEntries.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const simpleFoodEntriesRelations = relations(simpleFoodEntries, ({ one }) => ({\n  user: one(users, {\n    fields: [simpleFoodEntries.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const reflectionsRelations = relations(reflections, ({ one }) => ({\n  user: one(users, {\n    fields: [reflections.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const challengesRelations = relations(challenges, ({ many }) => ({\n  userProgress: many(userChallengeProgress),\n}));\n\nexport const userChallengeProgressRelations = relations(userChallengeProgress, ({ one }) => ({\n  user: one(users, {\n    fields: [userChallengeProgress.userId],\n    references: [users.id],\n  }),\n  challenge: one(challenges, {\n    fields: [userChallengeProgress.challengeId],\n    references: [challenges.id],\n  }),\n}));\n\nexport const savedRecipesRelations = relations(savedRecipes, ({ one }) => ({\n  user: one(users, {\n    fields: [savedRecipes.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const shoppingListItemsRelations = relations(shoppingListItems, ({ one }) => ({\n  user: one(users, {\n    fields: [shoppingListItems.userId],\n    references: [users.id],\n  }),\n}));\n\n// Type with relations for frontend\nexport type DiaryEntryWithAnalysis = DiaryEntry & {\n  analysis: FoodAnalysis;\n};\n","size_bytes":31027},"server/ai-providers/openai-provider.ts":{"content":"import OpenAI from \"openai\";\nimport { promises as fs } from \"fs\";\nimport { AIProvider, FoodAnalysisResult, FoodDetectionResult, DietAdviceResult, DiaryEntry, ProviderError, DailyCoaching, EducationalTip, HealthCheckResult } from \"./types\";\nimport { mapUKFoodTerms } from \"../uk-food-mapping\";\n\nexport class OpenAIProvider extends AIProvider {\n  public readonly name = \"OpenAI\";\n  public readonly priority = 3; // Lowest priority (quota exceeded, emergency only)\n  public readonly maxRetries = 2;\n\n  private client: OpenAI;\n\n  constructor() {\n    super();\n    this.client = new OpenAI({\n      apiKey: process.env.OPENAI_API_KEY,\n    });\n  }\n\n  async performHealthCheck(): Promise<HealthCheckResult> {\n    const startTime = Date.now();\n    \n    try {\n      // Simple health check with a lightweight request\n      const response = await this.client.chat.completions.create({\n        model: \"gpt-4o-mini\",\n        messages: [{ role: \"user\", content: \"Health check\" }],\n        max_tokens: 5\n      });\n\n      const responseTime = Date.now() - startTime;\n      \n      return {\n        providerName: this.name,\n        healthy: true,\n        responseTime,\n        timestamp: new Date(),\n        details: {\n          model: \"gpt-4o-mini\",\n          apiVersion: \"1.0\"\n        }\n      };\n    } catch (error: any) {\n      const responseTime = Date.now() - startTime;\n      \n      return {\n        providerName: this.name,\n        healthy: false,\n        responseTime,\n        error: error.message,\n        timestamp: new Date()\n      };\n    }\n  }\n\n  async analyzeFoodImage(imagePath: string): Promise<FoodAnalysisResult> {\n    try {\n      // Convert image to base64\n      const imageBuffer = await fs.readFile(imagePath);\n      const base64Image = imageBuffer.toString('base64');\n      const mimeType = 'image/jpeg';\n\n      const response = await this.client.chat.completions.create({\n        model: \"gpt-4o-mini\",\n        messages: [\n          {\n            role: \"user\",\n            content: [\n              {\n                type: \"text\",\n                text: `Analyze this food image and identify all visible food items. \n\nIMPORTANT: Look for reference objects in the image to help estimate scale and portion sizes:\n- Plate, bowl, or dish (standard dinner plate = 10-12 inches)\n- Utensils (fork = 7 inches, spoon = 6 inches)\n- Hand or fingers for scale\n- Common objects like coins, phones, etc.\n\nPORTION ESTIMATION GUIDELINES - BE CONSERVATIVE AND REALISTIC:\n- Default to MEDIUM portions unless the image clearly shows otherwise\n- Don't over-estimate portion sizes or assume extra toppings you can't see\n- Explicitly state what toppings/ingredients you can actually see in the image\n- If in doubt about portion size, choose the smaller estimate\n\nCRITICAL UK FOOD PORTIONS WITH TYPICAL CALORIE RANGES:\n- Jacket potato (plain): Medium (200g) = ~150-180 cal | with butter (10g) add ~70 cal | with cheese (30g) add ~100 cal\n  * Only add toppings you can CLEARLY SEE in the image\n  * Jacket potato >600 cal is almost certainly wrong unless it's massive with lots of visible toppings\n- UK crisps/chips: Single-serve packet = 25g (~130 cal) | sharing bag = 150g (~780 cal)\n- Fish & chips: Medium portion = ~600-700 cal total (fish 250g = 450 cal, chips 200g = 300 cal)\n- Full English breakfast: Standard = ~800-1000 cal (2 eggs, 2 bacon, 2 sausages, beans, toast, mushrooms, tomato)\n- Sandwich: Standard = 250-400 cal depending on fillings\n- Pasta dish (cooked): Medium portion 300g = 400-600 cal depending on sauce\n\nPROTEIN SHAKES & SUPPLEMENTS (CRITICAL):\n- Protein shakes, Herbalife, protein powder, BCAAs, pre-workout drinks are made with WATER (not milk) unless milk is explicitly visible\n- If you see protein powder/shake but no milk carton/bottle in the image, assume it's made with water\n- Examples: \"Herbalife shake made with water\", \"protein powder with water\", \"BCAA drink\"\n- Only specify \"made with milk\" if you can actually see milk being used in the image\n\nFor each food item detected, provide ONLY the food name and estimated portion - DO NOT include nutritional information as we will look that up from the USDA database for accuracy.\n\nEXPLICITLY STATE VISIBLE TOPPINGS in the food name (e.g., \"jacket potato with visible cheese and beans\" vs \"plain jacket potato\").\n\nReturn the response as a JSON object with this exact structure:\n\n{\n  \"confidence\": number (0-100),\n  \"referenceObjects\": [\"list of reference objects spotted for scale estimation\"],\n  \"detectedFoods\": [\n    {\n      \"name\": \"Food Name with visible toppings/ingredients clearly stated\",\n      \"portion\": \"estimated portion size with weight/volume (be conservative)\",\n      \"icon\": \"appropriate icon name from: egg, bacon, bread-slice, apple-alt\"\n    }\n  ]\n}\n\nFocus on accurate food identification and CONSERVATIVE portion estimation using any reference objects you can see. Be specific with portions (e.g., \"100g\", \"1 medium slice\", \"150ml\", \"25g\" for UK crisps).`\n              },\n              {\n                type: \"image_url\",\n                image_url: {\n                  url: `data:${mimeType};base64,${base64Image}`\n                }\n              }\n            ]\n          }\n        ],\n        max_tokens: 1000,\n        temperature: 0.1\n      });\n\n      const responseText = response.choices[0].message.content;\n      \n      if (!responseText) {\n        throw new Error(\"No response from OpenAI\");\n      }\n\n      // Clean the response text by removing markdown formatting\n      const cleanedText = responseText\n        .replace(/```json\\s*/g, '')\n        .replace(/```\\s*/g, '')\n        .trim();\n\n      // Parse the JSON response\n      const parsed = JSON.parse(cleanedText);\n      \n      // Validate the response structure\n      if (!parsed.detectedFoods || !Array.isArray(parsed.detectedFoods)) {\n        throw new Error(\"Invalid response format from OpenAI\");\n      }\n\n      // Convert to legacy format for now - will be updated after USDA integration\n      const mockNutritionFoods = parsed.detectedFoods.map((food: any) => ({\n        name: food.name,\n        portion: food.portion,\n        calories: 100, // Mock - will be replaced by USDA lookup\n        protein: 5,\n        carbs: 10,\n        fat: 3,\n        icon: food.icon\n      }));\n\n      const result: FoodAnalysisResult = {\n        imageUrl: imagePath,\n        confidence: Math.round(parsed.confidence || 85),\n        totalCalories: mockNutritionFoods.reduce((sum: number, food: any) => sum + food.calories, 0),\n        totalProtein: mockNutritionFoods.reduce((sum: number, food: any) => sum + food.protein, 0),\n        totalCarbs: mockNutritionFoods.reduce((sum: number, food: any) => sum + food.carbs, 0),\n        totalFat: mockNutritionFoods.reduce((sum: number, food: any) => sum + food.fat, 0),\n        detectedFoods: mockNutritionFoods,\n        // Store reference objects in a custom property for now\n        referenceObjects: parsed.referenceObjects || []\n      } as any;\n\n      this.recordSuccess();\n      return result;\n\n    } catch (error: any) {\n      console.error(\"OpenAI food analysis error:\", error);\n      \n      let providerError: ProviderError;\n      \n      if (error?.status === 429 || error?.code === 'rate_limit_exceeded') {\n        providerError = this.createError(\n          'RATE_LIMIT',\n          'OpenAI rate limit exceeded',\n          true,\n          true,\n          60 // Retry after 1 minute\n        );\n      } else if (error?.status >= 500) {\n        providerError = this.createError(\n          'SERVER_ERROR',\n          `OpenAI server error: ${error.message}`,\n          false,\n          true,\n          30\n        );\n      } else {\n        providerError = this.createError(\n          'ANALYSIS_ERROR',\n          `OpenAI analysis failed: ${error.message}`,\n          false,\n          false\n        );\n      }\n      \n      this.recordError(providerError);\n      throw providerError;\n    }\n  }\n\n  async detectFoodNames(imagePath: string): Promise<FoodDetectionResult> {\n    try {\n      // Convert image to base64\n      const imageBuffer = await fs.readFile(imagePath);\n      const base64Image = imageBuffer.toString('base64');\n      const mimeType = 'image/jpeg';\n\n      const response = await this.client.chat.completions.create({\n        model: \"gpt-4o-mini\",\n        messages: [\n          {\n            role: \"user\",\n            content: [\n              {\n                type: \"text\",\n                text: `Analyze this food image and identify all visible food items. Return ONLY the food names, separated by commas. \n\nExamples:\n- \"banana, chicken breast, broccoli\"\n- \"pizza, salad\"\n- \"rice, beans, grilled chicken\"\n\nDO NOT provide nutrition information, portions, or any other details. Only return the food names as a simple comma-separated list.\n\nIf you can't clearly identify something, don't include it. Be as accurate as possible with food identification.`\n              },\n              {\n                type: \"image_url\",\n                image_url: {\n                  url: `data:${mimeType};base64,${base64Image}`\n                }\n              }\n            ]\n          }\n        ],\n        max_tokens: 200,\n        temperature: 0.1\n      });\n\n      const responseText = response.choices[0].message.content;\n      \n      if (!responseText) {\n        throw new Error(\"No response from OpenAI\");\n      }\n\n      console.log(`ðŸ¤– OpenAI detected food names: ${responseText}`);\n\n      // Parse the comma-separated food names\n      const detectedFoodNames = responseText\n        .split(',')\n        .map(name => name.trim())\n        .filter(name => name.length > 0);\n\n      const result: FoodDetectionResult = {\n        confidence: 85, // Default confidence for food detection\n        detectedFoodNames\n      };\n\n      this.recordSuccess();\n      return result;\n\n    } catch (error: any) {\n      console.error(\"OpenAI food detection error:\", error);\n      \n      let providerError: ProviderError;\n      \n      if (error?.status === 429 || error?.code === 'rate_limit_exceeded') {\n        providerError = this.createError(\n          'RATE_LIMIT',\n          'OpenAI rate limit exceeded',\n          true,\n          true,\n          60 // Retry after 1 minute\n        );\n      } else if (error?.status >= 500) {\n        providerError = this.createError(\n          'SERVER_ERROR',\n          `OpenAI server error: ${error.message}`,\n          false,\n          true,\n          30\n        );\n      } else {\n        providerError = this.createError(\n          'DETECTION_ERROR',\n          `OpenAI food detection failed: ${error.message}`,\n          false,\n          false\n        );\n      }\n      \n      this.recordError(providerError);\n      throw providerError;\n    }\n  }\n\n  async analyzeFoodText(foodDescription: string, clientTimeInfo?: { timeString: string, timeOfDay: string, hours: number, minutes: number }): Promise<FoodAnalysisResult> {\n    try {\n      // Apply UK to US food term mapping BEFORE sending to AI\n      const mappedDescription = mapUKFoodTerms(foodDescription);\n      \n      // Add time context for better analysis (use client's local time if provided, otherwise server time)\n      let timeString: string;\n      let timeOfDay: string;\n      \n      if (clientTimeInfo) {\n        // Use pre-calculated client local time (no timezone conversion needed)\n        console.log('ðŸ• OpenAI provider received clientTimeInfo:', clientTimeInfo);\n        timeString = clientTimeInfo.timeString;\n        timeOfDay = clientTimeInfo.timeOfDay;\n      } else {\n        // Fallback to server time\n        const now = new Date();\n        const hours = now.getHours();\n        const minutes = now.getMinutes();\n        timeString = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;\n        timeOfDay = hours < 12 ? 'morning' : hours < 17 ? 'afternoon' : 'evening';\n        console.log('âš ï¸ OpenAI provider using server time (no clientTimeInfo provided):', { timeString, timeOfDay });\n      }\n      \n      console.log('ðŸ• Sending to OpenAI - Time:', timeString, 'Time of day:', timeOfDay);\n      \n      const response = await this.client.chat.completions.create({\n        model: \"gpt-4o-mini\",\n        messages: [\n          {\n            role: \"user\",\n            content: `Current time: ${timeString} (${timeOfDay})\n\nAnalyze this food description and extract nutritional information. Parse the quantity, unit, and food name from: \"${mappedDescription}\"\n\nUK FOOD VOCABULARY - THESE ARE SINGLE ITEMS (DO NOT SPLIT):\n- \"jacket potato\" = baked potato (ONE item, not \"bread\" and \"potato\")\n- \"fish and chips\" = ONE dish (battered fish + chips together)\n- \"full English\" = ONE breakfast (eggs, bacon, sausages, beans, toast, etc.)\n- \"beans on toast\" = ONE item\n- Examples:\n  * \"jacket potato\" â†’ [{\"name\": \"Baked potato (jacket potato)\", \"portion\": \"1 medium (200g)\"}] âœ“ CORRECT\n  * \"jacket potato\" â†’ [{\"name\": \"Bread, potato\"}] âœ— WRONG - Do NOT split!\n\nCRITICAL FOOD INTERPRETATION RULES:\n- \"rice\" = cooked white/brown rice (NOT rice paper, rice cakes, or rice noodles)\n- \"chicken\" = grilled/baked chicken breast unless specified otherwise\n- \"beef\" = lean beef/ground beef\n- \"pasta\" = cooked pasta (NOT raw weight)\n- \"bread\" = sliced bread\n- When user says \"X and Y\" (e.g., \"chicken and rice\"), create TWO separate food items\n- BUT: UK food names like \"jacket potato\" are SINGLE items even if they contain multiple words\n\nCOMMON MEAL EXAMPLES:\n- \"chicken and rice\" â†’ [{\"name\": \"Grilled chicken breast\", \"portion\": \"150g\"}, {\"name\": \"Cooked white rice\", \"portion\": \"200g\"}]\n- \"salmon and broccoli\" â†’ [{\"name\": \"Baked salmon fillet\", \"portion\": \"150g\"}, {\"name\": \"Steamed broccoli\", \"portion\": \"100g\"}]\n- \"eggs and toast\" â†’ [{\"name\": \"Scrambled eggs\", \"portion\": \"2 large eggs\"}, {\"name\": \"Whole wheat bread\", \"portion\": \"2 slices\"}]\n- \"jacket potato\" â†’ [{\"name\": \"Baked potato (jacket potato)\", \"portion\": \"1 medium (200g)\"}]\n\nPORTION ESTIMATION - BE CONSERVATIVE AND REALISTIC:\n- Default to MEDIUM portions unless specified\n- Don't over-estimate or assume extra toppings not mentioned\n- If in doubt, choose the smaller estimate\n\nDEFAULT PORTION SIZES (use when not specified):\n- Jacket potato: 1 medium (200g) plain = ~150-180 cal\n- Chicken breast: 150g cooked\n- Fish fillet: 150g cooked\n- Rice (cooked): 200g (1 cup)\n- Pasta (cooked): 200g (1 cup)\n- Vegetables: 100g\n- Eggs: 2 large\n- Bread: 2 slices\n\nCRITICAL UK FOOD PORTIONS WITH TYPICAL CALORIE RANGES:\n- Jacket potato (plain): Medium (200g) = ~150-180 cal | with butter add ~70 cal | with cheese add ~100 cal\n  * Jacket potato >600 cal is almost certainly wrong unless massive with lots of toppings\n- UK crisps: Single-serve packet = 25g (~130 cal)\n- Fish & chips: Medium portion = ~600-700 cal total\n- Full English breakfast: Standard = ~800-1000 cal\n- Sandwich: Standard = 250-400 cal depending on fillings\n\nCRITICAL QUANTITY HANDLING:\n- If user specifies quantity (e.g., \"4 Weetabix\", \"2 eggs\"), multiply nutrition by that quantity\n- Preserve original portion description with quantity\n\nSANITY CHECKS - Flag if values seem wrong:\n- Jacket potato >600 cal is suspicious\n- Simple meal >800 calories is suspicious\n- Chicken breast >250 cal per 100g is wrong\n- Rice >150 cal per 100g cooked is wrong\n- Single egg >80 calories is wrong\n\nProvide accurate nutritional information based on standard USDA values. Return the response as a JSON object with this exact structure:\n\n{\n  \"confidence\": number (0-100),\n  \"detectedFoods\": [\n    {\n      \"name\": \"Simple, basic food name (e.g., 'Grilled chicken breast', 'Baked potato (jacket potato)')\",\n      \"portion\": \"Specific amount with unit (e.g., '150g', '2 large eggs', '1 medium (200g)')\",\n      \"quantity\": number (default 1),\n      \"calories\": number (per 100g: chicken ~165, rice ~130, egg ~72 each, potato plain ~80),\n      \"protein\": number,\n      \"carbs\": number,\n      \"fat\": number,\n      \"icon\": \"ðŸ½ï¸\"\n    }\n  ]\n}\n\nIMPORTANT: UK food names like \"jacket potato\" are SINGLE items - do NOT split them! Use realistic portions and accurate nutrition values.`\n          }\n        ],\n        max_tokens: 1000,\n        temperature: 0.1\n      });\n\n      const responseText = response.choices[0].message.content;\n      \n      if (!responseText) {\n        throw new Error(\"No response from OpenAI\");\n      }\n\n      // Clean the response text by removing markdown formatting\n      const cleanedText = responseText\n        .replace(/```json\\s*/g, '')\n        .replace(/```\\s*/g, '')\n        .trim();\n\n      // Parse the JSON response\n      const parsed = JSON.parse(cleanedText);\n      \n      // Validate the response structure\n      if (!parsed.detectedFoods || !Array.isArray(parsed.detectedFoods)) {\n        throw new Error(\"Invalid response format from OpenAI\");\n      }\n\n      // Calculate totals and round to integers for database compatibility\n      const totalCalories = Math.round(parsed.detectedFoods.reduce((sum: number, food: any) => sum + (food.calories || 0), 0));\n      const totalProtein = Math.round(parsed.detectedFoods.reduce((sum: number, food: any) => sum + (food.protein || 0), 0));\n      const totalCarbs = Math.round(parsed.detectedFoods.reduce((sum: number, food: any) => sum + (food.carbs || 0), 0));\n      const totalFat = Math.round(parsed.detectedFoods.reduce((sum: number, food: any) => sum + (food.fat || 0), 0));\n\n      // Round nutritional values in detected foods\n      const roundedDetectedFoods = parsed.detectedFoods.map((food: any) => ({\n        ...food,\n        calories: Math.round(food.calories || 0),\n        protein: Math.round(food.protein || 0),\n        carbs: Math.round(food.carbs || 0),\n        fat: Math.round(food.fat || 0),\n        icon: food.icon || 'ðŸ½ï¸'\n      }));\n\n      const result: FoodAnalysisResult = {\n        imageUrl: `voice-input-${Date.now()}.txt`, // Placeholder for voice input\n        confidence: Math.round(parsed.confidence || 90),\n        totalCalories,\n        totalProtein,\n        totalCarbs,\n        totalFat,\n        detectedFoods: roundedDetectedFoods\n      };\n\n      this.recordSuccess();\n      return result;\n\n    } catch (error: any) {\n      console.error(\"OpenAI text analysis error:\", error);\n      \n      let providerError: ProviderError;\n      \n      if (error?.status === 429 || error?.code === 'rate_limit_exceeded') {\n        providerError = this.createError(\n          'RATE_LIMIT',\n          'OpenAI rate limit exceeded',\n          true,\n          true,\n          60 // Retry after 1 minute\n        );\n      } else if (error?.status >= 500) {\n        providerError = this.createError(\n          'SERVER_ERROR',\n          `OpenAI server error: ${error.message}`,\n          false,\n          true,\n          30\n        );\n      } else {\n        providerError = this.createError(\n          'ANALYSIS_ERROR',\n          `OpenAI text analysis failed: ${error.message}`,\n          false,\n          false\n        );\n      }\n      \n      this.recordError(providerError);\n      throw providerError;\n    }\n  }\n\n  async generateDietAdvice(entries: DiaryEntry[], userProfile?: any): Promise<DietAdviceResult> {\n    try {\n      // Analyze eating patterns\n      const totalEntries = entries.length;\n      const totalCalories = entries.reduce((sum, entry) => sum + (entry.analysis?.totalCalories || 0), 0);\n      const avgCalories = totalCalories / totalEntries;\n      \n      const totalProtein = entries.reduce((sum, entry) => sum + (entry.analysis?.totalProtein || 0), 0);\n      const totalCarbs = entries.reduce((sum, entry) => sum + (entry.analysis?.totalCarbs || 0), 0);\n      const totalFat = entries.reduce((sum, entry) => sum + (entry.analysis?.totalFat || 0), 0);\n      \n      // Count meal types\n      const mealTypeCounts = entries.reduce((counts, entry) => {\n        counts[entry.mealType] = (counts[entry.mealType] || 0) + 1;\n        return counts;\n      }, {} as Record<string, number>);\n\n      const analysisData = {\n        totalMeals: totalEntries,\n        averageCalories: Math.round(avgCalories),\n        totalNutrients: {\n          protein: Math.round(totalProtein),\n          carbs: Math.round(totalCarbs),\n          fat: Math.round(totalFat)\n        },\n        mealPattern: mealTypeCounts,\n        recentFoods: entries.slice(0, 10).map(entry => \n          entry.analysis?.detectedFoods?.map((food: any) => food.name).join(', ') || 'Unknown'\n        ).filter(Boolean),\n        userProfile: userProfile ? {\n          age: userProfile.age,\n          sex: userProfile.sex,\n          heightCm: userProfile.heightCm,\n          currentWeightKg: userProfile.currentWeightKg,\n          goalWeightKg: userProfile.goalWeightKg,\n          activityLevel: userProfile.activityLevel,\n          weightGoal: userProfile.weightGoal,\n          weeklyWeightChangeKg: userProfile.weeklyWeightChangeKg,\n          medication: userProfile.medication\n        } : null\n      };\n\n      const response = await this.client.chat.completions.create({\n        model: \"gpt-5\", // the newest OpenAI model is \"gpt-5\" which was released August 7, 2025. do not change this unless explicitly requested by the user\n        messages: [\n          {\n            role: \"system\",\n            content: \"You are a certified nutritionist and diet advisor. Analyze the user's eating patterns and personal profile to provide highly personalized advice including specific meal ideas tailored to their individual needs, goals, and health considerations.\"\n          },\n          {\n            role: \"user\",\n            content: `Analyze my eating patterns and personal profile to provide highly personalized diet advice with meal ideas tailored specifically to my goals, health status, and lifestyle. Here's my comprehensive data from the last 30 days:\n\n${JSON.stringify(analysisData, null, 2)}\n\nPlease provide advice in the following JSON format:\n{\n  \"personalizedAdvice\": [\"advice based on my specific patterns...\"],\n  \"nutritionGoals\": [\"specific goals I should work towards...\"],\n  \"improvements\": [\"areas where I can improve...\"],\n  \"generalTips\": [\"helpful nutrition tips...\"],\n  \"mealIdeas\": [\n    {\n      \"mealType\": \"breakfast/lunch/dinner/snack\",\n      \"name\": \"Meal Name\",\n      \"description\": \"Brief description of the meal\",\n      \"calories\": 400,\n      \"protein\": 25,\n      \"carbs\": 35,\n      \"fat\": 15,\n      \"ingredients\": [\"ingredient1\", \"ingredient2\", \"ingredient3\"],\n      \"benefits\": \"Why this meal is good for the user based on their patterns\",\n      \"recipeLink\": \"https://www.example.com/recipe-name\",\n      \"cookingInstructions\": [\n        \"Step 1: Brief cooking instruction\",\n        \"Step 2: Next step in preparation\",\n        \"Step 3: Final cooking steps\"\n      ]\n    }\n  ]\n}\n\nGenerate 4-6 meal ideas that address the user's specific nutritional needs, deficiencies, and goals based on their eating patterns AND personal profile (age, sex, weight goals, activity level, medication). Consider their current vs goal weight, activity level, and any weight loss medication when recommending portions and meal types. Include a variety of meal types (breakfast, lunch, dinner, snacks). For each meal idea, include a realistic recipe link (use popular cooking websites like allrecipes.com, foodnetwork.com, or BBC Good Food) and provide 3-4 simple cooking instructions. Keep advice items to 1-2 sentences. Be encouraging and specific. Focus on practical, actionable advice that considers their personal goals and health status.`\n          }\n        ],\n        response_format: { type: \"json_object\" },\n      });\n\n      const adviceData = JSON.parse(response.choices[0].message.content || '{}');\n      \n      this.recordSuccess();\n      return adviceData;\n\n    } catch (error: any) {\n      console.error(\"OpenAI diet advice error:\", error);\n      \n      let providerError: ProviderError;\n      \n      if (error?.status === 429 || error?.code === 'rate_limit_exceeded') {\n        providerError = this.createError(\n          'RATE_LIMIT',\n          'OpenAI rate limit exceeded',\n          true,\n          true,\n          60\n        );\n      } else if (error?.status >= 500) {\n        providerError = this.createError(\n          'SERVER_ERROR',\n          `OpenAI server error: ${error.message}`,\n          false,\n          true,\n          30\n        );\n      } else {\n        providerError = this.createError(\n          'ADVICE_ERROR',\n          `OpenAI advice generation failed: ${error.message}`,\n          false,\n          false\n        );\n      }\n      \n      this.recordError(providerError);\n      throw providerError;\n    }\n  }\n\n  private prepareNutritionContextData(entries: DiaryEntry[]) {\n    if (!entries || entries.length === 0) {\n      return \"No recent meal data available.\";\n    }\n\n    const summary = {\n      totalMeals: entries.length,\n      recentMeals: entries.slice(0, 10).map(entry => ({\n        date: entry.createdAt.toISOString().split('T')[0],\n        mealType: entry.mealType,\n        calories: entry.analysis?.totalCalories || 0,\n        protein: entry.analysis?.totalProtein || 0,\n        carbs: entry.analysis?.totalCarbs || 0,\n        fat: entry.analysis?.totalFat || 0,\n        foods: entry.analysis?.detectedFoods?.map(f => f.name).join(', ') || 'Unknown'\n      })),\n      averageDaily: {\n        calories: Math.round(entries.reduce((sum, e) => sum + (e.analysis?.totalCalories || 0), 0) / Math.max(entries.length, 1)),\n        protein: Math.round(entries.reduce((sum, e) => sum + (e.analysis?.totalProtein || 0), 0) / Math.max(entries.length, 1)),\n        carbs: Math.round(entries.reduce((sum, e) => sum + (e.analysis?.totalCarbs || 0), 0) / Math.max(entries.length, 1)),\n        fat: Math.round(entries.reduce((sum, e) => sum + (e.analysis?.totalFat || 0), 0) / Math.max(entries.length, 1))\n      }\n    };\n\n    return JSON.stringify(summary, null, 2);\n  }\n\n  async answerNutritionQuestion(\n    question: string, \n    entries: DiaryEntry[], \n    userProfile?: any,\n    nutritionGoals?: any,\n    coachMemory?: any,\n    personality?: any,\n    clientTimeInfo?: { timeString: string, timeOfDay: string, hours: number, minutes: number }\n  ): Promise<string> {\n    try {\n      // Prepare context from user's nutrition data\n      const contextData = this.prepareNutritionContextData(entries);\n      \n      // Build profile context if available\n      let profileContext = \"\";\n      let userDisplayName = \"\";\n      if (userProfile) {\n        const profileParts = [];\n        \n        // Set user display name (prefer nickname, fall back to name)\n        if (userProfile.nickname) {\n          userDisplayName = userProfile.nickname;\n          profileParts.push(`Preferred Name: ${userProfile.nickname}`);\n        } else if (userProfile.name) {\n          userDisplayName = userProfile.name;\n          profileParts.push(`Name: ${userProfile.name}`);\n        }\n        \n        if (userProfile.dietaryRequirements && userProfile.dietaryRequirements.length > 0) {\n          profileParts.push(`Dietary Requirements: ${userProfile.dietaryRequirements.join(', ')}`);\n        }\n        if (userProfile.allergies && userProfile.allergies.length > 0) {\n          profileParts.push(`Allergies/Intolerances: ${userProfile.allergies.join(', ')}`);\n        }\n        if (userProfile.foodDislikes) {\n          profileParts.push(`Foods They Dislike: ${userProfile.foodDislikes}`);\n        }\n        if (userProfile.healthConditions) {\n          profileParts.push(`Health Conditions: ${userProfile.healthConditions}`);\n        }\n        \n        if (profileParts.length > 0) {\n          profileContext = `\\n\\nUser Profile:\\n${profileParts.join('\\n')}`;\n        }\n      }\n      \n      // Build coach memory context if available\n      let memoryContext = \"\";\n      if (coachMemory) {\n        const memoryParts = [];\n        \n        if (coachMemory.age) memoryParts.push(`Age: ${coachMemory.age}`);\n        if (coachMemory.occupation) memoryParts.push(`Occupation: ${coachMemory.occupation}`);\n        if (coachMemory.lifestyleDetails) memoryParts.push(`Lifestyle: ${coachMemory.lifestyleDetails}`);\n        if (coachMemory.workSchedule) memoryParts.push(`Work Schedule: ${coachMemory.workSchedule}`);\n        if (coachMemory.exerciseFrequency) memoryParts.push(`Exercise Frequency: ${coachMemory.exerciseFrequency}`);\n        if (coachMemory.interests && coachMemory.interests.length > 0) {\n          memoryParts.push(`Interests: ${coachMemory.interests.join(', ')}`);\n        }\n        if (coachMemory.fitnessGoals) memoryParts.push(`Fitness Goals: ${coachMemory.fitnessGoals}`);\n        if (coachMemory.stressGoals) memoryParts.push(`Stress Management Goals: ${coachMemory.stressGoals}`);\n        if (coachMemory.sleepGoals) memoryParts.push(`Sleep Goals: ${coachMemory.sleepGoals}`);\n        if (coachMemory.mentalHealthGoals) memoryParts.push(`Mental Health Goals: ${coachMemory.mentalHealthGoals}`);\n        \n        if (memoryParts.length > 0) {\n          memoryContext = `\\n\\nPersonal Information:\\n${memoryParts.join('\\n')}`;\n        }\n      }\n      \n      // Build goals context if available\n      let goalsContext = \"\";\n      if (nutritionGoals) {\n        const goalsParts = [];\n        if (nutritionGoals.caloriesGoal) goalsParts.push(`Calorie Goal: ${nutritionGoals.caloriesGoal} kcal`);\n        if (nutritionGoals.proteinGoal) goalsParts.push(`Protein Goal: ${nutritionGoals.proteinGoal}g`);\n        if (nutritionGoals.carbsGoal) goalsParts.push(`Carbs Goal: ${nutritionGoals.carbsGoal}g`);\n        if (nutritionGoals.fatGoal) goalsParts.push(`Fat Goal: ${nutritionGoals.fatGoal}g`);\n        if (nutritionGoals.waterGoal) goalsParts.push(`Water Goal: ${nutritionGoals.waterGoal} glasses`);\n        \n        if (goalsParts.length > 0) {\n          goalsContext = `\\n\\nNutrition Goals:\\n${goalsParts.join('\\n')}`;\n        }\n      }\n      \n      // Get personality settings or use defaults\n      const personalitySettings = personality || {\n        name: 'Zen Wellness Coach',\n        systemPrompt: 'You are a calm, mindful wellness coach who focuses on balance and self-compassion.',\n        greetingPhrase: 'Welcome! Let\\'s work together on your journey to better health.',\n        encouragementPhrases: ['You\\'re doing great!', 'Every step forward is progress.'],\n        responseStyle: {\n          tone: 'Calm and supportive',\n          formality: 'Casual',\n          emoji: false,\n          directness: 'Gentle'\n        }\n      };\n      \n      // Get current time context (use client's local time if provided)\n      let timeContext = \"\";\n      if (clientTimeInfo) {\n        timeContext = `\\n\\nCurrent time for the user: ${clientTimeInfo.timeString} (${clientTimeInfo.timeOfDay})`;\n      }\n      \n      // Build system prompt with personality as PRIMARY identity\n      const systemPrompt = `${personalitySettings.systemPrompt}\n\nYou are a personal AI companion and coach. Stay in character with your unique personality style at all times.${timeContext}\n\nYour communication style:\n- Tone: ${personalitySettings.responseStyle.tone}\n- Formality: ${personalitySettings.responseStyle.formality}\n- Directness: ${personalitySettings.responseStyle.directness}\n${personalitySettings.responseStyle.emoji ? '- Use emojis to make conversations more engaging' : '- Keep responses professional without emojis'}\n\n${userDisplayName ? `The user prefers to be called \"${userDisplayName}\". Use this name naturally when addressing them to make the conversation more personal and friendly.` : ''}\n\nContext about the user (for reference when relevant):\n${contextData}${profileContext}${memoryContext}${goalsContext}\n\nGuidelines:\n- You can discuss ANY topic: relationships, career, hobbies, news, sports, motivation, life advice, philosophy, entertainment, technology, or anything else the user wants to talk about\n- When nutrition/health topics come up, consider their dietary requirements, allergies, and health conditions\n- Never suggest foods they're allergic to or that violate their dietary restrictions\n- Reference their personal goals, interests, and lifestyle when relevant${userDisplayName ? `\\n- Address the user as \"${userDisplayName}\" to make the conversation feel personal` : ''}\n- Stay fully in character with your unique personality - this is who you ARE, not just how you talk\n- Give practical, actionable advice in your distinctive style\n- If medical advice is needed, recommend consulting a healthcare professional\n- Keep responses focused and engaging (200-300 words max)`;\n      \n      const response = await this.client.chat.completions.create({\n        model: \"gpt-5\", // the newest OpenAI model is \"gpt-5\" which was released August 7, 2025. do not change this unless explicitly requested by the user\n        messages: [\n          {\n            role: \"system\",\n            content: systemPrompt\n          },\n          {\n            role: \"user\",\n            content: question\n          }\n        ],\n        max_tokens: 400,\n        temperature: 0.7,\n      });\n\n      const answer = response.choices[0].message.content || \"I'm sorry, I couldn't generate a response to your question right now.\";\n      \n      this.recordSuccess();\n      return answer;\n\n    } catch (error: any) {\n      console.error(\"OpenAI question answering error:\", error);\n      \n      let providerError: ProviderError;\n      \n      if (error?.status === 429 || error?.code === 'rate_limit_exceeded') {\n        providerError = this.createError(\n          'RATE_LIMIT',\n          'OpenAI rate limit exceeded',\n          true,\n          true,\n          60\n        );\n      } else if (error?.status >= 500) {\n        providerError = this.createError(\n          'SERVER_ERROR',\n          `OpenAI server error: ${error.message}`,\n          false,\n          true,\n          30\n        );\n      } else {\n        providerError = this.createError(\n          'QUESTION_ERROR',\n          `OpenAI question answering failed: ${error.message}`,\n          false,\n          false\n        );\n      }\n      \n      this.recordError(providerError);\n      throw providerError;\n    }\n  }\n\n  async generateDailyCoaching(entries: DiaryEntry[], userProfile?: any): Promise<DailyCoaching> {\n    try {\n      // Prepare context from user's nutrition data\n      const contextData = this.prepareNutritionContextData(entries);\n      \n      const systemPrompt = `You are PlateMate's AI wellness coach. Generate daily coaching content that's motivational, educational, and personalized. Be encouraging, supportive, and provide actionable advice.\n\nUser's Recent Nutrition Data:\n${contextData}\n\nGenerate coaching content with:\n- Motivation: Uplifting, personal message (30-50 words)\n- Nutrition Tip: Practical, actionable advice based on their eating patterns (30-50 words)\n- Medication Tip: If relevant, gentle reminder about GLP-1 medications and nutrition (20-40 words, optional)\n- Encouragement: Supportive message acknowledging their efforts (20-40 words)\n- Today's Focus: One specific, achievable goal for today (15-30 words)\n- Streak: Calculate their consistency streak (days of food logging)\n- Achievement: If they've hit a milestone, acknowledge it (optional)\n\nRespond in JSON format with these exact keys.`;\n\n      const response = await this.client.chat.completions.create({\n        model: \"gpt-5\", // the newest OpenAI model is \"gpt-5\" which was released August 7, 2025. do not change this unless explicitly requested by the user\n        messages: [\n          {\n            role: \"system\",\n            content: systemPrompt\n          },\n          {\n            role: \"user\",\n            content: \"Generate my daily coaching content based on my nutrition data.\"\n          }\n        ],\n        response_format: { type: \"json_object\" },\n        max_tokens: 600,\n        temperature: 0.8,\n      });\n\n      const responseText = response.choices[0].message.content;\n      \n      if (!responseText) {\n        throw new Error(\"No response from OpenAI\");\n      }\n\n      const parsed = JSON.parse(responseText);\n      \n      // Calculate actual streak from entries\n      const actualStreak = this.calculateStreak(entries);\n      \n      const coaching: DailyCoaching = {\n        motivation: parsed.motivation || \"You're doing great! Every healthy choice you make is an investment in your future self.\",\n        nutritionTip: parsed.nutritionTip || \"Try to include a variety of colorful vegetables in your meals for optimal nutrition.\",\n        medicationTip: parsed.medicationTip,\n        encouragement: parsed.encouragement || \"Remember, progress isn't always perfect, but consistency is key. You've got this!\",\n        todaysFocus: parsed.todaysFocus || \"Focus on staying hydrated and eating mindfully today.\",\n        streak: actualStreak,\n        achievement: actualStreak >= 7 ? `${actualStreak} day logging streak!` : parsed.achievement\n      };\n\n      this.recordSuccess();\n      return coaching;\n\n    } catch (error: any) {\n      console.error(\"OpenAI coaching generation error:\", error);\n      \n      let providerError: ProviderError;\n      \n      if (error?.status === 429 || error?.code === 'rate_limit_exceeded') {\n        providerError = this.createError(\n          'RATE_LIMIT',\n          'OpenAI rate limit exceeded',\n          true,\n          true,\n          60\n        );\n      } else if (error?.status >= 500) {\n        providerError = this.createError(\n          'SERVER_ERROR',\n          `OpenAI server error: ${error.message}`,\n          false,\n          true,\n          30\n        );\n      } else {\n        providerError = this.createError(\n          'COACHING_ERROR',\n          `OpenAI coaching generation failed: ${error.message}`,\n          false,\n          false\n        );\n      }\n      \n      this.recordError(providerError);\n      throw providerError;\n    }\n  }\n\n  async generateEducationalTips(category: 'all' | 'nutrition' | 'medication' | 'motivation'): Promise<EducationalTip[]> {\n    try {\n      const categoryFilter = category === 'all' ? 'nutrition, medication, and motivation' : category;\n      \n      const systemPrompt = `You are a certified nutritionist and wellness expert. Generate 6-8 educational tips about ${categoryFilter}. \n\nEach tip should be:\n- Practical and actionable\n- Evidence-based\n- Easy to understand\n- Relevant to people using nutrition tracking apps\n- Include proper importance level (high/medium/low)\n\nFocus areas:\n- Nutrition: Macro/micronutrients, meal timing, food combinations, healthy eating habits\n- Medication: GLP-1 medications, timing with meals, side effects management, interactions\n- Motivation: Habit formation, goal setting, overcoming challenges, mindset\n\nRespond with JSON array of tip objects with: id, title, content, category, importance.`;\n\n      const response = await this.client.chat.completions.create({\n        model: \"gpt-5\", // the newest OpenAI model is \"gpt-5\" which was released August 7, 2025. do not change this unless explicitly requested by the user\n        messages: [\n          {\n            role: \"system\",\n            content: systemPrompt\n          },\n          {\n            role: \"user\",\n            content: `Generate educational tips for: ${categoryFilter}`\n          }\n        ],\n        response_format: { type: \"json_object\" },\n        max_tokens: 1000,\n        temperature: 0.7,\n      });\n\n      const responseText = response.choices[0].message.content;\n      \n      if (!responseText) {\n        throw new Error(\"No response from OpenAI\");\n      }\n\n      const parsed = JSON.parse(responseText);\n      const tips = parsed.tips || [];\n      \n      // Filter by category if specific category requested\n      const filteredTips = category === 'all' ? tips : tips.filter((tip: any) => tip.category === category);\n      \n      this.recordSuccess();\n      return filteredTips;\n\n    } catch (error: any) {\n      console.error(\"OpenAI tips generation error:\", error);\n      \n      let providerError: ProviderError;\n      \n      if (error?.status === 429 || error?.code === 'rate_limit_exceeded') {\n        providerError = this.createError(\n          'RATE_LIMIT',\n          'OpenAI rate limit exceeded',\n          true,\n          true,\n          60\n        );\n      } else if (error?.status >= 500) {\n        providerError = this.createError(\n          'SERVER_ERROR',\n          `OpenAI server error: ${error.message}`,\n          false,\n          true,\n          30\n        );\n      } else {\n        providerError = this.createError(\n          'TIPS_ERROR',\n          `OpenAI tips generation failed: ${error.message}`,\n          false,\n          false\n        );\n      }\n      \n      this.recordError(providerError);\n      throw providerError;\n    }\n  }\n\n  async generateRecipes(dietaryFilter: string = \"\", userProfile: any = null): Promise<any[]> {\n    try {\n      const filterText = dietaryFilter ? ` that are suitable for ${dietaryFilter} dietary requirements` : \"\";\n      \n      // Build user-specific constraints\n      let userConstraints = \"\";\n      if (userProfile) {\n        const constraints: string[] = [];\n        \n        if (userProfile.allergies && userProfile.allergies.length > 0) {\n          constraints.push(`CRITICAL: Avoid ALL recipes containing these allergens: ${userProfile.allergies.join(', ')}. Do not include any recipe with these ingredients.`);\n        }\n        \n        if (userProfile.foodDislikes) {\n          constraints.push(`Avoid using these foods if possible: ${userProfile.foodDislikes}`);\n        }\n        \n        if (userProfile.healthConditions) {\n          constraints.push(`Consider these health conditions: ${userProfile.healthConditions}`);\n        }\n        \n        if (constraints.length > 0) {\n          userConstraints = \"\\n\\nUSER-SPECIFIC REQUIREMENTS:\\n\" + constraints.join('\\n');\n        }\n      }\n      \n      const systemPrompt = `You are a professional chef and nutritionist. Generate 8-10 healthy and delicious recipes${filterText}.\n\nEach recipe should include:\n- Complete ingredient list with measurements\n- Step-by-step cooking instructions\n- Accurate nutritional information\n- Cooking time and difficulty level\n- Serving size information\n- Dietary tags and information\n\nFocus on:\n- Balanced nutrition\n- Easy-to-find ingredients\n- Clear, actionable instructions\n- Variety in meal types (breakfast, lunch, dinner, snacks)\n- Different cooking methods and cuisines${userConstraints}\n\nRespond with a JSON object with a 'recipes' array.`;\n\n      const userPrompt = dietaryFilter \n        ? `Generate healthy recipes for ${dietaryFilter} diet. Include variety in meal types and cooking methods.`\n        : \"Generate a variety of healthy recipes for different meal types and dietary preferences.\";\n\n      const response = await this.client.chat.completions.create({\n        model: \"gpt-5\", // the newest OpenAI model is \"gpt-5\" which was released August 7, 2025. do not change this unless explicitly requested by the user\n        messages: [\n          {\n            role: \"system\",\n            content: systemPrompt\n          },\n          {\n            role: \"user\",\n            content: userPrompt\n          }\n        ],\n        response_format: { type: \"json_object\" },\n        max_tokens: 3000,\n        temperature: 0.8,\n      });\n\n      const responseText = response.choices[0].message.content;\n      \n      if (!responseText) {\n        throw new Error(\"No response from OpenAI\");\n      }\n\n      const parsed = JSON.parse(responseText);\n      const recipes = parsed.recipes || [];\n      \n      this.recordSuccess();\n      return recipes;\n\n    } catch (error: any) {\n      console.error(\"OpenAI recipe generation error:\", error);\n      \n      let providerError: ProviderError;\n      \n      if (error?.status === 429 || error?.code === 'rate_limit_exceeded') {\n        providerError = this.createError(\n          'RATE_LIMIT',\n          'OpenAI rate limit exceeded',\n          true,\n          true,\n          60\n        );\n      } else if (error?.status >= 500) {\n        providerError = this.createError(\n          'SERVER_ERROR',\n          `OpenAI server error: ${error.message}`,\n          false,\n          true,\n          30\n        );\n      } else {\n        providerError = this.createError(\n          'RECIPE_ERROR',\n          `OpenAI recipe generation failed: ${error.message}`,\n          false,\n          false\n        );\n      }\n      \n      this.recordError(providerError);\n      throw providerError;\n    }\n  }\n\n  private calculateStreak(entries: DiaryEntry[]): number {\n    if (!entries || entries.length === 0) return 0;\n    \n    // Sort entries by date (most recent first)\n    const sortedEntries = entries.sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());\n    \n    let streak = 0;\n    let currentDate = new Date();\n    currentDate.setHours(0, 0, 0, 0);\n    \n    // Check each day going backwards\n    for (let i = 0; i < 30; i++) { // Check last 30 days max\n      const checkDate = new Date(currentDate);\n      checkDate.setDate(checkDate.getDate() - i);\n      \n      // Find if there's an entry for this date\n      const hasEntryForDate = sortedEntries.some(entry => {\n        const entryDate = new Date(entry.createdAt);\n        entryDate.setHours(0, 0, 0, 0);\n        return entryDate.getTime() === checkDate.getTime();\n      });\n      \n      if (hasEntryForDate) {\n        streak++;\n      } else {\n        break; // Streak is broken\n      }\n    }\n    \n    return streak;\n  }\n}","size_bytes":45112},"android/app/src/test/java/com/getcapacitor/myapp/ExampleUnitTest.java":{"content":"package com.getcapacitor.myapp;\n\nimport static org.junit.Assert.*;\n\nimport org.junit.Test;\n\n/**\n * Example local unit test, which will execute on the development machine (host).\n *\n * @see <a href=\"http://d.android.com/tools/testing\">Testing documentation</a>\n */\npublic class ExampleUnitTest {\n\n    @Test\n    public void addition_isCorrect() throws Exception {\n        assertEquals(4, 2 + 2);\n    }\n}\n","size_bytes":402},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border-2 border-gray-300 bg-white dark:bg-gray-800 text-gray-900 dark:text-white p-6 shadow-2xl backdrop-blur-sm duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm font-medium text-gray-700 dark:text-gray-300\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","size_bytes":3949},"client/src/components/camera-interface.tsx":{"content":"import { useState, useRef, useEffect } from \"react\";\nimport { Images, Zap, Camera, CloudUpload, Syringe, QrCode, Flame } from \"lucide-react\";\nimport { Link, useLocation } from \"wouter\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { motion } from \"framer-motion\";\nimport { Camera as CapacitorCamera, CameraResultType, CameraSource } from '@capacitor/camera';\nimport { Capacitor } from '@capacitor/core';\nimport { mediaService } from '@/lib/media-service';\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { ScannerModal } from \"@/components/scanner-modal\";\nimport { BarcodeScanner } from \"@/components/barcode-scanner\";\nimport { scanBarcodeFromImage } from \"@/services/scanner-service\";\nimport { compressImage, preprocessAndCompress } from \"@/lib/image-compression\";\nimport { buildApiUrl } from '@/lib/api-config';\nimport type { FoodAnalysis } from \"@shared/schema\";\n\ninterface CameraInterfaceProps {\n  onAnalysisStart: () => void;\n  onAnalysisSuccess: (data: FoodAnalysis) => void;\n  onAnalysisError: (error: string, errorType?: 'food' | 'barcode') => void;\n  caloriesConsumed?: number;\n  caloriesGoal?: number;\n}\n\nexport function CameraInterface({\n  onAnalysisStart,\n  onAnalysisSuccess,\n  onAnalysisError,\n  caloriesConsumed = 0,\n  caloriesGoal = 2000,\n}: CameraInterfaceProps) {\n  const { toast } = useToast();\n  const [, setLocation] = useLocation();\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\n  const [previewUrl, setPreviewUrl] = useState<string>('');\n  const [flashEnabled, setFlashEnabled] = useState(false);\n  const [showBarcodeScanner, setShowBarcodeScanner] = useState(false);\n  const [showManualEntry, setShowManualEntry] = useState(false);\n  const [barcodeScanningMode, setBarcodeScanningMode] = useState(false);\n  \n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const cameraInputRef = useRef<HTMLInputElement>(null);\n\n  // Initialize media service\n  useEffect(() => {\n    if (!mediaService.isMediaSupported()) {\n      toast({\n        title: \"Camera Not Supported\",\n        description: \"Camera requires a modern browser with HTTPS\",\n        variant: \"destructive\",\n      });\n    }\n\n    // Cleanup on unmount\n    return () => {\n      mediaService.cleanup();\n    };\n  }, [toast]);\n\n  const analysisMutation = useMutation({\n    mutationFn: async (file: File) => {\n      // Preprocess and compress image for optimal AI analysis\n      let imageToUpload = file;\n      try {\n        imageToUpload = await preprocessAndCompress(\n          file,\n          {\n            enhanceContrast: true,\n            blurBackground: false,\n            centerCrop: false,\n            contrastAmount: 1.25\n          },\n          {\n            maxWidth: 800,\n            maxHeight: 800,\n            quality: 0.8,\n            maxSizeKB: 400\n          }\n        );\n      } catch (processingError) {\n        // Fallback to original if processing fails\n      }\n      \n      const formData = new FormData();\n      formData.append('image', imageToUpload);\n      \n      const response = await fetch(buildApiUrl('/api/analyze'), {\n        method: 'POST',\n        body: formData,\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        console.error(\"API Error:\", errorData);\n        throw new Error(errorData.error || 'Analysis failed');\n      }\n\n      const result = await response.json();\n      return result;\n    },\n    onMutate: () => {\n      onAnalysisStart();\n    },\n    onSuccess: (data: FoodAnalysis) => {\n      onAnalysisSuccess(data);\n    },\n    onError: (error: Error) => {\n      console.error(\"Analysis error:\", error);\n      onAnalysisError(error.message, 'food');\n    },\n  });\n\n\n  const barcodeMutation = useMutation({\n    mutationFn: async (barcode: string) => {\n      const response = await apiRequest('POST', '/api/barcode', { barcode });\n      const result = await response.json();\n      return result;\n    },\n    onMutate: () => {\n      onAnalysisStart();\n    },\n    onSuccess: (data: FoodAnalysis) => {\n      setShowBarcodeScanner(false);\n      onAnalysisSuccess(data);\n    },\n    onError: (error: Error) => {\n      console.error(\"Barcode lookup error:\", error);\n      \n      // If product not found, fallback to manual entry\n      if (error.message.includes(\"Product not found\") || error.message.includes(\"not found\")) {\n        setShowBarcodeScanner(false);\n        setBarcodeScanningMode(false);\n        setShowManualEntry(true);\n        toast({\n          title: \"Product Not Found\",\n          description: \"This barcode wasn't found in our database. Please enter the product details manually.\",\n          variant: \"default\",\n        });\n      } else {\n        // Other errors\n        toast({\n          title: \"Barcode Scanner Error\",\n          description: error.message,\n          variant: \"destructive\",\n        });\n        setShowBarcodeScanner(false);\n        setBarcodeScanningMode(false);\n        onAnalysisError(error.message, 'barcode');\n      }\n    },\n  });\n\n  const handleBarcodeScanned = (barcode: string) => {\n    // Check if the scanned code is a URL (QR code for restaurant menu)\n    try {\n      const url = new URL(barcode);\n      // If it's a valid URL, navigate to menu analysis page using wouter\n      if (url.protocol === 'http:' || url.protocol === 'https:') {\n        setShowBarcodeScanner(false);\n        setLocation(`/menu-analysis?url=${encodeURIComponent(barcode)}`);\n        return;\n      }\n    } catch {\n      // Not a URL, continue with barcode lookup\n    }\n    \n    // Regular barcode lookup\n    barcodeMutation.mutate(barcode);\n  };\n\n\n  // Listen for manual barcode entry events\n  useEffect(() => {\n    const handleManualBarcodeEvent = () => {\n      setShowBarcodeScanner(false);\n      setShowManualEntry(true);\n    };\n\n    window.addEventListener('open-manual-barcode', handleManualBarcodeEvent);\n    return () => window.removeEventListener('open-manual-barcode', handleManualBarcodeEvent);\n  }, []);\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    \n    if (file) {\n      setSelectedFile(file);\n      const url = URL.createObjectURL(file);\n      setPreviewUrl(url);\n      \n      // Don't auto-analyze - user needs to press capture button\n      // This makes gallery selection work like camera capture\n    }\n  };\n\n\n  const handleCameraCapture = async () => {\n    // If user has already selected a file from gallery\n    if (selectedFile) {\n      if (barcodeScanningMode) {\n        try {\n          const result = await scanBarcodeFromImage(selectedFile);\n          handleBarcodeScanned(result.barcode);\n          return;\n        } catch (error) {\n          console.error(\"Barcode detection failed:\", error);\n          setBarcodeScanningMode(false);\n          setShowManualEntry(true);\n          toast({\n            title: \"No Barcode Found\",\n            description: \"We couldn't detect a barcode in this image. Please enter the barcode manually.\",\n            variant: \"default\",\n          });\n          return;\n        }\n      } else {\n        analysisMutation.mutate(selectedFile);\n        return;\n      }\n    }\n    \n    // Use Capacitor Camera API if available (native app)\n    if (Capacitor.isNativePlatform()) {\n      try {\n        const image = await CapacitorCamera.getPhoto({\n          quality: 90,\n          allowEditing: false,\n          resultType: CameraResultType.Base64,\n          source: CameraSource.Camera,\n        });\n        \n        // Convert base64 to File object\n        const response = await fetch(`data:image/jpeg;base64,${image.base64String}`);\n        const blob = await response.blob();\n        const file = new File([blob], 'camera-photo.jpg', { type: 'image/jpeg' });\n        \n        setSelectedFile(file);\n        const url = URL.createObjectURL(file);\n        setPreviewUrl(url);\n        \n        if (barcodeScanningMode) {\n          try {\n            const result = await scanBarcodeFromImage(file);\n            handleBarcodeScanned(result.barcode);\n            return;\n          } catch (error) {\n            console.error(\"Barcode detection failed:\", error);\n            setBarcodeScanningMode(false);\n            setShowManualEntry(true);\n            toast({\n              title: \"No Barcode Found\",\n              description: \"We couldn't detect a barcode in this photo. Please enter the barcode manually.\",\n              variant: \"default\",\n            });\n            return;\n          }\n        } else {\n          // Auto-analyze the captured photo for food\n          analysisMutation.mutate(file);\n        }\n      } catch (error: any) {\n        console.error('Error taking photo:', error);\n        \n        // Handle user cancellation gracefully\n        if (error?.message?.includes('User cancelled') || error?.message?.includes('cancel')) {\n          return;\n        }\n        \n        toast({\n          title: \"Camera Error\",\n          description: error?.message || \"Failed to access camera. Please try again.\",\n          variant: \"destructive\",\n        });\n      }\n    } else {\n      // For web browsers, use camera input\n      if (!cameraInputRef.current) {\n        console.error(\"Camera input ref is null\");\n        toast({\n          title: \"Camera Error\",\n          description: \"Camera input not available. Please refresh the page.\",\n          variant: \"destructive\",\n        });\n        return;\n      }\n      \n      try {\n        cameraInputRef.current?.click();\n      } catch (error) {\n        console.error(\"Error triggering camera input:\", error);\n        toast({\n          title: \"Camera Error\", \n          description: \"Failed to open camera. Your browser may not support camera access.\",\n          variant: \"destructive\",\n        });\n      }\n    }\n  };\n\n  // Toggle flash for camera\n  const handleFlashToggle = () => {\n    setFlashEnabled(!flashEnabled);\n    toast({\n      title: flashEnabled ? \"Flash Disabled\" : \"Flash Enabled\",\n      description: `Camera flash is now ${flashEnabled ? 'off' : 'on'}`,\n    });\n  };\n\n  const handleGallerySelect = () => {\n    // Use file input for reliable gallery access across all platforms\n    fileInputRef.current?.click();\n  };\n\n  return (\n    <div className=\"relative p-1\">\n      {/* Camera View Container - only show when image is selected */}\n      {previewUrl && (\n        <div \n          className=\"relative aspect-square overflow-hidden rounded-3xl shadow-lg border border-white/20 cursor-pointer transition-all duration-200 hover:shadow-xl\" \n          style={{background: 'linear-gradient(135deg, #8B5CF6 0%, #A855F7 100%)'}}\n          onClick={handleCameraCapture}\n          data-testid=\"camera-panel-clickable\"\n          role=\"button\"\n          aria-label=\"Analyze selected food image\"\n          tabIndex={0}\n          onKeyDown={(e) => {\n            if (e.key === 'Enter' || e.key === ' ') {\n              e.preventDefault();\n              handleCameraCapture();\n            }\n          }}\n        >\n          \n          {/* Static Image Preview */}\n          <img \n            src={previewUrl} \n            alt=\"Selected food image for analysis\" \n            className=\"w-full h-full object-cover rounded-3xl\"\n            data-testid=\"img-preview\"\n          />\n          \n          \n          {/* Plate detection circle */}\n          <div className=\"absolute inset-16 border border-white/30 rounded-full border-dashed\" aria-hidden=\"true\"></div>\n          \n        </div>\n      )}\n      \n\n\n      {/* Hidden file inputs */}\n      <input\n        ref={fileInputRef}\n        type=\"file\"\n        accept=\"image/*\"\n        onChange={handleFileSelect}\n        className=\"hidden\"\n        data-testid=\"input-file\"\n        aria-label=\"Select food image from gallery\"\n      />\n      <input\n        ref={cameraInputRef}\n        type=\"file\"\n        accept=\"image/*\"\n        capture=\"environment\"\n        onChange={handleFileSelect}\n        className=\"hidden\"\n        data-testid=\"input-camera\"\n        aria-label=\"Take photo of food with camera\"\n      />\n\n      {/* Camera Barcode Scanner Modal */}\n      <ScannerModal\n        isOpen={showBarcodeScanner}\n        onScanSuccess={(barcode: string) => {\n          setBarcodeScanningMode(false);\n          handleBarcodeScanned(barcode);\n        }}\n        onClose={() => {\n          setShowBarcodeScanner(false);\n          setBarcodeScanningMode(false);\n        }}\n      />\n\n      {/* Manual Barcode Entry */}\n      <BarcodeScanner\n        isOpen={showManualEntry}\n        onScanSuccess={(barcode: string) => {\n          setShowManualEntry(false);\n          setBarcodeScanningMode(false);\n          handleBarcodeScanned(barcode);\n        }}\n        onClose={() => {\n          setShowManualEntry(false);\n          setBarcodeScanningMode(false);\n        }}\n      />\n    </div>\n  );\n}\n","size_bytes":12776},"client/src/lib/notification-service.ts":{"content":"import { LocalNotifications } from '@capacitor/local-notifications';\nimport { Capacitor } from '@capacitor/core';\nimport { soundService } from './sound-service';\nimport { buildApiUrl } from './api-config';\n\nexport interface NotificationConfig {\n  title: string;\n  body: string;\n  time: string; // Format: \"HH:MM\"\n  enabled: boolean;\n}\n\nclass NotificationService {\n  private hasPermission = false;\n  private isInitialized = false;\n\n  async initialize(): Promise<boolean> {\n    if (this.isInitialized) {\n      return this.hasPermission;\n    }\n\n    try {\n      // Check if we're on mobile (Capacitor) or web\n      if (Capacitor.isNativePlatform()) {\n        await this.initializeCapacitorNotifications();\n      } else {\n        await this.initializeWebNotifications();\n      }\n      \n      this.isInitialized = true;\n      return this.hasPermission;\n    } catch (error) {\n      console.error('Failed to initialize notifications:', error);\n      return false;\n    }\n  }\n\n  private async initializeCapacitorNotifications(): Promise<void> {\n    try {\n      // Request permission for local notifications\n      const permission = await LocalNotifications.requestPermissions();\n      this.hasPermission = permission.display === 'granted';\n      \n      if (this.hasPermission) {\n        console.log('âœ“ Capacitor notifications permission granted');\n      } else {\n        console.log('âœ— Capacitor notifications permission denied');\n      }\n    } catch (error) {\n      console.error('Capacitor notifications error:', error);\n      this.hasPermission = false;\n    }\n  }\n\n  private async initializeWebNotifications(): Promise<void> {\n    try {\n      // Check if running in a secure context (required for notifications)\n      if (!window.isSecureContext) {\n        console.log('Web notifications require secure context (HTTPS)');\n        return;\n      }\n\n      if (!('Notification' in window)) {\n        console.log('Web notifications not supported by this browser');\n        return;\n      }\n\n      // Check current permission status\n      const currentPermission = Notification.permission;\n      console.log(`Current notification permission: ${currentPermission}`);\n\n      if (currentPermission === 'granted') {\n        this.hasPermission = true;\n        console.log('âœ“ Web notifications permission already granted');\n      } else if (currentPermission === 'default') {\n        // Only request permission when user explicitly enables notifications\n        console.log('Web notifications permission not yet requested');\n        this.hasPermission = false;\n      } else {\n        console.log('âœ— Web notifications permission denied');\n        this.hasPermission = false;\n      }\n    } catch (error) {\n      console.error('Web notifications error:', error);\n      this.hasPermission = false;\n    }\n  }\n\n  async scheduleDaily(config: NotificationConfig): Promise<boolean> {\n    if (!config.enabled) {\n      await this.cancelDaily();\n      return true;\n    }\n\n    // Initialize notification service\n    await this.initialize();\n\n    // Request permission if we don't have it and notifications are supported\n    if (!Capacitor.isNativePlatform() && 'Notification' in window && !this.hasPermission) {\n      await this.requestWebNotificationPermission();\n    }\n\n    try {\n      if (Capacitor.isNativePlatform()) {\n        await this.scheduleDailyCapacitor(config);\n      } else {\n        await this.scheduleDailyWeb(config);\n      }\n      \n      const permissionStatus = this.hasPermission ? 'with browser notifications' : 'with in-app notifications only';\n      console.log(`âœ“ Daily motivation scheduled for ${config.time} (${permissionStatus})`);\n      return true;\n    } catch (error) {\n      console.error('Failed to schedule daily motivation:', error);\n      throw error;\n    }\n  }\n\n  private async scheduleDailyCapacitor(config: NotificationConfig): Promise<void> {\n    // Cancel existing notifications\n    await LocalNotifications.cancel({ notifications: [{ id: 1 }] });\n\n    // Parse time\n    const [hours, minutes] = config.time.split(':').map(Number);\n    \n    // Calculate next notification time\n    const now = new Date();\n    const scheduledTime = new Date();\n    scheduledTime.setHours(hours, minutes, 0, 0);\n    \n    // If the time has passed today, schedule for tomorrow\n    if (scheduledTime <= now) {\n      scheduledTime.setDate(scheduledTime.getDate() + 1);\n    }\n\n    await LocalNotifications.schedule({\n      notifications: [\n        {\n          id: 1,\n          title: config.title,\n          body: config.body,\n          schedule: {\n            at: scheduledTime,\n            repeats: true,\n            every: 'day'\n          },\n          sound: 'default',\n          actionTypeId: 'COACHING_REMINDER',\n          extra: {\n            type: 'daily-coaching'\n          }\n        }\n      ]\n    });\n  }\n\n  private async scheduleDailyWeb(config: NotificationConfig): Promise<void> {\n    // Clear existing timer if any\n    this.cancelWebTimer();\n\n    // Parse time\n    const [hours, minutes] = config.time.split(':').map(Number);\n    \n    // Calculate milliseconds until next notification\n    const now = new Date();\n    const scheduledTime = new Date();\n    scheduledTime.setHours(hours, minutes, 0, 0);\n    \n    // If the time has passed today, schedule for tomorrow\n    if (scheduledTime <= now) {\n      scheduledTime.setDate(scheduledTime.getDate() + 1);\n    }\n\n    const timeUntilNotification = scheduledTime.getTime() - now.getTime();\n\n    // Store timer ID in localStorage for persistence\n    const timerId = setTimeout(async () => {\n      await this.showWebNotification(config);\n      // Schedule next day's notification\n      this.scheduleDailyWeb(config);\n    }, timeUntilNotification);\n\n    // Store the scheduled time for reference\n    localStorage.setItem('platemate-notification-timer', JSON.stringify({\n      scheduledTime: scheduledTime.getTime(),\n      config\n    }));\n  }\n\n  private async showWebNotification(config: NotificationConfig): Promise<void> {\n    // Always fetch and show motivational content, regardless of notification support\n    const motivationalContent = await this.getMotivationalContent();\n    \n    // Play notification sound\n    soundService.playReminder();\n    \n    // Always show in-app motivation (works without browser permission)\n    this.showInAppMotivation(motivationalContent);\n    \n    // Try browser notification if available (but don't require it)\n    if (this.hasPermission && 'Notification' in window && window.isSecureContext) {\n      try {\n        const notification = new Notification(motivationalContent.title, {\n          body: motivationalContent.body,\n          icon: '/favicon.ico',\n          badge: '/favicon.ico',\n          tag: 'daily-motivation',\n          requireInteraction: true,\n          silent: false\n        });\n\n        notification.onclick = () => {\n          window.focus();\n          if (window.location.pathname !== '/coaching') {\n            window.location.href = '/coaching';\n          }\n          notification.close();\n        };\n\n        // Auto-close after 30 seconds\n        setTimeout(() => {\n          if (notification) {\n            notification.close();\n          }\n        }, 30000);\n        \n        console.log('âœ“ Browser notification shown:', motivationalContent.title);\n      } catch (error) {\n        console.log('Browser notification failed, but in-app motivation still works:', error);\n      }\n    } else {\n      console.log('Browser notifications not available, using in-app motivation only');\n    }\n    \n    console.log('ðŸŒŸ Daily motivation delivered:', motivationalContent.body);\n  }\n\n  // Method to explicitly request notification permission\n  async requestWebNotificationPermission(): Promise<boolean> {\n    try {\n      if (!('Notification' in window)) {\n        console.log('Browser does not support notifications');\n        return false;\n      }\n\n      if (!window.isSecureContext) {\n        console.log('Notifications require secure context (HTTPS)');\n        return false;\n      }\n\n      if (Notification.permission === 'granted') {\n        this.hasPermission = true;\n        return true;\n      }\n\n      if (Notification.permission === 'denied') {\n        console.log('Notification permission was denied by user');\n        return false;\n      }\n\n      // Request permission\n      const permission = await Notification.requestPermission();\n      this.hasPermission = permission === 'granted';\n      \n      if (this.hasPermission) {\n        console.log('âœ“ Web notifications permission granted');\n      } else {\n        console.log('âœ— Web notifications permission denied');\n      }\n      \n      return this.hasPermission;\n    } catch (error) {\n      console.error('Failed to request notification permission:', error);\n      return false;\n    }\n  }\n\n  // Method to show a test notification\n  async showTestNotification(): Promise<void> {\n    const hasPermission = await this.requestWebNotificationPermission();\n    \n    if (hasPermission) {\n      try {\n        const notification = new Notification('PlateMate Test', {\n          body: 'ðŸ§ª This is a test notification! Your daily motivation will look like this.',\n          icon: '/favicon.ico',\n          tag: 'test-notification'\n        });\n        \n        notification.onclick = () => {\n          window.focus();\n          notification.close();\n        };\n        \n        setTimeout(() => notification.close(), 5000);\n        console.log('Test notification shown');\n      } catch (error) {\n        console.error('Failed to show test notification:', error);\n      }\n    } else {\n      // Show in-app test instead\n      this.showInAppMotivation({\n        title: 'PlateMate Test',\n        body: 'ðŸ§ª Browser notifications not available, but in-app motivation works!'\n      });\n    }\n  }\n\n  async cancelDaily(): Promise<void> {\n    try {\n      if (Capacitor.isNativePlatform()) {\n        await LocalNotifications.cancel({ notifications: [{ id: 1 }] });\n      } else {\n        this.cancelWebTimer();\n      }\n      \n      console.log('âœ“ Daily reminders cancelled');\n    } catch (error) {\n      console.error('Failed to cancel daily reminders:', error);\n    }\n  }\n\n  private cancelWebTimer(): void {\n    const storedTimer = localStorage.getItem('platemate-notification-timer');\n    if (storedTimer) {\n      localStorage.removeItem('platemate-notification-timer');\n    }\n  }\n\n  async testNotification(): Promise<void> {\n    // Initialize but don't require permission for test\n    await this.initialize();\n\n    const config: NotificationConfig = {\n      title: 'PlateMate Coaching',\n      body: 'Test notification - your daily motivation is ready! ðŸŒŸ',\n      time: '00:00',\n      enabled: true\n    };\n\n    if (Capacitor.isNativePlatform()) {\n      await LocalNotifications.schedule({\n        notifications: [\n          {\n            id: 999,\n            title: config.title,\n            body: config.body,\n            schedule: { at: new Date(Date.now() + 1000) },\n            sound: 'default'\n          }\n        ]\n      });\n    } else {\n      // Show in-app motivation immediately (works without permissions)\n      await soundService.playNotification();\n      await this.showWebNotification(config);\n    }\n  }\n\n  // Get motivational content from API\n  private async getMotivationalContent(): Promise<{title: string, body: string}> {\n    try {\n      // Try to fetch daily coaching content\n      const response = await fetch(buildApiUrl('/api/coaching/daily'));\n      if (response.ok) {\n        const data = await response.json();\n        return {\n          title: 'ðŸŒŸ Daily Motivation',\n          body: data.motivation || 'Stay focused on your health goals! Every small step counts.'\n        };\n      }\n    } catch (error) {\n      console.log('Could not fetch coaching content, using fallback');\n    }\n    \n    // Fallback motivational quotes\n    const fallbackQuotes = [\n      'Today is a new opportunity to nourish your body! ðŸ’ª',\n      'Small steps lead to big changes. Keep going! âœ¨', \n      'Your health journey matters. Stay consistent! ðŸŒ±',\n      'Fuel your body with intention and watch yourself thrive! ðŸ”¥',\n      'Every meal is a chance to love yourself better! â¤ï¸'\n    ];\n    const randomQuote = fallbackQuotes[Math.floor(Math.random() * fallbackQuotes.length)];\n    \n    return {\n      title: 'ðŸŒŸ Daily Motivation',\n      body: randomQuote\n    };\n  }\n\n  // Show in-app motivation toast\n  private showInAppMotivation(content: {title: string, body: string}): void {\n    // Create a temporary toast element for in-app display\n    const toastElement = document.createElement('div');\n    toastElement.className = 'fixed top-4 left-1/2 transform -translate-x-1/2 z-50 bg-gradient-to-r from-purple-500 to-pink-500 text-white p-4 rounded-lg shadow-2xl max-w-sm text-center backdrop-blur-sm border border-white/20';\n    toastElement.innerHTML = `\n      <div class=\"font-bold text-lg mb-1\">${content.title}</div>\n      <div class=\"text-sm opacity-90\">${content.body}</div>\n    `;\n    \n    document.body.appendChild(toastElement);\n    \n    // Animate in\n    toastElement.style.transform = 'translate(-50%, -100%)';\n    toastElement.style.opacity = '0';\n    \n    setTimeout(() => {\n      toastElement.style.transition = 'all 0.3s ease-out';\n      toastElement.style.transform = 'translate(-50%, 0)';\n      toastElement.style.opacity = '1';\n    }, 10);\n    \n    // Remove after 8 seconds\n    setTimeout(() => {\n      toastElement.style.transition = 'all 0.3s ease-in';\n      toastElement.style.transform = 'translate(-50%, -100%)';\n      toastElement.style.opacity = '0';\n      setTimeout(() => {\n        if (toastElement.parentNode) {\n          toastElement.parentNode.removeChild(toastElement);\n        }\n      }, 300);\n    }, 8000);\n    \n    // Click to dismiss\n    toastElement.addEventListener('click', () => {\n      toastElement.style.transition = 'all 0.2s ease-in';\n      toastElement.style.transform = 'translate(-50%, -100%)';\n      toastElement.style.opacity = '0';\n      setTimeout(() => {\n        if (toastElement.parentNode) {\n          toastElement.parentNode.removeChild(toastElement);\n        }\n      }, 200);\n    });\n  }\n\n  // Resume web notifications on app load (for web only)\n  resumeWebNotifications(): void {\n    if (Capacitor.isNativePlatform()) return;\n\n    const storedTimer = localStorage.getItem('platemate-notification-timer');\n    if (storedTimer) {\n      try {\n        const { scheduledTime, config } = JSON.parse(storedTimer);\n        const now = Date.now();\n        \n        if (scheduledTime > now) {\n          // Notification is still pending, reschedule it\n          const timeRemaining = scheduledTime - now;\n          setTimeout(() => {\n            this.showWebNotification(config);\n            this.scheduleDailyWeb(config);\n          }, timeRemaining);\n        } else {\n          // Scheduled time has passed, schedule for next day\n          this.scheduleDailyWeb(config);\n        }\n      } catch (error) {\n        console.error('Failed to resume web notifications:', error);\n        localStorage.removeItem('platemate-notification-timer');\n      }\n    }\n  }\n}\n\nexport const notificationService = new NotificationService();","size_bytes":15141},"client/src/pages/calculator.tsx":{"content":"import React from 'react';\nimport { NutritionCalculator } from '@/components/nutrition-calculator';\nimport { CalorieCalculator } from '@/components/calorie-calculator';\nimport { useQuery } from '@tanstack/react-query';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Calculator, Target, ArrowLeft } from 'lucide-react';\nimport { Link } from 'wouter';\nimport type { DiaryEntry, DrinkEntry, FoodAnalysis, DiaryEntryWithAnalysis, NutritionGoals } from '@shared/schema';\nimport { DropdownNavigation } from '@/components/dropdown-navigation';\nimport { BottomHelpSection } from '@/components/bottom-help-section';\nimport { motion } from 'framer-motion';\n\nexport default function CalculatorPage() {\n  // Fetch nutrition goals\n  const { data: goals, isLoading: goalsLoading } = useQuery<NutritionGoals>({\n    queryKey: ['/api/nutrition-goals'],\n    retry: false,\n  });\n\n  // Fetch today's diary entries\n  const { data: diaryEntries = [], isLoading: diaryLoading } = useQuery<DiaryEntryWithAnalysis[]>({\n    queryKey: ['/api/diary'],\n    retry: false,\n  });\n\n  // Fetch today's drink entries\n  const { data: drinkEntries = [], isLoading: drinksLoading } = useQuery<DrinkEntry[]>({\n    queryKey: ['/api/drinks'],\n    retry: false,\n  });\n\n  // Calculate today's consumed nutrition\n  const consumed = React.useMemo(() => {\n    // Get today's date in YYYY-MM-DD format\n    const today = new Date().toISOString().split('T')[0];\n\n    // Filter entries for today only\n    const todayEntries = diaryEntries.filter(entry => {\n      if (!entry.mealDate) return false;\n      const entryDate = new Date(entry.mealDate).toISOString().split('T')[0];\n      return entryDate === today;\n    });\n\n    const todayDrinks = drinkEntries.filter(drink => {\n      if (!drink.loggedAt) return false;\n      const drinkDate = new Date(drink.loggedAt).toISOString().split('T')[0];\n      return drinkDate === today;\n    });\n\n    // Calculate food nutrition for today\n    const foodNutrition = todayEntries.reduce((total, entry) => {\n      return {\n        calories: total.calories + (entry.analysis?.totalCalories || 0),\n        protein: total.protein + (entry.analysis?.totalProtein || 0),\n        carbs: total.carbs + (entry.analysis?.totalCarbs || 0),\n        fat: total.fat + (entry.analysis?.totalFat || 0),\n      };\n    }, { calories: 0, protein: 0, carbs: 0, fat: 0 });\n    \n    // Calculate drink calories and water for today\n    const drinkCalories = todayDrinks.reduce((total, drink) => {\n      return total + (drink.calories || 0);\n    }, 0);\n    \n    const water = todayDrinks.reduce((total, drink) => {\n      // Only count water-type drinks toward hydration\n      if (['water', 'tea', 'coffee'].includes(drink.drinkType)) {\n        return total + drink.amount;\n      }\n      return total;\n    }, 0);\n    \n    return {\n      calories: foodNutrition.calories + drinkCalories,\n      protein: foodNutrition.protein,\n      carbs: foodNutrition.carbs,\n      fat: foodNutrition.fat,\n      water: water,\n    };\n  }, [diaryEntries, drinkEntries]);\n\n  // Show loading state\n  if (goalsLoading || diaryLoading || drinksLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\n          <p className=\"text-muted-foreground\">Loading your nutrition data...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <motion.div \n      initial={{ opacity: 0, scale: 0.95, y: 20 }}\n      animate={{ opacity: 1, scale: 1, y: 0 }}\n      transition={{ duration: 0.6, ease: \"easeOut\" }}\n      className=\"min-h-screen text-foreground\" \n      style={{background: 'var(--bg-gradient)'}}\n    >\n      {/* Header */}\n      <div className=\"bg-card border-b\">\n        <div className=\"max-w-md mx-auto px-4 py-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-3\">\n              <Link href=\"/\">\n                <button \n                  className=\"p-2 hover:bg-muted rounded-lg transition-colors\"\n                  data-testid=\"button-back-to-home\"\n                >\n                  <ArrowLeft className=\"h-5 w-5\" />\n                </button>\n              </Link>\n              <h1 className=\"text-xl font-bold\">Smart Nutrition Calculator</h1>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"container mx-auto p-6 space-y-8\">\n        <Tabs defaultValue=\"personal\" className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-2 p-2 bg-gradient-to-r from-gray-100 to-gray-200 dark:from-gray-800 dark:to-gray-700 rounded-xl\">\n            <TabsTrigger value=\"personal\" className=\"flex items-center gap-2 px-6 py-3 rounded-lg font-semibold transition-all duration-200 data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-500 data-[state=active]:to-purple-500 data-[state=active]:text-white data-[state=active]:shadow-lg\" data-testid=\"tab-personal-calculator\">\n              <Target className=\"h-4 w-4\" />\n              Personal Calculator\n            </TabsTrigger>\n            <TabsTrigger value=\"nutrition\" className=\"flex items-center gap-2 px-6 py-3 rounded-lg font-semibold transition-all duration-200 data-[state=active]:bg-gradient-to-r data-[state=active]:from-green-500 data-[state=active]:to-emerald-500 data-[state=active]:text-white data-[state=active]:shadow-lg\" data-testid=\"tab-nutrition-planner\">\n              <Calculator className=\"h-4 w-4\" />\n              Nutrition Planner\n            </TabsTrigger>\n          </TabsList>\n          \n          <TabsContent value=\"personal\" data-testid=\"content-personal-calculator\">\n            <CalorieCalculator />\n          </TabsContent>\n          \n          <TabsContent value=\"nutrition\" data-testid=\"content-nutrition-planner\">\n            <NutritionCalculator goals={goals} consumed={consumed} />\n          </TabsContent>\n        </Tabs>\n      </div>\n      \n      {/* Bottom Navigation */}\n      <DropdownNavigation />\n      \n      {/* Bottom Help Section */}\n      <BottomHelpSection />\n    </motion.div>\n  );\n}","size_bytes":6179},"client/src/components/error-state.tsx":{"content":"import { AlertTriangle, ArrowLeft, QrCode } from \"lucide-react\";\n\ninterface ErrorStateProps {\n  message: string;\n  onRetry: () => void;\n  type?: 'food' | 'barcode';\n}\n\nexport function ErrorState({ message, onRetry, type = 'food' }: ErrorStateProps) {\n  const isBarcode = type === 'barcode';\n  \n  return (\n    <div className=\"p-6\">\n      <div className=\"bg-card rounded-xl shadow-lg p-8 text-center\">\n        <div className=\"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n          {isBarcode ? (\n            <QrCode className=\"text-red-500 h-8 w-8\" />\n          ) : (\n            <AlertTriangle className=\"text-red-500 h-8 w-8\" />\n          )}\n        </div>\n        <h3 className=\"text-lg font-semibold mb-2\" data-testid=\"text-error-title\">\n          {isBarcode ? \"Unable to Scan Barcode\" : \"Unable to Analyze Image\"}\n        </h3>\n        <p className=\"text-muted-foreground mb-4\" data-testid=\"text-error-message\">\n          {message || (isBarcode ? \n            \"We couldn't detect a barcode in this image. Please try:\" : \n            \"We couldn't identify any food items in this image. Please try:\"\n          )}\n        </p>\n        <ul className=\"text-sm text-muted-foreground text-left mb-6 space-y-1\">\n          {isBarcode ? (\n            <>\n              <li>â€¢ Position barcode clearly in frame</li>\n              <li>â€¢ Ensure good lighting on the barcode</li>\n              <li>â€¢ Make sure barcode is not damaged</li>\n              <li>â€¢ Try manual entry if scanning fails</li>\n            </>\n          ) : (\n            <>\n              <li>â€¢ Ensure good lighting</li>\n              <li>â€¢ Position the plate clearly in frame</li>\n              <li>â€¢ Remove any obstructions</li>\n              <li>â€¢ Take photo from above the plate</li>\n            </>\n          )}\n        </ul>\n        <div className=\"flex gap-3 justify-center\">\n          <button \n            className=\"flex items-center gap-2 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 px-6 py-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors\"\n            onClick={onRetry}\n            data-testid=\"button-back\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n            Back\n          </button>\n          <button \n            className=\"bg-primary text-primary-foreground px-6 py-2 rounded-lg hover:bg-primary/90 transition-colors\"\n            onClick={onRetry}\n            data-testid=\"button-retry\"\n          >\n            {isBarcode ? \"Try Again\" : \"Try Again\"}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":2601},"ios/App/App/public/assets/index-BfQ6GJWf.js":{"content":"var Rte=Object.defineProperty;var fk=t=>{throw TypeError(t)};var Fte=(t,e,r)=>e in t?Rte(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var te=(t,e,r)=>Fte(t,typeof e!=\"symbol\"?e+\"\":e,r),Iw=(t,e,r)=>e.has(t)||fk(\"Cannot \"+r);var Y=(t,e,r)=>(Iw(t,e,\"read from private field\"),r?r.call(t):e.get(t)),rt=(t,e,r)=>e.has(t)?fk(\"Cannot add the same private member more than once\"):e instanceof WeakSet?e.add(t):e.set(t,r),Le=(t,e,r,n)=>(Iw(t,e,\"write to private field\"),n?n.call(t,r):e.set(t,r),r),St=(t,e,r)=>(Iw(t,e,\"access private method\"),r);var zg=(t,e,r,n)=>({set _(i){Le(t,e,i,r)},get _(){return Y(t,e,n)}});function Lte(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!=\"string\"&&!Array.isArray(n)){for(const i in n)if(i!==\"default\"&&!(i in t)){const a=Object.getOwnPropertyDescriptor(n,i);a&&Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}))}(function(){const e=document.createElement(\"link\").relList;if(e&&e.supports&&e.supports(\"modulepreload\"))return;for(const i of document.querySelectorAll('link[rel=\"modulepreload\"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type===\"childList\")for(const o of a.addedNodes)o.tagName===\"LINK\"&&o.rel===\"modulepreload\"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin===\"use-credentials\"?a.credentials=\"include\":i.crossOrigin===\"anonymous\"?a.credentials=\"omit\":a.credentials=\"same-origin\",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var Wg=typeof globalThis<\"u\"?globalThis:typeof window<\"u\"?window:typeof global<\"u\"?global:typeof self<\"u\"?self:{};function or(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,\"default\")?t.default:t}var Mw={exports:{}},Hh={},Dw={exports:{}},jt={};/**\n * @license React\n * react.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */var hk;function Bte(){if(hk)return jt;hk=1;var t=Symbol.for(\"react.element\"),e=Symbol.for(\"react.portal\"),r=Symbol.for(\"react.fragment\"),n=Symbol.for(\"react.strict_mode\"),i=Symbol.for(\"react.profiler\"),a=Symbol.for(\"react.provider\"),o=Symbol.for(\"react.context\"),s=Symbol.for(\"react.forward_ref\"),c=Symbol.for(\"react.suspense\"),u=Symbol.for(\"react.memo\"),f=Symbol.for(\"react.lazy\"),h=Symbol.iterator;function m(L){return L===null||typeof L!=\"object\"?null:(L=h&&L[h]||L[\"@@iterator\"],typeof L==\"function\"?L:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,v={};function b(L,J,ge){this.props=L,this.context=J,this.refs=v,this.updater=ge||g}b.prototype.isReactComponent={},b.prototype.setState=function(L,J){if(typeof L!=\"object\"&&typeof L!=\"function\"&&L!=null)throw Error(\"setState(...): takes an object of state variables to update or a function which returns an object of state variables.\");this.updater.enqueueSetState(this,L,J,\"setState\")},b.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,\"forceUpdate\")};function w(){}w.prototype=b.prototype;function C(L,J,ge){this.props=L,this.context=J,this.refs=v,this.updater=ge||g}var _=C.prototype=new w;_.constructor=C,x(_,b.prototype),_.isPureReactComponent=!0;var N=Array.isArray,A=Object.prototype.hasOwnProperty,T={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function k(L,J,ge){var Te,Fe={},Me=null,je=null;if(J!=null)for(Te in J.ref!==void 0&&(je=J.ref),J.key!==void 0&&(Me=\"\"+J.key),J)A.call(J,Te)&&!P.hasOwnProperty(Te)&&(Fe[Te]=J[Te]);var Ae=arguments.length-2;if(Ae===1)Fe.children=ge;else if(1<Ae){for(var fe=Array(Ae),_e=0;_e<Ae;_e++)fe[_e]=arguments[_e+2];Fe.children=fe}if(L&&L.defaultProps)for(Te in Ae=L.defaultProps,Ae)Fe[Te]===void 0&&(Fe[Te]=Ae[Te]);return{$$typeof:t,type:L,key:Me,ref:je,props:Fe,_owner:T.current}}function I(L,J){return{$$typeof:t,type:L.type,key:J,ref:L.ref,props:L.props,_owner:L._owner}}function R(L){return typeof L==\"object\"&&L!==null&&L.$$typeof===t}function F(L){var J={\"=\":\"=0\",\":\":\"=2\"};return\"$\"+L.replace(/[=:]/g,function(ge){return J[ge]})}var D=/\\/+/g;function B(L,J){return typeof L==\"object\"&&L!==null&&L.key!=null?F(\"\"+L.key):J.toString(36)}function q(L,J,ge,Te,Fe){var Me=typeof L;(Me===\"undefined\"||Me===\"boolean\")&&(L=null);var je=!1;if(L===null)je=!0;else switch(Me){case\"string\":case\"number\":je=!0;break;case\"object\":switch(L.$$typeof){case t:case e:je=!0}}if(je)return je=L,Fe=Fe(je),L=Te===\"\"?\".\"+B(je,0):Te,N(Fe)?(ge=\"\",L!=null&&(ge=L.replace(D,\"$&/\")+\"/\"),q(Fe,J,ge,\"\",function(_e){return _e})):Fe!=null&&(R(Fe)&&(Fe=I(Fe,ge+(!Fe.key||je&&je.key===Fe.key?\"\":(\"\"+Fe.key).replace(D,\"$&/\")+\"/\")+L)),J.push(Fe)),1;if(je=0,Te=Te===\"\"?\".\":Te+\":\",N(L))for(var Ae=0;Ae<L.length;Ae++){Me=L[Ae];var fe=Te+B(Me,Ae);je+=q(Me,J,ge,fe,Fe)}else if(fe=m(L),typeof fe==\"function\")for(L=fe.call(L),Ae=0;!(Me=L.next()).done;)Me=Me.value,fe=Te+B(Me,Ae++),je+=q(Me,J,ge,fe,Fe);else if(Me===\"object\")throw J=String(L),Error(\"Objects are not valid as a React child (found: \"+(J===\"[object Object]\"?\"object with keys {\"+Object.keys(L).join(\", \")+\"}\":J)+\"). If you meant to render a collection of children, use an array instead.\");return je}function V(L,J,ge){if(L==null)return L;var Te=[],Fe=0;return q(L,Te,\"\",\"\",function(Me){return J.call(ge,Me,Fe++)}),Te}function z(L){if(L._status===-1){var J=L._result;J=J(),J.then(function(ge){(L._status===0||L._status===-1)&&(L._status=1,L._result=ge)},function(ge){(L._status===0||L._status===-1)&&(L._status=2,L._result=ge)}),L._status===-1&&(L._status=0,L._result=J)}if(L._status===1)return L._result.default;throw L._result}var G={current:null},W={transition:null},re={ReactCurrentDispatcher:G,ReactCurrentBatchConfig:W,ReactCurrentOwner:T};function ne(){throw Error(\"act(...) is not supported in production builds of React.\")}return jt.Children={map:V,forEach:function(L,J,ge){V(L,function(){J.apply(this,arguments)},ge)},count:function(L){var J=0;return V(L,function(){J++}),J},toArray:function(L){return V(L,function(J){return J})||[]},only:function(L){if(!R(L))throw Error(\"React.Children.only expected to receive a single React element child.\");return L}},jt.Component=b,jt.Fragment=r,jt.Profiler=i,jt.PureComponent=C,jt.StrictMode=n,jt.Suspense=c,jt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=re,jt.act=ne,jt.cloneElement=function(L,J,ge){if(L==null)throw Error(\"React.cloneElement(...): The argument must be a React element, but you passed \"+L+\".\");var Te=x({},L.props),Fe=L.key,Me=L.ref,je=L._owner;if(J!=null){if(J.ref!==void 0&&(Me=J.ref,je=T.current),J.key!==void 0&&(Fe=\"\"+J.key),L.type&&L.type.defaultProps)var Ae=L.type.defaultProps;for(fe in J)A.call(J,fe)&&!P.hasOwnProperty(fe)&&(Te[fe]=J[fe]===void 0&&Ae!==void 0?Ae[fe]:J[fe])}var fe=arguments.length-2;if(fe===1)Te.children=ge;else if(1<fe){Ae=Array(fe);for(var _e=0;_e<fe;_e++)Ae[_e]=arguments[_e+2];Te.children=Ae}return{$$typeof:t,type:L.type,key:Fe,ref:Me,props:Te,_owner:je}},jt.createContext=function(L){return L={$$typeof:o,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},L.Provider={$$typeof:a,_context:L},L.Consumer=L},jt.createElement=k,jt.createFactory=function(L){var J=k.bind(null,L);return J.type=L,J},jt.createRef=function(){return{current:null}},jt.forwardRef=function(L){return{$$typeof:s,render:L}},jt.isValidElement=R,jt.lazy=function(L){return{$$typeof:f,_payload:{_status:-1,_result:L},_init:z}},jt.memo=function(L,J){return{$$typeof:u,type:L,compare:J===void 0?null:J}},jt.startTransition=function(L){var J=W.transition;W.transition={};try{L()}finally{W.transition=J}},jt.unstable_act=ne,jt.useCallback=function(L,J){return G.current.useCallback(L,J)},jt.useContext=function(L){return G.current.useContext(L)},jt.useDebugValue=function(){},jt.useDeferredValue=function(L){return G.current.useDeferredValue(L)},jt.useEffect=function(L,J){return G.current.useEffect(L,J)},jt.useId=function(){return G.current.useId()},jt.useImperativeHandle=function(L,J,ge){return G.current.useImperativeHandle(L,J,ge)},jt.useInsertionEffect=function(L,J){return G.current.useInsertionEffect(L,J)},jt.useLayoutEffect=function(L,J){return G.current.useLayoutEffect(L,J)},jt.useMemo=function(L,J){return G.current.useMemo(L,J)},jt.useReducer=function(L,J,ge){return G.current.useReducer(L,J,ge)},jt.useRef=function(L){return G.current.useRef(L)},jt.useState=function(L){return G.current.useState(L)},jt.useSyncExternalStore=function(L,J,ge){return G.current.useSyncExternalStore(L,J,ge)},jt.useTransition=function(){return G.current.useTransition()},jt.version=\"18.3.1\",jt}var pk;function Ex(){return pk||(pk=1,Dw.exports=Bte()),Dw.exports}/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */var mk;function $te(){if(mk)return Hh;mk=1;var t=Ex(),e=Symbol.for(\"react.element\"),r=Symbol.for(\"react.fragment\"),n=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function o(s,c,u){var f,h={},m=null,g=null;u!==void 0&&(m=\"\"+u),c.key!==void 0&&(m=\"\"+c.key),c.ref!==void 0&&(g=c.ref);for(f in c)n.call(c,f)&&!a.hasOwnProperty(f)&&(h[f]=c[f]);if(s&&s.defaultProps)for(f in c=s.defaultProps,c)h[f]===void 0&&(h[f]=c[f]);return{$$typeof:e,type:s,key:m,ref:g,props:h,_owner:i.current}}return Hh.Fragment=r,Hh.jsx=o,Hh.jsxs=o,Hh}var gk;function Vte(){return gk||(gk=1,Mw.exports=$te()),Mw.exports}var l=Vte(),qg={},Rw={exports:{}},Ii={},Fw={exports:{}},Lw={};/**\n * @license React\n * scheduler.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */var vk;function Ute(){return vk||(vk=1,(function(t){function e(W,re){var ne=W.length;W.push(re);e:for(;0<ne;){var L=ne-1>>>1,J=W[L];if(0<i(J,re))W[L]=re,W[ne]=J,ne=L;else break e}}function r(W){return W.length===0?null:W[0]}function n(W){if(W.length===0)return null;var re=W[0],ne=W.pop();if(ne!==re){W[0]=ne;e:for(var L=0,J=W.length,ge=J>>>1;L<ge;){var Te=2*(L+1)-1,Fe=W[Te],Me=Te+1,je=W[Me];if(0>i(Fe,ne))Me<J&&0>i(je,Fe)?(W[L]=je,W[Me]=ne,L=Me):(W[L]=Fe,W[Te]=ne,L=Te);else if(Me<J&&0>i(je,ne))W[L]=je,W[Me]=ne,L=Me;else break e}}return re}function i(W,re){var ne=W.sortIndex-re.sortIndex;return ne!==0?ne:W.id-re.id}if(typeof performance==\"object\"&&typeof performance.now==\"function\"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,s=o.now();t.unstable_now=function(){return o.now()-s}}var c=[],u=[],f=1,h=null,m=3,g=!1,x=!1,v=!1,b=typeof setTimeout==\"function\"?setTimeout:null,w=typeof clearTimeout==\"function\"?clearTimeout:null,C=typeof setImmediate<\"u\"?setImmediate:null;typeof navigator<\"u\"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(W){for(var re=r(u);re!==null;){if(re.callback===null)n(u);else if(re.startTime<=W)n(u),re.sortIndex=re.expirationTime,e(c,re);else break;re=r(u)}}function N(W){if(v=!1,_(W),!x)if(r(c)!==null)x=!0,z(A);else{var re=r(u);re!==null&&G(N,re.startTime-W)}}function A(W,re){x=!1,v&&(v=!1,w(k),k=-1),g=!0;var ne=m;try{for(_(re),h=r(c);h!==null&&(!(h.expirationTime>re)||W&&!F());){var L=h.callback;if(typeof L==\"function\"){h.callback=null,m=h.priorityLevel;var J=L(h.expirationTime<=re);re=t.unstable_now(),typeof J==\"function\"?h.callback=J:h===r(c)&&n(c),_(re)}else n(c);h=r(c)}if(h!==null)var ge=!0;else{var Te=r(u);Te!==null&&G(N,Te.startTime-re),ge=!1}return ge}finally{h=null,m=ne,g=!1}}var T=!1,P=null,k=-1,I=5,R=-1;function F(){return!(t.unstable_now()-R<I)}function D(){if(P!==null){var W=t.unstable_now();R=W;var re=!0;try{re=P(!0,W)}finally{re?B():(T=!1,P=null)}}else T=!1}var B;if(typeof C==\"function\")B=function(){C(D)};else if(typeof MessageChannel<\"u\"){var q=new MessageChannel,V=q.port2;q.port1.onmessage=D,B=function(){V.postMessage(null)}}else B=function(){b(D,0)};function z(W){P=W,T||(T=!0,B())}function G(W,re){k=b(function(){W(t.unstable_now())},re)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(W){W.callback=null},t.unstable_continueExecution=function(){x||g||(x=!0,z(A))},t.unstable_forceFrameRate=function(W){0>W||125<W?console.error(\"forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported\"):I=0<W?Math.floor(1e3/W):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(W){switch(m){case 1:case 2:case 3:var re=3;break;default:re=m}var ne=m;m=re;try{return W()}finally{m=ne}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(W,re){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var ne=m;m=W;try{return re()}finally{m=ne}},t.unstable_scheduleCallback=function(W,re,ne){var L=t.unstable_now();switch(typeof ne==\"object\"&&ne!==null?(ne=ne.delay,ne=typeof ne==\"number\"&&0<ne?L+ne:L):ne=L,W){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=ne+J,W={id:f++,callback:re,priorityLevel:W,startTime:ne,expirationTime:J,sortIndex:-1},ne>L?(W.sortIndex=ne,e(u,W),r(c)===null&&W===r(u)&&(v?(w(k),k=-1):v=!0,G(N,ne-L))):(W.sortIndex=J,e(c,W),x||g||(x=!0,z(A))),W},t.unstable_shouldYield=F,t.unstable_wrapCallback=function(W){var re=m;return function(){var ne=m;m=re;try{return W.apply(this,arguments)}finally{m=ne}}}})(Lw)),Lw}var yk;function zte(){return yk||(yk=1,Fw.exports=Ute()),Fw.exports}/**\n * @license React\n * react-dom.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */var xk;function Wte(){if(xk)return Ii;xk=1;var t=Ex(),e=zte();function r(d){for(var p=\"https://reactjs.org/docs/error-decoder.html?invariant=\"+d,y=1;y<arguments.length;y++)p+=\"&args[]=\"+encodeURIComponent(arguments[y]);return\"Minified React error #\"+d+\"; visit \"+p+\" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.\"}var n=new Set,i={};function a(d,p){o(d,p),o(d+\"Capture\",p)}function o(d,p){for(i[d]=p,d=0;d<p.length;d++)n.add(p[d])}var s=!(typeof window>\"u\"||typeof window.document>\"u\"||typeof window.document.createElement>\"u\"),c=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$/,f={},h={};function m(d){return c.call(h,d)?!0:c.call(f,d)?!1:u.test(d)?h[d]=!0:(f[d]=!0,!1)}function g(d,p,y,S){if(y!==null&&y.type===0)return!1;switch(typeof p){case\"function\":case\"symbol\":return!0;case\"boolean\":return S?!1:y!==null?!y.acceptsBooleans:(d=d.toLowerCase().slice(0,5),d!==\"data-\"&&d!==\"aria-\");default:return!1}}function x(d,p,y,S){if(p===null||typeof p>\"u\"||g(d,p,y,S))return!0;if(S)return!1;if(y!==null)switch(y.type){case 3:return!p;case 4:return p===!1;case 5:return isNaN(p);case 6:return isNaN(p)||1>p}return!1}function v(d,p,y,S,j,O,M){this.acceptsBooleans=p===2||p===3||p===4,this.attributeName=S,this.attributeNamespace=j,this.mustUseProperty=y,this.propertyName=d,this.type=p,this.sanitizeURL=O,this.removeEmptyString=M}var b={};\"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style\".split(\" \").forEach(function(d){b[d]=new v(d,0,!1,d,null,!1,!1)}),[[\"acceptCharset\",\"accept-charset\"],[\"className\",\"class\"],[\"htmlFor\",\"for\"],[\"httpEquiv\",\"http-equiv\"]].forEach(function(d){var p=d[0];b[p]=new v(p,1,!1,d[1],null,!1,!1)}),[\"contentEditable\",\"draggable\",\"spellCheck\",\"value\"].forEach(function(d){b[d]=new v(d,2,!1,d.toLowerCase(),null,!1,!1)}),[\"autoReverse\",\"externalResourcesRequired\",\"focusable\",\"preserveAlpha\"].forEach(function(d){b[d]=new v(d,2,!1,d,null,!1,!1)}),\"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope\".split(\" \").forEach(function(d){b[d]=new v(d,3,!1,d.toLowerCase(),null,!1,!1)}),[\"checked\",\"multiple\",\"muted\",\"selected\"].forEach(function(d){b[d]=new v(d,3,!0,d,null,!1,!1)}),[\"capture\",\"download\"].forEach(function(d){b[d]=new v(d,4,!1,d,null,!1,!1)}),[\"cols\",\"rows\",\"size\",\"span\"].forEach(function(d){b[d]=new v(d,6,!1,d,null,!1,!1)}),[\"rowSpan\",\"start\"].forEach(function(d){b[d]=new v(d,5,!1,d.toLowerCase(),null,!1,!1)});var w=/[\\-:]([a-z])/g;function C(d){return d[1].toUpperCase()}\"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height\".split(\" \").forEach(function(d){var p=d.replace(w,C);b[p]=new v(p,1,!1,d,null,!1,!1)}),\"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type\".split(\" \").forEach(function(d){var p=d.replace(w,C);b[p]=new v(p,1,!1,d,\"http://www.w3.org/1999/xlink\",!1,!1)}),[\"xml:base\",\"xml:lang\",\"xml:space\"].forEach(function(d){var p=d.replace(w,C);b[p]=new v(p,1,!1,d,\"http://www.w3.org/XML/1998/namespace\",!1,!1)}),[\"tabIndex\",\"crossOrigin\"].forEach(function(d){b[d]=new v(d,1,!1,d.toLowerCase(),null,!1,!1)}),b.xlinkHref=new v(\"xlinkHref\",1,!1,\"xlink:href\",\"http://www.w3.org/1999/xlink\",!0,!1),[\"src\",\"href\",\"action\",\"formAction\"].forEach(function(d){b[d]=new v(d,1,!1,d.toLowerCase(),null,!0,!0)});function _(d,p,y,S){var j=b.hasOwnProperty(p)?b[p]:null;(j!==null?j.type!==0:S||!(2<p.length)||p[0]!==\"o\"&&p[0]!==\"O\"||p[1]!==\"n\"&&p[1]!==\"N\")&&(x(p,y,j,S)&&(y=null),S||j===null?m(p)&&(y===null?d.removeAttribute(p):d.setAttribute(p,\"\"+y)):j.mustUseProperty?d[j.propertyName]=y===null?j.type===3?!1:\"\":y:(p=j.attributeName,S=j.attributeNamespace,y===null?d.removeAttribute(p):(j=j.type,y=j===3||j===4&&y===!0?\"\":\"\"+y,S?d.setAttributeNS(S,p,y):d.setAttribute(p,y))))}var N=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,A=Symbol.for(\"react.element\"),T=Symbol.for(\"react.portal\"),P=Symbol.for(\"react.fragment\"),k=Symbol.for(\"react.strict_mode\"),I=Symbol.for(\"react.profiler\"),R=Symbol.for(\"react.provider\"),F=Symbol.for(\"react.context\"),D=Symbol.for(\"react.forward_ref\"),B=Symbol.for(\"react.suspense\"),q=Symbol.for(\"react.suspense_list\"),V=Symbol.for(\"react.memo\"),z=Symbol.for(\"react.lazy\"),G=Symbol.for(\"react.offscreen\"),W=Symbol.iterator;function re(d){return d===null||typeof d!=\"object\"?null:(d=W&&d[W]||d[\"@@iterator\"],typeof d==\"function\"?d:null)}var ne=Object.assign,L;function J(d){if(L===void 0)try{throw Error()}catch(y){var p=y.stack.trim().match(/\\n( *(at )?)/);L=p&&p[1]||\"\"}return`\n`+L+d}var ge=!1;function Te(d,p){if(!d||ge)return\"\";ge=!0;var y=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(p)if(p=function(){throw Error()},Object.defineProperty(p.prototype,\"props\",{set:function(){throw Error()}}),typeof Reflect==\"object\"&&Reflect.construct){try{Reflect.construct(p,[])}catch(se){var S=se}Reflect.construct(d,[],p)}else{try{p.call()}catch(se){S=se}d.call(p.prototype)}else{try{throw Error()}catch(se){S=se}d()}}catch(se){if(se&&S&&typeof se.stack==\"string\"){for(var j=se.stack.split(`\n`),O=S.stack.split(`\n`),M=j.length-1,H=O.length-1;1<=M&&0<=H&&j[M]!==O[H];)H--;for(;1<=M&&0<=H;M--,H--)if(j[M]!==O[H]){if(M!==1||H!==1)do if(M--,H--,0>H||j[M]!==O[H]){var Q=`\n`+j[M].replace(\" at new \",\" at \");return d.displayName&&Q.includes(\"<anonymous>\")&&(Q=Q.replace(\"<anonymous>\",d.displayName)),Q}while(1<=M&&0<=H);break}}}finally{ge=!1,Error.prepareStackTrace=y}return(d=d?d.displayName||d.name:\"\")?J(d):\"\"}function Fe(d){switch(d.tag){case 5:return J(d.type);case 16:return J(\"Lazy\");case 13:return J(\"Suspense\");case 19:return J(\"SuspenseList\");case 0:case 2:case 15:return d=Te(d.type,!1),d;case 11:return d=Te(d.type.render,!1),d;case 1:return d=Te(d.type,!0),d;default:return\"\"}}function Me(d){if(d==null)return null;if(typeof d==\"function\")return d.displayName||d.name||null;if(typeof d==\"string\")return d;switch(d){case P:return\"Fragment\";case T:return\"Portal\";case I:return\"Profiler\";case k:return\"StrictMode\";case B:return\"Suspense\";case q:return\"SuspenseList\"}if(typeof d==\"object\")switch(d.$$typeof){case F:return(d.displayName||\"Context\")+\".Consumer\";case R:return(d._context.displayName||\"Context\")+\".Provider\";case D:var p=d.render;return d=d.displayName,d||(d=p.displayName||p.name||\"\",d=d!==\"\"?\"ForwardRef(\"+d+\")\":\"ForwardRef\"),d;case V:return p=d.displayName||null,p!==null?p:Me(d.type)||\"Memo\";case z:p=d._payload,d=d._init;try{return Me(d(p))}catch{}}return null}function je(d){var p=d.type;switch(d.tag){case 24:return\"Cache\";case 9:return(p.displayName||\"Context\")+\".Consumer\";case 10:return(p._context.displayName||\"Context\")+\".Provider\";case 18:return\"DehydratedFragment\";case 11:return d=p.render,d=d.displayName||d.name||\"\",p.displayName||(d!==\"\"?\"ForwardRef(\"+d+\")\":\"ForwardRef\");case 7:return\"Fragment\";case 5:return p;case 4:return\"Portal\";case 3:return\"Root\";case 6:return\"Text\";case 16:return Me(p);case 8:return p===k?\"StrictMode\":\"Mode\";case 22:return\"Offscreen\";case 12:return\"Profiler\";case 21:return\"Scope\";case 13:return\"Suspense\";case 19:return\"SuspenseList\";case 25:return\"TracingMarker\";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof p==\"function\")return p.displayName||p.name||null;if(typeof p==\"string\")return p}return null}function Ae(d){switch(typeof d){case\"boolean\":case\"number\":case\"string\":case\"undefined\":return d;case\"object\":return d;default:return\"\"}}function fe(d){var p=d.type;return(d=d.nodeName)&&d.toLowerCase()===\"input\"&&(p===\"checkbox\"||p===\"radio\")}function _e(d){var p=fe(d)?\"checked\":\"value\",y=Object.getOwnPropertyDescriptor(d.constructor.prototype,p),S=\"\"+d[p];if(!d.hasOwnProperty(p)&&typeof y<\"u\"&&typeof y.get==\"function\"&&typeof y.set==\"function\"){var j=y.get,O=y.set;return Object.defineProperty(d,p,{configurable:!0,get:function(){return j.call(this)},set:function(M){S=\"\"+M,O.call(this,M)}}),Object.defineProperty(d,p,{enumerable:y.enumerable}),{getValue:function(){return S},setValue:function(M){S=\"\"+M},stopTracking:function(){d._valueTracker=null,delete d[p]}}}}function we(d){d._valueTracker||(d._valueTracker=_e(d))}function ce(d){if(!d)return!1;var p=d._valueTracker;if(!p)return!0;var y=p.getValue(),S=\"\";return d&&(S=fe(d)?d.checked?\"true\":\"false\":d.value),d=S,d!==y?(p.setValue(d),!0):!1}function at(d){if(d=d||(typeof document<\"u\"?document:void 0),typeof d>\"u\")return null;try{return d.activeElement||d.body}catch{return d.body}}function le(d,p){var y=p.checked;return ne({},p,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:y??d._wrapperState.initialChecked})}function qe(d,p){var y=p.defaultValue==null?\"\":p.defaultValue,S=p.checked!=null?p.checked:p.defaultChecked;y=Ae(p.value!=null?p.value:y),d._wrapperState={initialChecked:S,initialValue:y,controlled:p.type===\"checkbox\"||p.type===\"radio\"?p.checked!=null:p.value!=null}}function tt(d,p){p=p.checked,p!=null&&_(d,\"checked\",p,!1)}function ke(d,p){tt(d,p);var y=Ae(p.value),S=p.type;if(y!=null)S===\"number\"?(y===0&&d.value===\"\"||d.value!=y)&&(d.value=\"\"+y):d.value!==\"\"+y&&(d.value=\"\"+y);else if(S===\"submit\"||S===\"reset\"){d.removeAttribute(\"value\");return}p.hasOwnProperty(\"value\")?qt(d,p.type,y):p.hasOwnProperty(\"defaultValue\")&&qt(d,p.type,Ae(p.defaultValue)),p.checked==null&&p.defaultChecked!=null&&(d.defaultChecked=!!p.defaultChecked)}function sr(d,p,y){if(p.hasOwnProperty(\"value\")||p.hasOwnProperty(\"defaultValue\")){var S=p.type;if(!(S!==\"submit\"&&S!==\"reset\"||p.value!==void 0&&p.value!==null))return;p=\"\"+d._wrapperState.initialValue,y||p===d.value||(d.value=p),d.defaultValue=p}y=d.name,y!==\"\"&&(d.name=\"\"),d.defaultChecked=!!d._wrapperState.initialChecked,y!==\"\"&&(d.name=y)}function qt(d,p,y){(p!==\"number\"||at(d.ownerDocument)!==d)&&(y==null?d.defaultValue=\"\"+d._wrapperState.initialValue:d.defaultValue!==\"\"+y&&(d.defaultValue=\"\"+y))}var X=Array.isArray;function U(d,p,y,S){if(d=d.options,p){p={};for(var j=0;j<y.length;j++)p[\"$\"+y[j]]=!0;for(y=0;y<d.length;y++)j=p.hasOwnProperty(\"$\"+d[y].value),d[y].selected!==j&&(d[y].selected=j),j&&S&&(d[y].defaultSelected=!0)}else{for(y=\"\"+Ae(y),p=null,j=0;j<d.length;j++){if(d[j].value===y){d[j].selected=!0,S&&(d[j].defaultSelected=!0);return}p!==null||d[j].disabled||(p=d[j])}p!==null&&(p.selected=!0)}}function Z(d,p){if(p.dangerouslySetInnerHTML!=null)throw Error(r(91));return ne({},p,{value:void 0,defaultValue:void 0,children:\"\"+d._wrapperState.initialValue})}function ue(d,p){var y=p.value;if(y==null){if(y=p.children,p=p.defaultValue,y!=null){if(p!=null)throw Error(r(92));if(X(y)){if(1<y.length)throw Error(r(93));y=y[0]}p=y}p==null&&(p=\"\"),y=p}d._wrapperState={initialValue:Ae(y)}}function pe(d,p){var y=Ae(p.value),S=Ae(p.defaultValue);y!=null&&(y=\"\"+y,y!==d.value&&(d.value=y),p.defaultValue==null&&d.defaultValue!==y&&(d.defaultValue=y)),S!=null&&(d.defaultValue=\"\"+S)}function me(d){var p=d.textContent;p===d._wrapperState.initialValue&&p!==\"\"&&p!==null&&(d.value=p)}function Ve(d){switch(d){case\"svg\":return\"http://www.w3.org/2000/svg\";case\"math\":return\"http://www.w3.org/1998/Math/MathML\";default:return\"http://www.w3.org/1999/xhtml\"}}function gt(d,p){return d==null||d===\"http://www.w3.org/1999/xhtml\"?Ve(p):d===\"http://www.w3.org/2000/svg\"&&p===\"foreignObject\"?\"http://www.w3.org/1999/xhtml\":d}var wt,lr=(function(d){return typeof MSApp<\"u\"&&MSApp.execUnsafeLocalFunction?function(p,y,S,j){MSApp.execUnsafeLocalFunction(function(){return d(p,y,S,j)})}:d})(function(d,p){if(d.namespaceURI!==\"http://www.w3.org/2000/svg\"||\"innerHTML\"in d)d.innerHTML=p;else{for(wt=wt||document.createElement(\"div\"),wt.innerHTML=\"<svg>\"+p.valueOf().toString()+\"</svg>\",p=wt.firstChild;d.firstChild;)d.removeChild(d.firstChild);for(;p.firstChild;)d.appendChild(p.firstChild)}});function Ei(d,p){if(p){var y=d.firstChild;if(y&&y===d.lastChild&&y.nodeType===3){y.nodeValue=p;return}}d.textContent=p}var fr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Qo=[\"Webkit\",\"ms\",\"Moz\",\"O\"];Object.keys(fr).forEach(function(d){Qo.forEach(function(p){p=p+d.charAt(0).toUpperCase()+d.substring(1),fr[p]=fr[d]})});function yo(d,p,y){return p==null||typeof p==\"boolean\"||p===\"\"?\"\":y||typeof p!=\"number\"||p===0||fr.hasOwnProperty(d)&&fr[d]?(\"\"+p).trim():p+\"px\"}function qs(d,p){d=d.style;for(var y in p)if(p.hasOwnProperty(y)){var S=y.indexOf(\"--\")===0,j=yo(y,p[y],S);y===\"float\"&&(y=\"cssFloat\"),S?d.setProperty(y,j):d[y]=j}}var Mu=ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(d,p){if(p){if(Mu[d]&&(p.children!=null||p.dangerouslySetInnerHTML!=null))throw Error(r(137,d));if(p.dangerouslySetInnerHTML!=null){if(p.children!=null)throw Error(r(60));if(typeof p.dangerouslySetInnerHTML!=\"object\"||!(\"__html\"in p.dangerouslySetInnerHTML))throw Error(r(61))}if(p.style!=null&&typeof p.style!=\"object\")throw Error(r(62))}}function We(d,p){if(d.indexOf(\"-\")===-1)return typeof p.is==\"string\";switch(d){case\"annotation-xml\":case\"color-profile\":case\"font-face\":case\"font-face-src\":case\"font-face-uri\":case\"font-face-format\":case\"font-face-name\":case\"missing-glyph\":return!1;default:return!0}}var Et=null;function vr(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var Da=null,Jo=null,Ui=null;function D0(d){if(d=Oh(d)){if(typeof Da!=\"function\")throw Error(r(280));var p=d.stateNode;p&&(p=ig(p),Da(d.stateNode,d.type,p))}}function Hs(d){Jo?Ui?Ui.push(d):Ui=[d]:Jo=d}function OP(){if(Jo){var d=Jo,p=Ui;if(Ui=Jo=null,D0(d),p)for(d=0;d<p.length;d++)D0(p[d])}}function kP(d,p){return d(p)}function IP(){}var Y1=!1;function MP(d,p,y){if(Y1)return d(p,y);Y1=!0;try{return kP(d,p,y)}finally{Y1=!1,(Jo!==null||Ui!==null)&&(IP(),OP())}}function uh(d,p){var y=d.stateNode;if(y===null)return null;var S=ig(y);if(S===null)return null;y=S[p];e:switch(p){case\"onClick\":case\"onClickCapture\":case\"onDoubleClick\":case\"onDoubleClickCapture\":case\"onMouseDown\":case\"onMouseDownCapture\":case\"onMouseMove\":case\"onMouseMoveCapture\":case\"onMouseUp\":case\"onMouseUpCapture\":case\"onMouseEnter\":(S=!S.disabled)||(d=d.type,S=!(d===\"button\"||d===\"input\"||d===\"select\"||d===\"textarea\")),d=!S;break e;default:d=!1}if(d)return null;if(y&&typeof y!=\"function\")throw Error(r(231,p,typeof y));return y}var Z1=!1;if(s)try{var dh={};Object.defineProperty(dh,\"passive\",{get:function(){Z1=!0}}),window.addEventListener(\"test\",dh,dh),window.removeEventListener(\"test\",dh,dh)}catch{Z1=!1}function UJ(d,p,y,S,j,O,M,H,Q){var se=Array.prototype.slice.call(arguments,3);try{p.apply(y,se)}catch(be){this.onError(be)}}var fh=!1,R0=null,F0=!1,Q1=null,zJ={onError:function(d){fh=!0,R0=d}};function WJ(d,p,y,S,j,O,M,H,Q){fh=!1,R0=null,UJ.apply(zJ,arguments)}function qJ(d,p,y,S,j,O,M,H,Q){if(WJ.apply(this,arguments),fh){if(fh){var se=R0;fh=!1,R0=null}else throw Error(r(198));F0||(F0=!0,Q1=se)}}function hc(d){var p=d,y=d;if(d.alternate)for(;p.return;)p=p.return;else{d=p;do p=d,(p.flags&4098)!==0&&(y=p.return),d=p.return;while(d)}return p.tag===3?y:null}function DP(d){if(d.tag===13){var p=d.memoizedState;if(p===null&&(d=d.alternate,d!==null&&(p=d.memoizedState)),p!==null)return p.dehydrated}return null}function RP(d){if(hc(d)!==d)throw Error(r(188))}function HJ(d){var p=d.alternate;if(!p){if(p=hc(d),p===null)throw Error(r(188));return p!==d?null:d}for(var y=d,S=p;;){var j=y.return;if(j===null)break;var O=j.alternate;if(O===null){if(S=j.return,S!==null){y=S;continue}break}if(j.child===O.child){for(O=j.child;O;){if(O===y)return RP(j),d;if(O===S)return RP(j),p;O=O.sibling}throw Error(r(188))}if(y.return!==S.return)y=j,S=O;else{for(var M=!1,H=j.child;H;){if(H===y){M=!0,y=j,S=O;break}if(H===S){M=!0,S=j,y=O;break}H=H.sibling}if(!M){for(H=O.child;H;){if(H===y){M=!0,y=O,S=j;break}if(H===S){M=!0,S=O,y=j;break}H=H.sibling}if(!M)throw Error(r(189))}}if(y.alternate!==S)throw Error(r(190))}if(y.tag!==3)throw Error(r(188));return y.stateNode.current===y?d:p}function FP(d){return d=HJ(d),d!==null?LP(d):null}function LP(d){if(d.tag===5||d.tag===6)return d;for(d=d.child;d!==null;){var p=LP(d);if(p!==null)return p;d=d.sibling}return null}var BP=e.unstable_scheduleCallback,$P=e.unstable_cancelCallback,GJ=e.unstable_shouldYield,KJ=e.unstable_requestPaint,qr=e.unstable_now,XJ=e.unstable_getCurrentPriorityLevel,J1=e.unstable_ImmediatePriority,VP=e.unstable_UserBlockingPriority,L0=e.unstable_NormalPriority,YJ=e.unstable_LowPriority,UP=e.unstable_IdlePriority,B0=null,xo=null;function ZJ(d){if(xo&&typeof xo.onCommitFiberRoot==\"function\")try{xo.onCommitFiberRoot(B0,d,void 0,(d.current.flags&128)===128)}catch{}}var Ra=Math.clz32?Math.clz32:eee,QJ=Math.log,JJ=Math.LN2;function eee(d){return d>>>=0,d===0?32:31-(QJ(d)/JJ|0)|0}var $0=64,V0=4194304;function hh(d){switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return d&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return d}}function U0(d,p){var y=d.pendingLanes;if(y===0)return 0;var S=0,j=d.suspendedLanes,O=d.pingedLanes,M=y&268435455;if(M!==0){var H=M&~j;H!==0?S=hh(H):(O&=M,O!==0&&(S=hh(O)))}else M=y&~j,M!==0?S=hh(M):O!==0&&(S=hh(O));if(S===0)return 0;if(p!==0&&p!==S&&(p&j)===0&&(j=S&-S,O=p&-p,j>=O||j===16&&(O&4194240)!==0))return p;if((S&4)!==0&&(S|=y&16),p=d.entangledLanes,p!==0)for(d=d.entanglements,p&=S;0<p;)y=31-Ra(p),j=1<<y,S|=d[y],p&=~j;return S}function tee(d,p){switch(d){case 1:case 2:case 4:return p+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ree(d,p){for(var y=d.suspendedLanes,S=d.pingedLanes,j=d.expirationTimes,O=d.pendingLanes;0<O;){var M=31-Ra(O),H=1<<M,Q=j[M];Q===-1?((H&y)===0||(H&S)!==0)&&(j[M]=tee(H,p)):Q<=p&&(d.expiredLanes|=H),O&=~H}}function eb(d){return d=d.pendingLanes&-1073741825,d!==0?d:d&1073741824?1073741824:0}function zP(){var d=$0;return $0<<=1,($0&4194240)===0&&($0=64),d}function tb(d){for(var p=[],y=0;31>y;y++)p.push(d);return p}function ph(d,p,y){d.pendingLanes|=p,p!==536870912&&(d.suspendedLanes=0,d.pingedLanes=0),d=d.eventTimes,p=31-Ra(p),d[p]=y}function nee(d,p){var y=d.pendingLanes&~p;d.pendingLanes=p,d.suspendedLanes=0,d.pingedLanes=0,d.expiredLanes&=p,d.mutableReadLanes&=p,d.entangledLanes&=p,p=d.entanglements;var S=d.eventTimes;for(d=d.expirationTimes;0<y;){var j=31-Ra(y),O=1<<j;p[j]=0,S[j]=-1,d[j]=-1,y&=~O}}function rb(d,p){var y=d.entangledLanes|=p;for(d=d.entanglements;y;){var S=31-Ra(y),j=1<<S;j&p|d[S]&p&&(d[S]|=p),y&=~j}}var Qt=0;function WP(d){return d&=-d,1<d?4<d?(d&268435455)!==0?16:536870912:4:1}var qP,nb,HP,GP,KP,ib=!1,z0=[],Gs=null,Ks=null,Xs=null,mh=new Map,gh=new Map,Ys=[],iee=\"mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit\".split(\" \");function XP(d,p){switch(d){case\"focusin\":case\"focusout\":Gs=null;break;case\"dragenter\":case\"dragleave\":Ks=null;break;case\"mouseover\":case\"mouseout\":Xs=null;break;case\"pointerover\":case\"pointerout\":mh.delete(p.pointerId);break;case\"gotpointercapture\":case\"lostpointercapture\":gh.delete(p.pointerId)}}function vh(d,p,y,S,j,O){return d===null||d.nativeEvent!==O?(d={blockedOn:p,domEventName:y,eventSystemFlags:S,nativeEvent:O,targetContainers:[j]},p!==null&&(p=Oh(p),p!==null&&nb(p)),d):(d.eventSystemFlags|=S,p=d.targetContainers,j!==null&&p.indexOf(j)===-1&&p.push(j),d)}function aee(d,p,y,S,j){switch(p){case\"focusin\":return Gs=vh(Gs,d,p,y,S,j),!0;case\"dragenter\":return Ks=vh(Ks,d,p,y,S,j),!0;case\"mouseover\":return Xs=vh(Xs,d,p,y,S,j),!0;case\"pointerover\":var O=j.pointerId;return mh.set(O,vh(mh.get(O)||null,d,p,y,S,j)),!0;case\"gotpointercapture\":return O=j.pointerId,gh.set(O,vh(gh.get(O)||null,d,p,y,S,j)),!0}return!1}function YP(d){var p=pc(d.target);if(p!==null){var y=hc(p);if(y!==null){if(p=y.tag,p===13){if(p=DP(y),p!==null){d.blockedOn=p,KP(d.priority,function(){HP(y)});return}}else if(p===3&&y.stateNode.current.memoizedState.isDehydrated){d.blockedOn=y.tag===3?y.stateNode.containerInfo:null;return}}}d.blockedOn=null}function W0(d){if(d.blockedOn!==null)return!1;for(var p=d.targetContainers;0<p.length;){var y=ob(d.domEventName,d.eventSystemFlags,p[0],d.nativeEvent);if(y===null){y=d.nativeEvent;var S=new y.constructor(y.type,y);Et=S,y.target.dispatchEvent(S),Et=null}else return p=Oh(y),p!==null&&nb(p),d.blockedOn=y,!1;p.shift()}return!0}function ZP(d,p,y){W0(d)&&y.delete(p)}function oee(){ib=!1,Gs!==null&&W0(Gs)&&(Gs=null),Ks!==null&&W0(Ks)&&(Ks=null),Xs!==null&&W0(Xs)&&(Xs=null),mh.forEach(ZP),gh.forEach(ZP)}function yh(d,p){d.blockedOn===p&&(d.blockedOn=null,ib||(ib=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,oee)))}function xh(d){function p(j){return yh(j,d)}if(0<z0.length){yh(z0[0],d);for(var y=1;y<z0.length;y++){var S=z0[y];S.blockedOn===d&&(S.blockedOn=null)}}for(Gs!==null&&yh(Gs,d),Ks!==null&&yh(Ks,d),Xs!==null&&yh(Xs,d),mh.forEach(p),gh.forEach(p),y=0;y<Ys.length;y++)S=Ys[y],S.blockedOn===d&&(S.blockedOn=null);for(;0<Ys.length&&(y=Ys[0],y.blockedOn===null);)YP(y),y.blockedOn===null&&Ys.shift()}var Du=N.ReactCurrentBatchConfig,q0=!0;function see(d,p,y,S){var j=Qt,O=Du.transition;Du.transition=null;try{Qt=1,ab(d,p,y,S)}finally{Qt=j,Du.transition=O}}function lee(d,p,y,S){var j=Qt,O=Du.transition;Du.transition=null;try{Qt=4,ab(d,p,y,S)}finally{Qt=j,Du.transition=O}}function ab(d,p,y,S){if(q0){var j=ob(d,p,y,S);if(j===null)_b(d,p,S,H0,y),XP(d,S);else if(aee(j,d,p,y,S))S.stopPropagation();else if(XP(d,S),p&4&&-1<iee.indexOf(d)){for(;j!==null;){var O=Oh(j);if(O!==null&&qP(O),O=ob(d,p,y,S),O===null&&_b(d,p,S,H0,y),O===j)break;j=O}j!==null&&S.stopPropagation()}else _b(d,p,S,null,y)}}var H0=null;function ob(d,p,y,S){if(H0=null,d=vr(S),d=pc(d),d!==null)if(p=hc(d),p===null)d=null;else if(y=p.tag,y===13){if(d=DP(p),d!==null)return d;d=null}else if(y===3){if(p.stateNode.current.memoizedState.isDehydrated)return p.tag===3?p.stateNode.containerInfo:null;d=null}else p!==d&&(d=null);return H0=d,null}function QP(d){switch(d){case\"cancel\":case\"click\":case\"close\":case\"contextmenu\":case\"copy\":case\"cut\":case\"auxclick\":case\"dblclick\":case\"dragend\":case\"dragstart\":case\"drop\":case\"focusin\":case\"focusout\":case\"input\":case\"invalid\":case\"keydown\":case\"keypress\":case\"keyup\":case\"mousedown\":case\"mouseup\":case\"paste\":case\"pause\":case\"play\":case\"pointercancel\":case\"pointerdown\":case\"pointerup\":case\"ratechange\":case\"reset\":case\"resize\":case\"seeked\":case\"submit\":case\"touchcancel\":case\"touchend\":case\"touchstart\":case\"volumechange\":case\"change\":case\"selectionchange\":case\"textInput\":case\"compositionstart\":case\"compositionend\":case\"compositionupdate\":case\"beforeblur\":case\"afterblur\":case\"beforeinput\":case\"blur\":case\"fullscreenchange\":case\"focus\":case\"hashchange\":case\"popstate\":case\"select\":case\"selectstart\":return 1;case\"drag\":case\"dragenter\":case\"dragexit\":case\"dragleave\":case\"dragover\":case\"mousemove\":case\"mouseout\":case\"mouseover\":case\"pointermove\":case\"pointerout\":case\"pointerover\":case\"scroll\":case\"toggle\":case\"touchmove\":case\"wheel\":case\"mouseenter\":case\"mouseleave\":case\"pointerenter\":case\"pointerleave\":return 4;case\"message\":switch(XJ()){case J1:return 1;case VP:return 4;case L0:case YJ:return 16;case UP:return 536870912;default:return 16}default:return 16}}var Zs=null,sb=null,G0=null;function JP(){if(G0)return G0;var d,p=sb,y=p.length,S,j=\"value\"in Zs?Zs.value:Zs.textContent,O=j.length;for(d=0;d<y&&p[d]===j[d];d++);var M=y-d;for(S=1;S<=M&&p[y-S]===j[O-S];S++);return G0=j.slice(d,1<S?1-S:void 0)}function K0(d){var p=d.keyCode;return\"charCode\"in d?(d=d.charCode,d===0&&p===13&&(d=13)):d=p,d===10&&(d=13),32<=d||d===13?d:0}function X0(){return!0}function e4(){return!1}function zi(d){function p(y,S,j,O,M){this._reactName=y,this._targetInst=j,this.type=S,this.nativeEvent=O,this.target=M,this.currentTarget=null;for(var H in d)d.hasOwnProperty(H)&&(y=d[H],this[H]=y?y(O):O[H]);return this.isDefaultPrevented=(O.defaultPrevented!=null?O.defaultPrevented:O.returnValue===!1)?X0:e4,this.isPropagationStopped=e4,this}return ne(p.prototype,{preventDefault:function(){this.defaultPrevented=!0;var y=this.nativeEvent;y&&(y.preventDefault?y.preventDefault():typeof y.returnValue!=\"unknown\"&&(y.returnValue=!1),this.isDefaultPrevented=X0)},stopPropagation:function(){var y=this.nativeEvent;y&&(y.stopPropagation?y.stopPropagation():typeof y.cancelBubble!=\"unknown\"&&(y.cancelBubble=!0),this.isPropagationStopped=X0)},persist:function(){},isPersistent:X0}),p}var Ru={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lb=zi(Ru),bh=ne({},Ru,{view:0,detail:0}),cee=zi(bh),cb,ub,wh,Y0=ne({},bh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fb,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return\"movementX\"in d?d.movementX:(d!==wh&&(wh&&d.type===\"mousemove\"?(cb=d.screenX-wh.screenX,ub=d.screenY-wh.screenY):ub=cb=0,wh=d),cb)},movementY:function(d){return\"movementY\"in d?d.movementY:ub}}),t4=zi(Y0),uee=ne({},Y0,{dataTransfer:0}),dee=zi(uee),fee=ne({},bh,{relatedTarget:0}),db=zi(fee),hee=ne({},Ru,{animationName:0,elapsedTime:0,pseudoElement:0}),pee=zi(hee),mee=ne({},Ru,{clipboardData:function(d){return\"clipboardData\"in d?d.clipboardData:window.clipboardData}}),gee=zi(mee),vee=ne({},Ru,{data:0}),r4=zi(vee),yee={Esc:\"Escape\",Spacebar:\" \",Left:\"ArrowLeft\",Up:\"ArrowUp\",Right:\"ArrowRight\",Down:\"ArrowDown\",Del:\"Delete\",Win:\"OS\",Menu:\"ContextMenu\",Apps:\"ContextMenu\",Scroll:\"ScrollLock\",MozPrintableKey:\"Unidentified\"},xee={8:\"Backspace\",9:\"Tab\",12:\"Clear\",13:\"Enter\",16:\"Shift\",17:\"Control\",18:\"Alt\",19:\"Pause\",20:\"CapsLock\",27:\"Escape\",32:\" \",33:\"PageUp\",34:\"PageDown\",35:\"End\",36:\"Home\",37:\"ArrowLeft\",38:\"ArrowUp\",39:\"ArrowRight\",40:\"ArrowDown\",45:\"Insert\",46:\"Delete\",112:\"F1\",113:\"F2\",114:\"F3\",115:\"F4\",116:\"F5\",117:\"F6\",118:\"F7\",119:\"F8\",120:\"F9\",121:\"F10\",122:\"F11\",123:\"F12\",144:\"NumLock\",145:\"ScrollLock\",224:\"Meta\"},bee={Alt:\"altKey\",Control:\"ctrlKey\",Meta:\"metaKey\",Shift:\"shiftKey\"};function wee(d){var p=this.nativeEvent;return p.getModifierState?p.getModifierState(d):(d=bee[d])?!!p[d]:!1}function fb(){return wee}var See=ne({},bh,{key:function(d){if(d.key){var p=yee[d.key]||d.key;if(p!==\"Unidentified\")return p}return d.type===\"keypress\"?(d=K0(d),d===13?\"Enter\":String.fromCharCode(d)):d.type===\"keydown\"||d.type===\"keyup\"?xee[d.keyCode]||\"Unidentified\":\"\"},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fb,charCode:function(d){return d.type===\"keypress\"?K0(d):0},keyCode:function(d){return d.type===\"keydown\"||d.type===\"keyup\"?d.keyCode:0},which:function(d){return d.type===\"keypress\"?K0(d):d.type===\"keydown\"||d.type===\"keyup\"?d.keyCode:0}}),_ee=zi(See),Cee=ne({},Y0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),n4=zi(Cee),Aee=ne({},bh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fb}),Nee=zi(Aee),Eee=ne({},Ru,{propertyName:0,elapsedTime:0,pseudoElement:0}),jee=zi(Eee),Tee=ne({},Y0,{deltaX:function(d){return\"deltaX\"in d?d.deltaX:\"wheelDeltaX\"in d?-d.wheelDeltaX:0},deltaY:function(d){return\"deltaY\"in d?d.deltaY:\"wheelDeltaY\"in d?-d.wheelDeltaY:\"wheelDelta\"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),Pee=zi(Tee),Oee=[9,13,27,32],hb=s&&\"CompositionEvent\"in window,Sh=null;s&&\"documentMode\"in document&&(Sh=document.documentMode);var kee=s&&\"TextEvent\"in window&&!Sh,i4=s&&(!hb||Sh&&8<Sh&&11>=Sh),a4=\" \",o4=!1;function s4(d,p){switch(d){case\"keyup\":return Oee.indexOf(p.keyCode)!==-1;case\"keydown\":return p.keyCode!==229;case\"keypress\":case\"mousedown\":case\"focusout\":return!0;default:return!1}}function l4(d){return d=d.detail,typeof d==\"object\"&&\"data\"in d?d.data:null}var Fu=!1;function Iee(d,p){switch(d){case\"compositionend\":return l4(p);case\"keypress\":return p.which!==32?null:(o4=!0,a4);case\"textInput\":return d=p.data,d===a4&&o4?null:d;default:return null}}function Mee(d,p){if(Fu)return d===\"compositionend\"||!hb&&s4(d,p)?(d=JP(),G0=sb=Zs=null,Fu=!1,d):null;switch(d){case\"paste\":return null;case\"keypress\":if(!(p.ctrlKey||p.altKey||p.metaKey)||p.ctrlKey&&p.altKey){if(p.char&&1<p.char.length)return p.char;if(p.which)return String.fromCharCode(p.which)}return null;case\"compositionend\":return i4&&p.locale!==\"ko\"?null:p.data;default:return null}}var Dee={color:!0,date:!0,datetime:!0,\"datetime-local\":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function c4(d){var p=d&&d.nodeName&&d.nodeName.toLowerCase();return p===\"input\"?!!Dee[d.type]:p===\"textarea\"}function u4(d,p,y,S){Hs(S),p=tg(p,\"onChange\"),0<p.length&&(y=new lb(\"onChange\",\"change\",null,y,S),d.push({event:y,listeners:p}))}var _h=null,Ch=null;function Ree(d){j4(d,0)}function Z0(d){var p=Uu(d);if(ce(p))return d}function Fee(d,p){if(d===\"change\")return p}var d4=!1;if(s){var pb;if(s){var mb=\"oninput\"in document;if(!mb){var f4=document.createElement(\"div\");f4.setAttribute(\"oninput\",\"return;\"),mb=typeof f4.oninput==\"function\"}pb=mb}else pb=!1;d4=pb&&(!document.documentMode||9<document.documentMode)}function h4(){_h&&(_h.detachEvent(\"onpropertychange\",p4),Ch=_h=null)}function p4(d){if(d.propertyName===\"value\"&&Z0(Ch)){var p=[];u4(p,Ch,d,vr(d)),MP(Ree,p)}}function Lee(d,p,y){d===\"focusin\"?(h4(),_h=p,Ch=y,_h.attachEvent(\"onpropertychange\",p4)):d===\"focusout\"&&h4()}function Bee(d){if(d===\"selectionchange\"||d===\"keyup\"||d===\"keydown\")return Z0(Ch)}function $ee(d,p){if(d===\"click\")return Z0(p)}function Vee(d,p){if(d===\"input\"||d===\"change\")return Z0(p)}function Uee(d,p){return d===p&&(d!==0||1/d===1/p)||d!==d&&p!==p}var Fa=typeof Object.is==\"function\"?Object.is:Uee;function Ah(d,p){if(Fa(d,p))return!0;if(typeof d!=\"object\"||d===null||typeof p!=\"object\"||p===null)return!1;var y=Object.keys(d),S=Object.keys(p);if(y.length!==S.length)return!1;for(S=0;S<y.length;S++){var j=y[S];if(!c.call(p,j)||!Fa(d[j],p[j]))return!1}return!0}function m4(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function g4(d,p){var y=m4(d);d=0;for(var S;y;){if(y.nodeType===3){if(S=d+y.textContent.length,d<=p&&S>=p)return{node:y,offset:p-d};d=S}e:{for(;y;){if(y.nextSibling){y=y.nextSibling;break e}y=y.parentNode}y=void 0}y=m4(y)}}function v4(d,p){return d&&p?d===p?!0:d&&d.nodeType===3?!1:p&&p.nodeType===3?v4(d,p.parentNode):\"contains\"in d?d.contains(p):d.compareDocumentPosition?!!(d.compareDocumentPosition(p)&16):!1:!1}function y4(){for(var d=window,p=at();p instanceof d.HTMLIFrameElement;){try{var y=typeof p.contentWindow.location.href==\"string\"}catch{y=!1}if(y)d=p.contentWindow;else break;p=at(d.document)}return p}function gb(d){var p=d&&d.nodeName&&d.nodeName.toLowerCase();return p&&(p===\"input\"&&(d.type===\"text\"||d.type===\"search\"||d.type===\"tel\"||d.type===\"url\"||d.type===\"password\")||p===\"textarea\"||d.contentEditable===\"true\")}function zee(d){var p=y4(),y=d.focusedElem,S=d.selectionRange;if(p!==y&&y&&y.ownerDocument&&v4(y.ownerDocument.documentElement,y)){if(S!==null&&gb(y)){if(p=S.start,d=S.end,d===void 0&&(d=p),\"selectionStart\"in y)y.selectionStart=p,y.selectionEnd=Math.min(d,y.value.length);else if(d=(p=y.ownerDocument||document)&&p.defaultView||window,d.getSelection){d=d.getSelection();var j=y.textContent.length,O=Math.min(S.start,j);S=S.end===void 0?O:Math.min(S.end,j),!d.extend&&O>S&&(j=S,S=O,O=j),j=g4(y,O);var M=g4(y,S);j&&M&&(d.rangeCount!==1||d.anchorNode!==j.node||d.anchorOffset!==j.offset||d.focusNode!==M.node||d.focusOffset!==M.offset)&&(p=p.createRange(),p.setStart(j.node,j.offset),d.removeAllRanges(),O>S?(d.addRange(p),d.extend(M.node,M.offset)):(p.setEnd(M.node,M.offset),d.addRange(p)))}}for(p=[],d=y;d=d.parentNode;)d.nodeType===1&&p.push({element:d,left:d.scrollLeft,top:d.scrollTop});for(typeof y.focus==\"function\"&&y.focus(),y=0;y<p.length;y++)d=p[y],d.element.scrollLeft=d.left,d.element.scrollTop=d.top}}var Wee=s&&\"documentMode\"in document&&11>=document.documentMode,Lu=null,vb=null,Nh=null,yb=!1;function x4(d,p,y){var S=y.window===y?y.document:y.nodeType===9?y:y.ownerDocument;yb||Lu==null||Lu!==at(S)||(S=Lu,\"selectionStart\"in S&&gb(S)?S={start:S.selectionStart,end:S.selectionEnd}:(S=(S.ownerDocument&&S.ownerDocument.defaultView||window).getSelection(),S={anchorNode:S.anchorNode,anchorOffset:S.anchorOffset,focusNode:S.focusNode,focusOffset:S.focusOffset}),Nh&&Ah(Nh,S)||(Nh=S,S=tg(vb,\"onSelect\"),0<S.length&&(p=new lb(\"onSelect\",\"select\",null,p,y),d.push({event:p,listeners:S}),p.target=Lu)))}function Q0(d,p){var y={};return y[d.toLowerCase()]=p.toLowerCase(),y[\"Webkit\"+d]=\"webkit\"+p,y[\"Moz\"+d]=\"moz\"+p,y}var Bu={animationend:Q0(\"Animation\",\"AnimationEnd\"),animationiteration:Q0(\"Animation\",\"AnimationIteration\"),animationstart:Q0(\"Animation\",\"AnimationStart\"),transitionend:Q0(\"Transition\",\"TransitionEnd\")},xb={},b4={};s&&(b4=document.createElement(\"div\").style,\"AnimationEvent\"in window||(delete Bu.animationend.animation,delete Bu.animationiteration.animation,delete Bu.animationstart.animation),\"TransitionEvent\"in window||delete Bu.transitionend.transition);function J0(d){if(xb[d])return xb[d];if(!Bu[d])return d;var p=Bu[d],y;for(y in p)if(p.hasOwnProperty(y)&&y in b4)return xb[d]=p[y];return d}var w4=J0(\"animationend\"),S4=J0(\"animationiteration\"),_4=J0(\"animationstart\"),C4=J0(\"transitionend\"),A4=new Map,N4=\"abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel\".split(\" \");function Qs(d,p){A4.set(d,p),a(p,[d])}for(var bb=0;bb<N4.length;bb++){var wb=N4[bb],qee=wb.toLowerCase(),Hee=wb[0].toUpperCase()+wb.slice(1);Qs(qee,\"on\"+Hee)}Qs(w4,\"onAnimationEnd\"),Qs(S4,\"onAnimationIteration\"),Qs(_4,\"onAnimationStart\"),Qs(\"dblclick\",\"onDoubleClick\"),Qs(\"focusin\",\"onFocus\"),Qs(\"focusout\",\"onBlur\"),Qs(C4,\"onTransitionEnd\"),o(\"onMouseEnter\",[\"mouseout\",\"mouseover\"]),o(\"onMouseLeave\",[\"mouseout\",\"mouseover\"]),o(\"onPointerEnter\",[\"pointerout\",\"pointerover\"]),o(\"onPointerLeave\",[\"pointerout\",\"pointerover\"]),a(\"onChange\",\"change click focusin focusout input keydown keyup selectionchange\".split(\" \")),a(\"onSelect\",\"focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange\".split(\" \")),a(\"onBeforeInput\",[\"compositionend\",\"keypress\",\"textInput\",\"paste\"]),a(\"onCompositionEnd\",\"compositionend focusout keydown keypress keyup mousedown\".split(\" \")),a(\"onCompositionStart\",\"compositionstart focusout keydown keypress keyup mousedown\".split(\" \")),a(\"onCompositionUpdate\",\"compositionupdate focusout keydown keypress keyup mousedown\".split(\" \"));var Eh=\"abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting\".split(\" \"),Gee=new Set(\"cancel close invalid load scroll toggle\".split(\" \").concat(Eh));function E4(d,p,y){var S=d.type||\"unknown-event\";d.currentTarget=y,qJ(S,p,void 0,d),d.currentTarget=null}function j4(d,p){p=(p&4)!==0;for(var y=0;y<d.length;y++){var S=d[y],j=S.event;S=S.listeners;e:{var O=void 0;if(p)for(var M=S.length-1;0<=M;M--){var H=S[M],Q=H.instance,se=H.currentTarget;if(H=H.listener,Q!==O&&j.isPropagationStopped())break e;E4(j,H,se),O=Q}else for(M=0;M<S.length;M++){if(H=S[M],Q=H.instance,se=H.currentTarget,H=H.listener,Q!==O&&j.isPropagationStopped())break e;E4(j,H,se),O=Q}}}if(F0)throw d=Q1,F0=!1,Q1=null,d}function yr(d,p){var y=p[Tb];y===void 0&&(y=p[Tb]=new Set);var S=d+\"__bubble\";y.has(S)||(T4(p,d,2,!1),y.add(S))}function Sb(d,p,y){var S=0;p&&(S|=4),T4(y,d,S,p)}var eg=\"_reactListening\"+Math.random().toString(36).slice(2);function jh(d){if(!d[eg]){d[eg]=!0,n.forEach(function(y){y!==\"selectionchange\"&&(Gee.has(y)||Sb(y,!1,d),Sb(y,!0,d))});var p=d.nodeType===9?d:d.ownerDocument;p===null||p[eg]||(p[eg]=!0,Sb(\"selectionchange\",!1,p))}}function T4(d,p,y,S){switch(QP(p)){case 1:var j=see;break;case 4:j=lee;break;default:j=ab}y=j.bind(null,p,y,d),j=void 0,!Z1||p!==\"touchstart\"&&p!==\"touchmove\"&&p!==\"wheel\"||(j=!0),S?j!==void 0?d.addEventListener(p,y,{capture:!0,passive:j}):d.addEventListener(p,y,!0):j!==void 0?d.addEventListener(p,y,{passive:j}):d.addEventListener(p,y,!1)}function _b(d,p,y,S,j){var O=S;if((p&1)===0&&(p&2)===0&&S!==null)e:for(;;){if(S===null)return;var M=S.tag;if(M===3||M===4){var H=S.stateNode.containerInfo;if(H===j||H.nodeType===8&&H.parentNode===j)break;if(M===4)for(M=S.return;M!==null;){var Q=M.tag;if((Q===3||Q===4)&&(Q=M.stateNode.containerInfo,Q===j||Q.nodeType===8&&Q.parentNode===j))return;M=M.return}for(;H!==null;){if(M=pc(H),M===null)return;if(Q=M.tag,Q===5||Q===6){S=O=M;continue e}H=H.parentNode}}S=S.return}MP(function(){var se=O,be=vr(y),Se=[];e:{var xe=A4.get(d);if(xe!==void 0){var Ue=lb,Ke=d;switch(d){case\"keypress\":if(K0(y)===0)break e;case\"keydown\":case\"keyup\":Ue=_ee;break;case\"focusin\":Ke=\"focus\",Ue=db;break;case\"focusout\":Ke=\"blur\",Ue=db;break;case\"beforeblur\":case\"afterblur\":Ue=db;break;case\"click\":if(y.button===2)break e;case\"auxclick\":case\"dblclick\":case\"mousedown\":case\"mousemove\":case\"mouseup\":case\"mouseout\":case\"mouseover\":case\"contextmenu\":Ue=t4;break;case\"drag\":case\"dragend\":case\"dragenter\":case\"dragexit\":case\"dragleave\":case\"dragover\":case\"dragstart\":case\"drop\":Ue=dee;break;case\"touchcancel\":case\"touchend\":case\"touchmove\":case\"touchstart\":Ue=Nee;break;case w4:case S4:case _4:Ue=pee;break;case C4:Ue=jee;break;case\"scroll\":Ue=cee;break;case\"wheel\":Ue=Pee;break;case\"copy\":case\"cut\":case\"paste\":Ue=gee;break;case\"gotpointercapture\":case\"lostpointercapture\":case\"pointercancel\":case\"pointerdown\":case\"pointermove\":case\"pointerout\":case\"pointerover\":case\"pointerup\":Ue=n4}var Ze=(p&4)!==0,Hr=!Ze&&d===\"scroll\",ie=Ze?xe!==null?xe+\"Capture\":null:xe;Ze=[];for(var ee=se,oe;ee!==null;){oe=ee;var Ee=oe.stateNode;if(oe.tag===5&&Ee!==null&&(oe=Ee,ie!==null&&(Ee=uh(ee,ie),Ee!=null&&Ze.push(Th(ee,Ee,oe)))),Hr)break;ee=ee.return}0<Ze.length&&(xe=new Ue(xe,Ke,null,y,be),Se.push({event:xe,listeners:Ze}))}}if((p&7)===0){e:{if(xe=d===\"mouseover\"||d===\"pointerover\",Ue=d===\"mouseout\"||d===\"pointerout\",xe&&y!==Et&&(Ke=y.relatedTarget||y.fromElement)&&(pc(Ke)||Ke[es]))break e;if((Ue||xe)&&(xe=be.window===be?be:(xe=be.ownerDocument)?xe.defaultView||xe.parentWindow:window,Ue?(Ke=y.relatedTarget||y.toElement,Ue=se,Ke=Ke?pc(Ke):null,Ke!==null&&(Hr=hc(Ke),Ke!==Hr||Ke.tag!==5&&Ke.tag!==6)&&(Ke=null)):(Ue=null,Ke=se),Ue!==Ke)){if(Ze=t4,Ee=\"onMouseLeave\",ie=\"onMouseEnter\",ee=\"mouse\",(d===\"pointerout\"||d===\"pointerover\")&&(Ze=n4,Ee=\"onPointerLeave\",ie=\"onPointerEnter\",ee=\"pointer\"),Hr=Ue==null?xe:Uu(Ue),oe=Ke==null?xe:Uu(Ke),xe=new Ze(Ee,ee+\"leave\",Ue,y,be),xe.target=Hr,xe.relatedTarget=oe,Ee=null,pc(be)===se&&(Ze=new Ze(ie,ee+\"enter\",Ke,y,be),Ze.target=oe,Ze.relatedTarget=Hr,Ee=Ze),Hr=Ee,Ue&&Ke)t:{for(Ze=Ue,ie=Ke,ee=0,oe=Ze;oe;oe=$u(oe))ee++;for(oe=0,Ee=ie;Ee;Ee=$u(Ee))oe++;for(;0<ee-oe;)Ze=$u(Ze),ee--;for(;0<oe-ee;)ie=$u(ie),oe--;for(;ee--;){if(Ze===ie||ie!==null&&Ze===ie.alternate)break t;Ze=$u(Ze),ie=$u(ie)}Ze=null}else Ze=null;Ue!==null&&P4(Se,xe,Ue,Ze,!1),Ke!==null&&Hr!==null&&P4(Se,Hr,Ke,Ze,!0)}}e:{if(xe=se?Uu(se):window,Ue=xe.nodeName&&xe.nodeName.toLowerCase(),Ue===\"select\"||Ue===\"input\"&&xe.type===\"file\")var Je=Fee;else if(c4(xe))if(d4)Je=Vee;else{Je=Bee;var ot=Lee}else(Ue=xe.nodeName)&&Ue.toLowerCase()===\"input\"&&(xe.type===\"checkbox\"||xe.type===\"radio\")&&(Je=$ee);if(Je&&(Je=Je(d,se))){u4(Se,Je,y,be);break e}ot&&ot(d,xe,se),d===\"focusout\"&&(ot=xe._wrapperState)&&ot.controlled&&xe.type===\"number\"&&qt(xe,\"number\",xe.value)}switch(ot=se?Uu(se):window,d){case\"focusin\":(c4(ot)||ot.contentEditable===\"true\")&&(Lu=ot,vb=se,Nh=null);break;case\"focusout\":Nh=vb=Lu=null;break;case\"mousedown\":yb=!0;break;case\"contextmenu\":case\"mouseup\":case\"dragend\":yb=!1,x4(Se,y,be);break;case\"selectionchange\":if(Wee)break;case\"keydown\":case\"keyup\":x4(Se,y,be)}var st;if(hb)e:{switch(d){case\"compositionstart\":var mt=\"onCompositionStart\";break e;case\"compositionend\":mt=\"onCompositionEnd\";break e;case\"compositionupdate\":mt=\"onCompositionUpdate\";break e}mt=void 0}else Fu?s4(d,y)&&(mt=\"onCompositionEnd\"):d===\"keydown\"&&y.keyCode===229&&(mt=\"onCompositionStart\");mt&&(i4&&y.locale!==\"ko\"&&(Fu||mt!==\"onCompositionStart\"?mt===\"onCompositionEnd\"&&Fu&&(st=JP()):(Zs=be,sb=\"value\"in Zs?Zs.value:Zs.textContent,Fu=!0)),ot=tg(se,mt),0<ot.length&&(mt=new r4(mt,d,null,y,be),Se.push({event:mt,listeners:ot}),st?mt.data=st:(st=l4(y),st!==null&&(mt.data=st)))),(st=kee?Iee(d,y):Mee(d,y))&&(se=tg(se,\"onBeforeInput\"),0<se.length&&(be=new r4(\"onBeforeInput\",\"beforeinput\",null,y,be),Se.push({event:be,listeners:se}),be.data=st))}j4(Se,p)})}function Th(d,p,y){return{instance:d,listener:p,currentTarget:y}}function tg(d,p){for(var y=p+\"Capture\",S=[];d!==null;){var j=d,O=j.stateNode;j.tag===5&&O!==null&&(j=O,O=uh(d,y),O!=null&&S.unshift(Th(d,O,j)),O=uh(d,p),O!=null&&S.push(Th(d,O,j))),d=d.return}return S}function $u(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5);return d||null}function P4(d,p,y,S,j){for(var O=p._reactName,M=[];y!==null&&y!==S;){var H=y,Q=H.alternate,se=H.stateNode;if(Q!==null&&Q===S)break;H.tag===5&&se!==null&&(H=se,j?(Q=uh(y,O),Q!=null&&M.unshift(Th(y,Q,H))):j||(Q=uh(y,O),Q!=null&&M.push(Th(y,Q,H)))),y=y.return}M.length!==0&&d.push({event:p,listeners:M})}var Kee=/\\r\\n?/g,Xee=/\\u0000|\\uFFFD/g;function O4(d){return(typeof d==\"string\"?d:\"\"+d).replace(Kee,`\n`).replace(Xee,\"\")}function rg(d,p,y){if(p=O4(p),O4(d)!==p&&y)throw Error(r(425))}function ng(){}var Cb=null,Ab=null;function Nb(d,p){return d===\"textarea\"||d===\"noscript\"||typeof p.children==\"string\"||typeof p.children==\"number\"||typeof p.dangerouslySetInnerHTML==\"object\"&&p.dangerouslySetInnerHTML!==null&&p.dangerouslySetInnerHTML.__html!=null}var Eb=typeof setTimeout==\"function\"?setTimeout:void 0,Yee=typeof clearTimeout==\"function\"?clearTimeout:void 0,k4=typeof Promise==\"function\"?Promise:void 0,Zee=typeof queueMicrotask==\"function\"?queueMicrotask:typeof k4<\"u\"?function(d){return k4.resolve(null).then(d).catch(Qee)}:Eb;function Qee(d){setTimeout(function(){throw d})}function jb(d,p){var y=p,S=0;do{var j=y.nextSibling;if(d.removeChild(y),j&&j.nodeType===8)if(y=j.data,y===\"/$\"){if(S===0){d.removeChild(j),xh(p);return}S--}else y!==\"$\"&&y!==\"$?\"&&y!==\"$!\"||S++;y=j}while(y);xh(p)}function Js(d){for(;d!=null;d=d.nextSibling){var p=d.nodeType;if(p===1||p===3)break;if(p===8){if(p=d.data,p===\"$\"||p===\"$!\"||p===\"$?\")break;if(p===\"/$\")return null}}return d}function I4(d){d=d.previousSibling;for(var p=0;d;){if(d.nodeType===8){var y=d.data;if(y===\"$\"||y===\"$!\"||y===\"$?\"){if(p===0)return d;p--}else y===\"/$\"&&p++}d=d.previousSibling}return null}var Vu=Math.random().toString(36).slice(2),bo=\"__reactFiber$\"+Vu,Ph=\"__reactProps$\"+Vu,es=\"__reactContainer$\"+Vu,Tb=\"__reactEvents$\"+Vu,Jee=\"__reactListeners$\"+Vu,ete=\"__reactHandles$\"+Vu;function pc(d){var p=d[bo];if(p)return p;for(var y=d.parentNode;y;){if(p=y[es]||y[bo]){if(y=p.alternate,p.child!==null||y!==null&&y.child!==null)for(d=I4(d);d!==null;){if(y=d[bo])return y;d=I4(d)}return p}d=y,y=d.parentNode}return null}function Oh(d){return d=d[bo]||d[es],!d||d.tag!==5&&d.tag!==6&&d.tag!==13&&d.tag!==3?null:d}function Uu(d){if(d.tag===5||d.tag===6)return d.stateNode;throw Error(r(33))}function ig(d){return d[Ph]||null}var Pb=[],zu=-1;function el(d){return{current:d}}function xr(d){0>zu||(d.current=Pb[zu],Pb[zu]=null,zu--)}function hr(d,p){zu++,Pb[zu]=d.current,d.current=p}var tl={},Hn=el(tl),ji=el(!1),mc=tl;function Wu(d,p){var y=d.type.contextTypes;if(!y)return tl;var S=d.stateNode;if(S&&S.__reactInternalMemoizedUnmaskedChildContext===p)return S.__reactInternalMemoizedMaskedChildContext;var j={},O;for(O in y)j[O]=p[O];return S&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=p,d.__reactInternalMemoizedMaskedChildContext=j),j}function Ti(d){return d=d.childContextTypes,d!=null}function ag(){xr(ji),xr(Hn)}function M4(d,p,y){if(Hn.current!==tl)throw Error(r(168));hr(Hn,p),hr(ji,y)}function D4(d,p,y){var S=d.stateNode;if(p=p.childContextTypes,typeof S.getChildContext!=\"function\")return y;S=S.getChildContext();for(var j in S)if(!(j in p))throw Error(r(108,je(d)||\"Unknown\",j));return ne({},y,S)}function og(d){return d=(d=d.stateNode)&&d.__reactInternalMemoizedMergedChildContext||tl,mc=Hn.current,hr(Hn,d),hr(ji,ji.current),!0}function R4(d,p,y){var S=d.stateNode;if(!S)throw Error(r(169));y?(d=D4(d,p,mc),S.__reactInternalMemoizedMergedChildContext=d,xr(ji),xr(Hn),hr(Hn,d)):xr(ji),hr(ji,y)}var ts=null,sg=!1,Ob=!1;function F4(d){ts===null?ts=[d]:ts.push(d)}function tte(d){sg=!0,F4(d)}function rl(){if(!Ob&&ts!==null){Ob=!0;var d=0,p=Qt;try{var y=ts;for(Qt=1;d<y.length;d++){var S=y[d];do S=S(!0);while(S!==null)}ts=null,sg=!1}catch(j){throw ts!==null&&(ts=ts.slice(d+1)),BP(J1,rl),j}finally{Qt=p,Ob=!1}}return null}var qu=[],Hu=0,lg=null,cg=0,ca=[],ua=0,gc=null,rs=1,ns=\"\";function vc(d,p){qu[Hu++]=cg,qu[Hu++]=lg,lg=d,cg=p}function L4(d,p,y){ca[ua++]=rs,ca[ua++]=ns,ca[ua++]=gc,gc=d;var S=rs;d=ns;var j=32-Ra(S)-1;S&=~(1<<j),y+=1;var O=32-Ra(p)+j;if(30<O){var M=j-j%5;O=(S&(1<<M)-1).toString(32),S>>=M,j-=M,rs=1<<32-Ra(p)+j|y<<j|S,ns=O+d}else rs=1<<O|y<<j|S,ns=d}function kb(d){d.return!==null&&(vc(d,1),L4(d,1,0))}function Ib(d){for(;d===lg;)lg=qu[--Hu],qu[Hu]=null,cg=qu[--Hu],qu[Hu]=null;for(;d===gc;)gc=ca[--ua],ca[ua]=null,ns=ca[--ua],ca[ua]=null,rs=ca[--ua],ca[ua]=null}var Wi=null,qi=null,Ar=!1,La=null;function B4(d,p){var y=pa(5,null,null,0);y.elementType=\"DELETED\",y.stateNode=p,y.return=d,p=d.deletions,p===null?(d.deletions=[y],d.flags|=16):p.push(y)}function $4(d,p){switch(d.tag){case 5:var y=d.type;return p=p.nodeType!==1||y.toLowerCase()!==p.nodeName.toLowerCase()?null:p,p!==null?(d.stateNode=p,Wi=d,qi=Js(p.firstChild),!0):!1;case 6:return p=d.pendingProps===\"\"||p.nodeType!==3?null:p,p!==null?(d.stateNode=p,Wi=d,qi=null,!0):!1;case 13:return p=p.nodeType!==8?null:p,p!==null?(y=gc!==null?{id:rs,overflow:ns}:null,d.memoizedState={dehydrated:p,treeContext:y,retryLane:1073741824},y=pa(18,null,null,0),y.stateNode=p,y.return=d,d.child=y,Wi=d,qi=null,!0):!1;default:return!1}}function Mb(d){return(d.mode&1)!==0&&(d.flags&128)===0}function Db(d){if(Ar){var p=qi;if(p){var y=p;if(!$4(d,p)){if(Mb(d))throw Error(r(418));p=Js(y.nextSibling);var S=Wi;p&&$4(d,p)?B4(S,y):(d.flags=d.flags&-4097|2,Ar=!1,Wi=d)}}else{if(Mb(d))throw Error(r(418));d.flags=d.flags&-4097|2,Ar=!1,Wi=d}}}function V4(d){for(d=d.return;d!==null&&d.tag!==5&&d.tag!==3&&d.tag!==13;)d=d.return;Wi=d}function ug(d){if(d!==Wi)return!1;if(!Ar)return V4(d),Ar=!0,!1;var p;if((p=d.tag!==3)&&!(p=d.tag!==5)&&(p=d.type,p=p!==\"head\"&&p!==\"body\"&&!Nb(d.type,d.memoizedProps)),p&&(p=qi)){if(Mb(d))throw U4(),Error(r(418));for(;p;)B4(d,p),p=Js(p.nextSibling)}if(V4(d),d.tag===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(r(317));e:{for(d=d.nextSibling,p=0;d;){if(d.nodeType===8){var y=d.data;if(y===\"/$\"){if(p===0){qi=Js(d.nextSibling);break e}p--}else y!==\"$\"&&y!==\"$!\"&&y!==\"$?\"||p++}d=d.nextSibling}qi=null}}else qi=Wi?Js(d.stateNode.nextSibling):null;return!0}function U4(){for(var d=qi;d;)d=Js(d.nextSibling)}function Gu(){qi=Wi=null,Ar=!1}function Rb(d){La===null?La=[d]:La.push(d)}var rte=N.ReactCurrentBatchConfig;function kh(d,p,y){if(d=y.ref,d!==null&&typeof d!=\"function\"&&typeof d!=\"object\"){if(y._owner){if(y=y._owner,y){if(y.tag!==1)throw Error(r(309));var S=y.stateNode}if(!S)throw Error(r(147,d));var j=S,O=\"\"+d;return p!==null&&p.ref!==null&&typeof p.ref==\"function\"&&p.ref._stringRef===O?p.ref:(p=function(M){var H=j.refs;M===null?delete H[O]:H[O]=M},p._stringRef=O,p)}if(typeof d!=\"string\")throw Error(r(284));if(!y._owner)throw Error(r(290,d))}return d}function dg(d,p){throw d=Object.prototype.toString.call(p),Error(r(31,d===\"[object Object]\"?\"object with keys {\"+Object.keys(p).join(\", \")+\"}\":d))}function z4(d){var p=d._init;return p(d._payload)}function W4(d){function p(ie,ee){if(d){var oe=ie.deletions;oe===null?(ie.deletions=[ee],ie.flags|=16):oe.push(ee)}}function y(ie,ee){if(!d)return null;for(;ee!==null;)p(ie,ee),ee=ee.sibling;return null}function S(ie,ee){for(ie=new Map;ee!==null;)ee.key!==null?ie.set(ee.key,ee):ie.set(ee.index,ee),ee=ee.sibling;return ie}function j(ie,ee){return ie=ul(ie,ee),ie.index=0,ie.sibling=null,ie}function O(ie,ee,oe){return ie.index=oe,d?(oe=ie.alternate,oe!==null?(oe=oe.index,oe<ee?(ie.flags|=2,ee):oe):(ie.flags|=2,ee)):(ie.flags|=1048576,ee)}function M(ie){return d&&ie.alternate===null&&(ie.flags|=2),ie}function H(ie,ee,oe,Ee){return ee===null||ee.tag!==6?(ee=Ew(oe,ie.mode,Ee),ee.return=ie,ee):(ee=j(ee,oe),ee.return=ie,ee)}function Q(ie,ee,oe,Ee){var Je=oe.type;return Je===P?be(ie,ee,oe.props.children,Ee,oe.key):ee!==null&&(ee.elementType===Je||typeof Je==\"object\"&&Je!==null&&Je.$$typeof===z&&z4(Je)===ee.type)?(Ee=j(ee,oe.props),Ee.ref=kh(ie,ee,oe),Ee.return=ie,Ee):(Ee=Dg(oe.type,oe.key,oe.props,null,ie.mode,Ee),Ee.ref=kh(ie,ee,oe),Ee.return=ie,Ee)}function se(ie,ee,oe,Ee){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==oe.containerInfo||ee.stateNode.implementation!==oe.implementation?(ee=jw(oe,ie.mode,Ee),ee.return=ie,ee):(ee=j(ee,oe.children||[]),ee.return=ie,ee)}function be(ie,ee,oe,Ee,Je){return ee===null||ee.tag!==7?(ee=Ac(oe,ie.mode,Ee,Je),ee.return=ie,ee):(ee=j(ee,oe),ee.return=ie,ee)}function Se(ie,ee,oe){if(typeof ee==\"string\"&&ee!==\"\"||typeof ee==\"number\")return ee=Ew(\"\"+ee,ie.mode,oe),ee.return=ie,ee;if(typeof ee==\"object\"&&ee!==null){switch(ee.$$typeof){case A:return oe=Dg(ee.type,ee.key,ee.props,null,ie.mode,oe),oe.ref=kh(ie,null,ee),oe.return=ie,oe;case T:return ee=jw(ee,ie.mode,oe),ee.return=ie,ee;case z:var Ee=ee._init;return Se(ie,Ee(ee._payload),oe)}if(X(ee)||re(ee))return ee=Ac(ee,ie.mode,oe,null),ee.return=ie,ee;dg(ie,ee)}return null}function xe(ie,ee,oe,Ee){var Je=ee!==null?ee.key:null;if(typeof oe==\"string\"&&oe!==\"\"||typeof oe==\"number\")return Je!==null?null:H(ie,ee,\"\"+oe,Ee);if(typeof oe==\"object\"&&oe!==null){switch(oe.$$typeof){case A:return oe.key===Je?Q(ie,ee,oe,Ee):null;case T:return oe.key===Je?se(ie,ee,oe,Ee):null;case z:return Je=oe._init,xe(ie,ee,Je(oe._payload),Ee)}if(X(oe)||re(oe))return Je!==null?null:be(ie,ee,oe,Ee,null);dg(ie,oe)}return null}function Ue(ie,ee,oe,Ee,Je){if(typeof Ee==\"string\"&&Ee!==\"\"||typeof Ee==\"number\")return ie=ie.get(oe)||null,H(ee,ie,\"\"+Ee,Je);if(typeof Ee==\"object\"&&Ee!==null){switch(Ee.$$typeof){case A:return ie=ie.get(Ee.key===null?oe:Ee.key)||null,Q(ee,ie,Ee,Je);case T:return ie=ie.get(Ee.key===null?oe:Ee.key)||null,se(ee,ie,Ee,Je);case z:var ot=Ee._init;return Ue(ie,ee,oe,ot(Ee._payload),Je)}if(X(Ee)||re(Ee))return ie=ie.get(oe)||null,be(ee,ie,Ee,Je,null);dg(ee,Ee)}return null}function Ke(ie,ee,oe,Ee){for(var Je=null,ot=null,st=ee,mt=ee=0,An=null;st!==null&&mt<oe.length;mt++){st.index>mt?(An=st,st=null):An=st.sibling;var Vt=xe(ie,st,oe[mt],Ee);if(Vt===null){st===null&&(st=An);break}d&&st&&Vt.alternate===null&&p(ie,st),ee=O(Vt,ee,mt),ot===null?Je=Vt:ot.sibling=Vt,ot=Vt,st=An}if(mt===oe.length)return y(ie,st),Ar&&vc(ie,mt),Je;if(st===null){for(;mt<oe.length;mt++)st=Se(ie,oe[mt],Ee),st!==null&&(ee=O(st,ee,mt),ot===null?Je=st:ot.sibling=st,ot=st);return Ar&&vc(ie,mt),Je}for(st=S(ie,st);mt<oe.length;mt++)An=Ue(st,ie,mt,oe[mt],Ee),An!==null&&(d&&An.alternate!==null&&st.delete(An.key===null?mt:An.key),ee=O(An,ee,mt),ot===null?Je=An:ot.sibling=An,ot=An);return d&&st.forEach(function(dl){return p(ie,dl)}),Ar&&vc(ie,mt),Je}function Ze(ie,ee,oe,Ee){var Je=re(oe);if(typeof Je!=\"function\")throw Error(r(150));if(oe=Je.call(oe),oe==null)throw Error(r(151));for(var ot=Je=null,st=ee,mt=ee=0,An=null,Vt=oe.next();st!==null&&!Vt.done;mt++,Vt=oe.next()){st.index>mt?(An=st,st=null):An=st.sibling;var dl=xe(ie,st,Vt.value,Ee);if(dl===null){st===null&&(st=An);break}d&&st&&dl.alternate===null&&p(ie,st),ee=O(dl,ee,mt),ot===null?Je=dl:ot.sibling=dl,ot=dl,st=An}if(Vt.done)return y(ie,st),Ar&&vc(ie,mt),Je;if(st===null){for(;!Vt.done;mt++,Vt=oe.next())Vt=Se(ie,Vt.value,Ee),Vt!==null&&(ee=O(Vt,ee,mt),ot===null?Je=Vt:ot.sibling=Vt,ot=Vt);return Ar&&vc(ie,mt),Je}for(st=S(ie,st);!Vt.done;mt++,Vt=oe.next())Vt=Ue(st,ie,mt,Vt.value,Ee),Vt!==null&&(d&&Vt.alternate!==null&&st.delete(Vt.key===null?mt:Vt.key),ee=O(Vt,ee,mt),ot===null?Je=Vt:ot.sibling=Vt,ot=Vt);return d&&st.forEach(function(Dte){return p(ie,Dte)}),Ar&&vc(ie,mt),Je}function Hr(ie,ee,oe,Ee){if(typeof oe==\"object\"&&oe!==null&&oe.type===P&&oe.key===null&&(oe=oe.props.children),typeof oe==\"object\"&&oe!==null){switch(oe.$$typeof){case A:e:{for(var Je=oe.key,ot=ee;ot!==null;){if(ot.key===Je){if(Je=oe.type,Je===P){if(ot.tag===7){y(ie,ot.sibling),ee=j(ot,oe.props.children),ee.return=ie,ie=ee;break e}}else if(ot.elementType===Je||typeof Je==\"object\"&&Je!==null&&Je.$$typeof===z&&z4(Je)===ot.type){y(ie,ot.sibling),ee=j(ot,oe.props),ee.ref=kh(ie,ot,oe),ee.return=ie,ie=ee;break e}y(ie,ot);break}else p(ie,ot);ot=ot.sibling}oe.type===P?(ee=Ac(oe.props.children,ie.mode,Ee,oe.key),ee.return=ie,ie=ee):(Ee=Dg(oe.type,oe.key,oe.props,null,ie.mode,Ee),Ee.ref=kh(ie,ee,oe),Ee.return=ie,ie=Ee)}return M(ie);case T:e:{for(ot=oe.key;ee!==null;){if(ee.key===ot)if(ee.tag===4&&ee.stateNode.containerInfo===oe.containerInfo&&ee.stateNode.implementation===oe.implementation){y(ie,ee.sibling),ee=j(ee,oe.children||[]),ee.return=ie,ie=ee;break e}else{y(ie,ee);break}else p(ie,ee);ee=ee.sibling}ee=jw(oe,ie.mode,Ee),ee.return=ie,ie=ee}return M(ie);case z:return ot=oe._init,Hr(ie,ee,ot(oe._payload),Ee)}if(X(oe))return Ke(ie,ee,oe,Ee);if(re(oe))return Ze(ie,ee,oe,Ee);dg(ie,oe)}return typeof oe==\"string\"&&oe!==\"\"||typeof oe==\"number\"?(oe=\"\"+oe,ee!==null&&ee.tag===6?(y(ie,ee.sibling),ee=j(ee,oe),ee.return=ie,ie=ee):(y(ie,ee),ee=Ew(oe,ie.mode,Ee),ee.return=ie,ie=ee),M(ie)):y(ie,ee)}return Hr}var Ku=W4(!0),q4=W4(!1),fg=el(null),hg=null,Xu=null,Fb=null;function Lb(){Fb=Xu=hg=null}function Bb(d){var p=fg.current;xr(fg),d._currentValue=p}function $b(d,p,y){for(;d!==null;){var S=d.alternate;if((d.childLanes&p)!==p?(d.childLanes|=p,S!==null&&(S.childLanes|=p)):S!==null&&(S.childLanes&p)!==p&&(S.childLanes|=p),d===y)break;d=d.return}}function Yu(d,p){hg=d,Fb=Xu=null,d=d.dependencies,d!==null&&d.firstContext!==null&&((d.lanes&p)!==0&&(Pi=!0),d.firstContext=null)}function da(d){var p=d._currentValue;if(Fb!==d)if(d={context:d,memoizedValue:p,next:null},Xu===null){if(hg===null)throw Error(r(308));Xu=d,hg.dependencies={lanes:0,firstContext:d}}else Xu=Xu.next=d;return p}var yc=null;function Vb(d){yc===null?yc=[d]:yc.push(d)}function H4(d,p,y,S){var j=p.interleaved;return j===null?(y.next=y,Vb(p)):(y.next=j.next,j.next=y),p.interleaved=y,is(d,S)}function is(d,p){d.lanes|=p;var y=d.alternate;for(y!==null&&(y.lanes|=p),y=d,d=d.return;d!==null;)d.childLanes|=p,y=d.alternate,y!==null&&(y.childLanes|=p),y=d,d=d.return;return y.tag===3?y.stateNode:null}var nl=!1;function Ub(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function G4(d,p){d=d.updateQueue,p.updateQueue===d&&(p.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,effects:d.effects})}function as(d,p){return{eventTime:d,lane:p,tag:0,payload:null,callback:null,next:null}}function il(d,p,y){var S=d.updateQueue;if(S===null)return null;if(S=S.shared,(Lt&2)!==0){var j=S.pending;return j===null?p.next=p:(p.next=j.next,j.next=p),S.pending=p,is(d,y)}return j=S.interleaved,j===null?(p.next=p,Vb(S)):(p.next=j.next,j.next=p),S.interleaved=p,is(d,y)}function pg(d,p,y){if(p=p.updateQueue,p!==null&&(p=p.shared,(y&4194240)!==0)){var S=p.lanes;S&=d.pendingLanes,y|=S,p.lanes=y,rb(d,y)}}function K4(d,p){var y=d.updateQueue,S=d.alternate;if(S!==null&&(S=S.updateQueue,y===S)){var j=null,O=null;if(y=y.firstBaseUpdate,y!==null){do{var M={eventTime:y.eventTime,lane:y.lane,tag:y.tag,payload:y.payload,callback:y.callback,next:null};O===null?j=O=M:O=O.next=M,y=y.next}while(y!==null);O===null?j=O=p:O=O.next=p}else j=O=p;y={baseState:S.baseState,firstBaseUpdate:j,lastBaseUpdate:O,shared:S.shared,effects:S.effects},d.updateQueue=y;return}d=y.lastBaseUpdate,d===null?y.firstBaseUpdate=p:d.next=p,y.lastBaseUpdate=p}function mg(d,p,y,S){var j=d.updateQueue;nl=!1;var O=j.firstBaseUpdate,M=j.lastBaseUpdate,H=j.shared.pending;if(H!==null){j.shared.pending=null;var Q=H,se=Q.next;Q.next=null,M===null?O=se:M.next=se,M=Q;var be=d.alternate;be!==null&&(be=be.updateQueue,H=be.lastBaseUpdate,H!==M&&(H===null?be.firstBaseUpdate=se:H.next=se,be.lastBaseUpdate=Q))}if(O!==null){var Se=j.baseState;M=0,be=se=Q=null,H=O;do{var xe=H.lane,Ue=H.eventTime;if((S&xe)===xe){be!==null&&(be=be.next={eventTime:Ue,lane:0,tag:H.tag,payload:H.payload,callback:H.callback,next:null});e:{var Ke=d,Ze=H;switch(xe=p,Ue=y,Ze.tag){case 1:if(Ke=Ze.payload,typeof Ke==\"function\"){Se=Ke.call(Ue,Se,xe);break e}Se=Ke;break e;case 3:Ke.flags=Ke.flags&-65537|128;case 0:if(Ke=Ze.payload,xe=typeof Ke==\"function\"?Ke.call(Ue,Se,xe):Ke,xe==null)break e;Se=ne({},Se,xe);break e;case 2:nl=!0}}H.callback!==null&&H.lane!==0&&(d.flags|=64,xe=j.effects,xe===null?j.effects=[H]:xe.push(H))}else Ue={eventTime:Ue,lane:xe,tag:H.tag,payload:H.payload,callback:H.callback,next:null},be===null?(se=be=Ue,Q=Se):be=be.next=Ue,M|=xe;if(H=H.next,H===null){if(H=j.shared.pending,H===null)break;xe=H,H=xe.next,xe.next=null,j.lastBaseUpdate=xe,j.shared.pending=null}}while(!0);if(be===null&&(Q=Se),j.baseState=Q,j.firstBaseUpdate=se,j.lastBaseUpdate=be,p=j.shared.interleaved,p!==null){j=p;do M|=j.lane,j=j.next;while(j!==p)}else O===null&&(j.shared.lanes=0);wc|=M,d.lanes=M,d.memoizedState=Se}}function X4(d,p,y){if(d=p.effects,p.effects=null,d!==null)for(p=0;p<d.length;p++){var S=d[p],j=S.callback;if(j!==null){if(S.callback=null,S=y,typeof j!=\"function\")throw Error(r(191,j));j.call(S)}}}var Ih={},wo=el(Ih),Mh=el(Ih),Dh=el(Ih);function xc(d){if(d===Ih)throw Error(r(174));return d}function zb(d,p){switch(hr(Dh,p),hr(Mh,d),hr(wo,Ih),d=p.nodeType,d){case 9:case 11:p=(p=p.documentElement)?p.namespaceURI:gt(null,\"\");break;default:d=d===8?p.parentNode:p,p=d.namespaceURI||null,d=d.tagName,p=gt(p,d)}xr(wo),hr(wo,p)}function Zu(){xr(wo),xr(Mh),xr(Dh)}function Y4(d){xc(Dh.current);var p=xc(wo.current),y=gt(p,d.type);p!==y&&(hr(Mh,d),hr(wo,y))}function Wb(d){Mh.current===d&&(xr(wo),xr(Mh))}var Pr=el(0);function gg(d){for(var p=d;p!==null;){if(p.tag===13){var y=p.memoizedState;if(y!==null&&(y=y.dehydrated,y===null||y.data===\"$?\"||y.data===\"$!\"))return p}else if(p.tag===19&&p.memoizedProps.revealOrder!==void 0){if((p.flags&128)!==0)return p}else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return null;p=p.return}p.sibling.return=p.return,p=p.sibling}return null}var qb=[];function Hb(){for(var d=0;d<qb.length;d++)qb[d]._workInProgressVersionPrimary=null;qb.length=0}var vg=N.ReactCurrentDispatcher,Gb=N.ReactCurrentBatchConfig,bc=0,Or=null,cn=null,_n=null,yg=!1,Rh=!1,Fh=0,nte=0;function Gn(){throw Error(r(321))}function Kb(d,p){if(p===null)return!1;for(var y=0;y<p.length&&y<d.length;y++)if(!Fa(d[y],p[y]))return!1;return!0}function Xb(d,p,y,S,j,O){if(bc=O,Or=p,p.memoizedState=null,p.updateQueue=null,p.lanes=0,vg.current=d===null||d.memoizedState===null?ste:lte,d=y(S,j),Rh){O=0;do{if(Rh=!1,Fh=0,25<=O)throw Error(r(301));O+=1,_n=cn=null,p.updateQueue=null,vg.current=cte,d=y(S,j)}while(Rh)}if(vg.current=wg,p=cn!==null&&cn.next!==null,bc=0,_n=cn=Or=null,yg=!1,p)throw Error(r(300));return d}function Yb(){var d=Fh!==0;return Fh=0,d}function So(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _n===null?Or.memoizedState=_n=d:_n=_n.next=d,_n}function fa(){if(cn===null){var d=Or.alternate;d=d!==null?d.memoizedState:null}else d=cn.next;var p=_n===null?Or.memoizedState:_n.next;if(p!==null)_n=p,cn=d;else{if(d===null)throw Error(r(310));cn=d,d={memoizedState:cn.memoizedState,baseState:cn.baseState,baseQueue:cn.baseQueue,queue:cn.queue,next:null},_n===null?Or.memoizedState=_n=d:_n=_n.next=d}return _n}function Lh(d,p){return typeof p==\"function\"?p(d):p}function Zb(d){var p=fa(),y=p.queue;if(y===null)throw Error(r(311));y.lastRenderedReducer=d;var S=cn,j=S.baseQueue,O=y.pending;if(O!==null){if(j!==null){var M=j.next;j.next=O.next,O.next=M}S.baseQueue=j=O,y.pending=null}if(j!==null){O=j.next,S=S.baseState;var H=M=null,Q=null,se=O;do{var be=se.lane;if((bc&be)===be)Q!==null&&(Q=Q.next={lane:0,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null}),S=se.hasEagerState?se.eagerState:d(S,se.action);else{var Se={lane:be,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null};Q===null?(H=Q=Se,M=S):Q=Q.next=Se,Or.lanes|=be,wc|=be}se=se.next}while(se!==null&&se!==O);Q===null?M=S:Q.next=H,Fa(S,p.memoizedState)||(Pi=!0),p.memoizedState=S,p.baseState=M,p.baseQueue=Q,y.lastRenderedState=S}if(d=y.interleaved,d!==null){j=d;do O=j.lane,Or.lanes|=O,wc|=O,j=j.next;while(j!==d)}else j===null&&(y.lanes=0);return[p.memoizedState,y.dispatch]}function Qb(d){var p=fa(),y=p.queue;if(y===null)throw Error(r(311));y.lastRenderedReducer=d;var S=y.dispatch,j=y.pending,O=p.memoizedState;if(j!==null){y.pending=null;var M=j=j.next;do O=d(O,M.action),M=M.next;while(M!==j);Fa(O,p.memoizedState)||(Pi=!0),p.memoizedState=O,p.baseQueue===null&&(p.baseState=O),y.lastRenderedState=O}return[O,S]}function Z4(){}function Q4(d,p){var y=Or,S=fa(),j=p(),O=!Fa(S.memoizedState,j);if(O&&(S.memoizedState=j,Pi=!0),S=S.queue,Jb(tO.bind(null,y,S,d),[d]),S.getSnapshot!==p||O||_n!==null&&_n.memoizedState.tag&1){if(y.flags|=2048,Bh(9,eO.bind(null,y,S,j,p),void 0,null),Cn===null)throw Error(r(349));(bc&30)!==0||J4(y,p,j)}return j}function J4(d,p,y){d.flags|=16384,d={getSnapshot:p,value:y},p=Or.updateQueue,p===null?(p={lastEffect:null,stores:null},Or.updateQueue=p,p.stores=[d]):(y=p.stores,y===null?p.stores=[d]:y.push(d))}function eO(d,p,y,S){p.value=y,p.getSnapshot=S,rO(p)&&nO(d)}function tO(d,p,y){return y(function(){rO(p)&&nO(d)})}function rO(d){var p=d.getSnapshot;d=d.value;try{var y=p();return!Fa(d,y)}catch{return!0}}function nO(d){var p=is(d,1);p!==null&&Ua(p,d,1,-1)}function iO(d){var p=So();return typeof d==\"function\"&&(d=d()),p.memoizedState=p.baseState=d,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Lh,lastRenderedState:d},p.queue=d,d=d.dispatch=ote.bind(null,Or,d),[p.memoizedState,d]}function Bh(d,p,y,S){return d={tag:d,create:p,destroy:y,deps:S,next:null},p=Or.updateQueue,p===null?(p={lastEffect:null,stores:null},Or.updateQueue=p,p.lastEffect=d.next=d):(y=p.lastEffect,y===null?p.lastEffect=d.next=d:(S=y.next,y.next=d,d.next=S,p.lastEffect=d)),d}function aO(){return fa().memoizedState}function xg(d,p,y,S){var j=So();Or.flags|=d,j.memoizedState=Bh(1|p,y,void 0,S===void 0?null:S)}function bg(d,p,y,S){var j=fa();S=S===void 0?null:S;var O=void 0;if(cn!==null){var M=cn.memoizedState;if(O=M.destroy,S!==null&&Kb(S,M.deps)){j.memoizedState=Bh(p,y,O,S);return}}Or.flags|=d,j.memoizedState=Bh(1|p,y,O,S)}function oO(d,p){return xg(8390656,8,d,p)}function Jb(d,p){return bg(2048,8,d,p)}function sO(d,p){return bg(4,2,d,p)}function lO(d,p){return bg(4,4,d,p)}function cO(d,p){if(typeof p==\"function\")return d=d(),p(d),function(){p(null)};if(p!=null)return d=d(),p.current=d,function(){p.current=null}}function uO(d,p,y){return y=y!=null?y.concat([d]):null,bg(4,4,cO.bind(null,p,d),y)}function ew(){}function dO(d,p){var y=fa();p=p===void 0?null:p;var S=y.memoizedState;return S!==null&&p!==null&&Kb(p,S[1])?S[0]:(y.memoizedState=[d,p],d)}function fO(d,p){var y=fa();p=p===void 0?null:p;var S=y.memoizedState;return S!==null&&p!==null&&Kb(p,S[1])?S[0]:(d=d(),y.memoizedState=[d,p],d)}function hO(d,p,y){return(bc&21)===0?(d.baseState&&(d.baseState=!1,Pi=!0),d.memoizedState=y):(Fa(y,p)||(y=zP(),Or.lanes|=y,wc|=y,d.baseState=!0),p)}function ite(d,p){var y=Qt;Qt=y!==0&&4>y?y:4,d(!0);var S=Gb.transition;Gb.transition={};try{d(!1),p()}finally{Qt=y,Gb.transition=S}}function pO(){return fa().memoizedState}function ate(d,p,y){var S=ll(d);if(y={lane:S,action:y,hasEagerState:!1,eagerState:null,next:null},mO(d))gO(p,y);else if(y=H4(d,p,y,S),y!==null){var j=ai();Ua(y,d,S,j),vO(y,p,S)}}function ote(d,p,y){var S=ll(d),j={lane:S,action:y,hasEagerState:!1,eagerState:null,next:null};if(mO(d))gO(p,j);else{var O=d.alternate;if(d.lanes===0&&(O===null||O.lanes===0)&&(O=p.lastRenderedReducer,O!==null))try{var M=p.lastRenderedState,H=O(M,y);if(j.hasEagerState=!0,j.eagerState=H,Fa(H,M)){var Q=p.interleaved;Q===null?(j.next=j,Vb(p)):(j.next=Q.next,Q.next=j),p.interleaved=j;return}}catch{}finally{}y=H4(d,p,j,S),y!==null&&(j=ai(),Ua(y,d,S,j),vO(y,p,S))}}function mO(d){var p=d.alternate;return d===Or||p!==null&&p===Or}function gO(d,p){Rh=yg=!0;var y=d.pending;y===null?p.next=p:(p.next=y.next,y.next=p),d.pending=p}function vO(d,p,y){if((y&4194240)!==0){var S=p.lanes;S&=d.pendingLanes,y|=S,p.lanes=y,rb(d,y)}}var wg={readContext:da,useCallback:Gn,useContext:Gn,useEffect:Gn,useImperativeHandle:Gn,useInsertionEffect:Gn,useLayoutEffect:Gn,useMemo:Gn,useReducer:Gn,useRef:Gn,useState:Gn,useDebugValue:Gn,useDeferredValue:Gn,useTransition:Gn,useMutableSource:Gn,useSyncExternalStore:Gn,useId:Gn,unstable_isNewReconciler:!1},ste={readContext:da,useCallback:function(d,p){return So().memoizedState=[d,p===void 0?null:p],d},useContext:da,useEffect:oO,useImperativeHandle:function(d,p,y){return y=y!=null?y.concat([d]):null,xg(4194308,4,cO.bind(null,p,d),y)},useLayoutEffect:function(d,p){return xg(4194308,4,d,p)},useInsertionEffect:function(d,p){return xg(4,2,d,p)},useMemo:function(d,p){var y=So();return p=p===void 0?null:p,d=d(),y.memoizedState=[d,p],d},useReducer:function(d,p,y){var S=So();return p=y!==void 0?y(p):p,S.memoizedState=S.baseState=p,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:p},S.queue=d,d=d.dispatch=ate.bind(null,Or,d),[S.memoizedState,d]},useRef:function(d){var p=So();return d={current:d},p.memoizedState=d},useState:iO,useDebugValue:ew,useDeferredValue:function(d){return So().memoizedState=d},useTransition:function(){var d=iO(!1),p=d[0];return d=ite.bind(null,d[1]),So().memoizedState=d,[p,d]},useMutableSource:function(){},useSyncExternalStore:function(d,p,y){var S=Or,j=So();if(Ar){if(y===void 0)throw Error(r(407));y=y()}else{if(y=p(),Cn===null)throw Error(r(349));(bc&30)!==0||J4(S,p,y)}j.memoizedState=y;var O={value:y,getSnapshot:p};return j.queue=O,oO(tO.bind(null,S,O,d),[d]),S.flags|=2048,Bh(9,eO.bind(null,S,O,y,p),void 0,null),y},useId:function(){var d=So(),p=Cn.identifierPrefix;if(Ar){var y=ns,S=rs;y=(S&~(1<<32-Ra(S)-1)).toString(32)+y,p=\":\"+p+\"R\"+y,y=Fh++,0<y&&(p+=\"H\"+y.toString(32)),p+=\":\"}else y=nte++,p=\":\"+p+\"r\"+y.toString(32)+\":\";return d.memoizedState=p},unstable_isNewReconciler:!1},lte={readContext:da,useCallback:dO,useContext:da,useEffect:Jb,useImperativeHandle:uO,useInsertionEffect:sO,useLayoutEffect:lO,useMemo:fO,useReducer:Zb,useRef:aO,useState:function(){return Zb(Lh)},useDebugValue:ew,useDeferredValue:function(d){var p=fa();return hO(p,cn.memoizedState,d)},useTransition:function(){var d=Zb(Lh)[0],p=fa().memoizedState;return[d,p]},useMutableSource:Z4,useSyncExternalStore:Q4,useId:pO,unstable_isNewReconciler:!1},cte={readContext:da,useCallback:dO,useContext:da,useEffect:Jb,useImperativeHandle:uO,useInsertionEffect:sO,useLayoutEffect:lO,useMemo:fO,useReducer:Qb,useRef:aO,useState:function(){return Qb(Lh)},useDebugValue:ew,useDeferredValue:function(d){var p=fa();return cn===null?p.memoizedState=d:hO(p,cn.memoizedState,d)},useTransition:function(){var d=Qb(Lh)[0],p=fa().memoizedState;return[d,p]},useMutableSource:Z4,useSyncExternalStore:Q4,useId:pO,unstable_isNewReconciler:!1};function Ba(d,p){if(d&&d.defaultProps){p=ne({},p),d=d.defaultProps;for(var y in d)p[y]===void 0&&(p[y]=d[y]);return p}return p}function tw(d,p,y,S){p=d.memoizedState,y=y(S,p),y=y==null?p:ne({},p,y),d.memoizedState=y,d.lanes===0&&(d.updateQueue.baseState=y)}var Sg={isMounted:function(d){return(d=d._reactInternals)?hc(d)===d:!1},enqueueSetState:function(d,p,y){d=d._reactInternals;var S=ai(),j=ll(d),O=as(S,j);O.payload=p,y!=null&&(O.callback=y),p=il(d,O,j),p!==null&&(Ua(p,d,j,S),pg(p,d,j))},enqueueReplaceState:function(d,p,y){d=d._reactInternals;var S=ai(),j=ll(d),O=as(S,j);O.tag=1,O.payload=p,y!=null&&(O.callback=y),p=il(d,O,j),p!==null&&(Ua(p,d,j,S),pg(p,d,j))},enqueueForceUpdate:function(d,p){d=d._reactInternals;var y=ai(),S=ll(d),j=as(y,S);j.tag=2,p!=null&&(j.callback=p),p=il(d,j,S),p!==null&&(Ua(p,d,S,y),pg(p,d,S))}};function yO(d,p,y,S,j,O,M){return d=d.stateNode,typeof d.shouldComponentUpdate==\"function\"?d.shouldComponentUpdate(S,O,M):p.prototype&&p.prototype.isPureReactComponent?!Ah(y,S)||!Ah(j,O):!0}function xO(d,p,y){var S=!1,j=tl,O=p.contextType;return typeof O==\"object\"&&O!==null?O=da(O):(j=Ti(p)?mc:Hn.current,S=p.contextTypes,O=(S=S!=null)?Wu(d,j):tl),p=new p(y,O),d.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=Sg,d.stateNode=p,p._reactInternals=d,S&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=j,d.__reactInternalMemoizedMaskedChildContext=O),p}function bO(d,p,y,S){d=p.state,typeof p.componentWillReceiveProps==\"function\"&&p.componentWillReceiveProps(y,S),typeof p.UNSAFE_componentWillReceiveProps==\"function\"&&p.UNSAFE_componentWillReceiveProps(y,S),p.state!==d&&Sg.enqueueReplaceState(p,p.state,null)}function rw(d,p,y,S){var j=d.stateNode;j.props=y,j.state=d.memoizedState,j.refs={},Ub(d);var O=p.contextType;typeof O==\"object\"&&O!==null?j.context=da(O):(O=Ti(p)?mc:Hn.current,j.context=Wu(d,O)),j.state=d.memoizedState,O=p.getDerivedStateFromProps,typeof O==\"function\"&&(tw(d,p,O,y),j.state=d.memoizedState),typeof p.getDerivedStateFromProps==\"function\"||typeof j.getSnapshotBeforeUpdate==\"function\"||typeof j.UNSAFE_componentWillMount!=\"function\"&&typeof j.componentWillMount!=\"function\"||(p=j.state,typeof j.componentWillMount==\"function\"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount==\"function\"&&j.UNSAFE_componentWillMount(),p!==j.state&&Sg.enqueueReplaceState(j,j.state,null),mg(d,y,j,S),j.state=d.memoizedState),typeof j.componentDidMount==\"function\"&&(d.flags|=4194308)}function Qu(d,p){try{var y=\"\",S=p;do y+=Fe(S),S=S.return;while(S);var j=y}catch(O){j=`\nError generating stack: `+O.message+`\n`+O.stack}return{value:d,source:p,stack:j,digest:null}}function nw(d,p,y){return{value:d,source:null,stack:y??null,digest:p??null}}function iw(d,p){try{console.error(p.value)}catch(y){setTimeout(function(){throw y})}}var ute=typeof WeakMap==\"function\"?WeakMap:Map;function wO(d,p,y){y=as(-1,y),y.tag=3,y.payload={element:null};var S=p.value;return y.callback=function(){Tg||(Tg=!0,xw=S),iw(d,p)},y}function SO(d,p,y){y=as(-1,y),y.tag=3;var S=d.type.getDerivedStateFromError;if(typeof S==\"function\"){var j=p.value;y.payload=function(){return S(j)},y.callback=function(){iw(d,p)}}var O=d.stateNode;return O!==null&&typeof O.componentDidCatch==\"function\"&&(y.callback=function(){iw(d,p),typeof S!=\"function\"&&(ol===null?ol=new Set([this]):ol.add(this));var M=p.stack;this.componentDidCatch(p.value,{componentStack:M!==null?M:\"\"})}),y}function _O(d,p,y){var S=d.pingCache;if(S===null){S=d.pingCache=new ute;var j=new Set;S.set(p,j)}else j=S.get(p),j===void 0&&(j=new Set,S.set(p,j));j.has(y)||(j.add(y),d=Cte.bind(null,d,p,y),p.then(d,d))}function CO(d){do{var p;if((p=d.tag===13)&&(p=d.memoizedState,p=p!==null?p.dehydrated!==null:!0),p)return d;d=d.return}while(d!==null);return null}function AO(d,p,y,S,j){return(d.mode&1)===0?(d===p?d.flags|=65536:(d.flags|=128,y.flags|=131072,y.flags&=-52805,y.tag===1&&(y.alternate===null?y.tag=17:(p=as(-1,1),p.tag=2,il(y,p,1))),y.lanes|=1),d):(d.flags|=65536,d.lanes=j,d)}var dte=N.ReactCurrentOwner,Pi=!1;function ii(d,p,y,S){p.child=d===null?q4(p,null,y,S):Ku(p,d.child,y,S)}function NO(d,p,y,S,j){y=y.render;var O=p.ref;return Yu(p,j),S=Xb(d,p,y,S,O,j),y=Yb(),d!==null&&!Pi?(p.updateQueue=d.updateQueue,p.flags&=-2053,d.lanes&=~j,os(d,p,j)):(Ar&&y&&kb(p),p.flags|=1,ii(d,p,S,j),p.child)}function EO(d,p,y,S,j){if(d===null){var O=y.type;return typeof O==\"function\"&&!Nw(O)&&O.defaultProps===void 0&&y.compare===null&&y.defaultProps===void 0?(p.tag=15,p.type=O,jO(d,p,O,S,j)):(d=Dg(y.type,null,S,p,p.mode,j),d.ref=p.ref,d.return=p,p.child=d)}if(O=d.child,(d.lanes&j)===0){var M=O.memoizedProps;if(y=y.compare,y=y!==null?y:Ah,y(M,S)&&d.ref===p.ref)return os(d,p,j)}return p.flags|=1,d=ul(O,S),d.ref=p.ref,d.return=p,p.child=d}function jO(d,p,y,S,j){if(d!==null){var O=d.memoizedProps;if(Ah(O,S)&&d.ref===p.ref)if(Pi=!1,p.pendingProps=S=O,(d.lanes&j)!==0)(d.flags&131072)!==0&&(Pi=!0);else return p.lanes=d.lanes,os(d,p,j)}return aw(d,p,y,S,j)}function TO(d,p,y){var S=p.pendingProps,j=S.children,O=d!==null?d.memoizedState:null;if(S.mode===\"hidden\")if((p.mode&1)===0)p.memoizedState={baseLanes:0,cachePool:null,transitions:null},hr(ed,Hi),Hi|=y;else{if((y&1073741824)===0)return d=O!==null?O.baseLanes|y:y,p.lanes=p.childLanes=1073741824,p.memoizedState={baseLanes:d,cachePool:null,transitions:null},p.updateQueue=null,hr(ed,Hi),Hi|=d,null;p.memoizedState={baseLanes:0,cachePool:null,transitions:null},S=O!==null?O.baseLanes:y,hr(ed,Hi),Hi|=S}else O!==null?(S=O.baseLanes|y,p.memoizedState=null):S=y,hr(ed,Hi),Hi|=S;return ii(d,p,j,y),p.child}function PO(d,p){var y=p.ref;(d===null&&y!==null||d!==null&&d.ref!==y)&&(p.flags|=512,p.flags|=2097152)}function aw(d,p,y,S,j){var O=Ti(y)?mc:Hn.current;return O=Wu(p,O),Yu(p,j),y=Xb(d,p,y,S,O,j),S=Yb(),d!==null&&!Pi?(p.updateQueue=d.updateQueue,p.flags&=-2053,d.lanes&=~j,os(d,p,j)):(Ar&&S&&kb(p),p.flags|=1,ii(d,p,y,j),p.child)}function OO(d,p,y,S,j){if(Ti(y)){var O=!0;og(p)}else O=!1;if(Yu(p,j),p.stateNode===null)Cg(d,p),xO(p,y,S),rw(p,y,S,j),S=!0;else if(d===null){var M=p.stateNode,H=p.memoizedProps;M.props=H;var Q=M.context,se=y.contextType;typeof se==\"object\"&&se!==null?se=da(se):(se=Ti(y)?mc:Hn.current,se=Wu(p,se));var be=y.getDerivedStateFromProps,Se=typeof be==\"function\"||typeof M.getSnapshotBeforeUpdate==\"function\";Se||typeof M.UNSAFE_componentWillReceiveProps!=\"function\"&&typeof M.componentWillReceiveProps!=\"function\"||(H!==S||Q!==se)&&bO(p,M,S,se),nl=!1;var xe=p.memoizedState;M.state=xe,mg(p,S,M,j),Q=p.memoizedState,H!==S||xe!==Q||ji.current||nl?(typeof be==\"function\"&&(tw(p,y,be,S),Q=p.memoizedState),(H=nl||yO(p,y,H,S,xe,Q,se))?(Se||typeof M.UNSAFE_componentWillMount!=\"function\"&&typeof M.componentWillMount!=\"function\"||(typeof M.componentWillMount==\"function\"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount==\"function\"&&M.UNSAFE_componentWillMount()),typeof M.componentDidMount==\"function\"&&(p.flags|=4194308)):(typeof M.componentDidMount==\"function\"&&(p.flags|=4194308),p.memoizedProps=S,p.memoizedState=Q),M.props=S,M.state=Q,M.context=se,S=H):(typeof M.componentDidMount==\"function\"&&(p.flags|=4194308),S=!1)}else{M=p.stateNode,G4(d,p),H=p.memoizedProps,se=p.type===p.elementType?H:Ba(p.type,H),M.props=se,Se=p.pendingProps,xe=M.context,Q=y.contextType,typeof Q==\"object\"&&Q!==null?Q=da(Q):(Q=Ti(y)?mc:Hn.current,Q=Wu(p,Q));var Ue=y.getDerivedStateFromProps;(be=typeof Ue==\"function\"||typeof M.getSnapshotBeforeUpdate==\"function\")||typeof M.UNSAFE_componentWillReceiveProps!=\"function\"&&typeof M.componentWillReceiveProps!=\"function\"||(H!==Se||xe!==Q)&&bO(p,M,S,Q),nl=!1,xe=p.memoizedState,M.state=xe,mg(p,S,M,j);var Ke=p.memoizedState;H!==Se||xe!==Ke||ji.current||nl?(typeof Ue==\"function\"&&(tw(p,y,Ue,S),Ke=p.memoizedState),(se=nl||yO(p,y,se,S,xe,Ke,Q)||!1)?(be||typeof M.UNSAFE_componentWillUpdate!=\"function\"&&typeof M.componentWillUpdate!=\"function\"||(typeof M.componentWillUpdate==\"function\"&&M.componentWillUpdate(S,Ke,Q),typeof M.UNSAFE_componentWillUpdate==\"function\"&&M.UNSAFE_componentWillUpdate(S,Ke,Q)),typeof M.componentDidUpdate==\"function\"&&(p.flags|=4),typeof M.getSnapshotBeforeUpdate==\"function\"&&(p.flags|=1024)):(typeof M.componentDidUpdate!=\"function\"||H===d.memoizedProps&&xe===d.memoizedState||(p.flags|=4),typeof M.getSnapshotBeforeUpdate!=\"function\"||H===d.memoizedProps&&xe===d.memoizedState||(p.flags|=1024),p.memoizedProps=S,p.memoizedState=Ke),M.props=S,M.state=Ke,M.context=Q,S=se):(typeof M.componentDidUpdate!=\"function\"||H===d.memoizedProps&&xe===d.memoizedState||(p.flags|=4),typeof M.getSnapshotBeforeUpdate!=\"function\"||H===d.memoizedProps&&xe===d.memoizedState||(p.flags|=1024),S=!1)}return ow(d,p,y,S,O,j)}function ow(d,p,y,S,j,O){PO(d,p);var M=(p.flags&128)!==0;if(!S&&!M)return j&&R4(p,y,!1),os(d,p,O);S=p.stateNode,dte.current=p;var H=M&&typeof y.getDerivedStateFromError!=\"function\"?null:S.render();return p.flags|=1,d!==null&&M?(p.child=Ku(p,d.child,null,O),p.child=Ku(p,null,H,O)):ii(d,p,H,O),p.memoizedState=S.state,j&&R4(p,y,!0),p.child}function kO(d){var p=d.stateNode;p.pendingContext?M4(d,p.pendingContext,p.pendingContext!==p.context):p.context&&M4(d,p.context,!1),zb(d,p.containerInfo)}function IO(d,p,y,S,j){return Gu(),Rb(j),p.flags|=256,ii(d,p,y,S),p.child}var sw={dehydrated:null,treeContext:null,retryLane:0};function lw(d){return{baseLanes:d,cachePool:null,transitions:null}}function MO(d,p,y){var S=p.pendingProps,j=Pr.current,O=!1,M=(p.flags&128)!==0,H;if((H=M)||(H=d!==null&&d.memoizedState===null?!1:(j&2)!==0),H?(O=!0,p.flags&=-129):(d===null||d.memoizedState!==null)&&(j|=1),hr(Pr,j&1),d===null)return Db(p),d=p.memoizedState,d!==null&&(d=d.dehydrated,d!==null)?((p.mode&1)===0?p.lanes=1:d.data===\"$!\"?p.lanes=8:p.lanes=1073741824,null):(M=S.children,d=S.fallback,O?(S=p.mode,O=p.child,M={mode:\"hidden\",children:M},(S&1)===0&&O!==null?(O.childLanes=0,O.pendingProps=M):O=Rg(M,S,0,null),d=Ac(d,S,y,null),O.return=p,d.return=p,O.sibling=d,p.child=O,p.child.memoizedState=lw(y),p.memoizedState=sw,d):cw(p,M));if(j=d.memoizedState,j!==null&&(H=j.dehydrated,H!==null))return fte(d,p,M,S,H,j,y);if(O){O=S.fallback,M=p.mode,j=d.child,H=j.sibling;var Q={mode:\"hidden\",children:S.children};return(M&1)===0&&p.child!==j?(S=p.child,S.childLanes=0,S.pendingProps=Q,p.deletions=null):(S=ul(j,Q),S.subtreeFlags=j.subtreeFlags&14680064),H!==null?O=ul(H,O):(O=Ac(O,M,y,null),O.flags|=2),O.return=p,S.return=p,S.sibling=O,p.child=S,S=O,O=p.child,M=d.child.memoizedState,M=M===null?lw(y):{baseLanes:M.baseLanes|y,cachePool:null,transitions:M.transitions},O.memoizedState=M,O.childLanes=d.childLanes&~y,p.memoizedState=sw,S}return O=d.child,d=O.sibling,S=ul(O,{mode:\"visible\",children:S.children}),(p.mode&1)===0&&(S.lanes=y),S.return=p,S.sibling=null,d!==null&&(y=p.deletions,y===null?(p.deletions=[d],p.flags|=16):y.push(d)),p.child=S,p.memoizedState=null,S}function cw(d,p){return p=Rg({mode:\"visible\",children:p},d.mode,0,null),p.return=d,d.child=p}function _g(d,p,y,S){return S!==null&&Rb(S),Ku(p,d.child,null,y),d=cw(p,p.pendingProps.children),d.flags|=2,p.memoizedState=null,d}function fte(d,p,y,S,j,O,M){if(y)return p.flags&256?(p.flags&=-257,S=nw(Error(r(422))),_g(d,p,M,S)):p.memoizedState!==null?(p.child=d.child,p.flags|=128,null):(O=S.fallback,j=p.mode,S=Rg({mode:\"visible\",children:S.children},j,0,null),O=Ac(O,j,M,null),O.flags|=2,S.return=p,O.return=p,S.sibling=O,p.child=S,(p.mode&1)!==0&&Ku(p,d.child,null,M),p.child.memoizedState=lw(M),p.memoizedState=sw,O);if((p.mode&1)===0)return _g(d,p,M,null);if(j.data===\"$!\"){if(S=j.nextSibling&&j.nextSibling.dataset,S)var H=S.dgst;return S=H,O=Error(r(419)),S=nw(O,S,void 0),_g(d,p,M,S)}if(H=(M&d.childLanes)!==0,Pi||H){if(S=Cn,S!==null){switch(M&-M){case 4:j=2;break;case 16:j=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:j=32;break;case 536870912:j=268435456;break;default:j=0}j=(j&(S.suspendedLanes|M))!==0?0:j,j!==0&&j!==O.retryLane&&(O.retryLane=j,is(d,j),Ua(S,d,j,-1))}return Aw(),S=nw(Error(r(421))),_g(d,p,M,S)}return j.data===\"$?\"?(p.flags|=128,p.child=d.child,p=Ate.bind(null,d),j._reactRetry=p,null):(d=O.treeContext,qi=Js(j.nextSibling),Wi=p,Ar=!0,La=null,d!==null&&(ca[ua++]=rs,ca[ua++]=ns,ca[ua++]=gc,rs=d.id,ns=d.overflow,gc=p),p=cw(p,S.children),p.flags|=4096,p)}function DO(d,p,y){d.lanes|=p;var S=d.alternate;S!==null&&(S.lanes|=p),$b(d.return,p,y)}function uw(d,p,y,S,j){var O=d.memoizedState;O===null?d.memoizedState={isBackwards:p,rendering:null,renderingStartTime:0,last:S,tail:y,tailMode:j}:(O.isBackwards=p,O.rendering=null,O.renderingStartTime=0,O.last=S,O.tail=y,O.tailMode=j)}function RO(d,p,y){var S=p.pendingProps,j=S.revealOrder,O=S.tail;if(ii(d,p,S.children,y),S=Pr.current,(S&2)!==0)S=S&1|2,p.flags|=128;else{if(d!==null&&(d.flags&128)!==0)e:for(d=p.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&DO(d,y,p);else if(d.tag===19)DO(d,y,p);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===p)break e;for(;d.sibling===null;){if(d.return===null||d.return===p)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}S&=1}if(hr(Pr,S),(p.mode&1)===0)p.memoizedState=null;else switch(j){case\"forwards\":for(y=p.child,j=null;y!==null;)d=y.alternate,d!==null&&gg(d)===null&&(j=y),y=y.sibling;y=j,y===null?(j=p.child,p.child=null):(j=y.sibling,y.sibling=null),uw(p,!1,j,y,O);break;case\"backwards\":for(y=null,j=p.child,p.child=null;j!==null;){if(d=j.alternate,d!==null&&gg(d)===null){p.child=j;break}d=j.sibling,j.sibling=y,y=j,j=d}uw(p,!0,y,null,O);break;case\"together\":uw(p,!1,null,null,void 0);break;default:p.memoizedState=null}return p.child}function Cg(d,p){(p.mode&1)===0&&d!==null&&(d.alternate=null,p.alternate=null,p.flags|=2)}function os(d,p,y){if(d!==null&&(p.dependencies=d.dependencies),wc|=p.lanes,(y&p.childLanes)===0)return null;if(d!==null&&p.child!==d.child)throw Error(r(153));if(p.child!==null){for(d=p.child,y=ul(d,d.pendingProps),p.child=y,y.return=p;d.sibling!==null;)d=d.sibling,y=y.sibling=ul(d,d.pendingProps),y.return=p;y.sibling=null}return p.child}function hte(d,p,y){switch(p.tag){case 3:kO(p),Gu();break;case 5:Y4(p);break;case 1:Ti(p.type)&&og(p);break;case 4:zb(p,p.stateNode.containerInfo);break;case 10:var S=p.type._context,j=p.memoizedProps.value;hr(fg,S._currentValue),S._currentValue=j;break;case 13:if(S=p.memoizedState,S!==null)return S.dehydrated!==null?(hr(Pr,Pr.current&1),p.flags|=128,null):(y&p.child.childLanes)!==0?MO(d,p,y):(hr(Pr,Pr.current&1),d=os(d,p,y),d!==null?d.sibling:null);hr(Pr,Pr.current&1);break;case 19:if(S=(y&p.childLanes)!==0,(d.flags&128)!==0){if(S)return RO(d,p,y);p.flags|=128}if(j=p.memoizedState,j!==null&&(j.rendering=null,j.tail=null,j.lastEffect=null),hr(Pr,Pr.current),S)break;return null;case 22:case 23:return p.lanes=0,TO(d,p,y)}return os(d,p,y)}var FO,dw,LO,BO;FO=function(d,p){for(var y=p.child;y!==null;){if(y.tag===5||y.tag===6)d.appendChild(y.stateNode);else if(y.tag!==4&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===p)break;for(;y.sibling===null;){if(y.return===null||y.return===p)return;y=y.return}y.sibling.return=y.return,y=y.sibling}},dw=function(){},LO=function(d,p,y,S){var j=d.memoizedProps;if(j!==S){d=p.stateNode,xc(wo.current);var O=null;switch(y){case\"input\":j=le(d,j),S=le(d,S),O=[];break;case\"select\":j=ne({},j,{value:void 0}),S=ne({},S,{value:void 0}),O=[];break;case\"textarea\":j=Z(d,j),S=Z(d,S),O=[];break;default:typeof j.onClick!=\"function\"&&typeof S.onClick==\"function\"&&(d.onclick=ng)}ve(y,S);var M;y=null;for(se in j)if(!S.hasOwnProperty(se)&&j.hasOwnProperty(se)&&j[se]!=null)if(se===\"style\"){var H=j[se];for(M in H)H.hasOwnProperty(M)&&(y||(y={}),y[M]=\"\")}else se!==\"dangerouslySetInnerHTML\"&&se!==\"children\"&&se!==\"suppressContentEditableWarning\"&&se!==\"suppressHydrationWarning\"&&se!==\"autoFocus\"&&(i.hasOwnProperty(se)?O||(O=[]):(O=O||[]).push(se,null));for(se in S){var Q=S[se];if(H=j!=null?j[se]:void 0,S.hasOwnProperty(se)&&Q!==H&&(Q!=null||H!=null))if(se===\"style\")if(H){for(M in H)!H.hasOwnProperty(M)||Q&&Q.hasOwnProperty(M)||(y||(y={}),y[M]=\"\");for(M in Q)Q.hasOwnProperty(M)&&H[M]!==Q[M]&&(y||(y={}),y[M]=Q[M])}else y||(O||(O=[]),O.push(se,y)),y=Q;else se===\"dangerouslySetInnerHTML\"?(Q=Q?Q.__html:void 0,H=H?H.__html:void 0,Q!=null&&H!==Q&&(O=O||[]).push(se,Q)):se===\"children\"?typeof Q!=\"string\"&&typeof Q!=\"number\"||(O=O||[]).push(se,\"\"+Q):se!==\"suppressContentEditableWarning\"&&se!==\"suppressHydrationWarning\"&&(i.hasOwnProperty(se)?(Q!=null&&se===\"onScroll\"&&yr(\"scroll\",d),O||H===Q||(O=[])):(O=O||[]).push(se,Q))}y&&(O=O||[]).push(\"style\",y);var se=O;(p.updateQueue=se)&&(p.flags|=4)}},BO=function(d,p,y,S){y!==S&&(p.flags|=4)};function $h(d,p){if(!Ar)switch(d.tailMode){case\"hidden\":p=d.tail;for(var y=null;p!==null;)p.alternate!==null&&(y=p),p=p.sibling;y===null?d.tail=null:y.sibling=null;break;case\"collapsed\":y=d.tail;for(var S=null;y!==null;)y.alternate!==null&&(S=y),y=y.sibling;S===null?p||d.tail===null?d.tail=null:d.tail.sibling=null:S.sibling=null}}function Kn(d){var p=d.alternate!==null&&d.alternate.child===d.child,y=0,S=0;if(p)for(var j=d.child;j!==null;)y|=j.lanes|j.childLanes,S|=j.subtreeFlags&14680064,S|=j.flags&14680064,j.return=d,j=j.sibling;else for(j=d.child;j!==null;)y|=j.lanes|j.childLanes,S|=j.subtreeFlags,S|=j.flags,j.return=d,j=j.sibling;return d.subtreeFlags|=S,d.childLanes=y,p}function pte(d,p,y){var S=p.pendingProps;switch(Ib(p),p.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kn(p),null;case 1:return Ti(p.type)&&ag(),Kn(p),null;case 3:return S=p.stateNode,Zu(),xr(ji),xr(Hn),Hb(),S.pendingContext&&(S.context=S.pendingContext,S.pendingContext=null),(d===null||d.child===null)&&(ug(p)?p.flags|=4:d===null||d.memoizedState.isDehydrated&&(p.flags&256)===0||(p.flags|=1024,La!==null&&(Sw(La),La=null))),dw(d,p),Kn(p),null;case 5:Wb(p);var j=xc(Dh.current);if(y=p.type,d!==null&&p.stateNode!=null)LO(d,p,y,S,j),d.ref!==p.ref&&(p.flags|=512,p.flags|=2097152);else{if(!S){if(p.stateNode===null)throw Error(r(166));return Kn(p),null}if(d=xc(wo.current),ug(p)){S=p.stateNode,y=p.type;var O=p.memoizedProps;switch(S[bo]=p,S[Ph]=O,d=(p.mode&1)!==0,y){case\"dialog\":yr(\"cancel\",S),yr(\"close\",S);break;case\"iframe\":case\"object\":case\"embed\":yr(\"load\",S);break;case\"video\":case\"audio\":for(j=0;j<Eh.length;j++)yr(Eh[j],S);break;case\"source\":yr(\"error\",S);break;case\"img\":case\"image\":case\"link\":yr(\"error\",S),yr(\"load\",S);break;case\"details\":yr(\"toggle\",S);break;case\"input\":qe(S,O),yr(\"invalid\",S);break;case\"select\":S._wrapperState={wasMultiple:!!O.multiple},yr(\"invalid\",S);break;case\"textarea\":ue(S,O),yr(\"invalid\",S)}ve(y,O),j=null;for(var M in O)if(O.hasOwnProperty(M)){var H=O[M];M===\"children\"?typeof H==\"string\"?S.textContent!==H&&(O.suppressHydrationWarning!==!0&&rg(S.textContent,H,d),j=[\"children\",H]):typeof H==\"number\"&&S.textContent!==\"\"+H&&(O.suppressHydrationWarning!==!0&&rg(S.textContent,H,d),j=[\"children\",\"\"+H]):i.hasOwnProperty(M)&&H!=null&&M===\"onScroll\"&&yr(\"scroll\",S)}switch(y){case\"input\":we(S),sr(S,O,!0);break;case\"textarea\":we(S),me(S);break;case\"select\":case\"option\":break;default:typeof O.onClick==\"function\"&&(S.onclick=ng)}S=j,p.updateQueue=S,S!==null&&(p.flags|=4)}else{M=j.nodeType===9?j:j.ownerDocument,d===\"http://www.w3.org/1999/xhtml\"&&(d=Ve(y)),d===\"http://www.w3.org/1999/xhtml\"?y===\"script\"?(d=M.createElement(\"div\"),d.innerHTML=\"<script><\\/script>\",d=d.removeChild(d.firstChild)):typeof S.is==\"string\"?d=M.createElement(y,{is:S.is}):(d=M.createElement(y),y===\"select\"&&(M=d,S.multiple?M.multiple=!0:S.size&&(M.size=S.size))):d=M.createElementNS(d,y),d[bo]=p,d[Ph]=S,FO(d,p,!1,!1),p.stateNode=d;e:{switch(M=We(y,S),y){case\"dialog\":yr(\"cancel\",d),yr(\"close\",d),j=S;break;case\"iframe\":case\"object\":case\"embed\":yr(\"load\",d),j=S;break;case\"video\":case\"audio\":for(j=0;j<Eh.length;j++)yr(Eh[j],d);j=S;break;case\"source\":yr(\"error\",d),j=S;break;case\"img\":case\"image\":case\"link\":yr(\"error\",d),yr(\"load\",d),j=S;break;case\"details\":yr(\"toggle\",d),j=S;break;case\"input\":qe(d,S),j=le(d,S),yr(\"invalid\",d);break;case\"option\":j=S;break;case\"select\":d._wrapperState={wasMultiple:!!S.multiple},j=ne({},S,{value:void 0}),yr(\"invalid\",d);break;case\"textarea\":ue(d,S),j=Z(d,S),yr(\"invalid\",d);break;default:j=S}ve(y,j),H=j;for(O in H)if(H.hasOwnProperty(O)){var Q=H[O];O===\"style\"?qs(d,Q):O===\"dangerouslySetInnerHTML\"?(Q=Q?Q.__html:void 0,Q!=null&&lr(d,Q)):O===\"children\"?typeof Q==\"string\"?(y!==\"textarea\"||Q!==\"\")&&Ei(d,Q):typeof Q==\"number\"&&Ei(d,\"\"+Q):O!==\"suppressContentEditableWarning\"&&O!==\"suppressHydrationWarning\"&&O!==\"autoFocus\"&&(i.hasOwnProperty(O)?Q!=null&&O===\"onScroll\"&&yr(\"scroll\",d):Q!=null&&_(d,O,Q,M))}switch(y){case\"input\":we(d),sr(d,S,!1);break;case\"textarea\":we(d),me(d);break;case\"option\":S.value!=null&&d.setAttribute(\"value\",\"\"+Ae(S.value));break;case\"select\":d.multiple=!!S.multiple,O=S.value,O!=null?U(d,!!S.multiple,O,!1):S.defaultValue!=null&&U(d,!!S.multiple,S.defaultValue,!0);break;default:typeof j.onClick==\"function\"&&(d.onclick=ng)}switch(y){case\"button\":case\"input\":case\"select\":case\"textarea\":S=!!S.autoFocus;break e;case\"img\":S=!0;break e;default:S=!1}}S&&(p.flags|=4)}p.ref!==null&&(p.flags|=512,p.flags|=2097152)}return Kn(p),null;case 6:if(d&&p.stateNode!=null)BO(d,p,d.memoizedProps,S);else{if(typeof S!=\"string\"&&p.stateNode===null)throw Error(r(166));if(y=xc(Dh.current),xc(wo.current),ug(p)){if(S=p.stateNode,y=p.memoizedProps,S[bo]=p,(O=S.nodeValue!==y)&&(d=Wi,d!==null))switch(d.tag){case 3:rg(S.nodeValue,y,(d.mode&1)!==0);break;case 5:d.memoizedProps.suppressHydrationWarning!==!0&&rg(S.nodeValue,y,(d.mode&1)!==0)}O&&(p.flags|=4)}else S=(y.nodeType===9?y:y.ownerDocument).createTextNode(S),S[bo]=p,p.stateNode=S}return Kn(p),null;case 13:if(xr(Pr),S=p.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(Ar&&qi!==null&&(p.mode&1)!==0&&(p.flags&128)===0)U4(),Gu(),p.flags|=98560,O=!1;else if(O=ug(p),S!==null&&S.dehydrated!==null){if(d===null){if(!O)throw Error(r(318));if(O=p.memoizedState,O=O!==null?O.dehydrated:null,!O)throw Error(r(317));O[bo]=p}else Gu(),(p.flags&128)===0&&(p.memoizedState=null),p.flags|=4;Kn(p),O=!1}else La!==null&&(Sw(La),La=null),O=!0;if(!O)return p.flags&65536?p:null}return(p.flags&128)!==0?(p.lanes=y,p):(S=S!==null,S!==(d!==null&&d.memoizedState!==null)&&S&&(p.child.flags|=8192,(p.mode&1)!==0&&(d===null||(Pr.current&1)!==0?un===0&&(un=3):Aw())),p.updateQueue!==null&&(p.flags|=4),Kn(p),null);case 4:return Zu(),dw(d,p),d===null&&jh(p.stateNode.containerInfo),Kn(p),null;case 10:return Bb(p.type._context),Kn(p),null;case 17:return Ti(p.type)&&ag(),Kn(p),null;case 19:if(xr(Pr),O=p.memoizedState,O===null)return Kn(p),null;if(S=(p.flags&128)!==0,M=O.rendering,M===null)if(S)$h(O,!1);else{if(un!==0||d!==null&&(d.flags&128)!==0)for(d=p.child;d!==null;){if(M=gg(d),M!==null){for(p.flags|=128,$h(O,!1),S=M.updateQueue,S!==null&&(p.updateQueue=S,p.flags|=4),p.subtreeFlags=0,S=y,y=p.child;y!==null;)O=y,d=S,O.flags&=14680066,M=O.alternate,M===null?(O.childLanes=0,O.lanes=d,O.child=null,O.subtreeFlags=0,O.memoizedProps=null,O.memoizedState=null,O.updateQueue=null,O.dependencies=null,O.stateNode=null):(O.childLanes=M.childLanes,O.lanes=M.lanes,O.child=M.child,O.subtreeFlags=0,O.deletions=null,O.memoizedProps=M.memoizedProps,O.memoizedState=M.memoizedState,O.updateQueue=M.updateQueue,O.type=M.type,d=M.dependencies,O.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),y=y.sibling;return hr(Pr,Pr.current&1|2),p.child}d=d.sibling}O.tail!==null&&qr()>td&&(p.flags|=128,S=!0,$h(O,!1),p.lanes=4194304)}else{if(!S)if(d=gg(M),d!==null){if(p.flags|=128,S=!0,y=d.updateQueue,y!==null&&(p.updateQueue=y,p.flags|=4),$h(O,!0),O.tail===null&&O.tailMode===\"hidden\"&&!M.alternate&&!Ar)return Kn(p),null}else 2*qr()-O.renderingStartTime>td&&y!==1073741824&&(p.flags|=128,S=!0,$h(O,!1),p.lanes=4194304);O.isBackwards?(M.sibling=p.child,p.child=M):(y=O.last,y!==null?y.sibling=M:p.child=M,O.last=M)}return O.tail!==null?(p=O.tail,O.rendering=p,O.tail=p.sibling,O.renderingStartTime=qr(),p.sibling=null,y=Pr.current,hr(Pr,S?y&1|2:y&1),p):(Kn(p),null);case 22:case 23:return Cw(),S=p.memoizedState!==null,d!==null&&d.memoizedState!==null!==S&&(p.flags|=8192),S&&(p.mode&1)!==0?(Hi&1073741824)!==0&&(Kn(p),p.subtreeFlags&6&&(p.flags|=8192)):Kn(p),null;case 24:return null;case 25:return null}throw Error(r(156,p.tag))}function mte(d,p){switch(Ib(p),p.tag){case 1:return Ti(p.type)&&ag(),d=p.flags,d&65536?(p.flags=d&-65537|128,p):null;case 3:return Zu(),xr(ji),xr(Hn),Hb(),d=p.flags,(d&65536)!==0&&(d&128)===0?(p.flags=d&-65537|128,p):null;case 5:return Wb(p),null;case 13:if(xr(Pr),d=p.memoizedState,d!==null&&d.dehydrated!==null){if(p.alternate===null)throw Error(r(340));Gu()}return d=p.flags,d&65536?(p.flags=d&-65537|128,p):null;case 19:return xr(Pr),null;case 4:return Zu(),null;case 10:return Bb(p.type._context),null;case 22:case 23:return Cw(),null;case 24:return null;default:return null}}var Ag=!1,Xn=!1,gte=typeof WeakSet==\"function\"?WeakSet:Set,He=null;function Ju(d,p){var y=d.ref;if(y!==null)if(typeof y==\"function\")try{y(null)}catch(S){Fr(d,p,S)}else y.current=null}function fw(d,p,y){try{y()}catch(S){Fr(d,p,S)}}var $O=!1;function vte(d,p){if(Cb=q0,d=y4(),gb(d)){if(\"selectionStart\"in d)var y={start:d.selectionStart,end:d.selectionEnd};else e:{y=(y=d.ownerDocument)&&y.defaultView||window;var S=y.getSelection&&y.getSelection();if(S&&S.rangeCount!==0){y=S.anchorNode;var j=S.anchorOffset,O=S.focusNode;S=S.focusOffset;try{y.nodeType,O.nodeType}catch{y=null;break e}var M=0,H=-1,Q=-1,se=0,be=0,Se=d,xe=null;t:for(;;){for(var Ue;Se!==y||j!==0&&Se.nodeType!==3||(H=M+j),Se!==O||S!==0&&Se.nodeType!==3||(Q=M+S),Se.nodeType===3&&(M+=Se.nodeValue.length),(Ue=Se.firstChild)!==null;)xe=Se,Se=Ue;for(;;){if(Se===d)break t;if(xe===y&&++se===j&&(H=M),xe===O&&++be===S&&(Q=M),(Ue=Se.nextSibling)!==null)break;Se=xe,xe=Se.parentNode}Se=Ue}y=H===-1||Q===-1?null:{start:H,end:Q}}else y=null}y=y||{start:0,end:0}}else y=null;for(Ab={focusedElem:d,selectionRange:y},q0=!1,He=p;He!==null;)if(p=He,d=p.child,(p.subtreeFlags&1028)!==0&&d!==null)d.return=p,He=d;else for(;He!==null;){p=He;try{var Ke=p.alternate;if((p.flags&1024)!==0)switch(p.tag){case 0:case 11:case 15:break;case 1:if(Ke!==null){var Ze=Ke.memoizedProps,Hr=Ke.memoizedState,ie=p.stateNode,ee=ie.getSnapshotBeforeUpdate(p.elementType===p.type?Ze:Ba(p.type,Ze),Hr);ie.__reactInternalSnapshotBeforeUpdate=ee}break;case 3:var oe=p.stateNode.containerInfo;oe.nodeType===1?oe.textContent=\"\":oe.nodeType===9&&oe.documentElement&&oe.removeChild(oe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Ee){Fr(p,p.return,Ee)}if(d=p.sibling,d!==null){d.return=p.return,He=d;break}He=p.return}return Ke=$O,$O=!1,Ke}function Vh(d,p,y){var S=p.updateQueue;if(S=S!==null?S.lastEffect:null,S!==null){var j=S=S.next;do{if((j.tag&d)===d){var O=j.destroy;j.destroy=void 0,O!==void 0&&fw(p,y,O)}j=j.next}while(j!==S)}}function Ng(d,p){if(p=p.updateQueue,p=p!==null?p.lastEffect:null,p!==null){var y=p=p.next;do{if((y.tag&d)===d){var S=y.create;y.destroy=S()}y=y.next}while(y!==p)}}function hw(d){var p=d.ref;if(p!==null){var y=d.stateNode;switch(d.tag){case 5:d=y;break;default:d=y}typeof p==\"function\"?p(d):p.current=d}}function VO(d){var p=d.alternate;p!==null&&(d.alternate=null,VO(p)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(p=d.stateNode,p!==null&&(delete p[bo],delete p[Ph],delete p[Tb],delete p[Jee],delete p[ete])),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}function UO(d){return d.tag===5||d.tag===3||d.tag===4}function zO(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||UO(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function pw(d,p,y){var S=d.tag;if(S===5||S===6)d=d.stateNode,p?y.nodeType===8?y.parentNode.insertBefore(d,p):y.insertBefore(d,p):(y.nodeType===8?(p=y.parentNode,p.insertBefore(d,y)):(p=y,p.appendChild(d)),y=y._reactRootContainer,y!=null||p.onclick!==null||(p.onclick=ng));else if(S!==4&&(d=d.child,d!==null))for(pw(d,p,y),d=d.sibling;d!==null;)pw(d,p,y),d=d.sibling}function mw(d,p,y){var S=d.tag;if(S===5||S===6)d=d.stateNode,p?y.insertBefore(d,p):y.appendChild(d);else if(S!==4&&(d=d.child,d!==null))for(mw(d,p,y),d=d.sibling;d!==null;)mw(d,p,y),d=d.sibling}var Dn=null,$a=!1;function al(d,p,y){for(y=y.child;y!==null;)WO(d,p,y),y=y.sibling}function WO(d,p,y){if(xo&&typeof xo.onCommitFiberUnmount==\"function\")try{xo.onCommitFiberUnmount(B0,y)}catch{}switch(y.tag){case 5:Xn||Ju(y,p);case 6:var S=Dn,j=$a;Dn=null,al(d,p,y),Dn=S,$a=j,Dn!==null&&($a?(d=Dn,y=y.stateNode,d.nodeType===8?d.parentNode.removeChild(y):d.removeChild(y)):Dn.removeChild(y.stateNode));break;case 18:Dn!==null&&($a?(d=Dn,y=y.stateNode,d.nodeType===8?jb(d.parentNode,y):d.nodeType===1&&jb(d,y),xh(d)):jb(Dn,y.stateNode));break;case 4:S=Dn,j=$a,Dn=y.stateNode.containerInfo,$a=!0,al(d,p,y),Dn=S,$a=j;break;case 0:case 11:case 14:case 15:if(!Xn&&(S=y.updateQueue,S!==null&&(S=S.lastEffect,S!==null))){j=S=S.next;do{var O=j,M=O.destroy;O=O.tag,M!==void 0&&((O&2)!==0||(O&4)!==0)&&fw(y,p,M),j=j.next}while(j!==S)}al(d,p,y);break;case 1:if(!Xn&&(Ju(y,p),S=y.stateNode,typeof S.componentWillUnmount==\"function\"))try{S.props=y.memoizedProps,S.state=y.memoizedState,S.componentWillUnmount()}catch(H){Fr(y,p,H)}al(d,p,y);break;case 21:al(d,p,y);break;case 22:y.mode&1?(Xn=(S=Xn)||y.memoizedState!==null,al(d,p,y),Xn=S):al(d,p,y);break;default:al(d,p,y)}}function qO(d){var p=d.updateQueue;if(p!==null){d.updateQueue=null;var y=d.stateNode;y===null&&(y=d.stateNode=new gte),p.forEach(function(S){var j=Nte.bind(null,d,S);y.has(S)||(y.add(S),S.then(j,j))})}}function Va(d,p){var y=p.deletions;if(y!==null)for(var S=0;S<y.length;S++){var j=y[S];try{var O=d,M=p,H=M;e:for(;H!==null;){switch(H.tag){case 5:Dn=H.stateNode,$a=!1;break e;case 3:Dn=H.stateNode.containerInfo,$a=!0;break e;case 4:Dn=H.stateNode.containerInfo,$a=!0;break e}H=H.return}if(Dn===null)throw Error(r(160));WO(O,M,j),Dn=null,$a=!1;var Q=j.alternate;Q!==null&&(Q.return=null),j.return=null}catch(se){Fr(j,p,se)}}if(p.subtreeFlags&12854)for(p=p.child;p!==null;)HO(p,d),p=p.sibling}function HO(d,p){var y=d.alternate,S=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:if(Va(p,d),_o(d),S&4){try{Vh(3,d,d.return),Ng(3,d)}catch(Ze){Fr(d,d.return,Ze)}try{Vh(5,d,d.return)}catch(Ze){Fr(d,d.return,Ze)}}break;case 1:Va(p,d),_o(d),S&512&&y!==null&&Ju(y,y.return);break;case 5:if(Va(p,d),_o(d),S&512&&y!==null&&Ju(y,y.return),d.flags&32){var j=d.stateNode;try{Ei(j,\"\")}catch(Ze){Fr(d,d.return,Ze)}}if(S&4&&(j=d.stateNode,j!=null)){var O=d.memoizedProps,M=y!==null?y.memoizedProps:O,H=d.type,Q=d.updateQueue;if(d.updateQueue=null,Q!==null)try{H===\"input\"&&O.type===\"radio\"&&O.name!=null&&tt(j,O),We(H,M);var se=We(H,O);for(M=0;M<Q.length;M+=2){var be=Q[M],Se=Q[M+1];be===\"style\"?qs(j,Se):be===\"dangerouslySetInnerHTML\"?lr(j,Se):be===\"children\"?Ei(j,Se):_(j,be,Se,se)}switch(H){case\"input\":ke(j,O);break;case\"textarea\":pe(j,O);break;case\"select\":var xe=j._wrapperState.wasMultiple;j._wrapperState.wasMultiple=!!O.multiple;var Ue=O.value;Ue!=null?U(j,!!O.multiple,Ue,!1):xe!==!!O.multiple&&(O.defaultValue!=null?U(j,!!O.multiple,O.defaultValue,!0):U(j,!!O.multiple,O.multiple?[]:\"\",!1))}j[Ph]=O}catch(Ze){Fr(d,d.return,Ze)}}break;case 6:if(Va(p,d),_o(d),S&4){if(d.stateNode===null)throw Error(r(162));j=d.stateNode,O=d.memoizedProps;try{j.nodeValue=O}catch(Ze){Fr(d,d.return,Ze)}}break;case 3:if(Va(p,d),_o(d),S&4&&y!==null&&y.memoizedState.isDehydrated)try{xh(p.containerInfo)}catch(Ze){Fr(d,d.return,Ze)}break;case 4:Va(p,d),_o(d);break;case 13:Va(p,d),_o(d),j=d.child,j.flags&8192&&(O=j.memoizedState!==null,j.stateNode.isHidden=O,!O||j.alternate!==null&&j.alternate.memoizedState!==null||(yw=qr())),S&4&&qO(d);break;case 22:if(be=y!==null&&y.memoizedState!==null,d.mode&1?(Xn=(se=Xn)||be,Va(p,d),Xn=se):Va(p,d),_o(d),S&8192){if(se=d.memoizedState!==null,(d.stateNode.isHidden=se)&&!be&&(d.mode&1)!==0)for(He=d,be=d.child;be!==null;){for(Se=He=be;He!==null;){switch(xe=He,Ue=xe.child,xe.tag){case 0:case 11:case 14:case 15:Vh(4,xe,xe.return);break;case 1:Ju(xe,xe.return);var Ke=xe.stateNode;if(typeof Ke.componentWillUnmount==\"function\"){S=xe,y=xe.return;try{p=S,Ke.props=p.memoizedProps,Ke.state=p.memoizedState,Ke.componentWillUnmount()}catch(Ze){Fr(S,y,Ze)}}break;case 5:Ju(xe,xe.return);break;case 22:if(xe.memoizedState!==null){XO(Se);continue}}Ue!==null?(Ue.return=xe,He=Ue):XO(Se)}be=be.sibling}e:for(be=null,Se=d;;){if(Se.tag===5){if(be===null){be=Se;try{j=Se.stateNode,se?(O=j.style,typeof O.setProperty==\"function\"?O.setProperty(\"display\",\"none\",\"important\"):O.display=\"none\"):(H=Se.stateNode,Q=Se.memoizedProps.style,M=Q!=null&&Q.hasOwnProperty(\"display\")?Q.display:null,H.style.display=yo(\"display\",M))}catch(Ze){Fr(d,d.return,Ze)}}}else if(Se.tag===6){if(be===null)try{Se.stateNode.nodeValue=se?\"\":Se.memoizedProps}catch(Ze){Fr(d,d.return,Ze)}}else if((Se.tag!==22&&Se.tag!==23||Se.memoizedState===null||Se===d)&&Se.child!==null){Se.child.return=Se,Se=Se.child;continue}if(Se===d)break e;for(;Se.sibling===null;){if(Se.return===null||Se.return===d)break e;be===Se&&(be=null),Se=Se.return}be===Se&&(be=null),Se.sibling.return=Se.return,Se=Se.sibling}}break;case 19:Va(p,d),_o(d),S&4&&qO(d);break;case 21:break;default:Va(p,d),_o(d)}}function _o(d){var p=d.flags;if(p&2){try{e:{for(var y=d.return;y!==null;){if(UO(y)){var S=y;break e}y=y.return}throw Error(r(160))}switch(S.tag){case 5:var j=S.stateNode;S.flags&32&&(Ei(j,\"\"),S.flags&=-33);var O=zO(d);mw(d,O,j);break;case 3:case 4:var M=S.stateNode.containerInfo,H=zO(d);pw(d,H,M);break;default:throw Error(r(161))}}catch(Q){Fr(d,d.return,Q)}d.flags&=-3}p&4096&&(d.flags&=-4097)}function yte(d,p,y){He=d,GO(d)}function GO(d,p,y){for(var S=(d.mode&1)!==0;He!==null;){var j=He,O=j.child;if(j.tag===22&&S){var M=j.memoizedState!==null||Ag;if(!M){var H=j.alternate,Q=H!==null&&H.memoizedState!==null||Xn;H=Ag;var se=Xn;if(Ag=M,(Xn=Q)&&!se)for(He=j;He!==null;)M=He,Q=M.child,M.tag===22&&M.memoizedState!==null?YO(j):Q!==null?(Q.return=M,He=Q):YO(j);for(;O!==null;)He=O,GO(O),O=O.sibling;He=j,Ag=H,Xn=se}KO(d)}else(j.subtreeFlags&8772)!==0&&O!==null?(O.return=j,He=O):KO(d)}}function KO(d){for(;He!==null;){var p=He;if((p.flags&8772)!==0){var y=p.alternate;try{if((p.flags&8772)!==0)switch(p.tag){case 0:case 11:case 15:Xn||Ng(5,p);break;case 1:var S=p.stateNode;if(p.flags&4&&!Xn)if(y===null)S.componentDidMount();else{var j=p.elementType===p.type?y.memoizedProps:Ba(p.type,y.memoizedProps);S.componentDidUpdate(j,y.memoizedState,S.__reactInternalSnapshotBeforeUpdate)}var O=p.updateQueue;O!==null&&X4(p,O,S);break;case 3:var M=p.updateQueue;if(M!==null){if(y=null,p.child!==null)switch(p.child.tag){case 5:y=p.child.stateNode;break;case 1:y=p.child.stateNode}X4(p,M,y)}break;case 5:var H=p.stateNode;if(y===null&&p.flags&4){y=H;var Q=p.memoizedProps;switch(p.type){case\"button\":case\"input\":case\"select\":case\"textarea\":Q.autoFocus&&y.focus();break;case\"img\":Q.src&&(y.src=Q.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(p.memoizedState===null){var se=p.alternate;if(se!==null){var be=se.memoizedState;if(be!==null){var Se=be.dehydrated;Se!==null&&xh(Se)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Xn||p.flags&512&&hw(p)}catch(xe){Fr(p,p.return,xe)}}if(p===d){He=null;break}if(y=p.sibling,y!==null){y.return=p.return,He=y;break}He=p.return}}function XO(d){for(;He!==null;){var p=He;if(p===d){He=null;break}var y=p.sibling;if(y!==null){y.return=p.return,He=y;break}He=p.return}}function YO(d){for(;He!==null;){var p=He;try{switch(p.tag){case 0:case 11:case 15:var y=p.return;try{Ng(4,p)}catch(Q){Fr(p,y,Q)}break;case 1:var S=p.stateNode;if(typeof S.componentDidMount==\"function\"){var j=p.return;try{S.componentDidMount()}catch(Q){Fr(p,j,Q)}}var O=p.return;try{hw(p)}catch(Q){Fr(p,O,Q)}break;case 5:var M=p.return;try{hw(p)}catch(Q){Fr(p,M,Q)}}}catch(Q){Fr(p,p.return,Q)}if(p===d){He=null;break}var H=p.sibling;if(H!==null){H.return=p.return,He=H;break}He=p.return}}var xte=Math.ceil,Eg=N.ReactCurrentDispatcher,gw=N.ReactCurrentOwner,ha=N.ReactCurrentBatchConfig,Lt=0,Cn=null,Qr=null,Rn=0,Hi=0,ed=el(0),un=0,Uh=null,wc=0,jg=0,vw=0,zh=null,Oi=null,yw=0,td=1/0,ss=null,Tg=!1,xw=null,ol=null,Pg=!1,sl=null,Og=0,Wh=0,bw=null,kg=-1,Ig=0;function ai(){return(Lt&6)!==0?qr():kg!==-1?kg:kg=qr()}function ll(d){return(d.mode&1)===0?1:(Lt&2)!==0&&Rn!==0?Rn&-Rn:rte.transition!==null?(Ig===0&&(Ig=zP()),Ig):(d=Qt,d!==0||(d=window.event,d=d===void 0?16:QP(d.type)),d)}function Ua(d,p,y,S){if(50<Wh)throw Wh=0,bw=null,Error(r(185));ph(d,y,S),((Lt&2)===0||d!==Cn)&&(d===Cn&&((Lt&2)===0&&(jg|=y),un===4&&cl(d,Rn)),ki(d,S),y===1&&Lt===0&&(p.mode&1)===0&&(td=qr()+500,sg&&rl()))}function ki(d,p){var y=d.callbackNode;ree(d,p);var S=U0(d,d===Cn?Rn:0);if(S===0)y!==null&&$P(y),d.callbackNode=null,d.callbackPriority=0;else if(p=S&-S,d.callbackPriority!==p){if(y!=null&&$P(y),p===1)d.tag===0?tte(QO.bind(null,d)):F4(QO.bind(null,d)),Zee(function(){(Lt&6)===0&&rl()}),y=null;else{switch(WP(S)){case 1:y=J1;break;case 4:y=VP;break;case 16:y=L0;break;case 536870912:y=UP;break;default:y=L0}y=ok(y,ZO.bind(null,d))}d.callbackPriority=p,d.callbackNode=y}}function ZO(d,p){if(kg=-1,Ig=0,(Lt&6)!==0)throw Error(r(327));var y=d.callbackNode;if(rd()&&d.callbackNode!==y)return null;var S=U0(d,d===Cn?Rn:0);if(S===0)return null;if((S&30)!==0||(S&d.expiredLanes)!==0||p)p=Mg(d,S);else{p=S;var j=Lt;Lt|=2;var O=ek();(Cn!==d||Rn!==p)&&(ss=null,td=qr()+500,_c(d,p));do try{Ste();break}catch(H){JO(d,H)}while(!0);Lb(),Eg.current=O,Lt=j,Qr!==null?p=0:(Cn=null,Rn=0,p=un)}if(p!==0){if(p===2&&(j=eb(d),j!==0&&(S=j,p=ww(d,j))),p===1)throw y=Uh,_c(d,0),cl(d,S),ki(d,qr()),y;if(p===6)cl(d,S);else{if(j=d.current.alternate,(S&30)===0&&!bte(j)&&(p=Mg(d,S),p===2&&(O=eb(d),O!==0&&(S=O,p=ww(d,O))),p===1))throw y=Uh,_c(d,0),cl(d,S),ki(d,qr()),y;switch(d.finishedWork=j,d.finishedLanes=S,p){case 0:case 1:throw Error(r(345));case 2:Cc(d,Oi,ss);break;case 3:if(cl(d,S),(S&130023424)===S&&(p=yw+500-qr(),10<p)){if(U0(d,0)!==0)break;if(j=d.suspendedLanes,(j&S)!==S){ai(),d.pingedLanes|=d.suspendedLanes&j;break}d.timeoutHandle=Eb(Cc.bind(null,d,Oi,ss),p);break}Cc(d,Oi,ss);break;case 4:if(cl(d,S),(S&4194240)===S)break;for(p=d.eventTimes,j=-1;0<S;){var M=31-Ra(S);O=1<<M,M=p[M],M>j&&(j=M),S&=~O}if(S=j,S=qr()-S,S=(120>S?120:480>S?480:1080>S?1080:1920>S?1920:3e3>S?3e3:4320>S?4320:1960*xte(S/1960))-S,10<S){d.timeoutHandle=Eb(Cc.bind(null,d,Oi,ss),S);break}Cc(d,Oi,ss);break;case 5:Cc(d,Oi,ss);break;default:throw Error(r(329))}}}return ki(d,qr()),d.callbackNode===y?ZO.bind(null,d):null}function ww(d,p){var y=zh;return d.current.memoizedState.isDehydrated&&(_c(d,p).flags|=256),d=Mg(d,p),d!==2&&(p=Oi,Oi=y,p!==null&&Sw(p)),d}function Sw(d){Oi===null?Oi=d:Oi.push.apply(Oi,d)}function bte(d){for(var p=d;;){if(p.flags&16384){var y=p.updateQueue;if(y!==null&&(y=y.stores,y!==null))for(var S=0;S<y.length;S++){var j=y[S],O=j.getSnapshot;j=j.value;try{if(!Fa(O(),j))return!1}catch{return!1}}}if(y=p.child,p.subtreeFlags&16384&&y!==null)y.return=p,p=y;else{if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return!0;p=p.return}p.sibling.return=p.return,p=p.sibling}}return!0}function cl(d,p){for(p&=~vw,p&=~jg,d.suspendedLanes|=p,d.pingedLanes&=~p,d=d.expirationTimes;0<p;){var y=31-Ra(p),S=1<<y;d[y]=-1,p&=~S}}function QO(d){if((Lt&6)!==0)throw Error(r(327));rd();var p=U0(d,0);if((p&1)===0)return ki(d,qr()),null;var y=Mg(d,p);if(d.tag!==0&&y===2){var S=eb(d);S!==0&&(p=S,y=ww(d,S))}if(y===1)throw y=Uh,_c(d,0),cl(d,p),ki(d,qr()),y;if(y===6)throw Error(r(345));return d.finishedWork=d.current.alternate,d.finishedLanes=p,Cc(d,Oi,ss),ki(d,qr()),null}function _w(d,p){var y=Lt;Lt|=1;try{return d(p)}finally{Lt=y,Lt===0&&(td=qr()+500,sg&&rl())}}function Sc(d){sl!==null&&sl.tag===0&&(Lt&6)===0&&rd();var p=Lt;Lt|=1;var y=ha.transition,S=Qt;try{if(ha.transition=null,Qt=1,d)return d()}finally{Qt=S,ha.transition=y,Lt=p,(Lt&6)===0&&rl()}}function Cw(){Hi=ed.current,xr(ed)}function _c(d,p){d.finishedWork=null,d.finishedLanes=0;var y=d.timeoutHandle;if(y!==-1&&(d.timeoutHandle=-1,Yee(y)),Qr!==null)for(y=Qr.return;y!==null;){var S=y;switch(Ib(S),S.tag){case 1:S=S.type.childContextTypes,S!=null&&ag();break;case 3:Zu(),xr(ji),xr(Hn),Hb();break;case 5:Wb(S);break;case 4:Zu();break;case 13:xr(Pr);break;case 19:xr(Pr);break;case 10:Bb(S.type._context);break;case 22:case 23:Cw()}y=y.return}if(Cn=d,Qr=d=ul(d.current,null),Rn=Hi=p,un=0,Uh=null,vw=jg=wc=0,Oi=zh=null,yc!==null){for(p=0;p<yc.length;p++)if(y=yc[p],S=y.interleaved,S!==null){y.interleaved=null;var j=S.next,O=y.pending;if(O!==null){var M=O.next;O.next=j,S.next=M}y.pending=S}yc=null}return d}function JO(d,p){do{var y=Qr;try{if(Lb(),vg.current=wg,yg){for(var S=Or.memoizedState;S!==null;){var j=S.queue;j!==null&&(j.pending=null),S=S.next}yg=!1}if(bc=0,_n=cn=Or=null,Rh=!1,Fh=0,gw.current=null,y===null||y.return===null){un=1,Uh=p,Qr=null;break}e:{var O=d,M=y.return,H=y,Q=p;if(p=Rn,H.flags|=32768,Q!==null&&typeof Q==\"object\"&&typeof Q.then==\"function\"){var se=Q,be=H,Se=be.tag;if((be.mode&1)===0&&(Se===0||Se===11||Se===15)){var xe=be.alternate;xe?(be.updateQueue=xe.updateQueue,be.memoizedState=xe.memoizedState,be.lanes=xe.lanes):(be.updateQueue=null,be.memoizedState=null)}var Ue=CO(M);if(Ue!==null){Ue.flags&=-257,AO(Ue,M,H,O,p),Ue.mode&1&&_O(O,se,p),p=Ue,Q=se;var Ke=p.updateQueue;if(Ke===null){var Ze=new Set;Ze.add(Q),p.updateQueue=Ze}else Ke.add(Q);break e}else{if((p&1)===0){_O(O,se,p),Aw();break e}Q=Error(r(426))}}else if(Ar&&H.mode&1){var Hr=CO(M);if(Hr!==null){(Hr.flags&65536)===0&&(Hr.flags|=256),AO(Hr,M,H,O,p),Rb(Qu(Q,H));break e}}O=Q=Qu(Q,H),un!==4&&(un=2),zh===null?zh=[O]:zh.push(O),O=M;do{switch(O.tag){case 3:O.flags|=65536,p&=-p,O.lanes|=p;var ie=wO(O,Q,p);K4(O,ie);break e;case 1:H=Q;var ee=O.type,oe=O.stateNode;if((O.flags&128)===0&&(typeof ee.getDerivedStateFromError==\"function\"||oe!==null&&typeof oe.componentDidCatch==\"function\"&&(ol===null||!ol.has(oe)))){O.flags|=65536,p&=-p,O.lanes|=p;var Ee=SO(O,H,p);K4(O,Ee);break e}}O=O.return}while(O!==null)}rk(y)}catch(Je){p=Je,Qr===y&&y!==null&&(Qr=y=y.return);continue}break}while(!0)}function ek(){var d=Eg.current;return Eg.current=wg,d===null?wg:d}function Aw(){(un===0||un===3||un===2)&&(un=4),Cn===null||(wc&268435455)===0&&(jg&268435455)===0||cl(Cn,Rn)}function Mg(d,p){var y=Lt;Lt|=2;var S=ek();(Cn!==d||Rn!==p)&&(ss=null,_c(d,p));do try{wte();break}catch(j){JO(d,j)}while(!0);if(Lb(),Lt=y,Eg.current=S,Qr!==null)throw Error(r(261));return Cn=null,Rn=0,un}function wte(){for(;Qr!==null;)tk(Qr)}function Ste(){for(;Qr!==null&&!GJ();)tk(Qr)}function tk(d){var p=ak(d.alternate,d,Hi);d.memoizedProps=d.pendingProps,p===null?rk(d):Qr=p,gw.current=null}function rk(d){var p=d;do{var y=p.alternate;if(d=p.return,(p.flags&32768)===0){if(y=pte(y,p,Hi),y!==null){Qr=y;return}}else{if(y=mte(y,p),y!==null){y.flags&=32767,Qr=y;return}if(d!==null)d.flags|=32768,d.subtreeFlags=0,d.deletions=null;else{un=6,Qr=null;return}}if(p=p.sibling,p!==null){Qr=p;return}Qr=p=d}while(p!==null);un===0&&(un=5)}function Cc(d,p,y){var S=Qt,j=ha.transition;try{ha.transition=null,Qt=1,_te(d,p,y,S)}finally{ha.transition=j,Qt=S}return null}function _te(d,p,y,S){do rd();while(sl!==null);if((Lt&6)!==0)throw Error(r(327));y=d.finishedWork;var j=d.finishedLanes;if(y===null)return null;if(d.finishedWork=null,d.finishedLanes=0,y===d.current)throw Error(r(177));d.callbackNode=null,d.callbackPriority=0;var O=y.lanes|y.childLanes;if(nee(d,O),d===Cn&&(Qr=Cn=null,Rn=0),(y.subtreeFlags&2064)===0&&(y.flags&2064)===0||Pg||(Pg=!0,ok(L0,function(){return rd(),null})),O=(y.flags&15990)!==0,(y.subtreeFlags&15990)!==0||O){O=ha.transition,ha.transition=null;var M=Qt;Qt=1;var H=Lt;Lt|=4,gw.current=null,vte(d,y),HO(y,d),zee(Ab),q0=!!Cb,Ab=Cb=null,d.current=y,yte(y),KJ(),Lt=H,Qt=M,ha.transition=O}else d.current=y;if(Pg&&(Pg=!1,sl=d,Og=j),O=d.pendingLanes,O===0&&(ol=null),ZJ(y.stateNode),ki(d,qr()),p!==null)for(S=d.onRecoverableError,y=0;y<p.length;y++)j=p[y],S(j.value,{componentStack:j.stack,digest:j.digest});if(Tg)throw Tg=!1,d=xw,xw=null,d;return(Og&1)!==0&&d.tag!==0&&rd(),O=d.pendingLanes,(O&1)!==0?d===bw?Wh++:(Wh=0,bw=d):Wh=0,rl(),null}function rd(){if(sl!==null){var d=WP(Og),p=ha.transition,y=Qt;try{if(ha.transition=null,Qt=16>d?16:d,sl===null)var S=!1;else{if(d=sl,sl=null,Og=0,(Lt&6)!==0)throw Error(r(331));var j=Lt;for(Lt|=4,He=d.current;He!==null;){var O=He,M=O.child;if((He.flags&16)!==0){var H=O.deletions;if(H!==null){for(var Q=0;Q<H.length;Q++){var se=H[Q];for(He=se;He!==null;){var be=He;switch(be.tag){case 0:case 11:case 15:Vh(8,be,O)}var Se=be.child;if(Se!==null)Se.return=be,He=Se;else for(;He!==null;){be=He;var xe=be.sibling,Ue=be.return;if(VO(be),be===se){He=null;break}if(xe!==null){xe.return=Ue,He=xe;break}He=Ue}}}var Ke=O.alternate;if(Ke!==null){var Ze=Ke.child;if(Ze!==null){Ke.child=null;do{var Hr=Ze.sibling;Ze.sibling=null,Ze=Hr}while(Ze!==null)}}He=O}}if((O.subtreeFlags&2064)!==0&&M!==null)M.return=O,He=M;else e:for(;He!==null;){if(O=He,(O.flags&2048)!==0)switch(O.tag){case 0:case 11:case 15:Vh(9,O,O.return)}var ie=O.sibling;if(ie!==null){ie.return=O.return,He=ie;break e}He=O.return}}var ee=d.current;for(He=ee;He!==null;){M=He;var oe=M.child;if((M.subtreeFlags&2064)!==0&&oe!==null)oe.return=M,He=oe;else e:for(M=ee;He!==null;){if(H=He,(H.flags&2048)!==0)try{switch(H.tag){case 0:case 11:case 15:Ng(9,H)}}catch(Je){Fr(H,H.return,Je)}if(H===M){He=null;break e}var Ee=H.sibling;if(Ee!==null){Ee.return=H.return,He=Ee;break e}He=H.return}}if(Lt=j,rl(),xo&&typeof xo.onPostCommitFiberRoot==\"function\")try{xo.onPostCommitFiberRoot(B0,d)}catch{}S=!0}return S}finally{Qt=y,ha.transition=p}}return!1}function nk(d,p,y){p=Qu(y,p),p=wO(d,p,1),d=il(d,p,1),p=ai(),d!==null&&(ph(d,1,p),ki(d,p))}function Fr(d,p,y){if(d.tag===3)nk(d,d,y);else for(;p!==null;){if(p.tag===3){nk(p,d,y);break}else if(p.tag===1){var S=p.stateNode;if(typeof p.type.getDerivedStateFromError==\"function\"||typeof S.componentDidCatch==\"function\"&&(ol===null||!ol.has(S))){d=Qu(y,d),d=SO(p,d,1),p=il(p,d,1),d=ai(),p!==null&&(ph(p,1,d),ki(p,d));break}}p=p.return}}function Cte(d,p,y){var S=d.pingCache;S!==null&&S.delete(p),p=ai(),d.pingedLanes|=d.suspendedLanes&y,Cn===d&&(Rn&y)===y&&(un===4||un===3&&(Rn&130023424)===Rn&&500>qr()-yw?_c(d,0):vw|=y),ki(d,p)}function ik(d,p){p===0&&((d.mode&1)===0?p=1:(p=V0,V0<<=1,(V0&130023424)===0&&(V0=4194304)));var y=ai();d=is(d,p),d!==null&&(ph(d,p,y),ki(d,y))}function Ate(d){var p=d.memoizedState,y=0;p!==null&&(y=p.retryLane),ik(d,y)}function Nte(d,p){var y=0;switch(d.tag){case 13:var S=d.stateNode,j=d.memoizedState;j!==null&&(y=j.retryLane);break;case 19:S=d.stateNode;break;default:throw Error(r(314))}S!==null&&S.delete(p),ik(d,y)}var ak;ak=function(d,p,y){if(d!==null)if(d.memoizedProps!==p.pendingProps||ji.current)Pi=!0;else{if((d.lanes&y)===0&&(p.flags&128)===0)return Pi=!1,hte(d,p,y);Pi=(d.flags&131072)!==0}else Pi=!1,Ar&&(p.flags&1048576)!==0&&L4(p,cg,p.index);switch(p.lanes=0,p.tag){case 2:var S=p.type;Cg(d,p),d=p.pendingProps;var j=Wu(p,Hn.current);Yu(p,y),j=Xb(null,p,S,d,j,y);var O=Yb();return p.flags|=1,typeof j==\"object\"&&j!==null&&typeof j.render==\"function\"&&j.$$typeof===void 0?(p.tag=1,p.memoizedState=null,p.updateQueue=null,Ti(S)?(O=!0,og(p)):O=!1,p.memoizedState=j.state!==null&&j.state!==void 0?j.state:null,Ub(p),j.updater=Sg,p.stateNode=j,j._reactInternals=p,rw(p,S,d,y),p=ow(null,p,S,!0,O,y)):(p.tag=0,Ar&&O&&kb(p),ii(null,p,j,y),p=p.child),p;case 16:S=p.elementType;e:{switch(Cg(d,p),d=p.pendingProps,j=S._init,S=j(S._payload),p.type=S,j=p.tag=jte(S),d=Ba(S,d),j){case 0:p=aw(null,p,S,d,y);break e;case 1:p=OO(null,p,S,d,y);break e;case 11:p=NO(null,p,S,d,y);break e;case 14:p=EO(null,p,S,Ba(S.type,d),y);break e}throw Error(r(306,S,\"\"))}return p;case 0:return S=p.type,j=p.pendingProps,j=p.elementType===S?j:Ba(S,j),aw(d,p,S,j,y);case 1:return S=p.type,j=p.pendingProps,j=p.elementType===S?j:Ba(S,j),OO(d,p,S,j,y);case 3:e:{if(kO(p),d===null)throw Error(r(387));S=p.pendingProps,O=p.memoizedState,j=O.element,G4(d,p),mg(p,S,null,y);var M=p.memoizedState;if(S=M.element,O.isDehydrated)if(O={element:S,isDehydrated:!1,cache:M.cache,pendingSuspenseBoundaries:M.pendingSuspenseBoundaries,transitions:M.transitions},p.updateQueue.baseState=O,p.memoizedState=O,p.flags&256){j=Qu(Error(r(423)),p),p=IO(d,p,S,y,j);break e}else if(S!==j){j=Qu(Error(r(424)),p),p=IO(d,p,S,y,j);break e}else for(qi=Js(p.stateNode.containerInfo.firstChild),Wi=p,Ar=!0,La=null,y=q4(p,null,S,y),p.child=y;y;)y.flags=y.flags&-3|4096,y=y.sibling;else{if(Gu(),S===j){p=os(d,p,y);break e}ii(d,p,S,y)}p=p.child}return p;case 5:return Y4(p),d===null&&Db(p),S=p.type,j=p.pendingProps,O=d!==null?d.memoizedProps:null,M=j.children,Nb(S,j)?M=null:O!==null&&Nb(S,O)&&(p.flags|=32),PO(d,p),ii(d,p,M,y),p.child;case 6:return d===null&&Db(p),null;case 13:return MO(d,p,y);case 4:return zb(p,p.stateNode.containerInfo),S=p.pendingProps,d===null?p.child=Ku(p,null,S,y):ii(d,p,S,y),p.child;case 11:return S=p.type,j=p.pendingProps,j=p.elementType===S?j:Ba(S,j),NO(d,p,S,j,y);case 7:return ii(d,p,p.pendingProps,y),p.child;case 8:return ii(d,p,p.pendingProps.children,y),p.child;case 12:return ii(d,p,p.pendingProps.children,y),p.child;case 10:e:{if(S=p.type._context,j=p.pendingProps,O=p.memoizedProps,M=j.value,hr(fg,S._currentValue),S._currentValue=M,O!==null)if(Fa(O.value,M)){if(O.children===j.children&&!ji.current){p=os(d,p,y);break e}}else for(O=p.child,O!==null&&(O.return=p);O!==null;){var H=O.dependencies;if(H!==null){M=O.child;for(var Q=H.firstContext;Q!==null;){if(Q.context===S){if(O.tag===1){Q=as(-1,y&-y),Q.tag=2;var se=O.updateQueue;if(se!==null){se=se.shared;var be=se.pending;be===null?Q.next=Q:(Q.next=be.next,be.next=Q),se.pending=Q}}O.lanes|=y,Q=O.alternate,Q!==null&&(Q.lanes|=y),$b(O.return,y,p),H.lanes|=y;break}Q=Q.next}}else if(O.tag===10)M=O.type===p.type?null:O.child;else if(O.tag===18){if(M=O.return,M===null)throw Error(r(341));M.lanes|=y,H=M.alternate,H!==null&&(H.lanes|=y),$b(M,y,p),M=O.sibling}else M=O.child;if(M!==null)M.return=O;else for(M=O;M!==null;){if(M===p){M=null;break}if(O=M.sibling,O!==null){O.return=M.return,M=O;break}M=M.return}O=M}ii(d,p,j.children,y),p=p.child}return p;case 9:return j=p.type,S=p.pendingProps.children,Yu(p,y),j=da(j),S=S(j),p.flags|=1,ii(d,p,S,y),p.child;case 14:return S=p.type,j=Ba(S,p.pendingProps),j=Ba(S.type,j),EO(d,p,S,j,y);case 15:return jO(d,p,p.type,p.pendingProps,y);case 17:return S=p.type,j=p.pendingProps,j=p.elementType===S?j:Ba(S,j),Cg(d,p),p.tag=1,Ti(S)?(d=!0,og(p)):d=!1,Yu(p,y),xO(p,S,j),rw(p,S,j,y),ow(null,p,S,!0,d,y);case 19:return RO(d,p,y);case 22:return TO(d,p,y)}throw Error(r(156,p.tag))};function ok(d,p){return BP(d,p)}function Ete(d,p,y,S){this.tag=d,this.key=y,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=p,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=S,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pa(d,p,y,S){return new Ete(d,p,y,S)}function Nw(d){return d=d.prototype,!(!d||!d.isReactComponent)}function jte(d){if(typeof d==\"function\")return Nw(d)?1:0;if(d!=null){if(d=d.$$typeof,d===D)return 11;if(d===V)return 14}return 2}function ul(d,p){var y=d.alternate;return y===null?(y=pa(d.tag,p,d.key,d.mode),y.elementType=d.elementType,y.type=d.type,y.stateNode=d.stateNode,y.alternate=d,d.alternate=y):(y.pendingProps=p,y.type=d.type,y.flags=0,y.subtreeFlags=0,y.deletions=null),y.flags=d.flags&14680064,y.childLanes=d.childLanes,y.lanes=d.lanes,y.child=d.child,y.memoizedProps=d.memoizedProps,y.memoizedState=d.memoizedState,y.updateQueue=d.updateQueue,p=d.dependencies,y.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext},y.sibling=d.sibling,y.index=d.index,y.ref=d.ref,y}function Dg(d,p,y,S,j,O){var M=2;if(S=d,typeof d==\"function\")Nw(d)&&(M=1);else if(typeof d==\"string\")M=5;else e:switch(d){case P:return Ac(y.children,j,O,p);case k:M=8,j|=8;break;case I:return d=pa(12,y,p,j|2),d.elementType=I,d.lanes=O,d;case B:return d=pa(13,y,p,j),d.elementType=B,d.lanes=O,d;case q:return d=pa(19,y,p,j),d.elementType=q,d.lanes=O,d;case G:return Rg(y,j,O,p);default:if(typeof d==\"object\"&&d!==null)switch(d.$$typeof){case R:M=10;break e;case F:M=9;break e;case D:M=11;break e;case V:M=14;break e;case z:M=16,S=null;break e}throw Error(r(130,d==null?d:typeof d,\"\"))}return p=pa(M,y,p,j),p.elementType=d,p.type=S,p.lanes=O,p}function Ac(d,p,y,S){return d=pa(7,d,S,p),d.lanes=y,d}function Rg(d,p,y,S){return d=pa(22,d,S,p),d.elementType=G,d.lanes=y,d.stateNode={isHidden:!1},d}function Ew(d,p,y){return d=pa(6,d,null,p),d.lanes=y,d}function jw(d,p,y){return p=pa(4,d.children!==null?d.children:[],d.key,p),p.lanes=y,p.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},p}function Tte(d,p,y,S,j){this.tag=p,this.containerInfo=d,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=tb(0),this.expirationTimes=tb(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tb(0),this.identifierPrefix=S,this.onRecoverableError=j,this.mutableSourceEagerHydrationData=null}function Tw(d,p,y,S,j,O,M,H,Q){return d=new Tte(d,p,y,H,Q),p===1?(p=1,O===!0&&(p|=8)):p=0,O=pa(3,null,null,p),d.current=O,O.stateNode=d,O.memoizedState={element:S,isDehydrated:y,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ub(O),d}function Pte(d,p,y){var S=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:T,key:S==null?null:\"\"+S,children:d,containerInfo:p,implementation:y}}function sk(d){if(!d)return tl;d=d._reactInternals;e:{if(hc(d)!==d||d.tag!==1)throw Error(r(170));var p=d;do{switch(p.tag){case 3:p=p.stateNode.context;break e;case 1:if(Ti(p.type)){p=p.stateNode.__reactInternalMemoizedMergedChildContext;break e}}p=p.return}while(p!==null);throw Error(r(171))}if(d.tag===1){var y=d.type;if(Ti(y))return D4(d,y,p)}return p}function lk(d,p,y,S,j,O,M,H,Q){return d=Tw(y,S,!0,d,j,O,M,H,Q),d.context=sk(null),y=d.current,S=ai(),j=ll(y),O=as(S,j),O.callback=p??null,il(y,O,j),d.current.lanes=j,ph(d,j,S),ki(d,S),d}function Fg(d,p,y,S){var j=p.current,O=ai(),M=ll(j);return y=sk(y),p.context===null?p.context=y:p.pendingContext=y,p=as(O,M),p.payload={element:d},S=S===void 0?null:S,S!==null&&(p.callback=S),d=il(j,p,M),d!==null&&(Ua(d,j,M,O),pg(d,j,M)),M}function Lg(d){if(d=d.current,!d.child)return null;switch(d.child.tag){case 5:return d.child.stateNode;default:return d.child.stateNode}}function ck(d,p){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var y=d.retryLane;d.retryLane=y!==0&&y<p?y:p}}function Pw(d,p){ck(d,p),(d=d.alternate)&&ck(d,p)}function Ote(){return null}var uk=typeof reportError==\"function\"?reportError:function(d){console.error(d)};function Ow(d){this._internalRoot=d}Bg.prototype.render=Ow.prototype.render=function(d){var p=this._internalRoot;if(p===null)throw Error(r(409));Fg(d,p,null,null)},Bg.prototype.unmount=Ow.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var p=d.containerInfo;Sc(function(){Fg(null,d,null,null)}),p[es]=null}};function Bg(d){this._internalRoot=d}Bg.prototype.unstable_scheduleHydration=function(d){if(d){var p=GP();d={blockedOn:null,target:d,priority:p};for(var y=0;y<Ys.length&&p!==0&&p<Ys[y].priority;y++);Ys.splice(y,0,d),y===0&&YP(d)}};function kw(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function $g(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11&&(d.nodeType!==8||d.nodeValue!==\" react-mount-point-unstable \"))}function dk(){}function kte(d,p,y,S,j){if(j){if(typeof S==\"function\"){var O=S;S=function(){var se=Lg(M);O.call(se)}}var M=lk(p,S,d,0,null,!1,!1,\"\",dk);return d._reactRootContainer=M,d[es]=M.current,jh(d.nodeType===8?d.parentNode:d),Sc(),M}for(;j=d.lastChild;)d.removeChild(j);if(typeof S==\"function\"){var H=S;S=function(){var se=Lg(Q);H.call(se)}}var Q=Tw(d,0,!1,null,null,!1,!1,\"\",dk);return d._reactRootContainer=Q,d[es]=Q.current,jh(d.nodeType===8?d.parentNode:d),Sc(function(){Fg(p,Q,y,S)}),Q}function Vg(d,p,y,S,j){var O=y._reactRootContainer;if(O){var M=O;if(typeof j==\"function\"){var H=j;j=function(){var Q=Lg(M);H.call(Q)}}Fg(p,M,d,j)}else M=kte(y,p,d,j,S);return Lg(M)}qP=function(d){switch(d.tag){case 3:var p=d.stateNode;if(p.current.memoizedState.isDehydrated){var y=hh(p.pendingLanes);y!==0&&(rb(p,y|1),ki(p,qr()),(Lt&6)===0&&(td=qr()+500,rl()))}break;case 13:Sc(function(){var S=is(d,1);if(S!==null){var j=ai();Ua(S,d,1,j)}}),Pw(d,1)}},nb=function(d){if(d.tag===13){var p=is(d,134217728);if(p!==null){var y=ai();Ua(p,d,134217728,y)}Pw(d,134217728)}},HP=function(d){if(d.tag===13){var p=ll(d),y=is(d,p);if(y!==null){var S=ai();Ua(y,d,p,S)}Pw(d,p)}},GP=function(){return Qt},KP=function(d,p){var y=Qt;try{return Qt=d,p()}finally{Qt=y}},Da=function(d,p,y){switch(p){case\"input\":if(ke(d,y),p=y.name,y.type===\"radio\"&&p!=null){for(y=d;y.parentNode;)y=y.parentNode;for(y=y.querySelectorAll(\"input[name=\"+JSON.stringify(\"\"+p)+'][type=\"radio\"]'),p=0;p<y.length;p++){var S=y[p];if(S!==d&&S.form===d.form){var j=ig(S);if(!j)throw Error(r(90));ce(S),ke(S,j)}}}break;case\"textarea\":pe(d,y);break;case\"select\":p=y.value,p!=null&&U(d,!!y.multiple,p,!1)}},kP=_w,IP=Sc;var Ite={usingClientEntryPoint:!1,Events:[Oh,Uu,ig,Hs,OP,_w]},qh={findFiberByHostInstance:pc,bundleType:0,version:\"18.3.1\",rendererPackageName:\"react-dom\"},Mte={bundleType:qh.bundleType,version:qh.version,rendererPackageName:qh.rendererPackageName,rendererConfig:qh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:N.ReactCurrentDispatcher,findHostInstanceByFiber:function(d){return d=FP(d),d===null?null:d.stateNode},findFiberByHostInstance:qh.findFiberByHostInstance||Ote,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:\"18.3.1-next-f1338f8080-20240426\"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<\"u\"){var Ug=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ug.isDisabled&&Ug.supportsFiber)try{B0=Ug.inject(Mte),xo=Ug}catch{}}return Ii.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ite,Ii.createPortal=function(d,p){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!kw(p))throw Error(r(200));return Pte(d,p,null,y)},Ii.createRoot=function(d,p){if(!kw(d))throw Error(r(299));var y=!1,S=\"\",j=uk;return p!=null&&(p.unstable_strictMode===!0&&(y=!0),p.identifierPrefix!==void 0&&(S=p.identifierPrefix),p.onRecoverableError!==void 0&&(j=p.onRecoverableError)),p=Tw(d,1,!1,null,null,y,!1,S,j),d[es]=p.current,jh(d.nodeType===8?d.parentNode:d),new Ow(p)},Ii.findDOMNode=function(d){if(d==null)return null;if(d.nodeType===1)return d;var p=d._reactInternals;if(p===void 0)throw typeof d.render==\"function\"?Error(r(188)):(d=Object.keys(d).join(\",\"),Error(r(268,d)));return d=FP(p),d=d===null?null:d.stateNode,d},Ii.flushSync=function(d){return Sc(d)},Ii.hydrate=function(d,p,y){if(!$g(p))throw Error(r(200));return Vg(null,d,p,!0,y)},Ii.hydrateRoot=function(d,p,y){if(!kw(d))throw Error(r(405));var S=y!=null&&y.hydratedSources||null,j=!1,O=\"\",M=uk;if(y!=null&&(y.unstable_strictMode===!0&&(j=!0),y.identifierPrefix!==void 0&&(O=y.identifierPrefix),y.onRecoverableError!==void 0&&(M=y.onRecoverableError)),p=lk(p,null,d,1,y??null,j,!1,O,M),d[es]=p.current,jh(d),S)for(d=0;d<S.length;d++)y=S[d],j=y._getVersion,j=j(y._source),p.mutableSourceEagerHydrationData==null?p.mutableSourceEagerHydrationData=[y,j]:p.mutableSourceEagerHydrationData.push(y,j);return new Bg(p)},Ii.render=function(d,p,y){if(!$g(p))throw Error(r(200));return Vg(null,d,p,!1,y)},Ii.unmountComponentAtNode=function(d){if(!$g(d))throw Error(r(40));return d._reactRootContainer?(Sc(function(){Vg(null,null,d,!1,function(){d._reactRootContainer=null,d[es]=null})}),!0):!1},Ii.unstable_batchedUpdates=_w,Ii.unstable_renderSubtreeIntoContainer=function(d,p,y,S){if(!$g(y))throw Error(r(200));if(d==null||d._reactInternals===void 0)throw Error(r(38));return Vg(d,p,y,!1,S)},Ii.version=\"18.3.1-next-f1338f8080-20240426\",Ii}var bk;function TV(){if(bk)return Rw.exports;bk=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>\"u\"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!=\"function\"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Rw.exports=Wte(),Rw.exports}var wk;function qte(){if(wk)return qg;wk=1;var t=TV();return qg.createRoot=t.createRoot,qg.hydrateRoot=t.hydrateRoot,qg}var Hte=qte(),Uf=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Gte={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},Cl,bj,kF,Kte=(kF=class{constructor(){rt(this,Cl,Gte);rt(this,bj,!1)}setTimeoutProvider(t){Le(this,Cl,t)}setTimeout(t,e){return Y(this,Cl).setTimeout(t,e)}clearTimeout(t){Y(this,Cl).clearTimeout(t)}setInterval(t,e){return Y(this,Cl).setInterval(t,e)}clearInterval(t){Y(this,Cl).clearInterval(t)}},Cl=new WeakMap,bj=new WeakMap,kF),Bc=new Kte;function Xte(t){setTimeout(t,0)}var su=typeof window>\"u\"||\"Deno\"in globalThis;function gi(){}function Yte(t,e){return typeof t==\"function\"?t(e):t}function IA(t){return typeof t==\"number\"&&t>=0&&t!==1/0}function PV(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Rl(t,e){return typeof t==\"function\"?t(e):t}function _a(t,e){return typeof t==\"function\"?t(e):t}function Sk(t,e){const{type:r=\"all\",exact:n,fetchStatus:i,predicate:a,queryKey:o,stale:s}=t;if(o){if(n){if(e.queryHash!==wj(o,e.options))return!1}else if(!zp(e.queryKey,o))return!1}if(r!==\"all\"){const c=e.isActive();if(r===\"active\"&&!c||r===\"inactive\"&&c)return!1}return!(typeof s==\"boolean\"&&e.isStale()!==s||i&&i!==e.state.fetchStatus||a&&!a(e))}function _k(t,e){const{exact:r,status:n,predicate:i,mutationKey:a}=t;if(a){if(!e.options.mutationKey)return!1;if(r){if(lu(e.options.mutationKey)!==lu(a))return!1}else if(!zp(e.options.mutationKey,a))return!1}return!(n&&e.state.status!==n||i&&!i(e))}function wj(t,e){return((e==null?void 0:e.queryKeyHashFn)||lu)(t)}function lu(t){return JSON.stringify(t,(e,r)=>MA(r)?Object.keys(r).sort().reduce((n,i)=>(n[i]=r[i],n),{}):r)}function zp(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t==\"object\"&&typeof e==\"object\"?Object.keys(e).every(r=>zp(t[r],e[r])):!1}var Zte=Object.prototype.hasOwnProperty;function OV(t,e){if(t===e)return t;const r=Ck(t)&&Ck(e);if(!r&&!(MA(t)&&MA(e)))return e;const i=(r?t:Object.keys(t)).length,a=r?e:Object.keys(e),o=a.length,s=r?new Array(o):{};let c=0;for(let u=0;u<o;u++){const f=r?u:a[u],h=t[f],m=e[f];if(h===m){s[f]=h,(r?u<i:Zte.call(t,f))&&c++;continue}if(h===null||m===null||typeof h!=\"object\"||typeof m!=\"object\"){s[f]=m;continue}const g=OV(h,m);s[f]=g,g===h&&c++}return i===o&&c===i?t:s}function $v(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}function Ck(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function MA(t){if(!Ak(t))return!1;const e=t.constructor;if(e===void 0)return!0;const r=e.prototype;return!(!Ak(r)||!r.hasOwnProperty(\"isPrototypeOf\")||Object.getPrototypeOf(t)!==Object.prototype)}function Ak(t){return Object.prototype.toString.call(t)===\"[object Object]\"}function Qte(t){return new Promise(e=>{Bc.setTimeout(e,t)})}function DA(t,e,r){return typeof r.structuralSharing==\"function\"?r.structuralSharing(t,e):r.structuralSharing!==!1?OV(t,e):e}function Jte(t,e,r=0){const n=[...t,e];return r&&n.length>r?n.slice(1):n}function ere(t,e,r=0){const n=[e,...t];return r&&n.length>r?n.slice(0,-1):n}var Sj=Symbol();function kV(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===Sj?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function IV(t,e){return typeof t==\"function\"?t(...e):!!t}var Kc,Al,Hd,IF,tre=(IF=class extends Uf{constructor(){super();rt(this,Kc);rt(this,Al);rt(this,Hd);Le(this,Hd,e=>{if(!su&&window.addEventListener){const r=()=>e();return window.addEventListener(\"visibilitychange\",r,!1),()=>{window.removeEventListener(\"visibilitychange\",r)}}})}onSubscribe(){Y(this,Al)||this.setEventListener(Y(this,Hd))}onUnsubscribe(){var e;this.hasListeners()||((e=Y(this,Al))==null||e.call(this),Le(this,Al,void 0))}setEventListener(e){var r;Le(this,Hd,e),(r=Y(this,Al))==null||r.call(this),Le(this,Al,e(n=>{typeof n==\"boolean\"?this.setFocused(n):this.onFocus()}))}setFocused(e){Y(this,Kc)!==e&&(Le(this,Kc,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(r=>{r(e)})}isFocused(){var e;return typeof Y(this,Kc)==\"boolean\"?Y(this,Kc):((e=globalThis.document)==null?void 0:e.visibilityState)!==\"hidden\"}},Kc=new WeakMap,Al=new WeakMap,Hd=new WeakMap,IF),_j=new tre;function RA(){let t,e;const r=new Promise((i,a)=>{t=i,e=a});r.status=\"pending\",r.catch(()=>{});function n(i){Object.assign(r,i),delete r.resolve,delete r.reject}return r.resolve=i=>{n({status:\"fulfilled\",value:i}),t(i)},r.reject=i=>{n({status:\"rejected\",reason:i}),e(i)},r}var rre=Xte;function nre(){let t=[],e=0,r=s=>{s()},n=s=>{s()},i=rre;const a=s=>{e?t.push(s):i(()=>{r(s)})},o=()=>{const s=t;t=[],s.length&&i(()=>{n(()=>{s.forEach(c=>{r(c)})})})};return{batch:s=>{let c;e++;try{c=s()}finally{e--,e||o()}return c},batchCalls:s=>(...c)=>{a(()=>{s(...c)})},schedule:a,setNotifyFunction:s=>{r=s},setBatchNotifyFunction:s=>{n=s},setScheduler:s=>{i=s}}}var vn=nre(),Gd,Nl,Kd,MF,ire=(MF=class extends Uf{constructor(){super();rt(this,Gd,!0);rt(this,Nl);rt(this,Kd);Le(this,Kd,e=>{if(!su&&window.addEventListener){const r=()=>e(!0),n=()=>e(!1);return window.addEventListener(\"online\",r,!1),window.addEventListener(\"offline\",n,!1),()=>{window.removeEventListener(\"online\",r),window.removeEventListener(\"offline\",n)}}})}onSubscribe(){Y(this,Nl)||this.setEventListener(Y(this,Kd))}onUnsubscribe(){var e;this.hasListeners()||((e=Y(this,Nl))==null||e.call(this),Le(this,Nl,void 0))}setEventListener(e){var r;Le(this,Kd,e),(r=Y(this,Nl))==null||r.call(this),Le(this,Nl,e(this.setOnline.bind(this)))}setOnline(e){Y(this,Gd)!==e&&(Le(this,Gd,e),this.listeners.forEach(n=>{n(e)}))}isOnline(){return Y(this,Gd)}},Gd=new WeakMap,Nl=new WeakMap,Kd=new WeakMap,MF),Vv=new ire;function are(t){return Math.min(1e3*2**t,3e4)}function MV(t){return(t??\"online\")===\"online\"?Vv.isOnline():!0}var FA=class extends Error{constructor(t){super(\"CancelledError\"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function DV(t){let e=!1,r=0,n;const i=RA(),a=()=>i.status!==\"pending\",o=v=>{var b;if(!a()){const w=new FA(v);m(w),(b=t.onCancel)==null||b.call(t,w)}},s=()=>{e=!0},c=()=>{e=!1},u=()=>_j.isFocused()&&(t.networkMode===\"always\"||Vv.isOnline())&&t.canRun(),f=()=>MV(t.networkMode)&&t.canRun(),h=v=>{a()||(n==null||n(),i.resolve(v))},m=v=>{a()||(n==null||n(),i.reject(v))},g=()=>new Promise(v=>{var b;n=w=>{(a()||u())&&v(w)},(b=t.onPause)==null||b.call(t)}).then(()=>{var v;n=void 0,a()||(v=t.onContinue)==null||v.call(t)}),x=()=>{if(a())return;let v;const b=r===0?t.initialPromise:void 0;try{v=b??t.fn()}catch(w){v=Promise.reject(w)}Promise.resolve(v).then(h).catch(w=>{var T;if(a())return;const C=t.retry??(su?0:3),_=t.retryDelay??are,N=typeof _==\"function\"?_(r,w):_,A=C===!0||typeof C==\"number\"&&r<C||typeof C==\"function\"&&C(r,w);if(e||!A){m(w);return}r++,(T=t.onFail)==null||T.call(t,r,w),Qte(N).then(()=>u()?void 0:g()).then(()=>{e?m(w):x()})})};return{promise:i,status:()=>i.status,cancel:o,continue:()=>(n==null||n(),i),cancelRetry:s,continueRetry:c,canStart:f,start:()=>(f()?x():g().then(x),i)}}var Xc,DF,RV=(DF=class{constructor(){rt(this,Xc)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),IA(this.gcTime)&&Le(this,Xc,Bc.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(su?1/0:300*1e3))}clearGcTimeout(){Y(this,Xc)&&(Bc.clearTimeout(Y(this,Xc)),Le(this,Xc,void 0))}},Xc=new WeakMap,DF),Yc,Xd,wa,Zc,jn,e0,Qc,Ga,ds,RF,ore=(RF=class extends RV{constructor(e){super();rt(this,Ga);rt(this,Yc);rt(this,Xd);rt(this,wa);rt(this,Zc);rt(this,jn);rt(this,e0);rt(this,Qc);Le(this,Qc,!1),Le(this,e0,e.defaultOptions),this.setOptions(e.options),this.observers=[],Le(this,Zc,e.client),Le(this,wa,Y(this,Zc).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,Le(this,Yc,Nk(this.options)),this.state=e.state??Y(this,Yc),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=Y(this,jn))==null?void 0:e.promise}setOptions(e){if(this.options={...Y(this,e0),...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=Nk(this.options);r.data!==void 0&&(this.setData(r.data,{updatedAt:r.dataUpdatedAt,manual:!0}),Le(this,Yc,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus===\"idle\"&&Y(this,wa).remove(this)}setData(e,r){const n=DA(this.state.data,e,this.options);return St(this,Ga,ds).call(this,{data:n,type:\"success\",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(e,r){St(this,Ga,ds).call(this,{type:\"setState\",state:e,setStateOptions:r})}cancel(e){var n,i;const r=(n=Y(this,jn))==null?void 0:n.promise;return(i=Y(this,jn))==null||i.cancel(e),r?r.then(gi).catch(gi):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Y(this,Yc))}isActive(){return this.observers.some(e=>_a(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Sj||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>Rl(e.options.staleTime,this)===\"static\"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e===\"static\"?!1:this.state.isInvalidated?!0:!PV(this.state.dataUpdatedAt,e)}onFocus(){var r;const e=this.observers.find(n=>n.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(r=Y(this,jn))==null||r.continue()}onOnline(){var r;const e=this.observers.find(n=>n.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(r=Y(this,jn))==null||r.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),Y(this,wa).notify({type:\"observerAdded\",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(r=>r!==e),this.observers.length||(Y(this,jn)&&(Y(this,Qc)?Y(this,jn).cancel({revert:!0}):Y(this,jn).cancelRetry()),this.scheduleGc()),Y(this,wa).notify({type:\"observerRemoved\",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||St(this,Ga,ds).call(this,{type:\"invalidate\"})}async fetch(e,r){var c,u,f,h,m,g,x,v,b,w,C,_;if(this.state.fetchStatus!==\"idle\"&&((c=Y(this,jn))==null?void 0:c.status())!==\"rejected\"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(Y(this,jn))return Y(this,jn).continueRetry(),Y(this,jn).promise}if(e&&this.setOptions(e),!this.options.queryFn){const N=this.observers.find(A=>A.options.queryFn);N&&this.setOptions(N.options)}const n=new AbortController,i=N=>{Object.defineProperty(N,\"signal\",{enumerable:!0,get:()=>(Le(this,Qc,!0),n.signal)})},a=()=>{const N=kV(this.options,r),T=(()=>{const P={client:Y(this,Zc),queryKey:this.queryKey,meta:this.meta};return i(P),P})();return Le(this,Qc,!1),this.options.persister?this.options.persister(N,T,this):N(T)},s=(()=>{const N={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:Y(this,Zc),state:this.state,fetchFn:a};return i(N),N})();(u=this.options.behavior)==null||u.onFetch(s,this),Le(this,Xd,this.state),(this.state.fetchStatus===\"idle\"||this.state.fetchMeta!==((f=s.fetchOptions)==null?void 0:f.meta))&&St(this,Ga,ds).call(this,{type:\"fetch\",meta:(h=s.fetchOptions)==null?void 0:h.meta}),Le(this,jn,DV({initialPromise:r==null?void 0:r.initialPromise,fn:s.fetchFn,onCancel:N=>{N instanceof FA&&N.revert&&this.setState({...Y(this,Xd),fetchStatus:\"idle\"}),n.abort()},onFail:(N,A)=>{St(this,Ga,ds).call(this,{type:\"failed\",failureCount:N,error:A})},onPause:()=>{St(this,Ga,ds).call(this,{type:\"pause\"})},onContinue:()=>{St(this,Ga,ds).call(this,{type:\"continue\"})},retry:s.options.retry,retryDelay:s.options.retryDelay,networkMode:s.options.networkMode,canRun:()=>!0}));try{const N=await Y(this,jn).start();if(N===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(N),(g=(m=Y(this,wa).config).onSuccess)==null||g.call(m,N,this),(v=(x=Y(this,wa).config).onSettled)==null||v.call(x,N,this.state.error,this),N}catch(N){if(N instanceof FA){if(N.silent)return Y(this,jn).promise;if(N.revert){if(this.state.data===void 0)throw N;return this.state.data}}throw St(this,Ga,ds).call(this,{type:\"error\",error:N}),(w=(b=Y(this,wa).config).onError)==null||w.call(b,N,this),(_=(C=Y(this,wa).config).onSettled)==null||_.call(C,this.state.data,N,this),N}finally{this.scheduleGc()}}},Yc=new WeakMap,Xd=new WeakMap,wa=new WeakMap,Zc=new WeakMap,jn=new WeakMap,e0=new WeakMap,Qc=new WeakMap,Ga=new WeakSet,ds=function(e){const r=n=>{switch(e.type){case\"failed\":return{...n,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case\"pause\":return{...n,fetchStatus:\"paused\"};case\"continue\":return{...n,fetchStatus:\"fetching\"};case\"fetch\":return{...n,...FV(n.data,this.options),fetchMeta:e.meta??null};case\"success\":const i={...n,data:e.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:\"success\",...!e.manual&&{fetchStatus:\"idle\",fetchFailureCount:0,fetchFailureReason:null}};return Le(this,Xd,e.manual?i:void 0),i;case\"error\":const a=e.error;return{...n,error:a,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:\"idle\",status:\"error\"};case\"invalidate\":return{...n,isInvalidated:!0};case\"setState\":return{...n,...e.state}}};this.state=r(this.state),vn.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),Y(this,wa).notify({query:this,type:\"updated\",action:e})})},RF);function FV(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:MV(e.networkMode)?\"fetching\":\"paused\",...t===void 0&&{error:null,status:\"pending\"}}}function Nk(t){const e=typeof t.initialData==\"function\"?t.initialData():t.initialData,r=e!==void 0,n=r?typeof t.initialDataUpdatedAt==\"function\"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?\"success\":\"pending\",fetchStatus:\"idle\"}}var Mi,Ot,t0,ui,Jc,Yd,ps,El,r0,Zd,Qd,eu,tu,jl,Jd,Zt,pp,LA,BA,$A,VA,UA,zA,WA,LV,FF,sre=(FF=class extends Uf{constructor(e,r){super();rt(this,Zt);rt(this,Mi);rt(this,Ot);rt(this,t0);rt(this,ui);rt(this,Jc);rt(this,Yd);rt(this,ps);rt(this,El);rt(this,r0);rt(this,Zd);rt(this,Qd);rt(this,eu);rt(this,tu);rt(this,jl);rt(this,Jd,new Set);this.options=r,Le(this,Mi,e),Le(this,El,null),Le(this,ps,RA()),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(Y(this,Ot).addObserver(this),Ek(Y(this,Ot),this.options)?St(this,Zt,pp).call(this):this.updateResult(),St(this,Zt,VA).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return qA(Y(this,Ot),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return qA(Y(this,Ot),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,St(this,Zt,UA).call(this),St(this,Zt,zA).call(this),Y(this,Ot).removeObserver(this)}setOptions(e){const r=this.options,n=Y(this,Ot);if(this.options=Y(this,Mi).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!=\"boolean\"&&typeof this.options.enabled!=\"function\"&&typeof _a(this.options.enabled,Y(this,Ot))!=\"boolean\")throw new Error(\"Expected enabled to be a boolean or a callback that returns a boolean\");St(this,Zt,WA).call(this),Y(this,Ot).setOptions(this.options),r._defaulted&&!$v(this.options,r)&&Y(this,Mi).getQueryCache().notify({type:\"observerOptionsUpdated\",query:Y(this,Ot),observer:this});const i=this.hasListeners();i&&jk(Y(this,Ot),n,this.options,r)&&St(this,Zt,pp).call(this),this.updateResult(),i&&(Y(this,Ot)!==n||_a(this.options.enabled,Y(this,Ot))!==_a(r.enabled,Y(this,Ot))||Rl(this.options.staleTime,Y(this,Ot))!==Rl(r.staleTime,Y(this,Ot)))&&St(this,Zt,LA).call(this);const a=St(this,Zt,BA).call(this);i&&(Y(this,Ot)!==n||_a(this.options.enabled,Y(this,Ot))!==_a(r.enabled,Y(this,Ot))||a!==Y(this,jl))&&St(this,Zt,$A).call(this,a)}getOptimisticResult(e){const r=Y(this,Mi).getQueryCache().build(Y(this,Mi),e),n=this.createResult(r,e);return cre(this,n)&&(Le(this,ui,n),Le(this,Yd,this.options),Le(this,Jc,Y(this,Ot).state)),n}getCurrentResult(){return Y(this,ui)}trackResult(e,r){return new Proxy(e,{get:(n,i)=>(this.trackProp(i),r==null||r(i),i===\"promise\"&&!this.options.experimental_prefetchInRender&&Y(this,ps).status===\"pending\"&&Y(this,ps).reject(new Error(\"experimental_prefetchInRender feature flag is not enabled\")),Reflect.get(n,i))})}trackProp(e){Y(this,Jd).add(e)}getCurrentQuery(){return Y(this,Ot)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const r=Y(this,Mi).defaultQueryOptions(e),n=Y(this,Mi).getQueryCache().build(Y(this,Mi),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(e){return St(this,Zt,pp).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),Y(this,ui)))}createResult(e,r){var I;const n=Y(this,Ot),i=this.options,a=Y(this,ui),o=Y(this,Jc),s=Y(this,Yd),u=e!==n?e.state:Y(this,t0),{state:f}=e;let h={...f},m=!1,g;if(r._optimisticResults){const R=this.hasListeners(),F=!R&&Ek(e,r),D=R&&jk(e,n,r,i);(F||D)&&(h={...h,...FV(f.data,e.options)}),r._optimisticResults===\"isRestoring\"&&(h.fetchStatus=\"idle\")}let{error:x,errorUpdatedAt:v,status:b}=h;g=h.data;let w=!1;if(r.placeholderData!==void 0&&g===void 0&&b===\"pending\"){let R;a!=null&&a.isPlaceholderData&&r.placeholderData===(s==null?void 0:s.placeholderData)?(R=a.data,w=!0):R=typeof r.placeholderData==\"function\"?r.placeholderData((I=Y(this,Qd))==null?void 0:I.state.data,Y(this,Qd)):r.placeholderData,R!==void 0&&(b=\"success\",g=DA(a==null?void 0:a.data,R,r),m=!0)}if(r.select&&g!==void 0&&!w)if(a&&g===(o==null?void 0:o.data)&&r.select===Y(this,r0))g=Y(this,Zd);else try{Le(this,r0,r.select),g=r.select(g),g=DA(a==null?void 0:a.data,g,r),Le(this,Zd,g),Le(this,El,null)}catch(R){Le(this,El,R)}Y(this,El)&&(x=Y(this,El),g=Y(this,Zd),v=Date.now(),b=\"error\");const C=h.fetchStatus===\"fetching\",_=b===\"pending\",N=b===\"error\",A=_&&C,T=g!==void 0,k={status:b,fetchStatus:h.fetchStatus,isPending:_,isSuccess:b===\"success\",isError:N,isInitialLoading:A,isLoading:A,data:g,dataUpdatedAt:h.dataUpdatedAt,error:x,errorUpdatedAt:v,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>u.dataUpdateCount||h.errorUpdateCount>u.errorUpdateCount,isFetching:C,isRefetching:C&&!_,isLoadingError:N&&!T,isPaused:h.fetchStatus===\"paused\",isPlaceholderData:m,isRefetchError:N&&T,isStale:Cj(e,r),refetch:this.refetch,promise:Y(this,ps),isEnabled:_a(r.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const R=B=>{k.status===\"error\"?B.reject(k.error):k.data!==void 0&&B.resolve(k.data)},F=()=>{const B=Le(this,ps,k.promise=RA());R(B)},D=Y(this,ps);switch(D.status){case\"pending\":e.queryHash===n.queryHash&&R(D);break;case\"fulfilled\":(k.status===\"error\"||k.data!==D.value)&&F();break;case\"rejected\":(k.status!==\"error\"||k.error!==D.reason)&&F();break}}return k}updateResult(){const e=Y(this,ui),r=this.createResult(Y(this,Ot),this.options);if(Le(this,Jc,Y(this,Ot).state),Le(this,Yd,this.options),Y(this,Jc).data!==void 0&&Le(this,Qd,Y(this,Ot)),$v(r,e))return;Le(this,ui,r);const n=()=>{if(!e)return!0;const{notifyOnChangeProps:i}=this.options,a=typeof i==\"function\"?i():i;if(a===\"all\"||!a&&!Y(this,Jd).size)return!0;const o=new Set(a??Y(this,Jd));return this.options.throwOnError&&o.add(\"error\"),Object.keys(Y(this,ui)).some(s=>{const c=s;return Y(this,ui)[c]!==e[c]&&o.has(c)})};St(this,Zt,LV).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&St(this,Zt,VA).call(this)}},Mi=new WeakMap,Ot=new WeakMap,t0=new WeakMap,ui=new WeakMap,Jc=new WeakMap,Yd=new WeakMap,ps=new WeakMap,El=new WeakMap,r0=new WeakMap,Zd=new WeakMap,Qd=new WeakMap,eu=new WeakMap,tu=new WeakMap,jl=new WeakMap,Jd=new WeakMap,Zt=new WeakSet,pp=function(e){St(this,Zt,WA).call(this);let r=Y(this,Ot).fetch(this.options,e);return e!=null&&e.throwOnError||(r=r.catch(gi)),r},LA=function(){St(this,Zt,UA).call(this);const e=Rl(this.options.staleTime,Y(this,Ot));if(su||Y(this,ui).isStale||!IA(e))return;const n=PV(Y(this,ui).dataUpdatedAt,e)+1;Le(this,eu,Bc.setTimeout(()=>{Y(this,ui).isStale||this.updateResult()},n))},BA=function(){return(typeof this.options.refetchInterval==\"function\"?this.options.refetchInterval(Y(this,Ot)):this.options.refetchInterval)??!1},$A=function(e){St(this,Zt,zA).call(this),Le(this,jl,e),!(su||_a(this.options.enabled,Y(this,Ot))===!1||!IA(Y(this,jl))||Y(this,jl)===0)&&Le(this,tu,Bc.setInterval(()=>{(this.options.refetchIntervalInBackground||_j.isFocused())&&St(this,Zt,pp).call(this)},Y(this,jl)))},VA=function(){St(this,Zt,LA).call(this),St(this,Zt,$A).call(this,St(this,Zt,BA).call(this))},UA=function(){Y(this,eu)&&(Bc.clearTimeout(Y(this,eu)),Le(this,eu,void 0))},zA=function(){Y(this,tu)&&(Bc.clearInterval(Y(this,tu)),Le(this,tu,void 0))},WA=function(){const e=Y(this,Mi).getQueryCache().build(Y(this,Mi),this.options);if(e===Y(this,Ot))return;const r=Y(this,Ot);Le(this,Ot,e),Le(this,t0,e.state),this.hasListeners()&&(r==null||r.removeObserver(this),e.addObserver(this))},LV=function(e){vn.batch(()=>{e.listeners&&this.listeners.forEach(r=>{r(Y(this,ui))}),Y(this,Mi).getQueryCache().notify({query:Y(this,Ot),type:\"observerResultsUpdated\"})})},FF);function lre(t,e){return _a(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status===\"error\"&&e.retryOnMount===!1)}function Ek(t,e){return lre(t,e)||t.state.data!==void 0&&qA(t,e,e.refetchOnMount)}function qA(t,e,r){if(_a(e.enabled,t)!==!1&&Rl(e.staleTime,t)!==\"static\"){const n=typeof r==\"function\"?r(t):r;return n===\"always\"||n!==!1&&Cj(t,e)}return!1}function jk(t,e,r,n){return(t!==e||_a(n.enabled,t)===!1)&&(!r.suspense||t.state.status!==\"error\")&&Cj(t,r)}function Cj(t,e){return _a(e.enabled,t)!==!1&&t.isStaleByTime(Rl(e.staleTime,t))}function cre(t,e){return!$v(t.getCurrentResult(),e)}function Tk(t){return{onFetch:(e,r)=>{var f,h,m,g,x;const n=e.options,i=(m=(h=(f=e.fetchOptions)==null?void 0:f.meta)==null?void 0:h.fetchMore)==null?void 0:m.direction,a=((g=e.state.data)==null?void 0:g.pages)||[],o=((x=e.state.data)==null?void 0:x.pageParams)||[];let s={pages:[],pageParams:[]},c=0;const u=async()=>{let v=!1;const b=_=>{Object.defineProperty(_,\"signal\",{enumerable:!0,get:()=>(e.signal.aborted?v=!0:e.signal.addEventListener(\"abort\",()=>{v=!0}),e.signal)})},w=kV(e.options,e.fetchOptions),C=async(_,N,A)=>{if(v)return Promise.reject();if(N==null&&_.pages.length)return Promise.resolve(_);const P=(()=>{const F={client:e.client,queryKey:e.queryKey,pageParam:N,direction:A?\"backward\":\"forward\",meta:e.options.meta};return b(F),F})(),k=await w(P),{maxPages:I}=e.options,R=A?ere:Jte;return{pages:R(_.pages,k,I),pageParams:R(_.pageParams,N,I)}};if(i&&a.length){const _=i===\"backward\",N=_?ure:Pk,A={pages:a,pageParams:o},T=N(n,A);s=await C(A,T,_)}else{const _=t??a.length;do{const N=c===0?o[0]??n.initialPageParam:Pk(n,s);if(c>0&&N==null)break;s=await C(s,N),c++}while(c<_)}return s};e.options.persister?e.fetchFn=()=>{var v,b;return(b=(v=e.options).persister)==null?void 0:b.call(v,u,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},r)}:e.fetchFn=u}}}function Pk(t,{pages:e,pageParams:r}){const n=e.length-1;return e.length>0?t.getNextPageParam(e[n],e,r[n],r):void 0}function ure(t,{pages:e,pageParams:r}){var n;return e.length>0?(n=t.getPreviousPageParam)==null?void 0:n.call(t,e[0],e,r[0],r):void 0}var n0,Ao,di,ru,No,yl,LF,dre=(LF=class extends RV{constructor(e){super();rt(this,No);rt(this,n0);rt(this,Ao);rt(this,di);rt(this,ru);Le(this,n0,e.client),this.mutationId=e.mutationId,Le(this,di,e.mutationCache),Le(this,Ao,[]),this.state=e.state||BV(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){Y(this,Ao).includes(e)||(Y(this,Ao).push(e),this.clearGcTimeout(),Y(this,di).notify({type:\"observerAdded\",mutation:this,observer:e}))}removeObserver(e){Le(this,Ao,Y(this,Ao).filter(r=>r!==e)),this.scheduleGc(),Y(this,di).notify({type:\"observerRemoved\",mutation:this,observer:e})}optionalRemove(){Y(this,Ao).length||(this.state.status===\"pending\"?this.scheduleGc():Y(this,di).remove(this))}continue(){var e;return((e=Y(this,ru))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var o,s,c,u,f,h,m,g,x,v,b,w,C,_,N,A,T,P,k,I;const r=()=>{St(this,No,yl).call(this,{type:\"continue\"})},n={client:Y(this,n0),meta:this.options.meta,mutationKey:this.options.mutationKey};Le(this,ru,DV({fn:()=>this.options.mutationFn?this.options.mutationFn(e,n):Promise.reject(new Error(\"No mutationFn found\")),onFail:(R,F)=>{St(this,No,yl).call(this,{type:\"failed\",failureCount:R,error:F})},onPause:()=>{St(this,No,yl).call(this,{type:\"pause\"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Y(this,di).canRun(this)}));const i=this.state.status===\"pending\",a=!Y(this,ru).canStart();try{if(i)r();else{St(this,No,yl).call(this,{type:\"pending\",variables:e,isPaused:a}),await((s=(o=Y(this,di).config).onMutate)==null?void 0:s.call(o,e,this,n));const F=await((u=(c=this.options).onMutate)==null?void 0:u.call(c,e,n));F!==this.state.context&&St(this,No,yl).call(this,{type:\"pending\",context:F,variables:e,isPaused:a})}const R=await Y(this,ru).start();return await((h=(f=Y(this,di).config).onSuccess)==null?void 0:h.call(f,R,e,this.state.context,this,n)),await((g=(m=this.options).onSuccess)==null?void 0:g.call(m,R,e,this.state.context,n)),await((v=(x=Y(this,di).config).onSettled)==null?void 0:v.call(x,R,null,this.state.variables,this.state.context,this,n)),await((w=(b=this.options).onSettled)==null?void 0:w.call(b,R,null,e,this.state.context,n)),St(this,No,yl).call(this,{type:\"success\",data:R}),R}catch(R){try{throw await((_=(C=Y(this,di).config).onError)==null?void 0:_.call(C,R,e,this.state.context,this,n)),await((A=(N=this.options).onError)==null?void 0:A.call(N,R,e,this.state.context,n)),await((P=(T=Y(this,di).config).onSettled)==null?void 0:P.call(T,void 0,R,this.state.variables,this.state.context,this,n)),await((I=(k=this.options).onSettled)==null?void 0:I.call(k,void 0,R,e,this.state.context,n)),R}finally{St(this,No,yl).call(this,{type:\"error\",error:R})}}finally{Y(this,di).runNext(this)}}},n0=new WeakMap,Ao=new WeakMap,di=new WeakMap,ru=new WeakMap,No=new WeakSet,yl=function(e){const r=n=>{switch(e.type){case\"failed\":return{...n,failureCount:e.failureCount,failureReason:e.error};case\"pause\":return{...n,isPaused:!0};case\"continue\":return{...n,isPaused:!1};case\"pending\":return{...n,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:\"pending\",variables:e.variables,submittedAt:Date.now()};case\"success\":return{...n,data:e.data,failureCount:0,failureReason:null,error:null,status:\"success\",isPaused:!1};case\"error\":return{...n,data:void 0,error:e.error,failureCount:n.failureCount+1,failureReason:e.error,isPaused:!1,status:\"error\"}}};this.state=r(this.state),vn.batch(()=>{Y(this,Ao).forEach(n=>{n.onMutationUpdate(e)}),Y(this,di).notify({mutation:this,type:\"updated\",action:e})})},LF);function BV(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:\"idle\",variables:void 0,submittedAt:0}}var ms,Ka,i0,BF,fre=(BF=class extends Uf{constructor(e={}){super();rt(this,ms);rt(this,Ka);rt(this,i0);this.config=e,Le(this,ms,new Set),Le(this,Ka,new Map),Le(this,i0,0)}build(e,r,n){const i=new dre({client:e,mutationCache:this,mutationId:++zg(this,i0)._,options:e.defaultMutationOptions(r),state:n});return this.add(i),i}add(e){Y(this,ms).add(e);const r=Hg(e);if(typeof r==\"string\"){const n=Y(this,Ka).get(r);n?n.push(e):Y(this,Ka).set(r,[e])}this.notify({type:\"added\",mutation:e})}remove(e){if(Y(this,ms).delete(e)){const r=Hg(e);if(typeof r==\"string\"){const n=Y(this,Ka).get(r);if(n)if(n.length>1){const i=n.indexOf(e);i!==-1&&n.splice(i,1)}else n[0]===e&&Y(this,Ka).delete(r)}}this.notify({type:\"removed\",mutation:e})}canRun(e){const r=Hg(e);if(typeof r==\"string\"){const n=Y(this,Ka).get(r),i=n==null?void 0:n.find(a=>a.state.status===\"pending\");return!i||i===e}else return!0}runNext(e){var n;const r=Hg(e);if(typeof r==\"string\"){const i=(n=Y(this,Ka).get(r))==null?void 0:n.find(a=>a!==e&&a.state.isPaused);return(i==null?void 0:i.continue())??Promise.resolve()}else return Promise.resolve()}clear(){vn.batch(()=>{Y(this,ms).forEach(e=>{this.notify({type:\"removed\",mutation:e})}),Y(this,ms).clear(),Y(this,Ka).clear()})}getAll(){return Array.from(Y(this,ms))}find(e){const r={exact:!0,...e};return this.getAll().find(n=>_k(r,n))}findAll(e={}){return this.getAll().filter(r=>_k(e,r))}notify(e){vn.batch(()=>{this.listeners.forEach(r=>{r(e)})})}resumePausedMutations(){const e=this.getAll().filter(r=>r.state.isPaused);return vn.batch(()=>Promise.all(e.map(r=>r.continue().catch(gi))))}},ms=new WeakMap,Ka=new WeakMap,i0=new WeakMap,BF);function Hg(t){var e;return(e=t.options.scope)==null?void 0:e.id}var gs,Tl,Di,vs,Os,Cv,HA,$F,hre=($F=class extends Uf{constructor(r,n){super();rt(this,Os);rt(this,gs);rt(this,Tl);rt(this,Di);rt(this,vs);Le(this,gs,r),this.setOptions(n),this.bindMethods(),St(this,Os,Cv).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var i;const n=this.options;this.options=Y(this,gs).defaultMutationOptions(r),$v(this.options,n)||Y(this,gs).getMutationCache().notify({type:\"observerOptionsUpdated\",mutation:Y(this,Di),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&lu(n.mutationKey)!==lu(this.options.mutationKey)?this.reset():((i=Y(this,Di))==null?void 0:i.state.status)===\"pending\"&&Y(this,Di).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=Y(this,Di))==null||r.removeObserver(this)}onMutationUpdate(r){St(this,Os,Cv).call(this),St(this,Os,HA).call(this,r)}getCurrentResult(){return Y(this,Tl)}reset(){var r;(r=Y(this,Di))==null||r.removeObserver(this),Le(this,Di,void 0),St(this,Os,Cv).call(this),St(this,Os,HA).call(this)}mutate(r,n){var i;return Le(this,vs,n),(i=Y(this,Di))==null||i.removeObserver(this),Le(this,Di,Y(this,gs).getMutationCache().build(Y(this,gs),this.options)),Y(this,Di).addObserver(this),Y(this,Di).execute(r)}},gs=new WeakMap,Tl=new WeakMap,Di=new WeakMap,vs=new WeakMap,Os=new WeakSet,Cv=function(){var n;const r=((n=Y(this,Di))==null?void 0:n.state)??BV();Le(this,Tl,{...r,isPending:r.status===\"pending\",isSuccess:r.status===\"success\",isError:r.status===\"error\",isIdle:r.status===\"idle\",mutate:this.mutate,reset:this.reset})},HA=function(r){vn.batch(()=>{var n,i,a,o,s,c,u,f;if(Y(this,vs)&&this.hasListeners()){const h=Y(this,Tl).variables,m=Y(this,Tl).context,g={client:Y(this,gs),meta:this.options.meta,mutationKey:this.options.mutationKey};(r==null?void 0:r.type)===\"success\"?((i=(n=Y(this,vs)).onSuccess)==null||i.call(n,r.data,h,m,g),(o=(a=Y(this,vs)).onSettled)==null||o.call(a,r.data,null,h,m,g)):(r==null?void 0:r.type)===\"error\"&&((c=(s=Y(this,vs)).onError)==null||c.call(s,r.error,h,m,g),(f=(u=Y(this,vs)).onSettled)==null||f.call(u,void 0,r.error,h,m,g))}this.listeners.forEach(h=>{h(Y(this,Tl))})})},$F),Eo,VF,pre=(VF=class extends Uf{constructor(e={}){super();rt(this,Eo);this.config=e,Le(this,Eo,new Map)}build(e,r,n){const i=r.queryKey,a=r.queryHash??wj(i,r);let o=this.get(a);return o||(o=new ore({client:e,queryKey:i,queryHash:a,options:e.defaultQueryOptions(r),state:n,defaultOptions:e.getQueryDefaults(i)}),this.add(o)),o}add(e){Y(this,Eo).has(e.queryHash)||(Y(this,Eo).set(e.queryHash,e),this.notify({type:\"added\",query:e}))}remove(e){const r=Y(this,Eo).get(e.queryHash);r&&(e.destroy(),r===e&&Y(this,Eo).delete(e.queryHash),this.notify({type:\"removed\",query:e}))}clear(){vn.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return Y(this,Eo).get(e)}getAll(){return[...Y(this,Eo).values()]}find(e){const r={exact:!0,...e};return this.getAll().find(n=>Sk(r,n))}findAll(e={}){const r=this.getAll();return Object.keys(e).length>0?r.filter(n=>Sk(e,n)):r}notify(e){vn.batch(()=>{this.listeners.forEach(r=>{r(e)})})}onFocus(){vn.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){vn.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Eo=new WeakMap,VF),Lr,Pl,Ol,ef,tf,kl,rf,nf,UF,mre=(UF=class{constructor(t={}){rt(this,Lr);rt(this,Pl);rt(this,Ol);rt(this,ef);rt(this,tf);rt(this,kl);rt(this,rf);rt(this,nf);Le(this,Lr,t.queryCache||new pre),Le(this,Pl,t.mutationCache||new fre),Le(this,Ol,t.defaultOptions||{}),Le(this,ef,new Map),Le(this,tf,new Map),Le(this,kl,0)}mount(){zg(this,kl)._++,Y(this,kl)===1&&(Le(this,rf,_j.subscribe(async t=>{t&&(await this.resumePausedMutations(),Y(this,Lr).onFocus())})),Le(this,nf,Vv.subscribe(async t=>{t&&(await this.resumePausedMutations(),Y(this,Lr).onOnline())})))}unmount(){var t,e;zg(this,kl)._--,Y(this,kl)===0&&((t=Y(this,rf))==null||t.call(this),Le(this,rf,void 0),(e=Y(this,nf))==null||e.call(this),Le(this,nf,void 0))}isFetching(t){return Y(this,Lr).findAll({...t,fetchStatus:\"fetching\"}).length}isMutating(t){return Y(this,Pl).findAll({...t,status:\"pending\"}).length}getQueryData(t){var r;const e=this.defaultQueryOptions({queryKey:t});return(r=Y(this,Lr).get(e.queryHash))==null?void 0:r.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),r=Y(this,Lr).build(this,e),n=r.state.data;return n===void 0?this.fetchQuery(t):(t.revalidateIfStale&&r.isStaleByTime(Rl(e.staleTime,r))&&this.prefetchQuery(e),Promise.resolve(n))}getQueriesData(t){return Y(this,Lr).findAll(t).map(({queryKey:e,state:r})=>{const n=r.data;return[e,n]})}setQueryData(t,e,r){const n=this.defaultQueryOptions({queryKey:t}),i=Y(this,Lr).get(n.queryHash),a=i==null?void 0:i.state.data,o=Yte(e,a);if(o!==void 0)return Y(this,Lr).build(this,n).setData(o,{...r,manual:!0})}setQueriesData(t,e,r){return vn.batch(()=>Y(this,Lr).findAll(t).map(({queryKey:n})=>[n,this.setQueryData(n,e,r)]))}getQueryState(t){var r;const e=this.defaultQueryOptions({queryKey:t});return(r=Y(this,Lr).get(e.queryHash))==null?void 0:r.state}removeQueries(t){const e=Y(this,Lr);vn.batch(()=>{e.findAll(t).forEach(r=>{e.remove(r)})})}resetQueries(t,e){const r=Y(this,Lr);return vn.batch(()=>(r.findAll(t).forEach(n=>{n.reset()}),this.refetchQueries({type:\"active\",...t},e)))}cancelQueries(t,e={}){const r={revert:!0,...e},n=vn.batch(()=>Y(this,Lr).findAll(t).map(i=>i.cancel(r)));return Promise.all(n).then(gi).catch(gi)}invalidateQueries(t,e={}){return vn.batch(()=>(Y(this,Lr).findAll(t).forEach(r=>{r.invalidate()}),(t==null?void 0:t.refetchType)===\"none\"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??\"active\"},e)))}refetchQueries(t,e={}){const r={...e,cancelRefetch:e.cancelRefetch??!0},n=vn.batch(()=>Y(this,Lr).findAll(t).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let a=i.fetch(void 0,r);return r.throwOnError||(a=a.catch(gi)),i.state.fetchStatus===\"paused\"?Promise.resolve():a}));return Promise.all(n).then(gi)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const r=Y(this,Lr).build(this,e);return r.isStaleByTime(Rl(e.staleTime,r))?r.fetch(e):Promise.resolve(r.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(gi).catch(gi)}fetchInfiniteQuery(t){return t.behavior=Tk(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(gi).catch(gi)}ensureInfiniteQueryData(t){return t.behavior=Tk(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return Vv.isOnline()?Y(this,Pl).resumePausedMutations():Promise.resolve()}getQueryCache(){return Y(this,Lr)}getMutationCache(){return Y(this,Pl)}getDefaultOptions(){return Y(this,Ol)}setDefaultOptions(t){Le(this,Ol,t)}setQueryDefaults(t,e){Y(this,ef).set(lu(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...Y(this,ef).values()],r={};return e.forEach(n=>{zp(t,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(t,e){Y(this,tf).set(lu(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...Y(this,tf).values()],r={};return e.forEach(n=>{zp(t,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(t){if(t._defaulted)return t;const e={...Y(this,Ol).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=wj(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!==\"always\"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode=\"offlineFirst\"),e.queryFn===Sj&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...Y(this,Ol).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){Y(this,Lr).clear(),Y(this,Pl).clear()}},Lr=new WeakMap,Pl=new WeakMap,Ol=new WeakMap,ef=new WeakMap,tf=new WeakMap,kl=new WeakMap,rf=new WeakMap,nf=new WeakMap,UF),E=Ex();const K=or(E),Aj=Lte({__proto__:null,default:K},[E]);var $V=E.createContext(void 0),la=t=>{const e=E.useContext($V);if(!e)throw new Error(\"No QueryClient set, use QueryClientProvider to set one\");return e},gre=({client:t,children:e})=>(E.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),l.jsx($V.Provider,{value:t,children:e})),VV=E.createContext(!1),vre=()=>E.useContext(VV);VV.Provider;function yre(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var xre=E.createContext(yre()),bre=()=>E.useContext(xre),wre=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},Sre=t=>{E.useEffect(()=>{t.clearReset()},[t])},_re=({result:t,errorResetBoundary:e,throwOnError:r,query:n,suspense:i})=>t.isError&&!e.isReset()&&!t.isFetching&&n&&(i&&t.data===void 0||IV(r,[t.error,n])),Cre=t=>{if(t.suspense){const r=i=>i===\"static\"?i:Math.max(i??1e3,1e3),n=t.staleTime;t.staleTime=typeof n==\"function\"?(...i)=>r(n(...i)):r(n),typeof t.gcTime==\"number\"&&(t.gcTime=Math.max(t.gcTime,1e3))}},Are=(t,e)=>t.isLoading&&t.isFetching&&!e,Nre=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,Ok=(t,e,r)=>e.fetchOptimistic(t).catch(()=>{r.clearReset()});function Ere(t,e,r){var h,m,g,x,v;const n=vre(),i=bre(),a=la(),o=a.defaultQueryOptions(t);(m=(h=a.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||m.call(h,o),o._optimisticResults=n?\"isRestoring\":\"optimistic\",Cre(o),wre(o,i),Sre(i);const s=!a.getQueryCache().get(o.queryHash),[c]=E.useState(()=>new e(a,o)),u=c.getOptimisticResult(o),f=!n&&t.subscribed!==!1;if(E.useSyncExternalStore(E.useCallback(b=>{const w=f?c.subscribe(vn.batchCalls(b)):gi;return c.updateResult(),w},[c,f]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),E.useEffect(()=>{c.setOptions(o)},[o,c]),Nre(o,u))throw Ok(o,c,i);if(_re({result:u,errorResetBoundary:i,throwOnError:o.throwOnError,query:a.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw u.error;if((x=(g=a.getDefaultOptions().queries)==null?void 0:g._experimental_afterQuery)==null||x.call(g,o,u),o.experimental_prefetchInRender&&!su&&Are(u,n)){const b=s?Ok(o,c,i):(v=a.getQueryCache().get(o.queryHash))==null?void 0:v.promise;b==null||b.catch(gi).finally(()=>{c.updateResult()})}return o.notifyOnChangeProps?u:c.trackResult(u)}function Tr(t,e){return Ere(t,sre)}function Wr(t,e){const r=la(),[n]=E.useState(()=>new hre(r,t));E.useEffect(()=>{n.setOptions(t)},[n,t]);const i=E.useSyncExternalStore(E.useCallback(o=>n.subscribe(vn.batchCalls(o)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),a=E.useCallback((o,s)=>{n.mutate(o,s).catch(gi)},[n]);if(i.error&&IV(n.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:a,mutateAsync:i.mutate}}async function UV(t){if(!t.ok){const e=await t.text()||t.statusText;throw new Error(`${t.status}: ${e}`)}}async function Sr(t,e,r){const n=localStorage.getItem(\"platemate_guest_id\"),i=r?{\"Content-Type\":\"application/json\"}:{};n&&(i[\"X-Guest-Id\"]=n);const a=await fetch(e,{method:t,headers:i,body:r?JSON.stringify(r):void 0,credentials:\"include\"});return await UV(a),a}const zV=({on401:t})=>async({queryKey:e})=>{const r=localStorage.getItem(\"platemate_guest_id\"),n={};r&&(n[\"X-Guest-Id\"]=r);const i=await fetch(e.join(\"/\"),{credentials:\"include\",headers:n});return t===\"returnNull\"&&i.status===401?null:(await UV(i),await i.json())},WV=new mre({defaultOptions:{queries:{queryFn:zV({on401:\"throw\"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:3600*1e3,gcTime:1440*60*1e3,retry:1},mutations:{retry:!1}}});function jre(t,e){if(t instanceof RegExp)return{keys:!1,pattern:t};var r,n,i,a,o=[],s=\"\",c=t.split(\"/\");for(c[0]||c.shift();i=c.shift();)r=i[0],r===\"*\"?(o.push(r),s+=i[1]===\"?\"?\"(?:/(.*))?\":\"/(.*)\"):r===\":\"?(n=i.indexOf(\"?\",1),a=i.indexOf(\".\",1),o.push(i.substring(1,~n?n:~a?a:i.length)),s+=~n&&!~a?\"(?:/([^/]+?))?\":\"/([^/]+?)\",~a&&(s+=(~n?\"?\":\"\")+\"\\\\\"+i.substring(a))):s+=\"/\"+i;return{keys:o,pattern:new RegExp(\"^\"+s+(e?\"(?=$|/)\":\"/?$\"),\"i\")}}var Bw={exports:{}},$w={};/**\n * @license React\n * use-sync-external-store-shim.production.js\n *\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */var kk;function Tre(){if(kk)return $w;kk=1;var t=Ex();function e(h,m){return h===m&&(h!==0||1/h===1/m)||h!==h&&m!==m}var r=typeof Object.is==\"function\"?Object.is:e,n=t.useState,i=t.useEffect,a=t.useLayoutEffect,o=t.useDebugValue;function s(h,m){var g=m(),x=n({inst:{value:g,getSnapshot:m}}),v=x[0].inst,b=x[1];return a(function(){v.value=g,v.getSnapshot=m,c(v)&&b({inst:v})},[h,g,m]),i(function(){return c(v)&&b({inst:v}),h(function(){c(v)&&b({inst:v})})},[h]),o(g),g}function c(h){var m=h.getSnapshot;h=h.value;try{var g=m();return!r(h,g)}catch{return!0}}function u(h,m){return m()}var f=typeof window>\"u\"||typeof window.document>\"u\"||typeof window.document.createElement>\"u\"?u:s;return $w.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:f,$w}var Ik;function Pre(){return Ik||(Ik=1,Bw.exports=Tre()),Bw.exports}var Ore=Pre();const kre=Aj.useInsertionEffect,Ire=typeof window<\"u\"&&typeof window.document<\"u\"&&typeof window.document.createElement<\"u\",Mre=Ire?E.useLayoutEffect:E.useEffect,Dre=kre||Mre,qV=t=>{const e=E.useRef([t,(...r)=>e[0](...r)]).current;return Dre(()=>{e[0]=t}),e[1]},Rre=\"popstate\",Nj=\"pushState\",Ej=\"replaceState\",Fre=\"hashchange\",Mk=[Rre,Nj,Ej,Fre],Lre=t=>{for(const e of Mk)addEventListener(e,t);return()=>{for(const e of Mk)removeEventListener(e,t)}},HV=(t,e)=>Ore.useSyncExternalStore(Lre,t,e),Bre=()=>location.search,$re=({ssrSearch:t=\"\"}={})=>HV(Bre,()=>t),Dk=()=>location.pathname,Vre=({ssrPath:t}={})=>HV(Dk,t?()=>t:Dk),Ure=(t,{replace:e=!1,state:r=null}={})=>history[e?Ej:Nj](r,\"\",t),zre=(t={})=>[Vre(t),Ure],Rk=Symbol.for(\"wouter_v3\");if(typeof history<\"u\"&&typeof window[Rk]>\"u\"){for(const t of[Nj,Ej]){const e=history[t];history[t]=function(){const r=e.apply(this,arguments),n=new Event(t);return n.arguments=arguments,dispatchEvent(n),r}}Object.defineProperty(window,Rk,{value:!0})}const Wre=(t,e)=>e.toLowerCase().indexOf(t.toLowerCase())?\"~\"+e:e.slice(t.length)||\"/\",GV=(t=\"\")=>t===\"/\"?\"\":t,qre=(t,e)=>t[0]===\"~\"?t.slice(1):GV(e)+t,Hre=(t=\"\",e)=>Wre(Fk(GV(t)),Fk(e)),Fk=t=>{try{return decodeURI(t)}catch{return t}},KV={hook:zre,searchHook:$re,parser:jre,base:\"\",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:t=>t},XV=E.createContext(KV),a0=()=>E.useContext(XV),YV={},ZV=E.createContext(YV),Gre=()=>E.useContext(ZV),jx=t=>{const[e,r]=t.hook(t);return[Hre(t.base,e),qV((n,i)=>r(qre(n,t.base),i))]},jj=()=>jx(a0()),QV=(t,e,r,n)=>{const{pattern:i,keys:a}=e instanceof RegExp?{keys:!1,pattern:e}:t(e||\"*\",n),o=i.exec(r)||[],[s,...c]=o;return s!==void 0?[!0,(()=>{const u=a!==!1?Object.fromEntries(a.map((h,m)=>[h,c[m]])):o.groups;let f={...c};return u&&Object.assign(f,u),f})(),...n?[s]:[]]:[!1,null]},Kre=({children:t,...e})=>{var f,h;const r=a0(),n=e.hook?KV:r;let i=n;const[a,o]=((f=e.ssrPath)==null?void 0:f.split(\"?\"))??[];o&&(e.ssrSearch=o,e.ssrPath=a),e.hrefs=e.hrefs??((h=e.hook)==null?void 0:h.hrefs);let s=E.useRef({}),c=s.current,u=c;for(let m in n){const g=m===\"base\"?n[m]+(e[m]||\"\"):e[m]||n[m];c===u&&g!==u[m]&&(s.current=u={...u}),u[m]=g,(g!==n[m]||g!==i[m])&&(i=u)}return E.createElement(XV.Provider,{value:i,children:t})},Lk=({children:t,component:e},r)=>e?E.createElement(e,{params:r}):typeof t==\"function\"?t(r):t,Xre=t=>{let e=E.useRef(YV);const r=e.current;return e.current=Object.keys(t).length!==Object.keys(r).length||Object.entries(t).some(([n,i])=>i!==r[n])?t:r},Jr=({path:t,nest:e,match:r,...n})=>{const i=a0(),[a]=jx(i),[o,s,c]=r??QV(i.parser,t,a,e),u=Xre({...Gre(),...s});if(!o)return null;const f=c?E.createElement(Kre,{base:c},Lk(n,u)):Lk(n,u);return E.createElement(ZV.Provider,{value:u,children:f})},nr=E.forwardRef((t,e)=>{const r=a0(),[n,i]=jx(r),{to:a=\"\",href:o=a,onClick:s,asChild:c,children:u,className:f,replace:h,state:m,...g}=t,x=qV(b=>{b.ctrlKey||b.metaKey||b.altKey||b.shiftKey||b.button!==0||(s==null||s(b),b.defaultPrevented||(b.preventDefault(),i(o,t)))}),v=r.hrefs(o[0]===\"~\"?o.slice(1):r.base+o,r);return c&&E.isValidElement(u)?E.cloneElement(u,{onClick:x,href:v}):E.createElement(\"a\",{...g,onClick:x,href:v,className:f!=null&&f.call?f(n===o):f,children:u,ref:e})}),JV=t=>Array.isArray(t)?t.flatMap(e=>JV(e&&e.type===E.Fragment?e.props.children:e)):[t],Yre=({children:t,location:e})=>{const r=a0(),[n]=jx(r);for(const i of JV(t)){let a=0;if(E.isValidElement(i)&&(a=QV(r.parser,i.props.path,e||n,i.props.nest))[0])return E.cloneElement(i,{match:a})}return null},Zre=\"useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict\";let Qre=(t=21)=>{let e=\"\",r=crypto.getRandomValues(new Uint8Array(t|=0));for(;t--;)e+=Zre[r[t]&63];return e};const Bk=\"platemate_guest_id\";function Jre(){const t=localStorage.getItem(Bk);if(t)return t;const e=`guest_${Qre()}`;return localStorage.setItem(Bk,e),e}function o0(){const{data:t,isLoading:e}=Tr({queryKey:[\"/api/user\"],queryFn:zV({on401:\"returnNull\"}),retry:!1}),r=!t&&!e?Jre():null;return{user:t,isLoading:e,isAuthenticated:!!t,isGuest:!!r,guestId:r,userId:(t==null?void 0:t.id)||r||null,requiresLogin:!1}}const ene=\"modulepreload\",tne=function(t){return\"/\"+t},$k={},zf=function(e,r,n){let i=Promise.resolve();if(r&&r.length>0){let o=function(u){return Promise.all(u.map(f=>Promise.resolve(f).then(h=>({status:\"fulfilled\",value:h}),h=>({status:\"rejected\",reason:h}))))};document.getElementsByTagName(\"link\");const s=document.querySelector(\"meta[property=csp-nonce]\"),c=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute(\"nonce\"));i=o(r.map(u=>{if(u=tne(u),u in $k)return;$k[u]=!0;const f=u.endsWith(\".css\"),h=f?'[rel=\"stylesheet\"]':\"\";if(document.querySelector(`link[href=\"${u}\"]${h}`))return;const m=document.createElement(\"link\");if(m.rel=f?\"stylesheet\":ene,f||(m.as=\"script\"),m.crossOrigin=\"\",m.href=u,c&&m.setAttribute(\"nonce\",c),document.head.appendChild(m),f)return new Promise((g,x)=>{m.addEventListener(\"load\",g),m.addEventListener(\"error\",()=>x(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(o){const s=new Event(\"vite:preloadError\",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o}return i.then(o=>{for(const s of o||[])s.status===\"rejected\"&&a(s.reason);return e().catch(a)})};/*! Capacitor: https://capacitorjs.com/ - MIT License */var af;(function(t){t.Unimplemented=\"UNIMPLEMENTED\",t.Unavailable=\"UNAVAILABLE\"})(af||(af={}));class Pd extends Error{constructor(e,r,n){super(e),this.message=e,this.code=r,this.data=n}}const rne=t=>{var e,r;return t!=null&&t.androidBridge?\"android\":!((r=(e=t==null?void 0:t.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||r===void 0)&&r.bridge?\"ios\":\"web\"},nne=t=>{const e=t.CapacitorCustomPlatform||null,r=t.Capacitor||{},n=r.Plugins=r.Plugins||{},i=()=>e!==null?e.name:rne(t),a=()=>i()!==\"web\",o=h=>{const m=u.get(h);return!!(m!=null&&m.platforms.has(i())||s(h))},s=h=>{var m;return(m=r.PluginHeaders)===null||m===void 0?void 0:m.find(g=>g.name===h)},c=h=>t.console.error(h),u=new Map,f=(h,m={})=>{const g=u.get(h);if(g)return console.warn(`Capacitor plugin \"${h}\" already registered. Cannot register plugins twice.`),g.proxy;const x=i(),v=s(h);let b;const w=async()=>(!b&&x in m?b=typeof m[x]==\"function\"?b=await m[x]():b=m[x]:e!==null&&!b&&\"web\"in m&&(b=typeof m.web==\"function\"?b=await m.web():b=m.web),b),C=(k,I)=>{var R,F;if(v){const D=v==null?void 0:v.methods.find(B=>I===B.name);if(D)return D.rtype===\"promise\"?B=>r.nativePromise(h,I.toString(),B):(B,q)=>r.nativeCallback(h,I.toString(),B,q);if(k)return(R=k[I])===null||R===void 0?void 0:R.bind(k)}else{if(k)return(F=k[I])===null||F===void 0?void 0:F.bind(k);throw new Pd(`\"${h}\" plugin is not implemented on ${x}`,af.Unimplemented)}},_=k=>{let I;const R=(...F)=>{const D=w().then(B=>{const q=C(B,k);if(q){const V=q(...F);return I=V==null?void 0:V.remove,V}else throw new Pd(`\"${h}.${k}()\" is not implemented on ${x}`,af.Unimplemented)});return k===\"addListener\"&&(D.remove=async()=>I()),D};return R.toString=()=>`${k.toString()}() { [capacitor code] }`,Object.defineProperty(R,\"name\",{value:k,writable:!1,configurable:!1}),R},N=_(\"addListener\"),A=_(\"removeListener\"),T=(k,I)=>{const R=N({eventName:k},I),F=async()=>{const B=await R;A({eventName:k,callbackId:B},I)},D=new Promise(B=>R.then(()=>B({remove:F})));return D.remove=async()=>{console.warn(\"Using addListener() without 'await' is deprecated.\"),await F()},D},P=new Proxy({},{get(k,I){switch(I){case\"$$typeof\":return;case\"toJSON\":return()=>({});case\"addListener\":return v?T:N;case\"removeListener\":return A;default:return _(I)}}});return n[h]=P,u.set(h,{name:h,proxy:P,platforms:new Set([...Object.keys(m),...v?[x]:[]])}),P};return r.convertFileSrc||(r.convertFileSrc=h=>h),r.getPlatform=i,r.handleError=c,r.isNativePlatform=a,r.isPluginAvailable=o,r.registerPlugin=f,r.Exception=Pd,r.DEBUG=!!r.DEBUG,r.isLoggingEnabled=!!r.isLoggingEnabled,r},ine=t=>t.Capacitor=nne(t),Pn=ine(typeof globalThis<\"u\"?globalThis:typeof self<\"u\"?self:typeof window<\"u\"?window:typeof global<\"u\"?global:{}),Nu=Pn.registerPlugin;class Tj{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,r){let n=!1;this.listeners[e]||(this.listeners[e]=[],n=!0),this.listeners[e].push(r);const a=this.windowListeners[e];a&&!a.registered&&this.addWindowListener(a),n&&this.sendRetainedArgumentsForEvent(e);const o=async()=>this.removeListener(e,r);return Promise.resolve({remove:o})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,r,n){const i=this.listeners[e];if(!i){if(n){let a=this.retainedEventArguments[e];a||(a=[]),a.push(r),this.retainedEventArguments[e]=a}return}i.forEach(a=>a(r))}hasListeners(e){var r;return!!(!((r=this.listeners[e])===null||r===void 0)&&r.length)}registerWindowListener(e,r){this.windowListeners[r]={registered:!1,windowEventName:e,pluginEventName:r,handler:n=>{this.notifyListeners(r,n)}}}unimplemented(e=\"not implemented\"){return new Pn.Exception(e,af.Unimplemented)}unavailable(e=\"not available\"){return new Pn.Exception(e,af.Unavailable)}async removeListener(e,r){const n=this.listeners[e];if(!n)return;const i=n.indexOf(r);this.listeners[e].splice(i,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const r=this.retainedEventArguments[e];r&&(delete this.retainedEventArguments[e],r.forEach(n=>{this.notifyListeners(e,n)}))}}const Vk=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Uk=t=>t.replace(/(%[\\dA-F]{2})+/gi,decodeURIComponent);class ane extends Tj{async getCookies(){const e=document.cookie,r={};return e.split(\";\").forEach(n=>{if(n.length<=0)return;let[i,a]=n.replace(/=/,\"CAP_COOKIE\").split(\"CAP_COOKIE\");i=Uk(i).trim(),a=Uk(a).trim(),r[i]=a}),r}async setCookie(e){try{const r=Vk(e.key),n=Vk(e.value),i=`; expires=${(e.expires||\"\").replace(\"expires=\",\"\")}`,a=(e.path||\"/\").replace(\"path=\",\"\"),o=e.url!=null&&e.url.length>0?`domain=${e.url}`:\"\";document.cookie=`${r}=${n||\"\"}${i}; path=${a}; ${o};`}catch(r){return Promise.reject(r)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(r){return Promise.reject(r)}}async clearCookies(){try{const e=document.cookie.split(\";\")||[];for(const r of e)document.cookie=r.replace(/^ +/,\"\").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}Nu(\"CapacitorCookies\",{web:()=>new ane});const one=async t=>new Promise((e,r)=>{const n=new FileReader;n.onload=()=>{const i=n.result;e(i.indexOf(\",\")>=0?i.split(\",\")[1]:i)},n.onerror=i=>r(i),n.readAsDataURL(t)}),sne=(t={})=>{const e=Object.keys(t);return Object.keys(t).map(i=>i.toLocaleLowerCase()).reduce((i,a,o)=>(i[a]=t[e[o]],i),{})},lne=(t,e=!0)=>t?Object.entries(t).reduce((n,i)=>{const[a,o]=i;let s,c;return Array.isArray(o)?(c=\"\",o.forEach(u=>{s=e?encodeURIComponent(u):u,c+=`${a}=${s}&`}),c.slice(0,-1)):(s=e?encodeURIComponent(o):o,c=`${a}=${s}`),`${n}&${c}`},\"\").substr(1):null,cne=(t,e={})=>{const r=Object.assign({method:t.method||\"GET\",headers:t.headers},e),i=sne(t.headers)[\"content-type\"]||\"\";if(typeof t.data==\"string\")r.body=t.data;else if(i.includes(\"application/x-www-form-urlencoded\")){const a=new URLSearchParams;for(const[o,s]of Object.entries(t.data||{}))a.set(o,s);r.body=a.toString()}else if(i.includes(\"multipart/form-data\")||t.data instanceof FormData){const a=new FormData;if(t.data instanceof FormData)t.data.forEach((s,c)=>{a.append(c,s)});else for(const s of Object.keys(t.data))a.append(s,t.data[s]);r.body=a;const o=new Headers(r.headers);o.delete(\"content-type\"),r.headers=o}else(i.includes(\"application/json\")||typeof t.data==\"object\")&&(r.body=JSON.stringify(t.data));return r};class une extends Tj{async request(e){const r=cne(e,e.webFetchExtra),n=lne(e.params,e.shouldEncodeUrlParams),i=n?`${e.url}?${n}`:e.url,a=await fetch(i,r),o=a.headers.get(\"content-type\")||\"\";let{responseType:s=\"text\"}=a.ok?e:{};o.includes(\"application/json\")&&(s=\"json\");let c,u;switch(s){case\"arraybuffer\":case\"blob\":u=await a.blob(),c=await one(u);break;case\"json\":c=await a.json();break;case\"document\":case\"text\":default:c=await a.text()}const f={};return a.headers.forEach((h,m)=>{f[m]=h}),{data:c,headers:f,status:a.status,url:a.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:\"GET\"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:\"POST\"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:\"PUT\"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:\"PATCH\"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:\"DELETE\"}))}}Nu(\"CapacitorHttp\",{web:()=>new une});const dne=Nu(\"App\",{web:()=>zf(()=>import(\"./web-DNXzBeur.js\"),[]).then(t=>new t.AppWeb)}),Wp=Nu(\"Browser\",{web:()=>zf(()=>import(\"./web-DaEeAdBX.js\"),[]).then(t=>new t.BrowserWeb)}),fne=1,hne=1e6;let Vw=0;function pne(){return Vw=(Vw+1)%Number.MAX_SAFE_INTEGER,Vw.toString()}const Uw=new Map,zk=t=>{if(Uw.has(t))return;const e=setTimeout(()=>{Uw.delete(t),Ep({type:\"REMOVE_TOAST\",toastId:t})},hne);Uw.set(t,e)},mne=(t,e)=>{switch(e.type){case\"ADD_TOAST\":return{...t,toasts:[e.toast,...t.toasts].slice(0,fne)};case\"UPDATE_TOAST\":return{...t,toasts:t.toasts.map(r=>r.id===e.toast.id?{...r,...e.toast}:r)};case\"DISMISS_TOAST\":{const{toastId:r}=e;return r?zk(r):t.toasts.forEach(n=>{zk(n.id)}),{...t,toasts:t.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case\"REMOVE_TOAST\":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(r=>r.id!==e.toastId)}}},Av=[];let Nv={toasts:[]};function Ep(t){Nv=mne(Nv,t),Av.forEach(e=>{e(Nv)})}function gne({...t}){const e=pne(),r=i=>Ep({type:\"UPDATE_TOAST\",toast:{...i,id:e}}),n=()=>Ep({type:\"DISMISS_TOAST\",toastId:e});return Ep({type:\"ADD_TOAST\",toast:{...t,id:e,open:!0,onOpenChange:i=>{i||n()}}}),{id:e,dismiss:n,update:r}}function Wn(){const[t,e]=E.useState(Nv);return E.useEffect(()=>(Av.push(e),()=>{const r=Av.indexOf(e);r>-1&&Av.splice(r,1)}),[t]),{...t,toast:gne,dismiss:r=>Ep({type:\"DISMISS_TOAST\",toastId:r})}}/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const vne=t=>t.replace(/([a-z0-9])([A-Z])/g,\"$1-$2\").toLowerCase(),eU=(...t)=>t.filter((e,r,n)=>!!e&&n.indexOf(e)===r).join(\" \");/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */var yne={xmlns:\"http://www.w3.org/2000/svg\",width:24,height:24,viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:2,strokeLinecap:\"round\",strokeLinejoin:\"round\"};/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const xne=E.forwardRef(({color:t=\"currentColor\",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i=\"\",children:a,iconNode:o,...s},c)=>E.createElement(\"svg\",{ref:c,...yne,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:eU(\"lucide\",i),...s},[...o.map(([u,f])=>E.createElement(u,f)),...Array.isArray(a)?a:[a]]));/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Ne=(t,e)=>{const r=E.forwardRef(({className:n,...i},a)=>E.createElement(xne,{ref:a,iconNode:e,className:eU(`lucide-${vne(t)}`,n),...i}));return r.displayName=`${t}`,r};/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Ev=Ne(\"Activity\",[[\"path\",{d:\"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2\",key:\"169zse\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Uv=Ne(\"Apple\",[[\"path\",{d:\"M12 20.94c1.5 0 2.75 1.06 4 1.06 3 0 6-8 6-12.22A4.91 4.91 0 0 0 17 5c-2.22 0-4 1.44-5 2-1-.56-2.78-2-5-2a4.9 4.9 0 0 0-5 4.78C2 14 5 22 8 22c1.25 0 2.5-1.06 4-1.06Z\",key:\"3s7exb\"}],[\"path\",{d:\"M10 2c1 .5 2 2 2 5\",key:\"fcco2y\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Ko=Ne(\"ArrowLeft\",[[\"path\",{d:\"m12 19-7-7 7-7\",key:\"1l729n\"}],[\"path\",{d:\"M19 12H5\",key:\"x3x0zl\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const bne=Ne(\"ArrowRight\",[[\"path\",{d:\"M5 12h14\",key:\"1ays0h\"}],[\"path\",{d:\"m12 5 7 7-7 7\",key:\"xquz4c\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const wne=Ne(\"AudioLines\",[[\"path\",{d:\"M2 10v3\",key:\"1fnikh\"}],[\"path\",{d:\"M6 6v11\",key:\"11sgs0\"}],[\"path\",{d:\"M10 3v18\",key:\"yhl04a\"}],[\"path\",{d:\"M14 8v7\",key:\"3a1oy3\"}],[\"path\",{d:\"M18 5v13\",key:\"123xd1\"}],[\"path\",{d:\"M22 10v3\",key:\"154ddg\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const of=Ne(\"Award\",[[\"path\",{d:\"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526\",key:\"1yiouv\"}],[\"circle\",{cx:\"12\",cy:\"8\",r:\"6\",key:\"1vp47v\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const qp=Ne(\"Beef\",[[\"circle\",{cx:\"12.5\",cy:\"8.5\",r:\"2.5\",key:\"9738u8\"}],[\"path\",{d:\"M12.5 2a6.5 6.5 0 0 0-6.22 4.6c-1.1 3.13-.78 3.9-3.18 6.08A3 3 0 0 0 5 18c4 0 8.4-1.8 11.4-4.3A6.5 6.5 0 0 0 12.5 2Z\",key:\"o0f6za\"}],[\"path\",{d:\"m18.5 6 2.19 4.5a6.48 6.48 0 0 1 .31 2 6.49 6.49 0 0 1-2.6 5.2C15.4 20.2 11 22 7 22a3 3 0 0 1-2.68-1.66L2.4 16.5\",key:\"k7p6i0\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const GA=Ne(\"Beer\",[[\"path\",{d:\"M17 11h1a3 3 0 0 1 0 6h-1\",key:\"1yp76v\"}],[\"path\",{d:\"M9 12v6\",key:\"1u1cab\"}],[\"path\",{d:\"M13 12v6\",key:\"1sugkk\"}],[\"path\",{d:\"M14 7.5c-1 0-1.44.5-3 .5s-2-.5-3-.5-1.72.5-2.5.5a2.5 2.5 0 0 1 0-5c.78 0 1.57.5 2.5.5S9.44 2 11 2s2 1.5 3 1.5 1.72-.5 2.5-.5a2.5 2.5 0 0 1 0 5c-.78 0-1.5-.5-2.5-.5Z\",key:\"1510fo\"}],[\"path\",{d:\"M5 8v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V8\",key:\"19jb7n\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Wk=Ne(\"Bell\",[[\"path\",{d:\"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9\",key:\"1qo2s2\"}],[\"path\",{d:\"M10.3 21a1.94 1.94 0 0 0 3.4 0\",key:\"qgo35s\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const zv=Ne(\"BookOpen\",[[\"path\",{d:\"M12 7v14\",key:\"1akyts\"}],[\"path\",{d:\"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z\",key:\"ruj8y\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Tx=Ne(\"Book\",[[\"path\",{d:\"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20\",key:\"k3hazp\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Sne=Ne(\"Bookmark\",[[\"path\",{d:\"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z\",key:\"1fy3hk\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const qk=Ne(\"Bot\",[[\"path\",{d:\"M12 8V4H8\",key:\"hb8ula\"}],[\"rect\",{width:\"16\",height:\"12\",x:\"4\",y:\"8\",rx:\"2\",key:\"enze0r\"}],[\"path\",{d:\"M2 14h2\",key:\"vft8re\"}],[\"path\",{d:\"M20 14h2\",key:\"4cs60a\"}],[\"path\",{d:\"M15 13v2\",key:\"1xurst\"}],[\"path\",{d:\"M9 13v2\",key:\"rq6x2g\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const cu=Ne(\"Brain\",[[\"path\",{d:\"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z\",key:\"l5xja\"}],[\"path\",{d:\"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z\",key:\"ep3f8r\"}],[\"path\",{d:\"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4\",key:\"1p4c4q\"}],[\"path\",{d:\"M17.599 6.5a3 3 0 0 0 .399-1.375\",key:\"tmeiqw\"}],[\"path\",{d:\"M6.003 5.125A3 3 0 0 0 6.401 6.5\",key:\"105sqy\"}],[\"path\",{d:\"M3.477 10.896a4 4 0 0 1 .585-.396\",key:\"ql3yin\"}],[\"path\",{d:\"M19.938 10.5a4 4 0 0 1 .585.396\",key:\"1qfode\"}],[\"path\",{d:\"M6 18a4 4 0 0 1-1.967-.516\",key:\"2e4loj\"}],[\"path\",{d:\"M19.967 17.484A4 4 0 0 1 18 18\",key:\"159ez6\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const sf=Ne(\"Calculator\",[[\"rect\",{width:\"16\",height:\"20\",x:\"4\",y:\"2\",rx:\"2\",key:\"1nb95v\"}],[\"line\",{x1:\"8\",x2:\"16\",y1:\"6\",y2:\"6\",key:\"x4nwl0\"}],[\"line\",{x1:\"16\",x2:\"16\",y1:\"14\",y2:\"18\",key:\"wjye3r\"}],[\"path\",{d:\"M16 10h.01\",key:\"1m94wz\"}],[\"path\",{d:\"M12 10h.01\",key:\"1nrarc\"}],[\"path\",{d:\"M8 10h.01\",key:\"19clt8\"}],[\"path\",{d:\"M12 14h.01\",key:\"1etili\"}],[\"path\",{d:\"M8 14h.01\",key:\"6423bh\"}],[\"path\",{d:\"M12 18h.01\",key:\"mhygvu\"}],[\"path\",{d:\"M8 18h.01\",key:\"lrp35t\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const no=Ne(\"Calendar\",[[\"path\",{d:\"M8 2v4\",key:\"1cmpym\"}],[\"path\",{d:\"M16 2v4\",key:\"4m81vk\"}],[\"rect\",{width:\"18\",height:\"18\",x:\"3\",y:\"4\",rx:\"2\",key:\"1hopcy\"}],[\"path\",{d:\"M3 10h18\",key:\"8toen8\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Do=Ne(\"Camera\",[[\"path\",{d:\"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z\",key:\"1tc9qg\"}],[\"circle\",{cx:\"12\",cy:\"13\",r:\"3\",key:\"1vg3eu\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const _ne=Ne(\"ChartPie\",[[\"path\",{d:\"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z\",key:\"pzmjnu\"}],[\"path\",{d:\"M21.21 15.89A10 10 0 1 1 8 2.83\",key:\"k2fpak\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Cs=Ne(\"Check\",[[\"path\",{d:\"M20 6 9 17l-5-5\",key:\"1gmf2c\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Ta=Ne(\"ChefHat\",[[\"path\",{d:\"M17 21a1 1 0 0 0 1-1v-5.35c0-.457.316-.844.727-1.041a4 4 0 0 0-2.134-7.589 5 5 0 0 0-9.186 0 4 4 0 0 0-2.134 7.588c.411.198.727.585.727 1.041V20a1 1 0 0 0 1 1Z\",key:\"1qvrer\"}],[\"path\",{d:\"M6 17h12\",key:\"1jwigz\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const bs=Ne(\"ChevronDown\",[[\"path\",{d:\"m6 9 6 6 6-6\",key:\"qrunsl\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Gg=Ne(\"ChevronRight\",[[\"path\",{d:\"m9 18 6-6-6-6\",key:\"mthhwq\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Pj=Ne(\"ChevronUp\",[[\"path\",{d:\"m18 15-6-6-6 6\",key:\"153udz\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const tU=Ne(\"CircleAlert\",[[\"circle\",{cx:\"12\",cy:\"12\",r:\"10\",key:\"1mglay\"}],[\"line\",{x1:\"12\",x2:\"12\",y1:\"8\",y2:\"12\",key:\"1pkeuh\"}],[\"line\",{x1:\"12\",x2:\"12.01\",y1:\"16\",y2:\"16\",key:\"4dfq90\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Yi=Ne(\"CircleCheckBig\",[[\"path\",{d:\"M21.801 10A10 10 0 1 1 17 3.335\",key:\"yps3ct\"}],[\"path\",{d:\"m9 11 3 3L22 4\",key:\"1pflzl\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Oj=Ne(\"CircleHelp\",[[\"circle\",{cx:\"12\",cy:\"12\",r:\"10\",key:\"1mglay\"}],[\"path\",{d:\"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3\",key:\"1u773s\"}],[\"path\",{d:\"M12 17h.01\",key:\"p32p05\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const md=Ne(\"CircleX\",[[\"circle\",{cx:\"12\",cy:\"12\",r:\"10\",key:\"1mglay\"}],[\"path\",{d:\"m15 9-6 6\",key:\"1uzhvr\"}],[\"path\",{d:\"m9 9 6 6\",key:\"z0biqf\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const s0=Ne(\"Clock\",[[\"circle\",{cx:\"12\",cy:\"12\",r:\"10\",key:\"1mglay\"}],[\"polyline\",{points:\"12 6 12 12 16 14\",key:\"68esgv\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Od=Ne(\"Coffee\",[[\"path\",{d:\"M10 2v2\",key:\"7u0qdc\"}],[\"path\",{d:\"M14 2v2\",key:\"6buw04\"}],[\"path\",{d:\"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1\",key:\"pwadti\"}],[\"path\",{d:\"M6 2v2\",key:\"colzsn\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const rU=Ne(\"Download\",[[\"path\",{d:\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\",key:\"ih7n3h\"}],[\"polyline\",{points:\"7 10 12 15 17 10\",key:\"2ggqvy\"}],[\"line\",{x1:\"12\",x2:\"12\",y1:\"15\",y2:\"3\",key:\"1vk2je\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const lo=Ne(\"Droplets\",[[\"path\",{d:\"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z\",key:\"1ptgy4\"}],[\"path\",{d:\"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97\",key:\"1sl1rz\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const kj=Ne(\"ExternalLink\",[[\"path\",{d:\"M15 3h6v6\",key:\"1q9fwt\"}],[\"path\",{d:\"M10 14 21 3\",key:\"gplh6r\"}],[\"path\",{d:\"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6\",key:\"a6xqqp\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const nU=Ne(\"FileText\",[[\"path\",{d:\"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z\",key:\"1rqfz7\"}],[\"path\",{d:\"M14 2v4a2 2 0 0 0 2 2h4\",key:\"tnqrlb\"}],[\"path\",{d:\"M10 9H8\",key:\"b1mrlr\"}],[\"path\",{d:\"M16 13H8\",key:\"t4e002\"}],[\"path\",{d:\"M16 17H8\",key:\"z1uh3a\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Ij=Ne(\"Filter\",[[\"polygon\",{points:\"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3\",key:\"1yg77f\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Ul=Ne(\"Flame\",[[\"path\",{d:\"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z\",key:\"96xj49\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const KA=Ne(\"GlassWater\",[[\"path\",{d:\"M15.2 22H8.8a2 2 0 0 1-2-1.79L5 3h14l-1.81 17.21A2 2 0 0 1 15.2 22Z\",key:\"48rfw3\"}],[\"path\",{d:\"M6 12a5 5 0 0 1 6 0 5 5 0 0 0 6 0\",key:\"mjntcy\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Hp=Ne(\"Heart\",[[\"path\",{d:\"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z\",key:\"c3ymky\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const iU=Ne(\"History\",[[\"path\",{d:\"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8\",key:\"1357e3\"}],[\"path\",{d:\"M3 3v5h5\",key:\"1xhq8a\"}],[\"path\",{d:\"M12 7v5l4 2\",key:\"1fdv2h\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Hk=Ne(\"Image\",[[\"rect\",{width:\"18\",height:\"18\",x:\"3\",y:\"3\",rx:\"2\",ry:\"2\",key:\"1m3agn\"}],[\"circle\",{cx:\"9\",cy:\"9\",r:\"2\",key:\"af1f0g\"}],[\"path\",{d:\"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21\",key:\"1xmnt7\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Cne=Ne(\"Images\",[[\"path\",{d:\"M18 22H4a2 2 0 0 1-2-2V6\",key:\"pblm9e\"}],[\"path\",{d:\"m22 13-1.296-1.296a2.41 2.41 0 0 0-3.408 0L11 18\",key:\"nf6bnh\"}],[\"circle\",{cx:\"12\",cy:\"8\",r:\"2\",key:\"1822b1\"}],[\"rect\",{width:\"16\",height:\"16\",x:\"6\",y:\"2\",rx:\"2\",key:\"12espp\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Il=Ne(\"Info\",[[\"circle\",{cx:\"12\",cy:\"12\",r:\"10\",key:\"1mglay\"}],[\"path\",{d:\"M12 16v-4\",key:\"1dtifu\"}],[\"path\",{d:\"M12 8h.01\",key:\"e9boi3\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const aU=Ne(\"Keyboard\",[[\"path\",{d:\"M10 8h.01\",key:\"1r9ogq\"}],[\"path\",{d:\"M12 12h.01\",key:\"1mp3jc\"}],[\"path\",{d:\"M14 8h.01\",key:\"1primd\"}],[\"path\",{d:\"M16 12h.01\",key:\"1l6xoz\"}],[\"path\",{d:\"M18 8h.01\",key:\"emo2bl\"}],[\"path\",{d:\"M6 8h.01\",key:\"x9i8wu\"}],[\"path\",{d:\"M7 16h10\",key:\"wp8him\"}],[\"path\",{d:\"M8 12h.01\",key:\"czm47f\"}],[\"rect\",{width:\"20\",height:\"16\",x:\"2\",y:\"4\",rx:\"2\",key:\"18n3k1\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const zl=Ne(\"Lightbulb\",[[\"path\",{d:\"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5\",key:\"1gvzjb\"}],[\"path\",{d:\"M9 18h6\",key:\"x1upvd\"}],[\"path\",{d:\"M10 22h4\",key:\"ceow96\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Gk=Ne(\"LogIn\",[[\"path\",{d:\"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4\",key:\"u53s6r\"}],[\"polyline\",{points:\"10 17 15 12 10 7\",key:\"1ail0h\"}],[\"line\",{x1:\"15\",x2:\"3\",y1:\"12\",y2:\"12\",key:\"v6grx8\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const oU=Ne(\"LogOut\",[[\"path\",{d:\"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4\",key:\"1uf3rs\"}],[\"polyline\",{points:\"16 17 21 12 16 7\",key:\"1gabdz\"}],[\"line\",{x1:\"21\",x2:\"9\",y1:\"12\",y2:\"12\",key:\"1uyos4\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Ane=Ne(\"MessageCircle\",[[\"path\",{d:\"M7.9 20A9 9 0 1 0 4 16.1L2 22Z\",key:\"vv11sd\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Nne=Ne(\"MessageSquare\",[[\"path\",{d:\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\",key:\"1lielz\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Wf=Ne(\"MicOff\",[[\"line\",{x1:\"2\",x2:\"22\",y1:\"2\",y2:\"22\",key:\"a6p6uj\"}],[\"path\",{d:\"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2\",key:\"80xlxr\"}],[\"path\",{d:\"M5 10v2a7 7 0 0 0 12 5\",key:\"p2k8kg\"}],[\"path\",{d:\"M15 9.34V5a3 3 0 0 0-5.68-1.33\",key:\"1gzdoj\"}],[\"path\",{d:\"M9 9v3a3 3 0 0 0 5.12 2.12\",key:\"r2i35w\"}],[\"line\",{x1:\"12\",x2:\"12\",y1:\"19\",y2:\"22\",key:\"x3vr5v\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const _i=Ne(\"Mic\",[[\"path\",{d:\"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z\",key:\"131961\"}],[\"path\",{d:\"M19 10v2a7 7 0 0 1-14 0v-2\",key:\"1vc78b\"}],[\"line\",{x1:\"12\",x2:\"12\",y1:\"19\",y2:\"22\",key:\"x3vr5v\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const sU=Ne(\"Minus\",[[\"path\",{d:\"M5 12h14\",key:\"1ays0h\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Ene=Ne(\"Monitor\",[[\"rect\",{width:\"20\",height:\"14\",x:\"2\",y:\"3\",rx:\"2\",key:\"48i651\"}],[\"line\",{x1:\"8\",x2:\"16\",y1:\"21\",y2:\"21\",key:\"1svkeh\"}],[\"line\",{x1:\"12\",x2:\"12\",y1:\"17\",y2:\"21\",key:\"vw1qmm\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const jne=Ne(\"Pause\",[[\"rect\",{x:\"14\",y:\"4\",width:\"4\",height:\"16\",rx:\"1\",key:\"zuxfzm\"}],[\"rect\",{x:\"6\",y:\"4\",width:\"4\",height:\"16\",rx:\"1\",key:\"1okwgv\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Gh=Ne(\"PenLine\",[[\"path\",{d:\"M12 20h9\",key:\"t2du7b\"}],[\"path\",{d:\"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z\",key:\"1ykcvy\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const XA=Ne(\"Pen\",[[\"path\",{d:\"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z\",key:\"1a8usu\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const YA=Ne(\"Play\",[[\"polygon\",{points:\"6 3 20 12 6 21 6 3\",key:\"1oa8hb\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const xi=Ne(\"Plus\",[[\"path\",{d:\"M5 12h14\",key:\"1ays0h\"}],[\"path\",{d:\"M12 5v14\",key:\"s699le\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const lU=Ne(\"QrCode\",[[\"rect\",{width:\"5\",height:\"5\",x:\"3\",y:\"3\",rx:\"1\",key:\"1tu5fj\"}],[\"rect\",{width:\"5\",height:\"5\",x:\"16\",y:\"3\",rx:\"1\",key:\"1v8r4q\"}],[\"rect\",{width:\"5\",height:\"5\",x:\"3\",y:\"16\",rx:\"1\",key:\"1x03jg\"}],[\"path\",{d:\"M21 16h-3a2 2 0 0 0-2 2v3\",key:\"177gqh\"}],[\"path\",{d:\"M21 21v.01\",key:\"ents32\"}],[\"path\",{d:\"M12 7v3a2 2 0 0 1-2 2H7\",key:\"8crl2c\"}],[\"path\",{d:\"M3 12h.01\",key:\"nlz23k\"}],[\"path\",{d:\"M12 3h.01\",key:\"n36tog\"}],[\"path\",{d:\"M12 16v.01\",key:\"133mhm\"}],[\"path\",{d:\"M16 12h1\",key:\"1slzba\"}],[\"path\",{d:\"M21 12v.01\",key:\"1lwtk9\"}],[\"path\",{d:\"M12 21v-1\",key:\"1880an\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Ml=Ne(\"RefreshCw\",[[\"path\",{d:\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\",key:\"v9h5vc\"}],[\"path\",{d:\"M21 3v5h-5\",key:\"1q7to0\"}],[\"path\",{d:\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\",key:\"3uifl3\"}],[\"path\",{d:\"M8 16H3v5\",key:\"1cv678\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Tne=Ne(\"RotateCcw\",[[\"path\",{d:\"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8\",key:\"1357e3\"}],[\"path\",{d:\"M3 3v5h5\",key:\"1xhq8a\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Mj=Ne(\"Save\",[[\"path\",{d:\"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z\",key:\"1c8476\"}],[\"path\",{d:\"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7\",key:\"1ydtos\"}],[\"path\",{d:\"M7 3v4a1 1 0 0 0 1 1h7\",key:\"t51u73\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const lf=Ne(\"Scale\",[[\"path\",{d:\"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z\",key:\"7g6ntu\"}],[\"path\",{d:\"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z\",key:\"ijws7r\"}],[\"path\",{d:\"M7 21h10\",key:\"1b0cd5\"}],[\"path\",{d:\"M12 3v18\",key:\"108xh3\"}],[\"path\",{d:\"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2\",key:\"3gwbw2\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Pne=Ne(\"Search\",[[\"circle\",{cx:\"11\",cy:\"11\",r:\"8\",key:\"4ej97u\"}],[\"path\",{d:\"m21 21-4.3-4.3\",key:\"1qie3q\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const One=Ne(\"Send\",[[\"path\",{d:\"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z\",key:\"1ffxy3\"}],[\"path\",{d:\"m21.854 2.147-10.94 10.939\",key:\"12cjpa\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const kne=Ne(\"Share2\",[[\"circle\",{cx:\"18\",cy:\"5\",r:\"3\",key:\"gq8acd\"}],[\"circle\",{cx:\"6\",cy:\"12\",r:\"3\",key:\"w7nqdw\"}],[\"circle\",{cx:\"18\",cy:\"19\",r:\"3\",key:\"1xt0gg\"}],[\"line\",{x1:\"8.59\",x2:\"15.42\",y1:\"13.51\",y2:\"17.49\",key:\"47mynk\"}],[\"line\",{x1:\"15.41\",x2:\"8.59\",y1:\"6.51\",y2:\"10.49\",key:\"1n3mei\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const cU=Ne(\"Shield\",[[\"path\",{d:\"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z\",key:\"oel41y\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Ine=Ne(\"Smartphone\",[[\"rect\",{width:\"14\",height:\"20\",x:\"5\",y:\"2\",rx:\"2\",ry:\"2\",key:\"1yt0o3\"}],[\"path\",{d:\"M12 18h.01\",key:\"mhygvu\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const jp=Ne(\"Sparkles\",[[\"path\",{d:\"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z\",key:\"4pj2yx\"}],[\"path\",{d:\"M20 3v4\",key:\"1olli1\"}],[\"path\",{d:\"M22 5h-4\",key:\"1gvqau\"}],[\"path\",{d:\"M4 17v2\",key:\"vumght\"}],[\"path\",{d:\"M5 18H3\",key:\"zchphs\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Mne=Ne(\"SquarePen\",[[\"path\",{d:\"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\",key:\"1m0v6g\"}],[\"path\",{d:\"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z\",key:\"ohrbg2\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const uU=Ne(\"Square\",[[\"rect\",{width:\"18\",height:\"18\",x:\"3\",y:\"3\",rx:\"2\",key:\"afitv7\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Kk=Ne(\"Star\",[[\"polygon\",{points:\"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2\",key:\"8f66p6\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Dne=Ne(\"StickyNote\",[[\"path\",{d:\"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z\",key:\"qazsjp\"}],[\"path\",{d:\"M15 3v4a2 2 0 0 0 2 2h4\",key:\"40519r\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Wv=Ne(\"Syringe\",[[\"path\",{d:\"m18 2 4 4\",key:\"22kx64\"}],[\"path\",{d:\"m17 7 3-3\",key:\"1w1zoj\"}],[\"path\",{d:\"M19 9 8.7 19.3c-1 1-2.5 1-3.4 0l-.6-.6c-1-1-1-2.5 0-3.4L15 5\",key:\"1exhtz\"}],[\"path\",{d:\"m9 11 4 4\",key:\"rovt3i\"}],[\"path\",{d:\"m5 19-3 3\",key:\"59f2uf\"}],[\"path\",{d:\"m14 4 6 6\",key:\"yqp9t2\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const ri=Ne(\"Target\",[[\"circle\",{cx:\"12\",cy:\"12\",r:\"10\",key:\"1mglay\"}],[\"circle\",{cx:\"12\",cy:\"12\",r:\"6\",key:\"1vlfrh\"}],[\"circle\",{cx:\"12\",cy:\"12\",r:\"2\",key:\"1c9p78\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const dU=Ne(\"TestTubeDiagonal\",[[\"path\",{d:\"M21 7 6.82 21.18a2.83 2.83 0 0 1-3.99-.01a2.83 2.83 0 0 1 0-4L17 3\",key:\"1ub6xw\"}],[\"path\",{d:\"m16 2 6 6\",key:\"1gw87d\"}],[\"path\",{d:\"M12 16H4\",key:\"1cjfip\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const kd=Ne(\"Trash2\",[[\"path\",{d:\"M3 6h18\",key:\"d0wm0j\"}],[\"path\",{d:\"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6\",key:\"4alrt4\"}],[\"path\",{d:\"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2\",key:\"v07s0e\"}],[\"line\",{x1:\"10\",x2:\"10\",y1:\"11\",y2:\"17\",key:\"1uufr5\"}],[\"line\",{x1:\"14\",x2:\"14\",y1:\"11\",y2:\"17\",key:\"xtxkd\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const qv=Ne(\"TrendingDown\",[[\"polyline\",{points:\"22 17 13.5 8.5 8.5 13.5 2 7\",key:\"1r2t7k\"}],[\"polyline\",{points:\"16 17 22 17 22 11\",key:\"11uiuu\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Li=Ne(\"TrendingUp\",[[\"polyline\",{points:\"22 7 13.5 15.5 8.5 10.5 2 17\",key:\"126l90\"}],[\"polyline\",{points:\"16 7 22 7 22 13\",key:\"kwv8wd\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const ys=Ne(\"TriangleAlert\",[[\"path\",{d:\"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3\",key:\"wmoenq\"}],[\"path\",{d:\"M12 9v4\",key:\"juzpu7\"}],[\"path\",{d:\"M12 17h.01\",key:\"p32p05\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const jv=Ne(\"Trophy\",[[\"path\",{d:\"M6 9H4.5a2.5 2.5 0 0 1 0-5H6\",key:\"17hqa7\"}],[\"path\",{d:\"M18 9h1.5a2.5 2.5 0 0 0 0-5H18\",key:\"lmptdp\"}],[\"path\",{d:\"M4 22h16\",key:\"57wxv0\"}],[\"path\",{d:\"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22\",key:\"1nw9bq\"}],[\"path\",{d:\"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22\",key:\"1np0yb\"}],[\"path\",{d:\"M18 2H6v7a6 6 0 0 0 12 0V2Z\",key:\"u46fv3\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Rne=Ne(\"Type\",[[\"polyline\",{points:\"4 7 4 4 20 4 20 7\",key:\"1nosan\"}],[\"line\",{x1:\"9\",x2:\"15\",y1:\"20\",y2:\"20\",key:\"swin9y\"}],[\"line\",{x1:\"12\",x2:\"12\",y1:\"4\",y2:\"20\",key:\"1tx1rr\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Id=Ne(\"User\",[[\"path\",{d:\"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2\",key:\"975kel\"}],[\"circle\",{cx:\"12\",cy:\"7\",r:\"4\",key:\"17ys0d\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const ZA=Ne(\"Users\",[[\"path\",{d:\"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2\",key:\"1yyitq\"}],[\"circle\",{cx:\"9\",cy:\"7\",r:\"4\",key:\"nufk8\"}],[\"path\",{d:\"M22 21v-2a4 4 0 0 0-3-3.87\",key:\"kshegd\"}],[\"path\",{d:\"M16 3.13a4 4 0 0 1 0 7.75\",key:\"1da9ce\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const uu=Ne(\"Utensils\",[[\"path\",{d:\"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2\",key:\"cjf0a3\"}],[\"path\",{d:\"M7 2v20\",key:\"1473qp\"}],[\"path\",{d:\"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7\",key:\"j28e5\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Dj=Ne(\"Volume2\",[[\"path\",{d:\"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z\",key:\"uqj9uw\"}],[\"path\",{d:\"M16 9a5 5 0 0 1 0 6\",key:\"1q6k2b\"}],[\"path\",{d:\"M19.364 18.364a9 9 0 0 0 0-12.728\",key:\"ijwkga\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Fne=Ne(\"VolumeX\",[[\"path\",{d:\"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z\",key:\"uqj9uw\"}],[\"line\",{x1:\"22\",x2:\"16\",y1:\"9\",y2:\"15\",key:\"1ewh16\"}],[\"line\",{x1:\"16\",x2:\"22\",y1:\"9\",y2:\"15\",key:\"5ykzw1\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Gp=Ne(\"Wheat\",[[\"path\",{d:\"M2 22 16 8\",key:\"60hf96\"}],[\"path\",{d:\"M3.47 12.53 5 11l1.53 1.53a3.5 3.5 0 0 1 0 4.94L5 19l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z\",key:\"1rdhi6\"}],[\"path\",{d:\"M7.47 8.53 9 7l1.53 1.53a3.5 3.5 0 0 1 0 4.94L9 15l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z\",key:\"1sdzmb\"}],[\"path\",{d:\"M11.47 4.53 13 3l1.53 1.53a3.5 3.5 0 0 1 0 4.94L13 11l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z\",key:\"eoatbi\"}],[\"path\",{d:\"M20 2h2v2a4 4 0 0 1-4 4h-2V6a4 4 0 0 1 4-4Z\",key:\"19rau1\"}],[\"path\",{d:\"M11.47 17.47 13 19l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L5 19l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z\",key:\"tc8ph9\"}],[\"path\",{d:\"M15.47 13.47 17 15l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L9 15l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z\",key:\"2m8kc5\"}],[\"path\",{d:\"M19.47 9.47 21 11l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L13 11l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z\",key:\"vex3ng\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Za=Ne(\"Wine\",[[\"path\",{d:\"M8 22h8\",key:\"rmew8v\"}],[\"path\",{d:\"M7 10h10\",key:\"1101jm\"}],[\"path\",{d:\"M12 15v7\",key:\"t2xh3l\"}],[\"path\",{d:\"M12 15a5 5 0 0 0 5-5c0-2-.5-4-2-8H9c-1.5 4-2 6-2 8a5 5 0 0 0 5 5Z\",key:\"10ffi3\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Wl=Ne(\"X\",[[\"path\",{d:\"M18 6 6 18\",key:\"1bl5f8\"}],[\"path\",{d:\"m6 6 12 12\",key:\"d8bk6v\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Lne=Ne(\"ZapOff\",[[\"path\",{d:\"M10.513 4.856 13.12 2.17a.5.5 0 0 1 .86.46l-1.377 4.317\",key:\"193nxd\"}],[\"path\",{d:\"M15.656 10H20a1 1 0 0 1 .78 1.63l-1.72 1.773\",key:\"27a7lr\"}],[\"path\",{d:\"M16.273 16.273 10.88 21.83a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14H4a1 1 0 0 1-.78-1.63l4.507-4.643\",key:\"1e0qe9\"}],[\"path\",{d:\"m2 2 20 20\",key:\"1ooewy\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const du=Ne(\"Zap\",[[\"path\",{d:\"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z\",key:\"1xq2db\"}]]),Bne=\"/assets/platemate-logo-D4AL1-s7.png\";function fU(){const t=Pn.isNativePlatform(),e=Pn.getPlatform();return{isNative:t,platform:e}}async function hU(){const t=fU();if(console.log(\"ðŸ” Launch signup - isNative:\",t.isNative,\"platform:\",t.platform),t.isNative){console.log(\"ðŸ“± Mobile: Opening OAuth signup in system browser with deep-link return\");const n=`https://nutri-snap-1-georgebrennan93.replit.app/api/signup?returnUrl=${encodeURIComponent(\"platemate://auth-complete\")}`;console.log(\"ðŸ”— Signup URL:\",n),console.log(\"ðŸ” Browser plugin available:\",typeof Wp<\"u\");try{console.log(\"ðŸš€ Calling Browser.open()...\");const i=await Wp.open({url:n,windowName:\"_system\",toolbarColor:\"#8B5CF6\",presentationStyle:\"popover\"});console.log(\"âœ… Browser.open() returned:\",i)}catch(i){console.error(\"âŒ Failed to open OAuth signup browser:\",i),alert(`Error opening browser: ${i instanceof Error?i.message:String(i)}`)}}else console.log(\"ðŸŒ Web: Navigating to OAuth signup\"),window.location.href=\"/api/signup\"}async function QA(){const t=fU();if(console.log(\"ðŸ” Launch login - isNative:\",t.isNative,\"platform:\",t.platform),t.isNative){console.log(\"ðŸ“± Mobile: Opening OAuth in system browser with deep-link return\");const n=`https://nutri-snap-1-georgebrennan93.replit.app/api/login?returnUrl=${encodeURIComponent(\"platemate://auth-complete\")}`;console.log(\"ðŸ”— Login URL:\",n),console.log(\"ðŸ” Browser plugin available:\",typeof Wp<\"u\");try{console.log(\"ðŸš€ Calling Browser.open()...\");const i=await Wp.open({url:n,windowName:\"_system\",toolbarColor:\"#8B5CF6\",presentationStyle:\"popover\"});console.log(\"âœ… Browser.open() returned:\",i)}catch(i){console.error(\"âŒ Failed to open OAuth browser:\",i),alert(`Error opening browser: ${i instanceof Error?i.message:String(i)}`)}}else console.log(\"ðŸŒ Web: Navigating to OAuth login\"),window.location.href=\"/api/login\"}function Rj(){const{user:t,isAuthenticated:e}=o0(),[r,n]=E.useState(!1),i=E.useRef(null);return E.useEffect(()=>{const a=o=>{i.current&&!i.current.contains(o.target)&&n(!1)};return r&&document.addEventListener(\"mousedown\",a),()=>{document.removeEventListener(\"mousedown\",a)}},[r]),l.jsx(\"header\",{className:\"modern-card glass-enhanced border-b border-border/50 p-4 backdrop-blur-md sticky top-0 z-50\",children:l.jsxs(\"div\",{className:\"max-w-md mx-auto flex items-center justify-between\",children:[l.jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[l.jsx(\"div\",{className:\"w-12 h-12 rounded-xl overflow-hidden shadow-lg\",children:l.jsx(\"img\",{src:Bne,alt:\"PlateMate Logo\",className:\"w-full h-full object-contain\",\"data-testid\":\"logo-platemate\"})}),l.jsxs(\"div\",{className:\"flex flex-col\",children:[l.jsx(\"h1\",{className:\"text-2xl font-bold gradient-text\",children:\"PlateMate\"}),l.jsx(\"p\",{className:\"text-xs text-muted-foreground\",children:\"Voice-powered nutrition companion\"})]})]}),l.jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[!e&&l.jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[l.jsx(\"button\",{className:\"p-2 px-4 rounded-xl bg-gradient-to-br from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-medium text-sm backdrop-blur-sm hover:scale-105 smooth-transition border border-blue-400/30 shadow-md\",\"data-testid\":\"button-login\",title:\"Sign in with Replit\",onClick:QA,children:\"Sign In\"}),l.jsx(\"button\",{className:\"p-2 px-4 rounded-xl bg-gradient-to-br from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-medium text-sm backdrop-blur-sm hover:scale-105 smooth-transition border border-green-400/30 shadow-md\",\"data-testid\":\"button-signup\",title:\"Create a Replit account\",onClick:hU,children:\"Sign Up\"})]}),e&&t&&l.jsxs(\"div\",{className:\"relative mr-2\",ref:i,children:[l.jsxs(\"button\",{onClick:()=>n(!r),className:\"flex items-center space-x-1 p-3 rounded-xl bg-gradient-to-br from-white/10 to-white/5 dark:from-gray-800/50 dark:to-gray-700/30 backdrop-blur-sm hover:scale-110 smooth-transition border border-white/10 dark:border-gray-700/30\",\"data-testid\":\"button-profile\",title:\"Profile\",children:[l.jsx(Id,{className:\"h-5 w-5 text-foreground/80\"}),r?l.jsx(Pj,{className:\"h-3 w-3 text-foreground/60\"}):l.jsx(bs,{className:\"h-3 w-3 text-foreground/60\"})]}),r&&l.jsxs(\"div\",{className:\"absolute top-full right-0 mt-2 bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 p-3 min-w-[200px] backdrop-blur-md z-50\",children:[l.jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[l.jsx(Id,{className:\"h-4 w-4 text-foreground/80\"}),l.jsx(\"span\",{className:\"text-sm font-medium text-foreground/90\",children:(t==null?void 0:t.firstName)||(t==null?void 0:t.email)||\"User\"})]}),(t==null?void 0:t.email)&&(t==null?void 0:t.firstName)&&l.jsx(\"div\",{className:\"text-xs text-foreground/60 mt-1 ml-6\",children:t==null?void 0:t.email})]})]}),l.jsx(\"button\",{className:\"p-3 rounded-xl bg-gradient-to-br from-white/10 to-white/5 dark:from-gray-800/50 dark:to-gray-700/30 backdrop-blur-sm hover:scale-110 smooth-transition border border-white/10 dark:border-gray-700/30\",\"data-testid\":\"button-history\",title:\"View History\",children:l.jsx(iU,{className:\"h-5 w-5 text-foreground/80\"})}),e&&l.jsx(\"a\",{href:\"/api/logout\",children:l.jsx(\"button\",{className:\"p-3 rounded-xl bg-gradient-to-br from-red-100/50 to-red-200/30 dark:from-red-900/20 dark:to-red-800/10 backdrop-blur-sm hover:scale-110 smooth-transition border border-red-200/30 dark:border-red-700/20 hover:from-red-200/70 hover:to-red-300/50\",\"data-testid\":\"button-logout\",title:\"Logout\",children:l.jsx(oU,{className:\"h-5 w-5 text-red-600 dark:text-red-400\"})})})]})]})})}class $ne{constructor(){this.audioContext=null,this.sounds=new Map,this.enabled=!0,this.loadSoundSettings()}loadSoundSettings(){const e=localStorage.getItem(\"platemate-sounds-enabled\");this.enabled=e!==\"false\"}async initialize(){try{this.audioContext=new(window.AudioContext||window.webkitAudioContext),await this.generateSounds(),console.log(\"âœ“ Sound service initialized\")}catch(e){console.warn(\"Sound initialization failed:\",e)}}async generateSounds(){if(!this.audioContext)return;const e={notification:()=>this.generateTone(800,.3,\"sine\"),success:()=>this.generateChord([523,659,784],.4),error:()=>this.generateTone(200,.5,\"square\"),click:()=>this.generateTone(1e3,.1,\"sine\"),scan:()=>this.generateSweep(600,1200,.3),achievement:()=>this.generateMelody([523,659,784,1047],.6),reminder:()=>this.generateGentleTone(440,.5)};for(const[r,n]of Object.entries(e))try{const i=n();this.sounds.set(r,i)}catch(i){console.warn(`Failed to generate ${r} sound:`,i)}}generateTone(e,r,n=\"sine\"){if(!this.audioContext)throw new Error(\"Audio context not initialized\");const i=this.audioContext.sampleRate,a=i*r,o=this.audioContext.createBuffer(1,a,i),s=o.getChannelData(0);for(let c=0;c<a;c++){const u=c/i;let f=0;switch(n){case\"sine\":f=Math.sin(2*Math.PI*e*u);break;case\"square\":f=Math.sin(2*Math.PI*e*u)>0?1:-1;break;case\"triangle\":f=2/Math.PI*Math.asin(Math.sin(2*Math.PI*e*u));break}const h=Math.sin(Math.PI*c/a);s[c]=f*h*.3}return o}generateChord(e,r){if(!this.audioContext)throw new Error(\"Audio context not initialized\");const n=this.audioContext.sampleRate,i=n*r,a=this.audioContext.createBuffer(1,i,n),o=a.getChannelData(0);for(let s=0;s<i;s++){const c=s/n;let u=0;for(const h of e)u+=Math.sin(2*Math.PI*h*c)/e.length;const f=Math.sin(Math.PI*s/i);o[s]=u*f*.3}return a}generateSweep(e,r,n){if(!this.audioContext)throw new Error(\"Audio context not initialized\");const i=this.audioContext.sampleRate,a=i*n,o=this.audioContext.createBuffer(1,a,i),s=o.getChannelData(0);for(let c=0;c<a;c++){const u=c/a,f=e+(r-e)*u,h=c/i,m=Math.sin(2*Math.PI*f*h),g=Math.sin(Math.PI*c/a);s[c]=m*g*.2}return o}generateMelody(e,r){if(!this.audioContext)throw new Error(\"Audio context not initialized\");const n=this.audioContext.sampleRate,i=n*r,a=i/e.length,o=this.audioContext.createBuffer(1,i,n),s=o.getChannelData(0);return e.forEach((c,u)=>{const f=Math.floor(u*a),h=Math.floor((u+1)*a);for(let m=f;m<h&&m<i;m++){const g=m-f,x=h-f,v=g/n,b=Math.sin(2*Math.PI*c*v),w=Math.sin(Math.PI*g/x);s[m]=b*w*.25}}),o}generateGentleTone(e,r){if(!this.audioContext)throw new Error(\"Audio context not initialized\");const n=this.audioContext.sampleRate,i=n*r,a=this.audioContext.createBuffer(1,i,n),o=a.getChannelData(0);for(let s=0;s<i;s++){const c=s/n,u=Math.sin(2*Math.PI*e*c),f=Math.sin(2*Math.PI*e*2*c)*.3,h=Math.sin(2*Math.PI*e*3*c)*.1;let m=u+f+h;const g=Math.pow(Math.sin(Math.PI*s/i),2);o[s]=m*g*.2}return a}async play(e,r=1){if(!(!this.enabled||!this.audioContext||!this.sounds.has(e)))try{this.audioContext.state===\"suspended\"&&await this.audioContext.resume();const n=this.sounds.get(e),i=this.audioContext.createBufferSource(),a=this.audioContext.createGain();i.buffer=n,a.gain.value=Math.min(Math.max(r,0),1)*.5,i.connect(a),a.connect(this.audioContext.destination),i.start()}catch(n){console.warn(`Failed to play ${e} sound:`,n)}}setEnabled(e){this.enabled=e,localStorage.setItem(\"platemate-sounds-enabled\",e.toString())}isEnabled(){return this.enabled}async playSuccess(){await this.play(\"success\")}async playError(){await this.play(\"error\")}async playClick(){await this.play(\"click\",.3)}async playNotification(){await this.play(\"notification\")}async playAchievement(){await this.play(\"achievement\")}async playScan(){await this.play(\"scan\")}async playReminder(){await this.play(\"reminder\")}}const Nr=new $ne;var To;(function(t){t.Prompt=\"PROMPT\",t.Camera=\"CAMERA\",t.Photos=\"PHOTOS\"})(To||(To={}));var Tp;(function(t){t.Rear=\"REAR\",t.Front=\"FRONT\"})(Tp||(Tp={}));var cf;(function(t){t.Uri=\"uri\",t.Base64=\"base64\",t.DataUrl=\"dataUrl\"})(cf||(cf={}));class Vne extends Tj{async getPhoto(e){return new Promise(async(r,n)=>{if(e.webUseInput||e.source===To.Photos)this.fileInputExperience(e,r,n);else if(e.source===To.Prompt){let i=document.querySelector(\"pwa-action-sheet\");i||(i=document.createElement(\"pwa-action-sheet\"),document.body.appendChild(i)),i.header=e.promptLabelHeader||\"Photo\",i.cancelable=!1,i.options=[{title:e.promptLabelPhoto||\"From Photos\"},{title:e.promptLabelPicture||\"Take Picture\"}],i.addEventListener(\"onSelection\",async a=>{a.detail===0?this.fileInputExperience(e,r,n):this.cameraExperience(e,r,n)})}else this.cameraExperience(e,r,n)})}async pickImages(e){return new Promise(async(r,n)=>{this.multipleFileInputExperience(r,n)})}async cameraExperience(e,r,n){if(customElements.get(\"pwa-camera-modal\")){const i=document.createElement(\"pwa-camera-modal\");i.facingMode=e.direction===Tp.Front?\"user\":\"environment\",document.body.appendChild(i);try{await i.componentOnReady(),i.addEventListener(\"onPhoto\",async a=>{const o=a.detail;o===null?n(new Pd(\"User cancelled photos app\")):o instanceof Error?n(o):r(await this._getCameraPhoto(o,e)),i.dismiss(),document.body.removeChild(i)}),i.present()}catch{this.fileInputExperience(e,r,n)}}else console.error(\"Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements.\"),this.fileInputExperience(e,r,n)}fileInputExperience(e,r,n){let i=document.querySelector(\"#_capacitor-camera-input\");const a=()=>{var o;(o=i.parentNode)===null||o===void 0||o.removeChild(i)};i||(i=document.createElement(\"input\"),i.id=\"_capacitor-camera-input\",i.type=\"file\",i.hidden=!0,document.body.appendChild(i),i.addEventListener(\"change\",o=>{const s=i.files[0];let c=\"jpeg\";if(s.type===\"image/png\"?c=\"png\":s.type===\"image/gif\"&&(c=\"gif\"),e.resultType===\"dataUrl\"||e.resultType===\"base64\"){const u=new FileReader;u.addEventListener(\"load\",()=>{if(e.resultType===\"dataUrl\")r({dataUrl:u.result,format:c});else if(e.resultType===\"base64\"){const f=u.result.split(\",\")[1];r({base64String:f,format:c})}a()}),u.readAsDataURL(s)}else r({webPath:URL.createObjectURL(s),format:c}),a()}),i.addEventListener(\"cancel\",o=>{n(new Pd(\"User cancelled photos app\")),a()})),i.accept=\"image/*\",i.capture=!0,e.source===To.Photos||e.source===To.Prompt?i.removeAttribute(\"capture\"):e.direction===Tp.Front?i.capture=\"user\":e.direction===Tp.Rear&&(i.capture=\"environment\"),i.click()}multipleFileInputExperience(e,r){let n=document.querySelector(\"#_capacitor-camera-input-multiple\");const i=()=>{var a;(a=n.parentNode)===null||a===void 0||a.removeChild(n)};n||(n=document.createElement(\"input\"),n.id=\"_capacitor-camera-input-multiple\",n.type=\"file\",n.hidden=!0,n.multiple=!0,document.body.appendChild(n),n.addEventListener(\"change\",a=>{const o=[];for(let s=0;s<n.files.length;s++){const c=n.files[s];let u=\"jpeg\";c.type===\"image/png\"?u=\"png\":c.type===\"image/gif\"&&(u=\"gif\"),o.push({webPath:URL.createObjectURL(c),format:u})}e({photos:o}),i()}),n.addEventListener(\"cancel\",a=>{r(new Pd(\"User cancelled photos app\")),i()})),n.accept=\"image/*\",n.click()}_getCameraPhoto(e,r){return new Promise((n,i)=>{const a=new FileReader,o=e.type.split(\"/\")[1];r.resultType===\"uri\"?n({webPath:URL.createObjectURL(e),format:o,saved:!1}):(a.readAsDataURL(e),a.onloadend=()=>{const s=a.result;r.resultType===\"dataUrl\"?n({dataUrl:s,format:o,saved:!1}):n({base64String:s.split(\",\")[1],format:o,saved:!1})},a.onerror=s=>{i(s)})})}async checkPermissions(){if(typeof navigator>\"u\"||!navigator.permissions)throw this.unavailable(\"Permissions API not available in this browser\");try{return{camera:(await window.navigator.permissions.query({name:\"camera\"})).state,photos:\"granted\"}}catch{throw this.unavailable(\"Camera permissions are not available in this browser\")}}async requestPermissions(){throw this.unimplemented(\"Not implemented on web.\")}async pickLimitedLibraryPhotos(){throw this.unavailable(\"Not implemented on web.\")}async getLimitedLibraryPhotos(){throw this.unavailable(\"Not implemented on web.\")}}const mp=Nu(\"Camera\",{web:()=>new Vne}),pU=Nu(\"Device\",{web:()=>zf(()=>import(\"./web-B2h_UMIc.js\"),[]).then(t=>new t.DeviceWeb)});class gd{constructor(){this.cameraStream=null,this.microphoneStream=null,this.mediaRecorder=null,this.recordingChunks=[],this.audioContext=null,this.isMediaRecorderSupported=!1,this.availableCameras=[],this.currentCameraIndex=0,this.isMediaRecorderSupported=this.checkMediaRecorderSupport()}static getInstance(){return gd.instance||(gd.instance=new gd),gd.instance}isMediaSupported(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}isSecureContext(){return window.isSecureContext||location.protocol===\"https:\"||location.hostname===\"localhost\"}checkMediaRecorderSupport(){if(typeof MediaRecorder>\"u\")return console.warn(\"âš ï¸ MediaRecorder not available in this browser\"),!1;const r=[\"audio/webm;codecs=opus\",\"audio/webm\",\"audio/mp4\",\"audio/ogg;codecs=opus\",\"audio/wav\"].find(n=>MediaRecorder.isTypeSupported(n));return r?(console.log(\"âœ… MediaRecorder supported with type:\",r),!0):(console.warn(\"âš ï¸ No supported MediaRecorder MIME types found\"),!1)}async getAvailableCameras(){if(!this.isMediaSupported())return[];try{const e=await navigator.mediaDevices.enumerateDevices();return this.availableCameras=e.filter(r=>r.kind===\"videoinput\"),console.log(\"ðŸ“¹ Available cameras:\",this.availableCameras.map(r=>({label:r.label||\"Camera\",deviceId:r.deviceId.substring(0,8)+\"...\"}))),this.availableCameras}catch(e){return console.error(\"âŒ Failed to enumerate cameras:\",e),[]}}async checkPermissions(){const e={camera:!1,microphone:!1};if(!this.isMediaSupported())return e;try{const r=await navigator.permissions.query({name:\"camera\"});e.camera=r.state===\"granted\"}catch(r){console.warn(\"Could not check camera permission:\",r)}try{const r=await navigator.permissions.query({name:\"microphone\"});e.microphone=r.state===\"granted\"}catch(r){console.warn(\"Could not check microphone permission:\",r)}return e}async startCamera(e,r={}){if(!this.isMediaSupported())throw new Error(\"Camera not supported in this browser\");try{this.cameraStream&&this.stopCamera();const n={video:{width:{ideal:r.width||1280,max:1920},height:{ideal:r.height||720,max:1080},facingMode:r.facingMode||\"environment\",aspectRatio:r.aspectRatio||16/9},audio:!1};return console.log(\"ðŸŽ¥ Requesting camera with constraints:\",n),this.cameraStream=await navigator.mediaDevices.getUserMedia(n),console.log(\"ðŸ“¹ Camera stream started successfully:\",{tracks:this.cameraStream.getTracks().length,videoTracks:this.cameraStream.getVideoTracks().length}),e.srcObject=this.cameraStream,e.playsInline=!0,e.muted=!0,await new Promise((i,a)=>{e.onloadedmetadata=()=>{console.log(\"ðŸ“ Video dimensions:\",{videoWidth:e.videoWidth,videoHeight:e.videoHeight}),i(void 0)},e.onerror=a,e.play().catch(a)}),this.cameraStream}catch(n){throw console.error(\"âŒ Camera access failed:\",n),this.handleMediaError(n,\"camera\"),n}}stopCamera(){this.cameraStream&&(console.log(\"â¹ï¸ Stopping camera stream\"),this.cameraStream.getTracks().forEach(e=>{e.stop(),console.log(`ðŸ”´ Stopped ${e.kind} track`)}),this.cameraStream=null)}async capturePhotoFromStream(e,r=.9){if(!this.cameraStream||!e.videoWidth)throw console.error(\"âŒ No active camera stream or video not ready\"),new Error(\"No active camera stream or video not ready\");try{const n=document.createElement(\"canvas\"),i=n.getContext(\"2d\");if(!i)throw new Error(\"Could not get canvas context\");return n.width=e.videoWidth,n.height=e.videoHeight,i.drawImage(e,0,0,n.width,n.height),console.log(\"ðŸ“¸ Photo captured from stream:\",{width:n.width,height:n.height,quality:r}),new Promise((a,o)=>{n.toBlob(s=>{s?a(s):o(new Error(\"Failed to create photo blob\"))},\"image/jpeg\",r)})}catch(n){throw console.error(\"âŒ Failed to capture photo:\",n),n}}async switchCamera(e){if(!this.cameraStream)throw new Error(\"No active camera stream to switch\");try{if(this.availableCameras.length===0&&await this.getAvailableCameras(),this.availableCameras.length<2)throw new Error(\"Only one camera available, cannot switch\");this.currentCameraIndex=(this.currentCameraIndex+1)%this.availableCameras.length;const r=this.availableCameras[this.currentCameraIndex];console.log(\"ðŸ”„ Switching to camera:\",{index:this.currentCameraIndex,label:r.label||\"Unknown Camera\",deviceId:r.deviceId.substring(0,8)+\"...\"}),this.stopCamera(),await this.startCameraWithDeviceId(e,r.deviceId)}catch(r){console.error(\"âŒ Failed to switch camera:\",r),await this.fallbackSwitchCamera(e)}}async fallbackSwitchCamera(e){var o;const r=(o=this.cameraStream)==null?void 0:o.getVideoTracks()[0];if(!r)throw new Error(\"No video track found for fallback switch\");const i=r.getConstraints().facingMode,a=i===\"user\"?\"environment\":\"user\";console.log(\"ðŸ”„ Fallback camera switch from\",i,\"to\",a),this.stopCamera(),await this.startCamera(e,{facingMode:a})}async startCameraWithDeviceId(e,r){const n={video:{deviceId:{exact:r},width:{ideal:1280,max:1920},height:{ideal:720,max:1080}},audio:!1};return console.log(\"ðŸ“¹ Starting camera with device ID:\",r.substring(0,8)+\"...\"),this.cameraStream=await navigator.mediaDevices.getUserMedia(n),e.srcObject=this.cameraStream,e.playsInline=!0,e.muted=!0,await new Promise((i,a)=>{e.onloadedmetadata=i,e.onerror=a,e.play().catch(a)}),this.cameraStream}async startMicrophoneRecording(e={}){if(!this.isMediaSupported())throw new Error(\"Microphone not supported in this browser\");try{this.microphoneStream&&this.stopMicrophone();const r={audio:{echoCancellation:e.echoCancellation??!0,noiseSuppression:e.noiseSuppression??!0,autoGainControl:e.autoGainControl??!0,sampleRate:e.sampleRate||44100},video:!1};return console.log(\"ðŸŽ¤ Requesting microphone with constraints:\",r),this.microphoneStream=await navigator.mediaDevices.getUserMedia(r),console.log(\"ðŸŽ™ï¸ Microphone stream started successfully:\",{tracks:this.microphoneStream.getTracks().length,audioTracks:this.microphoneStream.getAudioTracks().length}),this.microphoneStream}catch(r){throw console.error(\"âŒ Microphone access failed:\",r),this.handleMediaError(r,\"microphone\"),r}}async startAudioRecording(){if(this.microphoneStream||await this.startMicrophoneRecording(),!this.microphoneStream)throw new Error(\"No microphone stream available\");try{this.recordingChunks=[],this.isMediaRecorderSupported?await this.startMediaRecorderRecording():await this.startWebAudioRecording()}catch(e){throw console.error(\"âŒ Failed to start audio recording:\",e),e}}async startMediaRecorderRecording(){if(!this.microphoneStream)throw new Error(\"No microphone stream available\");this.mediaRecorder=new MediaRecorder(this.microphoneStream,{mimeType:this.getSupportedMimeType()}),console.log(\"ðŸŽ¬ Starting audio recording with MediaRecorder\"),this.mediaRecorder.ondataavailable=e=>{e.data.size>0&&(this.recordingChunks.push(e.data),console.log(\"ðŸ“Š Audio chunk received:\",e.data.size,\"bytes\"))},this.mediaRecorder.start(100)}async startWebAudioRecording(){if(!this.microphoneStream)throw new Error(\"No microphone stream available\");try{this.audioContext=new(window.AudioContext||window.webkitAudioContext),console.log(\"ðŸŽ¤ Starting Web Audio API recording (iOS Safari fallback)\");const e=this.audioContext.createMediaStreamSource(this.microphoneStream);this.audioContext.audioWorklet?await this.setupAudioWorkletRecording(e):this.setupScriptProcessorRecording(e)}catch(e){throw console.error(\"âŒ Failed to start Web Audio recording:\",e),e}}async setupAudioWorkletRecording(e){this.setupScriptProcessorRecording(e)}setupScriptProcessorRecording(e){if(!this.audioContext)return;const r=4096,n=this.audioContext.sampleRate,i=[],a=this.audioContext.createScriptProcessor(r,1,1);a.onaudioprocess=o=>{const c=o.inputBuffer.getChannelData(0);for(let u=0;u<c.length;u++)i.push(c[u])},e.connect(a),a.connect(this.audioContext.destination),this.scriptProcessor=a,this.recordedSamples=i,this.sampleRate=n,console.log(\"ðŸŽ™ï¸ ScriptProcessor recording setup complete\")}async stopAudioRecording(){if(this.isMediaRecorderSupported&&this.mediaRecorder)return this.stopMediaRecorderRecording();if(this.audioContext)return this.stopWebAudioRecording();throw new Error(\"No active recording to stop\")}stopMediaRecorderRecording(){return new Promise((e,r)=>{if(!this.mediaRecorder){r(new Error(\"No MediaRecorder active\"));return}this.mediaRecorder.onstop=()=>{console.log(\"â¹ï¸ MediaRecorder recording stopped, combining chunks...\");const n=new Blob(this.recordingChunks,{type:this.getSupportedMimeType()});console.log(\"ðŸŽµ Audio recording completed:\",{size:n.size,type:n.type,chunks:this.recordingChunks.length}),e(n)},this.mediaRecorder.stop()})}stopWebAudioRecording(){return new Promise((e,r)=>{try{const n=this.scriptProcessor,i=this.recordedSamples,a=this.sampleRate;if(!n||!i||!a){r(new Error(\"Web Audio recording data not found\"));return}console.log(\"â¹ï¸ Web Audio recording stopped, converting to WAV...\",{samples:i.length,sampleRate:a}),n.disconnect();const o=this.convertSamplesToWAV(i,a);console.log(\"ðŸŽµ Web Audio recording converted to WAV:\",{size:o.size,type:o.type}),delete this.scriptProcessor,delete this.recordedSamples,delete this.sampleRate,e(o)}catch(n){console.error(\"âŒ Failed to stop Web Audio recording:\",n),r(n)}})}convertSamplesToWAV(e,r){const n=e.length,i=new ArrayBuffer(44+n*2),a=new DataView(i),o=(c,u)=>{for(let f=0;f<u.length;f++)a.setUint8(c+f,u.charCodeAt(f))};o(0,\"RIFF\"),a.setUint32(4,36+n*2,!0),o(8,\"WAVE\"),o(12,\"fmt \"),a.setUint32(16,16,!0),a.setUint16(20,1,!0),a.setUint16(22,1,!0),a.setUint32(24,r,!0),a.setUint32(28,r*2,!0),a.setUint16(32,2,!0),a.setUint16(34,16,!0),o(36,\"data\"),a.setUint32(40,n*2,!0);let s=44;for(let c=0;c<n;c++){const u=Math.max(-1,Math.min(1,e[c]));a.setInt16(s,u*32767,!0),s+=2}return new Blob([i],{type:\"audio/wav\"})}stopMicrophone(){this.microphoneStream&&(console.log(\"â¹ï¸ Stopping microphone stream\"),this.microphoneStream.getTracks().forEach(e=>{e.stop(),console.log(`ðŸ”´ Stopped ${e.kind} track`)}),this.microphoneStream=null),this.mediaRecorder&&this.mediaRecorder.state!==\"inactive\"&&this.mediaRecorder.stop()}playAudio(e){const r=URL.createObjectURL(e),n=new Audio(r);return n.play().catch(i=>{console.error(\"âŒ Failed to play audio:\",i)}),n.addEventListener(\"ended\",()=>{URL.revokeObjectURL(r)}),n}getSupportedMimeType(){const e=[\"audio/webm;codecs=opus\",\"audio/webm\",\"audio/mp4\",\"audio/ogg;codecs=opus\",\"audio/wav\"];for(const r of e)if(MediaRecorder.isTypeSupported(r))return console.log(\"ðŸŽ¯ Using MIME type:\",r),r;return console.warn(\"âš ï¸ No supported MIME type found, using default\"),\"audio/webm\"}handleMediaError(e,r){let n=`Unable to access ${r}`;e.name===\"NotAllowedError\"?n=`${r.charAt(0).toUpperCase()+r.slice(1)} access was denied. Please allow ${r} permissions in your browser settings.`:e.name===\"NotFoundError\"?n=`No ${r} found on this device.`:e.name===\"NotSupportedError\"?n=`${r.charAt(0).toUpperCase()+r.slice(1)} is not supported in this browser.`:e.name===\"NotReadableError\"?n=`${r.charAt(0).toUpperCase()+r.slice(1)} is being used by another application.`:e.name===\"OverconstrainedError\"?n=`${r.charAt(0).toUpperCase()+r.slice(1)} settings are not supported on this device.`:e.name===\"SecurityError\"&&(n=`${r.charAt(0).toUpperCase()+r.slice(1)} access blocked for security reasons. Please use HTTPS.`),console.error(`âŒ ${r} error:`,n,e)}async takePhoto(e={}){Pn.isNativePlatform()?console.log(\"ðŸ“± Native platform - using native camera\"):console.log(\"ðŸ“± Web platform - using Capacitor Camera for web\");const r={quality:e.quality||90,allowEditing:e.allowEditing||!1,resultType:e.resultType||cf.Uri,source:e.source||To.Camera};try{const n=await mp.getPhoto(r);return console.log(\"ðŸ“¸ Photo captured successfully:\",{format:n.format,webPath:n.webPath?\"available\":\"none\"}),n}catch(n){throw console.error(\"âŒ Camera error:\",n),new Error(`Failed to take photo: ${n}`)}}async selectFromGallery(e={}){console.log(\"ðŸ–¼ï¸ Selecting from photo gallery...\");const r={quality:e.quality||90,allowEditing:e.allowEditing||!1,resultType:e.resultType||cf.Uri,source:To.Photos};try{const n=await mp.getPhoto(r);return console.log(\"ðŸ“· Gallery photo selected successfully\"),n}catch(n){throw console.error(\"âŒ Gallery selection error:\",n),new Error(`Failed to select from gallery: ${n}`)}}async checkCameraPermissions(){try{const e=await mp.checkPermissions();if(console.log(\"ðŸ“‹ Camera permissions status:\",e),e.camera===\"granted\"&&e.photos===\"granted\")return!0;const r=await mp.requestPermissions();return console.log(\"ðŸ“‹ Permission request result:\",r),r.camera===\"granted\"&&r.photos===\"granted\"}catch(e){return console.error(\"âŒ Permission check error:\",e),!1}}async getDeviceInfo(){try{const e=await pU.getInfo();return console.log(\"ðŸ“± Device info:\",{platform:e.platform,isVirtual:e.isVirtual,model:e.model}),e}catch(e){return console.error(\"âŒ Device info error:\",e),null}}isNativePlatform(){return Pn.isNativePlatform()}isPlatform(e){return Pn.getPlatform()===e}cleanup(){this.stopCamera(),this.stopMicrophone(),this.mediaRecorder&&(this.mediaRecorder=null),this.recordingChunks=[],console.log(\"ðŸ§¹ Media service cleaned up\")}}const Br=gd.getInstance();function ht(t,e,{checkForDefaultPrevented:r=!0}={}){return function(i){if(t==null||t(i),r===!1||!i.defaultPrevented)return e==null?void 0:e(i)}}function Xk(t,e){if(typeof t==\"function\")return t(e);t!=null&&(t.current=e)}function mU(...t){return e=>{let r=!1;const n=t.map(i=>{const a=Xk(i,e);return!r&&typeof a==\"function\"&&(r=!0),a});if(r)return()=>{for(let i=0;i<n.length;i++){const a=n[i];typeof a==\"function\"?a():Xk(t[i],null)}}}}function Dt(...t){return E.useCallback(mU(...t),t)}function Une(t,e){const r=E.createContext(e),n=a=>{const{children:o,...s}=a,c=E.useMemo(()=>s,Object.values(s));return l.jsx(r.Provider,{value:c,children:o})};n.displayName=t+\"Provider\";function i(a){const o=E.useContext(r);if(o)return o;if(e!==void 0)return e;throw new Error(`\\`${a}\\` must be used within \\`${t}\\``)}return[n,i]}function Ia(t,e=[]){let r=[];function n(a,o){const s=E.createContext(o),c=r.length;r=[...r,o];const u=h=>{var w;const{scope:m,children:g,...x}=h,v=((w=m==null?void 0:m[t])==null?void 0:w[c])||s,b=E.useMemo(()=>x,Object.values(x));return l.jsx(v.Provider,{value:b,children:g})};u.displayName=a+\"Provider\";function f(h,m){var v;const g=((v=m==null?void 0:m[t])==null?void 0:v[c])||s,x=E.useContext(g);if(x)return x;if(o!==void 0)return o;throw new Error(`\\`${h}\\` must be used within \\`${a}\\``)}return[u,f]}const i=()=>{const a=r.map(o=>E.createContext(o));return function(s){const c=(s==null?void 0:s[t])||a;return E.useMemo(()=>({[`__scope${t}`]:{...s,[t]:c}}),[s,c])}};return i.scopeName=t,[n,zne(i,...e)]}function zne(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const n=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(a){const o=n.reduce((s,{useScope:c,scopeName:u})=>{const h=c(a)[`__scope${u}`];return{...s,...h}},{});return E.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return r.scopeName=e.scopeName,r}var zn=globalThis!=null&&globalThis.document?E.useLayoutEffect:()=>{},Wne=Aj[\" useId \".trim().toString()]||(()=>{}),qne=0;function Ro(t){const[e,r]=E.useState(Wne());return zn(()=>{r(n=>n??String(qne++))},[t]),e?`radix-${e}`:\"\"}var Hne=Aj[\" useInsertionEffect \".trim().toString()]||zn;function ks({prop:t,defaultProp:e,onChange:r=()=>{},caller:n}){const[i,a,o]=Gne({defaultProp:e,onChange:r}),s=t!==void 0,c=s?t:i;{const f=E.useRef(t!==void 0);E.useEffect(()=>{const h=f.current;h!==s&&console.warn(`${n} is changing from ${h?\"controlled\":\"uncontrolled\"} to ${s?\"controlled\":\"uncontrolled\"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),f.current=s},[s,n])}const u=E.useCallback(f=>{var h;if(s){const m=Kne(f)?f(t):f;m!==t&&((h=o.current)==null||h.call(o,m))}else a(f)},[s,t,a,o]);return[c,u]}function Gne({defaultProp:t,onChange:e}){const[r,n]=E.useState(t),i=E.useRef(r),a=E.useRef(e);return Hne(()=>{a.current=e},[e]),E.useEffect(()=>{var o;i.current!==r&&((o=a.current)==null||o.call(a,r),i.current=r)},[r,i]),[r,n,a]}function Kne(t){return typeof t==\"function\"}var l0=TV();const Xne=or(l0);function fu(t){const e=Yne(t),r=E.forwardRef((n,i)=>{const{children:a,...o}=n,s=E.Children.toArray(a),c=s.find(Qne);if(c){const u=c.props.children,f=s.map(h=>h===c?E.Children.count(u)>1?E.Children.only(null):E.isValidElement(u)?u.props.children:null:h);return l.jsx(e,{...o,ref:i,children:E.isValidElement(u)?E.cloneElement(u,void 0,f):null})}return l.jsx(e,{...o,ref:i,children:a})});return r.displayName=`${t}.Slot`,r}var gU=fu(\"Slot\");function Yne(t){const e=E.forwardRef((r,n)=>{const{children:i,...a}=r;if(E.isValidElement(i)){const o=eie(i),s=Jne(a,i.props);return i.type!==E.Fragment&&(s.ref=n?mU(n,o):o),E.cloneElement(i,s)}return E.Children.count(i)>1?E.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var vU=Symbol(\"radix.slottable\");function Zne(t){const e=({children:r})=>l.jsx(l.Fragment,{children:r});return e.displayName=`${t}.Slottable`,e.__radixId=vU,e}function Qne(t){return E.isValidElement(t)&&typeof t.type==\"function\"&&\"__radixId\"in t.type&&t.type.__radixId===vU}function Jne(t,e){const r={...e};for(const n in e){const i=t[n],a=e[n];/^on[A-Z]/.test(n)?i&&a?r[n]=(...s)=>{const c=a(...s);return i(...s),c}:i&&(r[n]=i):n===\"style\"?r[n]={...i,...a}:n===\"className\"&&(r[n]=[i,a].filter(Boolean).join(\" \"))}return{...t,...r}}function eie(t){var n,i;let e=(n=Object.getOwnPropertyDescriptor(t.props,\"ref\"))==null?void 0:n.get,r=e&&\"isReactWarning\"in e&&e.isReactWarning;return r?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,\"ref\"))==null?void 0:i.get,r=e&&\"isReactWarning\"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var tie=[\"a\",\"button\",\"div\",\"form\",\"h2\",\"h3\",\"img\",\"input\",\"label\",\"li\",\"nav\",\"ol\",\"p\",\"select\",\"span\",\"svg\",\"ul\"],pt=tie.reduce((t,e)=>{const r=fu(`Primitive.${e}`),n=E.forwardRef((i,a)=>{const{asChild:o,...s}=i,c=o?r:e;return typeof window<\"u\"&&(window[Symbol.for(\"radix-ui\")]=!0),l.jsx(c,{...s,ref:a})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function rie(t,e){t&&l0.flushSync(()=>t.dispatchEvent(e))}function ql(t){const e=E.useRef(t);return E.useEffect(()=>{e.current=t}),E.useMemo(()=>(...r)=>{var n;return(n=e.current)==null?void 0:n.call(e,...r)},[])}function nie(t,e=globalThis==null?void 0:globalThis.document){const r=ql(t);E.useEffect(()=>{const n=i=>{i.key===\"Escape\"&&r(i)};return e.addEventListener(\"keydown\",n,{capture:!0}),()=>e.removeEventListener(\"keydown\",n,{capture:!0})},[r,e])}var iie=\"DismissableLayer\",JA=\"dismissableLayer.update\",aie=\"dismissableLayer.pointerDownOutside\",oie=\"dismissableLayer.focusOutside\",Yk,yU=E.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Px=E.forwardRef((t,e)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:i,onFocusOutside:a,onInteractOutside:o,onDismiss:s,...c}=t,u=E.useContext(yU),[f,h]=E.useState(null),m=(f==null?void 0:f.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,g]=E.useState({}),x=Dt(e,P=>h(P)),v=Array.from(u.layers),[b]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),w=v.indexOf(b),C=f?v.indexOf(f):-1,_=u.layersWithOutsidePointerEventsDisabled.size>0,N=C>=w,A=cie(P=>{const k=P.target,I=[...u.branches].some(R=>R.contains(k));!N||I||(i==null||i(P),o==null||o(P),P.defaultPrevented||s==null||s())},m),T=uie(P=>{const k=P.target;[...u.branches].some(R=>R.contains(k))||(a==null||a(P),o==null||o(P),P.defaultPrevented||s==null||s())},m);return nie(P=>{C===u.layers.size-1&&(n==null||n(P),!P.defaultPrevented&&s&&(P.preventDefault(),s()))},m),E.useEffect(()=>{if(f)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(Yk=m.body.style.pointerEvents,m.body.style.pointerEvents=\"none\"),u.layersWithOutsidePointerEventsDisabled.add(f)),u.layers.add(f),Zk(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(m.body.style.pointerEvents=Yk)}},[f,m,r,u]),E.useEffect(()=>()=>{f&&(u.layers.delete(f),u.layersWithOutsidePointerEventsDisabled.delete(f),Zk())},[f,u]),E.useEffect(()=>{const P=()=>g({});return document.addEventListener(JA,P),()=>document.removeEventListener(JA,P)},[]),l.jsx(pt.div,{...c,ref:x,style:{pointerEvents:_?N?\"auto\":\"none\":void 0,...t.style},onFocusCapture:ht(t.onFocusCapture,T.onFocusCapture),onBlurCapture:ht(t.onBlurCapture,T.onBlurCapture),onPointerDownCapture:ht(t.onPointerDownCapture,A.onPointerDownCapture)})});Px.displayName=iie;var sie=\"DismissableLayerBranch\",lie=E.forwardRef((t,e)=>{const r=E.useContext(yU),n=E.useRef(null),i=Dt(e,n);return E.useEffect(()=>{const a=n.current;if(a)return r.branches.add(a),()=>{r.branches.delete(a)}},[r.branches]),l.jsx(pt.div,{...t,ref:i})});lie.displayName=sie;function cie(t,e=globalThis==null?void 0:globalThis.document){const r=ql(t),n=E.useRef(!1),i=E.useRef(()=>{});return E.useEffect(()=>{const a=s=>{if(s.target&&!n.current){let c=function(){xU(aie,r,u,{discrete:!0})};const u={originalEvent:s};s.pointerType===\"touch\"?(e.removeEventListener(\"click\",i.current),i.current=c,e.addEventListener(\"click\",i.current,{once:!0})):c()}else e.removeEventListener(\"click\",i.current);n.current=!1},o=window.setTimeout(()=>{e.addEventListener(\"pointerdown\",a)},0);return()=>{window.clearTimeout(o),e.removeEventListener(\"pointerdown\",a),e.removeEventListener(\"click\",i.current)}},[e,r]),{onPointerDownCapture:()=>n.current=!0}}function uie(t,e=globalThis==null?void 0:globalThis.document){const r=ql(t),n=E.useRef(!1);return E.useEffect(()=>{const i=a=>{a.target&&!n.current&&xU(oie,r,{originalEvent:a},{discrete:!1})};return e.addEventListener(\"focusin\",i),()=>e.removeEventListener(\"focusin\",i)},[e,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function Zk(){const t=new CustomEvent(JA);document.dispatchEvent(t)}function xU(t,e,r,{discrete:n}){const i=r.originalEvent.target,a=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});e&&i.addEventListener(t,e,{once:!0}),n?rie(i,a):i.dispatchEvent(a)}var zw=\"focusScope.autoFocusOnMount\",Ww=\"focusScope.autoFocusOnUnmount\",Qk={bubbles:!1,cancelable:!0},die=\"FocusScope\",Ox=E.forwardRef((t,e)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:i,onUnmountAutoFocus:a,...o}=t,[s,c]=E.useState(null),u=ql(i),f=ql(a),h=E.useRef(null),m=Dt(e,v=>c(v)),g=E.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;E.useEffect(()=>{if(n){let v=function(_){if(g.paused||!s)return;const N=_.target;s.contains(N)?h.current=N:xl(h.current,{select:!0})},b=function(_){if(g.paused||!s)return;const N=_.relatedTarget;N!==null&&(s.contains(N)||xl(h.current,{select:!0}))},w=function(_){if(document.activeElement===document.body)for(const A of _)A.removedNodes.length>0&&xl(s)};document.addEventListener(\"focusin\",v),document.addEventListener(\"focusout\",b);const C=new MutationObserver(w);return s&&C.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener(\"focusin\",v),document.removeEventListener(\"focusout\",b),C.disconnect()}}},[n,s,g.paused]),E.useEffect(()=>{if(s){eI.add(g);const v=document.activeElement;if(!s.contains(v)){const w=new CustomEvent(zw,Qk);s.addEventListener(zw,u),s.dispatchEvent(w),w.defaultPrevented||(fie(vie(bU(s)),{select:!0}),document.activeElement===v&&xl(s))}return()=>{s.removeEventListener(zw,u),setTimeout(()=>{const w=new CustomEvent(Ww,Qk);s.addEventListener(Ww,f),s.dispatchEvent(w),w.defaultPrevented||xl(v??document.body,{select:!0}),s.removeEventListener(Ww,f),eI.remove(g)},0)}}},[s,u,f,g]);const x=E.useCallback(v=>{if(!r&&!n||g.paused)return;const b=v.key===\"Tab\"&&!v.altKey&&!v.ctrlKey&&!v.metaKey,w=document.activeElement;if(b&&w){const C=v.currentTarget,[_,N]=hie(C);_&&N?!v.shiftKey&&w===N?(v.preventDefault(),r&&xl(_,{select:!0})):v.shiftKey&&w===_&&(v.preventDefault(),r&&xl(N,{select:!0})):w===C&&v.preventDefault()}},[r,n,g.paused]);return l.jsx(pt.div,{tabIndex:-1,...o,ref:m,onKeyDown:x})});Ox.displayName=die;function fie(t,{select:e=!1}={}){const r=document.activeElement;for(const n of t)if(xl(n,{select:e}),document.activeElement!==r)return}function hie(t){const e=bU(t),r=Jk(e,t),n=Jk(e.reverse(),t);return[r,n]}function bU(t){const e=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const i=n.tagName===\"INPUT\"&&n.type===\"hidden\";return n.disabled||n.hidden||i?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)e.push(r.currentNode);return e}function Jk(t,e){for(const r of t)if(!pie(r,{upTo:e}))return r}function pie(t,{upTo:e}){if(getComputedStyle(t).visibility===\"hidden\")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display===\"none\")return!0;t=t.parentElement}return!1}function mie(t){return t instanceof HTMLInputElement&&\"select\"in t}function xl(t,{select:e=!1}={}){if(t&&t.focus){const r=document.activeElement;t.focus({preventScroll:!0}),t!==r&&mie(t)&&e&&t.select()}}var eI=gie();function gie(){let t=[];return{add(e){const r=t[0];e!==r&&(r==null||r.pause()),t=tI(t,e),t.unshift(e)},remove(e){var r;t=tI(t,e),(r=t[0])==null||r.resume()}}}function tI(t,e){const r=[...t],n=r.indexOf(e);return n!==-1&&r.splice(n,1),r}function vie(t){return t.filter(e=>e.tagName!==\"A\")}var yie=\"Portal\",kx=E.forwardRef((t,e)=>{var s;const{container:r,...n}=t,[i,a]=E.useState(!1);zn(()=>a(!0),[]);const o=r||i&&((s=globalThis==null?void 0:globalThis.document)==null?void 0:s.body);return o?Xne.createPortal(l.jsx(pt.div,{...n,ref:e}),o):null});kx.displayName=yie;function xie(t,e){return E.useReducer((r,n)=>e[r][n]??r,t)}var tc=t=>{const{present:e,children:r}=t,n=bie(e),i=typeof r==\"function\"?r({present:n.isPresent}):E.Children.only(r),a=Dt(n.ref,wie(i));return typeof r==\"function\"||n.isPresent?E.cloneElement(i,{ref:a}):null};tc.displayName=\"Presence\";function bie(t){const[e,r]=E.useState(),n=E.useRef(null),i=E.useRef(t),a=E.useRef(\"none\"),o=t?\"mounted\":\"unmounted\",[s,c]=xie(o,{mounted:{UNMOUNT:\"unmounted\",ANIMATION_OUT:\"unmountSuspended\"},unmountSuspended:{MOUNT:\"mounted\",ANIMATION_END:\"unmounted\"},unmounted:{MOUNT:\"mounted\"}});return E.useEffect(()=>{const u=Kg(n.current);a.current=s===\"mounted\"?u:\"none\"},[s]),zn(()=>{const u=n.current,f=i.current;if(f!==t){const m=a.current,g=Kg(u);t?c(\"MOUNT\"):g===\"none\"||(u==null?void 0:u.display)===\"none\"?c(\"UNMOUNT\"):c(f&&m!==g?\"ANIMATION_OUT\":\"UNMOUNT\"),i.current=t}},[t,c]),zn(()=>{if(e){let u;const f=e.ownerDocument.defaultView??window,h=g=>{const v=Kg(n.current).includes(CSS.escape(g.animationName));if(g.target===e&&v&&(c(\"ANIMATION_END\"),!i.current)){const b=e.style.animationFillMode;e.style.animationFillMode=\"forwards\",u=f.setTimeout(()=>{e.style.animationFillMode===\"forwards\"&&(e.style.animationFillMode=b)})}},m=g=>{g.target===e&&(a.current=Kg(n.current))};return e.addEventListener(\"animationstart\",m),e.addEventListener(\"animationcancel\",h),e.addEventListener(\"animationend\",h),()=>{f.clearTimeout(u),e.removeEventListener(\"animationstart\",m),e.removeEventListener(\"animationcancel\",h),e.removeEventListener(\"animationend\",h)}}else c(\"ANIMATION_END\")},[e,c]),{isPresent:[\"mounted\",\"unmountSuspended\"].includes(s),ref:E.useCallback(u=>{n.current=u?getComputedStyle(u):null,r(u)},[])}}function Kg(t){return(t==null?void 0:t.animationName)||\"none\"}function wie(t){var n,i;let e=(n=Object.getOwnPropertyDescriptor(t.props,\"ref\"))==null?void 0:n.get,r=e&&\"isReactWarning\"in e&&e.isReactWarning;return r?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,\"ref\"))==null?void 0:i.get,r=e&&\"isReactWarning\"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var qw=0;function Fj(){E.useEffect(()=>{const t=document.querySelectorAll(\"[data-radix-focus-guard]\");return document.body.insertAdjacentElement(\"afterbegin\",t[0]??rI()),document.body.insertAdjacentElement(\"beforeend\",t[1]??rI()),qw++,()=>{qw===1&&document.querySelectorAll(\"[data-radix-focus-guard]\").forEach(e=>e.remove()),qw--}},[])}function rI(){const t=document.createElement(\"span\");return t.setAttribute(\"data-radix-focus-guard\",\"\"),t.tabIndex=0,t.style.outline=\"none\",t.style.opacity=\"0\",t.style.position=\"fixed\",t.style.pointerEvents=\"none\",t}var jo=function(){return jo=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},jo.apply(this,arguments)};function wU(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols==\"function\")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Sie(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,a;n<i;n++)(a||!(n in e))&&(a||(a=Array.prototype.slice.call(e,0,n)),a[n]=e[n]);return t.concat(a||Array.prototype.slice.call(e))}var Tv=\"right-scroll-bar-position\",Pv=\"width-before-scroll-bar\",_ie=\"with-scroll-bars-hidden\",Cie=\"--removed-body-scroll-bar-size\";function Hw(t,e){return typeof t==\"function\"?t(e):t&&(t.current=e),t}function Aie(t,e){var r=E.useState(function(){return{value:t,callback:e,facade:{get current(){return r.value},set current(n){var i=r.value;i!==n&&(r.value=n,r.callback(n,i))}}}})[0];return r.callback=e,r.facade}var Nie=typeof window<\"u\"?E.useLayoutEffect:E.useEffect,nI=new WeakMap;function Eie(t,e){var r=Aie(null,function(n){return t.forEach(function(i){return Hw(i,n)})});return Nie(function(){var n=nI.get(r);if(n){var i=new Set(n),a=new Set(t),o=r.current;i.forEach(function(s){a.has(s)||Hw(s,null)}),a.forEach(function(s){i.has(s)||Hw(s,o)})}nI.set(r,t)},[t]),r}function jie(t){return t}function Tie(t,e){e===void 0&&(e=jie);var r=[],n=!1,i={read:function(){if(n)throw new Error(\"Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.\");return r.length?r[r.length-1]:t},useMedium:function(a){var o=e(a,n);return r.push(o),function(){r=r.filter(function(s){return s!==o})}},assignSyncMedium:function(a){for(n=!0;r.length;){var o=r;r=[],o.forEach(a)}r={push:function(s){return a(s)},filter:function(){return r}}},assignMedium:function(a){n=!0;var o=[];if(r.length){var s=r;r=[],s.forEach(a),o=r}var c=function(){var f=o;o=[],f.forEach(a)},u=function(){return Promise.resolve().then(c)};u(),r={push:function(f){o.push(f),u()},filter:function(f){return o=o.filter(f),r}}}};return i}function Pie(t){t===void 0&&(t={});var e=Tie(null);return e.options=jo({async:!0,ssr:!1},t),e}var SU=function(t){var e=t.sideCar,r=wU(t,[\"sideCar\"]);if(!e)throw new Error(\"Sidecar: please provide `sideCar` property to import the right car\");var n=e.read();if(!n)throw new Error(\"Sidecar medium not found\");return E.createElement(n,jo({},r))};SU.isSideCarExport=!0;function Oie(t,e){return t.useMedium(e),SU}var _U=Pie(),Gw=function(){},Ix=E.forwardRef(function(t,e){var r=E.useRef(null),n=E.useState({onScrollCapture:Gw,onWheelCapture:Gw,onTouchMoveCapture:Gw}),i=n[0],a=n[1],o=t.forwardProps,s=t.children,c=t.className,u=t.removeScrollBar,f=t.enabled,h=t.shards,m=t.sideCar,g=t.noRelative,x=t.noIsolation,v=t.inert,b=t.allowPinchZoom,w=t.as,C=w===void 0?\"div\":w,_=t.gapMode,N=wU(t,[\"forwardProps\",\"children\",\"className\",\"removeScrollBar\",\"enabled\",\"shards\",\"sideCar\",\"noRelative\",\"noIsolation\",\"inert\",\"allowPinchZoom\",\"as\",\"gapMode\"]),A=m,T=Eie([r,e]),P=jo(jo({},N),i);return E.createElement(E.Fragment,null,f&&E.createElement(A,{sideCar:_U,removeScrollBar:u,shards:h,noRelative:g,noIsolation:x,inert:v,setCallbacks:a,allowPinchZoom:!!b,lockRef:r,gapMode:_}),o?E.cloneElement(E.Children.only(s),jo(jo({},P),{ref:T})):E.createElement(C,jo({},P,{className:c,ref:T}),s))});Ix.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Ix.classNames={fullWidth:Pv,zeroRight:Tv};var kie=function(){if(typeof __webpack_nonce__<\"u\")return __webpack_nonce__};function Iie(){if(!document)return null;var t=document.createElement(\"style\");t.type=\"text/css\";var e=kie();return e&&t.setAttribute(\"nonce\",e),t}function Mie(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function Die(t){var e=document.head||document.getElementsByTagName(\"head\")[0];e.appendChild(t)}var Rie=function(){var t=0,e=null;return{add:function(r){t==0&&(e=Iie())&&(Mie(e,r),Die(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},Fie=function(){var t=Rie();return function(e,r){E.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&r])}},CU=function(){var t=Fie(),e=function(r){var n=r.styles,i=r.dynamic;return t(n,i),null};return e},Lie={left:0,top:0,right:0,gap:0},Kw=function(t){return parseInt(t||\"\",10)||0},Bie=function(t){var e=window.getComputedStyle(document.body),r=e[t===\"padding\"?\"paddingLeft\":\"marginLeft\"],n=e[t===\"padding\"?\"paddingTop\":\"marginTop\"],i=e[t===\"padding\"?\"paddingRight\":\"marginRight\"];return[Kw(r),Kw(n),Kw(i)]},$ie=function(t){if(t===void 0&&(t=\"margin\"),typeof window>\"u\")return Lie;var e=Bie(t),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,n-r+e[2]-e[0])}},Vie=CU(),Md=\"data-scroll-locked\",Uie=function(t,e,r,n){var i=t.left,a=t.top,o=t.right,s=t.gap;return r===void 0&&(r=\"margin\"),`\n  .`.concat(_ie,` {\n   overflow: hidden `).concat(n,`;\n   padding-right: `).concat(s,\"px \").concat(n,`;\n  }\n  body[`).concat(Md,`] {\n    overflow: hidden `).concat(n,`;\n    overscroll-behavior: contain;\n    `).concat([e&&\"position: relative \".concat(n,\";\"),r===\"margin\"&&`\n    padding-left: `.concat(i,`px;\n    padding-top: `).concat(a,`px;\n    padding-right: `).concat(o,`px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: `).concat(s,\"px \").concat(n,`;\n    `),r===\"padding\"&&\"padding-right: \".concat(s,\"px \").concat(n,\";\")].filter(Boolean).join(\"\"),`\n  }\n  \n  .`).concat(Tv,` {\n    right: `).concat(s,\"px \").concat(n,`;\n  }\n  \n  .`).concat(Pv,` {\n    margin-right: `).concat(s,\"px \").concat(n,`;\n  }\n  \n  .`).concat(Tv,\" .\").concat(Tv,` {\n    right: 0 `).concat(n,`;\n  }\n  \n  .`).concat(Pv,\" .\").concat(Pv,` {\n    margin-right: 0 `).concat(n,`;\n  }\n  \n  body[`).concat(Md,`] {\n    `).concat(Cie,\": \").concat(s,`px;\n  }\n`)},iI=function(){var t=parseInt(document.body.getAttribute(Md)||\"0\",10);return isFinite(t)?t:0},zie=function(){E.useEffect(function(){return document.body.setAttribute(Md,(iI()+1).toString()),function(){var t=iI()-1;t<=0?document.body.removeAttribute(Md):document.body.setAttribute(Md,t.toString())}},[])},Wie=function(t){var e=t.noRelative,r=t.noImportant,n=t.gapMode,i=n===void 0?\"margin\":n;zie();var a=E.useMemo(function(){return $ie(i)},[i]);return E.createElement(Vie,{styles:Uie(a,!e,i,r?\"\":\"!important\")})},eN=!1;if(typeof window<\"u\")try{var Xg=Object.defineProperty({},\"passive\",{get:function(){return eN=!0,!0}});window.addEventListener(\"test\",Xg,Xg),window.removeEventListener(\"test\",Xg,Xg)}catch{eN=!1}var nd=eN?{passive:!1}:!1,qie=function(t){return t.tagName===\"TEXTAREA\"},AU=function(t,e){if(!(t instanceof Element))return!1;var r=window.getComputedStyle(t);return r[e]!==\"hidden\"&&!(r.overflowY===r.overflowX&&!qie(t)&&r[e]===\"visible\")},Hie=function(t){return AU(t,\"overflowY\")},Gie=function(t){return AU(t,\"overflowX\")},aI=function(t,e){var r=e.ownerDocument,n=e;do{typeof ShadowRoot<\"u\"&&n instanceof ShadowRoot&&(n=n.host);var i=NU(t,n);if(i){var a=EU(t,n),o=a[1],s=a[2];if(o>s)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},Kie=function(t){var e=t.scrollTop,r=t.scrollHeight,n=t.clientHeight;return[e,r,n]},Xie=function(t){var e=t.scrollLeft,r=t.scrollWidth,n=t.clientWidth;return[e,r,n]},NU=function(t,e){return t===\"v\"?Hie(e):Gie(e)},EU=function(t,e){return t===\"v\"?Kie(e):Xie(e)},Yie=function(t,e){return t===\"h\"&&e===\"rtl\"?-1:1},Zie=function(t,e,r,n,i){var a=Yie(t,window.getComputedStyle(e).direction),o=a*n,s=r.target,c=e.contains(s),u=!1,f=o>0,h=0,m=0;do{if(!s)break;var g=EU(t,s),x=g[0],v=g[1],b=g[2],w=v-b-a*x;(x||w)&&NU(t,s)&&(h+=w,m+=x);var C=s.parentNode;s=C&&C.nodeType===Node.DOCUMENT_FRAGMENT_NODE?C.host:C}while(!c&&s!==document.body||c&&(e.contains(s)||e===s));return(f&&Math.abs(h)<1||!f&&Math.abs(m)<1)&&(u=!0),u},Yg=function(t){return\"changedTouches\"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},oI=function(t){return[t.deltaX,t.deltaY]},sI=function(t){return t&&\"current\"in t?t.current:t},Qie=function(t,e){return t[0]===e[0]&&t[1]===e[1]},Jie=function(t){return`\n  .block-interactivity-`.concat(t,` {pointer-events: none;}\n  .allow-interactivity-`).concat(t,` {pointer-events: all;}\n`)},eae=0,id=[];function tae(t){var e=E.useRef([]),r=E.useRef([0,0]),n=E.useRef(),i=E.useState(eae++)[0],a=E.useState(CU)[0],o=E.useRef(t);E.useEffect(function(){o.current=t},[t]),E.useEffect(function(){if(t.inert){document.body.classList.add(\"block-interactivity-\".concat(i));var v=Sie([t.lockRef.current],(t.shards||[]).map(sI),!0).filter(Boolean);return v.forEach(function(b){return b.classList.add(\"allow-interactivity-\".concat(i))}),function(){document.body.classList.remove(\"block-interactivity-\".concat(i)),v.forEach(function(b){return b.classList.remove(\"allow-interactivity-\".concat(i))})}}},[t.inert,t.lockRef.current,t.shards]);var s=E.useCallback(function(v,b){if(\"touches\"in v&&v.touches.length===2||v.type===\"wheel\"&&v.ctrlKey)return!o.current.allowPinchZoom;var w=Yg(v),C=r.current,_=\"deltaX\"in v?v.deltaX:C[0]-w[0],N=\"deltaY\"in v?v.deltaY:C[1]-w[1],A,T=v.target,P=Math.abs(_)>Math.abs(N)?\"h\":\"v\";if(\"touches\"in v&&P===\"h\"&&T.type===\"range\")return!1;var k=aI(P,T);if(!k)return!0;if(k?A=P:(A=P===\"v\"?\"h\":\"v\",k=aI(P,T)),!k)return!1;if(!n.current&&\"changedTouches\"in v&&(_||N)&&(n.current=A),!A)return!0;var I=n.current||A;return Zie(I,b,v,I===\"h\"?_:N)},[]),c=E.useCallback(function(v){var b=v;if(!(!id.length||id[id.length-1]!==a)){var w=\"deltaY\"in b?oI(b):Yg(b),C=e.current.filter(function(A){return A.name===b.type&&(A.target===b.target||b.target===A.shadowParent)&&Qie(A.delta,w)})[0];if(C&&C.should){b.cancelable&&b.preventDefault();return}if(!C){var _=(o.current.shards||[]).map(sI).filter(Boolean).filter(function(A){return A.contains(b.target)}),N=_.length>0?s(b,_[0]):!o.current.noIsolation;N&&b.cancelable&&b.preventDefault()}}},[]),u=E.useCallback(function(v,b,w,C){var _={name:v,delta:b,target:w,should:C,shadowParent:rae(w)};e.current.push(_),setTimeout(function(){e.current=e.current.filter(function(N){return N!==_})},1)},[]),f=E.useCallback(function(v){r.current=Yg(v),n.current=void 0},[]),h=E.useCallback(function(v){u(v.type,oI(v),v.target,s(v,t.lockRef.current))},[]),m=E.useCallback(function(v){u(v.type,Yg(v),v.target,s(v,t.lockRef.current))},[]);E.useEffect(function(){return id.push(a),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:m}),document.addEventListener(\"wheel\",c,nd),document.addEventListener(\"touchmove\",c,nd),document.addEventListener(\"touchstart\",f,nd),function(){id=id.filter(function(v){return v!==a}),document.removeEventListener(\"wheel\",c,nd),document.removeEventListener(\"touchmove\",c,nd),document.removeEventListener(\"touchstart\",f,nd)}},[]);var g=t.removeScrollBar,x=t.inert;return E.createElement(E.Fragment,null,x?E.createElement(a,{styles:Jie(i)}):null,g?E.createElement(Wie,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function rae(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const nae=Oie(_U,tae);var Mx=E.forwardRef(function(t,e){return E.createElement(Ix,jo({},t,{ref:e,sideCar:nae}))});Mx.classNames=Ix.classNames;var iae=function(t){if(typeof document>\"u\")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},ad=new WeakMap,Zg=new WeakMap,Qg={},Xw=0,jU=function(t){return t&&(t.host||jU(t.parentNode))},aae=function(t,e){return e.map(function(r){if(t.contains(r))return r;var n=jU(r);return n&&t.contains(n)?n:(console.error(\"aria-hidden\",r,\"in not contained inside\",t,\". Doing nothing\"),null)}).filter(function(r){return!!r})},oae=function(t,e,r,n){var i=aae(e,Array.isArray(t)?t:[t]);Qg[r]||(Qg[r]=new WeakMap);var a=Qg[r],o=[],s=new Set,c=new Set(i),u=function(h){!h||s.has(h)||(s.add(h),u(h.parentNode))};i.forEach(u);var f=function(h){!h||c.has(h)||Array.prototype.forEach.call(h.children,function(m){if(s.has(m))f(m);else try{var g=m.getAttribute(n),x=g!==null&&g!==\"false\",v=(ad.get(m)||0)+1,b=(a.get(m)||0)+1;ad.set(m,v),a.set(m,b),o.push(m),v===1&&x&&Zg.set(m,!0),b===1&&m.setAttribute(r,\"true\"),x||m.setAttribute(n,\"true\")}catch(w){console.error(\"aria-hidden: cannot operate on \",m,w)}})};return f(e),s.clear(),Xw++,function(){o.forEach(function(h){var m=ad.get(h)-1,g=a.get(h)-1;ad.set(h,m),a.set(h,g),m||(Zg.has(h)||h.removeAttribute(n),Zg.delete(h)),g||h.removeAttribute(r)}),Xw--,Xw||(ad=new WeakMap,ad=new WeakMap,Zg=new WeakMap,Qg={})}},Lj=function(t,e,r){r===void 0&&(r=\"data-aria-hidden\");var n=Array.from(Array.isArray(t)?t:[t]),i=iae(t);return i?(n.push.apply(n,Array.from(i.querySelectorAll(\"[aria-live], script\"))),oae(n,i,r,\"aria-hidden\")):function(){return null}},Dx=\"Dialog\",[TU,PU]=Ia(Dx),[sae,mo]=TU(Dx),OU=t=>{const{__scopeDialog:e,children:r,open:n,defaultOpen:i,onOpenChange:a,modal:o=!0}=t,s=E.useRef(null),c=E.useRef(null),[u,f]=ks({prop:n,defaultProp:i??!1,onChange:a,caller:Dx});return l.jsx(sae,{scope:e,triggerRef:s,contentRef:c,contentId:Ro(),titleId:Ro(),descriptionId:Ro(),open:u,onOpenChange:f,onOpenToggle:E.useCallback(()=>f(h=>!h),[f]),modal:o,children:r})};OU.displayName=Dx;var kU=\"DialogTrigger\",IU=E.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,i=mo(kU,r),a=Dt(e,i.triggerRef);return l.jsx(pt.button,{type:\"button\",\"aria-haspopup\":\"dialog\",\"aria-expanded\":i.open,\"aria-controls\":i.contentId,\"data-state\":Vj(i.open),...n,ref:a,onClick:ht(t.onClick,i.onOpenToggle)})});IU.displayName=kU;var Bj=\"DialogPortal\",[lae,MU]=TU(Bj,{forceMount:void 0}),DU=t=>{const{__scopeDialog:e,forceMount:r,children:n,container:i}=t,a=mo(Bj,e);return l.jsx(lae,{scope:e,forceMount:r,children:E.Children.map(n,o=>l.jsx(tc,{present:r||a.open,children:l.jsx(kx,{asChild:!0,container:i,children:o})}))})};DU.displayName=Bj;var Hv=\"DialogOverlay\",RU=E.forwardRef((t,e)=>{const r=MU(Hv,t.__scopeDialog),{forceMount:n=r.forceMount,...i}=t,a=mo(Hv,t.__scopeDialog);return a.modal?l.jsx(tc,{present:n||a.open,children:l.jsx(uae,{...i,ref:e})}):null});RU.displayName=Hv;var cae=fu(\"DialogOverlay.RemoveScroll\"),uae=E.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,i=mo(Hv,r);return l.jsx(Mx,{as:cae,allowPinchZoom:!0,shards:[i.contentRef],children:l.jsx(pt.div,{\"data-state\":Vj(i.open),...n,ref:e,style:{pointerEvents:\"auto\",...n.style}})})}),hu=\"DialogContent\",FU=E.forwardRef((t,e)=>{const r=MU(hu,t.__scopeDialog),{forceMount:n=r.forceMount,...i}=t,a=mo(hu,t.__scopeDialog);return l.jsx(tc,{present:n||a.open,children:a.modal?l.jsx(dae,{...i,ref:e}):l.jsx(fae,{...i,ref:e})})});FU.displayName=hu;var dae=E.forwardRef((t,e)=>{const r=mo(hu,t.__scopeDialog),n=E.useRef(null),i=Dt(e,r.contentRef,n);return E.useEffect(()=>{const a=n.current;if(a)return Lj(a)},[]),l.jsx(LU,{...t,ref:i,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ht(t.onCloseAutoFocus,a=>{var o;a.preventDefault(),(o=r.triggerRef.current)==null||o.focus()}),onPointerDownOutside:ht(t.onPointerDownOutside,a=>{const o=a.detail.originalEvent,s=o.button===0&&o.ctrlKey===!0;(o.button===2||s)&&a.preventDefault()}),onFocusOutside:ht(t.onFocusOutside,a=>a.preventDefault())})}),fae=E.forwardRef((t,e)=>{const r=mo(hu,t.__scopeDialog),n=E.useRef(!1),i=E.useRef(!1);return l.jsx(LU,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{var o,s;(o=t.onCloseAutoFocus)==null||o.call(t,a),a.defaultPrevented||(n.current||(s=r.triggerRef.current)==null||s.focus(),a.preventDefault()),n.current=!1,i.current=!1},onInteractOutside:a=>{var c,u;(c=t.onInteractOutside)==null||c.call(t,a),a.defaultPrevented||(n.current=!0,a.detail.originalEvent.type===\"pointerdown\"&&(i.current=!0));const o=a.target;((u=r.triggerRef.current)==null?void 0:u.contains(o))&&a.preventDefault(),a.detail.originalEvent.type===\"focusin\"&&i.current&&a.preventDefault()}})}),LU=E.forwardRef((t,e)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:i,onCloseAutoFocus:a,...o}=t,s=mo(hu,r),c=E.useRef(null),u=Dt(e,c);return Fj(),l.jsxs(l.Fragment,{children:[l.jsx(Ox,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:i,onUnmountAutoFocus:a,children:l.jsx(Px,{role:\"dialog\",id:s.contentId,\"aria-describedby\":s.descriptionId,\"aria-labelledby\":s.titleId,\"data-state\":Vj(s.open),...o,ref:u,onDismiss:()=>s.onOpenChange(!1)})}),l.jsxs(l.Fragment,{children:[l.jsx(pae,{titleId:s.titleId}),l.jsx(gae,{contentRef:c,descriptionId:s.descriptionId})]})]})}),$j=\"DialogTitle\",BU=E.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,i=mo($j,r);return l.jsx(pt.h2,{id:i.titleId,...n,ref:e})});BU.displayName=$j;var $U=\"DialogDescription\",VU=E.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,i=mo($U,r);return l.jsx(pt.p,{id:i.descriptionId,...n,ref:e})});VU.displayName=$U;var UU=\"DialogClose\",zU=E.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,i=mo(UU,r);return l.jsx(pt.button,{type:\"button\",...n,ref:e,onClick:ht(t.onClick,()=>i.onOpenChange(!1))})});zU.displayName=UU;function Vj(t){return t?\"open\":\"closed\"}var WU=\"DialogTitleWarning\",[hae,qU]=Une(WU,{contentName:hu,titleName:$j,docsSlug:\"dialog\"}),pae=({titleId:t})=>{const e=qU(WU),r=`\\`${e.contentName}\\` requires a \\`${e.titleName}\\` for the component to be accessible for screen reader users.\n\nIf you want to hide the \\`${e.titleName}\\`, you can wrap it with our VisuallyHidden component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return E.useEffect(()=>{t&&(document.getElementById(t)||console.error(r))},[r,t]),null},mae=\"DialogDescriptionWarning\",gae=({contentRef:t,descriptionId:e})=>{const n=`Warning: Missing \\`Description\\` or \\`aria-describedby={undefined}\\` for {${qU(mae).contentName}}.`;return E.useEffect(()=>{var a;const i=(a=t.current)==null?void 0:a.getAttribute(\"aria-describedby\");e&&i&&(document.getElementById(e)||console.warn(n))},[n,t,e]),null},HU=OU,GU=IU,KU=DU,Uj=RU,zj=FU,Wj=BU,qj=VU,Hj=zU;function XU(t){var e,r,n=\"\";if(typeof t==\"string\"||typeof t==\"number\")n+=t;else if(typeof t==\"object\")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=XU(t[e]))&&(n&&(n+=\" \"),n+=r)}else for(r in t)t[r]&&(n&&(n+=\" \"),n+=r);return n}function Mt(){for(var t,e,r=0,n=\"\",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=XU(t))&&(n&&(n+=\" \"),n+=e);return n}const Gj=\"-\",vae=t=>{const e=xae(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:o=>{const s=o.split(Gj);return s[0]===\"\"&&s.length!==1&&s.shift(),YU(s,e)||yae(o)},getConflictingClassGroupIds:(o,s)=>{const c=r[o]||[];return s&&n[o]?[...c,...n[o]]:c}}},YU=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const r=t[0],n=e.nextPart.get(r),i=n?YU(t.slice(1),n):void 0;if(i)return i;if(e.validators.length===0)return;const a=t.join(Gj);return(o=e.validators.find(({validator:s})=>s(a)))==null?void 0:o.classGroupId},lI=/^\\[(.+)\\]$/,yae=t=>{if(lI.test(t)){const e=lI.exec(t)[1],r=e==null?void 0:e.substring(0,e.indexOf(\":\"));if(r)return\"arbitrary..\"+r}},xae=t=>{const{theme:e,prefix:r}=t,n={nextPart:new Map,validators:[]};return wae(Object.entries(t.classGroups),r).forEach(([a,o])=>{tN(o,n,a,e)}),n},tN=(t,e,r,n)=>{t.forEach(i=>{if(typeof i==\"string\"){const a=i===\"\"?e:cI(e,i);a.classGroupId=r;return}if(typeof i==\"function\"){if(bae(i)){tN(i(n),e,r,n);return}e.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([a,o])=>{tN(o,cI(e,a),r,n)})})},cI=(t,e)=>{let r=t;return e.split(Gj).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},bae=t=>t.isThemeGetter,wae=(t,e)=>e?t.map(([r,n])=>{const i=n.map(a=>typeof a==\"string\"?e+a:typeof a==\"object\"?Object.fromEntries(Object.entries(a).map(([o,s])=>[e+o,s])):a);return[r,i]}):t,Sae=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,n=new Map;const i=(a,o)=>{r.set(a,o),e++,e>t&&(e=0,n=r,r=new Map)};return{get(a){let o=r.get(a);if(o!==void 0)return o;if((o=n.get(a))!==void 0)return i(a,o),o},set(a,o){r.has(a)?r.set(a,o):i(a,o)}}},ZU=\"!\",_ae=t=>{const{separator:e,experimentalParseClassName:r}=t,n=e.length===1,i=e[0],a=e.length,o=s=>{const c=[];let u=0,f=0,h;for(let b=0;b<s.length;b++){let w=s[b];if(u===0){if(w===i&&(n||s.slice(b,b+a)===e)){c.push(s.slice(f,b)),f=b+a;continue}if(w===\"/\"){h=b;continue}}w===\"[\"?u++:w===\"]\"&&u--}const m=c.length===0?s:s.substring(f),g=m.startsWith(ZU),x=g?m.substring(1):m,v=h&&h>f?h-f:void 0;return{modifiers:c,hasImportantModifier:g,baseClassName:x,maybePostfixModifierPosition:v}};return r?s=>r({className:s,parseClassName:o}):o},Cae=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(n=>{n[0]===\"[\"?(e.push(...r.sort(),n),r=[]):r.push(n)}),e.push(...r.sort()),e},Aae=t=>({cache:Sae(t.cacheSize),parseClassName:_ae(t),...vae(t)}),Nae=/\\s+/,Eae=(t,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i}=e,a=[],o=t.trim().split(Nae);let s=\"\";for(let c=o.length-1;c>=0;c-=1){const u=o[c],{modifiers:f,hasImportantModifier:h,baseClassName:m,maybePostfixModifierPosition:g}=r(u);let x=!!g,v=n(x?m.substring(0,g):m);if(!v){if(!x){s=u+(s.length>0?\" \"+s:s);continue}if(v=n(m),!v){s=u+(s.length>0?\" \"+s:s);continue}x=!1}const b=Cae(f).join(\":\"),w=h?b+ZU:b,C=w+v;if(a.includes(C))continue;a.push(C);const _=i(v,x);for(let N=0;N<_.length;++N){const A=_[N];a.push(w+A)}s=u+(s.length>0?\" \"+s:s)}return s};function jae(){let t=0,e,r,n=\"\";for(;t<arguments.length;)(e=arguments[t++])&&(r=QU(e))&&(n&&(n+=\" \"),n+=r);return n}const QU=t=>{if(typeof t==\"string\")return t;let e,r=\"\";for(let n=0;n<t.length;n++)t[n]&&(e=QU(t[n]))&&(r&&(r+=\" \"),r+=e);return r};function Tae(t,...e){let r,n,i,a=o;function o(c){const u=e.reduce((f,h)=>h(f),t());return r=Aae(u),n=r.cache.get,i=r.cache.set,a=s,s(c)}function s(c){const u=n(c);if(u)return u;const f=Eae(c,r);return i(c,f),f}return function(){return a(jae.apply(null,arguments))}}const br=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},JU=/^\\[(?:([a-z-]+):)?(.+)\\]$/i,Pae=/^\\d+\\/\\d+$/,Oae=new Set([\"px\",\"full\",\"screen\"]),kae=/^(\\d+(\\.\\d+)?)?(xs|sm|md|lg|xl)$/,Iae=/\\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\\b(calc|min|max|clamp)\\(.+\\)|^0$/,Mae=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\\(.+\\)$/,Dae=/^(inset_)?-?((\\d+)?\\.?(\\d+)[a-z]+|0)_-?((\\d+)?\\.?(\\d+)[a-z]+|0)/,Rae=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\\(.+\\)$/,ls=t=>Dd(t)||Oae.has(t)||Pae.test(t),fl=t=>qf(t,\"length\",Wae),Dd=t=>!!t&&!Number.isNaN(Number(t)),Yw=t=>qf(t,\"number\",Dd),Kh=t=>!!t&&Number.isInteger(Number(t)),Fae=t=>t.endsWith(\"%\")&&Dd(t.slice(0,-1)),bt=t=>JU.test(t),hl=t=>kae.test(t),Lae=new Set([\"length\",\"size\",\"percentage\"]),Bae=t=>qf(t,Lae,ez),$ae=t=>qf(t,\"position\",ez),Vae=new Set([\"image\",\"url\"]),Uae=t=>qf(t,Vae,Hae),zae=t=>qf(t,\"\",qae),Xh=()=>!0,qf=(t,e,r)=>{const n=JU.exec(t);return n?n[1]?typeof e==\"string\"?n[1]===e:e.has(n[1]):r(n[2]):!1},Wae=t=>Iae.test(t)&&!Mae.test(t),ez=()=>!1,qae=t=>Dae.test(t),Hae=t=>Rae.test(t),Gae=()=>{const t=br(\"colors\"),e=br(\"spacing\"),r=br(\"blur\"),n=br(\"brightness\"),i=br(\"borderColor\"),a=br(\"borderRadius\"),o=br(\"borderSpacing\"),s=br(\"borderWidth\"),c=br(\"contrast\"),u=br(\"grayscale\"),f=br(\"hueRotate\"),h=br(\"invert\"),m=br(\"gap\"),g=br(\"gradientColorStops\"),x=br(\"gradientColorStopPositions\"),v=br(\"inset\"),b=br(\"margin\"),w=br(\"opacity\"),C=br(\"padding\"),_=br(\"saturate\"),N=br(\"scale\"),A=br(\"sepia\"),T=br(\"skew\"),P=br(\"space\"),k=br(\"translate\"),I=()=>[\"auto\",\"contain\",\"none\"],R=()=>[\"auto\",\"hidden\",\"clip\",\"visible\",\"scroll\"],F=()=>[\"auto\",bt,e],D=()=>[bt,e],B=()=>[\"\",ls,fl],q=()=>[\"auto\",Dd,bt],V=()=>[\"bottom\",\"center\",\"left\",\"left-bottom\",\"left-top\",\"right\",\"right-bottom\",\"right-top\",\"top\"],z=()=>[\"solid\",\"dashed\",\"dotted\",\"double\",\"none\"],G=()=>[\"normal\",\"multiply\",\"screen\",\"overlay\",\"darken\",\"lighten\",\"color-dodge\",\"color-burn\",\"hard-light\",\"soft-light\",\"difference\",\"exclusion\",\"hue\",\"saturation\",\"color\",\"luminosity\"],W=()=>[\"start\",\"end\",\"center\",\"between\",\"around\",\"evenly\",\"stretch\"],re=()=>[\"\",\"0\",bt],ne=()=>[\"auto\",\"avoid\",\"all\",\"avoid-page\",\"page\",\"left\",\"right\",\"column\"],L=()=>[Dd,bt];return{cacheSize:500,separator:\":\",theme:{colors:[Xh],spacing:[ls,fl],blur:[\"none\",\"\",hl,bt],brightness:L(),borderColor:[t],borderRadius:[\"none\",\"\",\"full\",hl,bt],borderSpacing:D(),borderWidth:B(),contrast:L(),grayscale:re(),hueRotate:L(),invert:re(),gap:D(),gradientColorStops:[t],gradientColorStopPositions:[Fae,fl],inset:F(),margin:F(),opacity:L(),padding:D(),saturate:L(),scale:L(),sepia:re(),skew:L(),space:D(),translate:D()},classGroups:{aspect:[{aspect:[\"auto\",\"square\",\"video\",bt]}],container:[\"container\"],columns:[{columns:[hl]}],\"break-after\":[{\"break-after\":ne()}],\"break-before\":[{\"break-before\":ne()}],\"break-inside\":[{\"break-inside\":[\"auto\",\"avoid\",\"avoid-page\",\"avoid-column\"]}],\"box-decoration\":[{\"box-decoration\":[\"slice\",\"clone\"]}],box:[{box:[\"border\",\"content\"]}],display:[\"block\",\"inline-block\",\"inline\",\"flex\",\"inline-flex\",\"table\",\"inline-table\",\"table-caption\",\"table-cell\",\"table-column\",\"table-column-group\",\"table-footer-group\",\"table-header-group\",\"table-row-group\",\"table-row\",\"flow-root\",\"grid\",\"inline-grid\",\"contents\",\"list-item\",\"hidden\"],float:[{float:[\"right\",\"left\",\"none\",\"start\",\"end\"]}],clear:[{clear:[\"left\",\"right\",\"both\",\"none\",\"start\",\"end\"]}],isolation:[\"isolate\",\"isolation-auto\"],\"object-fit\":[{object:[\"contain\",\"cover\",\"fill\",\"none\",\"scale-down\"]}],\"object-position\":[{object:[...V(),bt]}],overflow:[{overflow:R()}],\"overflow-x\":[{\"overflow-x\":R()}],\"overflow-y\":[{\"overflow-y\":R()}],overscroll:[{overscroll:I()}],\"overscroll-x\":[{\"overscroll-x\":I()}],\"overscroll-y\":[{\"overscroll-y\":I()}],position:[\"static\",\"fixed\",\"absolute\",\"relative\",\"sticky\"],inset:[{inset:[v]}],\"inset-x\":[{\"inset-x\":[v]}],\"inset-y\":[{\"inset-y\":[v]}],start:[{start:[v]}],end:[{end:[v]}],top:[{top:[v]}],right:[{right:[v]}],bottom:[{bottom:[v]}],left:[{left:[v]}],visibility:[\"visible\",\"invisible\",\"collapse\"],z:[{z:[\"auto\",Kh,bt]}],basis:[{basis:F()}],\"flex-direction\":[{flex:[\"row\",\"row-reverse\",\"col\",\"col-reverse\"]}],\"flex-wrap\":[{flex:[\"wrap\",\"wrap-reverse\",\"nowrap\"]}],flex:[{flex:[\"1\",\"auto\",\"initial\",\"none\",bt]}],grow:[{grow:re()}],shrink:[{shrink:re()}],order:[{order:[\"first\",\"last\",\"none\",Kh,bt]}],\"grid-cols\":[{\"grid-cols\":[Xh]}],\"col-start-end\":[{col:[\"auto\",{span:[\"full\",Kh,bt]},bt]}],\"col-start\":[{\"col-start\":q()}],\"col-end\":[{\"col-end\":q()}],\"grid-rows\":[{\"grid-rows\":[Xh]}],\"row-start-end\":[{row:[\"auto\",{span:[Kh,bt]},bt]}],\"row-start\":[{\"row-start\":q()}],\"row-end\":[{\"row-end\":q()}],\"grid-flow\":[{\"grid-flow\":[\"row\",\"col\",\"dense\",\"row-dense\",\"col-dense\"]}],\"auto-cols\":[{\"auto-cols\":[\"auto\",\"min\",\"max\",\"fr\",bt]}],\"auto-rows\":[{\"auto-rows\":[\"auto\",\"min\",\"max\",\"fr\",bt]}],gap:[{gap:[m]}],\"gap-x\":[{\"gap-x\":[m]}],\"gap-y\":[{\"gap-y\":[m]}],\"justify-content\":[{justify:[\"normal\",...W()]}],\"justify-items\":[{\"justify-items\":[\"start\",\"end\",\"center\",\"stretch\"]}],\"justify-self\":[{\"justify-self\":[\"auto\",\"start\",\"end\",\"center\",\"stretch\"]}],\"align-content\":[{content:[\"normal\",...W(),\"baseline\"]}],\"align-items\":[{items:[\"start\",\"end\",\"center\",\"baseline\",\"stretch\"]}],\"align-self\":[{self:[\"auto\",\"start\",\"end\",\"center\",\"stretch\",\"baseline\"]}],\"place-content\":[{\"place-content\":[...W(),\"baseline\"]}],\"place-items\":[{\"place-items\":[\"start\",\"end\",\"center\",\"baseline\",\"stretch\"]}],\"place-self\":[{\"place-self\":[\"auto\",\"start\",\"end\",\"center\",\"stretch\"]}],p:[{p:[C]}],px:[{px:[C]}],py:[{py:[C]}],ps:[{ps:[C]}],pe:[{pe:[C]}],pt:[{pt:[C]}],pr:[{pr:[C]}],pb:[{pb:[C]}],pl:[{pl:[C]}],m:[{m:[b]}],mx:[{mx:[b]}],my:[{my:[b]}],ms:[{ms:[b]}],me:[{me:[b]}],mt:[{mt:[b]}],mr:[{mr:[b]}],mb:[{mb:[b]}],ml:[{ml:[b]}],\"space-x\":[{\"space-x\":[P]}],\"space-x-reverse\":[\"space-x-reverse\"],\"space-y\":[{\"space-y\":[P]}],\"space-y-reverse\":[\"space-y-reverse\"],w:[{w:[\"auto\",\"min\",\"max\",\"fit\",\"svw\",\"lvw\",\"dvw\",bt,e]}],\"min-w\":[{\"min-w\":[bt,e,\"min\",\"max\",\"fit\"]}],\"max-w\":[{\"max-w\":[bt,e,\"none\",\"full\",\"min\",\"max\",\"fit\",\"prose\",{screen:[hl]},hl]}],h:[{h:[bt,e,\"auto\",\"min\",\"max\",\"fit\",\"svh\",\"lvh\",\"dvh\"]}],\"min-h\":[{\"min-h\":[bt,e,\"min\",\"max\",\"fit\",\"svh\",\"lvh\",\"dvh\"]}],\"max-h\":[{\"max-h\":[bt,e,\"min\",\"max\",\"fit\",\"svh\",\"lvh\",\"dvh\"]}],size:[{size:[bt,e,\"auto\",\"min\",\"max\",\"fit\"]}],\"font-size\":[{text:[\"base\",hl,fl]}],\"font-smoothing\":[\"antialiased\",\"subpixel-antialiased\"],\"font-style\":[\"italic\",\"not-italic\"],\"font-weight\":[{font:[\"thin\",\"extralight\",\"light\",\"normal\",\"medium\",\"semibold\",\"bold\",\"extrabold\",\"black\",Yw]}],\"font-family\":[{font:[Xh]}],\"fvn-normal\":[\"normal-nums\"],\"fvn-ordinal\":[\"ordinal\"],\"fvn-slashed-zero\":[\"slashed-zero\"],\"fvn-figure\":[\"lining-nums\",\"oldstyle-nums\"],\"fvn-spacing\":[\"proportional-nums\",\"tabular-nums\"],\"fvn-fraction\":[\"diagonal-fractions\",\"stacked-fractions\"],tracking:[{tracking:[\"tighter\",\"tight\",\"normal\",\"wide\",\"wider\",\"widest\",bt]}],\"line-clamp\":[{\"line-clamp\":[\"none\",Dd,Yw]}],leading:[{leading:[\"none\",\"tight\",\"snug\",\"normal\",\"relaxed\",\"loose\",ls,bt]}],\"list-image\":[{\"list-image\":[\"none\",bt]}],\"list-style-type\":[{list:[\"none\",\"disc\",\"decimal\",bt]}],\"list-style-position\":[{list:[\"inside\",\"outside\"]}],\"placeholder-color\":[{placeholder:[t]}],\"placeholder-opacity\":[{\"placeholder-opacity\":[w]}],\"text-alignment\":[{text:[\"left\",\"center\",\"right\",\"justify\",\"start\",\"end\"]}],\"text-color\":[{text:[t]}],\"text-opacity\":[{\"text-opacity\":[w]}],\"text-decoration\":[\"underline\",\"overline\",\"line-through\",\"no-underline\"],\"text-decoration-style\":[{decoration:[...z(),\"wavy\"]}],\"text-decoration-thickness\":[{decoration:[\"auto\",\"from-font\",ls,fl]}],\"underline-offset\":[{\"underline-offset\":[\"auto\",ls,bt]}],\"text-decoration-color\":[{decoration:[t]}],\"text-transform\":[\"uppercase\",\"lowercase\",\"capitalize\",\"normal-case\"],\"text-overflow\":[\"truncate\",\"text-ellipsis\",\"text-clip\"],\"text-wrap\":[{text:[\"wrap\",\"nowrap\",\"balance\",\"pretty\"]}],indent:[{indent:D()}],\"vertical-align\":[{align:[\"baseline\",\"top\",\"middle\",\"bottom\",\"text-top\",\"text-bottom\",\"sub\",\"super\",bt]}],whitespace:[{whitespace:[\"normal\",\"nowrap\",\"pre\",\"pre-line\",\"pre-wrap\",\"break-spaces\"]}],break:[{break:[\"normal\",\"words\",\"all\",\"keep\"]}],hyphens:[{hyphens:[\"none\",\"manual\",\"auto\"]}],content:[{content:[\"none\",bt]}],\"bg-attachment\":[{bg:[\"fixed\",\"local\",\"scroll\"]}],\"bg-clip\":[{\"bg-clip\":[\"border\",\"padding\",\"content\",\"text\"]}],\"bg-opacity\":[{\"bg-opacity\":[w]}],\"bg-origin\":[{\"bg-origin\":[\"border\",\"padding\",\"content\"]}],\"bg-position\":[{bg:[...V(),$ae]}],\"bg-repeat\":[{bg:[\"no-repeat\",{repeat:[\"\",\"x\",\"y\",\"round\",\"space\"]}]}],\"bg-size\":[{bg:[\"auto\",\"cover\",\"contain\",Bae]}],\"bg-image\":[{bg:[\"none\",{\"gradient-to\":[\"t\",\"tr\",\"r\",\"br\",\"b\",\"bl\",\"l\",\"tl\"]},Uae]}],\"bg-color\":[{bg:[t]}],\"gradient-from-pos\":[{from:[x]}],\"gradient-via-pos\":[{via:[x]}],\"gradient-to-pos\":[{to:[x]}],\"gradient-from\":[{from:[g]}],\"gradient-via\":[{via:[g]}],\"gradient-to\":[{to:[g]}],rounded:[{rounded:[a]}],\"rounded-s\":[{\"rounded-s\":[a]}],\"rounded-e\":[{\"rounded-e\":[a]}],\"rounded-t\":[{\"rounded-t\":[a]}],\"rounded-r\":[{\"rounded-r\":[a]}],\"rounded-b\":[{\"rounded-b\":[a]}],\"rounded-l\":[{\"rounded-l\":[a]}],\"rounded-ss\":[{\"rounded-ss\":[a]}],\"rounded-se\":[{\"rounded-se\":[a]}],\"rounded-ee\":[{\"rounded-ee\":[a]}],\"rounded-es\":[{\"rounded-es\":[a]}],\"rounded-tl\":[{\"rounded-tl\":[a]}],\"rounded-tr\":[{\"rounded-tr\":[a]}],\"rounded-br\":[{\"rounded-br\":[a]}],\"rounded-bl\":[{\"rounded-bl\":[a]}],\"border-w\":[{border:[s]}],\"border-w-x\":[{\"border-x\":[s]}],\"border-w-y\":[{\"border-y\":[s]}],\"border-w-s\":[{\"border-s\":[s]}],\"border-w-e\":[{\"border-e\":[s]}],\"border-w-t\":[{\"border-t\":[s]}],\"border-w-r\":[{\"border-r\":[s]}],\"border-w-b\":[{\"border-b\":[s]}],\"border-w-l\":[{\"border-l\":[s]}],\"border-opacity\":[{\"border-opacity\":[w]}],\"border-style\":[{border:[...z(),\"hidden\"]}],\"divide-x\":[{\"divide-x\":[s]}],\"divide-x-reverse\":[\"divide-x-reverse\"],\"divide-y\":[{\"divide-y\":[s]}],\"divide-y-reverse\":[\"divide-y-reverse\"],\"divide-opacity\":[{\"divide-opacity\":[w]}],\"divide-style\":[{divide:z()}],\"border-color\":[{border:[i]}],\"border-color-x\":[{\"border-x\":[i]}],\"border-color-y\":[{\"border-y\":[i]}],\"border-color-s\":[{\"border-s\":[i]}],\"border-color-e\":[{\"border-e\":[i]}],\"border-color-t\":[{\"border-t\":[i]}],\"border-color-r\":[{\"border-r\":[i]}],\"border-color-b\":[{\"border-b\":[i]}],\"border-color-l\":[{\"border-l\":[i]}],\"divide-color\":[{divide:[i]}],\"outline-style\":[{outline:[\"\",...z()]}],\"outline-offset\":[{\"outline-offset\":[ls,bt]}],\"outline-w\":[{outline:[ls,fl]}],\"outline-color\":[{outline:[t]}],\"ring-w\":[{ring:B()}],\"ring-w-inset\":[\"ring-inset\"],\"ring-color\":[{ring:[t]}],\"ring-opacity\":[{\"ring-opacity\":[w]}],\"ring-offset-w\":[{\"ring-offset\":[ls,fl]}],\"ring-offset-color\":[{\"ring-offset\":[t]}],shadow:[{shadow:[\"\",\"inner\",\"none\",hl,zae]}],\"shadow-color\":[{shadow:[Xh]}],opacity:[{opacity:[w]}],\"mix-blend\":[{\"mix-blend\":[...G(),\"plus-lighter\",\"plus-darker\"]}],\"bg-blend\":[{\"bg-blend\":G()}],filter:[{filter:[\"\",\"none\"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],\"drop-shadow\":[{\"drop-shadow\":[\"\",\"none\",hl,bt]}],grayscale:[{grayscale:[u]}],\"hue-rotate\":[{\"hue-rotate\":[f]}],invert:[{invert:[h]}],saturate:[{saturate:[_]}],sepia:[{sepia:[A]}],\"backdrop-filter\":[{\"backdrop-filter\":[\"\",\"none\"]}],\"backdrop-blur\":[{\"backdrop-blur\":[r]}],\"backdrop-brightness\":[{\"backdrop-brightness\":[n]}],\"backdrop-contrast\":[{\"backdrop-contrast\":[c]}],\"backdrop-grayscale\":[{\"backdrop-grayscale\":[u]}],\"backdrop-hue-rotate\":[{\"backdrop-hue-rotate\":[f]}],\"backdrop-invert\":[{\"backdrop-invert\":[h]}],\"backdrop-opacity\":[{\"backdrop-opacity\":[w]}],\"backdrop-saturate\":[{\"backdrop-saturate\":[_]}],\"backdrop-sepia\":[{\"backdrop-sepia\":[A]}],\"border-collapse\":[{border:[\"collapse\",\"separate\"]}],\"border-spacing\":[{\"border-spacing\":[o]}],\"border-spacing-x\":[{\"border-spacing-x\":[o]}],\"border-spacing-y\":[{\"border-spacing-y\":[o]}],\"table-layout\":[{table:[\"auto\",\"fixed\"]}],caption:[{caption:[\"top\",\"bottom\"]}],transition:[{transition:[\"none\",\"all\",\"\",\"colors\",\"opacity\",\"shadow\",\"transform\",bt]}],duration:[{duration:L()}],ease:[{ease:[\"linear\",\"in\",\"out\",\"in-out\",bt]}],delay:[{delay:L()}],animate:[{animate:[\"none\",\"spin\",\"ping\",\"pulse\",\"bounce\",bt]}],transform:[{transform:[\"\",\"gpu\",\"none\"]}],scale:[{scale:[N]}],\"scale-x\":[{\"scale-x\":[N]}],\"scale-y\":[{\"scale-y\":[N]}],rotate:[{rotate:[Kh,bt]}],\"translate-x\":[{\"translate-x\":[k]}],\"translate-y\":[{\"translate-y\":[k]}],\"skew-x\":[{\"skew-x\":[T]}],\"skew-y\":[{\"skew-y\":[T]}],\"transform-origin\":[{origin:[\"center\",\"top\",\"top-right\",\"right\",\"bottom-right\",\"bottom\",\"bottom-left\",\"left\",\"top-left\",bt]}],accent:[{accent:[\"auto\",t]}],appearance:[{appearance:[\"none\",\"auto\"]}],cursor:[{cursor:[\"auto\",\"default\",\"pointer\",\"wait\",\"text\",\"move\",\"help\",\"not-allowed\",\"none\",\"context-menu\",\"progress\",\"cell\",\"crosshair\",\"vertical-text\",\"alias\",\"copy\",\"no-drop\",\"grab\",\"grabbing\",\"all-scroll\",\"col-resize\",\"row-resize\",\"n-resize\",\"e-resize\",\"s-resize\",\"w-resize\",\"ne-resize\",\"nw-resize\",\"se-resize\",\"sw-resize\",\"ew-resize\",\"ns-resize\",\"nesw-resize\",\"nwse-resize\",\"zoom-in\",\"zoom-out\",bt]}],\"caret-color\":[{caret:[t]}],\"pointer-events\":[{\"pointer-events\":[\"none\",\"auto\"]}],resize:[{resize:[\"none\",\"y\",\"x\",\"\"]}],\"scroll-behavior\":[{scroll:[\"auto\",\"smooth\"]}],\"scroll-m\":[{\"scroll-m\":D()}],\"scroll-mx\":[{\"scroll-mx\":D()}],\"scroll-my\":[{\"scroll-my\":D()}],\"scroll-ms\":[{\"scroll-ms\":D()}],\"scroll-me\":[{\"scroll-me\":D()}],\"scroll-mt\":[{\"scroll-mt\":D()}],\"scroll-mr\":[{\"scroll-mr\":D()}],\"scroll-mb\":[{\"scroll-mb\":D()}],\"scroll-ml\":[{\"scroll-ml\":D()}],\"scroll-p\":[{\"scroll-p\":D()}],\"scroll-px\":[{\"scroll-px\":D()}],\"scroll-py\":[{\"scroll-py\":D()}],\"scroll-ps\":[{\"scroll-ps\":D()}],\"scroll-pe\":[{\"scroll-pe\":D()}],\"scroll-pt\":[{\"scroll-pt\":D()}],\"scroll-pr\":[{\"scroll-pr\":D()}],\"scroll-pb\":[{\"scroll-pb\":D()}],\"scroll-pl\":[{\"scroll-pl\":D()}],\"snap-align\":[{snap:[\"start\",\"end\",\"center\",\"align-none\"]}],\"snap-stop\":[{snap:[\"normal\",\"always\"]}],\"snap-type\":[{snap:[\"none\",\"x\",\"y\",\"both\"]}],\"snap-strictness\":[{snap:[\"mandatory\",\"proximity\"]}],touch:[{touch:[\"auto\",\"none\",\"manipulation\"]}],\"touch-x\":[{\"touch-pan\":[\"x\",\"left\",\"right\"]}],\"touch-y\":[{\"touch-pan\":[\"y\",\"up\",\"down\"]}],\"touch-pz\":[\"touch-pinch-zoom\"],select:[{select:[\"none\",\"text\",\"all\",\"auto\"]}],\"will-change\":[{\"will-change\":[\"auto\",\"scroll\",\"contents\",\"transform\",bt]}],fill:[{fill:[t,\"none\"]}],\"stroke-w\":[{stroke:[ls,fl,Yw]}],stroke:[{stroke:[t,\"none\"]}],sr:[\"sr-only\",\"not-sr-only\"],\"forced-color-adjust\":[{\"forced-color-adjust\":[\"auto\",\"none\"]}]},conflictingClassGroups:{overflow:[\"overflow-x\",\"overflow-y\"],overscroll:[\"overscroll-x\",\"overscroll-y\"],inset:[\"inset-x\",\"inset-y\",\"start\",\"end\",\"top\",\"right\",\"bottom\",\"left\"],\"inset-x\":[\"right\",\"left\"],\"inset-y\":[\"top\",\"bottom\"],flex:[\"basis\",\"grow\",\"shrink\"],gap:[\"gap-x\",\"gap-y\"],p:[\"px\",\"py\",\"ps\",\"pe\",\"pt\",\"pr\",\"pb\",\"pl\"],px:[\"pr\",\"pl\"],py:[\"pt\",\"pb\"],m:[\"mx\",\"my\",\"ms\",\"me\",\"mt\",\"mr\",\"mb\",\"ml\"],mx:[\"mr\",\"ml\"],my:[\"mt\",\"mb\"],size:[\"w\",\"h\"],\"font-size\":[\"leading\"],\"fvn-normal\":[\"fvn-ordinal\",\"fvn-slashed-zero\",\"fvn-figure\",\"fvn-spacing\",\"fvn-fraction\"],\"fvn-ordinal\":[\"fvn-normal\"],\"fvn-slashed-zero\":[\"fvn-normal\"],\"fvn-figure\":[\"fvn-normal\"],\"fvn-spacing\":[\"fvn-normal\"],\"fvn-fraction\":[\"fvn-normal\"],\"line-clamp\":[\"display\",\"overflow\"],rounded:[\"rounded-s\",\"rounded-e\",\"rounded-t\",\"rounded-r\",\"rounded-b\",\"rounded-l\",\"rounded-ss\",\"rounded-se\",\"rounded-ee\",\"rounded-es\",\"rounded-tl\",\"rounded-tr\",\"rounded-br\",\"rounded-bl\"],\"rounded-s\":[\"rounded-ss\",\"rounded-es\"],\"rounded-e\":[\"rounded-se\",\"rounded-ee\"],\"rounded-t\":[\"rounded-tl\",\"rounded-tr\"],\"rounded-r\":[\"rounded-tr\",\"rounded-br\"],\"rounded-b\":[\"rounded-br\",\"rounded-bl\"],\"rounded-l\":[\"rounded-tl\",\"rounded-bl\"],\"border-spacing\":[\"border-spacing-x\",\"border-spacing-y\"],\"border-w\":[\"border-w-s\",\"border-w-e\",\"border-w-t\",\"border-w-r\",\"border-w-b\",\"border-w-l\"],\"border-w-x\":[\"border-w-r\",\"border-w-l\"],\"border-w-y\":[\"border-w-t\",\"border-w-b\"],\"border-color\":[\"border-color-s\",\"border-color-e\",\"border-color-t\",\"border-color-r\",\"border-color-b\",\"border-color-l\"],\"border-color-x\":[\"border-color-r\",\"border-color-l\"],\"border-color-y\":[\"border-color-t\",\"border-color-b\"],\"scroll-m\":[\"scroll-mx\",\"scroll-my\",\"scroll-ms\",\"scroll-me\",\"scroll-mt\",\"scroll-mr\",\"scroll-mb\",\"scroll-ml\"],\"scroll-mx\":[\"scroll-mr\",\"scroll-ml\"],\"scroll-my\":[\"scroll-mt\",\"scroll-mb\"],\"scroll-p\":[\"scroll-px\",\"scroll-py\",\"scroll-ps\",\"scroll-pe\",\"scroll-pt\",\"scroll-pr\",\"scroll-pb\",\"scroll-pl\"],\"scroll-px\":[\"scroll-pr\",\"scroll-pl\"],\"scroll-py\":[\"scroll-pt\",\"scroll-pb\"],touch:[\"touch-x\",\"touch-y\",\"touch-pz\"],\"touch-x\":[\"touch\"],\"touch-y\":[\"touch\"],\"touch-pz\":[\"touch\"]},conflictingClassGroupModifiers:{\"font-size\":[\"leading\"]}}},Kae=Tae(Gae);function dt(...t){return Kae(Mt(t))}const Kj=HU,Xae=GU,Yae=KU,tz=E.forwardRef(({className:t,...e},r)=>l.jsx(Uj,{ref:r,className:dt(\"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",t),...e}));tz.displayName=Uj.displayName;const Rx=E.forwardRef(({className:t,children:e,...r},n)=>l.jsxs(Yae,{children:[l.jsx(tz,{}),l.jsxs(zj,{ref:n,className:dt(\"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border-2 border-gray-300 bg-white dark:bg-gray-800 text-gray-900 dark:text-white p-6 shadow-2xl backdrop-blur-sm duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",t),...r,children:[e,l.jsxs(Hj,{className:\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\",children:[l.jsx(Wl,{className:\"h-4 w-4\"}),l.jsx(\"span\",{className:\"sr-only\",children:\"Close\"})]})]})]}));Rx.displayName=zj.displayName;const Xj=({className:t,...e})=>l.jsx(\"div\",{className:dt(\"flex flex-col space-y-1.5 text-center sm:text-left\",t),...e});Xj.displayName=\"DialogHeader\";const Fx=E.forwardRef(({className:t,...e},r)=>l.jsx(Wj,{ref:r,className:dt(\"text-lg font-semibold leading-none tracking-tight\",t),...e}));Fx.displayName=Wj.displayName;const Lx=E.forwardRef(({className:t,...e},r)=>l.jsx(qj,{ref:r,className:dt(\"text-sm font-medium text-gray-700 dark:text-gray-300\",t),...e}));Lx.displayName=qj.displayName;const uI=t=>typeof t==\"boolean\"?`${t}`:t===0?\"0\":t,dI=Mt,Bx=(t,e)=>r=>{var n;if((e==null?void 0:e.variants)==null)return dI(t,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:i,defaultVariants:a}=e,o=Object.keys(i).map(u=>{const f=r==null?void 0:r[u],h=a==null?void 0:a[u];if(f===null)return null;const m=uI(f)||uI(h);return i[u][m]}),s=r&&Object.entries(r).reduce((u,f)=>{let[h,m]=f;return m===void 0||(u[h]=m),u},{}),c=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((u,f)=>{let{class:h,className:m,...g}=f;return Object.entries(g).every(x=>{let[v,b]=x;return Array.isArray(b)?b.includes({...a,...s}[v]):{...a,...s}[v]===b})?[...u,h,m]:u},[]);return dI(t,o,c,r==null?void 0:r.class,r==null?void 0:r.className)},Yj=Bx(\"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",{variants:{variant:{default:\"bg-primary text-primary-foreground hover:bg-primary/90\",destructive:\"bg-destructive text-destructive-foreground hover:bg-destructive/90\",outline:\"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",secondary:\"bg-secondary text-secondary-foreground hover:bg-secondary/80\",ghost:\"hover:bg-accent hover:text-accent-foreground\",link:\"text-primary underline-offset-4 hover:underline\"},size:{default:\"h-10 px-4 py-2\",sm:\"h-9 rounded-md px-3\",lg:\"h-11 rounded-md px-8\",icon:\"h-10 w-10\"}},defaultVariants:{variant:\"default\",size:\"default\"}}),Oe=E.forwardRef(({className:t,variant:e,size:r,asChild:n=!1,...i},a)=>{const o=n?gU:\"button\";return l.jsx(o,{className:dt(Yj({variant:e,size:r,className:t})),ref:a,...i})});Oe.displayName=\"Button\";function Zae(t,e){var r=Object.setPrototypeOf;r?r(t,e):t.__proto__=e}function Qae(t,e){e===void 0&&(e=t.constructor);var r=Error.captureStackTrace;r&&r(t,e)}var Jae=(function(){var t=function(r,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(i[o]=a[o])},t(r,n)};return function(e,r){if(typeof r!=\"function\"&&r!==null)throw new TypeError(\"Class extends value \"+String(r)+\" is not a constructor or null\");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),eoe=(function(t){Jae(e,t);function e(r,n){var i=this.constructor,a=t.call(this,r,n)||this;return Object.defineProperty(a,\"name\",{value:i.name,enumerable:!1,configurable:!0}),Zae(a,i.prototype),Qae(a),a}return e})(Error),toe=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),Ni=(function(t){toe(e,t);function e(r){r===void 0&&(r=void 0);var n=t.call(this,r)||this;return n.message=r,n}return e.prototype.getKind=function(){var r=this.constructor;return r.kind},e.kind=\"Exception\",e})(eoe),roe=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),$r=(function(t){roe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind=\"ArgumentException\",e})(Ni),noe=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),it=(function(t){noe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind=\"IllegalArgumentException\",e})(Ni),Zj=(function(){function t(e){if(this.binarizer=e,e===null)throw new it(\"Binarizer must be non-null.\")}return t.prototype.getWidth=function(){return this.binarizer.getWidth()},t.prototype.getHeight=function(){return this.binarizer.getHeight()},t.prototype.getBlackRow=function(e,r){return this.binarizer.getBlackRow(e,r)},t.prototype.getBlackMatrix=function(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix},t.prototype.isCropSupported=function(){return this.binarizer.getLuminanceSource().isCropSupported()},t.prototype.crop=function(e,r,n,i){var a=this.binarizer.getLuminanceSource().crop(e,r,n,i);return new t(this.binarizer.createBinarizer(a))},t.prototype.isRotateSupported=function(){return this.binarizer.getLuminanceSource().isRotateSupported()},t.prototype.rotateCounterClockwise=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new t(this.binarizer.createBinarizer(e))},t.prototype.rotateCounterClockwise45=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new t(this.binarizer.createBinarizer(e))},t.prototype.toString=function(){try{return this.getBlackMatrix().toString()}catch{return\"\"}},t})(),ioe=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),Yr=(function(t){ioe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.getChecksumInstance=function(){return new e},e.kind=\"ChecksumException\",e})(Ni),rz=(function(){function t(e){this.source=e}return t.prototype.getLuminanceSource=function(){return this.source},t.prototype.getWidth=function(){return this.source.getWidth()},t.prototype.getHeight=function(){return this.source.getHeight()},t})(),cr=(function(){function t(){}return t.arraycopy=function(e,r,n,i,a){for(;a--;)n[i++]=e[r++]},t.currentTimeMillis=function(){return Date.now()},t})(),aoe=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),Qj=(function(t){aoe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind=\"IndexOutOfBoundsException\",e})(Ni),ooe=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),fI=(function(t){ooe(e,t);function e(r,n){r===void 0&&(r=void 0),n===void 0&&(n=void 0);var i=t.call(this,n)||this;return i.index=r,i.message=n,i}return e.kind=\"ArrayIndexOutOfBoundsException\",e})(Qj),soe=function(t){var e=typeof Symbol==\"function\"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length==\"number\")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")},an=(function(){function t(){}return t.fill=function(e,r){for(var n=0,i=e.length;n<i;n++)e[n]=r},t.fillWithin=function(e,r,n,i){t.rangeCheck(e.length,r,n);for(var a=r;a<n;a++)e[a]=i},t.rangeCheck=function(e,r,n){if(r>n)throw new it(\"fromIndex(\"+r+\") > toIndex(\"+n+\")\");if(r<0)throw new fI(r);if(n>e)throw new fI(n)},t.asList=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e},t.create=function(e,r,n){var i=Array.from({length:e});return i.map(function(a){return Array.from({length:r}).fill(n)})},t.createInt32Array=function(e,r,n){var i=Array.from({length:e});return i.map(function(a){return Int32Array.from({length:r}).fill(n)})},t.equals=function(e,r){if(!e||!r||!e.length||!r.length||e.length!==r.length)return!1;for(var n=0,i=e.length;n<i;n++)if(e[n]!==r[n])return!1;return!0},t.hashCode=function(e){var r,n;if(e===null)return 0;var i=1;try{for(var a=soe(e),o=a.next();!o.done;o=a.next()){var s=o.value;i=31*i+s}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return i},t.fillUint8Array=function(e,r){for(var n=0;n!==e.length;n++)e[n]=r},t.copyOf=function(e,r){return e.slice(0,r)},t.copyOfUint8Array=function(e,r){if(e.length<=r){var n=new Uint8Array(r);return n.set(e),n}return e.slice(0,r)},t.copyOfRange=function(e,r,n){var i=n-r,a=new Int32Array(i);return cr.arraycopy(e,r,a,0,i),a},t.binarySearch=function(e,r,n){n===void 0&&(n=t.numberComparator);for(var i=0,a=e.length-1;i<=a;){var o=a+i>>1,s=n(r,e[o]);if(s>0)i=o+1;else if(s<0)a=o-1;else return o}return-i-1},t.numberComparator=function(e,r){return e-r},t})(),At=(function(){function t(){}return t.numberOfTrailingZeros=function(e){var r;if(e===0)return 32;var n=31;return r=e<<16,r!==0&&(n-=16,e=r),r=e<<8,r!==0&&(n-=8,e=r),r=e<<4,r!==0&&(n-=4,e=r),r=e<<2,r!==0&&(n-=2,e=r),n-(e<<1>>>31)},t.numberOfLeadingZeros=function(e){if(e===0)return 32;var r=1;return e>>>16||(r+=16,e<<=16),e>>>24||(r+=8,e<<=8),e>>>28||(r+=4,e<<=4),e>>>30||(r+=2,e<<=2),r-=e>>>31,r},t.toHexString=function(e){return e.toString(16)},t.toBinaryString=function(e){return String(parseInt(String(e),2))},t.bitCount=function(e){return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),e=e+(e>>>4)&252645135,e=e+(e>>>8),e=e+(e>>>16),e&63},t.truncDivision=function(e,r){return Math.trunc(e/r)},t.parseInt=function(e,r){return r===void 0&&(r=void 0),parseInt(e,r)},t.MIN_VALUE_32_BITS=-2147483648,t.MAX_VALUE=Number.MAX_SAFE_INTEGER,t})(),yn=(function(){function t(e,r){e===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,r==null?this.bits=t.makeArray(e):this.bits=r)}return t.prototype.getSize=function(){return this.size},t.prototype.getSizeInBytes=function(){return Math.floor((this.size+7)/8)},t.prototype.ensureCapacity=function(e){if(e>this.bits.length*32){var r=t.makeArray(e);cr.arraycopy(this.bits,0,r,0,this.bits.length),this.bits=r}},t.prototype.get=function(e){return(this.bits[Math.floor(e/32)]&1<<(e&31))!==0},t.prototype.set=function(e){this.bits[Math.floor(e/32)]|=1<<(e&31)},t.prototype.flip=function(e){this.bits[Math.floor(e/32)]^=1<<(e&31)},t.prototype.getNextSet=function(e){var r=this.size;if(e>=r)return r;var n=this.bits,i=Math.floor(e/32),a=n[i];a&=~((1<<(e&31))-1);for(var o=n.length;a===0;){if(++i===o)return r;a=n[i]}var s=i*32+At.numberOfTrailingZeros(a);return s>r?r:s},t.prototype.getNextUnset=function(e){var r=this.size;if(e>=r)return r;var n=this.bits,i=Math.floor(e/32),a=~n[i];a&=~((1<<(e&31))-1);for(var o=n.length;a===0;){if(++i===o)return r;a=~n[i]}var s=i*32+At.numberOfTrailingZeros(a);return s>r?r:s},t.prototype.setBulk=function(e,r){this.bits[Math.floor(e/32)]=r},t.prototype.setRange=function(e,r){if(r<e||e<0||r>this.size)throw new it;if(r!==e){r--;for(var n=Math.floor(e/32),i=Math.floor(r/32),a=this.bits,o=n;o<=i;o++){var s=o>n?0:e&31,c=o<i?31:r&31,u=(2<<c)-(1<<s);a[o]|=u}}},t.prototype.clear=function(){for(var e=this.bits.length,r=this.bits,n=0;n<e;n++)r[n]=0},t.prototype.isRange=function(e,r,n){if(r<e||e<0||r>this.size)throw new it;if(r===e)return!0;r--;for(var i=Math.floor(e/32),a=Math.floor(r/32),o=this.bits,s=i;s<=a;s++){var c=s>i?0:e&31,u=s<a?31:r&31,f=(2<<u)-(1<<c)&4294967295;if((o[s]&f)!==(n?f:0))return!1}return!0},t.prototype.appendBit=function(e){this.ensureCapacity(this.size+1),e&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++},t.prototype.appendBits=function(e,r){if(r<0||r>32)throw new it(\"Num bits must be between 0 and 32\");this.ensureCapacity(this.size+r);for(var n=r;n>0;n--)this.appendBit((e>>n-1&1)===1)},t.prototype.appendBitArray=function(e){var r=e.size;this.ensureCapacity(this.size+r);for(var n=0;n<r;n++)this.appendBit(e.get(n))},t.prototype.xor=function(e){if(this.size!==e.size)throw new it(\"Sizes don't match\");for(var r=this.bits,n=0,i=r.length;n<i;n++)r[n]^=e.bits[n]},t.prototype.toBytes=function(e,r,n,i){for(var a=0;a<i;a++){for(var o=0,s=0;s<8;s++)this.get(e)&&(o|=1<<7-s),e++;r[n+a]=o}},t.prototype.getBitArray=function(){return this.bits},t.prototype.reverse=function(){for(var e=new Int32Array(this.bits.length),r=Math.floor((this.size-1)/32),n=r+1,i=this.bits,a=0;a<n;a++){var o=i[a];o=o>>1&1431655765|(o&1431655765)<<1,o=o>>2&858993459|(o&858993459)<<2,o=o>>4&252645135|(o&252645135)<<4,o=o>>8&16711935|(o&16711935)<<8,o=o>>16&65535|(o&65535)<<16,e[r-a]=o}if(this.size!==n*32){for(var s=n*32-this.size,c=e[0]>>>s,a=1;a<n;a++){var u=e[a];c|=u<<32-s,e[a-1]=c,c=u>>>s}e[n-1]=c}this.bits=e},t.makeArray=function(e){return new Int32Array(Math.floor((e+31)/32))},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.size===r.size&&an.equals(this.bits,r.bits)},t.prototype.hashCode=function(){return 31*this.size+an.hashCode(this.bits)},t.prototype.toString=function(){for(var e=\"\",r=0,n=this.size;r<n;r++)(r&7)===0&&(e+=\" \"),e+=this.get(r)?\"X\":\".\";return e},t.prototype.clone=function(){return new t(this.size,this.bits.slice())},t.prototype.toArray=function(){for(var e=[],r=0,n=this.size;r<n;r++)e.push(this.get(r));return e},t})(),rN;(function(t){t[t.OTHER=0]=\"OTHER\",t[t.PURE_BARCODE=1]=\"PURE_BARCODE\",t[t.POSSIBLE_FORMATS=2]=\"POSSIBLE_FORMATS\",t[t.TRY_HARDER=3]=\"TRY_HARDER\",t[t.CHARACTER_SET=4]=\"CHARACTER_SET\",t[t.ALLOWED_LENGTHS=5]=\"ALLOWED_LENGTHS\",t[t.ASSUME_CODE_39_CHECK_DIGIT=6]=\"ASSUME_CODE_39_CHECK_DIGIT\",t[t.ENABLE_CODE_39_EXTENDED_MODE=7]=\"ENABLE_CODE_39_EXTENDED_MODE\",t[t.ASSUME_GS1=8]=\"ASSUME_GS1\",t[t.RETURN_CODABAR_START_END=9]=\"RETURN_CODABAR_START_END\",t[t.NEED_RESULT_POINT_CALLBACK=10]=\"NEED_RESULT_POINT_CALLBACK\",t[t.ALLOWED_EAN_EXTENSIONS=11]=\"ALLOWED_EAN_EXTENSIONS\"})(rN||(rN={}));const ur=rN;var loe=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),Pe=(function(t){loe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.getFormatInstance=function(){return new e},e.kind=\"FormatException\",e})(Ni),coe=function(t){var e=typeof Symbol==\"function\"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length==\"number\")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")},Jt;(function(t){t[t.Cp437=0]=\"Cp437\",t[t.ISO8859_1=1]=\"ISO8859_1\",t[t.ISO8859_2=2]=\"ISO8859_2\",t[t.ISO8859_3=3]=\"ISO8859_3\",t[t.ISO8859_4=4]=\"ISO8859_4\",t[t.ISO8859_5=5]=\"ISO8859_5\",t[t.ISO8859_6=6]=\"ISO8859_6\",t[t.ISO8859_7=7]=\"ISO8859_7\",t[t.ISO8859_8=8]=\"ISO8859_8\",t[t.ISO8859_9=9]=\"ISO8859_9\",t[t.ISO8859_10=10]=\"ISO8859_10\",t[t.ISO8859_11=11]=\"ISO8859_11\",t[t.ISO8859_13=12]=\"ISO8859_13\",t[t.ISO8859_14=13]=\"ISO8859_14\",t[t.ISO8859_15=14]=\"ISO8859_15\",t[t.ISO8859_16=15]=\"ISO8859_16\",t[t.SJIS=16]=\"SJIS\",t[t.Cp1250=17]=\"Cp1250\",t[t.Cp1251=18]=\"Cp1251\",t[t.Cp1252=19]=\"Cp1252\",t[t.Cp1256=20]=\"Cp1256\",t[t.UnicodeBigUnmarked=21]=\"UnicodeBigUnmarked\",t[t.UTF8=22]=\"UTF8\",t[t.ASCII=23]=\"ASCII\",t[t.Big5=24]=\"Big5\",t[t.GB18030=25]=\"GB18030\",t[t.EUC_KR=26]=\"EUC_KR\"})(Jt||(Jt={}));var nn=(function(){function t(e,r,n){for(var i,a,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];this.valueIdentifier=e,this.name=n,typeof r==\"number\"?this.values=Int32Array.from([r]):this.values=r,this.otherEncodingNames=o,t.VALUE_IDENTIFIER_TO_ECI.set(e,this),t.NAME_TO_ECI.set(n,this);for(var c=this.values,u=0,f=c.length;u!==f;u++){var h=c[u];t.VALUES_TO_ECI.set(h,this)}try{for(var m=coe(o),g=m.next();!g.done;g=m.next()){var x=g.value;t.NAME_TO_ECI.set(x,this)}}catch(v){i={error:v}}finally{try{g&&!g.done&&(a=m.return)&&a.call(m)}finally{if(i)throw i.error}}}return t.prototype.getValueIdentifier=function(){return this.valueIdentifier},t.prototype.getName=function(){return this.name},t.prototype.getValue=function(){return this.values[0]},t.getCharacterSetECIByValue=function(e){if(e<0||e>=900)throw new Pe(\"incorect value\");var r=t.VALUES_TO_ECI.get(e);if(r===void 0)throw new Pe(\"incorect value\");return r},t.getCharacterSetECIByName=function(e){var r=t.NAME_TO_ECI.get(e);if(r===void 0)throw new Pe(\"incorect value\");return r},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.getName()===r.getName()},t.VALUE_IDENTIFIER_TO_ECI=new Map,t.VALUES_TO_ECI=new Map,t.NAME_TO_ECI=new Map,t.Cp437=new t(Jt.Cp437,Int32Array.from([0,2]),\"Cp437\"),t.ISO8859_1=new t(Jt.ISO8859_1,Int32Array.from([1,3]),\"ISO-8859-1\",\"ISO88591\",\"ISO8859_1\"),t.ISO8859_2=new t(Jt.ISO8859_2,4,\"ISO-8859-2\",\"ISO88592\",\"ISO8859_2\"),t.ISO8859_3=new t(Jt.ISO8859_3,5,\"ISO-8859-3\",\"ISO88593\",\"ISO8859_3\"),t.ISO8859_4=new t(Jt.ISO8859_4,6,\"ISO-8859-4\",\"ISO88594\",\"ISO8859_4\"),t.ISO8859_5=new t(Jt.ISO8859_5,7,\"ISO-8859-5\",\"ISO88595\",\"ISO8859_5\"),t.ISO8859_6=new t(Jt.ISO8859_6,8,\"ISO-8859-6\",\"ISO88596\",\"ISO8859_6\"),t.ISO8859_7=new t(Jt.ISO8859_7,9,\"ISO-8859-7\",\"ISO88597\",\"ISO8859_7\"),t.ISO8859_8=new t(Jt.ISO8859_8,10,\"ISO-8859-8\",\"ISO88598\",\"ISO8859_8\"),t.ISO8859_9=new t(Jt.ISO8859_9,11,\"ISO-8859-9\",\"ISO88599\",\"ISO8859_9\"),t.ISO8859_10=new t(Jt.ISO8859_10,12,\"ISO-8859-10\",\"ISO885910\",\"ISO8859_10\"),t.ISO8859_11=new t(Jt.ISO8859_11,13,\"ISO-8859-11\",\"ISO885911\",\"ISO8859_11\"),t.ISO8859_13=new t(Jt.ISO8859_13,15,\"ISO-8859-13\",\"ISO885913\",\"ISO8859_13\"),t.ISO8859_14=new t(Jt.ISO8859_14,16,\"ISO-8859-14\",\"ISO885914\",\"ISO8859_14\"),t.ISO8859_15=new t(Jt.ISO8859_15,17,\"ISO-8859-15\",\"ISO885915\",\"ISO8859_15\"),t.ISO8859_16=new t(Jt.ISO8859_16,18,\"ISO-8859-16\",\"ISO885916\",\"ISO8859_16\"),t.SJIS=new t(Jt.SJIS,20,\"SJIS\",\"Shift_JIS\"),t.Cp1250=new t(Jt.Cp1250,21,\"Cp1250\",\"windows-1250\"),t.Cp1251=new t(Jt.Cp1251,22,\"Cp1251\",\"windows-1251\"),t.Cp1252=new t(Jt.Cp1252,23,\"Cp1252\",\"windows-1252\"),t.Cp1256=new t(Jt.Cp1256,24,\"Cp1256\",\"windows-1256\"),t.UnicodeBigUnmarked=new t(Jt.UnicodeBigUnmarked,25,\"UnicodeBigUnmarked\",\"UTF-16BE\",\"UnicodeBig\"),t.UTF8=new t(Jt.UTF8,26,\"UTF8\",\"UTF-8\"),t.ASCII=new t(Jt.ASCII,Int32Array.from([27,170]),\"ASCII\",\"US-ASCII\"),t.Big5=new t(Jt.Big5,28,\"Big5\"),t.GB18030=new t(Jt.GB18030,29,\"GB18030\",\"GB2312\",\"EUC_CN\",\"GBK\"),t.EUC_KR=new t(Jt.EUC_KR,30,\"EUC_KR\",\"EUC-KR\"),t})(),uoe=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),Pp=(function(t){uoe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind=\"UnsupportedOperationException\",e})(Ni),ta=(function(){function t(){}return t.decode=function(e,r){var n=this.encodingName(r);return this.customDecoder?this.customDecoder(e,n):typeof TextDecoder>\"u\"||this.shouldDecodeOnFallback(n)?this.decodeFallback(e,n):new TextDecoder(n).decode(e)},t.shouldDecodeOnFallback=function(e){return!t.isBrowser()&&e===\"ISO-8859-1\"},t.encode=function(e,r){var n=this.encodingName(r);return this.customEncoder?this.customEncoder(e,n):typeof TextEncoder>\"u\"?this.encodeFallback(e):new TextEncoder().encode(e)},t.isBrowser=function(){return typeof window<\"u\"&&{}.toString.call(window)===\"[object Window]\"},t.encodingName=function(e){return typeof e==\"string\"?e:e.getName()},t.encodingCharacterSet=function(e){return e instanceof nn?e:nn.getCharacterSetECIByName(e)},t.decodeFallback=function(e,r){var n=this.encodingCharacterSet(r);if(t.isDecodeFallbackSupported(n)){for(var i=\"\",a=0,o=e.length;a<o;a++){var s=e[a].toString(16);s.length<2&&(s=\"0\"+s),i+=\"%\"+s}return decodeURIComponent(i)}if(n.equals(nn.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(e.buffer));throw new Pp(\"Encoding \"+this.encodingName(r)+\" not supported by fallback.\")},t.isDecodeFallbackSupported=function(e){return e.equals(nn.UTF8)||e.equals(nn.ISO8859_1)||e.equals(nn.ASCII)},t.encodeFallback=function(e){for(var r=btoa(unescape(encodeURIComponent(e))),n=r.split(\"\"),i=[],a=0;a<n.length;a++)i.push(n[a].charCodeAt(0));return new Uint8Array(i)},t})(),kt=(function(){function t(){}return t.castAsNonUtf8Char=function(e,r){r===void 0&&(r=null);var n=r?r.getName():this.ISO88591;return ta.decode(new Uint8Array([e]),n)},t.guessEncoding=function(e,r){if(r!=null&&r.get(ur.CHARACTER_SET)!==void 0)return r.get(ur.CHARACTER_SET).toString();for(var n=e.length,i=!0,a=!0,o=!0,s=0,c=0,u=0,f=0,h=0,m=0,g=0,x=0,v=0,b=0,w=0,C=e.length>3&&e[0]===239&&e[1]===187&&e[2]===191,_=0;_<n&&(i||a||o);_++){var N=e[_]&255;o&&(s>0?(N&128)===0?o=!1:s--:(N&128)!==0&&((N&64)===0?o=!1:(s++,(N&32)===0?c++:(s++,(N&16)===0?u++:(s++,(N&8)===0?f++:o=!1))))),i&&(N>127&&N<160?i=!1:N>159&&(N<192||N===215||N===247)&&w++),a&&(h>0?N<64||N===127||N>252?a=!1:h--:N===128||N===160||N>239?a=!1:N>160&&N<224?(m++,x=0,g++,g>v&&(v=g)):N>127?(h++,g=0,x++,x>b&&(b=x)):(g=0,x=0))}return o&&s>0&&(o=!1),a&&h>0&&(a=!1),o&&(C||c+u+f>0)?t.UTF8:a&&(t.ASSUME_SHIFT_JIS||v>=3||b>=3)?t.SHIFT_JIS:i&&a?v===2&&m===2||w*10>=n?t.SHIFT_JIS:t.ISO88591:i?t.ISO88591:a?t.SHIFT_JIS:o?t.UTF8:t.PLATFORM_DEFAULT_ENCODING},t.format=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var i=-1;function a(s,c,u,f,h,m){if(s===\"%%\")return\"%\";if(r[++i]!==void 0){s=f?parseInt(f.substr(1)):void 0;var g=h?parseInt(h.substr(1)):void 0,x;switch(m){case\"s\":x=r[i];break;case\"c\":x=r[i][0];break;case\"f\":x=parseFloat(r[i]).toFixed(s);break;case\"p\":x=parseFloat(r[i]).toPrecision(s);break;case\"e\":x=parseFloat(r[i]).toExponential(s);break;case\"x\":x=parseInt(r[i]).toString(g||16);break;case\"d\":x=parseFloat(parseInt(r[i],g||10).toPrecision(s)).toFixed(0);break}x=typeof x==\"object\"?JSON.stringify(x):(+x).toString(g);for(var v=parseInt(u),b=u&&u[0]+\"\"==\"0\"?\"0\":\" \";x.length<v;)x=c!==void 0?x+b:b+x;return x}}var o=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(o,a)},t.getBytes=function(e,r){return ta.encode(e,r)},t.getCharCode=function(e,r){return r===void 0&&(r=0),e.charCodeAt(r)},t.getCharAt=function(e){return String.fromCharCode(e)},t.SHIFT_JIS=nn.SJIS.getName(),t.GB2312=\"GB2312\",t.ISO88591=nn.ISO8859_1.getName(),t.EUC_JP=\"EUC_JP\",t.UTF8=nn.UTF8.getName(),t.PLATFORM_DEFAULT_ENCODING=t.UTF8,t.ASSUME_SHIFT_JIS=!1,t})(),_t=(function(){function t(e){e===void 0&&(e=\"\"),this.value=e}return t.prototype.enableDecoding=function(e){return this.encoding=e,this},t.prototype.append=function(e){return typeof e==\"string\"?this.value+=e.toString():this.encoding?this.value+=kt.castAsNonUtf8Char(e,this.encoding):this.value+=String.fromCharCode(e),this},t.prototype.appendChars=function(e,r,n){for(var i=r;r<r+n;i++)this.append(e[i]);return this},t.prototype.length=function(){return this.value.length},t.prototype.charAt=function(e){return this.value.charAt(e)},t.prototype.deleteCharAt=function(e){this.value=this.value.substr(0,e)+this.value.substring(e+1)},t.prototype.setCharAt=function(e,r){this.value=this.value.substr(0,e)+r+this.value.substr(e+1)},t.prototype.substring=function(e,r){return this.value.substring(e,r)},t.prototype.setLengthToZero=function(){this.value=\"\"},t.prototype.toString=function(){return this.value},t.prototype.insert=function(e,r){this.value=this.value.substring(0,e)+r+this.value.substring(e)},t})(),uo=(function(){function t(e,r,n,i){if(this.width=e,this.height=r,this.rowSize=n,this.bits=i,r==null&&(r=e),this.height=r,e<1||r<1)throw new it(\"Both dimensions must be greater than 0\");n==null&&(n=Math.floor((e+31)/32)),this.rowSize=n,i==null&&(this.bits=new Int32Array(this.rowSize*this.height))}return t.parseFromBooleanArray=function(e){for(var r=e.length,n=e[0].length,i=new t(n,r),a=0;a<r;a++)for(var o=e[a],s=0;s<n;s++)o[s]&&i.set(s,a);return i},t.parseFromString=function(e,r,n){if(e===null)throw new it(\"stringRepresentation cannot be null\");for(var i=new Array(e.length),a=0,o=0,s=-1,c=0,u=0;u<e.length;)if(e.charAt(u)===`\n`||e.charAt(u)===\"\\r\"){if(a>o){if(s===-1)s=a-o;else if(a-o!==s)throw new it(\"row lengths do not match\");o=a,c++}u++}else if(e.substring(u,u+r.length)===r)u+=r.length,i[a]=!0,a++;else if(e.substring(u,u+n.length)===n)u+=n.length,i[a]=!1,a++;else throw new it(\"illegal character encountered: \"+e.substring(u));if(a>o){if(s===-1)s=a-o;else if(a-o!==s)throw new it(\"row lengths do not match\");c++}for(var f=new t(s,c),h=0;h<a;h++)i[h]&&f.set(Math.floor(h%s),Math.floor(h/s));return f},t.prototype.get=function(e,r){var n=r*this.rowSize+Math.floor(e/32);return(this.bits[n]>>>(e&31)&1)!==0},t.prototype.set=function(e,r){var n=r*this.rowSize+Math.floor(e/32);this.bits[n]|=1<<(e&31)&4294967295},t.prototype.unset=function(e,r){var n=r*this.rowSize+Math.floor(e/32);this.bits[n]&=~(1<<(e&31)&4294967295)},t.prototype.flip=function(e,r){var n=r*this.rowSize+Math.floor(e/32);this.bits[n]^=1<<(e&31)&4294967295},t.prototype.xor=function(e){if(this.width!==e.getWidth()||this.height!==e.getHeight()||this.rowSize!==e.getRowSize())throw new it(\"input matrix dimensions do not match\");for(var r=new yn(Math.floor(this.width/32)+1),n=this.rowSize,i=this.bits,a=0,o=this.height;a<o;a++)for(var s=a*n,c=e.getRow(a,r).getBitArray(),u=0;u<n;u++)i[s+u]^=c[u]},t.prototype.clear=function(){for(var e=this.bits,r=e.length,n=0;n<r;n++)e[n]=0},t.prototype.setRegion=function(e,r,n,i){if(r<0||e<0)throw new it(\"Left and top must be nonnegative\");if(i<1||n<1)throw new it(\"Height and width must be at least 1\");var a=e+n,o=r+i;if(o>this.height||a>this.width)throw new it(\"The region must fit inside the matrix\");for(var s=this.rowSize,c=this.bits,u=r;u<o;u++)for(var f=u*s,h=e;h<a;h++)c[f+Math.floor(h/32)]|=1<<(h&31)&4294967295},t.prototype.getRow=function(e,r){r==null||r.getSize()<this.width?r=new yn(this.width):r.clear();for(var n=this.rowSize,i=this.bits,a=e*n,o=0;o<n;o++)r.setBulk(o*32,i[a+o]);return r},t.prototype.setRow=function(e,r){cr.arraycopy(r.getBitArray(),0,this.bits,e*this.rowSize,this.rowSize)},t.prototype.rotate180=function(){for(var e=this.getWidth(),r=this.getHeight(),n=new yn(e),i=new yn(e),a=0,o=Math.floor((r+1)/2);a<o;a++)n=this.getRow(a,n),i=this.getRow(r-1-a,i),n.reverse(),i.reverse(),this.setRow(a,i),this.setRow(r-1-a,n)},t.prototype.getEnclosingRectangle=function(){for(var e=this.width,r=this.height,n=this.rowSize,i=this.bits,a=e,o=r,s=-1,c=-1,u=0;u<r;u++)for(var f=0;f<n;f++){var h=i[u*n+f];if(h!==0){if(u<o&&(o=u),u>c&&(c=u),f*32<a){for(var m=0;(h<<31-m&4294967295)===0;)m++;f*32+m<a&&(a=f*32+m)}if(f*32+31>s){for(var m=31;!(h>>>m);)m--;f*32+m>s&&(s=f*32+m)}}}return s<a||c<o?null:Int32Array.from([a,o,s-a+1,c-o+1])},t.prototype.getTopLeftOnBit=function(){for(var e=this.rowSize,r=this.bits,n=0;n<r.length&&r[n]===0;)n++;if(n===r.length)return null;for(var i=n/e,a=n%e*32,o=r[n],s=0;(o<<31-s&4294967295)===0;)s++;return a+=s,Int32Array.from([a,i])},t.prototype.getBottomRightOnBit=function(){for(var e=this.rowSize,r=this.bits,n=r.length-1;n>=0&&r[n]===0;)n--;if(n<0)return null;for(var i=Math.floor(n/e),a=Math.floor(n%e)*32,o=r[n],s=31;!(o>>>s);)s--;return a+=s,Int32Array.from([a,i])},t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.getRowSize=function(){return this.rowSize},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.width===r.width&&this.height===r.height&&this.rowSize===r.rowSize&&an.equals(this.bits,r.bits)},t.prototype.hashCode=function(){var e=this.width;return e=31*e+this.width,e=31*e+this.height,e=31*e+this.rowSize,e=31*e+an.hashCode(this.bits),e},t.prototype.toString=function(e,r,n){return e===void 0&&(e=\"X \"),r===void 0&&(r=\"  \"),n===void 0&&(n=`\n`),this.buildToString(e,r,n)},t.prototype.buildToString=function(e,r,n){for(var i=new _t,a=0,o=this.height;a<o;a++){for(var s=0,c=this.width;s<c;s++)i.append(this.get(s,a)?e:r);i.append(n)}return i.toString()},t.prototype.clone=function(){return new t(this.width,this.height,this.rowSize,this.bits.slice())},t})(),doe=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),de=(function(t){doe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.getNotFoundInstance=function(){return new e},e.kind=\"NotFoundException\",e})(Ni),foe=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),nz=(function(t){foe(e,t);function e(r){var n=t.call(this,r)||this;return n.luminances=e.EMPTY,n.buckets=new Int32Array(e.LUMINANCE_BUCKETS),n}return e.prototype.getBlackRow=function(r,n){var i=this.getLuminanceSource(),a=i.getWidth();n==null||n.getSize()<a?n=new yn(a):n.clear(),this.initArrays(a);for(var o=i.getRow(r,this.luminances),s=this.buckets,c=0;c<a;c++)s[(o[c]&255)>>e.LUMINANCE_SHIFT]++;var u=e.estimateBlackPoint(s);if(a<3)for(var c=0;c<a;c++)(o[c]&255)<u&&n.set(c);else for(var f=o[0]&255,h=o[1]&255,c=1;c<a-1;c++){var m=o[c+1]&255;(h*4-f-m)/2<u&&n.set(c),f=h,h=m}return n},e.prototype.getBlackMatrix=function(){var r=this.getLuminanceSource(),n=r.getWidth(),i=r.getHeight(),a=new uo(n,i);this.initArrays(n);for(var o=this.buckets,s=1;s<5;s++)for(var c=Math.floor(i*s/5),u=r.getRow(c,this.luminances),f=Math.floor(n*4/5),h=Math.floor(n/5);h<f;h++){var m=u[h]&255;o[m>>e.LUMINANCE_SHIFT]++}for(var g=e.estimateBlackPoint(o),x=r.getMatrix(),s=0;s<i;s++)for(var v=s*n,h=0;h<n;h++){var m=x[v+h]&255;m<g&&a.set(h,s)}return a},e.prototype.createBinarizer=function(r){return new e(r)},e.prototype.initArrays=function(r){this.luminances.length<r&&(this.luminances=new Uint8ClampedArray(r));for(var n=this.buckets,i=0;i<e.LUMINANCE_BUCKETS;i++)n[i]=0},e.estimateBlackPoint=function(r){for(var n=r.length,i=0,a=0,o=0,s=0;s<n;s++)r[s]>o&&(a=s,o=r[s]),r[s]>i&&(i=r[s]);for(var c=0,u=0,s=0;s<n;s++){var f=s-a,h=r[s]*f*f;h>u&&(c=s,u=h)}if(a>c){var m=a;a=c,c=m}if(c-a<=n/16)throw new de;for(var g=c-1,x=-1,s=c-1;s>a;s--){var v=s-a,h=v*v*(c-s)*(i-r[s]);h>x&&(g=s,x=h)}return g<<e.LUMINANCE_SHIFT},e.LUMINANCE_BITS=5,e.LUMINANCE_SHIFT=8-e.LUMINANCE_BITS,e.LUMINANCE_BUCKETS=1<<e.LUMINANCE_BITS,e.EMPTY=Uint8ClampedArray.from([0]),e})(rz),hoe=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),Jj=(function(t){hoe(e,t);function e(r){var n=t.call(this,r)||this;return n.matrix=null,n}return e.prototype.getBlackMatrix=function(){if(this.matrix!==null)return this.matrix;var r=this.getLuminanceSource(),n=r.getWidth(),i=r.getHeight();if(n>=e.MINIMUM_DIMENSION&&i>=e.MINIMUM_DIMENSION){var a=r.getMatrix(),o=n>>e.BLOCK_SIZE_POWER;(n&e.BLOCK_SIZE_MASK)!==0&&o++;var s=i>>e.BLOCK_SIZE_POWER;(i&e.BLOCK_SIZE_MASK)!==0&&s++;var c=e.calculateBlackPoints(a,o,s,n,i),u=new uo(n,i);e.calculateThresholdForBlock(a,o,s,n,i,c,u),this.matrix=u}else this.matrix=t.prototype.getBlackMatrix.call(this);return this.matrix},e.prototype.createBinarizer=function(r){return new e(r)},e.calculateThresholdForBlock=function(r,n,i,a,o,s,c){for(var u=o-e.BLOCK_SIZE,f=a-e.BLOCK_SIZE,h=0;h<i;h++){var m=h<<e.BLOCK_SIZE_POWER;m>u&&(m=u);for(var g=e.cap(h,2,i-3),x=0;x<n;x++){var v=x<<e.BLOCK_SIZE_POWER;v>f&&(v=f);for(var b=e.cap(x,2,n-3),w=0,C=-2;C<=2;C++){var _=s[g+C];w+=_[b-2]+_[b-1]+_[b]+_[b+1]+_[b+2]}var N=w/25;e.thresholdBlock(r,v,m,N,a,c)}}},e.cap=function(r,n,i){return r<n?n:r>i?i:r},e.thresholdBlock=function(r,n,i,a,o,s){for(var c=0,u=i*o+n;c<e.BLOCK_SIZE;c++,u+=o)for(var f=0;f<e.BLOCK_SIZE;f++)(r[u+f]&255)<=a&&s.set(n+f,i+c)},e.calculateBlackPoints=function(r,n,i,a,o){for(var s=o-e.BLOCK_SIZE,c=a-e.BLOCK_SIZE,u=new Array(i),f=0;f<i;f++){u[f]=new Int32Array(n);var h=f<<e.BLOCK_SIZE_POWER;h>s&&(h=s);for(var m=0;m<n;m++){var g=m<<e.BLOCK_SIZE_POWER;g>c&&(g=c);for(var x=0,v=255,b=0,w=0,C=h*a+g;w<e.BLOCK_SIZE;w++,C+=a){for(var _=0;_<e.BLOCK_SIZE;_++){var N=r[C+_]&255;x+=N,N<v&&(v=N),N>b&&(b=N)}if(b-v>e.MIN_DYNAMIC_RANGE)for(w++,C+=a;w<e.BLOCK_SIZE;w++,C+=a)for(var _=0;_<e.BLOCK_SIZE;_++)x+=r[C+_]&255}var A=x>>e.BLOCK_SIZE_POWER*2;if(b-v<=e.MIN_DYNAMIC_RANGE&&(A=v/2,f>0&&m>0)){var T=(u[f-1][m]+2*u[f][m-1]+u[f-1][m-1])/4;v<T&&(A=T)}u[f][m]=A}}return u},e.BLOCK_SIZE_POWER=3,e.BLOCK_SIZE=1<<e.BLOCK_SIZE_POWER,e.BLOCK_SIZE_MASK=e.BLOCK_SIZE-1,e.MINIMUM_DIMENSION=e.BLOCK_SIZE*5,e.MIN_DYNAMIC_RANGE=24,e})(nz),Hf=(function(){function t(e,r){this.width=e,this.height=r}return t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.isCropSupported=function(){return!1},t.prototype.crop=function(e,r,n,i){throw new Pp(\"This luminance source does not support cropping.\")},t.prototype.isRotateSupported=function(){return!1},t.prototype.rotateCounterClockwise=function(){throw new Pp(\"This luminance source does not support rotation by 90 degrees.\")},t.prototype.rotateCounterClockwise45=function(){throw new Pp(\"This luminance source does not support rotation by 45 degrees.\")},t.prototype.toString=function(){for(var e=new Uint8ClampedArray(this.width),r=new _t,n=0;n<this.height;n++){for(var i=this.getRow(n,e),a=0;a<this.width;a++){var o=i[a]&255,s=void 0;o<64?s=\"#\":o<128?s=\"+\":o<192?s=\".\":s=\" \",r.append(s)}r.append(`\n`)}return r.toString()},t})(),poe=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),c0=(function(t){poe(e,t);function e(r){var n=t.call(this,r.getWidth(),r.getHeight())||this;return n.delegate=r,n}return e.prototype.getRow=function(r,n){for(var i=this.delegate.getRow(r,n),a=this.getWidth(),o=0;o<a;o++)i[o]=255-(i[o]&255);return i},e.prototype.getMatrix=function(){for(var r=this.delegate.getMatrix(),n=this.getWidth()*this.getHeight(),i=new Uint8ClampedArray(n),a=0;a<n;a++)i[a]=255-(r[a]&255);return i},e.prototype.isCropSupported=function(){return this.delegate.isCropSupported()},e.prototype.crop=function(r,n,i,a){return new e(this.delegate.crop(r,n,i,a))},e.prototype.isRotateSupported=function(){return this.delegate.isRotateSupported()},e.prototype.invert=function(){return this.delegate},e.prototype.rotateCounterClockwise=function(){return new e(this.delegate.rotateCounterClockwise())},e.prototype.rotateCounterClockwise45=function(){return new e(this.delegate.rotateCounterClockwise45())},e})(Hf),moe=(function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),iz=(function(t){moe(e,t);function e(r,n){n===void 0&&(n=!1);var i=t.call(this,r.width,r.height)||this;return i.canvas=r,i.tempCanvasElement=null,i.buffer=e.makeBufferFromCanvasImageData(r,n),i}return e.makeBufferFromCanvasImageData=function(r,n){n===void 0&&(n=!1);var i=r.getContext(\"2d\").getImageData(0,0,r.width,r.height);return e.toGrayscaleBuffer(i.data,r.width,r.height,n)},e.toGrayscaleBuffer=function(r,n,i,a){a===void 0&&(a=!1);var o=new Uint8ClampedArray(n*i);if(e.FRAME_INDEX=!e.FRAME_INDEX,e.FRAME_INDEX||!a)for(var s=0,c=0,u=r.length;s<u;s+=4,c++){var f=void 0,h=r[s+3];if(h===0)f=255;else{var m=r[s],g=r[s+1],x=r[s+2];f=306*m+601*g+117*x+512>>10}o[c]=f}else for(var s=0,c=0,v=r.length;s<v;s+=4,c++){var f=void 0,h=r[s+3];if(h===0)f=255;else{var m=r[s],g=r[s+1],x=r[s+2];f=306*m+601*g+117*x+5","size_bytes":360000},"client/src/pages/DiaryPage-backup.tsx":{"content":"// This is a backup of the diary page with errors\nimport React, { useState, useEffect } from \"react\";\n// We'll restore this from the working version once we fix the structure","size_bytes":174},"client/src/lib/guest-user.ts":{"content":"/**\n * Guest user management utilities\n * Allows users to use the app without authentication\n */\n\nconst GUEST_USER_KEY = 'platemate_guest_user';\nconst GUEST_MODE_KEY = 'platemate_guest_mode';\n\nexport interface GuestUser {\n  id: string;\n  createdAt: string;\n  isGuest: true;\n}\n\n/**\n * Generate a unique guest user ID\n */\nfunction generateGuestId(): string {\n  return `guest_${Date.now()}_${Math.random().toString(36).substring(2, 15)}`;\n}\n\n/**\n * Check if currently in guest mode\n */\nexport function isGuestMode(): boolean {\n  return localStorage.getItem(GUEST_MODE_KEY) === 'true';\n}\n\n/**\n * Get or create guest user\n */\nexport function getGuestUser(): GuestUser {\n  const existing = localStorage.getItem(GUEST_USER_KEY);\n  \n  if (existing) {\n    try {\n      return JSON.parse(existing);\n    } catch {\n      // Invalid data, create new\n    }\n  }\n  \n  const guestUser: GuestUser = {\n    id: generateGuestId(),\n    createdAt: new Date().toISOString(),\n    isGuest: true\n  };\n  \n  localStorage.setItem(GUEST_USER_KEY, JSON.stringify(guestUser));\n  localStorage.setItem(GUEST_MODE_KEY, 'true');\n  \n  return guestUser;\n}\n\n/**\n * Enable guest mode\n */\nexport function enableGuestMode(): GuestUser {\n  localStorage.setItem(GUEST_MODE_KEY, 'true');\n  return getGuestUser();\n}\n\n/**\n * Disable guest mode (called after successful authentication)\n */\nexport function disableGuestMode(): void {\n  localStorage.removeItem(GUEST_MODE_KEY);\n  // Keep guest user data for migration\n}\n\n/**\n * Clear all guest data (after successful migration or logout)\n */\nexport function clearGuestData(): void {\n  localStorage.removeItem(GUEST_USER_KEY);\n  localStorage.removeItem(GUEST_MODE_KEY);\n  localStorage.removeItem('platemate_guest_diary');\n  localStorage.removeItem('platemate_guest_weights');\n  localStorage.removeItem('platemate_guest_goals');\n}\n\n/**\n * Check if there's guest data to migrate\n */\nexport function hasGuestDataToMigrate(): boolean {\n  const diary = localStorage.getItem('platemate_guest_diary');\n  const weights = localStorage.getItem('platemate_guest_weights');\n  \n  return !!(diary || weights);\n}\n","size_bytes":2095},"server/auth-middleware.ts":{"content":"import { Request, Response, NextFunction } from \"express\";\nimport Database from \"@replit/database\";\nimport { sessions } from \"./session-store\";\n\nconst db = new Database();\n\n// Middleware to validate email/password auth session\nexport async function emailAuthMiddleware(req: any, res: Response, next: NextFunction) {\n  try {\n    const token = req.headers.authorization?.replace(\"Bearer \", \"\");\n\n    if (!token) {\n      // No token provided - continue as unauthenticated\n      return next();\n    }\n\n    const email = sessions[token];\n    \n    if (!email) {\n      // Invalid token - continue as unauthenticated\n      return next();\n    }\n\n    // Verify user still exists in database\n    const userKey = `user:${email}`;\n    const userResult: any = await db.get(userKey);\n\n    if (!userResult || userResult.ok !== true) {\n      // User no longer exists - clean up session\n      delete sessions[token];\n      return next();\n    }\n\n    // Attach user info to request\n    // Use email as the userId for consistency\n    req.user = {\n      email,\n      // Add claims.sub for compatibility with old routes\n      claims: {\n        sub: email\n      }\n    };\n\n    next();\n  } catch (error) {\n    console.error(\"Email auth middleware error:\", error);\n    next(); // Continue even if middleware fails\n  }\n}\n\n// Middleware to require authentication\nexport function requireAuth(req: any, res: Response, next: NextFunction) {\n  if (!req.user || !req.user.email) {\n    return res.status(401).json({ error: \"Authentication required\" });\n  }\n  next();\n}\n","size_bytes":1533},"client/src/pages/RegisterPage.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { buildApiUrl } from '@/lib/api-config';\n\nexport default function RegisterPage() {\n  const [, setLocation] = useLocation();\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [securityAnswer, setSecurityAnswer] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n\n  async function handleRegister(e: React.FormEvent) {\n    e.preventDefault();\n    setError(\"\");\n    setIsLoading(true);\n\n    try {\n      const res = await fetch(buildApiUrl(\"/api/register\"), {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ \n          email: email.trim(), \n          password: password.trim(),\n          securityAnswer: securityAnswer.trim()\n        }),\n      });\n\n      const data = await res.json();\n\n      if (data.success) {\n        alert(\"Account created successfully! Please log in.\");\n        setLocation(\"/login\");\n      } else {\n        setError(data.error || \"Registration failed\");\n      }\n    } catch (err) {\n      setError(\"Network error. Please try again.\");\n    } finally {\n      setIsLoading(false);\n    }\n  }\n\n  return (\n    <div style={{ \n      fontFamily: 'Arial, sans-serif', \n      background: '#f3f0ff', \n      display: 'flex', \n      justifyContent: 'center', \n      alignItems: 'center', \n      minHeight: '100vh',\n      padding: '20px'\n    }}>\n      <div style={{\n        background: 'white',\n        padding: '30px',\n        borderRadius: '15px',\n        boxShadow: '0 4px 12px rgba(0,0,0,0.15)',\n        width: '100%',\n        maxWidth: '360px',\n        textAlign: 'center'\n      }}>\n        <h2 style={{ marginBottom: '20px', color: '#333' }}>Create a PlateMate Account</h2>\n        \n        <form onSubmit={handleRegister}>\n          <input\n            data-testid=\"input-email\"\n            type=\"email\"\n            placeholder=\"Email\"\n            value={email}\n            onChange={(e) => setEmail(e.target.value)}\n            required\n            style={{\n              width: '90%',\n              padding: '10px',\n              margin: '8px 0',\n              borderRadius: '8px',\n              border: '1px solid #ccc',\n              fontSize: '14px'\n            }}\n          />\n          <br />\n          \n          <input\n            data-testid=\"input-password\"\n            type=\"password\"\n            placeholder=\"Password (min 6 characters)\"\n            value={password}\n            onChange={(e) => setPassword(e.target.value)}\n            required\n            minLength={6}\n            style={{\n              width: '90%',\n              padding: '10px',\n              margin: '8px 0',\n              borderRadius: '8px',\n              border: '1px solid #ccc',\n              fontSize: '14px'\n            }}\n          />\n          <br />\n          \n          <div style={{ \n            textAlign: 'left', \n            width: '90%', \n            margin: '15px auto 5px', \n            fontSize: '13px', \n            color: '#555',\n            fontWeight: '500'\n          }}>\n            Security Question: What is your favorite food?\n          </div>\n          \n          <input\n            data-testid=\"input-security-answer\"\n            type=\"text\"\n            placeholder=\"Your answer (for password reset)\"\n            value={securityAnswer}\n            onChange={(e) => setSecurityAnswer(e.target.value)}\n            required\n            style={{\n              width: '90%',\n              padding: '10px',\n              margin: '8px 0',\n              borderRadius: '8px',\n              border: '1px solid #ccc',\n              fontSize: '14px'\n            }}\n          />\n          <br />\n          \n          {error && (\n            <div data-testid=\"text-error\" style={{ \n              color: 'red', \n              fontSize: '14px', \n              marginTop: '10px',\n              marginBottom: '10px' \n            }}>\n              {error}\n            </div>\n          )}\n          \n          <button\n            data-testid=\"button-register\"\n            type=\"submit\"\n            disabled={isLoading}\n            style={{\n              width: '90%',\n              padding: '10px',\n              margin: '8px 0',\n              borderRadius: '8px',\n              border: 'none',\n              background: isLoading ? '#999' : 'purple',\n              color: 'white',\n              cursor: isLoading ? 'not-allowed' : 'pointer',\n              fontSize: '14px',\n              transition: '0.2s'\n            }}\n            onMouseEnter={(e) => {\n              if (!isLoading) e.currentTarget.style.background = '#5a007a';\n            }}\n            onMouseLeave={(e) => {\n              if (!isLoading) e.currentTarget.style.background = 'purple';\n            }}\n          >\n            {isLoading ? 'Creating account...' : 'Register'}\n          </button>\n        </form>\n        \n        <p style={{ marginTop: '15px', fontSize: '14px', color: '#666' }}>\n          Already have an account?{' '}\n          <a\n            data-testid=\"link-login\"\n            href=\"/login\"\n            onClick={(e) => {\n              e.preventDefault();\n              setLocation(\"/login\");\n            }}\n            style={{\n              color: 'purple',\n              textDecoration: 'none',\n              fontWeight: 'bold'\n            }}\n          >\n            Login here\n          </a>\n        </p>\n      </div>\n    </div>\n  );\n}\n","size_bytes":5486},"server/email-auth.ts":{"content":"import { Router } from \"express\";\nimport bcrypt from \"bcryptjs\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport Database from \"@replit/database\";\nimport { sessions } from \"./session-store\";\nimport { storage } from \"./storage\";\n\nconst router = Router();\nconst db = new Database();\n\n// Helper function to get user key in Replit DB\nconst getUserKey = (email: string) => `user:${email}`;\n\n// POST /api/register - create a new user\nrouter.post(\"/register\", async (req, res) => {\n  try {\n    const { email, password, securityAnswer } = req.body;\n\n    // Validate input\n    if (!email || !password) {\n      return res.status(400).json({ error: \"Email and password are required\" });\n    }\n\n    // Validate security answer\n    if (!securityAnswer || securityAnswer.trim().length === 0) {\n      return res.status(400).json({ error: \"Security answer is required\" });\n    }\n\n    // Check if email is valid\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    if (!emailRegex.test(email)) {\n      return res.status(400).json({ error: \"Invalid email format\" });\n    }\n\n    // Check if password meets minimum requirements\n    if (password.length < 6) {\n      return res.status(400).json({ error: \"Password must be at least 6 characters\" });\n    }\n\n    // Check if user already exists\n    const userKey = getUserKey(email);\n    const existingUser: any = await db.get(userKey);\n    const existingUserData = existingUser?.value;\n\n    // If user exists AND has a password, they must login\n    if (existingUserData && existingUserData.passwordHash) {\n      return res.status(400).json({ error: \"User already exists. Please login instead.\" });\n    }\n\n    // Hash password and security answer\n    const passwordHash = await bcrypt.hash(password, 10);\n    const securityAnswerHash = await bcrypt.hash(securityAnswer.trim().toLowerCase(), 10);\n\n    // Create or upgrade user in Replit Database\n    const userData = {\n      passwordHash,\n      securityAnswerHash,\n      createdAt: existingUserData?.createdAt || Date.now(),\n      migratedAt: existingUserData ? Date.now() : undefined\n    };\n\n    await db.set(userKey, userData);\n\n    // Create user in PostgreSQL database (using email as id for consistency)\n    await storage.upsertUser({\n      id: email, // Use email as the user ID for consistency with session management\n      email,\n    });\n\n    // Generate session token\n    const token = uuidv4();\n    sessions[token] = email;\n\n    res.json({\n      success: true,\n      token,\n      user: {\n        email\n      }\n    });\n  } catch (error: any) {\n    console.error(\"Registration error:\", error);\n    res.status(500).json({ error: \"Internal server error\" });\n  }\n});\n\n// POST /api/login - verify user credentials\nrouter.post(\"/login\", async (req, res) => {\n  try {\n    const { email, password } = req.body;\n\n    console.log(\"=== LOGIN ATTEMPT ===\");\n    console.log(\"Email:\", email);\n    console.log(\"Password length:\", password?.length);\n\n    // Validate input\n    if (!email || !password) {\n      console.log(\"ERROR: Missing email or password\");\n      return res.status(400).json({ error: \"Email and password are required\" });\n    }\n\n    // Find user by email\n    const userKey = getUserKey(email);\n    console.log(\"Looking up user with key:\", userKey);\n    \n    const userResult: any = await db.get(userKey);\n    console.log(\"User result:\", JSON.stringify(userResult, null, 2));\n    \n    if (!userResult || userResult.ok !== true || !userResult.value) {\n      console.log(\"ERROR: User not found in database\");\n      return res.status(401).json({ error: \"Invalid email or password\" });\n    }\n\n    const user = userResult.value;\n    console.log(\"User found, has passwordHash:\", !!user.passwordHash);\n\n    // Check if user has a password hash (old users from OIDC system might not)\n    if (!user.passwordHash) {\n      console.log(\"ERROR: User has no password hash\");\n      return res.status(401).json({ \n        error: \"Account needs password setup. Please use 'Forgot Password' to set a new password or register again.\" \n      });\n    }\n\n    // Verify password\n    console.log(\"Verifying password...\");\n    const isValid = await bcrypt.compare(password, user.passwordHash);\n    console.log(\"Password valid:\", isValid);\n    \n    if (!isValid) {\n      console.log(\"ERROR: Invalid password\");\n      return res.status(401).json({ error: \"Invalid email or password\" });\n    }\n\n    // Ensure user exists in PostgreSQL database (for backward compatibility)\n    console.log(\"Upserting user to PostgreSQL...\");\n    await storage.upsertUser({\n      id: email,\n      email,\n    });\n    console.log(\"User upserted successfully\");\n\n    // Generate session token\n    const token = uuidv4();\n    sessions[token] = email;\n    console.log(\"Session created, token:\", token);\n\n    console.log(\"=== LOGIN SUCCESS ===\");\n    res.json({\n      success: true,\n      token,\n      user: {\n        email\n      }\n    });\n  } catch (error: any) {\n    console.error(\"=== LOGIN ERROR ===\");\n    console.error(\"Error message:\", error.message);\n    console.error(\"Error stack:\", error.stack);\n    console.error(\"Error details:\", JSON.stringify(error, null, 2));\n    res.status(500).json({ error: \"Internal server error\", details: error.message });\n  }\n});\n\n// GET /api/checkSession - verify session token validity\nrouter.get(\"/checkSession\", async (req, res) => {\n  try {\n    const token = req.headers.authorization?.replace(\"Bearer \", \"\");\n\n    if (!token) {\n      return res.status(401).json({ error: \"No token provided\" });\n    }\n\n    const email = sessions[token];\n    if (!email) {\n      return res.status(401).json({ error: \"Invalid or expired token\" });\n    }\n\n    // Verify user still exists in database\n    const userKey = getUserKey(email);\n    const userResult: any = await db.get(userKey);\n\n    if (!userResult || userResult.ok !== true) {\n      delete sessions[token];\n      return res.status(401).json({ error: \"User not found\" });\n    }\n\n    res.json({\n      success: true,\n      user: {\n        email\n      }\n    });\n  } catch (error: any) {\n    console.error(\"Check session error:\", error);\n    res.status(500).json({ error: \"Internal server error\" });\n  }\n});\n\n// POST /api/logout - end a user session\nrouter.post(\"/logout\", async (req, res) => {\n  try {\n    const token = req.headers.authorization?.replace(\"Bearer \", \"\");\n\n    if (!token) {\n      return res.status(400).json({ error: \"No token provided\" });\n    }\n\n    // Remove session\n    if (sessions[token]) {\n      delete sessions[token];\n      return res.json({ success: true, message: \"Logged out successfully\" });\n    }\n\n    res.status(400).json({ error: \"Invalid token\" });\n  } catch (error: any) {\n    console.error(\"Logout error:\", error);\n    res.status(500).json({ error: \"Internal server error\" });\n  }\n});\n\n// POST /api/reset-password-verify - verify email and security answer for password reset\nrouter.post(\"/reset-password-verify\", async (req, res) => {\n  try {\n    const { email, securityAnswer } = req.body;\n\n    // Validate input\n    if (!email || !securityAnswer) {\n      return res.status(400).json({ error: \"Email and security answer are required\" });\n    }\n\n    // Find user by email\n    const userKey = getUserKey(email);\n    const userResult: any = await db.get(userKey);\n\n    if (!userResult || userResult.ok !== true || !userResult.value) {\n      return res.status(401).json({ error: \"Invalid email or security answer\" });\n    }\n\n    const user = userResult.value;\n\n    // Verify security answer (case-insensitive)\n    const isValid = await bcrypt.compare(securityAnswer.trim().toLowerCase(), user.securityAnswerHash);\n    \n    if (!isValid) {\n      return res.status(401).json({ error: \"Invalid email or security answer\" });\n    }\n\n    // Generate a temporary reset token (valid for 15 minutes)\n    const resetToken = uuidv4();\n    const resetKey = `reset:${resetToken}`;\n    await db.set(resetKey, {\n      email,\n      expiresAt: Date.now() + 15 * 60 * 1000 // 15 minutes\n    });\n\n    res.json({\n      success: true,\n      resetToken,\n      message: \"Security answer verified. You can now reset your password.\"\n    });\n  } catch (error: any) {\n    console.error(\"Reset password verify error:\", error);\n    res.status(500).json({ error: \"Internal server error\" });\n  }\n});\n\n// POST /api/reset-password - reset password using reset token\nrouter.post(\"/reset-password\", async (req, res) => {\n  try {\n    const { resetToken, newPassword } = req.body;\n\n    // Validate input\n    if (!resetToken || !newPassword) {\n      return res.status(400).json({ error: \"Reset token and new password are required\" });\n    }\n\n    // Check if password meets minimum requirements\n    if (newPassword.length < 6) {\n      return res.status(400).json({ error: \"Password must be at least 6 characters\" });\n    }\n\n    // Verify reset token\n    const resetKey = `reset:${resetToken}`;\n    const resetData: any = await db.get(resetKey);\n\n    if (!resetData || resetData.ok !== true || !resetData.value) {\n      return res.status(401).json({ error: \"Invalid or expired reset token\" });\n    }\n\n    const { email, expiresAt } = resetData.value;\n\n    // Check if token is expired\n    if (Date.now() > expiresAt) {\n      await db.delete(resetKey);\n      return res.status(401).json({ error: \"Reset token has expired\" });\n    }\n\n    // Hash new password\n    const passwordHash = await bcrypt.hash(newPassword, 10);\n\n    // Update user password\n    const userKey = getUserKey(email);\n    const userResult: any = await db.get(userKey);\n    \n    if (!userResult || userResult.ok !== true || !userResult.value) {\n      return res.status(404).json({ error: \"User not found\" });\n    }\n\n    const userData = {\n      ...userResult.value,\n      passwordHash,\n      updatedAt: Date.now()\n    };\n\n    await db.set(userKey, userData);\n\n    // Delete reset token\n    await db.delete(resetKey);\n\n    res.json({\n      success: true,\n      message: \"Password reset successfully. You can now log in with your new password.\"\n    });\n  } catch (error: any) {\n    console.error(\"Reset password error:\", error);\n    res.status(500).json({ error: \"Internal server error\" });\n  }\n});\n\nexport default router;\n","size_bytes":10099},"server/reset-users.ts":{"content":"// One-time script to reset all user accounts\n// Run this with: npx tsx server/reset-users.ts\n\nimport Database from \"@replit/database\";\n\nconst db = new Database();\n\nasync function resetAllUsers() {\n  console.log(\"ðŸ”„ Starting user account reset...\\n\");\n  \n  try {\n    // List all user keys\n    const userKeysResult = await db.list(\"user:\");\n    \n    if (!userKeysResult.ok) {\n      console.error(\"âŒ Error listing user keys:\", userKeysResult.error);\n      process.exit(1);\n    }\n    \n    const userKeys = userKeysResult.value || [];\n    console.log(`ðŸ‘¥ Found ${userKeys.length} user accounts`);\n    \n    // Delete all user keys\n    for (const key of userKeys) {\n      await db.delete(key);\n      console.log(`  âœ… Deleted: ${key}`);\n    }\n    \n    // List all reset token keys\n    const resetKeysResult = await db.list(\"reset:\");\n    \n    if (!resetKeysResult.ok) {\n      console.error(\"âš ï¸  Warning: Could not list reset keys:\", resetKeysResult.error);\n    } else {\n      const resetKeys = resetKeysResult.value || [];\n      console.log(`\\nðŸ”‘ Found ${resetKeys.length} reset tokens`);\n      \n      // Delete all reset keys\n      for (const key of resetKeys) {\n        await db.delete(key);\n        console.log(`  âœ… Deleted: ${key}`);\n      }\n    }\n    \n    console.log(\"\\nâœ¨ All user accounts have been reset!\");\n    console.log(\"ðŸ“ Users will need to register again with email and security question.\");\n    \n  } catch (error) {\n    console.error(\"âŒ Error resetting users:\", error);\n    process.exit(1);\n  }\n}\n\nresetAllUsers();\n","size_bytes":1546},"server/session-store.ts":{"content":"// Singleton session storage with Replit Database persistence\n// This module exports session management functions used by both auth-middleware and email-auth\n\nimport Database from \"@replit/database\";\n\nconst db = new Database();\nconst SESSION_PREFIX = \"session:\";\n\n// In-memory cache for faster lookups\nconst sessionCache: Record<string, string> = {};\n\n// Load all sessions from database into cache on startup\nasync function loadSessionsFromDatabase() {\n  try {\n    const allKeysResult: any = await db.list(SESSION_PREFIX);\n    const allKeys = allKeysResult?.value || [];\n    let loadedCount = 0;\n    \n    for (const key of allKeys) {\n      const emailResult: any = await db.get(key);\n      const email = emailResult?.value;\n      if (email) {\n        const token = key.replace(SESSION_PREFIX, \"\");\n        sessionCache[token] = email;\n        loadedCount++;\n      }\n    }\n    \n    console.log(`âœ… Loaded ${loadedCount} sessions from database`);\n  } catch (error) {\n    console.error(\"Failed to load sessions from database:\", error);\n  }\n}\n\n// Initialize sessions on module load\nloadSessionsFromDatabase();\n\nexport const sessions = new Proxy(sessionCache, {\n  get(target, prop: string) {\n    return target[prop];\n  },\n  \n  set(target, prop: string, value: string) {\n    target[prop] = value;\n    // Persist to database asynchronously\n    db.set(SESSION_PREFIX + prop, value).catch(err => {\n      console.error(\"Failed to persist session to database:\", err);\n    });\n    return true;\n  },\n  \n  deleteProperty(target, prop: string) {\n    delete target[prop];\n    // Remove from database asynchronously\n    db.delete(SESSION_PREFIX + prop).catch(err => {\n      console.error(\"Failed to delete session from database:\", err);\n    });\n    return true;\n  }\n});\n","size_bytes":1754},"server/debug-user.ts":{"content":"// Debug script to check user data in Replit DB\nimport Database from \"@replit/database\";\n\nconst db = new Database();\n\nasync function debugUser() {\n  const email = \"platematetestreview@gmail.com\";\n  const userKey = `user:${email}`;\n  \n  console.log(`\\nðŸ” Checking user data for: ${email}`);\n  console.log(`ðŸ“ User key: ${userKey}\\n`);\n  \n  const result: any = await db.get(userKey);\n  \n  console.log(\"ðŸ“¦ Raw result:\", JSON.stringify(result, null, 2));\n  \n  if (result && result.ok === true && result.value) {\n    console.log(\"\\nâœ… User found!\");\n    console.log(\"ðŸ“Š User data structure:\");\n    console.log(\"  - Has passwordHash:\", !!result.value.passwordHash);\n    console.log(\"  - Has securityAnswerHash:\", !!result.value.securityAnswerHash);\n    console.log(\"  - Has createdAt:\", !!result.value.createdAt);\n    console.log(\"  - Has updatedAt:\", !!result.value.updatedAt);\n    console.log(\"\\nðŸ”‘ Password hash preview:\", result.value.passwordHash?.substring(0, 30) + \"...\");\n  } else {\n    console.log(\"âŒ User not found or invalid structure\");\n  }\n}\n\ndebugUser().catch(console.error);\n","size_bytes":1097},"client/src/pages/LoginPage.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport pmLogo from \"@assets/pm-logo.png\";\nimport { buildApiUrl } from \"@/lib/api-config\";\n\nexport default function LoginPage() {\n  const [, setLocation] = useLocation();\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n  const [doorsOpen, setDoorsOpen] = useState(false);\n\n  async function handleLogin(e: React.FormEvent) {\n    e.preventDefault();\n    setError(\"\");\n    setIsLoading(true);\n\n    try {\n      const res = await fetch(buildApiUrl(\"/api/login\"), {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ email: email.trim(), password: password.trim() }),\n      });\n\n      const data = await res.json();\n\n      if (data.success) {\n        localStorage.setItem(\"auth_token\", data.token);\n        localStorage.setItem(\"auth_user\", JSON.stringify(data.user));\n        \n        // Trigger elevator door animation\n        setDoorsOpen(true);\n        \n        // Redirect after animation completes (3.2s animation + 0.2s buffer)\n        setTimeout(() => {\n          setLocation(\"/\");\n        }, 3400);\n      } else {\n        setError(data.error || \"Login failed\");\n      }\n    } catch (err) {\n      setError(\"Network error. Please try again.\");\n    } finally {\n      setIsLoading(false);\n    }\n  }\n\n  return (\n    <>\n      <style>{`\n        @keyframes doorLeft {\n          0% { transform: translateX(-100%); }\n          19% { transform: translateX(0); }\n          41% { transform: translateX(0); }\n          91% { transform: translateX(-100%); }\n          100% { transform: translateX(-100%); }\n        }\n        @keyframes doorRight {\n          0% { transform: translateX(100%); }\n          19% { transform: translateX(0); }\n          41% { transform: translateX(0); }\n          91% { transform: translateX(100%); }\n          100% { transform: translateX(100%); }\n        }\n        @keyframes fadeInText {\n          0% { opacity: 0; }\n          40% { opacity: 0; }\n          55% { opacity: 1; }\n          100% { opacity: 1; }\n        }\n      `}</style>\n      \n      {/* Elevator Door Overlay - Hidden until login succeeds */}\n      {doorsOpen && (\n        <div style={{\n          position: 'fixed',\n          top: 0,\n          left: 0,\n          width: '100%',\n          height: '100%',\n          zIndex: 9999,\n          pointerEvents: 'none'\n        }}>\n          {/* Background Layer - Purple gradient with metallic welcome text */}\n          <div style={{\n            position: 'absolute',\n            top: 0,\n            left: 0,\n            width: '100%',\n            height: '100%',\n            background: 'linear-gradient(135deg, #8B5CF6 0%, #A855F7 100%)',\n            display: 'flex',\n            flexDirection: 'column',\n            justifyContent: 'center',\n            alignItems: 'center',\n            gap: '10px'\n          }}>\n            <div style={{\n              fontSize: '48px',\n              fontWeight: 'bold',\n              background: 'linear-gradient(135deg, #e0e0e0 0%, #ffffff 25%, #c0c0c0 50%, #ffffff 75%, #e0e0e0 100%)',\n              WebkitBackgroundClip: 'text',\n              WebkitTextFillColor: 'transparent',\n              backgroundClip: 'text',\n              textShadow: '0 0 20px rgba(255,255,255,0.5), 0 2px 4px rgba(0,0,0,0.3)',\n              letterSpacing: '2px',\n              animation: 'fadeInText 3.2s ease-in-out forwards'\n            }}>\n              Welcome\n            </div>\n            <div style={{\n              fontSize: '24px',\n              fontWeight: '500',\n              background: 'linear-gradient(135deg, #d0d0d0 0%, #f5f5f5 50%, #d0d0d0 100%)',\n              WebkitBackgroundClip: 'text',\n              WebkitTextFillColor: 'transparent',\n              backgroundClip: 'text',\n              textShadow: '0 0 15px rgba(255,255,255,0.4), 0 1px 3px rgba(0,0,0,0.2)',\n              letterSpacing: '1px',\n              animation: 'fadeInText 3.2s ease-in-out forwards'\n            }}>\n              to PlateMate\n            </div>\n          </div>\n          \n          {/* Left Metallic Door */}\n          <div style={{\n            position: 'absolute',\n            top: 0,\n            left: 0,\n            width: '50%',\n            height: '100%',\n            background: 'linear-gradient(135deg, #111827 0%, #1f2937 35%, #4b5563 50%, #1f2937 65%, #0f172a 100%)',\n            animation: 'doorLeft 3.2s ease-in-out forwards',\n            boxShadow: 'inset -2px 0 8px rgba(0,0,0,0.5)'\n          }} />\n          \n          {/* Right Metallic Door */}\n          <div style={{\n            position: 'absolute',\n            top: 0,\n            right: 0,\n            width: '50%',\n            height: '100%',\n            background: 'linear-gradient(135deg, #111827 0%, #1f2937 35%, #4b5563 50%, #1f2937 65%, #0f172a 100%)',\n            animation: 'doorRight 3.2s ease-in-out forwards',\n            boxShadow: 'inset 2px 0 8px rgba(0,0,0,0.5)'\n          }} />\n        </div>\n      )}\n\n      <div style={{ \n        fontFamily: 'Arial, sans-serif', \n        background: 'linear-gradient(135deg, #8B5CF6 0%, #A855F7 100%)',\n        display: 'flex', \n        justifyContent: 'center', \n        alignItems: 'center', \n        minHeight: '100vh',\n        padding: '20px'\n      }}>\n        <div style={{\n          background: 'white',\n          padding: '30px',\n          borderRadius: '15px',\n          boxShadow: '0 4px 12px rgba(0,0,0,0.15)',\n          width: '100%',\n          maxWidth: '360px',\n          textAlign: 'center',\n          opacity: doorsOpen ? 0 : 1,\n          transition: 'opacity 0.3s ease-in-out'\n        }}>\n        <h2 style={{ marginBottom: '20px', color: '#333' }}>Login to PlateMate</h2>\n        \n        <form onSubmit={handleLogin}>\n          <input\n            data-testid=\"input-email\"\n            type=\"email\"\n            placeholder=\"Email\"\n            value={email}\n            onChange={(e) => setEmail(e.target.value)}\n            required\n            style={{\n              width: '90%',\n              padding: '10px',\n              margin: '8px 0',\n              borderRadius: '8px',\n              border: '1px solid #ccc',\n              fontSize: '14px'\n            }}\n          />\n          <br />\n          \n          <input\n            data-testid=\"input-password\"\n            type=\"password\"\n            placeholder=\"Password\"\n            value={password}\n            onChange={(e) => setPassword(e.target.value)}\n            required\n            style={{\n              width: '90%',\n              padding: '10px',\n              margin: '8px 0',\n              borderRadius: '8px',\n              border: '1px solid #ccc',\n              fontSize: '14px'\n            }}\n          />\n          <br />\n          \n          {error && (\n            <div data-testid=\"text-error\" style={{ \n              color: 'red', \n              fontSize: '14px', \n              marginTop: '10px',\n              marginBottom: '10px' \n            }}>\n              {error}\n            </div>\n          )}\n          \n          <button\n            data-testid=\"button-login\"\n            type=\"submit\"\n            disabled={isLoading}\n            style={{\n              width: '90%',\n              padding: '10px',\n              margin: '8px 0',\n              borderRadius: '8px',\n              border: 'none',\n              background: isLoading ? '#999' : 'purple',\n              color: 'white',\n              cursor: isLoading ? 'not-allowed' : 'pointer',\n              fontSize: '14px',\n              transition: '0.2s'\n            }}\n            onMouseEnter={(e) => {\n              if (!isLoading) e.currentTarget.style.background = '#5a007a';\n            }}\n            onMouseLeave={(e) => {\n              if (!isLoading) e.currentTarget.style.background = 'purple';\n            }}\n          >\n            {isLoading ? 'Logging in...' : 'Login'}\n          </button>\n        </form>\n        \n        <p style={{ marginTop: '10px', fontSize: '14px', color: '#666' }}>\n          <a\n            data-testid=\"link-forgot-password\"\n            href=\"/forgot-password\"\n            onClick={(e) => {\n              e.preventDefault();\n              setLocation(\"/forgot-password\");\n            }}\n            style={{\n              color: 'purple',\n              textDecoration: 'none',\n              fontWeight: 'bold'\n            }}\n          >\n            Forgot Password?\n          </a>\n        </p>\n        \n        <p style={{ marginTop: '10px', fontSize: '14px', color: '#666' }}>\n          No account?{' '}\n          <a\n            data-testid=\"link-register\"\n            href=\"/register\"\n            onClick={(e) => {\n              e.preventDefault();\n              setLocation(\"/register\");\n            }}\n            style={{\n              color: 'purple',\n              textDecoration: 'none',\n              fontWeight: 'bold'\n            }}\n          >\n            Register here\n          </a>\n        </p>\n        </div>\n      </div>\n    </>\n  );\n}\n","size_bytes":9097},"EMAIL_AUTH_README.md":{"content":"# Email/Password Authentication System\n\n## âœ… Implementation Complete\n\nA simple, independent email/password authentication system has been successfully added to PlateMate using **@replit/database** for user storage.\n\n---\n\n## ðŸ“ Files Created/Modified\n\n### New Files:\n- **`server/email-auth.ts`** - Self-contained authentication module\n\n### Modified Files:\n- **`server/index.ts`** - Added import: `import emailAuthRoutes from \"./email-auth\"`\n\n### Database:\n- **Replit Database** - Key-value storage for user data\n- **In-memory sessions** - Session tokens stored in-memory\n\n---\n\n## ðŸ” Security Features\n\n- âœ… Password hashing with **bcryptjs** (10 salt rounds)\n- âœ… Email validation with regex pattern\n- âœ… Session tokens generated with **uuid v4**\n- âœ… Minimum password length requirement (6 characters)\n- âœ… Secure password comparison\n\n---\n\n## ðŸ› ï¸ API Endpoints\n\n### 1. POST /api/register\nCreate a new user account.\n\n**Request:**\n```json\n{\n  \"email\": \"user@example.com\",\n  \"password\": \"yourpassword\"\n}\n```\n\n**Success Response (200):**\n```json\n{\n  \"success\": true,\n  \"token\": \"uuid-v4-token\",\n  \"user\": {\n    \"email\": \"user@example.com\"\n  }\n}\n```\n\n**Error Responses:**\n- `400` - Missing email or password\n- `400` - Invalid email format\n- `400` - Password too short (< 6 characters)\n- `400` - User already exists\n- `500` - Internal server error\n\n---\n\n### 2. POST /api/login\nAuthenticate an existing user.\n\n**Request:**\n```json\n{\n  \"email\": \"user@example.com\",\n  \"password\": \"yourpassword\"\n}\n```\n\n**Success Response (200):**\n```json\n{\n  \"success\": true,\n  \"token\": \"uuid-v4-token\",\n  \"user\": {\n    \"email\": \"user@example.com\"\n  }\n}\n```\n\n**Error Responses:**\n- `400` - Missing email or password\n- `401` - Invalid email or password\n- `500` - Internal server error\n\n---\n\n### 3. GET /api/checkSession\nVerify if a session token is valid.\n\n**Headers:**\n```\nAuthorization: Bearer <token>\n```\n\n**Success Response (200):**\n```json\n{\n  \"success\": true,\n  \"user\": {\n    \"email\": \"user@example.com\"\n  }\n}\n```\n\n**Error Responses:**\n- `401` - No token provided\n- `401` - Invalid or expired token\n- `401` - User not found\n- `500` - Internal server error\n\n---\n\n### 4. POST /api/logout\nEnd a user session.\n\n**Headers:**\n```\nAuthorization: Bearer <token>\n```\n\n**Success Response (200):**\n```json\n{\n  \"success\": true,\n  \"message\": \"Logged out successfully\"\n}\n```\n\n**Error Responses:**\n- `400` - No token provided or invalid token\n- `500` - Internal server error\n\n---\n\n## ðŸ’¾ Data Storage\n\n### User Storage (Replit Database)\nUsers are stored in Replit's key-value database with the following structure:\n\n**Key Format:** `user:{email}`\n\n**Value:**\n```javascript\n{\n  passwordHash: \"bcrypt-hashed-password\",\n  createdAt: 1760004983461  // Unix timestamp\n}\n```\n\n### Session Storage (In-Memory)\nSessions are stored in-memory as requested:\n```javascript\nconst sessions = {\n  \"uuid-token-1\": \"user1@example.com\",\n  \"uuid-token-2\": \"user2@example.com\"\n}\n```\n\nâš ï¸ **Note:** In-memory sessions will be lost when the server restarts. For production, consider using a persistent session store.\n\n---\n\n## ðŸ§ª Testing Results\n\nAll endpoints have been tested and verified:\n\nâœ… **Registration** - New users created successfully  \nâœ… **Login** - User authentication working correctly  \nâœ… **Session Validation** - Tokens verified properly  \nâœ… **Logout** - Sessions terminated successfully  \nâœ… **Duplicate Prevention** - Existing users cannot re-register  \nâœ… **Main App** - PlateMate app loads and functions normally  \n\n---\n\n## ðŸ“ Integration Details\n\nThe authentication module is imported in `server/index.ts`:\n\n```typescript\nimport emailAuthRoutes from \"./email-auth\";\napp.use(\"/api\", emailAuthRoutes);\n```\n\nThis setup ensures:\n- âœ… No conflicts with existing routes\n- âœ… No modifications to OAuth (Replit/Google) system\n- âœ… No changes to AI analysis or diary features\n- âœ… Completely independent and self-contained\n\n---\n\n## ðŸ”— Example Usage\n\n### Register a New User\n```bash\ncurl -X POST http://localhost:5000/api/register \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"email\":\"user@example.com\",\"password\":\"password123\"}'\n```\n\n### Login\n```bash\ncurl -X POST http://localhost:5000/api/login \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"email\":\"user@example.com\",\"password\":\"password123\"}'\n```\n\n### Check Session\n```bash\ncurl http://localhost:5000/api/checkSession \\\n  -H \"Authorization: Bearer YOUR_TOKEN_HERE\"\n```\n\n### Logout\n```bash\ncurl -X POST http://localhost:5000/api/logout \\\n  -H \"Authorization: Bearer YOUR_TOKEN_HERE\"\n```\n\n---\n\n## âœ… Verification Checklist\n\n- [x] Uses @replit/database for user storage\n- [x] Uses bcryptjs for password hashing\n- [x] Uses uuid v4 for session tokens\n- [x] All 4 endpoints working (/register, /login, /checkSession, /logout)\n- [x] Returns clear JSON responses\n- [x] Sessions stored in-memory\n- [x] No modifications to existing app logic\n- [x] Main PlateMate app runs normally\n- [x] No conflicts with current routes or authentication\n\n---\n\n## ðŸš€ Next Steps\n\nThe authentication system is ready to use! You can now:\n\n1. **Test the endpoints** using the examples above\n2. **Integrate with your frontend** by making API calls\n3. **Switch over** from OAuth when ready (existing OAuth unchanged)\n4. **Extend functionality** - Add password reset, email verification, etc.\n\nThe system is completely independent and won't interfere with your existing app!\n","size_bytes":5395},"client/src/pages/ForgotPasswordPage.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { buildApiUrl } from '@/lib/api-config';\n\nexport default function ForgotPasswordPage() {\n  const [, setLocation] = useLocation();\n  const [step, setStep] = useState<\"verify\" | \"reset\">(\"verify\");\n  \n  // Step 1: Verify email and security answer\n  const [email, setEmail] = useState(\"\");\n  const [securityAnswer, setSecurityAnswer] = useState(\"\");\n  const [isVerifying, setIsVerifying] = useState(false);\n  const [verifyError, setVerifyError] = useState(\"\");\n  \n  // Step 2: Reset password\n  const [resetToken, setResetToken] = useState(\"\");\n  const [newPassword, setNewPassword] = useState(\"\");\n  const [confirmPassword, setConfirmPassword] = useState(\"\");\n  const [isResetting, setIsResetting] = useState(false);\n  const [resetError, setResetError] = useState(\"\");\n\n  async function handleVerify(e: React.FormEvent) {\n    e.preventDefault();\n    setVerifyError(\"\");\n    setIsVerifying(true);\n\n    try {\n      const res = await fetch(buildApiUrl(\"/api/reset-password-verify\"), {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ \n          email: email.trim(), \n          securityAnswer: securityAnswer.trim() \n        }),\n      });\n\n      const data = await res.json();\n\n      if (data.success) {\n        setResetToken(data.resetToken);\n        setStep(\"reset\");\n      } else {\n        setVerifyError(data.error || \"Verification failed\");\n      }\n    } catch (err) {\n      setVerifyError(\"Network error. Please try again.\");\n    } finally {\n      setIsVerifying(false);\n    }\n  }\n\n  async function handleReset(e: React.FormEvent) {\n    e.preventDefault();\n    setResetError(\"\");\n\n    if (newPassword !== confirmPassword) {\n      setResetError(\"Passwords do not match\");\n      return;\n    }\n\n    setIsResetting(true);\n\n    try {\n      const res = await fetch(buildApiUrl(\"/api/reset-password\"), {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ \n          resetToken, \n          newPassword: newPassword.trim() \n        }),\n      });\n\n      const data = await res.json();\n\n      if (data.success) {\n        alert(\"Password reset successfully! You can now log in with your new password.\");\n        setLocation(\"/login\");\n      } else {\n        setResetError(data.error || \"Password reset failed\");\n      }\n    } catch (err) {\n      setResetError(\"Network error. Please try again.\");\n    } finally {\n      setIsResetting(false);\n    }\n  }\n\n  return (\n    <div style={{ \n      fontFamily: 'Arial, sans-serif', \n      background: '#f3f0ff', \n      display: 'flex', \n      justifyContent: 'center', \n      alignItems: 'center', \n      minHeight: '100vh',\n      padding: '20px'\n    }}>\n      <div style={{\n        background: 'white',\n        padding: '30px',\n        borderRadius: '15px',\n        boxShadow: '0 4px 12px rgba(0,0,0,0.15)',\n        width: '100%',\n        maxWidth: '360px',\n        textAlign: 'center'\n      }}>\n        {step === \"verify\" ? (\n          <>\n            <h2 style={{ marginBottom: '10px', color: '#333' }}>Reset Password</h2>\n            <p style={{ fontSize: '14px', color: '#666', marginBottom: '20px' }}>\n              Answer your security question to reset your password\n            </p>\n            \n            <form onSubmit={handleVerify}>\n              <input\n                data-testid=\"input-reset-email\"\n                type=\"email\"\n                placeholder=\"Email\"\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n                required\n                style={{\n                  width: '90%',\n                  padding: '10px',\n                  margin: '8px 0',\n                  borderRadius: '8px',\n                  border: '1px solid #ccc',\n                  fontSize: '14px'\n                }}\n              />\n              <br />\n              \n              <div style={{ \n                textAlign: 'left', \n                width: '90%', \n                margin: '15px auto 5px', \n                fontSize: '13px', \n                color: '#555',\n                fontWeight: '500'\n              }}>\n                Security Question: What is your favorite food?\n              </div>\n              \n              <input\n                data-testid=\"input-reset-security-answer\"\n                type=\"text\"\n                placeholder=\"Your answer\"\n                value={securityAnswer}\n                onChange={(e) => setSecurityAnswer(e.target.value)}\n                required\n                style={{\n                  width: '90%',\n                  padding: '10px',\n                  margin: '8px 0',\n                  borderRadius: '8px',\n                  border: '1px solid #ccc',\n                  fontSize: '14px'\n                }}\n              />\n              <br />\n              \n              {verifyError && (\n                <div data-testid=\"text-verify-error\" style={{ \n                  color: 'red', \n                  fontSize: '14px', \n                  marginTop: '10px',\n                  marginBottom: '10px' \n                }}>\n                  {verifyError}\n                </div>\n              )}\n              \n              <button\n                data-testid=\"button-verify\"\n                type=\"submit\"\n                disabled={isVerifying}\n                style={{\n                  width: '90%',\n                  padding: '10px',\n                  margin: '8px 0',\n                  borderRadius: '8px',\n                  border: 'none',\n                  background: isVerifying ? '#999' : 'purple',\n                  color: 'white',\n                  cursor: isVerifying ? 'not-allowed' : 'pointer',\n                  fontSize: '14px',\n                  transition: '0.2s'\n                }}\n                onMouseEnter={(e) => {\n                  if (!isVerifying) e.currentTarget.style.background = '#5a007a';\n                }}\n                onMouseLeave={(e) => {\n                  if (!isVerifying) e.currentTarget.style.background = 'purple';\n                }}\n              >\n                {isVerifying ? 'Verifying...' : 'Verify'}\n              </button>\n            </form>\n          </>\n        ) : (\n          <>\n            <h2 style={{ marginBottom: '10px', color: '#333' }}>Set New Password</h2>\n            <p style={{ fontSize: '14px', color: '#666', marginBottom: '20px' }}>\n              Enter your new password below\n            </p>\n            \n            <form onSubmit={handleReset}>\n              <input\n                data-testid=\"input-new-password\"\n                type=\"password\"\n                placeholder=\"New Password (min 6 characters)\"\n                value={newPassword}\n                onChange={(e) => setNewPassword(e.target.value)}\n                required\n                minLength={6}\n                style={{\n                  width: '90%',\n                  padding: '10px',\n                  margin: '8px 0',\n                  borderRadius: '8px',\n                  border: '1px solid #ccc',\n                  fontSize: '14px'\n                }}\n              />\n              <br />\n              \n              <input\n                data-testid=\"input-confirm-password\"\n                type=\"password\"\n                placeholder=\"Confirm New Password\"\n                value={confirmPassword}\n                onChange={(e) => setConfirmPassword(e.target.value)}\n                required\n                minLength={6}\n                style={{\n                  width: '90%',\n                  padding: '10px',\n                  margin: '8px 0',\n                  borderRadius: '8px',\n                  border: '1px solid #ccc',\n                  fontSize: '14px'\n                }}\n              />\n              <br />\n              \n              {resetError && (\n                <div data-testid=\"text-reset-error\" style={{ \n                  color: 'red', \n                  fontSize: '14px', \n                  marginTop: '10px',\n                  marginBottom: '10px' \n                }}>\n                  {resetError}\n                </div>\n              )}\n              \n              <button\n                data-testid=\"button-reset-password\"\n                type=\"submit\"\n                disabled={isResetting}\n                style={{\n                  width: '90%',\n                  padding: '10px',\n                  margin: '8px 0',\n                  borderRadius: '8px',\n                  border: 'none',\n                  background: isResetting ? '#999' : 'purple',\n                  color: 'white',\n                  cursor: isResetting ? 'not-allowed' : 'pointer',\n                  fontSize: '14px',\n                  transition: '0.2s'\n                }}\n                onMouseEnter={(e) => {\n                  if (!isResetting) e.currentTarget.style.background = '#5a007a';\n                }}\n                onMouseLeave={(e) => {\n                  if (!isResetting) e.currentTarget.style.background = 'purple';\n                }}\n              >\n                {isResetting ? 'Resetting...' : 'Reset Password'}\n              </button>\n            </form>\n          </>\n        )}\n        \n        <p style={{ marginTop: '15px', fontSize: '14px', color: '#666' }}>\n          Remember your password?{' '}\n          <a\n            data-testid=\"link-login-from-reset\"\n            href=\"/login\"\n            onClick={(e) => {\n              e.preventDefault();\n              setLocation(\"/login\");\n            }}\n            style={{\n              color: 'purple',\n              textDecoration: 'none',\n              fontWeight: 'bold'\n            }}\n          >\n            Login here\n          </a>\n        </p>\n      </div>\n    </div>\n  );\n}\n","size_bytes":9765},"server/uk-food-mapping.ts":{"content":"/**\n * UK to US food term mapping for better USDA database lookups\n * IMPORTANT: Only map unambiguous UK-specific terms to avoid breaking US food names\n */\nexport const UK_TO_US_FOOD_MAP: Record<string, string> = {\n  // Vegetables (UK-specific terms)\n  \"aubergine\": \"eggplant\",\n  \"courgette\": \"zucchini\",\n  \"rocket\": \"arugula\",\n  \"spring onion\": \"scallion\",\n  \"spring onions\": \"scallions\",\n  \"mangetout\": \"snow peas\",\n  \"swede\": \"rutabaga\",\n  \n  // Meats (UK-specific terms - be specific to avoid corrupting \"lamb mince\", \"quorn mince\", etc.)\n  \"beef mince\": \"ground beef\",\n  \"minced beef\": \"ground beef\",\n  \"pork mince\": \"ground pork\", \n  \"minced pork\": \"ground pork\",\n  \"lamb mince\": \"ground lamb\",\n  \"minced lamb\": \"ground lamb\",\n  \"turkey mince\": \"ground turkey\",\n  \"minced turkey\": \"ground turkey\",\n  \"gammon\": \"ham\",\n  \"back bacon\": \"canadian bacon\",\n  \n  // Breakfast cereals (UK-specific)\n  \"weetabix\": \"Weetabix cereal biscuit\",\n  \"weetabix cereal\": \"Weetabix cereal biscuit\",\n  \n  // Dairy (UK-specific)\n  \"single cream\": \"light cream\",\n  \"double cream\": \"heavy cream\",\n  \n  // Other UK-specific foods\n  \"coriander\": \"cilantro\",\n  \"porridge\": \"oatmeal\",\n  \n  // UK snacks - ONLY map specific UK crisp brands/packets\n  \"packet of crisps\": \"bag of potato chips\",\n  \"bag of crisps\": \"bag of potato chips\",\n  \"walkers crisps\": \"potato chips\",\n  \"ready salted crisps\": \"ready salted potato chips\",\n  \n  // Bread and toast (UK to USDA search terms)\n  // Order matters: more specific terms MUST come before general terms\n  \"sliced white bread\": \"bread white\",\n  \"sliced brown bread\": \"bread wheat\",\n  \"sliced wholemeal bread\": \"bread whole wheat\",\n  \"wholemeal toast\": \"bread whole wheat toasted\",\n  \"granary toast\": \"bread multigrain toasted\",\n  \"white toast\": \"bread white toasted\",\n  \"brown toast\": \"bread wheat toasted\",\n  \"wholemeal bread\": \"bread whole wheat\",\n  \"granary bread\": \"bread multigrain\",\n  \"white bread\": \"bread white\",\n  \"brown bread\": \"bread wheat\",\n};\n\n/**\n * Pre-process food text to convert UK terms to US equivalents\n * This improves accuracy when looking up nutrition data in USDA database\n * \n * NOTE: This function is conservative and only replaces unambiguous UK-specific terms.\n * It does NOT replace generic words like \"chips\" or \"biscuit\" that have different meanings\n * in US English (chocolate chips, biscuit gravy, etc.)\n */\nexport function mapUKFoodTerms(text: string): string {\n  let mappedText = text;\n  \n  // Sort mappings by length descending to process longer phrases first\n  // This prevents \"sliced white bread\" from becoming \"bread white wheat\" \n  // (by applying \"sliced bread\" â†’ \"bread white\" then \"white bread\" â†’ \"bread wheat\")\n  const sortedMappings = Object.entries(UK_TO_US_FOOD_MAP).sort((a, b) => b[0].length - a[0].length);\n  \n  // Apply each mapping with word boundaries for precise matching\n  for (const [ukTerm, usTerm] of sortedMappings) {\n    // Case-insensitive replacement with word boundaries\n    const regex = new RegExp(`\\\\b${ukTerm}\\\\b`, 'gi');\n    mappedText = mappedText.replace(regex, usTerm);\n  }\n  \n  // Only log if something actually changed\n  if (mappedText !== text) {\n    console.log(`ðŸ‡¬ðŸ‡§â†’ðŸ‡ºðŸ‡¸ Food mapping: \"${text}\" â†’ \"${mappedText}\"`);\n  }\n  \n  return mappedText;\n}\n\n/**\n * Extract quantity multiplier from portion text\n * Examples:\n *   \"4 Weetabix\" â†’ { quantity: 4, foodName: \"Weetabix\" }\n *   \"2 large eggs\" â†’ { quantity: 2, foodName: \"large eggs\" }\n *   \"one apple\" â†’ { quantity: 1, foodName: \"apple\" }\n *   \"banana\" â†’ { quantity: 1, foodName: \"banana\" }\n */\nexport function extractQuantity(portionText: string): { quantity: number; foodName: string } {\n  // Remove leading/trailing whitespace\n  const text = portionText.trim();\n  \n  // Try to match patterns like \"4 Weetabix\", \"2 eggs\", \"one apple\"\n  const numberMatch = text.match(/^(\\d+(?:\\.\\d+)?)\\s+(.+)$/);\n  if (numberMatch) {\n    return {\n      quantity: parseFloat(numberMatch[1]),\n      foodName: numberMatch[2].trim()\n    };\n  }\n  \n  // Match word numbers\n  const wordNumbers: Record<string, number> = {\n    'one': 1, 'two': 2, 'three': 3, 'four': 4, 'five': 5,\n    'six': 6, 'seven': 7, 'eight': 8, 'nine': 9, 'ten': 10,\n    'a': 1, 'an': 1\n  };\n  \n  const wordMatch = text.match(/^(one|two|three|four|five|six|seven|eight|nine|ten|a|an)\\s+(.+)$/i);\n  if (wordMatch) {\n    const wordNum = wordMatch[1].toLowerCase();\n    return {\n      quantity: wordNumbers[wordNum] || 1,\n      foodName: wordMatch[2].trim()\n    };\n  }\n  \n  // Default: no quantity multiplier\n  return {\n    quantity: 1,\n    foodName: text\n  };\n}\n","size_bytes":4582},"client/src/components/dashboard.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport type { DiaryEntryWithAnalysis, NutritionGoals } from \"@shared/schema\";\nimport { Card } from \"@/components/ui/card\";\nimport { Flame, Dumbbell, Wheat, Droplet, TrendingUp, Award, Target, Utensils } from \"lucide-react\";\nimport { PieChart, Pie, Cell, ResponsiveContainer, Legend, Tooltip } from \"recharts\";\nimport { calculateDailyNutrition } from \"@/lib/nutrition-calculator\";\nimport { useEffect, useState, useRef } from \"react\";\nimport { motion } from \"framer-motion\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { WaterTracker } from \"@/components/water-tracker\";\n\ninterface DashboardProps {\n  onViewMeals?: () => void;\n}\n\nexport function Dashboard({ onViewMeals }: DashboardProps = {}) {\n  const { data: diaryEntries } = useQuery<DiaryEntryWithAnalysis[]>({\n    queryKey: ['/api/diary'],\n  });\n\n  const { data: nutritionGoals } = useQuery<NutritionGoals>({\n    queryKey: ['/api/nutrition-goals'],\n  });\n\n  const [motivationalQuote, setMotivationalQuote] = useState(\"\");\n  const lastCheckRef = useRef<string>('');\n\n  // Get today's entries (using local date to avoid timezone issues)\n  const today = new Date().toDateString();\n  const todayEntries = diaryEntries?.filter(entry => {\n    const entryDate = new Date(entry.mealDate).toDateString();\n    return entryDate === today;\n  }) || [];\n\n  // Calculate today's totals from food diary only\n  const totals = calculateDailyNutrition(todayEntries, []);\n\n  // Mutation to check goal challenges\n  const checkGoalsMutation = useMutation({\n    mutationFn: async (data: {\n      totalCalories: number;\n      totalProtein: number;\n      dailyGoals: { calories: number; protein: number };\n    }) => {\n      return apiRequest('POST', '/api/challenges/check-goals', data);\n    },\n  });\n\n  // Check goals whenever totals or goals change\n  useEffect(() => {\n    if (nutritionGoals && totals.calories > 0) {\n      const checkKey = `${totals.calories}-${totals.protein}`;\n      \n      // Only check if values have changed\n      if (checkKey !== lastCheckRef.current) {\n        lastCheckRef.current = checkKey;\n        \n        // Call the API to check goal-based challenges\n        apiRequest('POST', '/api/challenges/check-goals', {\n          totalCalories: totals.calories,\n          totalProtein: totals.protein,\n          dailyGoals: {\n            calories: nutritionGoals.dailyCalories || 2000,\n            protein: nutritionGoals.dailyProtein || 150,\n          },\n        }).catch(err => {\n          console.error('Goal check failed:', err);\n        });\n      }\n    }\n  }, [totals.calories, totals.protein, nutritionGoals]);\n\n  // AI motivational quotes\n  const quotes = [\n    \"Every healthy choice is a step forward! ðŸŒŸ\",\n    \"Your consistency is building strength! ðŸ’ª\",\n    \"Progress, not perfection! Keep going! ðŸŽ¯\",\n    \"You're fueling your best self! ðŸ”¥\",\n    \"Small steps lead to big changes! â­\",\n    \"Your health journey matters! ðŸŒˆ\",\n    \"Stay committed to your goals! ðŸ†\",\n    \"You're doing amazing! Keep it up! ðŸ’«\",\n  ];\n\n  useEffect(() => {\n    const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];\n    setMotivationalQuote(randomQuote);\n  }, []);\n\n  // Prepare macro data for pie chart\n  const macroData = [\n    { name: \"Protein\", value: totals.protein * 4, color: \"#a78bfa\" }, // Purple\n    { name: \"Carbs\", value: totals.carbs * 4, color: \"#fb923c\" }, // Orange\n    { name: \"Fat\", value: totals.fat * 9, color: \"#fbbf24\" }, // Yellow\n  ];\n\n  const totalMacroCalories = macroData.reduce((sum, item) => sum + item.value, 0);\n\n  // Calculate percentages for goals\n  const proteinPercent = nutritionGoals?.dailyProtein \n    ? Math.round((totals.protein / nutritionGoals.dailyProtein) * 100)\n    : 0;\n  const carbsPercent = nutritionGoals?.dailyCarbs\n    ? Math.round((totals.carbs / nutritionGoals.dailyCarbs) * 100)\n    : 0;\n  const fatPercent = nutritionGoals?.dailyFat\n    ? Math.round((totals.fat / nutritionGoals.dailyFat) * 100)\n    : 0;\n  const caloriesPercent = nutritionGoals?.dailyCalories\n    ? Math.round((totals.calories / nutritionGoals.dailyCalories) * 100)\n    : 0;\n\n  return (\n    <div className=\"space-y-6 max-w-md mx-auto px-4\">\n      {/* Fluid Intake Tracker */}\n      <WaterTracker />\n\n      {/* View All Meals Button */}\n      {onViewMeals && todayEntries.length > 0 && (\n        <motion.button\n          onClick={onViewMeals}\n          whileHover={{ scale: 1.02 }}\n          whileTap={{ scale: 0.98 }}\n          className=\"w-full bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white px-6 py-3 rounded-xl text-base font-semibold transition-all flex items-center justify-center space-x-2 shadow-lg\"\n          data-testid=\"button-view-all-meals\"\n        >\n          <Utensils className=\"h-5 w-5\" />\n          <span>View All Meals</span>\n        </motion.button>\n      )}\n    </div>\n  );\n}\n","size_bytes":4918},"client/src/components/offline-indicator.tsx":{"content":"import { useEffect, useState } from 'react';\nimport { WifiOff, Wifi, CloudOff, CloudUpload } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { offlineQueue } from '@/lib/offline-queue';\n\nexport function OfflineIndicator() {\n  const [isOnline, setIsOnline] = useState(navigator.onLine);\n  const [queueCount, setQueueCount] = useState(0);\n  const [showSyncSuccess, setShowSyncSuccess] = useState(false);\n\n  useEffect(() => {\n    // Subscribe to online/offline status changes\n    const unsubscribe = offlineQueue.onStatusChange((online) => {\n      setIsOnline(online);\n      \n      if (online) {\n        // Trigger sync when coming back online\n        offlineQueue.syncQueue().then((result) => {\n          if (result && result.success > 0) {\n            setShowSyncSuccess(true);\n            setTimeout(() => setShowSyncSuccess(false), 3000);\n          }\n        });\n      }\n    });\n\n    // Update queue count periodically\n    const interval = setInterval(() => {\n      setQueueCount(offlineQueue.getQueueCount());\n    }, 1000);\n\n    return () => {\n      unsubscribe();\n      clearInterval(interval);\n    };\n  }, []);\n\n  if (isOnline && queueCount === 0 && !showSyncSuccess) {\n    return null; // Don't show anything when online and queue is empty\n  }\n\n  return (\n    <AnimatePresence>\n      {(!isOnline || queueCount > 0 || showSyncSuccess) && (\n        <motion.div\n          initial={{ opacity: 0, y: -20 }}\n          animate={{ opacity: 1, y: 0 }}\n          exit={{ opacity: 0, y: -20 }}\n          className=\"fixed top-20 left-1/2 transform -translate-x-1/2 z-50\"\n        >\n          {showSyncSuccess ? (\n            <div className=\"bg-gradient-to-r from-green-500 to-emerald-600 text-white px-6 py-3 rounded-full shadow-lg flex items-center space-x-2\">\n              <CloudUpload className=\"h-5 w-5\" />\n              <span className=\"font-semibold\">Synced successfully!</span>\n            </div>\n          ) : !isOnline ? (\n            <div className=\"bg-gradient-to-r from-orange-500 to-red-500 text-white px-6 py-3 rounded-full shadow-lg flex items-center space-x-2\">\n              <WifiOff className=\"h-5 w-5\" />\n              <span className=\"font-semibold\">You're offline</span>\n              {queueCount > 0 && (\n                <span className=\"ml-2 bg-white/20 px-2 py-1 rounded-full text-xs\">\n                  {queueCount} queued\n                </span>\n              )}\n            </div>\n          ) : queueCount > 0 ? (\n            <div className=\"bg-gradient-to-r from-blue-500 to-purple-600 text-white px-6 py-3 rounded-full shadow-lg flex items-center space-x-2\">\n              <CloudOff className=\"h-5 w-5 animate-pulse\" />\n              <span className=\"font-semibold\">Syncing {queueCount} items...</span>\n            </div>\n          ) : null}\n        </motion.div>\n      )}\n    </AnimatePresence>\n  );\n}\n","size_bytes":2862},"client/src/lib/offline-queue.ts":{"content":"/**\n * Offline Queue Service\n * Caches diary entries and analysis when device is offline\n * Automatically syncs when connection is restored\n */\n\nimport { buildApiUrl } from './api-config';\n\nexport interface QueuedEntry {\n  id: string;\n  type: 'diary' | 'analysis';\n  data: any;\n  timestamp: number;\n  retryCount: number;\n}\n\nconst QUEUE_STORAGE_KEY = 'platemate_offline_queue';\nconst MAX_RETRY_COUNT = 3;\n\nclass OfflineQueueService {\n  private queue: QueuedEntry[] = [];\n  private isOnline: boolean = navigator.onLine;\n  private syncInProgress: boolean = false;\n  private listeners: Set<(isOnline: boolean) => void> = new Set();\n\n  constructor() {\n    this.loadQueue();\n    this.setupEventListeners();\n  }\n\n  /**\n   * Setup online/offline event listeners\n   */\n  private setupEventListeners() {\n    window.addEventListener('online', () => {\n      console.log('ðŸŒ Device back online - starting sync...');\n      this.isOnline = true;\n      this.notifyListeners(true);\n      this.syncQueue();\n    });\n\n    window.addEventListener('offline', () => {\n      console.log('ðŸ“µ Device offline - queueing enabled');\n      this.isOnline = false;\n      this.notifyListeners(false);\n    });\n  }\n\n  /**\n   * Subscribe to online/offline status changes\n   */\n  onStatusChange(callback: (isOnline: boolean) => void) {\n    this.listeners.add(callback);\n    // Immediately call with current status\n    callback(this.isOnline);\n    \n    return () => this.listeners.delete(callback);\n  }\n\n  /**\n   * Notify all listeners of status change\n   */\n  private notifyListeners(isOnline: boolean) {\n    this.listeners.forEach(listener => listener(isOnline));\n  }\n\n  /**\n   * Load queued entries from localStorage\n   */\n  private loadQueue() {\n    try {\n      const stored = localStorage.getItem(QUEUE_STORAGE_KEY);\n      if (stored) {\n        this.queue = JSON.parse(stored);\n        console.log(`ðŸ“¦ Loaded ${this.queue.length} queued entries from storage`);\n      }\n    } catch (error) {\n      console.error('Failed to load offline queue:', error);\n      this.queue = [];\n    }\n  }\n\n  /**\n   * Save queue to localStorage\n   */\n  private saveQueue() {\n    try {\n      localStorage.setItem(QUEUE_STORAGE_KEY, JSON.stringify(this.queue));\n    } catch (error) {\n      console.error('Failed to save offline queue:', error);\n    }\n  }\n\n  /**\n   * Add entry to queue (when offline or failed online)\n   */\n  addToQueue(type: 'diary' | 'analysis', data: any): string {\n    const entry: QueuedEntry = {\n      id: `queue_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n      type,\n      data,\n      timestamp: Date.now(),\n      retryCount: 0\n    };\n\n    this.queue.push(entry);\n    this.saveQueue();\n    \n    console.log(`ðŸ“¥ Added ${type} entry to offline queue:`, entry.id);\n    return entry.id;\n  }\n\n  /**\n   * Get all queued entries\n   */\n  getQueue(): QueuedEntry[] {\n    return [...this.queue];\n  }\n\n  /**\n   * Get count of queued entries\n   */\n  getQueueCount(): number {\n    return this.queue.length;\n  }\n\n  /**\n   * Check if device is currently online\n   */\n  getOnlineStatus(): boolean {\n    return this.isOnline;\n  }\n\n  /**\n   * Sync all queued entries to server\n   */\n  async syncQueue() {\n    if (this.syncInProgress || !this.isOnline || this.queue.length === 0) {\n      return;\n    }\n\n    this.syncInProgress = true;\n    console.log(`ðŸ”„ Syncing ${this.queue.length} queued entries...`);\n\n    const entriesToSync = [...this.queue];\n    const syncResults: { success: number; failed: number } = { success: 0, failed: 0 };\n\n    for (const entry of entriesToSync) {\n      try {\n        await this.syncEntry(entry);\n        // Remove from queue on success\n        this.queue = this.queue.filter(e => e.id !== entry.id);\n        syncResults.success++;\n        console.log(`âœ… Synced entry ${entry.id}`);\n      } catch (error) {\n        console.error(`âŒ Failed to sync entry ${entry.id}:`, error);\n        \n        // Increment retry count\n        const queueEntry = this.queue.find(e => e.id === entry.id);\n        if (queueEntry) {\n          queueEntry.retryCount++;\n          \n          // Remove if exceeded retry limit\n          if (queueEntry.retryCount >= MAX_RETRY_COUNT) {\n            this.queue = this.queue.filter(e => e.id !== entry.id);\n            console.warn(`âš ï¸ Removed entry ${entry.id} after ${MAX_RETRY_COUNT} failed attempts`);\n          }\n        }\n        \n        syncResults.failed++;\n      }\n    }\n\n    this.saveQueue();\n    this.syncInProgress = false;\n\n    console.log(`ðŸ Sync complete: ${syncResults.success} succeeded, ${syncResults.failed} failed`);\n    \n    return syncResults;\n  }\n\n  /**\n   * Sync a single entry to the server\n   */\n  private async syncEntry(entry: QueuedEntry): Promise<void> {\n    if (entry.type === 'diary') {\n      // Sync diary entry\n      const response = await fetch(buildApiUrl('/api/diary'), {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(entry.data)\n      });\n\n      if (!response.ok) {\n        throw new Error(`Failed to sync diary entry: ${response.status}`);\n      }\n    } else if (entry.type === 'analysis') {\n      // For analysis entries, re-run the analysis\n      const formData = new FormData();\n      \n      // Convert base64 back to file if needed\n      if (entry.data.imageData) {\n        const blob = await fetch(entry.data.imageData).then(r => r.blob());\n        formData.append('image', blob);\n      }\n\n      const response = await fetch(buildApiUrl('/api/analyze'), {\n        method: 'POST',\n        body: formData\n      });\n\n      if (!response.ok) {\n        throw new Error(`Failed to sync analysis: ${response.status}`);\n      }\n    }\n  }\n\n  /**\n   * Clear all queued entries (use with caution!)\n   */\n  clearQueue() {\n    this.queue = [];\n    this.saveQueue();\n    console.log('ðŸ—‘ï¸ Offline queue cleared');\n  }\n\n  /**\n   * Manually trigger sync (useful for testing)\n   */\n  async forceSyncresponse() {\n    await this.syncQueue();\n  }\n}\n\n// Singleton instance\nexport const offlineQueue = new OfflineQueueService();\n","size_bytes":6076},"client/src/components/diary-edit-dialog.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { format } from \"date-fns\";\nimport { Utensils, Loader2 } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Slider } from \"@/components/ui/slider\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { updateDiaryEntrySchema, type DiaryEntryWithAnalysis } from \"@shared/schema\";\n\n// Form schema for diary editing\nconst diaryEditFormSchema = z.object({\n  mealType: z.enum([\"breakfast\", \"lunch\", \"dinner\", \"snack\", \"custom\"]),\n  portionMultiplier: z.number().int().min(10).max(500), // 10% to 500% (0.1x to 5x)\n  notes: z.string().optional(),\n  customMealName: z.string().optional(),\n});\n\ntype DiaryEditFormData = z.infer<typeof diaryEditFormSchema>;\n\ninterface DiaryEditDialogProps {\n  entry: DiaryEntryWithAnalysis | null;\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  onSuccess?: () => void;\n}\n\nexport function DiaryEditDialog({ entry, open, onOpenChange, onSuccess }: DiaryEditDialogProps) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  \n  // Local state for portion input to allow typing without immediate clamping\n  const [portionInput, setPortionInput] = useState<string>(\"100\");\n\n  // Initialize form with current entry data\n  const form = useForm<DiaryEditFormData>({\n    resolver: zodResolver(diaryEditFormSchema),\n    defaultValues: {\n      mealType: \"breakfast\",\n      portionMultiplier: 100, // 1.0x\n      notes: \"\",\n      customMealName: \"\",\n    },\n  });\n\n  // Update form when entry changes\n  useEffect(() => {\n    if (entry) {\n      const portionValue = entry.portionMultiplier || 100;\n      form.reset({\n        mealType: entry.mealType as \"breakfast\" | \"lunch\" | \"dinner\" | \"snack\" | \"custom\",\n        portionMultiplier: portionValue,\n        notes: entry.notes || \"\",\n        customMealName: entry.customMealName || \"\",\n      });\n      setPortionInput(portionValue.toString());\n    }\n  }, [entry, form]);\n\n  const updateDiaryMutation = useMutation({\n    mutationFn: async (data: DiaryEditFormData) => {\n      if (!entry) throw new Error(\"No entry to update\");\n      \n      const updateData = {\n        mealType: data.mealType,\n        portionMultiplier: data.portionMultiplier,\n        notes: data.notes || null,\n        customMealName: data.mealType === \"custom\" ? data.customMealName : null,\n      };\n\n      return apiRequest(\"PATCH\", `/api/diary/${entry.id}`, updateData);\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Success\",\n        description: \"Meal entry updated successfully.\",\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/diary'] });\n      onOpenChange(false);\n      onSuccess?.();\n    },\n    onError: (error: any) => {\n      console.error(\"Diary update error:\", error);\n      toast({\n        variant: \"destructive\",\n        title: \"Error\",\n        description: error.message || \"Failed to update meal entry.\",\n      });\n    },\n  });\n\n  const onSubmit = (data: DiaryEditFormData) => {\n    console.log(\"ðŸ”„ Form submitted:\", data);\n    console.log(\"ðŸ“ Portion input value:\", portionInput);\n    \n    // Commit any uncommitted portion input before submitting\n    const portionValue = parseInt(portionInput) || 100;\n    const clampedValue = Math.max(10, Math.min(500, portionValue));\n    \n    console.log(\"âœ… Final portion value:\", clampedValue);\n    \n    updateDiaryMutation.mutate({\n      ...data,\n      portionMultiplier: clampedValue,\n    });\n  };\n\n  const portionValue = form.watch(\"portionMultiplier\");\n  const portionDisplay = (portionValue / 100).toFixed(1);\n\n  // Calculate multiplied nutrition values for preview\n  const previewNutrition = entry ? {\n    calories: Math.round((entry.analysis?.totalCalories || 0) * (portionValue / 100)),\n    protein: Math.round((entry.analysis?.totalProtein || 0) * (portionValue / 100)),\n    carbs: Math.round((entry.analysis?.totalCarbs || 0) * (portionValue / 100)),\n    fat: Math.round((entry.analysis?.totalFat || 0) * (portionValue / 100)),\n  } : null;\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-sm\">\n        <DialogHeader className=\"pb-1\">\n          <DialogTitle className=\"flex items-center space-x-2 text-sm\">\n            <Utensils className=\"h-4 w-4\" />\n            <span>Meal Entry</span>\n          </DialogTitle>\n          <DialogDescription className=\"text-[10px]\">\n            Adjust portion size, meal type, or add notes\n          </DialogDescription>\n        </DialogHeader>\n\n        <form onSubmit={form.handleSubmit(\n          onSubmit,\n          (errors) => {\n            console.error(\"âŒ Form validation errors:\", errors);\n            toast({\n              variant: \"destructive\",\n              title: \"Validation Error\",\n              description: \"Please check all fields and try again.\",\n            });\n          }\n        )} className=\"space-y-2\">\n          {/* Compact Portion Size */}\n          <div className=\"space-y-1\">\n            <div className=\"flex items-center justify-between\">\n              <Label className=\"text-xs\">Size</Label>\n              <div className=\"flex items-center gap-1\">\n                <input\n                  type=\"number\"\n                  value={portionInput}\n                  onChange={(e) => {\n                    setPortionInput(e.target.value);\n                  }}\n                  onBlur={(e) => {\n                    const value = parseInt(e.target.value) || 100;\n                    const clampedValue = Math.max(10, Math.min(500, value));\n                    form.setValue(\"portionMultiplier\", clampedValue);\n                    setPortionInput(clampedValue.toString());\n                  }}\n                  min={10}\n                  max={500}\n                  step={10}\n                  className=\"w-14 px-1 py-0.5 text-xs border rounded text-center dark:bg-gray-800 dark:border-gray-700\"\n                  data-testid=\"input-portion-value\"\n                />\n                <span className=\"text-xs font-bold text-primary\">{portionDisplay}x</span>\n              </div>\n            </div>\n            <Slider\n              value={[portionValue]}\n              onValueChange={(values) => {\n                form.setValue(\"portionMultiplier\", values[0]);\n                setPortionInput(values[0].toString());\n              }}\n              min={10}\n              max={500}\n              step={10}\n              className=\"w-full h-2\"\n              data-testid=\"slider-portion\"\n            />\n            <div className=\"flex justify-between text-[9px] text-muted-foreground -mt-0.5\">\n              <span>1.0x (100%)</span>\n              <span>5.0x (500%)</span>\n            </div>\n          </div>\n\n          {/* Inline Nutrition Preview */}\n          {previewNutrition && (\n            <div className=\"bg-muted/30 rounded-lg p-1.5\">\n              <div className=\"grid grid-cols-4 gap-1 text-center\">\n                <div>\n                  <div className=\"text-sm font-bold text-orange-600\">{previewNutrition.calories}</div>\n                  <div className=\"text-[10px] text-muted-foreground\">cal</div>\n                </div>\n                <div>\n                  <div className=\"text-sm font-bold text-blue-600\">{previewNutrition.protein}g</div>\n                  <div className=\"text-[10px] text-muted-foreground\">protein</div>\n                </div>\n                <div>\n                  <div className=\"text-sm font-bold text-yellow-600\">{previewNutrition.carbs}g</div>\n                  <div className=\"text-[10px] text-muted-foreground\">carbs</div>\n                </div>\n                <div>\n                  <div className=\"text-sm font-bold text-green-600\">{previewNutrition.fat}g</div>\n                  <div className=\"text-[10px] text-muted-foreground\">fat</div>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Compact Meal Type */}\n          <div className=\"space-y-0.5\">\n            <Label className=\"text-xs\">Type</Label>\n            <Select\n              value={form.watch(\"mealType\")}\n              onValueChange={(value) => form.setValue(\"mealType\", value as any)}\n            >\n              <SelectTrigger className=\"h-7 text-xs\" data-testid=\"select-meal-type\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"breakfast\">Breakfast</SelectItem>\n                <SelectItem value=\"lunch\">Lunch</SelectItem>\n                <SelectItem value=\"dinner\">Dinner</SelectItem>\n                <SelectItem value=\"snack\">Snack</SelectItem>\n                <SelectItem value=\"custom\">Custom</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n\n          {/* Custom Meal Name (if custom type selected) */}\n          {form.watch(\"mealType\") === \"custom\" && (\n            <div className=\"space-y-1\">\n              <Label className=\"text-sm\">Custom Meal Name</Label>\n              <input\n                {...form.register(\"customMealName\")}\n                placeholder=\"e.g., Brunch\"\n                className=\"w-full px-2 py-1 text-sm border rounded-md dark:bg-gray-800 dark:border-gray-700\"\n                data-testid=\"input-custom-meal-name\"\n              />\n            </div>\n          )}\n\n          {/* Compact Notes */}\n          <div className=\"space-y-1\">\n            <Label className=\"text-sm\">Notes (Optional)</Label>\n            <Textarea\n              {...form.register(\"notes\")}\n              placeholder=\"Add notes...\"\n              rows={2}\n              className=\"text-sm resize-none\"\n              data-testid=\"textarea-notes\"\n            />\n          </div>\n\n          {/* Action Buttons */}\n          <div className=\"flex space-x-2 pt-2\">\n            <Button\n              type=\"button\"\n              variant=\"outline\"\n              onClick={() => onOpenChange(false)}\n              className=\"flex-1 h-8 text-sm\"\n              data-testid=\"button-cancel-edit\"\n            >\n              Cancel\n            </Button>\n            <Button\n              type=\"submit\"\n              disabled={updateDiaryMutation.isPending}\n              className=\"flex-1 h-8 text-sm bg-gradient-to-r from-purple-600 to-orange-500 hover:from-purple-700 hover:to-orange-600\"\n              data-testid=\"button-save-edit\"\n            >\n              {updateDiaryMutation.isPending ? (\n                <>\n                  <Loader2 className=\"mr-1 h-3 w-3 animate-spin\" />\n                  Saving...\n                </>\n              ) : (\n                \"Save Changes\"\n              )}\n            </Button>\n          </div>\n        </form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":11173},"client/src/components/meal-memory-badge.tsx":{"content":"import { Clock, TrendingUp } from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport type { MealMemory } from '@/lib/meal-memory';\nimport { getMealMemoryMessage } from '@/lib/meal-memory';\n\ninterface MealMemoryBadgeProps {\n  memory: MealMemory | null;\n  frequency?: { count: number; averageDaysBetween: number };\n}\n\nexport function MealMemoryBadge({ memory, frequency }: MealMemoryBadgeProps) {\n  if (!memory) return null;\n\n  const message = getMealMemoryMessage(memory);\n  if (!message) return null;\n\n  const showFrequency = frequency && frequency.count > 2;\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: -10 }}\n      animate={{ opacity: 1, y: 0 }}\n      className=\"mb-4\"\n    >\n      <div className=\"bg-gradient-to-r from-purple-500/20 to-pink-500/20 border border-purple-300/50 dark:border-purple-500/30 rounded-xl p-4\">\n        <div className=\"flex items-start space-x-3\">\n          <div className=\"flex-shrink-0\">\n            <Clock className=\"h-5 w-5 text-purple-600 dark:text-purple-400\" />\n          </div>\n          <div className=\"flex-1\">\n            <p className=\"text-sm font-medium text-purple-900 dark:text-purple-100\">\n              {message}\n            </p>\n            {showFrequency && (\n              <div className=\"mt-2 flex items-center space-x-2 text-xs text-purple-700 dark:text-purple-300\">\n                <TrendingUp className=\"h-4 w-4\" />\n                <span>\n                  You eat this about every {frequency.averageDaysBetween} days\n                  {' '}({frequency.count} times total)\n                </span>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </motion.div>\n  );\n}\n","size_bytes":1681},"client/src/lib/meal-memory.ts":{"content":"/**\n * Meal Memory Service\n * Tracks previously logged foods and shows \"You had this last time\" reminders\n */\n\nimport type { DiaryEntryWithAnalysis } from \"@shared/schema\";\n\nexport interface MealMemory {\n  foodName: string;\n  lastEaten: Date;\n  daysAgo: number;\n  mealType: string;\n  calories: number;\n}\n\n/**\n * Find previous occurrences of similar foods in diary history\n */\nexport function findPreviousMeals(\n  currentFoodName: string,\n  diaryEntries: DiaryEntryWithAnalysis[]\n): MealMemory | null {\n  if (!currentFoodName || diaryEntries.length === 0) {\n    return null;\n  }\n\n  // Normalize food name for comparison (lowercase, remove extra spaces)\n  const normalizedCurrent = currentFoodName.toLowerCase().trim();\n  \n  // Find matching entries (excluding today)\n  const today = new Date().toDateString();\n  const matchingEntries = diaryEntries\n    .filter(entry => {\n      if (!entry.analysis?.detectedFoods) return false;\n      \n      const entryDate = new Date(entry.mealDate).toDateString();\n      if (entryDate === today) return false; // Exclude today's entries\n      \n      // Check if any food item matches (exact match or very similar)\n      return entry.analysis.detectedFoods.some((food: any) => {\n        const normalizedFood = food.name.toLowerCase().trim();\n        \n        // Exact match\n        if (normalizedFood === normalizedCurrent) return true;\n        \n        // Only allow substring match if one is significantly longer\n        // and the shorter one is at least 4 characters (to avoid false positives like \"rice\" matching \"fried rice\")\n        const minLength = 5;\n        if (normalizedCurrent.length >= minLength && normalizedFood.includes(normalizedCurrent)) {\n          // Ensure current is substantial part of food name\n          return normalizedCurrent.length / normalizedFood.length >= 0.6;\n        }\n        if (normalizedFood.length >= minLength && normalizedCurrent.includes(normalizedFood)) {\n          // Ensure food is substantial part of current name\n          return normalizedFood.length / normalizedCurrent.length >= 0.6;\n        }\n        \n        return false;\n      });\n    })\n    .sort((a, b) => new Date(b.mealDate).getTime() - new Date(a.mealDate).getTime()); // Most recent first\n\n  if (matchingEntries.length === 0) {\n    return null;\n  }\n\n  const lastEntry = matchingEntries[0];\n  const lastEaten = new Date(lastEntry.mealDate);\n  const now = new Date();\n  const daysAgo = Math.floor((now.getTime() - lastEaten.getTime()) / (1000 * 60 * 60 * 24));\n\n  return {\n    foodName: currentFoodName,\n    lastEaten,\n    daysAgo,\n    mealType: lastEntry.mealType,\n    calories: lastEntry.analysis?.totalCalories || 0\n  };\n}\n\n/**\n * Generate a friendly reminder message based on meal memory\n */\nexport function getMealMemoryMessage(memory: MealMemory | null): string | null {\n  if (!memory) return null;\n\n  const { daysAgo, mealType } = memory;\n\n  // Note: daysAgo === 0 case doesn't occur because we filter out same-day entries\n  if (daysAgo === 1) {\n    return `You had this yesterday for ${mealType}`;\n  } else if (daysAgo <= 7) {\n    return `You had this ${daysAgo} days ago for ${mealType}`;\n  } else if (daysAgo <= 30) {\n    const weeks = Math.floor(daysAgo / 7);\n    return `You had this ${weeks} ${weeks === 1 ? 'week' : 'weeks'} ago`;\n  } else {\n    return `You had this over a month ago`;\n  }\n}\n\n/**\n * Get meal frequency statistics\n */\nexport function getMealFrequency(\n  foodName: string,\n  diaryEntries: DiaryEntryWithAnalysis[]\n): { count: number; averageDaysBetween: number } {\n  const normalizedFood = foodName.toLowerCase().trim();\n  \n  const matchingDates = diaryEntries\n    .filter(entry => {\n      if (!entry.analysis?.detectedFoods) return false;\n      return entry.analysis.detectedFoods.some((food: any) => {\n        const normalizedEntryFood = food.name.toLowerCase().trim();\n        \n        // Exact match\n        if (normalizedEntryFood === normalizedFood) return true;\n        \n        // Stricter substring matching with minimum length and ratio\n        const minLength = 5;\n        if (normalizedFood.length >= minLength && normalizedEntryFood.includes(normalizedFood)) {\n          return normalizedFood.length / normalizedEntryFood.length >= 0.6;\n        }\n        if (normalizedEntryFood.length >= minLength && normalizedFood.includes(normalizedEntryFood)) {\n          return normalizedEntryFood.length / normalizedFood.length >= 0.6;\n        }\n        \n        return false;\n      });\n    })\n    .map(entry => new Date(entry.mealDate).getTime())\n    .sort((a, b) => b - a); // Most recent first\n\n  if (matchingDates.length < 2) {\n    return { count: matchingDates.length, averageDaysBetween: 0 };\n  }\n\n  // Calculate average days between occurrences\n  let totalDays = 0;\n  for (let i = 0; i < matchingDates.length - 1; i++) {\n    const daysBetween = (matchingDates[i] - matchingDates[i + 1]) / (1000 * 60 * 60 * 24);\n    totalDays += daysBetween;\n  }\n\n  const averageDaysBetween = Math.round(totalDays / (matchingDates.length - 1));\n\n  return {\n    count: matchingDates.length,\n    averageDaysBetween\n  };\n}\n","size_bytes":5085},"client/src/lib/google-fit-service.ts":{"content":"/**\n * Google Fit Integration Service (Placeholder)\n * \n * This service is prepared for future Google Fit integration.\n * Currently returns mock data for the rewards system.\n */\n\nexport interface StepData {\n  steps: number;\n  earnedCalories: number;\n  date: string;\n}\n\nclass GoogleFitService {\n  /**\n   * Check if Google Fit is connected\n   * @returns Promise<boolean> - Currently always returns false (not implemented)\n   */\n  async isConnected(): Promise<boolean> {\n    return false;\n  }\n\n  /**\n   * Get today's step count\n   * @returns Promise<StepData> - Returns mock data (0 steps)\n   */\n  async getTodaySteps(): Promise<StepData> {\n    return {\n      steps: 0,\n      earnedCalories: 0,\n      date: new Date().toISOString().split('T')[0]\n    };\n  }\n\n  /**\n   * Connect to Google Fit (not implemented)\n   * @throws Error - Always throws as feature is not yet implemented\n   */\n  async connect(): Promise<void> {\n    throw new Error('Google Fit integration is not yet available. Stay tuned for future updates!');\n  }\n\n  /**\n   * Disconnect from Google Fit (not implemented)\n   */\n  async disconnect(): Promise<void> {\n    // No-op for now\n  }\n\n  /**\n   * Sync steps from Google Fit (not implemented)\n   */\n  async syncSteps(): Promise<StepData> {\n    return this.getTodaySteps();\n  }\n}\n\nexport const googleFitService = new GoogleFitService();\n","size_bytes":1346},"client/src/components/streak-counter.tsx":{"content":"import { useEffect, useState } from 'react';\nimport { Flame } from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport { getStreakData, getStreakMessage, type StreakData } from '@/lib/streak-tracker';\n\nexport function StreakCounter() {\n  const [streakData, setStreakData] = useState<StreakData | null>(null);\n\n  useEffect(() => {\n    // Load streak data on mount\n    const data = getStreakData();\n    setStreakData(data);\n    \n    // Listen for streak updates\n    const handleStreakUpdate = () => {\n      const updatedData = getStreakData();\n      setStreakData(updatedData);\n    };\n    \n    window.addEventListener('streakUpdated', handleStreakUpdate);\n    return () => window.removeEventListener('streakUpdated', handleStreakUpdate);\n  }, []);\n\n  if (!streakData) {\n    return null;\n  }\n\n  const { currentStreak, longestStreak } = streakData;\n  const message = getStreakMessage(currentStreak);\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, scale: 0.95 }}\n      animate={{ opacity: 1, scale: 1 }}\n      className=\"bg-gradient-to-br from-purple-500/80 to-purple-600/80 dark:from-purple-600/80 dark:to-purple-700/80 rounded-2xl p-6 border-2 border-purple-400/50 dark:border-purple-500/50 shadow-lg\"\n      data-testid=\"streak-counter\"\n    >\n      <div className=\"flex items-center justify-between mb-4\">\n        <div className=\"flex items-center space-x-3\">\n          <motion.div\n            animate={currentStreak > 0 ? {\n              scale: [1, 1.2, 1],\n              rotate: [0, -10, 10, -10, 0]\n            } : {}}\n            transition={{\n              duration: 0.5,\n              repeat: Infinity,\n              repeatDelay: 3\n            }}\n          >\n            <Flame className={`h-8 w-8 ${currentStreak > 0 ? 'text-orange-400' : 'text-white/50'}`} />\n          </motion.div>\n          <div>\n            <h3 className=\"text-lg font-semibold text-white\">\n              Daily Streak\n            </h3>\n            <p className=\"text-sm text-purple-100\">\n              {message}\n            </p>\n          </div>\n        </div>\n        <div className=\"text-right\">\n          <div className=\"text-3xl font-bold text-orange-400\" data-testid=\"streak-current\">\n            {currentStreak}\n          </div>\n          <div className=\"text-xs text-purple-100\">\n            {currentStreak === 1 ? 'day' : 'days'}\n          </div>\n        </div>\n      </div>\n      \n      {longestStreak > currentStreak && (\n        <div className=\"pt-4 border-t border-white/20\">\n          <div className=\"flex items-center justify-between text-sm\">\n            <span className=\"text-purple-100\">\n              Personal Best\n            </span>\n            <span className=\"font-semibold text-orange-300\" data-testid=\"streak-longest\">\n              {longestStreak} {longestStreak === 1 ? 'day' : 'days'}\n            </span>\n          </div>\n        </div>\n      )}\n    </motion.div>\n  );\n}\n","size_bytes":2895},"client/src/lib/streak-tracker.ts":{"content":"/**\n * Streak Tracker Service\n * Tracks consecutive days of food logging\n */\n\nconst STREAK_STORAGE_KEY = 'platemate_streak';\nconst LAST_LOG_DATE_KEY = 'platemate_last_log_date';\n\nexport interface StreakData {\n  currentStreak: number;\n  longestStreak: number;\n  lastLogDate: string | null;\n}\n\n/**\n * Get current streak data from localStorage\n */\nexport function getStreakData(): StreakData {\n  try {\n    const stored = localStorage.getItem(STREAK_STORAGE_KEY);\n    if (stored) {\n      return JSON.parse(stored);\n    }\n  } catch (error) {\n    console.error('Failed to load streak data:', error);\n  }\n  \n  return {\n    currentStreak: 0,\n    longestStreak: 0,\n    lastLogDate: null\n  };\n}\n\n/**\n * Update streak when user logs food\n */\nexport function updateStreak(): StreakData {\n  // Use ISO date string (YYYY-MM-DD) for reliable comparison\n  const today = new Date().toISOString().split('T')[0];\n  const streakData = getStreakData();\n  \n  // If already logged today, no update needed\n  if (streakData.lastLogDate === today) {\n    return streakData;\n  }\n  \n  // Calculate yesterday's date\n  const yesterday = new Date();\n  yesterday.setDate(yesterday.getDate() - 1);\n  const yesterdayStr = yesterday.toISOString().split('T')[0];\n  \n  // Check if streak continues\n  if (streakData.lastLogDate === yesterdayStr) {\n    // Consecutive day - increment streak\n    streakData.currentStreak++;\n  } else {\n    // Streak broken or first log - start new streak\n    streakData.currentStreak = 1;\n  }\n  \n  // Update longest streak\n  if (streakData.currentStreak > streakData.longestStreak) {\n    streakData.longestStreak = streakData.currentStreak;\n  }\n  \n  // Update last log date\n  streakData.lastLogDate = today;\n  \n  // Save to localStorage\n  try {\n    localStorage.setItem(STREAK_STORAGE_KEY, JSON.stringify(streakData));\n  } catch (error) {\n    console.error('Failed to save streak data:', error);\n  }\n  \n  return streakData;\n}\n\n/**\n * Reset streak (for testing or user request)\n */\nexport function resetStreak(): void {\n  localStorage.removeItem(STREAK_STORAGE_KEY);\n  localStorage.removeItem(LAST_LOG_DATE_KEY);\n}\n\n/**\n * Get streak status message\n */\nexport function getStreakMessage(streak: number): string {\n  if (streak === 0) {\n    return \"Start your streak today!\";\n  } else if (streak === 1) {\n    return \"Great start! Keep it going!\";\n  } else if (streak < 7) {\n    return `${streak} days strong! Keep logging!`;\n  } else if (streak < 30) {\n    return `Amazing! ${streak} day streak!`;\n  } else {\n    return `Incredible! ${streak} days and counting!`;\n  }\n}\n","size_bytes":2558},"client/src/pages/ChallengesPage.tsx":{"content":"import { useRef } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { DropdownNavigation } from \"@/components/dropdown-navigation\";\nimport { Card } from \"@/components/ui/card\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Button } from \"@/components/ui/button\";\nimport { Trophy, Star, Flame, Target, CheckCircle2, Lock, ArrowLeft, Share2 } from \"lucide-react\";\nimport type { ChallengeWithProgress } from \"@shared/schema\";\nimport { motion } from \"framer-motion\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { soundService } from \"@/lib/sound-service\";\nimport { ChallengeShareCard } from \"@/components/challenge-share-card\";\nimport { generateAndShareCard } from \"@/lib/share-image-generator\";\nimport { Link } from \"wouter\";\n\nexport function ChallengesPage() {\n  const { isAuthenticated } = useAuth();\n  const { toast } = useToast();\n  const shareCardRef = useRef<HTMLDivElement>(null);\n\n  const { data: challenges = [], isLoading: challengesLoading } = useQuery<ChallengeWithProgress[]>({\n    queryKey: ['/api/challenges'],\n    enabled: isAuthenticated,\n  });\n\n  const { data: pointsData, isLoading: pointsLoading } = useQuery<{ points: number }>({\n    queryKey: ['/api/challenges/points'],\n    enabled: isAuthenticated,\n  });\n\n  const { data: streakData, isLoading: streakLoading } = useQuery<{ streak: number }>({\n    queryKey: ['/api/challenges/streak'],\n    enabled: isAuthenticated,\n  });\n\n  const totalPoints = pointsData?.points || 0;\n  const currentStreak = streakData?.streak || 0;\n\n  const inProgressChallenges = challenges.filter(c => !c.progress || c.progress.isCompleted === 0);\n  const completedChallenges = challenges.filter(c => c.progress?.isCompleted === 1);\n\n  const handleShare = async () => {\n    if (!shareCardRef.current) return;\n\n    try {\n      // Create text fallback for when image sharing fails\n      const textFallback = `ðŸ† My PlateMate Achievements\n\nðŸ“Š Total Points: ${totalPoints}\nðŸ”¥ Current Streak: ${currentStreak} days\nâœ… Challenges Completed: ${completedChallenges.length}\n\nTrack your nutrition goals and earn rewards on PlateMate!`;\n\n      const shared = await generateAndShareCard(\n        shareCardRef.current,\n        `I've earned ${totalPoints} points and have a ${currentStreak} day streak on PlateMate! ðŸ†`,\n        `Check out my progress: ${completedChallenges.length} challenges completed!`,\n        textFallback,\n        `platemate-achievements-${new Date().toISOString().split('T')[0]}.png`\n      );\n      \n      if (shared) {\n        soundService.playSuccess();\n        toast({\n          title: \"Achievement Shared!\",\n          description: \"Your achievement card has been shared successfully.\",\n        });\n      }\n      // If false: either user cancelled or browser doesn't support file sharing (will auto-download)\n      // No message needed - browser's download notification will show if downloaded\n    } catch (error) {\n      soundService.playError();\n      toast({\n        title: \"Share Failed\",\n        description: \"Could not generate achievement card. Please try again.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const getProgressPercentage = (challenge: ChallengeWithProgress) => {\n    if (!challenge.progress) return 0;\n    return Math.min((challenge.progress.currentCount / challenge.targetCount) * 100, 100);\n  };\n\n  const getDifficultyColor = (difficulty: string) => {\n    switch (difficulty) {\n      case 'easy': return 'text-green-600 dark:text-green-400';\n      case 'medium': return 'text-yellow-600 dark:text-yellow-400';\n      case 'hard': return 'text-red-600 dark:text-red-400';\n      default: return 'text-gray-600 dark:text-gray-400';\n    }\n  };\n\n  if (!isAuthenticated) {\n    return (\n      <div className=\"min-h-screen bg-purple-500 dark:bg-gray-900 p-4\">\n        <div className=\"max-w-md mx-auto pt-20\">\n          <Card className=\"p-8 text-center\">\n            <Lock className=\"w-12 h-12 mx-auto mb-4 text-gray-400\" />\n            <h2 className=\"text-xl font-bold mb-2\">Login Required</h2>\n            <p className=\"text-gray-600 dark:text-gray-400\">\n              Please log in to view your challenges\n            </p>\n          </Card>\n        </div>\n        <DropdownNavigation />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-purple-500 dark:bg-gray-900 pb-32\">\n      {/* Header */}\n      <div className=\"bg-gradient-to-r from-purple-600 to-violet-600 dark:from-purple-700 dark:to-violet-700 text-white p-6 pb-8\">\n        <div className=\"max-w-4xl mx-auto\">\n          <div className=\"flex items-center gap-3 mb-2\">\n            <Link to=\"/\">\n              <button\n                className=\"p-2 hover:bg-white/20 rounded-lg transition-colors\"\n                data-testid=\"button-back\"\n              >\n                <ArrowLeft className=\"h-5 w-5\" />\n              </button>\n            </Link>\n            <Trophy className=\"w-8 h-8\" />\n            <h1 className=\"text-3xl font-bold\">Challenges</h1>\n          </div>\n          <p className=\"text-blue-100\">Complete challenges to earn rewards and track your progress</p>\n        </div>\n      </div>\n\n      <div className=\"max-w-4xl mx-auto p-4 -mt-4\">\n        {/* Stats Cards */}\n        <div className=\"grid grid-cols-2 gap-4 mb-6\">\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.3 }}\n          >\n            <Card className=\"p-4 bg-gradient-to-br from-yellow-50 to-orange-50 dark:from-yellow-900/20 dark:to-orange-900/20 border-yellow-200 dark:border-yellow-800\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"p-2 bg-yellow-500 rounded-lg\">\n                  <Star className=\"w-6 h-6 text-white\" />\n                </div>\n                <div>\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400\">Total Points</p>\n                  <p className=\"text-2xl font-bold text-yellow-700 dark:text-yellow-400\">{totalPoints}</p>\n                </div>\n              </div>\n            </Card>\n          </motion.div>\n\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.3, delay: 0.1 }}\n          >\n            <Card className=\"p-4 bg-gradient-to-br from-orange-50 to-red-50 dark:from-orange-900/20 dark:to-red-900/20 border-orange-200 dark:border-orange-800\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"p-2 bg-orange-500 rounded-lg\">\n                  <Flame className=\"w-6 h-6 text-white\" />\n                </div>\n                <div>\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400\">Current Streak</p>\n                  <p className=\"text-2xl font-bold text-orange-700 dark:text-orange-400\">{currentStreak} days</p>\n                </div>\n              </div>\n            </Card>\n          </motion.div>\n        </div>\n\n        {/* Share Button */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.3, delay: 0.2 }}\n          className=\"mb-6\"\n        >\n          <Button\n            onClick={handleShare}\n            className=\"w-full\"\n            data-testid=\"button-share-achievements\"\n          >\n            <Share2 className=\"w-4 h-4 mr-2\" />\n            Share My Achievements\n          </Button>\n        </motion.div>\n\n        {/* In Progress Challenges */}\n        <div className=\"mb-6\">\n          <h2 className=\"text-xl font-bold mb-4 flex items-center gap-2\">\n            <Target className=\"w-6 h-6 text-blue-600 dark:text-blue-400\" />\n            Active Challenges\n          </h2>\n          \n          {challengesLoading ? (\n            <div className=\"space-y-4\">\n              {[1, 2, 3].map(i => (\n                <Card key={i} className=\"p-4 animate-pulse\">\n                  <div className=\"h-20 bg-gray-200 dark:bg-gray-700 rounded\"></div>\n                </Card>\n              ))}\n            </div>\n          ) : inProgressChallenges.length === 0 ? (\n            <Card className=\"p-6 text-center text-gray-500\">\n              <p>All challenges completed! Great job! ðŸŽ‰</p>\n            </Card>\n          ) : (\n            <div className=\"space-y-4\">\n              {inProgressChallenges.map((challenge, index) => (\n                <motion.div\n                  key={challenge.id}\n                  initial={{ opacity: 0, x: -20 }}\n                  animate={{ opacity: 1, x: 0 }}\n                  transition={{ duration: 0.3, delay: index * 0.1 }}\n                >\n                  <Card className=\"p-4 hover:shadow-lg transition-shadow\" data-testid={`card-challenge-${challenge.id}`}>\n                    <div className=\"flex items-start justify-between mb-3\">\n                      <div className=\"flex items-center gap-3\">\n                        <div className=\"text-3xl\">{challenge.rewardBadge}</div>\n                        <div>\n                          <h3 className=\"font-bold text-lg\">{challenge.name}</h3>\n                          <p className=\"text-sm text-gray-600 dark:text-gray-400\">{challenge.description}</p>\n                        </div>\n                      </div>\n                      <div className={`text-xs font-semibold uppercase ${getDifficultyColor(challenge.difficulty)}`}>\n                        {challenge.difficulty}\n                      </div>\n                    </div>\n                    \n                    <div className=\"mb-2\">\n                      <div className=\"flex justify-between text-sm mb-1\">\n                        <span className=\"text-gray-600 dark:text-gray-400\">Progress</span>\n                        <span className=\"font-semibold\">\n                          {challenge.progress?.currentCount || 0} / {challenge.targetCount}\n                        </span>\n                      </div>\n                      <Progress value={getProgressPercentage(challenge)} className=\"h-2\" />\n                    </div>\n                    \n                    <div className=\"flex items-center justify-between text-sm\">\n                      <div className=\"flex items-center gap-1 text-yellow-600 dark:text-yellow-400\">\n                        <Star className=\"w-4 h-4\" />\n                        <span className=\"font-semibold\">{challenge.rewardPoints} points</span>\n                      </div>\n                      <div className=\"text-xs text-gray-500\">\n                        {challenge.challengeType === 'streak' && 'ðŸ”¥ Streak Challenge'}\n                        {challenge.challengeType === 'count' && 'ðŸ“Š Count Challenge'}\n                        {challenge.challengeType === 'goal' && 'ðŸŽ¯ Goal Challenge'}\n                      </div>\n                    </div>\n                  </Card>\n                </motion.div>\n              ))}\n            </div>\n          )}\n        </div>\n\n        {/* Completed Challenges */}\n        {completedChallenges.length > 0 && (\n          <div className=\"mb-6\">\n            <h2 className=\"text-xl font-bold mb-4 flex items-center gap-2\">\n              <CheckCircle2 className=\"w-6 h-6 text-green-600\" />\n              Completed Challenges\n            </h2>\n            \n            <div className=\"space-y-3\">\n              {completedChallenges.map((challenge, index) => (\n                <motion.div\n                  key={challenge.id}\n                  initial={{ opacity: 0, scale: 0.95 }}\n                  animate={{ opacity: 1, scale: 1 }}\n                  transition={{ duration: 0.3, delay: index * 0.05 }}\n                >\n                  <Card className=\"p-3 bg-green-50 dark:bg-green-900/10 border-green-200 dark:border-green-800\" data-testid={`card-completed-${challenge.id}`}>\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"text-2xl opacity-75\">{challenge.rewardBadge}</div>\n                      <div className=\"flex-1\">\n                        <h3 className=\"font-semibold\">{challenge.name}</h3>\n                        <p className=\"text-xs text-gray-600 dark:text-gray-400\">\n                          Completed {challenge.progress?.completedAt ? new Date(challenge.progress.completedAt).toLocaleDateString() : ''}\n                        </p>\n                      </div>\n                      <div className=\"flex items-center gap-1 text-yellow-600 dark:text-yellow-400 font-semibold\">\n                        <Star className=\"w-4 h-4\" />\n                        <span>+{challenge.rewardPoints}</span>\n                      </div>\n                      <CheckCircle2 className=\"w-5 h-5 text-green-600 dark:text-green-400\" />\n                    </div>\n                  </Card>\n                </motion.div>\n              ))}\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Hidden Share Card for Image Generation */}\n      <div className=\"fixed -left-[9999px] -top-[9999px]\">\n        <ChallengeShareCard\n          ref={shareCardRef}\n          points={totalPoints}\n          streak={currentStreak}\n          completedChallenges={completedChallenges.length}\n        />\n      </div>\n\n      <DropdownNavigation />\n    </div>\n  );\n}\n","size_bytes":13233},"client/src/pages/InsightsPage.tsx":{"content":"import { useState, useRef } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { DropdownNavigation } from \"@/components/dropdown-navigation\";\nimport { BottomHelpSection } from \"@/components/bottom-help-section\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport { Lightbulb, RefreshCw, Calendar, TrendingUp, Check, AlertCircle, ArrowLeft, Share2 } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport type { Reflection } from \"@shared/schema\";\nimport { motion } from \"framer-motion\";\nimport { soundService } from \"@/lib/sound-service\";\nimport { InsightShareCard } from \"@/components/insight-share-card\";\nimport { generateAndShareCard } from \"@/lib/share-image-generator\";\nimport { buildApiUrl } from '@/lib/api-config';\nimport { Link } from \"wouter\";\n\nexport function InsightsPage() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const { isAuthenticated } = useAuth();\n  const [period, setPeriod] = useState<'daily' | 'weekly'>('daily');\n  const shareCardRef = useRef<HTMLDivElement>(null);\n\n  // Fetch latest reflection\n  const { data: reflection, isLoading, error } = useQuery<Reflection>({\n    queryKey: [`/api/reflections/latest?period=${period}`],\n    enabled: isAuthenticated,\n  });\n\n  // Generate new reflection\n  const generateMutation = useMutation({\n    mutationFn: async () => {\n      const response = await fetch(buildApiUrl(`/api/reflections/generate?period=${period}`), {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${localStorage.getItem('token')}`,\n        },\n      });\n      if (!response.ok) throw new Error('Failed to generate reflection');\n      return response.json();\n    },\n    onSuccess: () => {\n      soundService.playSuccess();\n      toast({\n        title: \"Reflection Generated!\",\n        description: `Your new ${period} reflection is ready.`,\n      });\n      queryClient.invalidateQueries({ queryKey: [`/api/reflections/latest?period=${period}`] });\n    },\n    onError: () => {\n      soundService.playError();\n      toast({\n        title: \"Generation Failed\",\n        description: \"Could not generate reflection. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Refresh reflection (deletes cached one and regenerates with current data)\n  const refreshMutation = useMutation({\n    mutationFn: async () => {\n      const response = await fetch(buildApiUrl(`/api/reflections/refresh?period=${period}`), {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${localStorage.getItem('token')}`,\n        },\n      });\n      if (!response.ok) throw new Error('Failed to refresh reflection');\n      return response.json();\n    },\n    onSuccess: () => {\n      soundService.playSuccess();\n      toast({\n        title: \"Insights Refreshed!\",\n        description: \"Your reflection has been updated with your current diary data.\",\n      });\n      queryClient.invalidateQueries({ queryKey: [`/api/reflections/latest?period=${period}`] });\n    },\n    onError: () => {\n      soundService.playError();\n      toast({\n        title: \"Refresh Failed\",\n        description: \"Could not refresh reflection. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleShare = async () => {\n    if (!reflection || !shareCardRef.current) return;\n\n    try {\n      // Create text fallback for when image sharing fails\n      const textFallback = `ðŸ½ï¸ My ${period === 'daily' ? 'Daily' : 'Weekly'} Nutrition Reflection ðŸ’œ\n\nâœ… What Went Well:\n${reflection.wentWell}\n\nâš ï¸ Room for Growth:\n${reflection.couldImprove}\n\nðŸ’ª Positivity Score: ${reflection.sentimentScore}%\n\nTrack your nutrition with AI-powered insights on PlateMate!`;\n\n      // Generate and share the image with text fallback\n      const shared = await generateAndShareCard(\n        shareCardRef.current,\n        `My ${period === 'daily' ? 'Daily' : 'Weekly'} Nutrition Reflection - PlateMate`,\n        reflection.wentWell,\n        textFallback,\n        `platemate-reflection-${period}-${new Date().toISOString().split('T')[0]}.png`\n      );\n\n      // Only update share status if user actually shared\n      if (shared) {\n        await fetch(buildApiUrl(`/api/reflections/${reflection.id}/share`), {\n          method: 'PATCH',\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer ${localStorage.getItem('token')}`,\n          },\n          body: JSON.stringify({ shareChannel: 'facebook' }),\n        });\n\n        soundService.playSuccess();\n        toast({\n          title: \"Reflection Shared!\",\n          description: \"Your reflection card has been shared successfully.\",\n        });\n      }\n      // If false: either user cancelled or browser doesn't support file sharing (will auto-download)\n      // No message needed - browser's download notification will show if downloaded\n    } catch (error) {\n      soundService.playError();\n      toast({\n        title: \"Share Failed\",\n        description: \"Could not generate reflection card. Please try again.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  if (!isAuthenticated) {\n    return (\n      <div className=\"min-h-screen bg-purple-500 dark:bg-gray-900 p-4\">\n        <div className=\"max-w-md mx-auto pt-20\">\n          <Card className=\"p-8 text-center\">\n            <AlertCircle className=\"w-12 h-12 mx-auto mb-4 text-gray-400\" />\n            <h2 className=\"text-xl font-bold mb-2\">Login Required</h2>\n            <p className=\"text-gray-600 dark:text-gray-400\">\n              Please log in to view your insights\n            </p>\n          </Card>\n        </div>\n        <DropdownNavigation />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-purple-500 dark:bg-gray-900 pb-32\">\n      {/* Header */}\n      <div className=\"bg-gradient-to-r from-purple-600 to-violet-600 dark:from-purple-700 dark:to-violet-700 text-white p-6 pb-8\">\n        <div className=\"max-w-4xl mx-auto\">\n          <div className=\"flex items-center gap-3 mb-2\">\n            <Link to=\"/\">\n              <button\n                className=\"p-2 hover:bg-white/20 rounded-lg transition-colors\"\n                data-testid=\"button-back\"\n              >\n                <ArrowLeft className=\"h-5 w-5\" />\n              </button>\n            </Link>\n            <Lightbulb className=\"w-8 h-8\" />\n            <h1 className=\"text-3xl font-bold\">Insights</h1>\n          </div>\n          <p className=\"text-green-100\">AI-powered reflections on your nutrition journey</p>\n        </div>\n      </div>\n\n      <div className=\"max-w-4xl mx-auto p-4 -mt-4\">\n        {/* Period Toggle */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.3 }}\n          className=\"flex gap-2 mb-6\"\n        >\n          <Button\n            variant={period === 'daily' ? 'default' : 'outline'}\n            onClick={() => setPeriod('daily')}\n            className=\"flex-1\"\n            data-testid=\"button-period-daily\"\n          >\n            <Calendar className=\"w-4 h-4 mr-2\" />\n            Daily\n          </Button>\n          <Button\n            variant={period === 'weekly' ? 'default' : 'outline'}\n            onClick={() => setPeriod('weekly')}\n            className=\"flex-1\"\n            data-testid=\"button-period-weekly\"\n          >\n            <TrendingUp className=\"w-4 h-4 mr-2\" />\n            Weekly\n          </Button>\n        </motion.div>\n\n        {/* Loading State */}\n        {isLoading && (\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            className=\"text-center py-12\"\n          >\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto\"></div>\n            <p className=\"mt-4 text-gray-600 dark:text-gray-400\">Loading your insights...</p>\n          </motion.div>\n        )}\n\n        {/* Error State */}\n        {error && (\n          <Card className=\"p-8 text-center\">\n            <AlertCircle className=\"w-12 h-12 mx-auto mb-4 text-red-500\" />\n            <h3 className=\"text-lg font-semibold mb-2\">Could not load reflection</h3>\n            <p className=\"text-gray-600 dark:text-gray-400 mb-4\">\n              Please try generating a new one\n            </p>\n            <Button\n              onClick={() => generateMutation.mutate()}\n              disabled={generateMutation.isPending}\n              data-testid=\"button-generate-reflection\"\n            >\n              <RefreshCw className={`w-4 h-4 mr-2 ${generateMutation.isPending ? 'animate-spin' : ''}`} />\n              Generate Reflection\n            </Button>\n          </Card>\n        )}\n\n        {/* Reflection Display */}\n        {reflection && !isLoading && (\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.5, delay: 0.1 }}\n          >\n            <Card className=\"p-6 mb-6 shadow-lg\">\n              {/* Header */}\n              <div className=\"flex items-center justify-between mb-6\">\n                <div>\n                  <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\n                    {period === 'daily' ? 'Daily' : 'Weekly'} Reflection\n                  </h2>\n                  <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n                    {new Date(reflection.createdAt).toLocaleDateString('en-US', {\n                      weekday: 'long',\n                      year: 'numeric',\n                      month: 'long',\n                      day: 'numeric'\n                    })}\n                  </p>\n                </div>\n                <div className=\"flex gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => refreshMutation.mutate()}\n                    disabled={refreshMutation.isPending}\n                    data-testid=\"button-refresh-insights\"\n                    title=\"Refresh insights with current diary data\"\n                  >\n                    <RefreshCw className={`w-4 h-4 ${refreshMutation.isPending ? 'animate-spin' : ''}`} />\n                  </Button>\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={handleShare}\n                    data-testid=\"button-share-reflection\"\n                  >\n                    <Share2 className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </div>\n\n              {/* What Went Well */}\n              <div className=\"mb-6\">\n                <div className=\"flex items-center gap-2 mb-3\">\n                  <div className=\"w-10 h-10 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center\">\n                    <Check className=\"w-5 h-5 text-green-600 dark:text-green-400\" />\n                  </div>\n                  <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">What Went Well</h3>\n                </div>\n                <p className=\"text-gray-700 dark:text-gray-300 ml-12\" data-testid=\"text-went-well\">\n                  {reflection.wentWell}\n                </p>\n              </div>\n\n              {/* Could Improve */}\n              <div className=\"mb-6\">\n                <div className=\"flex items-center gap-2 mb-3\">\n                  <div className=\"w-10 h-10 rounded-full bg-yellow-100 dark:bg-yellow-900 flex items-center justify-center\">\n                    <TrendingUp className=\"w-5 h-5 text-yellow-600 dark:text-yellow-400\" />\n                  </div>\n                  <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">Could Improve</h3>\n                </div>\n                <p className=\"text-gray-700 dark:text-gray-300 ml-12\" data-testid=\"text-could-improve\">\n                  {reflection.couldImprove}\n                </p>\n              </div>\n\n              {/* Action Steps */}\n              <div>\n                <div className=\"flex items-center gap-2 mb-3\">\n                  <div className=\"w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center\">\n                    <Lightbulb className=\"w-5 h-5 text-blue-600 dark:text-blue-400\" />\n                  </div>\n                  <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">Action Steps</h3>\n                </div>\n                <ul className=\"space-y-2 ml-12\">\n                  {reflection.actionSteps?.map((step, index) => (\n                    <motion.li\n                      key={index}\n                      initial={{ opacity: 0, x: -20 }}\n                      animate={{ opacity: 1, x: 0 }}\n                      transition={{ duration: 0.3, delay: index * 0.1 + 0.5 }}\n                      className=\"flex items-start gap-2\"\n                      data-testid={`text-action-step-${index}`}\n                    >\n                      <span className=\"w-6 h-6 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-sm font-medium flex-shrink-0 mt-0.5\">\n                        {index + 1}\n                      </span>\n                      <span className=\"text-gray-700 dark:text-gray-300\">{step}</span>\n                    </motion.li>\n                  ))}\n                </ul>\n              </div>\n\n              {/* Sentiment Score */}\n              <div className=\"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-sm text-gray-600 dark:text-gray-400\">Positivity Score</span>\n                  <div className=\"flex items-center gap-2\">\n                    <div className=\"w-32 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden\">\n                      <div \n                        className=\"h-full bg-gradient-to-r from-green-400 to-emerald-500 transition-all duration-500\"\n                        style={{ width: `${reflection.sentimentScore}%` }}\n                      />\n                    </div>\n                    <span className=\"text-sm font-semibold text-gray-900 dark:text-white\">\n                      {reflection.sentimentScore}%\n                    </span>\n                  </div>\n                </div>\n              </div>\n            </Card>\n          </motion.div>\n        )}\n      </div>\n\n      {/* Hidden Share Card for Image Generation */}\n      {reflection && (\n        <div className=\"fixed -left-[9999px] -top-[9999px]\">\n          <InsightShareCard\n            ref={shareCardRef}\n            period={period}\n            wentWell={reflection.wentWell}\n            couldImprove={reflection.couldImprove}\n            sentimentScore={reflection.sentimentScore}\n            date={new Date(reflection.createdAt).toLocaleDateString('en-US', {\n              weekday: 'long',\n              year: 'numeric',\n              month: 'long',\n              day: 'numeric'\n            })}\n          />\n        </div>\n      )}\n\n      <DropdownNavigation />\n      <BottomHelpSection />\n    </div>\n  );\n}\n","size_bytes":15195},"server/services/challenge-service.ts":{"content":"import { storage } from \"../storage\";\nimport { db } from \"../db\";\nimport { challenges } from \"@shared/schema\";\nimport type { Challenge, UserChallengeProgress, ChallengeWithProgress } from \"@shared/schema\";\n\n// Predefined challenges that users can complete\nexport const CHALLENGE_DEFINITIONS = [\n  {\n    challengeKey: \"first_meal_logged\",\n    name: \"First Steps\",\n    description: \"Log your first meal\",\n    challengeType: \"count\" as const,\n    targetCount: 1,\n    rewardPoints: 10,\n    rewardBadge: \"ðŸŽ‰\",\n    difficulty: \"easy\" as const,\n  },\n  {\n    challengeKey: \"5_meals_logged\",\n    name: \"Getting Started\",\n    description: \"Log 5 meals\",\n    challengeType: \"count\" as const,\n    targetCount: 5,\n    rewardPoints: 25,\n    rewardBadge: \"ðŸŒŸ\",\n    difficulty: \"easy\" as const,\n  },\n  {\n    challengeKey: \"3_day_streak\",\n    name: \"Consistency Builder\",\n    description: \"Log meals for 3 consecutive days\",\n    challengeType: \"streak\" as const,\n    targetCount: 3,\n    rewardPoints: 50,\n    rewardBadge: \"ðŸ”¥\",\n    difficulty: \"medium\" as const,\n  },\n  {\n    challengeKey: \"7_day_streak\",\n    name: \"Week Warrior\",\n    description: \"Log meals for 7 consecutive days\",\n    challengeType: \"streak\" as const,\n    targetCount: 7,\n    rewardPoints: 100,\n    rewardBadge: \"ðŸ’ª\",\n    difficulty: \"medium\" as const,\n  },\n  {\n    challengeKey: \"30_day_streak\",\n    name: \"Habit Master\",\n    description: \"Log meals for 30 consecutive days\",\n    challengeType: \"streak\" as const,\n    targetCount: 30,\n    rewardPoints: 500,\n    rewardBadge: \"ðŸ‘‘\",\n    difficulty: \"hard\" as const,\n  },\n  {\n    challengeKey: \"water_goal_5_days\",\n    name: \"Hydration Hero\",\n    description: \"Meet your daily water goal 5 times\",\n    challengeType: \"goal\" as const,\n    targetCount: 5,\n    rewardPoints: 75,\n    rewardBadge: \"ðŸ’§\",\n    difficulty: \"medium\" as const,\n  },\n  {\n    challengeKey: \"calorie_goal_10_days\",\n    name: \"Calorie Champion\",\n    description: \"Stay within your calorie goal 10 times\",\n    challengeType: \"goal\" as const,\n    targetCount: 10,\n    rewardPoints: 150,\n    rewardBadge: \"ðŸŽ¯\",\n    difficulty: \"hard\" as const,\n  },\n  {\n    challengeKey: \"protein_goal_7_days\",\n    name: \"Protein Pro\",\n    description: \"Meet your protein goal 7 times\",\n    challengeType: \"goal\" as const,\n    targetCount: 7,\n    rewardPoints: 100,\n    rewardBadge: \"ðŸ’ª\",\n    difficulty: \"medium\" as const,\n  },\n  {\n    challengeKey: \"weight_logged_10_times\",\n    name: \"Scale Master\",\n    description: \"Log your weight 10 times\",\n    challengeType: \"count\" as const,\n    targetCount: 10,\n    rewardPoints: 50,\n    rewardBadge: \"âš–ï¸\",\n    difficulty: \"easy\" as const,\n  },\n  {\n    challengeKey: \"100_meals_logged\",\n    name: \"Tracking Legend\",\n    description: \"Log 100 meals total\",\n    challengeType: \"count\" as const,\n    targetCount: 100,\n    rewardPoints: 250,\n    rewardBadge: \"ðŸ†\",\n    difficulty: \"hard\" as const,\n  },\n];\n\nexport class ChallengeService {\n  \n  async initializeChallenges(): Promise<void> {\n    for (const challengeDef of CHALLENGE_DEFINITIONS) {\n      const existing = await storage.getChallengeByKey(challengeDef.challengeKey);\n      if (!existing) {\n        await db.insert(challenges).values({\n          challengeKey: challengeDef.challengeKey,\n          name: challengeDef.name,\n          description: challengeDef.description,\n          challengeType: challengeDef.challengeType,\n          targetCount: challengeDef.targetCount,\n          rewardPoints: challengeDef.rewardPoints,\n          rewardBadge: challengeDef.rewardBadge,\n          difficulty: challengeDef.difficulty,\n          isActive: 1,\n        } as any);\n      }\n    }\n  }\n\n  async trackMealLogged(userId: string): Promise<UserChallengeProgress[]> {\n    const completedChallenges: UserChallengeProgress[] = [];\n    \n    const mealChallenges = ['first_meal_logged', '5_meals_logged', '100_meals_logged'];\n    \n    for (const challengeKey of mealChallenges) {\n      const challenge = await storage.getChallengeByKey(challengeKey);\n      if (!challenge) continue;\n      \n      const progress = await storage.createOrUpdateProgress(userId, challenge.id, 1);\n      \n      if (progress.currentCount >= challenge.targetCount && progress.isCompleted === 0) {\n        const completed = await storage.completeChallenge(userId, challenge.id);\n        if (completed) {\n          completedChallenges.push(completed);\n        }\n      }\n    }\n    \n    return completedChallenges;\n  }\n\n  async trackWeightLogged(userId: string): Promise<UserChallengeProgress[]> {\n    const completedChallenges: UserChallengeProgress[] = [];\n    \n    const weightChallenge = await storage.getChallengeByKey('weight_logged_10_times');\n    if (!weightChallenge) return completedChallenges;\n    \n    const progress = await storage.createOrUpdateProgress(userId, weightChallenge.id, 1);\n    \n    if (progress.currentCount >= weightChallenge.targetCount && progress.isCompleted === 0) {\n      const completed = await storage.completeChallenge(userId, weightChallenge.id);\n      if (completed) {\n        completedChallenges.push(completed);\n      }\n    }\n    \n    return completedChallenges;\n  }\n\n  async checkStreakChallenge(userId: string, consecutiveDays: number): Promise<UserChallengeProgress[]> {\n    const completedChallenges: UserChallengeProgress[] = [];\n    \n    const streakChallenges = ['3_day_streak', '7_day_streak', '30_day_streak'];\n    \n    for (const challengeKey of streakChallenges) {\n      const challenge = await storage.getChallengeByKey(challengeKey);\n      if (!challenge) continue;\n      \n      const existingProgress = await storage.getUserChallengeProgress(userId, challenge.id);\n      \n      if (!existingProgress || existingProgress.isCompleted === 1) continue;\n      \n      if (consecutiveDays >= challenge.targetCount) {\n        const completed = await storage.completeChallenge(userId, challenge.id);\n        if (completed) {\n          completedChallenges.push(completed);\n        }\n      } else {\n        await storage.createOrUpdateProgress(userId, challenge.id, consecutiveDays - (existingProgress?.currentCount || 0));\n      }\n    }\n    \n    return completedChallenges;\n  }\n\n  async checkGoalChallenge(userId: string, goalType: 'water' | 'calorie' | 'protein'): Promise<UserChallengeProgress[]> {\n    const completedChallenges: UserChallengeProgress[] = [];\n    \n    const challengeKeyMap = {\n      water: 'water_goal_5_days',\n      calorie: 'calorie_goal_10_days',\n      protein: 'protein_goal_7_days',\n    };\n    \n    const challengeKey = challengeKeyMap[goalType];\n    const challenge = await storage.getChallengeByKey(challengeKey);\n    if (!challenge) return completedChallenges;\n    \n    const progress = await storage.createOrUpdateProgress(userId, challenge.id, 1);\n    \n    if (progress.currentCount >= challenge.targetCount && progress.isCompleted === 0) {\n      const completed = await storage.completeChallenge(userId, challenge.id);\n      if (completed) {\n        completedChallenges.push(completed);\n      }\n    }\n    \n    return completedChallenges;\n  }\n\n  async getUserChallengesWithProgress(userId: string): Promise<ChallengeWithProgress[]> {\n    return await storage.getUserAllChallengesProgress(userId);\n  }\n\n  async getUserCompletedChallenges(userId: string): Promise<ChallengeWithProgress[]> {\n    return await storage.getUserCompletedChallenges(userId);\n  }\n\n  async getUserTotalPoints(userId: string): Promise<number> {\n    return await storage.getUserPoints(userId);\n  }\n\n  async calculateCurrentStreak(userId: string): Promise<number> {\n    const diaryEntries = await storage.getDiaryEntries(userId, 100);\n    \n    if (diaryEntries.length === 0) return 0;\n    \n    // Get unique days when user logged meals\n    const uniqueDays = new Set<string>();\n    for (const entry of diaryEntries) {\n      const dateStr = new Date(entry.mealDate).toISOString().split('T')[0];\n      uniqueDays.add(dateStr);\n    }\n    \n    const sortedDays = Array.from(uniqueDays).sort((a, b) => b.localeCompare(a));\n    \n    const today = new Date().toISOString().split('T')[0];\n    const yesterday = new Date();\n    yesterday.setDate(yesterday.getDate() - 1);\n    const yesterdayStr = yesterday.toISOString().split('T')[0];\n    \n    // Check if user has logged today or yesterday (grace period)\n    // Streak is alive if last log was today or yesterday\n    const lastLogDate = sortedDays[0];\n    \n    if (lastLogDate !== today && lastLogDate !== yesterdayStr) {\n      // Last log was before yesterday - streak is broken\n      return 0;\n    }\n    \n    // Calculate streak by counting consecutive days backwards\n    let streak = 0;\n    const startDate = lastLogDate === today ? today : yesterdayStr;\n    \n    for (let i = 0; i < sortedDays.length; i++) {\n      const expectedDate = new Date(startDate);\n      expectedDate.setDate(expectedDate.getDate() - i);\n      const expectedDateStr = expectedDate.toISOString().split('T')[0];\n      \n      if (sortedDays.find(d => d === expectedDateStr)) {\n        streak++;\n      } else {\n        break;\n      }\n    }\n    \n    return streak;\n  }\n}\n\nexport const challengeService = new ChallengeService();\n","size_bytes":9120},"server/services/reflection-service.ts":{"content":"import { storage } from \"../storage\";\nimport type { DiaryEntryWithAnalysis, DrinkEntry, NutritionGoals, Reflection } from \"@shared/schema\";\nimport { OpenAIProvider } from \"../ai-providers/openai-provider\";\nimport { GeminiProvider } from \"../ai-providers/gemini-provider\";\n\ninterface NutritionSummary {\n  totalCalories: number;\n  totalProtein: number;\n  totalCarbs: number;\n  totalFat: number;\n  totalWater: number;\n  mealCount: number;\n  goals?: NutritionGoals;\n}\n\nexport class ReflectionService {\n  private openaiProvider = new OpenAIProvider();\n  private geminiProvider = new GeminiProvider();\n\n  /**\n   * Generate a daily reflection for the user based on yesterday's nutrition data\n   */\n  async generateDailyReflection(userId: string): Promise<Reflection> {\n    // Get yesterday's date range\n    const now = new Date();\n    const yesterday = new Date(now);\n    yesterday.setDate(yesterday.getDate() - 1);\n    yesterday.setHours(0, 0, 0, 0);\n    \n    const endOfYesterday = new Date(yesterday);\n    endOfYesterday.setHours(23, 59, 59, 999);\n\n    // Gather nutrition data\n    const summary = await this.getNutritionSummary(userId, yesterday, endOfYesterday);\n    \n    // Generate reflection using AI\n    const reflectionContent = await this.generateReflectionContent(summary);\n    \n    // Save to database\n    const reflection = await storage.createReflection({\n      userId,\n      reflectionPeriod: 'daily',\n      periodStart: yesterday.toISOString(),\n      periodEnd: endOfYesterday.toISOString(),\n      wentWell: reflectionContent.wentWell,\n      couldImprove: reflectionContent.couldImprove,\n      actionSteps: reflectionContent.actionSteps,\n      sentimentScore: reflectionContent.sentimentScore,\n      aiProvider: reflectionContent.provider,\n      aiModel: reflectionContent.model,\n      status: 'final',\n    });\n\n    return reflection;\n  }\n\n  /**\n   * Get the latest daily reflection or generate a new one if needed\n   */\n  async getOrGenerateDailyReflection(userId: string): Promise<Reflection> {\n    // Check if we already have today's reflection\n    const latest = await storage.getLatestReflection(userId, 'daily');\n    \n    if (latest) {\n      // Check if it's from today\n      const latestDate = new Date(latest.createdAt);\n      const today = new Date();\n      \n      if (latestDate.toDateString() === today.toDateString()) {\n        return latest;\n      }\n    }\n\n    // Generate new reflection\n    return await this.generateDailyReflection(userId);\n  }\n\n  /**\n   * Gather nutrition summary for a given period\n   */\n  private async getNutritionSummary(\n    userId: string,\n    startDate: Date,\n    endDate: Date\n  ): Promise<NutritionSummary> {\n    // Get diary entries\n    const diaryEntries = await storage.getDiaryEntriesByDateRange(userId, startDate, endDate);\n    \n    // Get drink entries\n    const drinkEntries = await storage.getDrinkEntries(userId);\n    const periodDrinks = drinkEntries.filter(d => {\n      const drinkDate = new Date(d.loggedAt);\n      return drinkDate >= startDate && drinkDate <= endDate;\n    });\n\n    // Get nutrition goals\n    const goals = await storage.getNutritionGoals(userId);\n\n    // Calculate totals\n    let totalCalories = 0;\n    let totalProtein = 0;\n    let totalCarbs = 0;\n    let totalFat = 0;\n    let totalWater = 0;\n\n    diaryEntries.forEach(entry => {\n      const multiplier = (entry.portionMultiplier || 100) / 100;\n      totalCalories += entry.analysis.totalCalories * multiplier;\n      totalProtein += entry.analysis.totalProtein * multiplier;\n      totalCarbs += entry.analysis.totalCarbs * multiplier;\n      totalFat += entry.analysis.totalFat * multiplier;\n    });\n\n    periodDrinks.forEach(drink => {\n      if (drink.drinkType === 'water') {\n        totalWater += drink.amount;\n      }\n      totalCalories += drink.calories || 0;\n    });\n\n    return {\n      totalCalories: Math.round(totalCalories),\n      totalProtein: Math.round(totalProtein),\n      totalCarbs: Math.round(totalCarbs),\n      totalFat: Math.round(totalFat),\n      totalWater,\n      mealCount: diaryEntries.length,\n      goals,\n    };\n  }\n\n  /**\n   * Generate reflection content using AI\n   */\n  private async generateReflectionContent(summary: NutritionSummary): Promise<{\n    wentWell: string;\n    couldImprove: string;\n    actionSteps: string[];\n    sentimentScore: number;\n    provider: string;\n    model: string;\n  }> {\n    const prompt = this.buildReflectionPrompt(summary);\n\n    // Try OpenAI first, fallback to Gemini\n    let response;\n    let provider = 'openai';\n    let model = 'gpt-4o-mini';\n\n    try {\n      const openaiResponse = await this.openaiProvider.answerNutritionQuestion(prompt, []);\n      response = openaiResponse;\n    } catch (error) {\n      console.log('OpenAI failed, trying Gemini:', error);\n      try {\n        const geminiResponse = await this.geminiProvider.answerNutritionQuestion(prompt, []);\n        response = geminiResponse;\n        provider = 'gemini';\n        model = 'gemini-1.5-flash';\n      } catch (geminiError) {\n        console.error('Both AI providers failed:', geminiError);\n        // Return fallback reflection\n        return this.getFallbackReflection();\n      }\n    }\n\n    // Parse AI response\n    return this.parseReflectionResponse(response, provider, model);\n  }\n\n  /**\n   * Build the prompt for AI reflection generation\n   */\n  private buildReflectionPrompt(summary: NutritionSummary): string {\n    const { totalCalories, totalProtein, totalCarbs, totalFat, totalWater, mealCount, goals } = summary;\n\n    const calorieGoal = goals?.dailyCalories || 2000;\n    const proteinGoal = goals?.dailyProtein || 150;\n    const waterGoal = goals?.dailyWater || 2000;\n\n    const caloriePercent = Math.round((totalCalories / calorieGoal) * 100);\n    const proteinPercent = Math.round((totalProtein / proteinGoal) * 100);\n    const waterPercent = Math.round((totalWater / waterGoal) * 100);\n\n    return `You are an honest, accountability-focused nutrition coach. Generate a truthful daily reflection based on the user's actual performance yesterday. Hold them accountable while remaining polite.\n\nNutrition Data:\n- Calories: ${totalCalories} / ${calorieGoal} (${caloriePercent}%)\n- Protein: ${totalProtein}g / ${proteinGoal}g (${proteinPercent}%)\n- Carbs: ${totalCarbs}g\n- Fat: ${totalFat}g\n- Water: ${totalWater}ml / ${waterGoal}ml (${waterPercent}%)\n- Meals logged: ${mealCount}\n\nIMPORTANT SCORING GUIDELINES:\n- If mealCount is 0: Express polite disappointment that no tracking occurred. sentimentScore should be 20-30. Do NOT praise them.\n- If calories/protein are <50% of goals: Acknowledge the significant shortfall. sentimentScore should be 30-50.\n- If calories/protein are 50-80% of goals: Note room for improvement. sentimentScore should be 50-70.\n- If calories/protein are >80% of goals: Give genuine encouragement. sentimentScore should be 70-90.\n- Only celebrate when there's actual achievement to celebrate.\n\nRespond in the following JSON format:\n{\n  \"wentWell\": \"Honest observations about what went well (or acknowledge nothing if mealCount is 0)\",\n  \"couldImprove\": \"Direct feedback about what needs to change\",\n  \"actionSteps\": [\"specific action 1\", \"specific action 2\", \"specific action 3\"],\n  \"sentimentScore\": 0-100\n}\n\nBe honest and hold them accountable. If they didn't track or fell short, say so clearly but politely. The sentimentScore must accurately reflect their actual performance, not fake encouragement.`;\n  }\n\n  /**\n   * Parse AI response into reflection format\n   */\n  private parseReflectionResponse(response: string, provider: string, model: string): {\n    wentWell: string;\n    couldImprove: string;\n    actionSteps: string[];\n    sentimentScore: number;\n    provider: string;\n    model: string;\n  } {\n    try {\n      // Try to extract JSON from response\n      const jsonMatch = response.match(/\\{[\\s\\S]*\\}/);\n      if (jsonMatch) {\n        const parsed = JSON.parse(jsonMatch[0]);\n        return {\n          wentWell: parsed.wentWell || 'You logged your meals consistently.',\n          couldImprove: parsed.couldImprove || 'Consider tracking water intake more regularly.',\n          actionSteps: parsed.actionSteps || ['Keep logging your meals', 'Stay hydrated', 'Aim for balanced nutrition'],\n          sentimentScore: parsed.sentimentScore || 75,\n          provider,\n          model,\n        };\n      }\n    } catch (error) {\n      console.error('Failed to parse AI response:', error);\n    }\n\n    // Fallback if parsing fails\n    return this.getFallbackReflection(provider, model);\n  }\n\n  /**\n   * Get fallback reflection when AI fails\n   */\n  private getFallbackReflection(provider = 'fallback', model = 'none'): {\n    wentWell: string;\n    couldImprove: string;\n    actionSteps: string[];\n    sentimentScore: number;\n    provider: string;\n    model: string;\n  } {\n    return {\n      wentWell: 'Unable to generate personalized reflection at this time.',\n      couldImprove: 'Please review your tracking data manually to assess your progress. Consistent tracking is essential for achieving your nutrition goals.',\n      actionSteps: [\n        'Log all meals and snacks throughout the day',\n        'Track water intake to stay hydrated',\n        'Review your daily goals and plan ahead'\n      ],\n      sentimentScore: 50,\n      provider,\n      model,\n    };\n  }\n}\n\nexport const reflectionService = new ReflectionService();\n","size_bytes":9334},"client/src/components/share-to-facebook.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Facebook } from \"lucide-react\";\n\ninterface ShareToFacebookProps {\n  url?: string;\n  title: string;\n  description?: string;\n  onClick?: () => void;\n  variant?: \"default\" | \"outline\" | \"ghost\";\n  size?: \"default\" | \"sm\" | \"lg\" | \"icon\";\n  className?: string;\n}\n\nexport function ShareToFacebook({ \n  url, \n  title, \n  description,\n  onClick,\n  variant = \"default\",\n  size = \"default\",\n  className = \"\"\n}: ShareToFacebookProps) {\n  \n  const handleShare = () => {\n    // Get the current page URL if not provided\n    const shareUrl = url || window.location.href;\n    \n    // Encode the URL for Facebook\n    const encodedUrl = encodeURIComponent(shareUrl);\n    \n    // Build Facebook sharer URL\n    const facebookShareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodedUrl}`;\n    \n    // Open Facebook share dialog in a popup window\n    const popupWidth = 600;\n    const popupHeight = 400;\n    const left = (screen.width / 2) - (popupWidth / 2);\n    const top = (screen.height / 2) - (popupHeight / 2);\n    \n    window.open(\n      facebookShareUrl,\n      'facebook-share-dialog',\n      `width=${popupWidth},height=${popupHeight},left=${left},top=${top},scrollbars=no`\n    );\n    \n    // Call the optional onClick callback\n    onClick?.();\n  };\n\n  return (\n    <Button \n      onClick={handleShare}\n      variant={variant}\n      size={size}\n      className={className}\n      data-testid=\"button-share-facebook\"\n    >\n      <Facebook className=\"w-4 h-4 mr-2\" />\n      Share to Facebook\n    </Button>\n  );\n}\n","size_bytes":1565},"client/src/components/insight-share-card.tsx":{"content":"import { forwardRef } from \"react\";\nimport { Lightbulb, Check, TrendingUp } from \"lucide-react\";\n\ninterface InsightShareCardProps {\n  period: 'daily' | 'weekly';\n  wentWell: string;\n  couldImprove: string;\n  sentimentScore: number;\n  date: string;\n}\n\nexport const InsightShareCard = forwardRef<HTMLDivElement, InsightShareCardProps>(\n  ({ period, wentWell, couldImprove, sentimentScore, date }, ref) => {\n    return (\n      <div\n        ref={ref}\n        className=\"relative bg-gradient-to-br from-purple-700 via-purple-600 to-fuchsia-600 p-8 rounded-2xl w-[600px] text-white overflow-hidden\"\n        style={{ fontFamily: 'system-ui, -apple-system, sans-serif' }}\n      >\n        {/* Metallic overlay effect */}\n        <div className=\"absolute inset-0 bg-gradient-to-br from-white/20 via-transparent to-black/20 pointer-events-none\"></div>\n        \n        <div className=\"relative z-10\">\n          {/* Header */}\n          <div className=\"flex items-center gap-3 mb-6\">\n            <div className=\"p-2 bg-white/20 backdrop-blur-sm rounded-xl\">\n              <Lightbulb className=\"w-10 h-10 text-white\" />\n            </div>\n            <div>\n              <h1 className=\"text-3xl font-bold text-white\">My {period === 'daily' ? 'Daily' : 'Weekly'} Reflection</h1>\n              <p className=\"text-white/90 text-sm font-medium\">{date}</p>\n            </div>\n          </div>\n\n          {/* What Went Well */}\n          <div className=\"bg-white/25 backdrop-blur-md rounded-xl p-4 mb-4 border border-white/20\">\n            <div className=\"flex items-center gap-2 mb-2\">\n              <div className=\"w-8 h-8 bg-green-400 rounded-full flex items-center justify-center shadow-lg\">\n                <Check className=\"w-4 h-4 text-green-900\" />\n              </div>\n              <h3 className=\"font-bold text-white\">What Went Well</h3>\n            </div>\n            <p className=\"text-sm leading-relaxed text-white/95\">\n              {wentWell.length > 150 ? wentWell.substring(0, 150) + '...' : wentWell}\n            </p>\n          </div>\n\n          {/* Could Improve */}\n          <div className=\"bg-white/25 backdrop-blur-md rounded-xl p-4 mb-4 border border-white/20\">\n            <div className=\"flex items-center gap-2 mb-2\">\n              <div className=\"w-8 h-8 bg-yellow-400 rounded-full flex items-center justify-center shadow-lg\">\n                <TrendingUp className=\"w-4 h-4 text-yellow-900\" />\n              </div>\n              <h3 className=\"font-bold text-white\">Room for Growth</h3>\n            </div>\n            <p className=\"text-sm leading-relaxed text-white/95\">\n              {couldImprove.length > 150 ? couldImprove.substring(0, 150) + '...' : couldImprove}\n            </p>\n          </div>\n\n          {/* Positivity Score */}\n          <div className=\"bg-white/25 backdrop-blur-md rounded-xl p-4 mb-6 border border-white/20\">\n            <div className=\"flex items-center justify-between mb-2\">\n              <span className=\"font-semibold text-white\">Positivity Score</span>\n              <span className=\"text-2xl font-bold text-white\">{sentimentScore}%</span>\n            </div>\n            <div className=\"w-full h-3 bg-white/40 rounded-full overflow-hidden shadow-inner\">\n              <div \n                className=\"h-full bg-gradient-to-r from-green-400 to-emerald-400 shadow-lg\"\n                style={{ width: `${sentimentScore}%` }}\n              />\n            </div>\n          </div>\n\n          {/* Footer */}\n          <div className=\"border-t border-white/30 pt-4 text-center\">\n            <p className=\"text-lg font-bold text-white mb-1\">AI-Powered Nutrition Insights</p>\n            <p className=\"text-white/90 text-sm font-medium\">PlateMate - Your Personal Nutrition Coach</p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n);\n\nInsightShareCard.displayName = 'InsightShareCard';\n","size_bytes":3831},"client/src/components/challenge-share-card.tsx":{"content":"import { forwardRef } from \"react\";\nimport { Trophy, Star, Flame } from \"lucide-react\";\n\ninterface ChallengeShareCardProps {\n  points: number;\n  streak: number;\n  completedChallenges: number;\n}\n\nexport const ChallengeShareCard = forwardRef<HTMLDivElement, ChallengeShareCardProps>(\n  ({ points, streak, completedChallenges }, ref) => {\n    return (\n      <div\n        ref={ref}\n        className=\"bg-gradient-to-br from-purple-600 to-pink-600 p-8 rounded-2xl w-[600px] text-white\"\n        style={{ fontFamily: 'system-ui, -apple-system, sans-serif' }}\n      >\n        {/* Header */}\n        <div className=\"flex items-center gap-3 mb-6\">\n          <Trophy className=\"w-12 h-12\" />\n          <div>\n            <h1 className=\"text-3xl font-bold\">My PlateMate Journey</h1>\n            <p className=\"text-purple-100 text-sm\">Nutrition Tracking Achievements</p>\n          </div>\n        </div>\n\n        {/* Stats Grid */}\n        <div className=\"grid grid-cols-3 gap-4 mb-6\">\n          {/* Total Points */}\n          <div className=\"bg-white/20 backdrop-blur-sm rounded-xl p-4 text-center\">\n            <div className=\"w-12 h-12 bg-yellow-400 rounded-full flex items-center justify-center mx-auto mb-2\">\n              <Star className=\"w-6 h-6 text-yellow-900\" />\n            </div>\n            <div className=\"text-3xl font-bold mb-1\">{points}</div>\n            <div className=\"text-sm text-purple-100\">Points Earned</div>\n          </div>\n\n          {/* Current Streak */}\n          <div className=\"bg-white/20 backdrop-blur-sm rounded-xl p-4 text-center\">\n            <div className=\"w-12 h-12 bg-orange-400 rounded-full flex items-center justify-center mx-auto mb-2\">\n              <Flame className=\"w-6 h-6 text-orange-900\" />\n            </div>\n            <div className=\"text-3xl font-bold mb-1\">{streak}</div>\n            <div className=\"text-sm text-purple-100\">Day Streak</div>\n          </div>\n\n          {/* Completed Challenges */}\n          <div className=\"bg-white/20 backdrop-blur-sm rounded-xl p-4 text-center\">\n            <div className=\"w-12 h-12 bg-green-400 rounded-full flex items-center justify-center mx-auto mb-2\">\n              <Trophy className=\"w-6 h-6 text-green-900\" />\n            </div>\n            <div className=\"text-3xl font-bold mb-1\">{completedChallenges}</div>\n            <div className=\"text-sm text-purple-100\">Completed</div>\n          </div>\n        </div>\n\n        {/* Footer */}\n        <div className=\"border-t border-white/30 pt-4 text-center\">\n          <p className=\"text-lg font-semibold mb-1\">Track Your Nutrition Journey</p>\n          <p className=\"text-purple-100 text-sm\">Join me on PlateMate - AI-Powered Food Tracking</p>\n        </div>\n      </div>\n    );\n  }\n);\n\nChallengeShareCard.displayName = 'ChallengeShareCard';\n","size_bytes":2773},"client/src/lib/share-image-generator.ts":{"content":"import domtoimage from 'dom-to-image-more';\n\nexport interface ShareImageOptions {\n  element: HTMLElement;\n  filename?: string;\n  backgroundColor?: string;\n}\n\n/**\n * Generate a shareable image from a DOM element using dom-to-image-more\n * \n * Note: Ensure all images in the element have crossOrigin=\"anonymous\" to avoid CORS issues.\n * Avoid capturing iframes or videos as they may cause the generation to fail.\n */\nexport async function generateShareImage(options: ShareImageOptions): Promise<Blob> {\n  const { element, backgroundColor = 'transparent' } = options;\n\n  // Generate blob directly for better Safari compatibility\n  const blob = await domtoimage.toBlob(element, {\n    bgcolor: backgroundColor,\n    quality: 1.0,\n    style: {\n      transform: 'scale(1)',\n      transformOrigin: 'top left'\n    }\n  });\n\n  return blob;\n}\n\n/**\n * Share image using Web Share API or download as fallback\n */\nexport async function shareImage(\n  blob: Blob, \n  title: string, \n  text?: string,\n  textFallback?: string,\n  filename: string = 'platemate-share.png'\n): Promise<boolean> {\n  const file = new File([blob], filename, { type: 'image/png' });\n  \n  // Try Web Share API first (works on mobile)\n  if (navigator.share) {\n    // Check if sharing files is supported\n    const canShareFiles = navigator.canShare ? navigator.canShare({ files: [file] }) : false;\n    \n    // Only try to share if files are supported\n    if (canShareFiles) {\n      try {\n        await navigator.share({\n          title,\n          text,\n          files: [file],\n        });\n        return true;\n      } catch (error: any) {\n        // User cancelled or share failed\n        if (error.name === 'AbortError') {\n          // User explicitly cancelled\n          return false;\n        }\n        // Fall through to text fallback if available\n        if (textFallback && navigator.share) {\n          try {\n            await navigator.share({\n              title,\n              text: textFallback,\n            });\n            return true;\n          } catch (textError: any) {\n            if (textError.name === 'AbortError') {\n              return false;\n            }\n          }\n        }\n      }\n    } else {\n      // Try text-only share if files aren't supported\n      if (textFallback && navigator.share) {\n        try {\n          await navigator.share({\n            title,\n            text: textFallback,\n          });\n          return true;\n        } catch (textError: any) {\n          if (textError.name === 'AbortError') {\n            return false;\n          }\n        }\n      }\n    }\n  }\n\n  // Fallback: Download the image\n  const url = URL.createObjectURL(blob);\n  const link = document.createElement('a');\n  link.href = url;\n  link.download = filename;\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n  URL.revokeObjectURL(url);\n  \n  // Return false to indicate we downloaded instead of shared\n  return false;\n}\n\n/**\n * Generate and share an achievement card with text fallback\n */\nexport async function generateAndShareCard(\n  element: HTMLElement,\n  title: string,\n  description?: string,\n  textFallback?: string,\n  filename?: string\n): Promise<boolean> {\n  try {\n    const blob = await generateShareImage({ element });\n    return await shareImage(blob, title, description, textFallback, filename);\n  } catch (error) {\n    console.error('Error generating share image:', error);\n    \n    // If image generation fails and we have a text fallback, try that\n    if (textFallback && navigator.share) {\n      try {\n        await navigator.share({\n          title,\n          text: textFallback,\n        });\n        return true;\n      } catch (shareError: any) {\n        if (shareError.name === 'AbortError') {\n          return false;\n        }\n      }\n    }\n    \n    throw error;\n  }\n}\n","size_bytes":3791},"client/src/dom-to-image-more.d.ts":{"content":"declare module 'dom-to-image-more' {\n  import domToImage = require('dom-to-image');\n  export = domToImage;\n}\n","size_bytes":109},"client/src/pages/MenuAnalysisPage.tsx":{"content":"import { useState, useEffect, useRef } from \"react\";\nimport { Link, useLocation } from \"wouter\";\nimport { ArrowLeft, Loader2, PlusCircle, Flame, Activity, FileText, Camera, X } from \"lucide-react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { motion } from \"framer-motion\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { soundService } from \"@/lib/sound-service\";\nimport { buildApiUrl } from \"@/lib/api-config\";\n\ninterface MenuRecommendation {\n  name: string;\n  description: string;\n  calories: number;\n  protein: number;\n  carbs: number;\n  fat: number;\n  matchScore: number;\n  matchReason: string;\n}\n\ninterface MenuPhoto {\n  id: string;\n  file: File;\n  preview: string;\n}\n\nexport function MenuAnalysisPage() {\n  const [location] = useLocation();\n  const { toast } = useToast();\n  const [menuUrl, setMenuUrl] = useState<string>(\"\");\n  const [manualMenuText, setManualMenuText] = useState<string>(\"\");\n  const [useManualInput, setUseManualInput] = useState(false);\n  const [selectedMealType, setSelectedMealType] = useState<'breakfast' | 'lunch' | 'dinner' | 'snack'>('lunch');\n  const [menuPhotos, setMenuPhotos] = useState<MenuPhoto[]>([]);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  \n  // Extract URL from query parameters\n  useEffect(() => {\n    const params = new URLSearchParams(location.split('?')[1]);\n    const url = params.get('url');\n    if (url) {\n      setMenuUrl(decodeURIComponent(url));\n    } else {\n      // No URL provided, go straight to manual input mode\n      setUseManualInput(true);\n    }\n  }, [location]);\n\n  // Fetch webpage content\n  const { data: webpageData, isLoading: isFetchingPage, error: fetchError } = useQuery({\n    queryKey: ['/api/fetch-webpage', menuUrl],\n    enabled: !!menuUrl && !useManualInput,\n    queryFn: async () => {\n      const response = await apiRequest('POST', '/api/fetch-webpage', { url: menuUrl });\n      \n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({ error: 'Failed to fetch webpage' }));\n        \n        // If fetching fails, switch to manual input mode\n        setUseManualInput(true);\n        toast({\n          title: \"Couldn't fetch menu automatically\",\n          description: errorData.suggestion || \"Please paste the menu text manually\",\n          variant: \"default\"\n        });\n        \n        throw new Error(errorData.error || `HTTP ${response.status}: Failed to fetch webpage`);\n      }\n      \n      const data = await response.json();\n      return data;\n    }\n  });\n\n  // Auto-analyze when webpage data is fetched from allowlisted domains\n  useEffect(() => {\n    if (webpageData?.content && !analyzeMenuMutation.data && !analyzeMenuMutation.isPending) {\n      console.log('ðŸ“„ Auto-analyzing fetched menu content');\n      analyzeMenuMutation.mutate(webpageData.content);\n    }\n  }, [webpageData]);\n\n  // Analyze menu mutation (triggered by button click, not automatic)\n  const analyzeMenuMutation = useMutation({\n    mutationFn: async (menuText: string) => {\n      const response = await apiRequest('POST', '/api/analyze-menu', {\n        menuText,\n        url: menuUrl || 'manual-input'\n      });\n      \n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({ error: 'Failed to analyze menu' }));\n        throw new Error(errorData.error || `HTTP ${response.status}: Failed to analyze menu`);\n      }\n      \n      const data = await response.json();\n      return data;\n    },\n    onSuccess: () => {\n      soundService.playSuccess();\n    },\n    onError: (error: Error) => {\n      soundService.playError();\n      toast({\n        title: \"Analysis Failed\",\n        description: error.message || \"Failed to analyze menu\",\n        variant: \"destructive\",\n      });\n    }\n  });\n\n  const menuAnalysis = analyzeMenuMutation.data;\n  const isAnalyzing = analyzeMenuMutation.isPending;\n  const analysisError = analyzeMenuMutation.error;\n\n  // Add meal to diary mutation\n  const addToDiaryMutation = useMutation({\n    mutationFn: async (meal: MenuRecommendation) => {\n      // Create a food analysis entry for this meal\n      const analysisResponse = await apiRequest('POST', '/api/analyze-text', {\n        foodDescription: `${meal.name}: ${meal.description}`\n      });\n      \n      if (!analysisResponse.ok) {\n        const errorData = await analysisResponse.json().catch(() => ({ error: 'Failed to analyze meal' }));\n        throw new Error(errorData.error || 'Failed to analyze meal');\n      }\n      \n      const analysis = await analysisResponse.json();\n      \n      if (!analysis?.id) {\n        throw new Error('Analysis failed: No ID returned');\n      }\n\n      // Add to diary\n      const now = new Date();\n      const diaryResponse = await apiRequest('POST', '/api/diary', {\n        analysisId: analysis.id,\n        mealType: selectedMealType,\n        mealDate: now.toISOString(),\n        notes: `From menu: ${menuUrl}`\n      });\n      \n      if (!diaryResponse.ok) {\n        const errorData = await diaryResponse.json().catch(() => ({ error: 'Failed to add to diary' }));\n        throw new Error(errorData.error || 'Failed to add to diary');\n      }\n      \n      return await diaryResponse.json();\n    },\n    onSuccess: () => {\n      soundService.playSuccess();\n      toast({\n        title: \"Added to Diary!\",\n        description: \"Your meal has been saved to your food diary.\",\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/diary'] });\n    },\n    onError: (error: Error) => {\n      soundService.playError();\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to add meal to diary\",\n        variant: \"destructive\",\n      });\n    }\n  });\n\n  // Extract text from menu photos mutation\n  const extractTextMutation = useMutation({\n    mutationFn: async (photos: MenuPhoto[]) => {\n      console.log(`ðŸ“¸ Extracting text from ${photos.length} photos`);\n      const formData = new FormData();\n      photos.forEach((photo, index) => {\n        console.log(`ðŸ“¸ Adding photo ${index + 1}:`, photo.file.name, photo.file.type, photo.file.size);\n        formData.append('images', photo.file);\n      });\n      \n      console.log('ðŸ“¸ Sending request to /api/extract-menu-text');\n      const response = await fetch(buildApiUrl('/api/extract-menu-text'), {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${localStorage.getItem('token')}`,\n        },\n        body: formData\n      });\n      \n      console.log('ðŸ“¸ Response status:', response.status);\n      \n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({ error: 'Failed to extract text' }));\n        console.error('ðŸ“¸ Extraction failed:', errorData);\n        throw new Error(errorData.error || 'Failed to extract menu text from photos');\n      }\n      \n      const result = await response.json();\n      console.log('ðŸ“¸ Extraction successful:', result);\n      return result;\n    },\n    onSuccess: (data) => {\n      soundService.playSuccess();\n      setManualMenuText(data.combinedText || '');\n      toast({\n        title: \"Text Extracted!\",\n        description: `Successfully extracted text from ${menuPhotos.length} photo(s)`,\n      });\n    },\n    onError: (error: Error) => {\n      soundService.playError();\n      toast({\n        title: \"Extraction Failed\",\n        description: error.message || \"Failed to extract text from photos\",\n        variant: \"destructive\",\n      });\n    }\n  });\n\n  // Handle photo capture\n  const handlePhotoCapture = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const files = event.target.files;\n    if (!files || files.length === 0) return;\n    \n    const newPhotos: MenuPhoto[] = Array.from(files).map(file => ({\n      id: Math.random().toString(36).substr(2, 9),\n      file,\n      preview: URL.createObjectURL(file)\n    }));\n    \n    setMenuPhotos(prev => [...prev, ...newPhotos]);\n    \n    toast({\n      title: \"Photo Added\",\n      description: `Added ${newPhotos.length} photo(s). Total: ${menuPhotos.length + newPhotos.length}`,\n    });\n    \n    // Reset input\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n\n  // Delete a photo\n  const handleDeletePhoto = (photoId: string) => {\n    setMenuPhotos(prev => {\n      const photo = prev.find(p => p.id === photoId);\n      if (photo) {\n        URL.revokeObjectURL(photo.preview);\n      }\n      return prev.filter(p => p.id !== photoId);\n    });\n  };\n\n  // Cleanup photo previews on unmount\n  useEffect(() => {\n    return () => {\n      menuPhotos.forEach(photo => URL.revokeObjectURL(photo.preview));\n    };\n  }, [menuPhotos]);\n\n  const isLoading = isFetchingPage || isAnalyzing;\n  // Only show fetch error if we're not in manual input mode\n  const error = useManualInput ? analysisError : (fetchError || analysisError);\n  const recommendations = menuAnalysis?.recommendations || [];\n\n  return (\n    <div className=\"min-h-screen bg-purple-500 dark:bg-gray-900\">\n      {/* Header */}\n      <div className=\"bg-gradient-to-r from-purple-600 to-violet-600 text-white p-6 shadow-lg\">\n        <div className=\"flex items-center space-x-4 mb-2\">\n          <Link to=\"/\" data-testid=\"button-back\">\n            <button className=\"p-2 hover:bg-white/20 rounded-full transition-colors\">\n              <ArrowLeft className=\"h-6 w-6\" />\n            </button>\n          </Link>\n          <h1 className=\"text-2xl font-bold\">ðŸ“¸ Menu Scanner</h1>\n        </div>\n        <p className=\"text-purple-100 text-sm ml-14\">\n          Photograph menus for AI-powered meal recommendations\n        </p>\n      </div>\n\n      <div className=\"p-4 max-w-4xl mx-auto\">\n        {/* Camera and Manual Input - Always visible for photo scanning and manual text entry */}\n        {!isAnalyzing && (\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            className=\"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 mb-6\"\n          >\n            <div className=\"flex items-center space-x-3 mb-4\">\n              <Camera className=\"h-6 w-6 text-purple-600\" />\n              <h2 className=\"text-xl font-bold text-gray-800 dark:text-white\">\n                ðŸ“¸ Scan Menu with Camera\n              </h2>\n            </div>\n            <p className=\"text-gray-600 dark:text-gray-300 text-sm mb-4\">\n              Take photos of restaurant menus and we'll use AI to extract the text and recommend meals that match your nutrition goals.\n            </p>\n            \n            {/* Photo Scanner Section - TEMPORARILY DISABLED */}\n            <div className=\"mb-4 p-4 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-900/20 dark:to-gray-800/20 rounded-lg border-2 border-gray-300 dark:border-gray-700 opacity-60\">\n              <div className=\"flex items-center justify-between mb-3\">\n                <div className=\"flex items-center gap-2\">\n                  <Camera className=\"h-5 w-5 text-gray-500 dark:text-gray-400\" />\n                  <h3 className=\"font-semibold text-gray-700 dark:text-gray-300\">\n                    Photo Scanner (Coming Soon)\n                  </h3>\n                </div>\n              </div>\n              <p className=\"text-gray-600 dark:text-gray-400 text-xs mb-3\">\n                AI photo text extraction is being optimized. For now, please use the manual text paste option below.\n              </p>\n              \n              {/* Disabled - buttons hidden for now */}\n            </div>\n            \n            {/* Manual Text Input Section */}\n            <div className=\"mt-6\">\n              <div className=\"flex items-center gap-2 mb-3\">\n                <FileText className=\"h-5 w-5 text-gray-600 dark:text-gray-400\" />\n                <h3 className=\"font-semibold text-gray-700 dark:text-gray-300\">\n                  Or Paste Menu Text Manually\n                </h3>\n              </div>\n              \n              {menuUrl && (\n                <div className=\"mb-4 space-y-3\">\n                  <div className=\"p-4 bg-gradient-to-r from-purple-50 to-blue-50 dark:from-purple-900/20 dark:to-blue-900/20 rounded-lg border-2 border-purple-200 dark:border-purple-800\">\n                    <p className=\"text-purple-900 dark:text-purple-100 text-sm font-semibold mb-2\">\n                      ðŸ“± QR Code Detected\n                    </p>\n                    <p className=\"text-purple-700 dark:text-purple-300 text-xs break-all\">\n                      {menuUrl}\n                    </p>\n                  </div>\n                  <a \n                    href={menuUrl} \n                    target=\"_blank\" \n                    rel=\"noopener noreferrer\"\n                    className=\"block w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white py-3 px-4 rounded-xl font-medium transition-all duration-200 text-center\"\n                    data-testid=\"link-open-menu-url\"\n                  >\n                    ðŸ“„ Open Menu in New Tab\n                  </a>\n                  <p className=\"text-gray-500 dark:text-gray-400 text-xs text-center\">\n                    After opening, copy the menu text and paste it below\n                  </p>\n                </div>\n              )}\n              \n              <textarea\n                value={manualMenuText}\n                onChange={(e) => setManualMenuText(e.target.value)}\n                placeholder=\"Paste the restaurant menu here...\"\n                className=\"w-full h-48 p-4 border-2 border-gray-200 dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-white focus:border-purple-500 focus:outline-none resize-none\"\n                data-testid=\"input-manual-menu\"\n              />\n              <button\n                onClick={() => {\n                  if (manualMenuText.trim().length > 10) {\n                    analyzeMenuMutation.mutate(manualMenuText.trim());\n                  } else {\n                    toast({\n                      title: \"Menu text too short\",\n                      description: \"Please paste more menu content to analyze\",\n                      variant: \"destructive\"\n                    });\n                  }\n                }}\n                disabled={manualMenuText.trim().length < 10 || analyzeMenuMutation.isPending}\n                className=\"mt-4 w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 disabled:from-gray-400 disabled:to-gray-500 text-white py-3 px-4 rounded-xl font-bold transition-all duration-200 disabled:cursor-not-allowed flex items-center justify-center space-x-2\"\n                data-testid=\"button-analyze-menu\"\n              >\n                {analyzeMenuMutation.isPending ? (\n                  <>\n                    <Loader2 className=\"h-5 w-5 animate-spin\" />\n                    <span>Analyzing...</span>\n                  </>\n                ) : (\n                  <span>Analyze Menu</span>\n                )}\n              </button>\n            </div>\n          </motion.div>\n        )}\n\n        {/* Loading State */}\n        {isLoading && (\n          <motion.div\n            initial={{ opacity: 0, scale: 0.9 }}\n            animate={{ opacity: 1, scale: 1 }}\n            className=\"flex flex-col items-center justify-center py-20\"\n          >\n            <Loader2 className=\"h-16 w-16 text-purple-600 animate-spin mb-4\" />\n            <p className=\"text-gray-600 dark:text-gray-300 text-lg\">\n              {isFetchingPage ? \"Fetching menu...\" : \"Analyzing menu with AI...\"}\n            </p>\n            <p className=\"text-gray-400 text-sm mt-2\">\n              This may take a few moments\n            </p>\n          </motion.div>\n        )}\n\n        {/* Error State */}\n        {error && !isLoading && (\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-6 text-center\"\n          >\n            <p className=\"text-red-600 dark:text-red-400 font-semibold mb-2\">\n              Unable to Analyze Menu\n            </p>\n            <p className=\"text-red-500 dark:text-red-300 text-sm\">\n              {error instanceof Error ? error.message : \"An error occurred\"}\n            </p>\n            <Link to=\"/\">\n              <button\n                className=\"mt-4 px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors\"\n                data-testid=\"button-back-home\"\n              >\n                Back to Home\n              </button>\n            </Link>\n          </motion.div>\n        )}\n\n        {/* Meal Type Selector */}\n        {!isLoading && !error && recommendations.length > 0 && (\n          <div className=\"mb-6\">\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n              Meal Type\n            </label>\n            <div className=\"grid grid-cols-4 gap-2\">\n              {(['breakfast', 'lunch', 'dinner', 'snack'] as const).map((type) => (\n                <button\n                  key={type}\n                  onClick={() => setSelectedMealType(type)}\n                  className={`py-2 px-4 rounded-lg font-medium capitalize transition-all ${\n                    selectedMealType === type\n                      ? 'bg-gradient-to-r from-purple-600 to-blue-600 text-white shadow-lg'\n                      : 'bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600'\n                  }`}\n                  data-testid={`button-meal-type-${type}`}\n                >\n                  {type}\n                </button>\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* Recommendations List */}\n        {!isLoading && !error && recommendations.length > 0 && (\n          <div className=\"space-y-4\">\n            <h2 className=\"text-xl font-bold text-gray-800 dark:text-white mb-4\">\n              Recommended for You\n            </h2>\n            {recommendations.map((meal: MenuRecommendation, index: number) => (\n              <motion.div\n                key={index}\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: index * 0.1 }}\n                className=\"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-5 border-2 border-gray-100 dark:border-gray-700\"\n              >\n                {/* Match Score Badge */}\n                <div className=\"flex items-center justify-between mb-3\">\n                  <h3 className=\"text-lg font-bold text-gray-800 dark:text-white\">\n                    {meal.name}\n                  </h3>\n                  <div className=\"flex items-center space-x-2\">\n                    <div className={`px-3 py-1 rounded-full text-xs font-bold ${\n                      meal.matchScore >= 80\n                        ? 'bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400'\n                        : meal.matchScore >= 60\n                        ? 'bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400'\n                        : 'bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-400'\n                    }`}>\n                      {meal.matchScore}% Match\n                    </div>\n                  </div>\n                </div>\n\n                <p className=\"text-gray-600 dark:text-gray-300 text-sm mb-4\">\n                  {meal.description}\n                </p>\n\n                {/* Match Reason */}\n                <div className=\"mb-4 p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-200 dark:border-purple-800\">\n                  <p className=\"text-purple-700 dark:text-purple-300 text-sm\">\n                    <strong>Why this matches:</strong> {meal.matchReason}\n                  </p>\n                </div>\n\n                {/* Nutrition Info */}\n                <div className=\"grid grid-cols-4 gap-3 mb-4\">\n                  <div className=\"text-center p-2 bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-900/20 dark:to-orange-800/20 rounded-lg\">\n                    <Flame className=\"h-4 w-4 mx-auto mb-1 text-orange-600 dark:text-orange-400\" />\n                    <p className=\"text-xs text-gray-600 dark:text-gray-400\">Calories</p>\n                    <p className=\"font-bold text-gray-800 dark:text-white\">{meal.calories}</p>\n                  </div>\n                  <div className=\"text-center p-2 bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 rounded-lg\">\n                    <Activity className=\"h-4 w-4 mx-auto mb-1 text-blue-600 dark:text-blue-400\" />\n                    <p className=\"text-xs text-gray-600 dark:text-gray-400\">Protein</p>\n                    <p className=\"font-bold text-gray-800 dark:text-white\">{meal.protein}g</p>\n                  </div>\n                  <div className=\"text-center p-2 bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 rounded-lg\">\n                    <p className=\"text-xs text-gray-600 dark:text-gray-400\">Carbs</p>\n                    <p className=\"font-bold text-gray-800 dark:text-white\">{meal.carbs}g</p>\n                  </div>\n                  <div className=\"text-center p-2 bg-gradient-to-br from-yellow-50 to-yellow-100 dark:from-yellow-900/20 dark:to-yellow-800/20 rounded-lg\">\n                    <p className=\"text-xs text-gray-600 dark:text-gray-400\">Fat</p>\n                    <p className=\"font-bold text-gray-800 dark:text-white\">{meal.fat}g</p>\n                  </div>\n                </div>\n\n                {/* Add to Diary Button */}\n                <button\n                  onClick={() => addToDiaryMutation.mutate(meal)}\n                  disabled={addToDiaryMutation.isPending}\n                  className=\"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 disabled:from-gray-400 disabled:to-gray-500 text-white py-3 px-4 rounded-xl font-bold transition-all duration-200 transform hover:scale-105 disabled:transform-none shadow-lg hover:shadow-xl disabled:shadow-none flex items-center justify-center space-x-2\"\n                  data-testid={`button-add-meal-${index}`}\n                >\n                  {addToDiaryMutation.isPending ? (\n                    <>\n                      <Loader2 className=\"h-5 w-5 animate-spin\" />\n                      <span>Adding...</span>\n                    </>\n                  ) : (\n                    <>\n                      <PlusCircle className=\"h-5 w-5\" />\n                      <span>Add to Diary</span>\n                    </>\n                  )}\n                </button>\n              </motion.div>\n            ))}\n          </div>\n        )}\n\n        {/* No Recommendations - only show after an analysis has been attempted */}\n        {!isLoading && !error && recommendations.length === 0 && menuAnalysis && (\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            className=\"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-xl p-6 text-center\"\n          >\n            <p className=\"text-yellow-700 dark:text-yellow-400 font-semibold mb-2\">\n              No Recommendations Available\n            </p>\n            <p className=\"text-yellow-600 dark:text-yellow-300 text-sm\">\n              We couldn't find any menu items to recommend. Please try pasting different menu content.\n            </p>\n          </motion.div>\n        )}\n      </div>\n    </div>\n  );\n}\n","size_bytes":23590},"client/src/components/shopping-list-dialog.tsx":{"content":"import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { useState, useEffect, useMemo } from \"react\";\nimport { Plus, X, ShoppingBasket, Star, Trash2 } from \"lucide-react\";\nimport { nanoid } from \"nanoid\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\n\ninterface Recipe {\n  id: string;\n  name: string;\n  ingredients: string[];\n}\n\ninterface ShoppingListDialogProps {\n  isOpen: boolean;\n  onClose: () => void;\n  recipes: Recipe[];\n}\n\ninterface ParsedIngredient {\n  original: string;\n  quantity: number;\n  unit: string;\n  ingredient: string;\n}\n\ninterface CustomItem {\n  id: string;\n  label: string;\n}\n\nfunction parseIngredient(ingredientStr: string): ParsedIngredient {\n  // Try to parse quantity, unit, and ingredient name\n  // Examples: \"2 cups flour\", \"1/2 cup milk\", \"1 1/2 cups flour\", \"3 large eggs\", \"salt to taste\", \"Â½ cup sugar\"\n  \n  // Convert Unicode fractions to regular fractions\n  const unicodeFractionMap: Record<string, string> = {\n    'Â½': '1/2',\n    'â…“': '1/3',\n    'â…”': '2/3',\n    'Â¼': '1/4',\n    'Â¾': '3/4',\n    'â…•': '1/5',\n    'â…–': '2/5',\n    'â…—': '3/5',\n    'â…˜': '4/5',\n    'â…™': '1/6',\n    'â…š': '5/6',\n    'â…›': '1/8',\n    'â…œ': '3/8',\n    'â…': '5/8',\n    'â…ž': '7/8'\n  };\n  \n  let normalized = ingredientStr;\n  Object.keys(unicodeFractionMap).forEach(unicode => {\n    // Handle attached fractions like \"1Â½\" by adding a space before replacement\n    const pattern = new RegExp(`(\\\\d)${unicode}`, 'g');\n    normalized = normalized.replace(pattern, `$1 ${unicodeFractionMap[unicode]}`);\n    // Handle standalone fractions like \"Â½ cup\"\n    normalized = normalized.replace(unicode, unicodeFractionMap[unicode]);\n  });\n  \n  // Handle mixed numbers (e.g., \"1 1/2 cups\") and standalone fractions/decimals\n  const mixedNumberMatch = normalized.match(/^(\\d+)\\s+(\\d+\\/\\d+|\\d+\\.\\d+)\\s+(.*)$/);\n  const fractionMatch = normalized.match(/^(\\d+\\/\\d+|\\d+\\.\\d+|\\d+)\\s+(.*)$/);\n\n  \n  if (mixedNumberMatch) {\n    // Mixed number like \"1 1/2\"\n    const wholeNumber = parseInt(mixedNumberMatch[1]);\n    const fraction = eval(mixedNumberMatch[2]); // Convert \"1/2\" to 0.5\n    const quantity = wholeNumber + fraction;\n    const rest = mixedNumberMatch[3].trim();\n    \n    // Try to extract unit\n    const unitMatch = rest.match(/^(cup|cups|tbsp|tsp|oz|lb|g|kg|ml|l|tablespoon|tablespoons|teaspoon|teaspoons|pound|pounds|ounce|ounces|gram|grams|kilogram|kilograms|liter|liters|milliliter|milliliters)\\s+(.+)$/i);\n    if (unitMatch) {\n      return {\n        original: ingredientStr,\n        quantity,\n        unit: unitMatch[1].toLowerCase(),\n        ingredient: unitMatch[2].trim()\n      };\n    }\n    \n    // No unit, just quantity and ingredient\n    return {\n      original: ingredientStr,\n      quantity,\n      unit: '',\n      ingredient: rest\n    };\n  } else if (fractionMatch) {\n    const quantity = eval(fractionMatch[1]); // Convert fractions like \"1/2\" to 0.5\n    const rest = fractionMatch[2].trim();\n    \n    // Try to extract unit\n    const unitMatch = rest.match(/^(cup|cups|tbsp|tsp|oz|lb|g|kg|ml|l|tablespoon|tablespoons|teaspoon|teaspoons|pound|pounds|ounce|ounces|gram|grams|kilogram|kilograms|liter|liters|milliliter|milliliters)\\s+(.+)$/i);\n    if (unitMatch) {\n      return {\n        original: ingredientStr,\n        quantity,\n        unit: unitMatch[1].toLowerCase(),\n        ingredient: unitMatch[2].trim()\n      };\n    }\n    \n    // No unit, just quantity and ingredient\n    return {\n      original: ingredientStr,\n      quantity,\n      unit: '',\n      ingredient: rest\n    };\n  }\n  \n  // No quantity found - return original text without forcing quantity\n  return {\n    original: ingredientStr,\n    quantity: 0,\n    unit: '',\n    ingredient: ingredientStr\n  };\n}\n\nfunction normalizeUnit(unit: string): string {\n  const unitMap: Record<string, string> = {\n    'cup': 'cup',\n    'cups': 'cup',\n    'tbsp': 'tbsp',\n    'tablespoon': 'tbsp',\n    'tablespoons': 'tbsp',\n    'tsp': 'tsp',\n    'teaspoon': 'tsp',\n    'teaspoons': 'tsp',\n    'oz': 'oz',\n    'ounce': 'oz',\n    'ounces': 'oz',\n    'lb': 'lb',\n    'pound': 'lb',\n    'pounds': 'lb',\n    'g': 'g',\n    'gram': 'g',\n    'grams': 'g',\n    'kg': 'kg',\n    'kilogram': 'kg',\n    'kilograms': 'kg',\n    'ml': 'ml',\n    'milliliter': 'ml',\n    'milliliters': 'ml',\n    'l': 'l',\n    'liter': 'l',\n    'liters': 'l'\n  };\n  return unitMap[unit.toLowerCase()] || unit.toLowerCase();\n}\n\nfunction aggregateIngredients(recipes: Recipe[]): Map<string, ParsedIngredient[]> {\n  const ingredientMap = new Map<string, ParsedIngredient[]>();\n  \n  recipes.forEach(recipe => {\n    recipe.ingredients.forEach(ing => {\n      const parsed = parseIngredient(ing);\n      const key = parsed.ingredient.toLowerCase();\n      \n      if (!ingredientMap.has(key)) {\n        ingredientMap.set(key, []);\n      }\n      ingredientMap.get(key)!.push(parsed);\n    });\n  });\n  \n  return ingredientMap;\n}\n\nfunction convertToShoppingQuantity(quantity: number, unit: string, ingredient: string): string {\n  // Convert recipe measurements to realistic shopping amounts\n  const normalizedUnit = normalizeUnit(unit);\n  \n  // Produce items - always use containers/bunches\n  if (ingredient.includes('berries') || ingredient.includes('strawberries') || ingredient.includes('blueberries') || ingredient.includes('raspberries')) {\n    return '1 container mixed berries';\n  }\n  if (ingredient.includes('lettuce') || ingredient.includes('spinach') || ingredient.includes('kale') || ingredient.includes('arugula')) {\n    return '1 bag/bunch ' + ingredient;\n  }\n  if (ingredient.includes('onion') || ingredient.includes('garlic') || ingredient.includes('tomato')) {\n    const roundedQty = Math.ceil(quantity);\n    return `${roundedQty} ${ingredient}`;\n  }\n  \n  // Liquid items - convert to common purchase sizes\n  if (normalizedUnit === 'cup' || normalizedUnit === 'ml') {\n    if (ingredient.includes('milk') || ingredient.includes('cream') || ingredient.includes('yogurt')) {\n      if (quantity <= 1) return '1 small carton ' + ingredient;\n      if (quantity <= 4) return '1 quart ' + ingredient;\n      return '1 half gallon ' + ingredient;\n    }\n  }\n  \n  // Dry goods - use packages\n  if (ingredient.includes('oats') || ingredient.includes('flour') || ingredient.includes('sugar') || ingredient.includes('rice')) {\n    return '1 package ' + ingredient;\n  }\n  \n  // Nuts and seeds - use bags\n  if (ingredient.includes('almond') || ingredient.includes('nut') || ingredient.includes('seed')) {\n    return '1 bag/container ' + ingredient;\n  }\n  \n  // Eggs - round up\n  if (ingredient.includes('egg')) {\n    const eggCount = Math.ceil(quantity);\n    if (eggCount <= 6) return '1 half dozen eggs';\n    return '1 dozen eggs';\n  }\n  \n  // Spices and seasonings - use original or \"to taste\"\n  if (ingredient.includes('salt') || ingredient.includes('pepper') || ingredient.includes('spice') || \n      ingredient.includes('cinnamon') || ingredient.includes('vanilla')) {\n    return ingredient + ' (to taste)';\n  }\n  \n  // Default: round up small quantities and use package/container\n  if (quantity > 0) {\n    const roundedQty = Math.ceil(quantity);\n    if (unit) {\n      return `${roundedQty} ${normalizedUnit} ${ingredient} (or 1 package)`;\n    } else {\n      return `${roundedQty} ${ingredient}`;\n    }\n  }\n  \n  return ingredient;\n}\n\nfunction formatShoppingList(aggregated: Map<string, ParsedIngredient[]>): string[] {\n  const items: string[] = [];\n  \n  aggregated.forEach((ingredients, key) => {\n    // For shopping, we want to convert to realistic purchase amounts\n    const firstIng = ingredients[0];\n    \n    // Sum up total quantity\n    let totalQty = 0;\n    let primaryUnit = '';\n    \n    ingredients.forEach(ing => {\n      if (ing.quantity > 0) {\n        totalQty += ing.quantity;\n        if (!primaryUnit && ing.unit) {\n          primaryUnit = ing.unit;\n        }\n      }\n    });\n    \n    if (totalQty > 0) {\n      // Convert to shopping quantity\n      const shoppingItem = convertToShoppingQuantity(totalQty, primaryUnit, firstIng.ingredient);\n      items.push(shoppingItem);\n    } else {\n      // No quantity - use as is\n      items.push(firstIng.ingredient);\n    }\n  });\n  \n  return items.sort();\n}\n\n// Helper to get emoji for ingredient\nfunction getIngredientEmoji(item: string): string {\n  const lower = item.toLowerCase();\n  \n  // Fruits & Berries\n  if (lower.includes('berries') || lower.includes('strawberr') || lower.includes('blueberr')) return 'ðŸ«';\n  if (lower.includes('apple')) return 'ðŸŽ';\n  if (lower.includes('banana')) return 'ðŸŒ';\n  if (lower.includes('orange')) return 'ðŸŠ';\n  if (lower.includes('lemon') || lower.includes('lime')) return 'ðŸ‹';\n  \n  // Vegetables\n  if (lower.includes('tomato')) return 'ðŸ…';\n  if (lower.includes('lettuce') || lower.includes('salad')) return 'ðŸ¥—';\n  if (lower.includes('carrot')) return 'ðŸ¥•';\n  if (lower.includes('broccoli')) return 'ðŸ¥¦';\n  if (lower.includes('onion')) return 'ðŸ§…';\n  if (lower.includes('garlic')) return 'ðŸ§„';\n  if (lower.includes('pepper') && !lower.includes('black pepper')) return 'ðŸ«‘';\n  if (lower.includes('potato')) return 'ðŸ¥”';\n  if (lower.includes('spinach') || lower.includes('kale')) return 'ðŸ¥¬';\n  \n  // Protein\n  if (lower.includes('egg')) return 'ðŸ¥š';\n  if (lower.includes('chicken') || lower.includes('poultry')) return 'ðŸ—';\n  if (lower.includes('beef') || lower.includes('steak')) return 'ðŸ¥©';\n  if (lower.includes('fish') || lower.includes('salmon')) return 'ðŸŸ';\n  if (lower.includes('shrimp') || lower.includes('prawn')) return 'ðŸ¤';\n  \n  // Dairy\n  if (lower.includes('milk')) return 'ðŸ¥›';\n  if (lower.includes('cheese')) return 'ðŸ§€';\n  if (lower.includes('butter')) return 'ðŸ§ˆ';\n  if (lower.includes('yogurt')) return 'ðŸ¥›';\n  if (lower.includes('cream')) return 'ðŸ¥›';\n  \n  // Grains & Bread\n  if (lower.includes('bread')) return 'ðŸž';\n  if (lower.includes('rice')) return 'ðŸš';\n  if (lower.includes('pasta')) return 'ðŸ';\n  if (lower.includes('oat')) return 'ðŸŒ¾';\n  if (lower.includes('flour')) return 'ðŸŒ¾';\n  \n  // Nuts & Seeds\n  if (lower.includes('almond') || lower.includes('nut')) return 'ðŸ¥œ';\n  if (lower.includes('seed')) return 'ðŸŒ°';\n  \n  // Seasonings\n  if (lower.includes('salt')) return 'ðŸ§‚';\n  if (lower.includes('pepper') && lower.includes('black')) return 'ðŸ§‚';\n  if (lower.includes('cinnamon') || lower.includes('spice')) return 'âœ¨';\n  if (lower.includes('vanilla')) return 'âœ¨';\n  \n  // Misc\n  if (lower.includes('sugar') || lower.includes('honey')) return 'ðŸ¯';\n  if (lower.includes('oil') || lower.includes('olive')) return 'ðŸ«’';\n  if (lower.includes('sauce')) return 'ðŸ¥«';\n  \n  // Default\n  return 'ðŸ›’';\n}\n\nexport function ShoppingListDialog({ isOpen, onClose, recipes }: ShoppingListDialogProps) {\n  const [newItemInput, setNewItemInput] = useState(\"\");\n  const [checkedRecipeItems, setCheckedRecipeItems] = useState<Set<string>>(new Set());\n  \n  // Fetch shopping list items from API\n  const { data: shoppingListItems = [], isLoading } = useQuery<any[]>({\n    queryKey: ['/api/shopping-list'],\n    enabled: isOpen,\n  });\n  \n  // Add shopping item mutation\n  const addItemMutation = useMutation({\n    mutationFn: async (itemName: string) => {\n      return await apiRequest('POST', '/api/shopping-list', {\n        itemName,\n        source: 'custom',\n        checked: 0,\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/shopping-list'] });\n      setNewItemInput(\"\");\n    },\n  });\n  \n  // Update shopping item mutation (for checking/unchecking)\n  const updateItemMutation = useMutation({\n    mutationFn: async ({ id, checked }: { id: string; checked: number }) => {\n      return await apiRequest('PATCH', `/api/shopping-list/${id}`, { checked });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/shopping-list'] });\n    },\n  });\n  \n  // Delete shopping item mutation\n  const deleteItemMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest('DELETE', `/api/shopping-list/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/shopping-list'] });\n    },\n  });\n\n  // Clear all checked items mutation\n  const clearCheckedMutation = useMutation({\n    mutationFn: async () => {\n      // Delete all checked custom items\n      const checkedCustomItems = customItems.filter((item: any) => item.checked === 1);\n      await Promise.all(\n        checkedCustomItems.map((item: any) => \n          apiRequest('DELETE', `/api/shopping-list/${item.id}`)\n        )\n      );\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/shopping-list'] });\n      // Also clear checked recipe items\n      setCheckedRecipeItems(new Set());\n    },\n  });\n  \n  // Filter custom items from database items\n  const customItems = shoppingListItems.filter((item: any) => item.source === 'custom');\n  \n  // Calculate shopping list from recipes\n  const shoppingList = useMemo(() => {\n    const aggregated = aggregateIngredients(recipes);\n    return formatShoppingList(aggregated);\n  }, [recipes]);\n  \n  const toggleItem = (item: any) => {\n    const newChecked = item.checked === 1 ? 0 : 1;\n    updateItemMutation.mutate({ id: item.id, checked: newChecked });\n  };\n  \n  const addCustomItem = () => {\n    const trimmed = newItemInput.trim();\n    if (trimmed) {\n      addItemMutation.mutate(trimmed);\n    }\n  };\n  \n  const deleteCustomItem = (itemId: string) => {\n    deleteItemMutation.mutate(itemId);\n  };\n  \n  const toggleRecipeItem = (itemId: string) => {\n    setCheckedRecipeItems(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(itemId)) {\n        newSet.delete(itemId);\n      } else {\n        newSet.add(itemId);\n      }\n      return newSet;\n    });\n  };\n  \n  const handleKeyPress = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      addCustomItem();\n    }\n  };\n  \n  const totalItems = shoppingList.length + customItems.length;\n  const checkedCount = customItems.filter((item: any) => item.checked === 1).length + checkedRecipeItems.size;\n  const remainingCount = totalItems - checkedCount;\n  \n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-md max-h-[85vh] overflow-hidden flex flex-col bg-gradient-to-br from-purple-50 via-pink-50 to-orange-50 dark:from-purple-950/30 dark:via-pink-950/30 dark:to-orange-950/30 border-0\" data-testid=\"dialog-shopping-list\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2 text-2xl\">\n            <ShoppingBasket className=\"h-6 w-6 text-purple-600\" />\n            Shopping List\n          </DialogTitle>\n          <DialogDescription className=\"text-base\">\n            {remainingCount > 0 ? (\n              <span className=\"text-purple-700 dark:text-purple-300 font-semibold\">\n                {remainingCount} of {totalItems} remaining\n              </span>\n            ) : totalItems > 0 ? (\n              <span className=\"text-green-600 dark:text-green-400 font-semibold\">\n                ðŸŽ‰ All done! Great shopping!\n              </span>\n            ) : (\n              <span className=\"text-gray-600 dark:text-gray-400\">\n                Add essentials below or select recipes\n              </span>\n            )}\n          </DialogDescription>\n        </DialogHeader>\n        \n        {/* Add Custom Item Input */}\n        <div className=\"flex gap-2 px-1\">\n          <Input\n            placeholder=\"Add essential item (e.g., Milk, Bread)\"\n            value={newItemInput}\n            onChange={(e) => setNewItemInput(e.target.value)}\n            onKeyPress={handleKeyPress}\n            className=\"bg-white dark:bg-gray-900 border-purple-200 dark:border-purple-800 focus-visible:ring-purple-500\"\n            data-testid=\"input-custom-item\"\n          />\n          <Button \n            onClick={addCustomItem}\n            size=\"icon\"\n            disabled={!newItemInput.trim()}\n            className=\"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700\"\n            data-testid=\"button-add-item\"\n          >\n            <Plus className=\"h-4 w-4\" />\n          </Button>\n        </div>\n        \n        <div className=\"flex-1 overflow-y-auto pr-2 space-y-4\">\n          {/* Your Essentials Section */}\n          {customItems.length > 0 && (\n            <div>\n              <div className=\"mb-3 p-3 rounded-xl bg-gradient-to-r from-purple-500 to-pink-500 flex items-center gap-2\">\n                <Star className=\"h-5 w-5 text-white\" />\n                <h3 className=\"text-base font-bold text-white\">\n                  Your Essentials\n                </h3>\n              </div>\n              <div className=\"space-y-2\">\n                {customItems.map((item: any, index) => {\n                  const isChecked = item.checked === 1;\n                  return (\n                    <div \n                      key={item.id} \n                      className=\"flex items-center gap-3 p-4 bg-white dark:bg-gray-900 rounded-2xl shadow-sm hover:shadow-md transition-all cursor-pointer group\"\n                      onClick={() => toggleItem(item)}\n                      data-testid={`custom-item-${index}`}\n                    >\n                      <Checkbox\n                        checked={isChecked}\n                        onCheckedChange={() => toggleItem(item)}\n                        className=\"h-5 w-5 rounded-full border-2\"\n                        data-testid={`checkbox-custom-${index}`}\n                      />\n                      <span className=\"text-2xl\">{getIngredientEmoji(item.itemName)}</span>\n                      <span \n                        className={`flex-1 text-base ${isChecked ? 'line-through text-gray-400' : 'text-gray-900 dark:text-gray-100 font-medium'}`}\n                      >\n                        {item.itemName}\n                      </span>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"icon\"\n                        className=\"h-8 w-8 opacity-0 group-hover:opacity-100 transition-opacity text-red-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-950/20\"\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          deleteCustomItem(item.id);\n                        }}\n                        data-testid={`button-delete-custom-${index}`}\n                      >\n                        <X className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  );\n                })}\n              </div>\n            </div>\n          )}\n          \n          {/* From Recipes Section */}\n          {shoppingList.length > 0 && (\n            <div>\n              <div className=\"mb-3 p-3 rounded-xl bg-gradient-to-r from-orange-500 to-amber-500 flex items-center gap-2\">\n                <ShoppingBasket className=\"h-5 w-5 text-white\" />\n                <h3 className=\"text-base font-bold text-white\">\n                  From Recipes\n                </h3>\n              </div>\n              <div className=\"space-y-2\">\n                {shoppingList.map((item, index) => {\n                  // Use item content as stable ID to survive recipe changes\n                  const itemId = `recipe-${item.toLowerCase().replace(/\\s+/g, '-')}`;\n                  const isChecked = checkedRecipeItems.has(itemId);\n                  return (\n                    <div \n                      key={itemId} \n                      className=\"flex items-center gap-3 p-4 bg-white dark:bg-gray-900 rounded-2xl shadow-sm hover:shadow-md transition-all cursor-pointer\"\n                      onClick={() => toggleRecipeItem(itemId)}\n                      data-testid={`shopping-item-${index}`}\n                    >\n                      <Checkbox\n                        checked={isChecked}\n                        onCheckedChange={() => toggleRecipeItem(itemId)}\n                        className=\"h-5 w-5 rounded-full border-2\"\n                        data-testid={`checkbox-item-${index}`}\n                      />\n                      <span className=\"text-2xl\">{getIngredientEmoji(item)}</span>\n                      <span \n                        className={`flex-1 text-base ${isChecked ? 'line-through text-gray-400' : 'text-gray-900 dark:text-gray-100 font-medium'}`}\n                      >\n                        {item}\n                      </span>\n                    </div>\n                  );\n                })}\n              </div>\n              \n              {recipes.length > 0 && (\n                <div className=\"mt-4 p-4 bg-white/60 dark:bg-gray-900/60 rounded-xl backdrop-blur-sm\">\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400 font-medium\">\n                    From your recipes:\n                  </p>\n                  <p className=\"text-sm mt-1 text-gray-800 dark:text-gray-200\">\n                    {recipes.map(r => r.name).join(', ')}\n                  </p>\n                </div>\n              )}\n            </div>\n          )}\n          \n          {/* Empty State */}\n          {shoppingList.length === 0 && customItems.length === 0 && (\n            <div className=\"text-center py-8 px-4\">\n              <ShoppingBasket className=\"h-16 w-16 mx-auto mb-4 text-purple-300 dark:text-purple-700\" />\n              <p className=\"text-lg text-gray-700 dark:text-gray-300 font-semibold mb-2\">\n                Start Your Shopping List\n              </p>\n              <div className=\"space-y-3 text-sm text-gray-600 dark:text-gray-400 text-left max-w-sm mx-auto\">\n                <div className=\"flex items-start gap-3 p-3 bg-white/50 dark:bg-gray-900/50 rounded-lg\">\n                  <span className=\"text-2xl\">ðŸ“</span>\n                  <div>\n                    <p className=\"font-medium\">Add essentials above</p>\n                    <p className=\"text-xs\">Quick items like milk, bread, eggs</p>\n                  </div>\n                </div>\n                <div className=\"flex items-start gap-3 p-3 bg-white/50 dark:bg-gray-900/50 rounded-lg\">\n                  <span className=\"text-2xl\">ðŸ³</span>\n                  <div>\n                    <p className=\"font-medium\">Select saved recipes</p>\n                    <p className=\"text-xs\">Ingredients added automatically</p>\n                  </div>\n                </div>\n                <div className=\"flex items-start gap-3 p-3 bg-white/50 dark:bg-gray-900/50 rounded-lg\">\n                  <span className=\"text-2xl\">âœ…</span>\n                  <div>\n                    <p className=\"font-medium\">Check off as you shop</p>\n                    <p className=\"text-xs\">Items stay visible so you can undo</p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n        \n        {/* Clear Checked Items Button */}\n        {checkedCount > 0 && (\n          <div className=\"pt-4 border-t border-purple-200 dark:border-purple-800\">\n            <Button\n              onClick={() => clearCheckedMutation.mutate()}\n              disabled={clearCheckedMutation.isPending}\n              className=\"w-full bg-gradient-to-r from-red-500 to-orange-500 hover:from-red-600 hover:to-orange-600 text-white font-semibold\"\n              data-testid=\"button-clear-checked\"\n            >\n              <Trash2 className=\"h-4 w-4 mr-2\" />\n              Clear {checkedCount} Checked Item{checkedCount !== 1 ? 's' : ''}\n            </Button>\n          </div>\n        )}\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":23793},"client/src/components/dropdown-navigation.tsx":{"content":"import { Link, useLocation } from \"wouter\";\nimport { Camera, Book, Calculator, Target, ChefHat, Brain, Trophy, Lightbulb, Menu, User, Images, GripVertical, CalendarClock } from \"lucide-react\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { Button } from \"@/components/ui/button\";\nimport { cn } from \"@/lib/utils\";\nimport { useState, useEffect, useRef } from \"react\";\n\nexport function DropdownNavigation() {\n  const [location] = useLocation();\n  const [position, setPosition] = useState({ x: 16, y: 100 }); // Start middle-left\n  const [isDragging, setIsDragging] = useState(false);\n  const [dragStart, setDragStart] = useState({ x: 0, y: 0 });\n  const [dropdownOpen, setDropdownOpen] = useState(false);\n  const [hasMoved, setHasMoved] = useState(false);\n  const buttonRef = useRef<HTMLButtonElement>(null);\n  const isMountedRef = useRef(true);\n\n  // Track mount status\n  useEffect(() => {\n    isMountedRef.current = true;\n    return () => {\n      isMountedRef.current = false;\n    };\n  }, []);\n\n  // Load saved position\n  useEffect(() => {\n    const saved = localStorage.getItem('nav-menu-position');\n    if (saved) {\n      try {\n        const parsed = JSON.parse(saved);\n        if (typeof parsed.x === 'number' && typeof parsed.y === 'number') {\n          if (isMountedRef.current) {\n            setPosition(parsed);\n          }\n        }\n      } catch (e) {\n        // Silently ignore errors\n      }\n    }\n  }, []);\n\n  // Clamp position to viewport\n  const clampToViewport = (x: number, y: number) => {\n    const buttonSize = 56; // 14 * 4px\n    const margin = 8;\n    return {\n      x: Math.max(margin, Math.min(x, window.innerWidth - buttonSize - margin)),\n      y: Math.max(margin, Math.min(y, window.innerHeight - buttonSize - margin))\n    };\n  };\n\n  // Start dragging\n  const handleDragStart = (clientX: number, clientY: number) => {\n    setHasMoved(false);\n    setDragStart({\n      x: clientX - position.x,\n      y: clientY - position.y\n    });\n  };\n\n  const handleMouseDown = (e: React.MouseEvent) => {\n    e.preventDefault();\n    handleDragStart(e.clientX, e.clientY);\n  };\n\n  const handleTouchStart = (e: React.TouchEvent) => {\n    if (e.touches.length === 1) {\n      handleDragStart(e.touches[0].clientX, e.touches[0].clientY);\n    }\n  };\n\n  // Handle dragging\n  useEffect(() => {\n    if (dragStart.x === 0 && dragStart.y === 0) return;\n\n    let moved = false;\n\n    const handleMove = (clientX: number, clientY: number) => {\n      if (!isMountedRef.current) return;\n      \n      try {\n        const deltaX = Math.abs(clientX - (position.x + dragStart.x));\n        const deltaY = Math.abs(clientY - (position.y + dragStart.y));\n        \n        // If moved more than 5px, consider it a drag\n        if (deltaX > 5 || deltaY > 5) {\n          if (!moved) {\n            moved = true;\n            if (isMountedRef.current) {\n              setHasMoved(true);\n              setIsDragging(true);\n              setDropdownOpen(false);\n            }\n          }\n          \n          if (isMountedRef.current) {\n            const newPos = clampToViewport(\n              clientX - dragStart.x,\n              clientY - dragStart.y\n            );\n            setPosition(newPos);\n          }\n        }\n      } catch (e) {\n        // Silently ignore errors during drag\n      }\n    };\n\n    const handleMouseMove = (e: MouseEvent) => {\n      e.preventDefault();\n      handleMove(e.clientX, e.clientY);\n    };\n\n    const handleTouchMove = (e: TouchEvent) => {\n      e.preventDefault();\n      if (e.touches.length === 1) {\n        handleMove(e.touches[0].clientX, e.touches[0].clientY);\n      }\n    };\n\n    const handleEnd = () => {\n      if (!isMountedRef.current) return;\n      \n      try {\n        if (moved) {\n          localStorage.setItem('nav-menu-position', JSON.stringify(position));\n        }\n        if (isMountedRef.current) {\n          setDragStart({ x: 0, y: 0 });\n          setTimeout(() => {\n            if (isMountedRef.current) {\n              setIsDragging(false);\n              setHasMoved(false);\n            }\n          }, 100);\n        }\n      } catch (e) {\n        // Silently ignore errors\n      }\n    };\n\n    window.addEventListener('mousemove', handleMouseMove);\n    window.addEventListener('mouseup', handleEnd);\n    window.addEventListener('touchmove', handleTouchMove, { passive: false });\n    window.addEventListener('touchend', handleEnd);\n\n    return () => {\n      window.removeEventListener('mousemove', handleMouseMove);\n      window.removeEventListener('mouseup', handleEnd);\n      window.removeEventListener('touchmove', handleTouchMove);\n      window.removeEventListener('touchend', handleEnd);\n    };\n  }, [dragStart, position]);\n\n  // Prevent dropdown opening while dragging\n  const handleClick = (e: React.MouseEvent) => {\n    if (hasMoved) {\n      e.preventDefault();\n      e.stopPropagation();\n      return false;\n    }\n  };\n\n  // Handle dropdown open/close\n  const handleDropdownOpenChange = (open: boolean) => {\n    // Don't allow opening if we just dragged\n    if (!hasMoved) {\n      setDropdownOpen(open);\n    }\n  };\n\n  const navItems = [\n    {\n      href: \"/\",\n      icon: Camera,\n      label: \"Home\",\n      isActive: location === \"/\" || location === \"/home\"\n    },\n    {\n      href: \"/diary?tab=diary\",\n      icon: Book,\n      label: \"Diary\",\n      isActive: location === \"/diary\" || location.startsWith(\"/diary?\")\n    },\n    {\n      href: \"/progress-photos\",\n      icon: Images,\n      label: \"Progress Photos\",\n      isActive: location === \"/progress-photos\"\n    },\n    {\n      href: \"/insights\",\n      icon: Lightbulb,\n      label: \"Insights\",\n      isActive: location === \"/insights\"\n    },\n    {\n      href: \"/ai-coach\",\n      icon: Lightbulb,\n      label: \"AI Coach\",\n      isActive: location === \"/ai-coach\"\n    },\n    {\n      href: \"/goals\",\n      icon: Target,\n      label: \"Goals\",\n      isActive: location === \"/goals\"\n    },\n    {\n      href: \"/shift-planner\",\n      icon: CalendarClock,\n      label: \"Shift Planner\",\n      isActive: location === \"/shift-planner\"\n    },\n    {\n      href: \"/profile\",\n      icon: User,\n      label: \"Profile\",\n      isActive: location === \"/profile\"\n    },\n    {\n      href: \"/recipes\",\n      icon: ChefHat,\n      label: \"Recipes\",\n      isActive: location === \"/recipes\"\n    },\n    {\n      href: \"/challenges\",\n      icon: Trophy,\n      label: \"Challenges\",\n      isActive: location === \"/challenges\"\n    }\n  ];\n\n  return (\n    <div\n      style={{\n        position: 'fixed',\n        left: position.x,\n        top: position.y,\n        zIndex: 50,\n        touchAction: 'none',\n        userSelect: 'none',\n        WebkitUserSelect: 'none'\n      }}\n      onMouseDown={handleMouseDown}\n      onTouchStart={handleTouchStart}\n    >\n      <DropdownMenu open={dropdownOpen} onOpenChange={handleDropdownOpenChange}>\n        <DropdownMenuTrigger asChild>\n          <Button\n            ref={buttonRef}\n            variant=\"ghost\"\n            size=\"icon\"\n            className=\"h-14 w-14 rounded-full bg-white/95 dark:bg-gray-900/95 backdrop-blur-md border border-border/50 shadow-lg hover:scale-105 transition-transform relative group cursor-move\"\n            style={{ touchAction: 'none' }}\n            data-testid=\"button-menu\"\n            aria-label=\"Open navigation menu (tap) or drag to move\"\n            onClick={handleClick}\n          >\n            <Menu className=\"h-6 w-6\" />\n            <GripVertical className=\"h-3 w-3 absolute bottom-0 right-0 text-muted-foreground opacity-50 group-hover:opacity-100 transition-opacity pointer-events-none\" />\n          </Button>\n        </DropdownMenuTrigger>\n        <DropdownMenuContent\n          align=\"start\"\n          className=\"w-56 ml-4 mt-2 bg-white/95 dark:bg-gray-900/95 backdrop-blur-md border-border/50\"\n          data-testid=\"dropdown-navigation-menu\"\n        >\n          {navItems.map((item) => {\n            const Icon = item.icon;\n            const isAICoach = item.href === \"/ai-coach\";\n            return (\n              <Link key={item.href} href={item.href}>\n                <DropdownMenuItem\n                  className={cn(\n                    \"flex items-center gap-3 px-4 py-3 cursor-pointer transition-colors min-h-[48px]\",\n                    isAICoach\n                      ? \"bg-gradient-to-r from-teal-600 to-cyan-600 text-white font-semibold hover:from-teal-700 hover:to-cyan-700 shadow-md\"\n                      : item.isActive\n                        ? \"bg-primary/10 text-primary font-medium\"\n                        : \"text-foreground hover:bg-accent\"\n                  )}\n                  data-testid={`nav-${item.label.toLowerCase()}`}\n                  aria-current={item.isActive ? 'page' : undefined}\n                >\n                  <Icon className=\"h-5 w-5\" aria-hidden=\"true\" />\n                  <span className=\"text-base\">{item.label}</span>\n                </DropdownMenuItem>\n              </Link>\n            );\n          })}\n        </DropdownMenuContent>\n      </DropdownMenu>\n    </div>\n  );\n}\n","size_bytes":9064},"client/src/pages/AICoachPage.tsx":{"content":"import { useState, useRef, useEffect } from \"react\";\nimport { motion } from \"framer-motion\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Link } from \"wouter\";\nimport { ArrowLeft, Lightbulb, Send, Sparkles, Target, ChefHat, TrendingUp, Heart, Loader2, Shield, Info } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { AICoachAvatar, ActivePersonalityStage, PersonalityType } from \"@/components/ai-coach-avatar\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\n\ninterface Message {\n  role: 'user' | 'assistant';\n  content: string;\n  timestamp: Date;\n}\n\ninterface Personality {\n  id: PersonalityType;\n  name: string;\n  description: string;\n}\n\ninterface QuickAction {\n  id: string;\n  label: string;\n  icon: any;\n  prompt: string;\n  color: string;\n}\n\nconst personalities: Personality[] = [\n  {\n    id: 'military',\n    name: 'Sergeant Stone',\n    description: 'Intense, direct, no excuses'\n  },\n  {\n    id: 'gym_bro',\n    name: 'Coach Mike',\n    description: 'Casual, hyped energy'\n  },\n  {\n    id: 'zen',\n    name: 'Maya',\n    description: 'Calm, mindful, balanced'\n  },\n  {\n    id: 'clinical',\n    name: 'Dr. Rivera',\n    description: 'Professional, evidence-based'\n  },\n  {\n    id: 'dark_humour',\n    name: 'Ryder',\n    description: 'Sarcastic but supportive'\n  },\n  {\n    id: 'alex',\n    name: 'Alex',\n    description: 'Army veteran, mum of 3. Brutally honest, sarcastic, weirdly motivating.'\n  }\n];\n\nconst quickActions: QuickAction[] = [\n  {\n    id: 'low-cal',\n    label: 'Low-Calorie Recipes',\n    icon: Target,\n    prompt: 'Show me healthy recipes under 500 calories',\n    color: 'from-blue-500 to-cyan-500'\n  },\n  {\n    id: 'high-protein',\n    label: 'High-Protein Meals',\n    icon: TrendingUp,\n    prompt: 'Suggest high-protein meal ideas (30g+ protein)',\n    color: 'from-purple-500 to-pink-500'\n  },\n  {\n    id: 'meal-planning',\n    label: 'Meal Planning Tips',\n    icon: ChefHat,\n    prompt: 'Give me tips for meal planning and prep',\n    color: 'from-green-500 to-emerald-500'\n  },\n  {\n    id: 'nutrition-advice',\n    label: 'Nutrition Advice',\n    icon: Heart,\n    prompt: 'What are some general nutrition tips for healthy eating?',\n    color: 'from-orange-500 to-red-500'\n  }\n];\n\nexport default function AICoachPage() {\n  const { toast } = useToast();\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [input, setInput] = useState('');\n  const [selectedPersonality, setSelectedPersonality] = useState<PersonalityType>('gym_bro');\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const textareaRef = useRef<HTMLTextAreaElement>(null);\n  const stageRef = useRef<HTMLDivElement>(null);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  };\n\n  const scrollToStage = () => {\n    // Use requestAnimationFrame to ensure DOM has updated\n    requestAnimationFrame(() => {\n      stageRef.current?.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\n    });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  useEffect(() => {\n    // Auto-scroll to stage when personality changes\n    scrollToStage();\n  }, [selectedPersonality]);\n\n  const chatMutation = useMutation({\n    mutationFn: async ({ prompt, history, personality }: { prompt: string; history: Message[]; personality: PersonalityType }) => {\n      // Send client's local time so AI knows what time it is for the user\n      const now = new Date();\n      const hours = now.getHours();\n      const minutes = now.getMinutes();\n      const clientTimeInfo = {\n        hours,\n        minutes,\n        timeString: `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`,\n        timeOfDay: hours < 12 ? 'morning' : hours < 17 ? 'afternoon' : 'evening'\n      };\n      \n      console.log('ðŸ•ðŸ•ðŸ• SENDING TIME TO AI:', clientTimeInfo);\n      \n      const response = await apiRequest('POST', '/api/ai-coach', { \n        prompt,\n        conversationHistory: history.map(m => ({ role: m.role, content: m.content })),\n        personality,\n        clientTimeInfo\n      });\n      if (!response.ok) {\n        throw new Error('Failed to get AI response');\n      }\n      return await response.json();\n    },\n    onSuccess: (data) => {\n      setMessages(prev => [...prev, {\n        role: 'assistant',\n        content: data.response,\n        timestamp: new Date()\n      }]);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to get AI response. Please try again.\",\n        variant: \"destructive\",\n      });\n    }\n  });\n\n  const handleSend = () => {\n    if (!input.trim() || chatMutation.isPending) return;\n\n    const userMessage = input.trim();\n    const newMessages = [...messages, {\n      role: 'user' as const,\n      content: userMessage,\n      timestamp: new Date()\n    }];\n    setMessages(newMessages);\n    setInput('');\n    chatMutation.mutate({ prompt: userMessage, history: newMessages, personality: selectedPersonality });\n  };\n\n  const handleQuickAction = (action: QuickAction) => {\n    const newMessages = [...messages, {\n      role: 'user' as const,\n      content: action.prompt,\n      timestamp: new Date()\n    }];\n    setMessages(newMessages);\n    chatMutation.mutate({ prompt: action.prompt, history: newMessages, personality: selectedPersonality });\n  };\n\n  const handleKeyPress = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSend();\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-b from-teal-50 via-white to-cyan-50 dark:from-gray-900 dark:via-gray-900 dark:to-gray-900\">\n      {/* Header Bar */}\n      <div className=\"bg-gradient-to-r from-teal-600 to-cyan-600 dark:from-teal-700 dark:to-cyan-700 text-white p-6 pb-8\">\n        <div className=\"max-w-4xl mx-auto\">\n          <div className=\"flex items-center gap-3 mb-2\">\n            <Link href=\"/\">\n              <button\n                className=\"p-2 hover:bg-white/20 rounded-lg transition-colors\"\n                data-testid=\"button-back\"\n              >\n                <ArrowLeft className=\"h-5 w-5\" />\n              </button>\n            </Link>\n            <Lightbulb className=\"w-8 h-8\" />\n            <h1 className=\"text-3xl font-bold\">AI Coach</h1>\n          </div>\n          <p className=\"text-teal-100\">Your personal nutrition and recipe assistant</p>\n        </div>\n      </div>\n\n      <div className=\"max-w-4xl mx-auto p-4 -mt-4 pb-32\">\n        {/* Privacy Notice */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.4 }}\n          className=\"mb-6\"\n        >\n          <Alert className=\"bg-gradient-to-r from-blue-50 to-cyan-50 dark:from-blue-950/20 dark:to-cyan-950/20 border-blue-200 dark:border-blue-800\">\n            <Shield className=\"h-4 w-4 text-blue-600 dark:text-blue-400\" />\n            <AlertDescription className=\"text-sm text-gray-700 dark:text-gray-300\">\n              <strong className=\"font-semibold\">Personalized AI Coaching:</strong> Your AI Coach uses your nutrition data, diary entries, weight tracking, goals, and activity to provide tailored advice. Your data is processed securely and never shared with third parties. We use AI providers (OpenAI/Google) only for generating responsesâ€”they don't store your personal information.\n            </AlertDescription>\n          </Alert>\n        </motion.div>\n\n        {/* Active Personality Animation Stage */}\n        <motion.div\n          ref={stageRef}\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.5 }}\n          className=\"mb-8\"\n        >\n          <ActivePersonalityStage \n            personality={selectedPersonality} \n            isThinking={chatMutation.isPending}\n          />\n        </motion.div>\n\n        {/* Personality Selector */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.6, delay: 0.1 }}\n          className=\"mb-8\"\n        >\n          <h2 className=\"text-xl font-semibold mb-4 text-center text-gray-900 dark:text-gray-100\">\n            Choose Your Coach\n          </h2>\n          <div className=\"grid grid-cols-2 md:grid-cols-5 gap-4\">\n            {personalities.map((personality) => (\n              <motion.button\n                key={personality.id}\n                onClick={() => setSelectedPersonality(personality.id)}\n                className={`p-4 rounded-xl border-2 transition-all flex flex-col items-center gap-2 ${\n                  selectedPersonality === personality.id\n                    ? 'border-teal-500 bg-teal-50 dark:bg-teal-900/20 shadow-lg'\n                    : 'border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 hover:border-teal-300 dark:hover:border-teal-600'\n                }`}\n                whileHover={{ scale: 1.05 }}\n                whileTap={{ scale: 0.95 }}\n                data-testid={`button-personality-${personality.id}`}\n              >\n                <AICoachAvatar \n                  personality={personality.id} \n                  size=\"small\"\n                />\n                <div className=\"text-center\">\n                  <div className=\"text-sm font-semibold text-gray-900 dark:text-gray-100\">\n                    {personality.name}\n                  </div>\n                  <div className=\"text-xs text-gray-600 dark:text-gray-400 mt-1\">\n                    {personality.description}\n                  </div>\n                </div>\n              </motion.button>\n            ))}\n          </div>\n        </motion.div>\n\n        {/* Quick Actions - Always visible */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.6, delay: 0.2 }}\n          className=\"mb-8\"\n        >\n            <h2 className=\"text-xl font-semibold mb-4 flex items-center gap-2 text-gray-900 dark:text-gray-100\">\n              <Sparkles className=\"h-5 w-5 text-teal-600 dark:text-teal-400\" />\n              Quick Actions\n            </h2>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              {quickActions.map((action) => {\n                const Icon = action.icon;\n                return (\n                  <motion.button\n                    key={action.id}\n                    onClick={() => handleQuickAction(action)}\n                    disabled={chatMutation.isPending}\n                    className={`p-6 rounded-2xl bg-gradient-to-r ${action.color} text-white shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300 text-left disabled:opacity-50 disabled:cursor-not-allowed`}\n                    whileHover={{ scale: 1.05 }}\n                    whileTap={{ scale: 0.95 }}\n                    data-testid={`button-quick-${action.id}`}\n                  >\n                    <Icon className=\"h-6 w-6 mb-2\" />\n                    <div className=\"font-semibold text-lg\">{action.label}</div>\n                  </motion.button>\n                );\n              })}\n            </div>\n          </motion.div>\n\n          {/* Chat Messages */}\n          {messages.length > 0 && (\n            <div className=\"mb-6 space-y-4\">\n              {messages.map((message, index) => (\n                <motion.div\n                  key={index}\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ duration: 0.3 }}\n                  className={`flex ${message.role === 'user' ? 'justify-end' : 'justify-start'}`}\n                >\n                  <div\n                    className={`max-w-[80%] p-4 rounded-2xl ${\n                      message.role === 'user'\n                        ? 'bg-gradient-to-r from-teal-600 to-cyan-600 text-white'\n                        : 'bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 border border-gray-200 dark:border-gray-700'\n                    }`}\n                  >\n                    <div className=\"whitespace-pre-wrap\">{message.content}</div>\n                    <div className={`text-xs mt-2 ${message.role === 'user' ? 'text-white/70' : 'text-gray-500'}`}>\n                      {message.timestamp.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\n                    </div>\n                  </div>\n                </motion.div>\n              ))}\n              {chatMutation.isPending && (\n                <motion.div\n                  initial={{ opacity: 0 }}\n                  animate={{ opacity: 1 }}\n                  className=\"flex justify-start\"\n                >\n                  <div className=\"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 p-4 rounded-2xl\">\n                    <Loader2 className=\"h-5 w-5 animate-spin text-teal-600 dark:text-teal-400\" />\n                  </div>\n                </motion.div>\n              )}\n              <div ref={messagesEndRef} />\n            </div>\n          )}\n\n          {/* Input Area - Fixed at bottom */}\n          <div className=\"fixed bottom-0 left-0 right-0 bg-white/95 dark:bg-gray-900/95 backdrop-blur-md border-t border-gray-200 dark:border-gray-800 p-4\">\n            <div className=\"max-w-4xl mx-auto\">\n              <div className=\"flex gap-2 items-end\">\n                <Textarea\n                  ref={textareaRef}\n                  value={input}\n                  onChange={(e) => setInput(e.target.value)}\n                  onKeyDown={handleKeyPress}\n                  placeholder=\"Ask me about recipes, nutrition advice, meal planning...\"\n                  className=\"flex-1 min-h-[60px] max-h-[120px] resize-none rounded-2xl border-gray-300 dark:border-gray-700 focus:ring-2 focus:ring-teal-500\"\n                  disabled={chatMutation.isPending}\n                  data-testid=\"input-chat\"\n                />\n                <Button\n                  onClick={handleSend}\n                  disabled={!input.trim() || chatMutation.isPending}\n                  className=\"h-[60px] px-6 bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-700 hover:to-cyan-700 text-white rounded-2xl\"\n                  data-testid=\"button-send\"\n                >\n                  <Send className=\"h-5 w-5\" />\n                </Button>\n              </div>\n              <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-2 text-center\">\n                Press Enter to send, Shift+Enter for new line\n              </p>\n            </div>\n          </div>\n        </div>\n    </div>\n  );\n}\n","size_bytes":14763},"client/src/pages/ProfilePage.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { ArrowLeft, User, Save, Loader2, Clock, Briefcase, Calculator, Scale, Target, Activity, ChevronDown, ChevronUp } from \"lucide-react\";\nimport { Link, useLocation } from \"wouter\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Label } from \"@/components/ui/label\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { DropdownNavigation } from \"@/components/dropdown-navigation\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { motion } from \"framer-motion\";\nimport { calculateNutritionTargets, calculateMacroTargets, type UserData } from \"@/lib/nutrition-calculator\";\n\nconst profileFormSchema = z.object({\n  // Personal info\n  name: z.string().optional(),\n  nickname: z.string().optional(),\n  // Physical stats & goals\n  age: z.number().min(10).max(120).optional(),\n  sex: z.enum([\"male\", \"female\"]).optional(),\n  heightCm: z.number().min(100).max(250).optional(),\n  currentWeightKg: z.number().min(30).max(300).optional(),\n  goalWeightKg: z.number().min(30).max(300).optional(),\n  activityLevel: z.enum([\"sedentary\", \"lightly_active\", \"moderately_active\", \"very_active\", \"extra_active\"]).optional(),\n  weightGoal: z.enum([\"lose_weight\", \"maintain_weight\", \"gain_weight\"]).optional(),\n  medication: z.enum([\"none\", \"ozempic\", \"wegovy\", \"mounjaro\", \"other_glp1\"]).optional(),\n  // Dietary & health\n  dietaryRequirements: z.string().optional(),\n  allergies: z.string().optional(),\n  foodDislikes: z.string().optional(),\n  healthConditions: z.string().optional(),\n  // Work schedule\n  defaultShiftType: z.string().optional(),\n  customShiftStart: z.string().optional(),\n  customShiftEnd: z.string().optional(),\n  enableDailyShiftCheckIn: z.boolean().optional(),\n});\n\ntype ProfileFormData = z.infer<typeof profileFormSchema>;\n\nexport function ProfilePage() {\n  const { toast } = useToast();\n  const [, setLocation] = useLocation();\n  const [dietaryTags, setDietaryTags] = useState<string[]>([]);\n  const [allergyTags, setAllergyTags] = useState<string[]>([]);\n  const [selectedShiftType, setSelectedShiftType] = useState<string>(\"regular\");\n  const [breakTimes, setBreakTimes] = useState<string[]>([]);\n  const [dailyCheckInEnabled, setDailyCheckInEnabled] = useState(false);\n  const [calculatedData, setCalculatedData] = useState<any>(null);\n  const [showCalculations, setShowCalculations] = useState(false);\n\n  // Fetch user profile\n  const { data: profile, isLoading } = useQuery<any>({\n    queryKey: [\"/api/user-profile\"],\n  });\n\n  const form = useForm<ProfileFormData>({\n    resolver: zodResolver(profileFormSchema),\n    defaultValues: {\n      name: \"\",\n      nickname: \"\",\n      age: undefined,\n      sex: undefined,\n      heightCm: undefined,\n      currentWeightKg: undefined,\n      goalWeightKg: undefined,\n      activityLevel: undefined,\n      weightGoal: undefined,\n      medication: \"none\",\n      dietaryRequirements: \"\",\n      allergies: \"\",\n      foodDislikes: \"\",\n      healthConditions: \"\",\n      defaultShiftType: \"regular\",\n      customShiftStart: \"\",\n      customShiftEnd: \"\",\n      enableDailyShiftCheckIn: false,\n    },\n  });\n\n  // Initialize tags and form fields when profile loads\n  useEffect(() => {\n    if (profile) {\n      if (profile.dietaryRequirements && Array.isArray(profile.dietaryRequirements)) {\n        setDietaryTags(profile.dietaryRequirements);\n      }\n      if (profile.allergies && Array.isArray(profile.allergies)) {\n        setAllergyTags(profile.allergies);\n      }\n      if (profile.defaultShiftType) {\n        setSelectedShiftType(profile.defaultShiftType);\n      }\n      if (profile.customBreakWindows && Array.isArray(profile.customBreakWindows)) {\n        setBreakTimes(profile.customBreakWindows);\n      }\n      if (profile.enableDailyShiftCheckIn !== undefined) {\n        setDailyCheckInEnabled(profile.enableDailyShiftCheckIn === 1);\n      }\n      // Reset form with profile data\n      form.reset({\n        name: profile.name || \"\",\n        nickname: profile.nickname || \"\",\n        age: profile.age || undefined,\n        sex: profile.sex as any || undefined,\n        heightCm: profile.heightCm || undefined,\n        currentWeightKg: profile.currentWeightKg || undefined,\n        goalWeightKg: profile.goalWeightKg || undefined,\n        activityLevel: profile.activityLevel as any || undefined,\n        weightGoal: profile.weightGoal as any || undefined,\n        medication: profile.medication as any || \"none\",\n        dietaryRequirements: \"\",\n        allergies: \"\",\n        foodDislikes: profile.foodDislikes || \"\",\n        healthConditions: profile.healthConditions || \"\",\n        defaultShiftType: profile.defaultShiftType || \"regular\",\n        customShiftStart: profile.customShiftStart || \"\",\n        customShiftEnd: profile.customShiftEnd || \"\",\n        enableDailyShiftCheckIn: profile.enableDailyShiftCheckIn === 1,\n      });\n    }\n  }, [profile, form]);\n\n  // Auto-calculate nutrition targets when physical stats change\n  useEffect(() => {\n    const subscription = form.watch((data) => {\n      const { age, sex, heightCm, currentWeightKg, goalWeightKg, activityLevel, weightGoal, medication } = data;\n      \n      // Only calculate if all required fields are present\n      if (age && sex && heightCm && currentWeightKg && goalWeightKg && activityLevel && weightGoal) {\n        const userData: UserData = {\n          age: age as number,\n          sex: sex as \"male\" | \"female\",\n          heightCm: heightCm as number,\n          currentWeightKg: currentWeightKg as number,\n          goalWeightKg: goalWeightKg as number,\n          activityLevel: activityLevel as any,\n          weightGoal: weightGoal as any,\n          medication: medication as any,\n        };\n        \n        const results = calculateNutritionTargets(userData);\n        const macros = calculateMacroTargets(results.targetCalories, weightGoal as string);\n        \n        setCalculatedData({ ...results, macros });\n        setShowCalculations(true);\n      }\n    });\n    \n    return () => subscription.unsubscribe();\n  }, [form]);\n\n  // Save profile mutation\n  const saveMutation = useMutation({\n    mutationFn: async (data: any) => {\n      return await apiRequest('POST', '/api/user-profile', data);\n    },\n    onSuccess: async () => {\n      // Save nutrition goals if we have calculated data\n      if (calculatedData && calculatedData.macros) {\n        try {\n          await apiRequest('POST', '/api/nutrition-goals', calculatedData.macros);\n          queryClient.invalidateQueries({ queryKey: [\"/api/nutrition-goals\"] });\n        } catch (error) {\n          console.error(\"Failed to save nutrition goals:\", error);\n          toast({\n            title: \"Warning\",\n            description: \"Profile saved but nutrition targets failed to update. Please try again.\",\n            variant: \"destructive\",\n          });\n          return;\n        }\n      }\n      \n      queryClient.invalidateQueries({ queryKey: [\"/api/user-profile\"] });\n      toast({\n        title: \"Profile saved!\",\n        description: calculatedData ? \"Your profile and nutrition targets have been updated.\" : \"Your profile has been updated.\",\n      });\n      \n      // Redirect to Goals page\n      setTimeout(() => {\n        setLocation('/goals');\n      }, 1000);\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to save profile. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: ProfileFormData) => {\n    saveMutation.mutate({\n      name: data.name || null,\n      nickname: data.nickname || null,\n      age: data.age || null,\n      sex: data.sex || null,\n      heightCm: data.heightCm || null,\n      currentWeightKg: data.currentWeightKg || null,\n      goalWeightKg: data.goalWeightKg || null,\n      activityLevel: data.activityLevel || null,\n      weightGoal: data.weightGoal || null,\n      medication: data.medication || null,\n      dietaryRequirements: dietaryTags,\n      allergies: allergyTags,\n      foodDislikes: data.foodDislikes || null,\n      healthConditions: data.healthConditions || null,\n      defaultShiftType: selectedShiftType,\n      customShiftStart: data.customShiftStart || null,\n      customShiftEnd: data.customShiftEnd || null,\n      customBreakWindows: breakTimes,\n      enableDailyShiftCheckIn: dailyCheckInEnabled ? 1 : 0,\n    });\n  };\n\n  const addBreakTime = () => {\n    setBreakTimes([...breakTimes, \"\"]);\n  };\n\n  const updateBreakTime = (index: number, value: string) => {\n    const updated = [...breakTimes];\n    updated[index] = value;\n    setBreakTimes(updated);\n  };\n\n  const removeBreakTime = (index: number) => {\n    setBreakTimes(breakTimes.filter((_, i) => i !== index));\n  };\n\n  const shiftTypes = [\n    { value: \"regular\", label: \"Regular Daytime\", description: \"Standard 9-5 working hours\" },\n    { value: \"early_shift\", label: \"Early Shift\", description: \"e.g., 6am-2pm\" },\n    { value: \"late_shift\", label: \"Late Shift\", description: \"e.g., 2pm-10pm\" },\n    { value: \"night_shift\", label: \"Night Shift\", description: \"Overnight hours\" },\n    { value: \"long_shift\", label: \"Long 12.5hr Clinical Shift\", description: \"For NHS/emergency workers\" },\n    { value: \"custom\", label: \"Custom Shift\", description: \"Set your own hours\" },\n  ];\n\n  const commonDietaryOptions = [\n    \"Vegetarian\",\n    \"Vegan\",\n    \"Pescatarian\",\n    \"Keto\",\n    \"Paleo\",\n    \"Low Carb\",\n    \"Gluten-Free\",\n    \"Dairy-Free\",\n    \"Halal\",\n    \"Kosher\",\n  ];\n\n  const commonAllergies = [\n    \"Peanuts\",\n    \"Tree Nuts\",\n    \"Milk/Dairy\",\n    \"Eggs\",\n    \"Fish\",\n    \"Shellfish\",\n    \"Soy\",\n    \"Wheat/Gluten\",\n    \"Sesame\",\n  ];\n\n  const toggleTag = (tag: string, currentTags: string[], setTags: (tags: string[]) => void) => {\n    if (currentTags.includes(tag)) {\n      setTags(currentTags.filter((t) => t !== tag));\n    } else {\n      setTags([...currentTags, tag]);\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\" style={{background: 'var(--bg-gradient)'}}>\n        <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen text-foreground pb-32\" style={{background: 'var(--bg-gradient)'}}>\n      {/* Header */}\n      <div className=\"bg-gradient-to-r from-purple-600 to-pink-600 text-white\">\n        <div className=\"max-w-4xl mx-auto px-4 py-6\">\n          <div className=\"flex items-center space-x-3\">\n            <Link href=\"/\">\n              <button \n                className=\"p-2 hover:bg-white/20 rounded-lg transition-colors\"\n                data-testid=\"button-back\"\n              >\n                <ArrowLeft className=\"h-5 w-5\" />\n              </button>\n            </Link>\n            <div className=\"flex items-center space-x-3\">\n              <User className=\"h-6 w-6\" />\n              <h1 className=\"text-2xl font-bold\">My Profile</h1>\n            </div>\n          </div>\n          <p className=\"mt-2 text-white/90 text-sm ml-14\">\n            Help your AI Coach give you personalized advice\n          </p>\n        </div>\n      </div>\n\n      {/* Content */}\n      <motion.div \n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ duration: 0.6 }}\n        className=\"max-w-4xl mx-auto p-4 space-y-6\"\n      >\n        <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n          {/* Personal Information Section */}\n          <div className=\"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg\">\n            <h2 className=\"text-lg font-semibold mb-4\">Personal Information</h2>\n            <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-4\">\n              Help your AI Coach address you personally\n            </p>\n            <div className=\"space-y-4\">\n              <div>\n                <Label htmlFor=\"name\" className=\"block mb-2\">\n                  Your Name\n                </Label>\n                <Input\n                  id=\"name\"\n                  {...form.register(\"name\")}\n                  placeholder=\"e.g., Sarah Johnson\"\n                  className=\"w-full\"\n                  data-testid=\"input-name\"\n                />\n              </div>\n              <div>\n                <Label htmlFor=\"nickname\" className=\"block mb-2\">\n                  Preferred Name / Nickname\n                </Label>\n                <p className=\"text-sm text-gray-500 dark:text-gray-400 mb-2\">\n                  What should your AI Coach call you?\n                </p>\n                <Input\n                  id=\"nickname\"\n                  {...form.register(\"nickname\")}\n                  placeholder=\"e.g., Sarah, SJ, Coach...\"\n                  className=\"w-full\"\n                  data-testid=\"input-nickname\"\n                />\n              </div>\n            </div>\n          </div>\n\n          {/* Physical Stats & Goals Section */}\n          <div className=\"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg\">\n            <div className=\"flex items-center gap-2 mb-2\">\n              <Calculator className=\"h-5 w-5 text-purple-600\" />\n              <h2 className=\"text-lg font-semibold\">Physical Stats & Goals</h2>\n            </div>\n            <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-4\">\n              Enter your physical information to calculate your nutrition targets\n            </p>\n            \n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              {/* Age */}\n              <div>\n                <Label htmlFor=\"age\" className=\"block mb-2\">Age (years)</Label>\n                <Input\n                  id=\"age\"\n                  type=\"number\"\n                  {...form.register(\"age\", { valueAsNumber: true })}\n                  placeholder=\"e.g., 30\"\n                  className=\"w-full\"\n                  data-testid=\"input-age\"\n                />\n              </div>\n\n              {/* Sex */}\n              <div>\n                <Label htmlFor=\"sex\" className=\"block mb-2\">Sex</Label>\n                <Select onValueChange={(value) => form.setValue(\"sex\", value as any)} value={form.watch(\"sex\") || \"\"}>\n                  <SelectTrigger data-testid=\"select-sex\" className=\"w-full\">\n                    <SelectValue placeholder=\"Select sex\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"male\">Male</SelectItem>\n                    <SelectItem value=\"female\">Female</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n\n              {/* Height */}\n              <div>\n                <Label htmlFor=\"heightCm\" className=\"block mb-2\">Height (cm)</Label>\n                <Input\n                  id=\"heightCm\"\n                  type=\"number\"\n                  {...form.register(\"heightCm\", { valueAsNumber: true })}\n                  placeholder=\"e.g., 170\"\n                  className=\"w-full\"\n                  data-testid=\"input-height\"\n                />\n              </div>\n\n              {/* Current Weight */}\n              <div>\n                <Label htmlFor=\"currentWeightKg\" className=\"block mb-2\">Current Weight (kg)</Label>\n                <Input\n                  id=\"currentWeightKg\"\n                  type=\"number\"\n                  {...form.register(\"currentWeightKg\", { valueAsNumber: true })}\n                  placeholder=\"e.g., 75\"\n                  className=\"w-full\"\n                  data-testid=\"input-current-weight\"\n                />\n              </div>\n\n              {/* Goal Weight */}\n              <div>\n                <Label htmlFor=\"goalWeightKg\" className=\"block mb-2\">Goal Weight (kg)</Label>\n                <Input\n                  id=\"goalWeightKg\"\n                  type=\"number\"\n                  {...form.register(\"goalWeightKg\", { valueAsNumber: true })}\n                  placeholder=\"e.g., 70\"\n                  className=\"w-full\"\n                  data-testid=\"input-goal-weight\"\n                />\n              </div>\n\n              {/* Activity Level */}\n              <div>\n                <Label htmlFor=\"activityLevel\" className=\"block mb-2\">Activity Level</Label>\n                <Select onValueChange={(value) => form.setValue(\"activityLevel\", value as any)} value={form.watch(\"activityLevel\") || \"\"}>\n                  <SelectTrigger data-testid=\"select-activity\" className=\"w-full\">\n                    <SelectValue placeholder=\"Select activity level\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"sedentary\">Sedentary (desk job, no exercise)</SelectItem>\n                    <SelectItem value=\"lightly_active\">Lightly Active (light exercise 1-3 days/week)</SelectItem>\n                    <SelectItem value=\"moderately_active\">Moderately Active (moderate exercise 3-5 days/week)</SelectItem>\n                    <SelectItem value=\"very_active\">Very Active (heavy exercise 6-7 days/week)</SelectItem>\n                    <SelectItem value=\"extra_active\">Extra Active (very heavy exercise, physical job)</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n\n              {/* Weight Goal */}\n              <div>\n                <Label htmlFor=\"weightGoal\" className=\"block mb-2\">Weight Goal</Label>\n                <Select onValueChange={(value) => form.setValue(\"weightGoal\", value as any)} value={form.watch(\"weightGoal\") || \"\"}>\n                  <SelectTrigger data-testid=\"select-weight-goal\" className=\"w-full\">\n                    <SelectValue placeholder=\"Select weight goal\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"lose_weight\">Lose Weight</SelectItem>\n                    <SelectItem value=\"maintain_weight\">Maintain Weight</SelectItem>\n                    <SelectItem value=\"gain_weight\">Gain Weight</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n\n              {/* Medication */}\n              <div>\n                <Label htmlFor=\"medication\" className=\"block mb-2\">Weight Loss Medication (Optional)</Label>\n                <Select onValueChange={(value) => form.setValue(\"medication\", value as any)} value={form.watch(\"medication\") || \"none\"}>\n                  <SelectTrigger data-testid=\"select-medication\" className=\"w-full\">\n                    <SelectValue placeholder=\"Select medication\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"none\">None</SelectItem>\n                    <SelectItem value=\"ozempic\">Ozempic</SelectItem>\n                    <SelectItem value=\"wegovy\">Wegovy</SelectItem>\n                    <SelectItem value=\"mounjaro\">Mounjaro</SelectItem>\n                    <SelectItem value=\"other_glp1\">Other GLP-1</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n\n            {/* Calculated Targets */}\n            {calculatedData && showCalculations && (\n              <div className=\"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700\">\n                <button\n                  type=\"button\"\n                  onClick={() => setShowCalculations(!showCalculations)}\n                  className=\"flex items-center justify-between w-full mb-4 text-left\"\n                  data-testid=\"button-toggle-calculations\"\n                >\n                  <h3 className=\"text-md font-semibold text-purple-600 dark:text-purple-400\">\n                    Your Calculated Nutrition Targets\n                  </h3>\n                  {showCalculations ? <ChevronUp className=\"h-5 w-5\" /> : <ChevronDown className=\"h-5 w-5\" />}\n                </button>\n\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                  <div className=\"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl\">\n                    <div className=\"text-sm text-gray-600 dark:text-gray-400 mb-1\">BMR</div>\n                    <div className=\"text-2xl font-bold text-blue-600 dark:text-blue-400\">{calculatedData.bmr}</div>\n                    <div className=\"text-xs text-gray-500 dark:text-gray-400\">cal/day</div>\n                  </div>\n\n                  <div className=\"bg-green-50 dark:bg-green-900/20 p-4 rounded-xl\">\n                    <div className=\"text-sm text-gray-600 dark:text-gray-400 mb-1\">TDEE</div>\n                    <div className=\"text-2xl font-bold text-green-600 dark:text-green-400\">{calculatedData.tdee}</div>\n                    <div className=\"text-xs text-gray-500 dark:text-gray-400\">cal/day</div>\n                  </div>\n\n                  <div className=\"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-xl\">\n                    <div className=\"text-sm text-gray-600 dark:text-gray-400 mb-1\">Target</div>\n                    <div className=\"text-2xl font-bold text-purple-600 dark:text-purple-400\">{calculatedData.targetCalories}</div>\n                    <div className=\"text-xs text-gray-500 dark:text-gray-400\">cal/day</div>\n                  </div>\n\n                  <div className=\"bg-pink-50 dark:bg-pink-900/20 p-4 rounded-xl\">\n                    <div className=\"text-sm text-gray-600 dark:text-gray-400 mb-1\">Protein</div>\n                    <div className=\"text-2xl font-bold text-pink-600 dark:text-pink-400\">{calculatedData.macros.dailyProtein}</div>\n                    <div className=\"text-xs text-gray-500 dark:text-gray-400\">grams/day</div>\n                  </div>\n\n                  <div className=\"bg-orange-50 dark:bg-orange-900/20 p-4 rounded-xl\">\n                    <div className=\"text-sm text-gray-600 dark:text-gray-400 mb-1\">Carbs</div>\n                    <div className=\"text-2xl font-bold text-orange-600 dark:text-orange-400\">{calculatedData.macros.dailyCarbs}</div>\n                    <div className=\"text-xs text-gray-500 dark:text-gray-400\">grams/day</div>\n                  </div>\n\n                  <div className=\"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-xl\">\n                    <div className=\"text-sm text-gray-600 dark:text-gray-400 mb-1\">Fat</div>\n                    <div className=\"text-2xl font-bold text-yellow-600 dark:text-yellow-400\">{calculatedData.macros.dailyFat}</div>\n                    <div className=\"text-xs text-gray-500 dark:text-gray-400\">grams/day</div>\n                  </div>\n                </div>\n\n                <p className=\"mt-4 text-xs text-gray-500 dark:text-gray-400\">\n                  These targets will be saved to your Goals page when you save your profile.\n                </p>\n              </div>\n            )}\n          </div>\n\n          {/* Dietary Requirements Section */}\n          <div className=\"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg\">\n            <h2 className=\"text-lg font-semibold mb-4\">Dietary Requirements</h2>\n            <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-4\">\n              Select any dietary preferences or restrictions you follow\n            </p>\n            <div className=\"flex flex-wrap gap-2\">\n              {commonDietaryOptions.map((option) => (\n                <button\n                  key={option}\n                  type=\"button\"\n                  onClick={() => toggleTag(option, dietaryTags, setDietaryTags)}\n                  className={`px-4 py-2 rounded-full text-sm font-medium transition-all ${\n                    dietaryTags.includes(option)\n                      ? \"bg-purple-600 text-white shadow-md\"\n                      : \"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600\"\n                  }`}\n                  data-testid={`tag-dietary-${option.toLowerCase().replace(/\\s+/g, '-')}`}\n                >\n                  {option}\n                </button>\n              ))}\n            </div>\n          </div>\n\n          {/* Allergies Section */}\n          <div className=\"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg\">\n            <h2 className=\"text-lg font-semibold mb-4\">Allergies & Intolerances</h2>\n            <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-4\">\n              Select any foods you're allergic to or intolerant of\n            </p>\n            <div className=\"flex flex-wrap gap-2\">\n              {commonAllergies.map((allergy) => (\n                <button\n                  key={allergy}\n                  type=\"button\"\n                  onClick={() => toggleTag(allergy, allergyTags, setAllergyTags)}\n                  className={`px-4 py-2 rounded-full text-sm font-medium transition-all ${\n                    allergyTags.includes(allergy)\n                      ? \"bg-red-600 text-white shadow-md\"\n                      : \"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600\"\n                  }`}\n                  data-testid={`tag-allergy-${allergy.toLowerCase().replace(/\\s+/g, '-').replace(/\\//g, '-')}`}\n                >\n                  {allergy}\n                </button>\n              ))}\n            </div>\n          </div>\n\n          {/* Food Dislikes Section */}\n          <div className=\"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg\">\n            <Label htmlFor=\"foodDislikes\" className=\"text-lg font-semibold block mb-2\">\n              Foods You Dislike\n            </Label>\n            <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-4\">\n              Let us know what foods you don't enjoy eating\n            </p>\n            <Textarea\n              id=\"foodDislikes\"\n              {...form.register(\"foodDislikes\")}\n              placeholder=\"e.g., Brussels sprouts, cilantro, liver...\"\n              className=\"min-h-[100px]\"\n              data-testid=\"input-food-dislikes\"\n            />\n          </div>\n\n          {/* Health Conditions Section */}\n          <div className=\"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg\">\n            <Label htmlFor=\"healthConditions\" className=\"text-lg font-semibold block mb-2\">\n              Health Conditions\n            </Label>\n            <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-4\">\n              Optional: Share any health conditions that might affect your diet\n            </p>\n            <Textarea\n              id=\"healthConditions\"\n              {...form.register(\"healthConditions\")}\n              placeholder=\"e.g., Type 2 diabetes, hypertension, PCOS...\"\n              className=\"min-h-[100px]\"\n              data-testid=\"input-health-conditions\"\n            />\n          </div>\n\n          {/* Work Pattern Section */}\n          <div className=\"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg\">\n            <div className=\"flex items-center gap-2 mb-2\">\n              <Briefcase className=\"h-5 w-5 text-purple-600\" />\n              <h2 className=\"text-lg font-semibold\">Work Pattern</h2>\n            </div>\n            <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-4\">\n              Help your AI Coach adapt meal timing and nutrition advice for your work schedule\n            </p>\n            \n            {/* Shift Type Selection */}\n            <div className=\"space-y-3 mb-6\">\n              <Label className=\"text-sm font-medium\">Default Shift Type</Label>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\n                {shiftTypes.map((shift) => (\n                  <button\n                    key={shift.value}\n                    type=\"button\"\n                    onClick={() => setSelectedShiftType(shift.value)}\n                    className={`p-4 rounded-xl text-left border-2 transition-all ${\n                      selectedShiftType === shift.value\n                        ? \"border-purple-600 bg-purple-50 dark:bg-purple-900/20\"\n                        : \"border-gray-200 dark:border-gray-700 hover:border-purple-300 dark:hover:border-purple-700\"\n                    }`}\n                    data-testid={`shift-type-${shift.value}`}\n                  >\n                    <div className=\"font-medium text-sm\">{shift.label}</div>\n                    <div className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                      {shift.description}\n                    </div>\n                  </button>\n                ))}\n              </div>\n            </div>\n\n            {/* Custom Shift Times (shown when custom is selected) */}\n            {selectedShiftType === \"custom\" && (\n              <div className=\"space-y-4 mb-6 p-4 bg-gray-50 dark:bg-gray-900/50 rounded-xl\">\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <Label htmlFor=\"customShiftStart\" className=\"text-sm flex items-center gap-1\">\n                      <Clock className=\"h-3 w-3\" />\n                      Shift Start\n                    </Label>\n                    <Input\n                      id=\"customShiftStart\"\n                      type=\"time\"\n                      {...form.register(\"customShiftStart\")}\n                      className=\"mt-1\"\n                      data-testid=\"input-shift-start\"\n                    />\n                  </div>\n                  <div>\n                    <Label htmlFor=\"customShiftEnd\" className=\"text-sm flex items-center gap-1\">\n                      <Clock className=\"h-3 w-3\" />\n                      Shift End\n                    </Label>\n                    <Input\n                      id=\"customShiftEnd\"\n                      type=\"time\"\n                      {...form.register(\"customShiftEnd\")}\n                      className=\"mt-1\"\n                      data-testid=\"input-shift-end\"\n                    />\n                  </div>\n                </div>\n\n                {/* Break Times */}\n                <div>\n                  <Label className=\"text-sm mb-2 block\">Break Times (Optional)</Label>\n                  <div className=\"space-y-2\">\n                    {breakTimes.map((breakTime, index) => (\n                      <div key={index} className=\"flex gap-2\">\n                        <Input\n                          type=\"time\"\n                          value={breakTime}\n                          onChange={(e) => updateBreakTime(index, e.target.value)}\n                          placeholder=\"HH:MM\"\n                          className=\"flex-1\"\n                          data-testid={`input-break-time-${index}`}\n                        />\n                        <Button\n                          type=\"button\"\n                          variant=\"outline\"\n                          size=\"sm\"\n                          onClick={() => removeBreakTime(index)}\n                          data-testid={`button-remove-break-${index}`}\n                        >\n                          Remove\n                        </Button>\n                      </div>\n                    ))}\n                    <Button\n                      type=\"button\"\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={addBreakTime}\n                      className=\"w-full\"\n                      data-testid=\"button-add-break\"\n                    >\n                      + Add Break Time\n                    </Button>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Daily Check-in Toggle */}\n            <div className=\"flex items-center justify-between p-4 bg-purple-50 dark:bg-purple-900/20 rounded-xl\">\n              <div className=\"flex-1 pr-4\">\n                <Label htmlFor=\"dailyCheckIn\" className=\"text-sm font-medium cursor-pointer\">\n                  Daily Shift Check-in\n                </Label>\n                <p className=\"text-xs text-gray-600 dark:text-gray-400 mt-1\">\n                  Get asked about your shift at the start of each day for personalized meal planning\n                </p>\n              </div>\n              <Switch\n                id=\"dailyCheckIn\"\n                checked={dailyCheckInEnabled}\n                onCheckedChange={setDailyCheckInEnabled}\n                data-testid=\"switch-daily-checkin\"\n              />\n            </div>\n          </div>\n\n          {/* Save Button */}\n          <Button\n            type=\"submit\"\n            disabled={saveMutation.isPending}\n            className=\"w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white h-12 rounded-xl text-lg font-semibold shadow-lg\"\n            data-testid=\"button-save-profile\"\n          >\n            {saveMutation.isPending ? (\n              <>\n                <Loader2 className=\"mr-2 h-5 w-5 animate-spin\" />\n                Saving...\n              </>\n            ) : (\n              <>\n                <Save className=\"mr-2 h-5 w-5\" />\n                Save Profile\n              </>\n            )}\n          </Button>\n        </form>\n      </motion.div>\n\n      {/* Dropdown Navigation */}\n      <DropdownNavigation />\n    </div>\n  );\n}\n\nexport default ProfilePage;\n","size_bytes":33263},"client/src/pages/ProgressPhotosPage.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { format, parseISO } from \"date-fns\";\nimport { Camera, ArrowLeft, TrendingDown, TrendingUp, Minus, ChevronLeft, ChevronRight, X } from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\";\nimport type { WeightEntry } from \"@shared/schema\";\nimport { motion, AnimatePresence } from \"framer-motion\";\n\nexport function ProgressPhotosPage() {\n  const [selectedPhotoIndex, setSelectedPhotoIndex] = useState<number | null>(null);\n  const [displayUnit, setDisplayUnit] = useState<\"kg\" | \"lb\">(\"kg\");\n\n  // Fetch weight entries with photos\n  const { data: weightEntries = [], isLoading } = useQuery<WeightEntry[]>({\n    queryKey: ['/api/weights'],\n    select: (data) => {\n      // Filter only entries with photos and sort by date (oldest first for timeline)\n      return (data || [])\n        .filter(entry => entry.imageUrl)\n        .sort((a, b) => new Date(a.loggedAt).getTime() - new Date(b.loggedAt).getTime());\n    },\n  });\n\n  const formatWeight = (weightGrams: number): string => {\n    if (displayUnit === \"kg\") {\n      return `${(weightGrams / 1000).toFixed(1)} kg`;\n    } else {\n      return `${(weightGrams / 453.592).toFixed(1)} lb`;\n    }\n  };\n\n  const formatDate = (dateInput: string | Date): string => {\n    try {\n      const date = typeof dateInput === 'string' ? parseISO(dateInput) : dateInput;\n      return format(date, 'MMM d, yyyy');\n    } catch {\n      return dateInput.toString();\n    }\n  };\n\n  const getWeightChange = (index: number): { change: number; trend: 'up' | 'down' | 'same' } | null => {\n    if (index === 0) return null;\n    const current = weightEntries[index].weightGrams;\n    const previous = weightEntries[index - 1].weightGrams;\n    const change = current - previous;\n    \n    if (Math.abs(change) < 100) return { change: 0, trend: 'same' }; // Less than 0.1kg difference\n    \n    return {\n      change: displayUnit === \"kg\" ? change / 1000 : change / 453.592,\n      trend: change > 0 ? 'up' : 'down'\n    };\n  };\n\n  const handlePreviousPhoto = () => {\n    if (selectedPhotoIndex !== null && selectedPhotoIndex > 0) {\n      setSelectedPhotoIndex(selectedPhotoIndex - 1);\n    }\n  };\n\n  const handleNextPhoto = () => {\n    if (selectedPhotoIndex !== null && selectedPhotoIndex < weightEntries.length - 1) {\n      setSelectedPhotoIndex(selectedPhotoIndex + 1);\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-purple-500 dark:bg-gray-900\">\n        <div className=\"max-w-4xl mx-auto p-4\">\n          {/* Header Skeleton */}\n          <div className=\"mb-6\">\n            <div className=\"h-8 w-48 bg-gray-200 dark:bg-gray-700 rounded animate-pulse mb-2\"></div>\n            <div className=\"h-4 w-64 bg-gray-200 dark:bg-gray-700 rounded animate-pulse\"></div>\n          </div>\n\n          {/* Timeline Skeleton */}\n          <div className=\"space-y-8\">\n            {[1, 2, 3].map((i) => (\n              <div key={i} className=\"flex gap-4 animate-pulse\">\n                <div className=\"w-32 h-32 bg-gray-200 dark:bg-gray-700 rounded-lg\"></div>\n                <div className=\"flex-1 space-y-2\">\n                  <div className=\"h-4 w-32 bg-gray-200 dark:bg-gray-700 rounded\"></div>\n                  <div className=\"h-6 w-24 bg-gray-200 dark:bg-gray-700 rounded\"></div>\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-purple-500 dark:bg-gray-900 pb-24\">\n      <div className=\"max-w-4xl mx-auto p-4\">\n        {/* Header */}\n        <div className=\"mb-6\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <Link href=\"/diary?tab=weight\">\n              <button\n                className=\"flex items-center space-x-2 text-white hover:text-purple-200 transition-colors\"\n                data-testid=\"button-back\"\n              >\n                <ArrowLeft className=\"h-5 w-5\" />\n                <span>Back</span>\n              </button>\n            </Link>\n\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => setDisplayUnit(displayUnit === \"kg\" ? \"lb\" : \"kg\")}\n              data-testid=\"button-toggle-unit\"\n            >\n              {displayUnit === \"kg\" ? \"kg\" : \"lb\"}\n            </Button>\n          </div>\n\n          <div className=\"flex items-center space-x-3 mb-2\">\n            <Camera className=\"h-8 w-8 text-white\" />\n            <h1 className=\"text-3xl font-bold text-white\">\n              Progress Photos\n            </h1>\n          </div>\n          <p className=\"text-white/90\">\n            Your visual transformation journey\n          </p>\n        </div>\n\n        {/* Timeline */}\n        {weightEntries.length === 0 ? (\n          <div className=\"text-center py-16\">\n            <Camera className=\"h-16 w-16 mx-auto text-gray-400 mb-4\" />\n            <h3 className=\"text-xl font-medium text-gray-900 dark:text-gray-100 mb-2\">\n              No Progress Photos Yet\n            </h3>\n            <p className=\"text-gray-600 dark:text-gray-400 mb-6\">\n              Start tracking your progress by adding photos when you log your weight\n            </p>\n            <Link href=\"/diary?tab=weight\">\n              <Button className=\"bg-gradient-to-r from-purple-600 to-violet-600 hover:from-purple-700 hover:to-violet-700 text-white\" data-testid=\"button-log-weight\">\n                Log Weight with Photo\n              </Button>\n            </Link>\n          </div>\n        ) : (\n          <div className=\"relative\">\n            {/* Timeline line */}\n            <div className=\"absolute left-4 md:left-6 top-0 bottom-0 w-0.5 bg-gradient-to-b from-purple-400 via-violet-400 to-purple-500\"></div>\n\n            {/* Timeline entries */}\n            <div className=\"space-y-8\" data-testid=\"timeline-entries\">\n              {weightEntries.map((entry, index) => {\n                const weightChange = getWeightChange(index);\n                const isFirst = index === 0;\n                const isLast = index === weightEntries.length - 1;\n\n                return (\n                  <motion.div\n                    key={entry.id}\n                    initial={{ opacity: 0, x: -20 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    transition={{ delay: index * 0.1 }}\n                    className=\"relative pl-12 md:pl-16\"\n                  >\n                    {/* Timeline dot */}\n                    <div className={`absolute left-2.5 md:left-4.5 w-4 h-4 rounded-full border-4 border-white dark:border-gray-900 ${\n                      isFirst ? 'bg-purple-400' : isLast ? 'bg-violet-500' : 'bg-purple-500'\n                    }`}></div>\n\n                    <div className=\"bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow\">\n                      <div className=\"md:flex\">\n                        {/* Photo */}\n                        <button\n                          onClick={() => entry.imageUrl ? setSelectedPhotoIndex(index) : undefined}\n                          className={`relative group w-full md:w-64 h-64 md:h-auto overflow-hidden ${!entry.imageUrl ? 'cursor-default' : ''}`}\n                          data-testid={`button-view-photo-${entry.id}`}\n                        >\n                          {entry.imageUrl ? (\n                            <>\n                              <img\n                                src={entry.imageUrl}\n                                alt={`Progress photo from ${formatDate(entry.loggedAt)}`}\n                                className=\"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300\"\n                              />\n                              <div className=\"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-all flex items-center justify-center\">\n                                <Camera className=\"h-8 w-8 text-white opacity-0 group-hover:opacity-100 transition-opacity\" />\n                              </div>\n                            </>\n                          ) : (\n                            <div className=\"w-full h-full bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-800 flex flex-col items-center justify-center\">\n                              <Camera className=\"h-12 w-12 text-gray-400 dark:text-gray-500 mb-2\" />\n                              <p className=\"text-sm text-gray-500 dark:text-gray-400\">No photo added</p>\n                            </div>\n                          )}\n                          \n                          {/* Badge for first/last */}\n                          {isFirst && (\n                            <div className=\"absolute top-2 left-2 bg-green-500 text-white text-xs font-bold px-2 py-1 rounded-full\">\n                              START\n                            </div>\n                          )}\n                          {isLast && (\n                            <div className=\"absolute top-2 left-2 bg-violet-500 text-white text-xs font-bold px-2 py-1 rounded-full\">\n                              LATEST\n                            </div>\n                          )}\n                        </button>\n\n                        {/* Info */}\n                        <div className=\"flex-1 p-6\">\n                          <div className=\"flex items-start justify-between mb-3\">\n                            <div>\n                              <p className=\"text-sm text-gray-500 dark:text-gray-400 mb-1\">\n                                {formatDate(entry.loggedAt)}\n                              </p>\n                              <p className=\"text-3xl font-bold text-purple-600 dark:text-purple-400\" data-testid={`text-weight-${entry.id}`}>\n                                {formatWeight(entry.weightGrams)}\n                              </p>\n                            </div>\n\n                            {/* Weight change indicator */}\n                            {weightChange && weightChange.trend !== 'same' && (\n                              <div className={`flex items-center space-x-1 px-3 py-1 rounded-full ${\n                                weightChange.trend === 'down' \n                                  ? 'bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400'\n                                  : 'bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400'\n                              }`}>\n                                {weightChange.trend === 'down' ? (\n                                  <TrendingDown className=\"h-4 w-4\" />\n                                ) : (\n                                  <TrendingUp className=\"h-4 w-4\" />\n                                )}\n                                <span className=\"text-sm font-semibold\">\n                                  {Math.abs(weightChange.change).toFixed(1)} {displayUnit}\n                                </span>\n                              </div>\n                            )}\n                          </div>\n\n                          {entry.notes && (\n                            <div className=\"mt-4 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg\">\n                              <p className=\"text-sm text-gray-700 dark:text-gray-300\" data-testid={`text-notes-${entry.id}`}>\n                                {entry.notes}\n                              </p>\n                            </div>\n                          )}\n\n                          {/* Stats */}\n                          <div className=\"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                            <div className=\"flex items-center justify-between text-sm\">\n                              <span className=\"text-gray-500 dark:text-gray-400\">\n                                {index === 0 ? 'Starting point' : `${index + 1} of ${weightEntries.length}`}\n                              </span>\n                              {!isFirst && (\n                                <span className=\"text-gray-500 dark:text-gray-400\">\n                                  {Math.abs((entry.weightGrams - weightEntries[0].weightGrams) / (displayUnit === \"kg\" ? 1000 : 453.592)).toFixed(1)} {displayUnit} from start\n                                </span>\n                              )}\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </motion.div>\n                );\n              })}\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Full-screen photo viewer */}\n      <Dialog open={selectedPhotoIndex !== null} onOpenChange={(open) => !open && setSelectedPhotoIndex(null)}>\n        <DialogContent className=\"max-w-6xl h-[90vh] p-0\" data-testid=\"dialog-photo-viewer\">\n          <AnimatePresence mode=\"wait\">\n            {selectedPhotoIndex !== null && weightEntries[selectedPhotoIndex] && (\n              <motion.div\n                key={selectedPhotoIndex}\n                initial={{ opacity: 0 }}\n                animate={{ opacity: 1 }}\n                exit={{ opacity: 0 }}\n                className=\"flex flex-col h-full\"\n              >\n                {/* Header */}\n                <div className=\"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700\">\n                  <div>\n                    <p className=\"font-semibold text-lg\">\n                      {formatDate(weightEntries[selectedPhotoIndex].loggedAt)}\n                    </p>\n                    <p className=\"text-2xl font-bold text-purple-600 dark:text-purple-400\">\n                      {formatWeight(weightEntries[selectedPhotoIndex].weightGrams)}\n                    </p>\n                  </div>\n                  <button\n                    onClick={() => setSelectedPhotoIndex(null)}\n                    className=\"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors\"\n                    data-testid=\"button-close-viewer\"\n                  >\n                    <X className=\"h-6 w-6\" />\n                  </button>\n                </div>\n\n                {/* Photo with swipe support */}\n                <div className=\"flex-1 relative bg-black flex items-center justify-center overflow-hidden\">\n                  <motion.img\n                    key={selectedPhotoIndex}\n                    src={weightEntries[selectedPhotoIndex].imageUrl!}\n                    alt=\"Progress photo\"\n                    className=\"max-w-full max-h-full object-contain cursor-grab active:cursor-grabbing\"\n                    data-testid=\"img-fullscreen\"\n                    drag=\"x\"\n                    dragElastic={0.7}\n                    dragMomentum={false}\n                    onDragEnd={(e, { offset, velocity }) => {\n                      const swipeThreshold = 50;\n                      const swipeVelocityThreshold = 500;\n                      \n                      // Swipe left (next photo)\n                      if (offset.x < -swipeThreshold || velocity.x < -swipeVelocityThreshold) {\n                        handleNextPhoto();\n                      }\n                      // Swipe right (previous photo)\n                      else if (offset.x > swipeThreshold || velocity.x > swipeVelocityThreshold) {\n                        handlePreviousPhoto();\n                      }\n                    }}\n                    initial={{ opacity: 0, scale: 0.95 }}\n                    animate={{ opacity: 1, scale: 1 }}\n                    exit={{ opacity: 0, scale: 0.95 }}\n                    transition={{ type: \"spring\", stiffness: 300, damping: 30 }}\n                  />\n\n                  {/* Navigation arrows */}\n                  {selectedPhotoIndex > 0 && (\n                    <button\n                      onClick={handlePreviousPhoto}\n                      className=\"absolute left-4 top-1/2 -translate-y-1/2 bg-black/50 hover:bg-black/70 text-white p-3 rounded-full transition-colors\"\n                      data-testid=\"button-previous-photo\"\n                    >\n                      <ChevronLeft className=\"h-6 w-6\" />\n                    </button>\n                  )}\n                  {selectedPhotoIndex < weightEntries.length - 1 && (\n                    <button\n                      onClick={handleNextPhoto}\n                      className=\"absolute right-4 top-1/2 -translate-y-1/2 bg-black/50 hover:bg-black/70 text-white p-3 rounded-full transition-colors\"\n                      data-testid=\"button-next-photo\"\n                    >\n                      <ChevronRight className=\"h-6 w-6\" />\n                    </button>\n                  )}\n\n                  {/* Counter */}\n                  <div className=\"absolute bottom-4 left-1/2 -translate-x-1/2 bg-black/70 text-white px-4 py-2 rounded-full text-sm\">\n                    {selectedPhotoIndex + 1} / {weightEntries.length}\n                  </div>\n                </div>\n\n                {/* Notes */}\n                {weightEntries[selectedPhotoIndex].notes && (\n                  <div className=\"p-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800\">\n                    <p className=\"text-gray-700 dark:text-gray-300\">\n                      {weightEntries[selectedPhotoIndex].notes}\n                    </p>\n                  </div>\n                )}\n              </motion.div>\n            )}\n          </AnimatePresence>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","size_bytes":17538},"server/personality-manager.ts":{"content":"// Personality Manager for AI Coach\n// Manages the different personality types and their unique characteristics\n\nexport type PersonalityType = \"military\" | \"gym_bro\" | \"zen\" | \"clinical\" | \"dark_humour\" | \"alex\";\n\nexport interface PersonalityConfig {\n  id: PersonalityType;\n  name: string;\n  description: string;\n  systemPromptAddition: string;\n  greetings: string[];\n  encouragements: string[];\n  checkIns: string[];\n  toughLove: string[];\n  celebrationPhrases: string[];\n  responseStyle: {\n    tone: string;\n    formality: string;\n    emoji: boolean;\n    directness: string;\n  };\n}\n\nexport const PERSONALITIES: Record<PersonalityType, PersonalityConfig> = {\n  military: {\n    id: \"military\",\n    name: \"Military Drill Sergeant\",\n    description: \"Intense, direct, no excuses. Push you to your limits.\",\n    systemPromptAddition: `\nYou are a MILITARY DRILL SERGEANT coaching this recruit. Your communication style:\n- DIRECT and COMMANDING\n- NO EXCUSES accepted\n- High accountability and discipline\n- Use military terminology when appropriate (\"soldier\", \"mission\", \"objective\")\n- Short, punchy sentences\n- Zero tolerance for weakness or self-pity\n- Push hard but care deeply about results\n- Call out BS immediately\n- Celebrate victories like a commander praising a successful mission\n    `,\n    greetings: [\n      \"LISTEN UP! Ready to report your progress?\",\n      \"At ease, soldier. What's your status today?\",\n      \"Drop and give me your day's rundown. Move it!\",\n      \"Time to check in. No excuses, just facts.\",\n    ],\n    encouragements: [\n      \"OUTSTANDING! Keep that momentum!\",\n      \"THAT'S what I'm talking about! HOOAH!\",\n      \"You're crushing it, soldier!\",\n      \"Now THAT'S discipline in action!\",\n    ],\n    checkIns: [\n      \"Soldier, I need a status report. How's the mission going?\",\n      \"Give me your sitrep. What's happening out there?\",\n      \"Haven't heard from you. Everything under control?\",\n    ],\n    toughLove: [\n      \"That's NOT acceptable. You know better.\",\n      \"WEAK effort. I know you can do better than this.\",\n      \"This isn't boot camp. This is YOUR life. Act like it!\",\n      \"Drop the excuses. What's the REAL issue here?\",\n    ],\n    celebrationPhrases: [\n      \"MISSION ACCOMPLISHED!\",\n      \"HOOAH! That's what I call victory!\",\n      \"Objective CRUSHED!\",\n    ],\n    responseStyle: {\n      tone: \"commanding\",\n      formality: \"structured\",\n      emoji: false,\n      directness: \"extremely direct\",\n    },\n  },\n\n  gym_bro: {\n    id: \"gym_bro\",\n    name: \"Friendly Gym Bro\",\n    description: \"Casual, hyped energy. Like your best workout buddy.\",\n    systemPromptAddition: `\nYou are a FRIENDLY GYM BRO coaching your buddy. Your communication style:\n- Super casual and relaxed (\"bro\", \"dude\", \"man\")\n- HIGH ENERGY and enthusiastic\n- Use gym/fitness slang naturally\n- Hyped about gains and progress\n- Supportive but also pumps you up\n- Relates everything to gym/fitness analogies\n- Uses emojis occasionally (ðŸ’ªðŸ”¥ðŸ‘Š)\n- Bros don't let bros skip leg day (or meals)\n- Celebrate wins like spotting a new PR\n    `,\n    greetings: [\n      \"Yo bro! How's it going today?\",\n      \"What's up man! Ready to crush it?\",\n      \"Hey dude! Let's talk gains today.\",\n      \"Brooo! What's happening in your world?\",\n    ],\n    encouragements: [\n      \"Let's GOOOO! ðŸ’ª\",\n      \"That's what I'm talking about! You're killing it!\",\n      \"YESSS BRO! Keep that energy up!\",\n      \"Dude you're absolutely crushing it right now!\",\n    ],\n    checkIns: [\n      \"Yo! Haven't heard from you in a bit. Everything good?\",\n      \"What's up bro? How's life treating you?\",\n      \"Hey man, just checking in. What's the vibe today?\",\n    ],\n    toughLove: [\n      \"C'mon bro, you know you can do better than this.\",\n      \"Dude... that's not it. Let's get back on track.\",\n      \"Man, you're better than this. Let's lock in!\",\n      \"Bro to bro - what's really going on?\",\n    ],\n    celebrationPhrases: [\n      \"LET'S GOOOOO! ðŸ”¥\",\n      \"THAT'S MY BRO! ðŸ’ª\",\n      \"CRUSHING IT!\",\n    ],\n    responseStyle: {\n      tone: \"enthusiastic\",\n      formality: \"very casual\",\n      emoji: true,\n      directness: \"casual but honest\",\n    },\n  },\n\n  zen: {\n    id: \"zen\",\n    name: \"Zen Wellness Coach\",\n    description: \"Calm, self-care focused. Gentle guidance and mindfulness.\",\n    systemPromptAddition: `\nYou are a ZEN WELLNESS COACH guiding this person. Your communication style:\n- CALM, GENTLE, and COMPASSIONATE\n- Focus on SELF-CARE and holistic wellness\n- Mindfulness and balance are key\n- Never rushed or aggressive\n- Acknowledge emotions and struggles with empathy\n- Use wellness/meditation language\n- Encourage self-compassion\n- Progress is a journey, not a race\n- Celebrate small wins mindfully\n- Address stress, sleep, mental health naturally\n    `,\n    greetings: [\n      \"Hello friend. How are you feeling today?\",\n      \"Welcome. Let's check in with yourself. How's your energy?\",\n      \"Greetings. Take a breath and tell me how you're doing.\",\n      \"Hi there. What's on your mind today?\",\n    ],\n    encouragements: [\n      \"Beautiful progress. Be proud of yourself.\",\n      \"You're honoring your commitment to yourself. Well done.\",\n      \"This is wonderful growth. Notice how far you've come.\",\n      \"You're showing up for yourself. That's powerful.\",\n    ],\n    checkIns: [\n      \"I'm thinking of you. How has your journey been lately?\",\n      \"It's been a while. How are you feeling in this moment?\",\n      \"Checking in with compassion. What's your current state?\",\n    ],\n    toughLove: [\n      \"I sense you're being hard on yourself. What's beneath this struggle?\",\n      \"Let's pause. What do you truly need right now?\",\n      \"This pattern... have you noticed it? Let's explore gently.\",\n      \"I invite you to reflect: what's holding you back from your wellness?\",\n    ],\n    celebrationPhrases: [\n      \"Inner peace achieved ðŸ•‰ï¸\",\n      \"Balance restored\",\n      \"Wellness flourishing\",\n    ],\n    responseStyle: {\n      tone: \"calm and nurturing\",\n      formality: \"gentle\",\n      emoji: true,\n      directness: \"soft but clear\",\n    },\n  },\n\n  clinical: {\n    id: \"clinical\",\n    name: \"Clinical Expert\",\n    description: \"Medical, structured, evidence-based. Professional guidance.\",\n    systemPromptAddition: `\nYou are a CLINICAL HEALTH EXPERT coaching this client. Your communication style:\n- PROFESSIONAL and EVIDENCE-BASED\n- Use proper medical/nutritional terminology\n- Structured and systematic approach\n- Reference health data and metrics\n- Objective and analytical\n- Focus on sustainable, medically sound practices\n- Educate with facts and research\n- Address health conditions appropriately\n- No fads or pseudoscience\n- Professional but approachable\n    `,\n    greetings: [\n      \"Good day. Let's review your health metrics.\",\n      \"Hello. How have you been progressing with your health goals?\",\n      \"Welcome. Let's assess your current status.\",\n      \"Greetings. Time for your wellness check-in.\",\n    ],\n    encouragements: [\n      \"Excellent adherence to your plan. This is clinically significant progress.\",\n      \"Your metrics show positive trends. Well executed.\",\n      \"Strong compliance. This approach is yielding results.\",\n      \"Impressive consistency. Your data reflects solid improvement.\",\n    ],\n    checkIns: [\n      \"It's time for a status update. How are your health parameters?\",\n      \"I'd like to review your recent progress. What's your current state?\",\n      \"Checking in on your wellness protocol. Any concerns to address?\",\n    ],\n    toughLove: [\n      \"This deviation from your plan is concerning. Let's identify the barriers.\",\n      \"Your data suggests inconsistency. We need to address this systematically.\",\n      \"I'm seeing patterns that require intervention. Let's discuss frankly.\",\n      \"This isn't sustainable. Let's recalibrate your approach.\",\n    ],\n    celebrationPhrases: [\n      \"Clinical objective achieved\",\n      \"Health markers optimized\",\n      \"Protocol successful\",\n    ],\n    responseStyle: {\n      tone: \"professional\",\n      formality: \"structured\",\n      emoji: false,\n      directness: \"clinically direct\",\n    },\n  },\n\n  dark_humour: {\n    id: \"dark_humour\",\n    name: \"Dark Humour / Banter Mode\",\n    description: \"Sarcastic, entertaining, cheeky. Makes health fun with wit.\",\n    systemPromptAddition: `\nYou are a WITTY COACH with DARK HUMOUR coaching this person. Your communication style:\n- SARCASTIC but LOVING\n- Use British/dry humour and banter\n- Roast gently but make them laugh\n- Self-deprecating jokes welcome\n- Never mean-spirited, always playful\n- Call out absurdity hilariously\n- Make mundane stuff entertaining\n- Pop culture references\n- Memes and internet culture vibes\n- Keep it cheeky but supportive\n- Balance roasting with genuine care\n    `,\n    greetings: [\n      \"Well well well... look who's back. Ready to pretend you'll actually stick to your goals this time? ðŸ˜\",\n      \"Ah, you've returned. What's the excuse today?\",\n      \"Hello there. Come to confess your crimes against nutrition?\",\n      \"Oh good, you're alive. Was starting to wonder.\",\n    ],\n    encouragements: [\n      \"Wow, you actually did it. I'm genuinely shocked. Proud, but shocked.\",\n      \"Look at you being all responsible and stuff. Who are you and what did you do with the old you?\",\n      \"Okay okay, I'll admit it - that's actually impressive. Don't let it go to your head.\",\n      \"Not bad... not bad at all. I might have to retire my roasts at this rate.\",\n    ],\n    checkIns: [\n      \"It's been suspiciously quiet. Either you're crushing it or hiding something. Which is it?\",\n      \"Haven't heard from you. Should I be worried or impressed?\",\n      \"So... are we doing this or have you ghosted your own health? ðŸ‘»\",\n    ],\n    toughLove: [\n      \"Mate... REALLY? That's what we're doing now?\",\n      \"I mean, you COULD have done that, or you could've chosen literally anything better.\",\n      \"Fascinating choice. By fascinating I mean terrible. Let's fix this.\",\n      \"Not gonna lie, that's a proper mess. But hey, at least you're consistent! ðŸ™ƒ\",\n    ],\n    celebrationPhrases: [\n      \"LEGEND STATUS UNLOCKED ðŸ†\",\n      \"Absolute madness! (In a good way)\",\n      \"Chef's kiss ðŸ‘¨â€ðŸ³ðŸ’‹\",\n    ],\n    responseStyle: {\n      tone: \"sarcastic but warm\",\n      formality: \"very casual\",\n      emoji: true,\n      directness: \"brutally honest but funny\",\n    },\n  },\n\n  alex: {\n    id: \"alex\",\n    name: \"Alex\",\n    description: \"Army veteran, mum of 3. Brutally honest, sarcastic, weirdly motivating.\",\n    systemPromptAddition: `\nYou are ALEX, a former Army soldier turned nutrition coach. Your communication style:\n- BRUTALLY HONEST but WEIRDLY MOTIVATING\n- Sarcastic and self-deprecating (you mock yourself before anyone else can)\n- NO EXCUSES, NO SHORTCUTS, NO \"I'll start Monday\"\n- Reference your Army background naturally when it fits\n- Talk about \"the gremlins\" (your 3 kids) and how they \"ruined your metabolism\"\n- Use savage humour to call out BS\n- Tired of people blaming bread for their problems\n- Army discipline meets chaotic-household-survivor energy\n- Mix tough love with dark comedy\n- If something needs doing - you do it\n- Weirdly wholesome despite the sarcasm\n- Make grown adults thank you for the harsh truth\n- Keep it real, keep it funny, keep them moving forward\n    `,\n    greetings: [\n      \"Right then, let's see what you've been up to. And please don't say 'finding yourself' - I'm still looking for the old me pre-kids.\",\n      \"Alright, report in. What's the damage today?\",\n      \"Hello. Before you start - no, bread isn't the enemy. You are. Let's chat.\",\n      \"Oh good, you're here. Was starting to think you'd ghosted me like my pre-baby abs.\",\n    ],\n    encouragements: [\n      \"See? You CAN do it when you stop overthinking it. Well done, actually proud of you.\",\n      \"Bloody hell, look at you go! The gremlins haven't even managed this level of consistency.\",\n      \"Right, I'll give you that one. Solid work. Don't get cocky though.\",\n      \"Actually impressive. And I don't say that lightly - my standards are higher than my patience.\",\n    ],\n    checkIns: [\n      \"Haven't heard from you. Either crushing it or hiding under a duvet. Which one?\",\n      \"Checking in. How's it going? And I mean really - not the Instagram version.\",\n      \"You've been quiet. Should I be worried or are you just busy adulting?\",\n    ],\n    toughLove: [\n      \"Right... so we're doing this now? The excuses? Come on, you're better than this rubbish.\",\n      \"I've heard this story before. From myself. In 2018. It didn't work then either. What's REALLY going on?\",\n      \"Nope. Not having it. Drop the nonsense and tell me what the actual issue is.\",\n      \"Look - discipline chose YOU, not the other way round. So what are we going to do about this mess?\",\n    ],\n    celebrationPhrases: [\n      \"MISSION COMPLETE! (Army habits die hard)\",\n      \"Absolutely smashed it!\",\n      \"Right, you're officially my new favourite. Don't tell the others.\",\n    ],\n    responseStyle: {\n      tone: \"sarcastic but motivating\",\n      formality: \"casual military\",\n      emoji: false,\n      directness: \"brutally honest\",\n    },\n  },\n};\n\nexport class PersonalityManager {\n  /**\n   * Get personality configuration\n   */\n  getPersonality(type: PersonalityType): PersonalityConfig {\n    return PERSONALITIES[type];\n  }\n\n  /**\n   * Get all available personalities\n   */\n  getAllPersonalities(): PersonalityConfig[] {\n    return Object.values(PERSONALITIES);\n  }\n\n  /**\n   * Get a random greeting for the personality\n   */\n  getGreeting(type: PersonalityType): string {\n    const personality = this.getPersonality(type);\n    return personality.greetings[Math.floor(Math.random() * personality.greetings.length)];\n  }\n\n  /**\n   * Get a random encouragement for the personality\n   */\n  getEncouragement(type: PersonalityType): string {\n    const personality = this.getPersonality(type);\n    return personality.encouragements[Math.floor(Math.random() * personality.encouragements.length)];\n  }\n\n  /**\n   * Get a random check-in message for the personality\n   */\n  getCheckIn(type: PersonalityType): string {\n    const personality = this.getPersonality(type);\n    return personality.checkIns[Math.floor(Math.random() * personality.checkIns.length)];\n  }\n\n  /**\n   * Get a random tough love message for the personality\n   */\n  getToughLove(type: PersonalityType): string {\n    const personality = this.getPersonality(type);\n    return personality.toughLove[Math.floor(Math.random() * personality.toughLove.length)];\n  }\n\n  /**\n   * Build complete system prompt with personality\n   */\n  buildSystemPrompt(type: PersonalityType, userName: string, context: {\n    age?: number;\n    occupation?: string;\n    interests?: string[];\n    goals?: {\n      fitness?: string;\n      stress?: string;\n      sleep?: string;\n      mentalHealth?: string;\n    };\n    recentMood?: string;\n    profile?: any;\n  }): string {\n    const personality = this.getPersonality(type);\n    \n    const basePrompt = `You are an AI Health & Wellness Coach for ${userName}. Your role is to provide comprehensive support across ALL aspects of their life - nutrition, fitness, mental health, stress management, sleep, work-life balance, and general wellbeing.\n\n${personality.systemPromptAddition}\n\nIMPORTANT CONTEXT ABOUT ${userName.toUpperCase()}:\n${context.age ? `- Age: ${context.age}` : \"\"}\n${context.occupation ? `- Occupation: ${context.occupation}` : \"\"}\n${context.interests && context.interests.length > 0 ? `- Interests: ${context.interests.join(\", \")}` : \"\"}\n${context.profile?.lifestyleDetails ? `- Lifestyle: ${context.profile.lifestyleDetails}` : \"\"}\n${context.profile?.workSchedule ? `- Work Schedule: ${context.profile.workSchedule}` : \"\"}\n${context.profile?.dietaryRequirements && context.profile.dietaryRequirements.length > 0 ? `- Dietary Requirements: ${context.profile.dietaryRequirements.join(\", \")}` : \"\"}\n${context.profile?.allergies && context.profile.allergies.length > 0 ? `- Allergies: ${context.profile.allergies.join(\", \")}` : \"\"}\n${context.profile?.healthConditions ? `- Health Conditions: ${context.profile.healthConditions}` : \"\"}\n\nTHEIR GOALS:\n${context.goals?.fitness ? `- Fitness: ${context.goals.fitness}` : \"\"}\n${context.goals?.stress ? `- Stress Management: ${context.goals.stress}` : \"\"}\n${context.goals?.sleep ? `- Sleep: ${context.goals.sleep}` : \"\"}\n${context.goals?.mentalHealth ? `- Mental Health: ${context.goals.mentalHealth}` : \"\"}\n\n${context.recentMood ? `CURRENT MOOD: ${context.recentMood} - Adapt your tone accordingly while staying in character.` : \"\"}\n\nCONVERSATION RULES:\n1. You can discuss ANY topic - work stress, relationships (non-therapeutic), hobbies, life events, gym progress, mental health, sleep issues, etc.\n2. Always anchor advice back to health/wellness when relevant\n3. Use their name (${userName}) naturally in conversation\n4. Remember their interests and reference them\n5. Be a real companion, not just a nutrition calculator\n6. If they seem tired/stressed/low, acknowledge it and adapt while staying in your personality\n7. If they're motivated/excited, match that energy (in your style)\n8. NEVER suggest foods that violate their dietary requirements or allergies\n9. Address their health conditions appropriately in all advice\n\nStay in character as: ${personality.name}\nResponse style: ${personality.responseStyle.tone}, ${personality.responseStyle.formality}, ${personality.responseStyle.emoji ? 'use emojis' : 'no emojis'}, ${personality.responseStyle.directness}\n`;\n\n    return basePrompt;\n  }\n}\n\nexport const personalityManager = new PersonalityManager();\n","size_bytes":17633},"server/coach-memory-service.ts":{"content":"import { db } from \"./db\";\nimport { aiCoachMemory, userProfiles } from \"@shared/schema\";\nimport type { InsertAiCoachMemory, UpdateAiCoachMemory, AiCoachMemory } from \"@shared/schema\";\nimport { eq } from \"drizzle-orm\";\n\nexport class CoachMemoryService {\n  /**\n   * Get or create coach memory for a user\n   */\n  async getOrCreateMemory(userId: string): Promise<AiCoachMemory> {\n    const existing = await db.query.aiCoachMemory.findFirst({\n      where: eq(aiCoachMemory.userId, userId),\n    });\n\n    if (existing) {\n      return existing;\n    }\n\n    // Create default memory with zen personality\n    const [newMemory] = await db\n      .insert(aiCoachMemory)\n      .values({\n        userId,\n        selectedPersonality: \"zen\",\n        motivationalStyle: \"positive\",\n        interests: [],\n        conversationTopics: [],\n        recentMoods: [],\n      })\n      .returning();\n\n    return newMemory;\n  }\n\n  /**\n   * Update coach memory for a user\n   */\n  async updateMemory(userId: string, updates: UpdateAiCoachMemory): Promise<AiCoachMemory> {\n    const [updated] = await db\n      .update(aiCoachMemory)\n      .set({\n        ...updates,\n        updatedAt: new Date(),\n      })\n      .where(eq(aiCoachMemory.userId, userId))\n      .returning();\n\n    return updated;\n  }\n\n  /**\n   * Update last interaction timestamp\n   */\n  async updateLastInteraction(userId: string): Promise<void> {\n    await db\n      .update(aiCoachMemory)\n      .set({\n        lastInteraction: new Date(),\n      })\n      .where(eq(aiCoachMemory.userId, userId));\n  }\n\n  /**\n   * Add mood entry to recent moods (keeps last 30 entries)\n   */\n  async addMoodEntry(userId: string, mood: string, sentiment: number): Promise<void> {\n    const memory = await this.getOrCreateMemory(userId);\n    const recentMoods = memory.recentMoods || [];\n    \n    const newMood = {\n      date: new Date().toISOString(),\n      mood,\n      sentiment,\n    };\n\n    // Keep only last 30 mood entries\n    const updatedMoods = [newMood, ...recentMoods].slice(0, 30);\n\n    await db\n      .update(aiCoachMemory)\n      .set({\n        recentMoods: updatedMoods,\n        updatedAt: new Date(),\n      })\n      .where(eq(aiCoachMemory.userId, userId));\n  }\n\n  /**\n   * Add conversation topic to recent topics (keeps last 10)\n   */\n  async addConversationTopic(userId: string, topic: string): Promise<void> {\n    const memory = await this.getOrCreateMemory(userId);\n    const topics = memory.conversationTopics || [];\n\n    // Avoid duplicates and keep only last 10 topics\n    const updatedTopics = [topic, ...topics.filter(t => t !== topic)].slice(0, 10);\n\n    await db\n      .update(aiCoachMemory)\n      .set({\n        conversationTopics: updatedTopics,\n        updatedAt: new Date(),\n      })\n      .where(eq(aiCoachMemory.userId, userId));\n  }\n\n  /**\n   * Get comprehensive user context for AI (combines memory + profile)\n   */\n  async getUserContext(userId: string): Promise<{\n    memory: AiCoachMemory;\n    profile: any;\n    userName: string;\n  }> {\n    const memory = await this.getOrCreateMemory(userId);\n    \n    // Get user profile for additional context\n    const profile = await db.query.userProfiles.findFirst({\n      where: eq(userProfiles.userId, userId),\n    });\n\n    // Determine preferred name for AI to use\n    const userName = profile?.nickname || profile?.name || \"friend\";\n\n    return {\n      memory,\n      profile,\n      userName,\n    };\n  }\n\n  /**\n   * Extract and update user details from conversation\n   * (Called after each AI interaction to learn from natural conversation)\n   */\n  async extractAndUpdateFromConversation(userId: string, userMessage: string): Promise<void> {\n    // Simple keyword extraction (can be enhanced with NLP later)\n    const lowerMessage = userMessage.toLowerCase();\n    \n    // Detect interests\n    const interestKeywords = [\n      { keyword: \"gym\", interest: \"gym\" },\n      { keyword: \"workout\", interest: \"gym\" },\n      { keyword: \"football\", interest: \"football\" },\n      { keyword: \"soccer\", interest: \"football\" },\n      { keyword: \"music\", interest: \"music\" },\n      { keyword: \"gaming\", interest: \"gaming\" },\n      { keyword: \"video game\", interest: \"gaming\" },\n      { keyword: \"kids\", interest: \"kids\" },\n      { keyword: \"children\", interest: \"kids\" },\n      { keyword: \"car\", interest: \"cars\" },\n      { keyword: \"mental health\", interest: \"mental health\" },\n      { keyword: \"meditation\", interest: \"mindfulness\" },\n    ];\n\n    const memory = await this.getOrCreateMemory(userId);\n    const currentInterests = memory.interests || [];\n    let newInterests = [...currentInterests];\n\n    for (const { keyword, interest } of interestKeywords) {\n      if (lowerMessage.includes(keyword) && !currentInterests.includes(interest)) {\n        newInterests.push(interest);\n      }\n    }\n\n    // Update if new interests found\n    if (newInterests.length > currentInterests.length) {\n      await this.updateMemory(userId, {\n        interests: newInterests,\n      });\n    }\n\n    // Extract work schedule hints\n    if (lowerMessage.includes(\"night shift\") || lowerMessage.includes(\"night shifts\")) {\n      await this.updateMemory(userId, {\n        workSchedule: \"night shifts\",\n      });\n    } else if (lowerMessage.includes(\"day shift\") || lowerMessage.includes(\"day shifts\")) {\n      await this.updateMemory(userId, {\n        workSchedule: \"day shifts\",\n      });\n    }\n\n    // Extract occupation hints\n    if (lowerMessage.includes(\"nurse\") || lowerMessage.includes(\"nursing\")) {\n      await this.updateMemory(userId, {\n        occupation: \"nurse\",\n      });\n    } else if (lowerMessage.includes(\"military\") || lowerMessage.includes(\"army\") || lowerMessage.includes(\"veteran\")) {\n      await this.updateMemory(userId, {\n        lifestyleDetails: \"ex-military\",\n      });\n    }\n  }\n}\n\nexport const coachMemoryService = new CoachMemoryService();\n","size_bytes":5829},"server/objectAcl.ts":{"content":"// Referenced from blueprint: javascript_object_storage\nimport { File } from \"@google-cloud/storage\";\n\nconst ACL_POLICY_METADATA_KEY = \"custom:aclPolicy\";\n\nexport enum ObjectAccessGroupType {}\n\nexport interface ObjectAccessGroup {\n  type: ObjectAccessGroupType;\n  id: string;\n}\n\nexport enum ObjectPermission {\n  READ = \"read\",\n  WRITE = \"write\",\n}\n\nexport interface ObjectAclRule {\n  group: ObjectAccessGroup;\n  permission: ObjectPermission;\n}\n\nexport interface ObjectAclPolicy {\n  owner: string;\n  visibility: \"public\" | \"private\";\n  aclRules?: Array<ObjectAclRule>;\n}\n\nfunction isPermissionAllowed(\n  requested: ObjectPermission,\n  granted: ObjectPermission,\n): boolean {\n  if (requested === ObjectPermission.READ) {\n    return [ObjectPermission.READ, ObjectPermission.WRITE].includes(granted);\n  }\n  return granted === ObjectPermission.WRITE;\n}\n\nabstract class BaseObjectAccessGroup implements ObjectAccessGroup {\n  constructor(\n    public readonly type: ObjectAccessGroupType,\n    public readonly id: string,\n  ) {}\n\n  public abstract hasMember(userId: string): Promise<boolean>;\n}\n\nfunction createObjectAccessGroup(\n  group: ObjectAccessGroup,\n): BaseObjectAccessGroup {\n  switch (group.type) {\n    default:\n      throw new Error(`Unknown access group type: ${group.type}`);\n  }\n}\n\nexport async function setObjectAclPolicy(\n  objectFile: File,\n  aclPolicy: ObjectAclPolicy,\n): Promise<void> {\n  const [exists] = await objectFile.exists();\n  if (!exists) {\n    throw new Error(`Object not found: ${objectFile.name}`);\n  }\n\n  await objectFile.setMetadata({\n    metadata: {\n      [ACL_POLICY_METADATA_KEY]: JSON.stringify(aclPolicy),\n    },\n  });\n}\n\nexport async function getObjectAclPolicy(\n  objectFile: File,\n): Promise<ObjectAclPolicy | null> {\n  const [metadata] = await objectFile.getMetadata();\n  const aclPolicy = metadata?.metadata?.[ACL_POLICY_METADATA_KEY];\n  if (!aclPolicy) {\n    return null;\n  }\n  return JSON.parse(aclPolicy as string);\n}\n\nexport async function canAccessObject({\n  userId,\n  objectFile,\n  requestedPermission,\n}: {\n  userId?: string;\n  objectFile: File;\n  requestedPermission: ObjectPermission;\n}): Promise<boolean> {\n  const aclPolicy = await getObjectAclPolicy(objectFile);\n  if (!aclPolicy) {\n    return false;\n  }\n\n  if (\n    aclPolicy.visibility === \"public\" &&\n    requestedPermission === ObjectPermission.READ\n  ) {\n    return true;\n  }\n\n  if (!userId) {\n    return false;\n  }\n\n  if (aclPolicy.owner === userId) {\n    return true;\n  }\n\n  for (const rule of aclPolicy.aclRules || []) {\n    const accessGroup = createObjectAccessGroup(rule.group);\n    if (\n      (await accessGroup.hasMember(userId)) &&\n      isPermissionAllowed(requestedPermission, rule.permission)\n    ) {\n      return true;\n    }\n  }\n\n  return false;\n}\n","size_bytes":2763},"client/src/pages/CoachPersonalityPage.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Link } from \"wouter\";\nimport { ArrowLeft, Sparkles, Check } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport type { AiCoachMemory } from \"@shared/schema\";\nimport { motion } from \"framer-motion\";\n\ninterface Personality {\n  id: string;\n  name: string;\n  description: string;\n  responseStyle: {\n    tone: string;\n    formality: string;\n    emoji: boolean;\n    directness: string;\n  };\n}\n\nexport function CoachPersonalityPage() {\n  const { toast } = useToast();\n  const [selectedPersonality, setSelectedPersonality] = useState<string | null>(null);\n\n  // Fetch user's current personality\n  const { data: memory, isLoading: memoryLoading } = useQuery<AiCoachMemory>({\n    queryKey: ['/api/coach-memory'],\n  });\n\n  // Fetch available personalities\n  const { data: personalities = [], isLoading: personalitiesLoading } = useQuery<Personality[]>({\n    queryKey: ['/api/coach-personalities'],\n  });\n\n  // Update personality mutation\n  const updatePersonality = useMutation({\n    mutationFn: async (personalityId: string) => {\n      return apiRequest('/api/coach-memory', {\n        method: 'PATCH',\n        body: JSON.stringify({ selectedPersonality: personalityId }),\n        headers: { 'Content-Type': 'application/json' },\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/coach-memory'] });\n      toast({\n        title: \"Personality Updated!\",\n        description: \"Your AI coach has adopted a new personality.\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to update personality. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const currentPersonality = memory?.selectedPersonality || \"zen\";\n\n  // Initialize selected personality when data loads\n  useEffect(() => {\n    if (memory?.selectedPersonality && selectedPersonality === null) {\n      setSelectedPersonality(memory.selectedPersonality);\n    }\n  }, [memory, selectedPersonality]);\n\n  const handleSelectPersonality = (personalityId: string) => {\n    setSelectedPersonality(personalityId);\n  };\n\n  const handleSave = () => {\n    if (selectedPersonality) {\n      updatePersonality.mutate(selectedPersonality);\n    }\n  };\n\n  const isLoading = memoryLoading || personalitiesLoading;\n\n  return (\n    <div className=\"min-h-screen bg-purple-500 dark:bg-gray-900 pb-24\">\n      <div className=\"max-w-4xl mx-auto p-4\">\n        {/* Header */}\n        <div className=\"mb-6\">\n          <Link href=\"/coaching\">\n            <button\n              className=\"flex items-center space-x-2 text-white hover:text-purple-200 transition-colors mb-4\"\n              data-testid=\"button-back\"\n            >\n              <ArrowLeft className=\"h-5 w-5\" />\n              <span>Back to Coach</span>\n            </button>\n          </Link>\n\n          <div className=\"flex items-center space-x-3 mb-2\">\n            <Sparkles className=\"h-8 w-8 text-white\" />\n            <h1 className=\"text-3xl font-bold text-white\">\n              Choose Your Coach Personality\n            </h1>\n          </div>\n          <p className=\"text-white/90\">\n            Select the coaching style that motivates you best\n          </p>\n        </div>\n\n        {/* Loading State */}\n        {isLoading && (\n          <div className=\"space-y-4\">\n            {[1, 2, 3].map((i) => (\n              <div key={i} className=\"animate-pulse bg-white/20 dark:bg-gray-800 rounded-xl h-32\" />\n            ))}\n          </div>\n        )}\n\n        {/* Personality Cards */}\n        {!isLoading && (\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            className=\"space-y-4 mb-6\"\n          >\n            {personalities.map((personality, index) => {\n              const isSelected = selectedPersonality === personality.id;\n              const isCurrent = currentPersonality === personality.id;\n\n              return (\n                <motion.div\n                  key={personality.id}\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ delay: index * 0.1 }}\n                >\n                  <Card\n                    className={`p-6 cursor-pointer transition-all hover:shadow-lg ${\n                      isSelected\n                        ? 'ring-4 ring-purple-600 dark:ring-purple-400 bg-purple-50 dark:bg-purple-900/20'\n                        : 'hover:bg-gray-50 dark:hover:bg-gray-800'\n                    }`}\n                    onClick={() => handleSelectPersonality(personality.id)}\n                    data-testid={`card-personality-${personality.id}`}\n                  >\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-2 mb-2\">\n                          <h3 className=\"text-xl font-bold text-gray-900 dark:text-white\">\n                            {personality.name}\n                          </h3>\n                          {isCurrent && (\n                            <span className=\"px-2 py-1 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 text-xs font-semibold rounded-full\">\n                              Current\n                            </span>\n                          )}\n                        </div>\n                        <p className=\"text-gray-600 dark:text-gray-300 mb-3\">\n                          {personality.description}\n                        </p>\n                        <div className=\"flex flex-wrap gap-2\">\n                          <span className=\"px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 text-sm rounded-full\">\n                            {personality.responseStyle.tone}\n                          </span>\n                          <span className=\"px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 text-sm rounded-full\">\n                            {personality.responseStyle.formality}\n                          </span>\n                          <span className=\"px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 text-sm rounded-full\">\n                            {personality.responseStyle.directness}\n                          </span>\n                          {personality.responseStyle.emoji && (\n                            <span className=\"px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 text-sm rounded-full\">\n                              uses emojis\n                            </span>\n                          )}\n                        </div>\n                      </div>\n                      {isSelected && (\n                        <div className=\"ml-4\">\n                          <div className=\"h-8 w-8 bg-purple-600 dark:bg-purple-400 rounded-full flex items-center justify-center\">\n                            <Check className=\"h-5 w-5 text-white dark:text-gray-900\" />\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  </Card>\n                </motion.div>\n              );\n            })}\n          </motion.div>\n        )}\n\n        {/* Save Button */}\n        {!isLoading && selectedPersonality && selectedPersonality !== currentPersonality && (\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n          >\n            <Button\n              onClick={handleSave}\n              disabled={updatePersonality.isPending}\n              className=\"w-full bg-gradient-to-r from-purple-600 to-violet-600 hover:from-purple-700 hover:to-violet-700 text-white py-6 text-lg\"\n              data-testid=\"button-save-personality\"\n            >\n              {updatePersonality.isPending ? \"Saving...\" : \"Save Personality\"}\n            </Button>\n          </motion.div>\n        )}\n      </div>\n    </div>\n  );\n}\n","size_bytes":8209},"client/src/pages/CoachProfilePage.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Link } from \"wouter\";\nimport { ArrowLeft, User, Plus, X } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport type { AiCoachMemory } from \"@shared/schema\";\nimport { motion } from \"framer-motion\";\n\nexport function CoachProfilePage() {\n  const { toast } = useToast();\n  \n  // Form state\n  const [age, setAge] = useState<number | null>(null);\n  const [occupation, setOccupation] = useState(\"\");\n  const [lifestyleDetails, setLifestyleDetails] = useState(\"\");\n  const [interests, setInterests] = useState<string[]>([]);\n  const [newInterest, setNewInterest] = useState(\"\");\n  const [fitnessGoals, setFitnessGoals] = useState(\"\");\n  const [stressGoals, setStressGoals] = useState(\"\");\n  const [sleepGoals, setSleepGoals] = useState(\"\");\n  const [mentalHealthGoals, setMentalHealthGoals] = useState(\"\");\n  const [workSchedule, setWorkSchedule] = useState(\"\");\n  const [exerciseFrequency, setExerciseFrequency] = useState(\"\");\n\n  // Fetch user's coach memory\n  const { data: memory, isLoading } = useQuery<AiCoachMemory>({\n    queryKey: ['/api/coach-memory'],\n  });\n\n  // Populate form when data loads\n  useEffect(() => {\n    if (memory) {\n      setAge(memory.age || null);\n      setOccupation(memory.occupation || \"\");\n      setLifestyleDetails(memory.lifestyleDetails || \"\");\n      setInterests(memory.interests || []);\n      setFitnessGoals(memory.fitnessGoals || \"\");\n      setStressGoals(memory.stressGoals || \"\");\n      setSleepGoals(memory.sleepGoals || \"\");\n      setMentalHealthGoals(memory.mentalHealthGoals || \"\");\n      setWorkSchedule(memory.workSchedule || \"\");\n      setExerciseFrequency(memory.exerciseFrequency || \"\");\n    }\n  }, [memory]);\n\n  // Update memory mutation\n  const updateMemory = useMutation({\n    mutationFn: async () => {\n      return apiRequest('/api/coach-memory', {\n        method: 'PATCH',\n        body: JSON.stringify({\n          age: age || undefined,\n          occupation: occupation || undefined,\n          lifestyleDetails: lifestyleDetails || undefined,\n          interests: interests.length > 0 ? interests : undefined,\n          fitnessGoals: fitnessGoals || undefined,\n          stressGoals: stressGoals || undefined,\n          sleepGoals: sleepGoals || undefined,\n          mentalHealthGoals: mentalHealthGoals || undefined,\n          workSchedule: workSchedule || undefined,\n          exerciseFrequency: exerciseFrequency || undefined,\n        }),\n        headers: { 'Content-Type': 'application/json' },\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/coach-memory'] });\n      toast({\n        title: \"Profile Updated!\",\n        description: \"Your coach will use this information to personalize conversations.\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to update profile. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleAddInterest = () => {\n    if (newInterest.trim() && !interests.includes(newInterest.trim())) {\n      setInterests([...interests, newInterest.trim()]);\n      setNewInterest(\"\");\n    }\n  };\n\n  const handleRemoveInterest = (interest: string) => {\n    setInterests(interests.filter(i => i !== interest));\n  };\n\n  const handleSave = () => {\n    // Validate that at least one field has meaningful content\n    const hasContent = \n      (age && age > 0) ||\n      (occupation && occupation.trim().length > 0) ||\n      (lifestyleDetails && lifestyleDetails.trim().length > 0) ||\n      (interests && interests.length > 0) ||\n      (fitnessGoals && fitnessGoals.trim().length > 0) ||\n      (stressGoals && stressGoals.trim().length > 0) ||\n      (sleepGoals && sleepGoals.trim().length > 0) ||\n      (mentalHealthGoals && mentalHealthGoals.trim().length > 0) ||\n      (workSchedule && workSchedule.trim().length > 0) ||\n      (exerciseFrequency && exerciseFrequency.trim().length > 0);\n    \n    if (!hasContent) {\n      toast({\n        title: \"No Changes\",\n        description: \"Please add at least one piece of information to save.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    \n    updateMemory.mutate();\n  };\n\n  return (\n    <div className=\"min-h-screen bg-purple-500 dark:bg-gray-900 pb-24\">\n      <div className=\"max-w-4xl mx-auto p-4\">\n        {/* Header */}\n        <div className=\"mb-6\">\n          <Link href=\"/coaching\">\n            <button\n              className=\"flex items-center space-x-2 text-white hover:text-purple-200 transition-colors mb-4\"\n              data-testid=\"button-back\"\n            >\n              <ArrowLeft className=\"h-5 w-5\" />\n              <span>Back to Coach</span>\n            </button>\n          </Link>\n\n          <div className=\"flex items-center space-x-3 mb-2\">\n            <User className=\"h-8 w-8 text-white\" />\n            <h1 className=\"text-3xl font-bold text-white\">\n              Your Coach Profile\n            </h1>\n          </div>\n          <p className=\"text-white/90\">\n            Help your AI coach get to know you better\n          </p>\n        </div>\n\n        {/* Loading State */}\n        {isLoading && (\n          <div className=\"space-y-4\">\n            {[1, 2, 3].map((i) => (\n              <div key={i} className=\"animate-pulse bg-white/20 dark:bg-gray-800 rounded-xl h-32\" />\n            ))}\n          </div>\n        )}\n\n        {/* Form */}\n        {!isLoading && (\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            className=\"space-y-6\"\n          >\n            {/* Personal Details */}\n            <Card className=\"p-6 bg-white dark:bg-gray-800\">\n              <h2 className=\"text-xl font-bold mb-4 text-gray-900 dark:text-white\">\n                Personal Details\n              </h2>\n              \n              <div className=\"space-y-4\">\n                <div>\n                  <Label htmlFor=\"age\">Age (optional)</Label>\n                  <Input\n                    id=\"age\"\n                    type=\"number\"\n                    value={age || \"\"}\n                    onChange={(e) => setAge(e.target.value ? parseInt(e.target.value) : null)}\n                    placeholder=\"Your age\"\n                    data-testid=\"input-age\"\n                  />\n                </div>\n\n                <div>\n                  <Label htmlFor=\"occupation\">Occupation (optional)</Label>\n                  <Input\n                    id=\"occupation\"\n                    value={occupation}\n                    onChange={(e) => setOccupation(e.target.value)}\n                    placeholder=\"e.g., Nurse, Teacher, Engineer\"\n                    data-testid=\"input-occupation\"\n                  />\n                </div>\n\n                <div>\n                  <Label htmlFor=\"lifestyle\">Lifestyle Details (optional)</Label>\n                  <Input\n                    id=\"lifestyle\"\n                    value={lifestyleDetails}\n                    onChange={(e) => setLifestyleDetails(e.target.value)}\n                    placeholder=\"e.g., Night shifts, Ex-military, Parent of young kids\"\n                    data-testid=\"input-lifestyle\"\n                  />\n                </div>\n\n                <div>\n                  <Label htmlFor=\"workSchedule\">Work Schedule (optional)</Label>\n                  <Input\n                    id=\"workSchedule\"\n                    value={workSchedule}\n                    onChange={(e) => setWorkSchedule(e.target.value)}\n                    placeholder=\"e.g., Day shifts, Night shifts, Rotating schedule\"\n                    data-testid=\"input-work-schedule\"\n                  />\n                </div>\n              </div>\n            </Card>\n\n            {/* Interests & Hobbies */}\n            <Card className=\"p-6 bg-white dark:bg-gray-800\">\n              <h2 className=\"text-xl font-bold mb-4 text-gray-900 dark:text-white\">\n                Interests & Hobbies\n              </h2>\n              \n              <div className=\"space-y-3\">\n                <div className=\"flex gap-2\">\n                  <Input\n                    value={newInterest}\n                    onChange={(e) => setNewInterest(e.target.value)}\n                    onKeyPress={(e) => e.key === 'Enter' && handleAddInterest()}\n                    placeholder=\"Add an interest (gym, music, gaming, etc.)\"\n                    data-testid=\"input-new-interest\"\n                  />\n                  <Button\n                    onClick={handleAddInterest}\n                    variant=\"outline\"\n                    size=\"icon\"\n                    data-testid=\"button-add-interest\"\n                  >\n                    <Plus className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n\n                {interests.length > 0 && (\n                  <div className=\"flex flex-wrap gap-2\">\n                    {interests.map((interest) => (\n                      <span\n                        key={interest}\n                        className=\"px-3 py-1 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 rounded-full flex items-center gap-2\"\n                        data-testid={`tag-interest-${interest}`}\n                      >\n                        {interest}\n                        <button\n                          onClick={() => handleRemoveInterest(interest)}\n                          className=\"hover:text-purple-900 dark:hover:text-purple-100\"\n                          data-testid={`button-remove-${interest}`}\n                        >\n                          <X className=\"h-3 w-3\" />\n                        </button>\n                      </span>\n                    ))}\n                  </div>\n                )}\n              </div>\n            </Card>\n\n            {/* Goals Beyond Nutrition */}\n            <Card className=\"p-6 bg-white dark:bg-gray-800\">\n              <h2 className=\"text-xl font-bold mb-4 text-gray-900 dark:text-white\">\n                Personal Goals\n              </h2>\n              \n              <div className=\"space-y-4\">\n                <div>\n                  <Label htmlFor=\"fitnessGoals\">Fitness Goals (optional)</Label>\n                  <Textarea\n                    id=\"fitnessGoals\"\n                    value={fitnessGoals}\n                    onChange={(e) => setFitnessGoals(e.target.value)}\n                    placeholder=\"e.g., Build strength, Run 5K, Improve flexibility\"\n                    rows={2}\n                    data-testid=\"input-fitness-goals\"\n                  />\n                </div>\n\n                <div>\n                  <Label htmlFor=\"stressGoals\">Stress Management Goals (optional)</Label>\n                  <Textarea\n                    id=\"stressGoals\"\n                    value={stressGoals}\n                    onChange={(e) => setStressGoals(e.target.value)}\n                    placeholder=\"e.g., Better work-life balance, Learn to say no\"\n                    rows={2}\n                    data-testid=\"input-stress-goals\"\n                  />\n                </div>\n\n                <div>\n                  <Label htmlFor=\"sleepGoals\">Sleep Goals (optional)</Label>\n                  <Textarea\n                    id=\"sleepGoals\"\n                    value={sleepGoals}\n                    onChange={(e) => setSleepGoals(e.target.value)}\n                    placeholder=\"e.g., Consistent sleep schedule, 8 hours per night\"\n                    rows={2}\n                    data-testid=\"input-sleep-goals\"\n                  />\n                </div>\n\n                <div>\n                  <Label htmlFor=\"mentalHealthGoals\">Mental Health Goals (optional)</Label>\n                  <Textarea\n                    id=\"mentalHealthGoals\"\n                    value={mentalHealthGoals}\n                    onChange={(e) => setMentalHealthGoals(e.target.value)}\n                    placeholder=\"e.g., Build confidence, Reduce anxiety\"\n                    rows={2}\n                    data-testid=\"input-mental-health-goals\"\n                  />\n                </div>\n\n                <div>\n                  <Label htmlFor=\"exerciseFrequency\">Exercise Frequency (optional)</Label>\n                  <Input\n                    id=\"exerciseFrequency\"\n                    value={exerciseFrequency}\n                    onChange={(e) => setExerciseFrequency(e.target.value)}\n                    placeholder=\"e.g., Daily, 3x per week, Weekend warrior\"\n                    data-testid=\"input-exercise-frequency\"\n                  />\n                </div>\n              </div>\n            </Card>\n\n            {/* Save Button */}\n            <Button\n              onClick={handleSave}\n              disabled={updateMemory.isPending}\n              className=\"w-full bg-gradient-to-r from-purple-600 to-violet-600 hover:from-purple-700 hover:to-violet-700 text-white py-6 text-lg\"\n              data-testid=\"button-save-profile\"\n            >\n              {updateMemory.isPending ? \"Saving...\" : \"Save Profile\"}\n            </Button>\n          </motion.div>\n        )}\n      </div>\n    </div>\n  );\n}\n","size_bytes":13397},"server/objectStorage.ts":{"content":"// Referenced from blueprint: javascript_object_storage\nimport { Storage, File } from \"@google-cloud/storage\";\nimport { Response } from \"express\";\nimport { randomUUID } from \"crypto\";\nimport {\n  ObjectAclPolicy,\n  ObjectPermission,\n  canAccessObject,\n  getObjectAclPolicy,\n  setObjectAclPolicy,\n} from \"./objectAcl\";\n\nconst REPLIT_SIDECAR_ENDPOINT = \"http://127.0.0.1:1106\";\n\nexport const objectStorageClient = new Storage({\n  credentials: {\n    audience: \"replit\",\n    subject_token_type: \"access_token\",\n    token_url: `${REPLIT_SIDECAR_ENDPOINT}/token`,\n    type: \"external_account\",\n    credential_source: {\n      url: `${REPLIT_SIDECAR_ENDPOINT}/credential`,\n      format: {\n        type: \"json\",\n        subject_token_field_name: \"access_token\",\n      },\n    },\n    universe_domain: \"googleapis.com\",\n  },\n  projectId: \"\",\n});\n\nexport class ObjectNotFoundError extends Error {\n  constructor() {\n    super(\"Object not found\");\n    this.name = \"ObjectNotFoundError\";\n    Object.setPrototypeOf(this, ObjectNotFoundError.prototype);\n  }\n}\n\nexport class ObjectStorageService {\n  constructor() {}\n\n  getPublicObjectSearchPaths(): Array<string> {\n    const pathsStr = process.env.PUBLIC_OBJECT_SEARCH_PATHS || \"\";\n    const paths = Array.from(\n      new Set(\n        pathsStr\n          .split(\",\")\n          .map((path) => path.trim())\n          .filter((path) => path.length > 0)\n      )\n    );\n    if (paths.length === 0) {\n      throw new Error(\n        \"PUBLIC_OBJECT_SEARCH_PATHS not set. Create a bucket in 'Object Storage' \" +\n          \"tool and set PUBLIC_OBJECT_SEARCH_PATHS env var (comma-separated paths).\"\n      );\n    }\n    return paths;\n  }\n\n  getPrivateObjectDir(): string {\n    const dir = process.env.PRIVATE_OBJECT_DIR || \"\";\n    if (!dir) {\n      throw new Error(\n        \"PRIVATE_OBJECT_DIR not set. Create a bucket in 'Object Storage' \" +\n          \"tool and set PRIVATE_OBJECT_DIR env var.\"\n      );\n    }\n    return dir;\n  }\n\n  async searchPublicObject(filePath: string): Promise<File | null> {\n    for (const searchPath of this.getPublicObjectSearchPaths()) {\n      const fullPath = `${searchPath}/${filePath}`;\n      const { bucketName, objectName } = parseObjectPath(fullPath);\n      const bucket = objectStorageClient.bucket(bucketName);\n      const file = bucket.file(objectName);\n      const [exists] = await file.exists();\n      if (exists) {\n        return file;\n      }\n    }\n    return null;\n  }\n\n  async downloadObject(file: File, res: Response, cacheTtlSec: number = 3600) {\n    try {\n      const [metadata] = await file.getMetadata();\n      const aclPolicy = await getObjectAclPolicy(file);\n      const isPublic = aclPolicy?.visibility === \"public\";\n      res.set({\n        \"Content-Type\": metadata.contentType || \"application/octet-stream\",\n        \"Content-Length\": metadata.size,\n        \"Cache-Control\": `${\n          isPublic ? \"public\" : \"private\"\n        }, max-age=${cacheTtlSec}`,\n      });\n\n      const stream = file.createReadStream();\n\n      stream.on(\"error\", (err: Error) => {\n        console.error(\"Stream error:\", err);\n        if (!res.headersSent) {\n          res.status(500).json({ error: \"Error streaming file\" });\n        }\n      });\n\n      stream.pipe(res);\n    } catch (error) {\n      console.error(\"Error downloading file:\", error);\n      if (!res.headersSent) {\n        res.status(500).json({ error: \"Error downloading file\" });\n      }\n    }\n  }\n\n  async getObjectEntityUploadURL(): Promise<string> {\n    const privateObjectDir = this.getPrivateObjectDir();\n    if (!privateObjectDir) {\n      throw new Error(\n        \"PRIVATE_OBJECT_DIR not set. Create a bucket in 'Object Storage' \" +\n          \"tool and set PRIVATE_OBJECT_DIR env var.\"\n      );\n    }\n\n    const objectId = randomUUID();\n    const fullPath = `${privateObjectDir}/uploads/${objectId}`;\n    const { bucketName, objectName } = parseObjectPath(fullPath);\n\n    return signObjectURL({\n      bucketName,\n      objectName,\n      method: \"PUT\",\n      ttlSec: 900,\n    });\n  }\n\n  async getObjectEntityFile(objectPath: string): Promise<File> {\n    if (!objectPath.startsWith(\"/objects/\")) {\n      throw new ObjectNotFoundError();\n    }\n\n    const parts = objectPath.slice(1).split(\"/\");\n    if (parts.length < 2) {\n      throw new ObjectNotFoundError();\n    }\n\n    const entityId = parts.slice(1).join(\"/\");\n    let entityDir = this.getPrivateObjectDir();\n    if (!entityDir.endsWith(\"/\")) {\n      entityDir = `${entityDir}/`;\n    }\n    const objectEntityPath = `${entityDir}${entityId}`;\n    const { bucketName, objectName } = parseObjectPath(objectEntityPath);\n    const bucket = objectStorageClient.bucket(bucketName);\n    const objectFile = bucket.file(objectName);\n    const [exists] = await objectFile.exists();\n    if (!exists) {\n      throw new ObjectNotFoundError();\n    }\n    return objectFile;\n  }\n\n  normalizeObjectEntityPath(rawPath: string): string {\n    if (!rawPath.startsWith(\"https://storage.googleapis.com/\")) {\n      return rawPath;\n    }\n\n    const url = new URL(rawPath);\n    const rawObjectPath = url.pathname;\n\n    let objectEntityDir = this.getPrivateObjectDir();\n    if (!objectEntityDir.endsWith(\"/\")) {\n      objectEntityDir = `${objectEntityDir}/`;\n    }\n\n    if (!rawObjectPath.startsWith(objectEntityDir)) {\n      return rawObjectPath;\n    }\n\n    const entityId = rawObjectPath.slice(objectEntityDir.length);\n    return `/objects/${entityId}`;\n  }\n\n  async trySetObjectEntityAclPolicy(\n    rawPath: string,\n    aclPolicy: ObjectAclPolicy\n  ): Promise<string> {\n    const normalizedPath = this.normalizeObjectEntityPath(rawPath);\n    if (!normalizedPath.startsWith(\"/\")) {\n      return normalizedPath;\n    }\n\n    const objectFile = await this.getObjectEntityFile(normalizedPath);\n    await setObjectAclPolicy(objectFile, aclPolicy);\n    return normalizedPath;\n  }\n\n  async canAccessObjectEntity({\n    userId,\n    objectFile,\n    requestedPermission,\n  }: {\n    userId?: string;\n    objectFile: File;\n    requestedPermission?: ObjectPermission;\n  }): Promise<boolean> {\n    return canAccessObject({\n      userId,\n      objectFile,\n      requestedPermission: requestedPermission ?? ObjectPermission.READ,\n    });\n  }\n\n  // Upload image data directly to object storage\n  async uploadProgressPhoto(imageBuffer: Buffer, userId: string): Promise<string> {\n    const privateObjectDir = this.getPrivateObjectDir();\n    const objectId = randomUUID();\n    const fullPath = `${privateObjectDir}/progress/${objectId}.jpg`;\n    const { bucketName, objectName } = parseObjectPath(fullPath);\n\n    const bucket = objectStorageClient.bucket(bucketName);\n    const file = bucket.file(objectName);\n\n    // Upload the image\n    await file.save(imageBuffer, {\n      contentType: 'image/jpeg',\n      metadata: {\n        cacheControl: 'public, max-age=31536000',\n      },\n    });\n\n    // Set ACL policy for the photo (public read access for browser display)\n    // Progress photos are user body photos without personal identifying information,\n    // so they can be publicly readable to allow browser <img> tags to load them\n    await setObjectAclPolicy(file, {\n      owner: userId,\n      visibility: \"public\",\n    });\n\n    // Return the object path\n    return `/objects/progress/${objectId}.jpg`;\n  }\n\n  // Generate a signed URL for a progress photo (valid for 24 hours)\n  async getSignedProgressPhotoUrl(objectPath: string): Promise<string> {\n    try {\n      const { bucketName, objectName } = parseObjectPath(objectPath);\n      return await signObjectURL({\n        bucketName,\n        objectName,\n        method: \"GET\",\n        ttlSec: 86400, // 24 hours\n      });\n    } catch (error) {\n      console.error(`Failed to generate signed URL for ${objectPath}:`, error);\n      // Return original path as fallback\n      return objectPath;\n    }\n  }\n}\n\nfunction parseObjectPath(path: string): {\n  bucketName: string;\n  objectName: string;\n} {\n  if (!path.startsWith(\"/\")) {\n    path = `/${path}`;\n  }\n  const pathParts = path.split(\"/\");\n  if (pathParts.length < 3) {\n    throw new Error(\"Invalid path: must contain at least a bucket name\");\n  }\n\n  const bucketName = pathParts[1];\n  const objectName = pathParts.slice(2).join(\"/\");\n\n  return {\n    bucketName,\n    objectName,\n  };\n}\n\nasync function signObjectURL({\n  bucketName,\n  objectName,\n  method,\n  ttlSec,\n}: {\n  bucketName: string;\n  objectName: string;\n  method: \"GET\" | \"PUT\" | \"DELETE\" | \"HEAD\";\n  ttlSec: number;\n}): Promise<string> {\n  const request = {\n    bucket_name: bucketName,\n    object_name: objectName,\n    method,\n    expires_at: new Date(Date.now() + ttlSec * 1000).toISOString(),\n  };\n  const response = await fetch(\n    `${REPLIT_SIDECAR_ENDPOINT}/object-storage/signed-object-url`,\n    {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify(request),\n    }\n  );\n  if (!response.ok) {\n    throw new Error(\n      `Failed to sign object URL, errorcode: ${response.status}, ` +\n        `make sure you're running on Replit`\n    );\n  }\n\n  const { signed_url: signedURL } = await response.json();\n  return signedURL;\n}\n","size_bytes":9081},"client/src/pages/ActivityPage.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Activity, ArrowLeft, RefreshCw, TrendingUp, Calendar } from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { buildApiUrl } from '@/lib/api-config';\nimport { motion } from \"framer-motion\";\nimport { format } from \"date-fns\";\n\ninterface StepEntry {\n  id: string;\n  userId: string;\n  stepCount: number;\n  loggedDate: string;\n  source: string;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport function ActivityPage() {\n  const [isRefreshing, setIsRefreshing] = useState(false);\n  const [errorMessage, setErrorMessage] = useState<string | null>(null);\n\n  // Fetch today's steps from backend\n  const { data: todaySteps, isLoading } = useQuery<StepEntry>({\n    queryKey: ['/api/steps/today'],\n  });\n\n  // Fetch step history\n  const { data: stepHistory = [] } = useQuery<StepEntry[]>({\n    queryKey: ['/api/steps'],\n  });\n\n  // Mutation to update steps\n  const updateStepsMutation = useMutation({\n    mutationFn: async (stepCount: number) => {\n      const res = await fetch(buildApiUrl('/api/steps'), {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'include',\n        body: JSON.stringify({ stepCount }),\n      });\n      if (!res.ok) throw new Error('Failed to update steps');\n      return res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/steps/today'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/steps'] });\n    },\n  });\n\n  // Fetch steps from device health data\n  const fetchStepsFromDevice = async () => {\n    try {\n      setIsRefreshing(true);\n      setErrorMessage(null);\n\n      // Check if Capacitor and Health plugin are available\n      if (typeof window === 'undefined' || !(window as any).Capacitor) {\n        setErrorMessage('Step tracking requires the native mobile app. For now, steps will sync automatically when available.');\n        setIsRefreshing(false);\n        return;\n      }\n\n      // Try to import and use the health plugin dynamically\n      try {\n        const { Health } = await import('capacitor-health');\n        \n        // Request authorization\n        await Health.requestAuthorization({\n          read: ['STEPS'],\n          write: []\n        });\n\n        // Get today's date range\n        const today = new Date();\n        today.setHours(0, 0, 0, 0);\n        const now = new Date();\n\n        // Query step count\n        const result = await Health.query({\n          sampleType: 'STEPS',\n          startDate: today.toISOString(),\n          endDate: now.toISOString()\n        });\n\n        // Sum all step counts for today\n        const totalSteps = Array.isArray(result) \n          ? result.reduce((sum: number, item: any) => sum + (item.value || item.count || 0), 0)\n          : 0;\n\n        // Update backend\n        await updateStepsMutation.mutateAsync(totalSteps);\n        setErrorMessage(null);\n      } catch (pluginError: any) {\n        console.error('Health plugin error:', pluginError);\n        setErrorMessage('Health data access not available. Steps will sync automatically when the feature is enabled.');\n      }\n      \n      setIsRefreshing(false);\n    } catch (error: any) {\n      console.error('Fetch steps error:', error);\n      setErrorMessage('Step tracking will be available in the mobile app.');\n      setIsRefreshing(false);\n    }\n  };\n\n  // Auto-fetch steps on mount\n  useEffect(() => {\n    // Try to sync steps automatically\n    fetchStepsFromDevice();\n  }, []);\n\n  // Format step count with commas\n  const formatSteps = (steps: number): string => {\n    return steps.toLocaleString();\n  };\n\n  // Format date\n  const formatDate = (dateStr: string): string => {\n    try {\n      return format(new Date(dateStr), 'MMM d, yyyy');\n    } catch {\n      return dateStr;\n    }\n  };\n\n  // Calculate weekly average\n  const weeklyAverage = stepHistory.length > 0 \n    ? Math.round(stepHistory.slice(0, 7).reduce((sum, entry) => sum + entry.stepCount, 0) / Math.min(7, stepHistory.length))\n    : 0;\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-purple-500 dark:bg-gray-900\">\n        <div className=\"max-w-4xl mx-auto p-4\">\n          <div className=\"h-8 w-48 bg-gray-200 dark:bg-gray-700 rounded animate-pulse mb-4\"></div>\n          <div className=\"h-64 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  const currentSteps = todaySteps?.stepCount || 0;\n  const dailyGoal = 10000;\n  const progress = Math.min((currentSteps / dailyGoal) * 100, 100);\n\n  return (\n    <div className=\"min-h-screen bg-purple-500 dark:bg-gray-900 pb-24\">\n      <div className=\"max-w-4xl mx-auto p-4\">\n        {/* Header */}\n        <div className=\"mb-6\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <Link href=\"/diary\">\n              <button\n                className=\"flex items-center space-x-2 text-white hover:text-purple-200 transition-colors\"\n                data-testid=\"button-back\"\n              >\n                <ArrowLeft className=\"h-5 w-5\" />\n                <span>Back</span>\n              </button>\n            </Link>\n\n            <Button\n              onClick={fetchStepsFromDevice}\n              disabled={isRefreshing}\n              variant=\"outline\"\n              size=\"sm\"\n              className=\"text-white border-white/30 hover:bg-white/10\"\n              data-testid=\"button-refresh-steps\"\n            >\n              <RefreshCw className={`h-4 w-4 mr-2 ${isRefreshing ? 'animate-spin' : ''}`} />\n              Sync\n            </Button>\n          </div>\n\n          <div className=\"flex items-center space-x-3 mb-2\">\n            <Activity className=\"h-8 w-8 text-white\" />\n            <h1 className=\"text-3xl font-bold text-white\">\n              Daily Activity\n            </h1>\n          </div>\n          <p className=\"text-white/90\">\n            Track your steps automatically from your device\n          </p>\n        </div>\n\n        {/* Info Message */}\n        {errorMessage && (\n          <motion.div\n            initial={{ opacity: 0, y: -10 }}\n            animate={{ opacity: 1, y: 0 }}\n            className=\"bg-blue-100 dark:bg-blue-900/30 border border-blue-400 dark:border-blue-700 text-blue-700 dark:text-blue-200 px-4 py-3 rounded-lg mb-4\"\n            data-testid=\"info-message\"\n          >\n            <p className=\"text-sm\">{errorMessage}</p>\n          </motion.div>\n        )}\n\n        {/* Today's Steps Card */}\n        <motion.div\n          initial={{ opacity: 0, scale: 0.95 }}\n          animate={{ opacity: 1, scale: 1 }}\n          className=\"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 mb-6\"\n        >\n          <div className=\"text-center mb-4\">\n            <h2 className=\"text-lg font-medium text-gray-700 dark:text-gray-300 mb-2\">\n              Today's Steps\n            </h2>\n            <div className=\"text-6xl font-bold bg-gradient-to-r from-purple-600 to-violet-600 bg-clip-text text-transparent mb-2\" data-testid=\"text-step-count\">\n              {formatSteps(currentSteps)}\n            </div>\n            <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n              Goal: {formatSteps(dailyGoal)} steps\n            </p>\n          </div>\n\n          {/* Progress Bar */}\n          <div className=\"relative w-full h-4 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden\">\n            <motion.div\n              initial={{ width: 0 }}\n              animate={{ width: `${progress}%` }}\n              transition={{ duration: 0.8, ease: \"easeOut\" }}\n              className=\"h-full bg-gradient-to-r from-purple-600 to-violet-600\"\n            />\n          </div>\n          <p className=\"text-center text-sm text-gray-600 dark:text-gray-400 mt-2\">\n            {progress.toFixed(0)}% of daily goal\n          </p>\n\n          {/* Stats Row */}\n          <div className=\"grid grid-cols-2 gap-4 mt-6 pt-6 border-t border-gray-200 dark:border-gray-700\">\n            <div className=\"text-center\">\n              <TrendingUp className=\"h-5 w-5 mx-auto text-purple-600 mb-1\" />\n              <p className=\"text-2xl font-bold text-gray-900 dark:text-gray-100\">\n                {formatSteps(weeklyAverage)}\n              </p>\n              <p className=\"text-xs text-gray-600 dark:text-gray-400\">7-day average</p>\n            </div>\n            <div className=\"text-center\">\n              <Calendar className=\"h-5 w-5 mx-auto text-violet-600 mb-1\" />\n              <p className=\"text-2xl font-bold text-gray-900 dark:text-gray-100\">\n                {stepHistory.length}\n              </p>\n              <p className=\"text-xs text-gray-600 dark:text-gray-400\">Days tracked</p>\n            </div>\n          </div>\n        </motion.div>\n\n        {/* Step History */}\n        {stepHistory.length > 0 && (\n          <div className=\"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6\">\n            <h3 className=\"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4\">\n              Recent Activity\n            </h3>\n            <div className=\"space-y-3\" data-testid=\"step-history\">\n              {stepHistory.slice(0, 7).map((entry, index) => (\n                <motion.div\n                  key={entry.id}\n                  initial={{ opacity: 0, x: -20 }}\n                  animate={{ opacity: 1, x: 0 }}\n                  transition={{ delay: index * 0.05 }}\n                  className=\"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg\"\n                >\n                  <div className=\"flex items-center space-x-3\">\n                    <Activity className=\"h-5 w-5 text-purple-600\" />\n                    <div>\n                      <p className=\"font-medium text-gray-900 dark:text-gray-100\">\n                        {formatSteps(entry.stepCount)} steps\n                      </p>\n                      <p className=\"text-xs text-gray-600 dark:text-gray-400\">\n                        {formatDate(entry.loggedDate)}\n                      </p>\n                    </div>\n                  </div>\n                  <div className={`px-3 py-1 rounded-full text-xs font-medium ${\n                    entry.stepCount >= dailyGoal\n                      ? 'bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300'\n                      : 'bg-gray-200 text-gray-700 dark:bg-gray-600 dark:text-gray-300'\n                  }`}>\n                    {entry.stepCount >= dailyGoal ? 'âœ“ Goal met' : `${Math.round((entry.stepCount / dailyGoal) * 100)}%`}\n                  </div>\n                </motion.div>\n              ))}\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","size_bytes":10761},"client/src/components/step-counter-widget.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Zap } from \"lucide-react\";\nimport { useLocation } from \"wouter\";\n\ninterface StepData {\n  stepCount: number;\n}\n\nexport function StepCounterWidget() {\n  const [, setLocation] = useLocation();\n\n  const { data: todaySteps, isLoading } = useQuery<StepData>({\n    queryKey: ['/api/steps/today'],\n    refetchInterval: 300000, // Refetch every 5 minutes\n  });\n\n  const stepCount = todaySteps?.stepCount ?? 0;\n  const earnedCalories = Math.round(stepCount * 0.04); // Reward calculation\n\n  return (\n    <div \n      onClick={() => setLocation('/rewards')}\n      className=\"bg-gradient-to-r from-yellow-400 via-orange-500 to-red-500 rounded-2xl p-4 shadow-2xl hover:shadow-3xl transform hover:scale-105 transition-all duration-300 border-2 border-yellow-300/50 cursor-pointer\"\n      data-testid=\"card-steps-rewards\"\n    >\n      <div className=\"flex items-center space-x-3\">\n        <div className=\"p-2 bg-white/20 backdrop-blur-sm rounded-full relative\">\n          <Zap className=\"h-6 w-6 text-white animate-pulse\" />\n          <div className=\"absolute inset-0 rounded-full animate-ping bg-yellow-300/30\"></div>\n        </div>\n        <div>\n          <h3 className=\"text-lg font-bold text-white mb-0.5\">Steps Rewards</h3>\n          {isLoading ? (\n            <p className=\"text-white/80 text-xs\">Loading...</p>\n          ) : (\n            <p className=\"text-white/90 text-xs\">{stepCount.toLocaleString()} steps = {earnedCalories} calories earned</p>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":1557},"MOBILE_BUILD.md":{"content":"# PlateMate Mobile App Build Instructions\n\n## Prerequisites\n\n1. Install Xcode (for iOS builds) or Android Studio (for Android builds)\n2. Install Capacitor CLI globally: `npm install -g @capacitor/cli`\n\n## Build Steps\n\n### 1. Install Dependencies\n```bash\nnpm install\n```\n\n### 2. Build the Web App\n```bash\nnpm run build\n```\n\n### 3. Sync Capacitor\n```bash\nnpx cap sync\n```\n\nThis will copy the web assets to the native projects and update native dependencies.\n\n## iOS Build\n\n### 4. Open iOS Project in Xcode\n```bash\nnpx cap open ios\n```\n\n### 5. **IMPORTANT: Enable HealthKit Entitlement**\n\nâš ï¸ **This step is required for step tracking to work!**\n\n1. In Xcode, select the \"App\" target in the project navigator\n2. Go to the \"Signing & Capabilities\" tab\n3. Click the \"+ Capability\" button\n4. Search for \"HealthKit\" and add it\n5. Make sure \"HealthKit\" appears in the list of capabilities\n\n### 6. Configure Signing\n\n1. In the \"Signing & Capabilities\" tab, select your development team\n2. Xcode will automatically generate a provisioning profile\n\n### 7. Build and Run\n\n- Select your target device or simulator\n- Click the \"Run\" button (â–¶ï¸) or press Cmd+R\n- The app will build and launch on your device/simulator\n\n## Android Build\n\n### 4. Open Android Project in Android Studio\n```bash\nnpx cap open android\n```\n\n### 5. Install Health Connect (on Device/Emulator)\n\nThe step tracking feature requires Google Health Connect to be installed:\n\n- On a physical device: Install from Google Play Store\n- On an emulator: Use a system image with Google Play services\n\n### 6. Configure Signing (for Release Builds)\n\n1. Go to Build â†’ Generate Signed Bundle/APK\n2. Follow the wizard to create or select a keystore\n\n### 7. Build and Run\n\n- Select your target device or emulator\n- Click the \"Run\" button (â–¶) or press Shift+F10\n- The app will build and install on your device/emulator\n\n## Testing Step Counter\n\n### On iOS:\n1. Grant HealthKit permission when prompted\n2. The app will automatically sync steps from Apple Health\n3. You can verify by checking Settings â†’ Health â†’ Data Access & Devices â†’ PlateMate\n\n### On Android:\n1. Install Google Health Connect from Play Store\n2. Grant Health Connect permissions when prompted\n3. The app will automatically sync steps from Health Connect\n4. You can verify by opening Health Connect app â†’ App permissions â†’ PlateMate\n\n## Troubleshooting\n\n### iOS Step Counter Not Working\n- Make sure HealthKit capability is enabled in Xcode\n- Check that the app has permission in Settings â†’ Health â†’ Data Access & Devices\n- Steps may not sync in the simulator - test on a real device\n\n### Android Step Counter Not Working\n- Install Health Connect from Play Store\n- Grant all required permissions\n- Make sure you have some step data in Health Connect\n- The emulator typically doesn't have step data - test on a real device\n\n### General Issues\n- Run `npx cap sync` after any code changes\n- Clean build folder and rebuild if you encounter caching issues\n- Check that all required permissions are in AndroidManifest.xml and Info.plist\n\n## Updating the App\n\nAfter making code changes:\n\n1. Rebuild the web app: `npm run build`\n2. Sync changes: `npx cap sync`\n3. Rebuild in Xcode/Android Studio\n\n## Additional Resources\n\n- [Capacitor Documentation](https://capacitorjs.com/docs)\n- [capacitor-health Plugin](https://github.com/mley/capacitor-health)\n- [Apple HealthKit Documentation](https://developer.apple.com/documentation/healthkit)\n- [Android Health Connect Documentation](https://developer.android.com/health-and-fitness/guides/health-connect)\n","size_bytes":3572},"client/src/components/ai-coach-avatar.tsx":{"content":"import { motion } from \"framer-motion\";\nimport { useEffect, useState } from \"react\";\nimport militaryVideo from \"@assets/1760859782981_1760865007751.mp4\";\nimport gymBroVideo from \"@assets/1760859862860_1760865007770.mp4\";\nimport zenVideo from \"@assets/1760860089731_1760865007735.mp4\";\nimport clinicalVideo from \"@assets/1760860104807_1760865007708.mp4\";\nimport darkHumourVideo from \"@assets/1760860192581_1760865007745.mp4\";\nimport alexVideo from \"@assets/1760871634663_1760876511667.mp4\";\n\nexport type PersonalityType = 'military' | 'gym_bro' | 'zen' | 'clinical' | 'dark_humour' | 'alex';\n\ninterface AvatarConfig {\n  video: string;\n  glowColor: string;\n  particleColor: string;\n  name: string;\n}\n\nconst AVATAR_CONFIG: Record<PersonalityType, AvatarConfig> = {\n  military: {\n    video: zenVideo,\n    glowColor: 'rgba(239, 68, 68, 0.6)', // Red\n    particleColor: '#ef4444',\n    name: 'Sergeant Stone'\n  },\n  gym_bro: {\n    video: clinicalVideo,\n    glowColor: 'rgba(34, 197, 94, 0.6)', // Green\n    particleColor: '#22c55e',\n    name: 'Coach Mike'\n  },\n  zen: {\n    video: gymBroVideo,\n    glowColor: 'rgba(168, 85, 247, 0.6)', // Purple\n    particleColor: '#a855f7',\n    name: 'Maya'\n  },\n  clinical: {\n    video: darkHumourVideo,\n    glowColor: 'rgba(6, 182, 212, 0.6)', // Cyan\n    particleColor: '#06b6d4',\n    name: 'Dr. Rivera'\n  },\n  dark_humour: {\n    video: militaryVideo,\n    glowColor: 'rgba(236, 72, 153, 0.6)', // Pink\n    particleColor: '#ec4899',\n    name: 'Ryder'\n  },\n  alex: {\n    video: alexVideo,\n    glowColor: 'rgba(251, 146, 60, 0.6)', // Orange\n    particleColor: '#fb923c',\n    name: 'Alex'\n  }\n};\n\ninterface AICoachAvatarProps {\n  personality: PersonalityType;\n  isThinking?: boolean;\n  size?: 'small' | 'medium' | 'large';\n}\n\n// Large animation stage for selected personality\ninterface ActivePersonalityStageProps {\n  personality: PersonalityType;\n  isThinking?: boolean;\n}\n\nexport function ActivePersonalityStage({ personality, isThinking = false }: ActivePersonalityStageProps) {\n  const config = AVATAR_CONFIG[personality];\n  const [particles, setParticles] = useState<Array<{ id: number; x: number; y: number }>>([]);\n\n  // Generate random particles\n  useEffect(() => {\n    const newParticles = Array.from({ length: 20 }, (_, i) => ({\n      id: i,\n      x: Math.random() * 100,\n      y: Math.random() * 100,\n    }));\n    setParticles(newParticles);\n  }, [personality]);\n\n  // Amplified personality-specific animations for visibility\n  const getStageAnimation = () => {\n    switch (personality) {\n      case 'military':\n        // Aggressive shouting motion - vigorous shaking\n        return {\n          rotate: isThinking ? [-8, 8, -8, 8, -8] : [-4, 4, -4],\n          y: isThinking ? [-25, 25, -25, 25, -25] : [-15, 15, -15],\n          x: isThinking ? [-15, 15, -15, 15, -15] : [-8, 8, -8],\n          scale: isThinking ? [1, 1.05, 1, 1.05, 1] : [1, 1.02, 1],\n          transition: {\n            duration: isThinking ? 0.3 : 0.6,\n            repeat: Infinity,\n            ease: \"easeInOut\"\n          }\n        };\n      case 'gym_bro':\n        // Enthusiastic wave/bounce - energetic movement\n        return {\n          rotate: isThinking ? [0, -12, 12, -12, 12, 0] : [0, -8, 8, 0],\n          y: isThinking ? [0, -30, 0, -30, 0] : [0, -20, 0],\n          x: isThinking ? [-20, 0, 20, 0, -20] : [-12, 0, 12, 0],\n          scale: isThinking ? [1, 1.1, 1, 1.1, 1] : [1, 1.05, 1],\n          transition: {\n            duration: isThinking ? 0.5 : 1,\n            repeat: Infinity,\n            ease: \"easeInOut\"\n          }\n        };\n      case 'zen':\n        // Gentle meditation breathing/sway - smooth and slow\n        return {\n          rotate: [0, -3, 0, 3, 0],\n          y: [0, -15, 0, -15, 0],\n          x: [-8, 0, 8, 0, -8],\n          scale: [1, 1.03, 1, 1.03, 1],\n          transition: {\n            duration: 5,\n            repeat: Infinity,\n            ease: \"easeInOut\"\n          }\n        };\n      case 'clinical':\n        // Thoughtful pondering with head tilt - analytical movement\n        return {\n          rotate: isThinking ? [-10, 10, -10, 10, 0] : [0, 6, 0, -6, 0],\n          x: isThinking ? [0, 20, 0, -20, 0] : [0, 12, 0, -12, 0],\n          y: isThinking ? [-12, 0, -12, 0, -12] : [-8, 0, -8, 0, -8],\n          scale: isThinking ? [1, 1.04, 1, 1.04, 1] : [1, 1.02, 1],\n          transition: {\n            duration: isThinking ? 1.2 : 2.5,\n            repeat: Infinity,\n            ease: \"easeInOut\"\n          }\n        };\n      case 'dark_humour':\n        // Mischievous tilt and smirk - playful movement\n        return {\n          rotate: isThinking ? [0, 8, -8, 8, 0] : [0, 5, 0, -5, 0],\n          y: isThinking ? [0, -18, 0, -18, 0] : [0, -12, 0],\n          x: isThinking ? [15, -15, 15, -15, 0] : [10, -10, 10, 0],\n          scale: isThinking ? [1, 1.06, 1, 1.06, 1] : [1, 1.03, 1],\n          transition: {\n            duration: isThinking ? 0.8 : 2,\n            repeat: Infinity,\n            ease: \"easeInOut\"\n          }\n        };\n      case 'alex':\n        // Confident head tilt with sarcastic swagger - Army-meets-mum energy\n        return {\n          rotate: isThinking ? [-7, 7, -7, 7, 0] : [0, -6, 6, 0],\n          y: isThinking ? [-10, 10, -10, 10, 0] : [-8, 8, -8, 0],\n          x: isThinking ? [0, 15, -15, 0] : [0, 10, -10, 0],\n          scale: isThinking ? [1, 1.04, 1, 1.04, 1] : [1, 1.03, 1],\n          transition: {\n            duration: isThinking ? 1 : 1.8,\n            repeat: Infinity,\n            ease: \"easeInOut\"\n          }\n        };\n      default:\n        return {\n          scale: [1, 1.03, 1],\n          transition: {\n            duration: 2,\n            repeat: Infinity,\n            ease: \"easeInOut\"\n          }\n        };\n    }\n  };\n\n  return (\n    <div className=\"w-full flex flex-col items-center justify-center p-6 bg-gradient-to-br from-purple-50 to-white dark:from-gray-900 dark:to-gray-800 rounded-2xl shadow-lg\">\n      <div className=\"relative w-80 h-80 md:w-96 md:h-96 flex items-center justify-center\">\n        {/* Animated background glow */}\n        <motion.div\n          className=\"absolute inset-0 rounded-3xl opacity-30\"\n          style={{ \n            background: `radial-gradient(circle, ${config.glowColor}, transparent 70%)`,\n          }}\n          animate={{\n            scale: isThinking ? [1, 1.2, 1] : [1, 1.1, 1],\n            opacity: isThinking ? [0.3, 0.5, 0.3] : [0.2, 0.4, 0.2],\n          }}\n          transition={{\n            duration: isThinking ? 1.5 : 3,\n            repeat: Infinity,\n            ease: \"easeInOut\"\n          }}\n        />\n\n        {/* Main avatar with amplified animation */}\n        <div\n          className=\"relative w-64 h-64 md:w-80 md:h-80 rounded-3xl overflow-hidden border-4 shadow-2xl\"\n          style={{ borderColor: config.particleColor }}\n        >\n          <video \n            src={config.video} \n            className=\"w-full h-full object-cover\"\n            autoPlay\n            loop\n            muted\n            playsInline\n          />\n          \n          {/* Overlay glow effect */}\n          <motion.div\n            className=\"absolute inset-0\"\n            style={{ \n              background: `radial-gradient(circle at 30% 30%, ${config.glowColor}, transparent 60%)`,\n            }}\n            animate={{\n              opacity: isThinking ? [0.3, 0.6, 0.3] : [0.2, 0.4, 0.2],\n            }}\n            transition={{\n              duration: isThinking ? 1.5 : 3,\n              repeat: Infinity,\n              ease: \"easeInOut\"\n            }}\n          />\n        </div>\n\n        {/* Floating particles */}\n        {particles.map((particle) => (\n          <motion.div\n            key={particle.id}\n            className=\"absolute w-2 h-2 rounded-full\"\n            style={{\n              backgroundColor: config.particleColor,\n              left: `${particle.x}%`,\n              top: `${particle.y}%`,\n            }}\n            animate={{\n              y: [0, -40, 0],\n              opacity: [0, 1, 0],\n              scale: [0, 1.5, 0],\n            }}\n            transition={{\n              duration: 3 + Math.random() * 2,\n              repeat: Infinity,\n              delay: Math.random() * 2,\n              ease: \"easeInOut\"\n            }}\n          />\n        ))}\n\n        {/* Thinking indicator */}\n        {isThinking && (\n          <motion.div\n            className=\"absolute -bottom-4 left-1/2 transform -translate-x-1/2 px-4 py-2 rounded-full text-sm font-semibold shadow-lg\"\n            style={{ \n              backgroundColor: config.particleColor,\n              color: 'white'\n            }}\n            animate={{\n              scale: [1, 1.05, 1],\n            }}\n            transition={{\n              duration: 1,\n              repeat: Infinity,\n              ease: \"easeInOut\"\n            }}\n          >\n            Thinking...\n          </motion.div>\n        )}\n      </div>\n\n      {/* Personality name */}\n      <motion.h3 \n        className=\"mt-6 text-2xl md:text-3xl font-bold\"\n        style={{ color: config.particleColor }}\n        initial={{ opacity: 0, y: 10 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ duration: 0.5 }}\n      >\n        {config.name}\n      </motion.h3>\n    </div>\n  );\n}\n\nexport function AICoachAvatar({ personality, isThinking = false, size = 'medium' }: AICoachAvatarProps) {\n  const config = AVATAR_CONFIG[personality];\n  const [particles, setParticles] = useState<Array<{ id: number; x: number; y: number }>>([]);\n\n  // Generate random particles\n  useEffect(() => {\n    const newParticles = Array.from({ length: 8 }, (_, i) => ({\n      id: i,\n      x: Math.random() * 100,\n      y: Math.random() * 100,\n    }));\n    setParticles(newParticles);\n  }, [personality]);\n\n  const sizes = {\n    small: 'w-16 h-16',\n    medium: 'w-32 h-32',\n    large: 'w-48 h-48'\n  };\n\n  const containerSizes = {\n    small: 'w-20 h-20',\n    medium: 'w-40 h-40',\n    large: 'w-56 h-56'\n  };\n\n  // Personality-specific animations (disabled for small thumbnails)\n  const getPersonalityAnimation = () => {\n    // No animations for small thumbnails to avoid visual conflict\n    if (size === 'small') {\n      return {};\n    }\n\n    switch (personality) {\n      case 'military':\n        // Aggressive shouting motion - vigorous shaking\n        return {\n          rotate: isThinking ? [-5, 5, -5, 5, -5] : [-3, 3, -3],\n          y: isThinking ? [-5, 5, -5, 5, -5] : [-3, 3, -3],\n          x: isThinking ? [-3, 3, -3, 3, -3] : [-2, 2, -2],\n          transition: {\n            duration: isThinking ? 0.3 : 0.6,\n            repeat: Infinity,\n            ease: \"easeInOut\"\n          }\n        };\n      case 'gym_bro':\n        // Enthusiastic wave/bounce - energetic movement\n        return {\n          rotate: isThinking ? [0, -8, 8, -8, 8, 0] : [0, -5, 5, 0],\n          y: isThinking ? [0, -8, 0, -8, 0] : [0, -5, 0],\n          x: isThinking ? [-5, 0, 5, 0, -5] : [-3, 0, 3, 0],\n          scale: isThinking ? [1, 1.05, 1, 1.05, 1] : [1, 1.03, 1],\n          transition: {\n            duration: isThinking ? 0.5 : 1,\n            repeat: Infinity,\n            ease: \"easeInOut\"\n          }\n        };\n      case 'zen':\n        // Gentle meditation breathing/sway - smooth and slow\n        return {\n          rotate: [0, -2, 0, 2, 0],\n          y: [0, -4, 0, -4, 0],\n          x: [-2, 0, 2, 0, -2],\n          scale: [1, 1.01, 1, 1.01, 1],\n          transition: {\n            duration: 5,\n            repeat: Infinity,\n            ease: \"easeInOut\"\n          }\n        };\n      case 'clinical':\n        // Thoughtful pondering with head tilt - analytical movement\n        return {\n          rotate: isThinking ? [-6, 6, -6, 6, 0] : [0, 4, 0, -4, 0],\n          x: isThinking ? [0, 5, 0, -5, 0] : [0, 3, 0, -3, 0],\n          y: isThinking ? [-3, 0, -3, 0, -3] : [-2, 0, -2, 0, -2],\n          transition: {\n            duration: isThinking ? 1.2 : 2.5,\n            repeat: Infinity,\n            ease: \"easeInOut\"\n          }\n        };\n      case 'dark_humour':\n        // Mischievous tilt and smirk - playful movement\n        return {\n          rotate: isThinking ? [0, 5, -5, 5, 0] : [0, 3, 0, -3, 0],\n          y: isThinking ? [0, -4, 0, -4, 0] : [0, -3, 0],\n          x: isThinking ? [3, -3, 3, -3, 0] : [2, -2, 2, 0],\n          scale: isThinking ? [1, 1.03, 1, 1.03, 1] : [1, 1.02, 1],\n          transition: {\n            duration: isThinking ? 0.8 : 2,\n            repeat: Infinity,\n            ease: \"easeInOut\"\n          }\n        };\n      case 'alex':\n        // Confident head tilt with sarcastic swagger - Army-meets-mum energy\n        return {\n          rotate: isThinking ? [-4, 4, -4, 4, 0] : [0, -3, 3, 0],\n          y: isThinking ? [-3, 3, -3, 3, 0] : [-2, 2, -2, 0],\n          x: isThinking ? [0, 4, -4, 0] : [0, 3, -3, 0],\n          scale: isThinking ? [1, 1.03, 1, 1.03, 1] : [1, 1.02, 1],\n          transition: {\n            duration: isThinking ? 1 : 1.8,\n            repeat: Infinity,\n            ease: \"easeInOut\"\n          }\n        };\n      default:\n        return {\n          scale: [1, 1.02, 1],\n          transition: {\n            duration: 2,\n            repeat: Infinity,\n            ease: \"easeInOut\"\n          }\n        };\n    }\n  };\n\n  return (\n    <div className=\"relative flex items-center justify-center\">\n      <div className={`relative ${containerSizes[size]}`}>\n        {/* Outer glow ring */}\n        <motion.div\n          className=\"absolute inset-0 rounded-full blur-xl\"\n          style={{ \n            background: `radial-gradient(circle, ${config.glowColor} 0%, transparent 70%)`,\n          }}\n          animate={{\n            scale: isThinking ? [1, 1.2, 1] : [1, 1.1, 1],\n            opacity: isThinking ? [0.6, 0.9, 0.6] : [0.4, 0.6, 0.4],\n          }}\n          transition={{\n            duration: isThinking ? 1.5 : 3,\n            repeat: Infinity,\n            ease: \"easeInOut\"\n          }}\n        />\n\n        {/* Pulsing ring */}\n        <motion.div\n          className=\"absolute inset-2 rounded-full border-2\"\n          style={{ borderColor: config.particleColor }}\n          animate={{\n            scale: [1, 1.05, 1],\n            opacity: [0.3, 0.6, 0.3],\n          }}\n          transition={{\n            duration: 2,\n            repeat: Infinity,\n            ease: \"easeInOut\"\n          }}\n        />\n\n        {/* Avatar image with personality-specific animation */}\n        <div\n          className={`relative ${sizes[size]} rounded-full overflow-hidden border-4 shadow-2xl`}\n          style={{ borderColor: config.particleColor }}\n        >\n          <video \n            src={config.video} \n            className=\"w-full h-full object-cover\"\n            autoPlay\n            loop\n            muted\n            playsInline\n          />\n          \n          {/* Overlay glow effect */}\n          <motion.div\n            className=\"absolute inset-0\"\n            style={{ \n              background: `radial-gradient(circle at 30% 30%, ${config.glowColor}, transparent 60%)`,\n            }}\n            animate={{\n              opacity: isThinking ? [0.3, 0.6, 0.3] : [0.2, 0.4, 0.2],\n            }}\n            transition={{\n              duration: isThinking ? 1.5 : 3,\n              repeat: Infinity,\n              ease: \"easeInOut\"\n            }}\n          />\n        </div>\n\n        {/* Floating particles */}\n        {particles.map((particle) => (\n          <motion.div\n            key={particle.id}\n            className=\"absolute w-1 h-1 rounded-full\"\n            style={{\n              backgroundColor: config.particleColor,\n              left: `${particle.x}%`,\n              top: `${particle.y}%`,\n            }}\n            animate={{\n              y: [0, -20, 0],\n              opacity: [0, 1, 0],\n              scale: [0, 1, 0],\n            }}\n            transition={{\n              duration: 3 + Math.random() * 2,\n              repeat: Infinity,\n              delay: Math.random() * 2,\n              ease: \"easeInOut\"\n            }}\n          />\n        ))}\n\n        {/* Thinking indicator */}\n        {isThinking && (\n          <motion.div\n            className=\"absolute -bottom-2 left-1/2 transform -translate-x-1/2 px-3 py-1 rounded-full text-xs font-semibold shadow-lg\"\n            style={{ \n              backgroundColor: config.particleColor,\n              color: 'white'\n            }}\n            initial={{ opacity: 0, y: 10 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: 10 }}\n          >\n            Thinking...\n          </motion.div>\n        )}\n      </div>\n    </div>\n  );\n}\n","size_bytes":16470},"server/services/user-context-service.ts":{"content":"import { storage } from \"../storage\";\nimport type { UserProfile, DiaryEntry, WeightEntry, DrinkEntry, ShiftSchedule, WaterIntake } from \"@shared/schema\";\n\n/**\n * User Context Service\n * \n * Aggregates all relevant user data for AI Coach personalization.\n * This service collects data from multiple sources to provide comprehensive\n * context about the user's nutrition habits, progress, and preferences.\n */\n\n// Extended types for context\ninterface NutritionGoalsExtended {\n  dailyCalories: number | null;\n  dailyProtein: number | null;\n  dailyCarbs: number | null;\n  dailyFat: number | null;\n  dailyWater: number | null;\n}\n\ninterface DiaryEntryWithAnalysis extends DiaryEntry {\n  analysis?: {\n    totalCalories: number;\n    totalProtein: number;\n    totalCarbs: number;\n    totalFat: number;\n  };\n}\n\nexport interface UserContext {\n  // User profile and preferences\n  profile: UserProfile | null;\n  nutritionGoals: NutritionGoalsExtended | null;\n  \n  // Recent activity (last 7 days)\n  recentDiary: DiaryEntryWithAnalysis[];\n  recentWeights: WeightEntry[];\n  recentDrinks: DrinkEntry[]; // Legacy - kept for backwards compatibility\n  recentWaterIntake: WaterIntake[]; // New water tracking system\n  todaySteps: number;\n  \n  // Patterns and trends\n  weeklyMealCount: number;\n  averageDailyCalories: number;\n  weightTrend: 'increasing' | 'decreasing' | 'stable' | 'insufficient_data';\n  \n  // Shopping and preferences\n  shoppingList: any[];\n  \n  // Shift schedule (current week)\n  shiftSchedules: ShiftSchedule[];\n  \n  // Engagement metrics\n  currentStreak: number;\n  activeChallenges: any[];\n  totalPoints: number;\n}\n\nclass UserContextService {\n  /**\n   * Gather comprehensive user context for AI personalization\n   */\n  async getUserContext(userId: string): Promise<UserContext> {\n    try {\n      // Get current week's date range for shift schedules (timezone-safe)\n      const today = new Date();\n      const startOfWeek = new Date(today);\n      startOfWeek.setDate(today.getDate() - today.getDay()); // Start on Sunday\n      startOfWeek.setUTCHours(0, 0, 0, 0); // Reset to UTC midnight\n      const endOfWeek = new Date(startOfWeek);\n      endOfWeek.setDate(startOfWeek.getDate() + 6); // End on Saturday\n      endOfWeek.setUTCHours(0, 0, 0, 0); // Reset to UTC midnight\n      \n      // Use timezone-safe date formatting to avoid off-by-one day errors\n      const startDate = startOfWeek.toLocaleDateString('en-CA', { timeZone: 'UTC' });\n      const endDate = endOfWeek.toLocaleDateString('en-CA', { timeZone: 'UTC' });\n      \n      // Get today's date for water intake\n      const todayDate = new Date().toISOString().split('T')[0]; // YYYY-MM-DD\n      \n      // Fetch all data in parallel for better performance\n      const [\n        profile,\n        nutritionGoals,\n        recentDiary,\n        recentWeights,\n        recentDrinks,\n        recentWaterIntake,\n        shoppingList,\n        stepsData,\n        challengeData,\n        shiftSchedules,\n      ] = await Promise.all([\n        storage.getUserProfile(userId),\n        storage.getNutritionGoals(userId),\n        storage.getDiaryEntries(userId, 30), // Last 30 entries\n        storage.getWeightEntries(userId), // Get all weights\n        storage.getDrinkEntries(userId, 50), // Last 50 drink entries (legacy)\n        storage.getWaterIntakeByDate(userId, todayDate), // Today's water intake (new system)\n        this.getShoppingList(userId),\n        this.getStepsToday(userId),\n        this.getChallengeData(userId),\n        storage.getShiftSchedules(userId, startDate, endDate),\n      ]);\n\n      // Enrich diary entries with analysis data\n      const enrichedDiary = await this.enrichDiaryEntries(recentDiary.slice(0, 30));\n\n      // Calculate patterns and trends\n      const weeklyMealCount = this.calculateWeeklyMealCount(enrichedDiary);\n      const averageDailyCalories = this.calculateAverageDailyCalories(enrichedDiary);\n      const weightTrend = this.calculateWeightTrend(recentWeights.slice(0, 30));\n      \n      return {\n        profile: profile || null,\n        nutritionGoals: nutritionGoals ? {\n          dailyCalories: nutritionGoals.dailyCalories,\n          dailyProtein: nutritionGoals.dailyProtein,\n          dailyCarbs: nutritionGoals.dailyCarbs,\n          dailyFat: nutritionGoals.dailyFat,\n          dailyWater: nutritionGoals.dailyWater,\n        } : null,\n        recentDiary: enrichedDiary.slice(0, 20), // Only include most recent 20 for context\n        recentWeights: recentWeights.slice(0, 10), // Last 10 weigh-ins\n        recentDrinks: recentDrinks.slice(0, 20), // Last 20 drink entries (legacy)\n        recentWaterIntake: recentWaterIntake || [], // Today's water intake (new system)\n        todaySteps: stepsData.stepCount,\n        weeklyMealCount,\n        averageDailyCalories,\n        weightTrend,\n        shoppingList,\n        shiftSchedules: shiftSchedules || [],\n        currentStreak: challengeData.streak,\n        activeChallenges: challengeData.active,\n        totalPoints: challengeData.points,\n      };\n    } catch (error) {\n      console.error('Error gathering user context:', error);\n      // Return minimal context on error\n      return {\n        profile: null,\n        nutritionGoals: null,\n        recentDiary: [],\n        recentWeights: [],\n        recentDrinks: [],\n        recentWaterIntake: [],\n        todaySteps: 0,\n        weeklyMealCount: 0,\n        averageDailyCalories: 0,\n        weightTrend: 'insufficient_data',\n        shoppingList: [],\n        shiftSchedules: [],\n        currentStreak: 0,\n        activeChallenges: [],\n        totalPoints: 0,\n      };\n    }\n  }\n\n  /**\n   * Format context into a readable string for AI prompts\n   */\n  formatContextForAI(context: UserContext): string {\n    const sections: string[] = [];\n\n    // User Profile\n    if (context.profile) {\n      const profile = context.profile;\n      \n      sections.push(`USER PROFILE:\n- Name: ${profile.name || 'Not set'}\n- Age: ${profile.age || 'Not set'}\n- Sex: ${profile.sex || 'Not set'}\n- Height: ${profile.heightCm ? `${profile.heightCm}cm` : 'Not set'}\n- Current Weight: ${profile.currentWeightKg ? `${profile.currentWeightKg}kg` : 'Not set'}\n- Goal Weight: ${profile.goalWeightKg ? `${profile.goalWeightKg}kg` : 'Not set'}\n- Activity Level: ${profile.activityLevel || 'Not set'}\n- Weight Goal: ${profile.weightGoal || 'Not set'}\n- Dietary Requirements: ${profile.dietaryRequirements?.join(', ') || 'None'}\n- Allergies: ${profile.allergies?.join(', ') || 'None'}\n- Food Dislikes: ${profile.foodDislikes || 'None'}\n- Health Conditions: ${profile.healthConditions || 'None'}\n- Medication: ${profile.medication || 'None'}`);\n    }\n\n    // Shift Schedule (Current Week)\n    if (context.shiftSchedules && context.shiftSchedules.length > 0) {\n      // Get today's date in timezone-safe format\n      const todayDate = new Date();\n      todayDate.setUTCHours(0, 0, 0, 0);\n      const today = todayDate.toLocaleDateString('en-CA', { timeZone: 'UTC' });\n      \n      const shiftLabels: Record<string, string> = {\n        'day_off': 'Day Off',\n        'regular': 'Regular (9am-5pm)',\n        'early_shift': 'Early Shift (6am-2pm)',\n        'late_shift': 'Late Shift (2pm-10pm)',\n        'night_shift': 'Night Shift (Overnight)',\n        'long_shift': 'Long Shift (12.5hrs)',\n        'custom': 'Custom Shift'\n      };\n\n      // Create a map of scheduled shifts for easy lookup\n      const shiftMap = new Map(context.shiftSchedules.map(s => [s.shiftDate, s]));\n      \n      // Generate full week schedule, showing gaps\n      const startOfWeek = new Date(todayDate);\n      startOfWeek.setDate(todayDate.getDate() - todayDate.getDay());\n      startOfWeek.setUTCHours(0, 0, 0, 0);\n      \n      const weekSchedule: string[] = [];\n      for (let i = 0; i < 7; i++) {\n        const currentDay = new Date(startOfWeek);\n        currentDay.setDate(startOfWeek.getDate() + i);\n        const dateStr = currentDay.toLocaleDateString('en-CA', { timeZone: 'UTC' });\n        const dayName = currentDay.toLocaleDateString('en-US', { weekday: 'short', timeZone: 'UTC' });\n        const isToday = dateStr === today;\n        const todayMarker = isToday ? ' â† TODAY' : '';\n        \n        const shift = shiftMap.get(dateStr);\n        \n        if (shift) {\n          let shiftInfo = shiftLabels[shift.shiftType] || shift.shiftType;\n          \n          if (shift.shiftType === 'custom' && shift.customShiftStart && shift.customShiftEnd) {\n            shiftInfo = `Custom (${shift.customShiftStart}-${shift.customShiftEnd})`;\n          }\n          \n          let breakInfo = '';\n          if (shift.breakWindows && shift.breakWindows.length > 0) {\n            breakInfo = `, Breaks: ${shift.breakWindows.join(', ')}`;\n          }\n          \n          weekSchedule.push(`  ${dayName} ${dateStr}: ${shiftInfo}${breakInfo}${todayMarker}`);\n        } else {\n          weekSchedule.push(`  ${dayName} ${dateStr}: No schedule logged${todayMarker}`);\n        }\n      }\n\n      sections.push(`WORK SHIFT SCHEDULE (This Week):\n${weekSchedule.join('\\n')}\n\n**Important**: Use this shift schedule to provide personalized nutrition advice. Consider shift timing when suggesting meals, account for night shifts when recommending sleep/eating patterns, and acknowledge days off for meal prep opportunities. If days show \"No schedule logged,\" the user hasn't planned their shifts for those days yet.`);\n    }\n\n    // Nutrition Goals\n    if (context.nutritionGoals) {\n      const goals = context.nutritionGoals;\n      sections.push(`NUTRITION GOALS:\n- Daily Calories: ${goals.dailyCalories || 'Not set'} kcal\n- Protein: ${goals.dailyProtein || 'Not set'}g\n- Carbs: ${goals.dailyCarbs || 'Not set'}g\n- Fat: ${goals.dailyFat || 'Not set'}g\n- Water: ${goals.dailyWater || 'Not set'}ml`);\n    }\n\n    // Weight Trends\n    if (context.recentWeights.length > 0) {\n      const latestWeight = context.recentWeights[0];\n      const latestWeightKg = latestWeight.weightGrams / 1000;\n      \n      let weightChangeInfo = '';\n      if (context.recentWeights.length > 1) {\n        const oldestWeight = context.recentWeights[context.recentWeights.length - 1];\n        const oldestWeightKg = oldestWeight.weightGrams / 1000;\n        const weightChange = latestWeightKg - oldestWeightKg;\n        weightChangeInfo = `\\n- Recent Change: ${weightChange > 0 ? '+' : ''}${weightChange.toFixed(1)}kg`;\n      }\n      \n      sections.push(`WEIGHT TRACKING:\n- Current Weight: ${latestWeightKg.toFixed(1)}kg\n- Trend: ${context.weightTrend}${weightChangeInfo}\n- Total Weigh-ins: ${context.recentWeights.length}`);\n    }\n\n    // Recent Eating Patterns\n    if (context.recentDiary.length > 0) {\n      const recentMeals = context.recentDiary\n        .slice(0, 3)\n        .map(entry => {\n          const cals = entry.analysis?.totalCalories || 0;\n          return `${entry.mealType} (${cals}kcal)`;\n        })\n        .join(', ');\n      \n      sections.push(`RECENT EATING PATTERNS (Last 7 Days):\n- Meals Logged: ${context.weeklyMealCount}\n- Average Daily Calories: ${Math.round(context.averageDailyCalories)} kcal\n- Most Recent Meals: ${recentMeals || 'None'}`);\n    }\n\n    // Hydration - Use new water tracking system\n    if (context.recentWaterIntake && context.recentWaterIntake.length > 0) {\n      const todayWater = context.recentWaterIntake.reduce((sum, entry) => sum + entry.amountMl, 0);\n      const waterGoal = context.nutritionGoals?.dailyWater || 2500;\n      const percentOfGoal = Math.round((todayWater / waterGoal) * 100);\n      \n      sections.push(`HYDRATION:\n- Today's Fluid Intake: ${todayWater}ml\n- Daily Goal: ${waterGoal}ml\n- Progress: ${percentOfGoal}% of daily goal\n- Drinks Logged Today: ${context.recentWaterIntake.length}`);\n    } else {\n      // No water logged today\n      const waterGoal = context.nutritionGoals?.dailyWater || 2500;\n      sections.push(`HYDRATION:\n- Today's Fluid Intake: 0ml\n- Daily Goal: ${waterGoal}ml\n- Progress: 0% of daily goal\n- No fluid logged yet today`);\n    }\n\n    // Activity\n    if (context.todaySteps > 0) {\n      sections.push(`ACTIVITY:\n- Today's Steps: ${context.todaySteps}`);\n    }\n\n    // Engagement\n    sections.push(`ENGAGEMENT:\n- Current Streak: ${context.currentStreak} days\n- Active Challenges: ${context.activeChallenges.length}\n- Total Points: ${context.totalPoints}`);\n\n    // Shopping List\n    if (context.shoppingList && context.shoppingList.length > 0) {\n      const uncheckedItems = context.shoppingList.filter((item: any) => !item.checked || item.checked === 0);\n      const checkedItems = context.shoppingList.filter((item: any) => item.checked === 1);\n      \n      const itemsList = context.shoppingList\n        .map((item: any, index: number) => {\n          const name = item.itemName || item.name || item;\n          const status = item.checked === 1 ? 'âœ“' : 'â—‹';\n          return `${status} ${name}`;\n        })\n        .join('\\n  ');\n      \n      sections.push(`SHOPPING LIST (${context.shoppingList.length} items, ${uncheckedItems.length} remaining):\n  ${itemsList}`);\n    }\n\n    return sections.join('\\n\\n');\n  }\n\n  // Helper methods\n\n  private async enrichDiaryEntries(entries: DiaryEntry[]): Promise<DiaryEntryWithAnalysis[]> {\n    const enriched = await Promise.all(\n      entries.map(async (entry) => {\n        try {\n          const analysis = await storage.getFoodAnalysis(entry.analysisId);\n          return {\n            ...entry,\n            analysis: analysis ? {\n              totalCalories: analysis.totalCalories,\n              totalProtein: analysis.totalProtein,\n              totalCarbs: analysis.totalCarbs,\n              totalFat: analysis.totalFat,\n            } : undefined,\n          };\n        } catch {\n          return { ...entry, analysis: undefined };\n        }\n      })\n    );\n    return enriched;\n  }\n\n  private async getShoppingList(userId: string): Promise<any[]> {\n    try {\n      // Check if shopping list functionality exists in storage\n      if (typeof (storage as any).getShoppingList === 'function') {\n        return await (storage as any).getShoppingList(userId);\n      }\n      return [];\n    } catch {\n      return [];\n    }\n  }\n\n  private async getStepsToday(userId: string): Promise<{ stepCount: number }> {\n    try {\n      if (typeof (storage as any).getStepsToday === 'function') {\n        return await (storage as any).getStepsToday(userId);\n      }\n      return { stepCount: 0 };\n    } catch {\n      return { stepCount: 0 };\n    }\n  }\n\n  private async getChallengeData(userId: string): Promise<{ streak: number; active: any[]; points: number }> {\n    try {\n      // Streak is stored in localStorage (client-side), so we can't access it here\n      // We'll rely on the client to pass this or calculate from diary entries\n      const streak = 0;\n      \n      // Try to get challenge data if available\n      let active: any[] = [];\n      let points = 0;\n      \n      if (typeof (storage as any).getActiveChallenges === 'function') {\n        active = await (storage as any).getActiveChallenges(userId);\n      }\n      \n      if (typeof (storage as any).getUserPoints === 'function') {\n        const pointsData = await (storage as any).getUserPoints(userId);\n        points = pointsData?.totalPoints || 0;\n      }\n      \n      return { streak, active, points };\n    } catch {\n      return { streak: 0, active: [], points: 0 };\n    }\n  }\n\n  private calculateWeeklyMealCount(diaryEntries: DiaryEntryWithAnalysis[]): number {\n    const oneWeekAgo = new Date();\n    oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);\n    \n    return diaryEntries.filter(entry => {\n      const entryDate = new Date(entry.mealDate);\n      return entryDate >= oneWeekAgo;\n    }).length;\n  }\n\n  private calculateAverageDailyCalories(diaryEntries: DiaryEntryWithAnalysis[]): number {\n    const oneWeekAgo = new Date();\n    oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);\n    \n    const recentEntries = diaryEntries.filter(entry => {\n      const entryDate = new Date(entry.mealDate);\n      return entryDate >= oneWeekAgo;\n    });\n    \n    if (recentEntries.length === 0) return 0;\n    \n    const totalCalories = recentEntries.reduce((sum, entry) => {\n      return sum + (entry.analysis?.totalCalories || 0);\n    }, 0);\n    \n    const uniqueDays = new Set(\n      recentEntries.map(e => new Date(e.mealDate).toDateString())\n    ).size;\n    \n    return uniqueDays > 0 ? totalCalories / uniqueDays : 0;\n  }\n\n  private calculateWeightTrend(weightEntries: WeightEntry[]): 'increasing' | 'decreasing' | 'stable' | 'insufficient_data' {\n    if (weightEntries.length < 3) return 'insufficient_data';\n    \n    // Use last 5 entries for trend\n    const recentWeights = weightEntries.slice(0, Math.min(5, weightEntries.length));\n    const oldestKg = recentWeights[recentWeights.length - 1].weightGrams / 1000;\n    const newestKg = recentWeights[0].weightGrams / 1000;\n    const change = newestKg - oldestKg;\n    \n    // Consider stable if change is less than 0.5kg\n    if (Math.abs(change) < 0.5) return 'stable';\n    return change > 0 ? 'increasing' : 'decreasing';\n  }\n}\n\nexport const userContextService = new UserContextService();\n","size_bytes":17024},"server/ai-providers/huggingface-provider.ts":{"content":"import { promises as fs } from \"fs\";\nimport { AIProvider, FoodAnalysisResult, FoodDetectionResult, DietAdviceResult, DiaryEntry, ProviderError, DailyCoaching, EducationalTip } from \"./types\";\n\nexport class HuggingFaceProvider extends AIProvider {\n  public readonly name = \"HuggingFace\";\n  public readonly priority = 2; // Second priority (free backup)\n  public readonly maxRetries = 2;\n\n  private apiKey: string;\n  private baseUrl = \"https://api-inference.huggingface.co/models\";\n\n  constructor() {\n    super();\n    this.apiKey = process.env.HUGGINGFACE_API_KEY || \"\";\n  }\n\n  async performHealthCheck(): Promise<any> {\n    const startTime = Date.now();\n    \n    try {\n      if (!this.apiKey) {\n        throw new Error(\"HUGGINGFACE_API_KEY not configured\");\n      }\n\n      // Simple health check with a text generation model\n      const response = await fetch(`${this.baseUrl}/mistralai/Mistral-7B-Instruct-v0.2`, {\n        method: \"POST\",\n        headers: {\n          \"Authorization\": `Bearer ${this.apiKey}`,\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          inputs: \"Health check\",\n          parameters: {\n            max_new_tokens: 10\n          }\n        })\n      });\n\n      const responseTime = Date.now() - startTime;\n      \n      if (!response.ok) {\n        throw new Error(`Health check failed: ${response.statusText}`);\n      }\n\n      return {\n        providerName: this.name,\n        healthy: true,\n        responseTime,\n        timestamp: new Date(),\n        details: {\n          model: \"mistralai/Mistral-7B-Instruct-v0.2\",\n          apiVersion: \"1.0\"\n        }\n      };\n    } catch (error: any) {\n      const responseTime = Date.now() - startTime;\n      \n      return {\n        providerName: this.name,\n        healthy: false,\n        responseTime,\n        error: error.message,\n        timestamp: new Date()\n      };\n    }\n  }\n\n  private async queryVisionModel(imageBytes: Buffer): Promise<string> {\n    // Use BLIP for image captioning - send binary data directly\n    const response = await fetch(`${this.baseUrl}/Salesforce/blip-image-captioning-base`, {\n      method: \"POST\",\n      headers: {\n        \"Authorization\": `Bearer ${this.apiKey}`,\n      },\n      body: new Uint8Array(imageBytes)\n    });\n\n    if (!response.ok) {\n      const errorText = await response.text();\n      throw new Error(`HuggingFace vision API error: ${response.statusText} - ${errorText}`);\n    }\n\n    const result = await response.json();\n    return Array.isArray(result) ? result[0]?.generated_text || \"\" : result.generated_text || \"\";\n  }\n\n  private async queryTextModel(prompt: string, maxTokens: number = 1000): Promise<string> {\n    // Use Mistral-7B-Instruct which is free, reliable, and high-quality\n    const response = await fetch(`${this.baseUrl}/mistralai/Mistral-7B-Instruct-v0.2`, {\n      method: \"POST\",\n      headers: {\n        \"Authorization\": `Bearer ${this.apiKey}`,\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({\n        inputs: prompt,\n        parameters: {\n          max_new_tokens: maxTokens,\n          temperature: 0.7,\n          top_p: 0.9,\n          return_full_text: false\n        }\n      })\n    });\n\n    if (!response.ok) {\n      const errorText = await response.text();\n      \n      // Check for rate limiting or quota errors\n      if (response.status === 429 || errorText.includes('rate limit')) {\n        const retryAfter = response.headers.get('retry-after');\n        throw this.createError(\n          'RATE_LIMIT',\n          'HuggingFace rate limit exceeded',\n          true,\n          true,\n          retryAfter ? parseInt(retryAfter) : 60\n        );\n      }\n      \n      throw new Error(`HuggingFace text API error: ${response.statusText} - ${errorText}`);\n    }\n\n    const result = await response.json();\n    return Array.isArray(result) ? result[0]?.generated_text || \"\" : result.generated_text || \"\";\n  }\n\n  async analyzeFoodImage(imagePath: string): Promise<FoodAnalysisResult> {\n    try {\n      if (!this.apiKey) {\n        throw new Error(\"HUGGINGFACE_API_KEY not configured\");\n      }\n\n      // Read image file\n      const imageBytes = await fs.readFile(imagePath);\n      \n      // First, get a caption of the image\n      const caption = await this.queryVisionModel(imageBytes);\n\n      // Then use text model to analyze the food\n      const prompt = `Based on this food image description: \"${caption}\"\n\nAnalyze this food and identify all visible food items.\n\nPORTION ESTIMATION GUIDELINES - BE CONSERVATIVE AND REALISTIC:\n- Default to MEDIUM portions unless clearly otherwise\n- Don't over-estimate portion sizes or assume extra toppings not mentioned in the description\n- Explicitly state what toppings/ingredients are visible\n- If in doubt about portion size, choose the smaller estimate\n\nCRITICAL UK FOOD PORTIONS WITH TYPICAL CALORIE RANGES:\n- Jacket potato (plain): Medium (200g) = ~150-180 cal | with butter add ~70 cal | with cheese add ~100 cal\n  * Only add toppings you can clearly identify from the description\n  * Jacket potato >600 cal is almost certainly wrong unless massive with lots of toppings\n- UK crisps/chips: Single-serve packet = 25g (~130 cal) | sharing bag = 150g (~780 cal)\n- Fish & chips: Medium portion = ~600-700 cal total\n- Full English breakfast: Standard = ~800-1000 cal\n- Sandwich: Standard = 250-400 cal depending on fillings\n\nReturn ONLY a JSON object with this exact structure (no additional text):\n\n{\n  \"confidence\": number (0-100),\n  \"detectedFoods\": [\n    {\n      \"name\": \"Food Name with visible toppings/ingredients clearly stated\",\n      \"portion\": \"estimated portion size with weight/volume (be conservative)\",\n      \"icon\": \"appropriate icon name from: egg, bacon, bread-slice, apple-alt\"\n    }\n  ]\n}\n\nOnly return the JSON object, nothing else.`;\n\n      const responseText = await this.queryTextModel(prompt, 800);\n      \n      // Clean the response text by removing markdown formatting\n      const cleanedText = responseText\n        .replace(/```json\\s*/g, '')\n        .replace(/```\\s*/g, '')\n        .trim();\n\n      // Parse the JSON response\n      const parsed = JSON.parse(cleanedText);\n      \n      // Validate the response structure\n      if (!parsed.detectedFoods || !Array.isArray(parsed.detectedFoods)) {\n        throw new Error(\"Invalid response format from HuggingFace\");\n      }\n\n      // Convert to legacy format with mock nutrition - will be replaced by USDA lookup\n      const mockNutritionFoods = parsed.detectedFoods.map((food: any) => ({\n        name: food.name,\n        portion: food.portion,\n        calories: 100, // Mock - will be replaced by USDA lookup\n        protein: 5,\n        carbs: 10,\n        fat: 3,\n        icon: food.icon\n      }));\n\n      // Calculate totals from mock data\n      const totalCalories = mockNutritionFoods.reduce((sum: number, food: any) => sum + food.calories, 0);\n      const totalProtein = mockNutritionFoods.reduce((sum: number, food: any) => sum + food.protein, 0);\n      const totalCarbs = mockNutritionFoods.reduce((sum: number, food: any) => sum + food.carbs, 0);\n      const totalFat = mockNutritionFoods.reduce((sum: number, food: any) => sum + food.fat, 0);\n\n      const result: FoodAnalysisResult = {\n        imageUrl: imagePath,\n        confidence: Math.round(parsed.confidence || 70),\n        totalCalories,\n        totalProtein,\n        totalCarbs,\n        totalFat,\n        detectedFoods: mockNutritionFoods\n      };\n\n      this.recordSuccess();\n      return result;\n\n    } catch (error: any) {\n      console.error(\"HuggingFace food analysis error:\", error);\n      \n      let providerError: ProviderError;\n      \n      if (error?.message?.includes('quota') || error?.message?.includes('rate') || error.isRateLimit) {\n        providerError = this.createError(\n          'RATE_LIMIT',\n          'HuggingFace rate limit exceeded',\n          true,\n          true,\n          error.retryAfter || 60\n        );\n      } else if (error?.message?.includes('API') || error?.message?.includes('network')) {\n        providerError = this.createError(\n          'API_ERROR',\n          error.message,\n          false,\n          true\n        );\n      } else {\n        providerError = this.createError(\n          'UNKNOWN_ERROR',\n          error.message,\n          false,\n          true\n        );\n      }\n      \n      this.recordError(providerError);\n      throw providerError;\n    }\n  }\n\n  async analyzeFoodText(foodDescription: string, clientTimeInfo?: { timeString: string, timeOfDay: string, hours: number, minutes: number }): Promise<FoodAnalysisResult> {\n    try {\n      if (!this.apiKey) {\n        throw new Error(\"HUGGINGFACE_API_KEY not configured\");\n      }\n\n      // Add time context for better analysis (use client's local time if provided, otherwise server time)\n      let timeString: string;\n      let timeOfDay: string;\n      \n      if (clientTimeInfo) {\n        // Use pre-calculated client local time (no timezone conversion needed)\n        timeString = clientTimeInfo.timeString;\n        timeOfDay = clientTimeInfo.timeOfDay;\n      } else {\n        // Fallback to server time\n        const now = new Date();\n        const hours = now.getHours();\n        const minutes = now.getMinutes();\n        timeString = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;\n        timeOfDay = hours < 12 ? 'morning' : hours < 17 ? 'afternoon' : 'evening';\n      }\n\n      const prompt = `Current time: ${timeString} (${timeOfDay})\n\nAnalyze this food description: \"${foodDescription}\"\n\nUK FOOD VOCABULARY - THESE ARE SINGLE ITEMS (DO NOT SPLIT):\n- \"jacket potato\" = baked potato (ONE item, not \"bread\" and \"potato\")\n- \"fish and chips\" = ONE dish\n- \"full English\" = ONE breakfast\n- \"beans on toast\" = ONE item\n- Examples:\n  * \"jacket potato\" â†’ [{\"name\": \"Baked potato (jacket potato)\", \"portion\": \"1 medium (200g)\"}] âœ“ CORRECT\n  * \"jacket potato\" â†’ [{\"name\": \"Bread, potato\"}] âœ— WRONG - Do NOT split!\n\nPORTION ESTIMATION - BE CONSERVATIVE:\n- Default to MEDIUM portions unless specified\n- Don't over-estimate or assume extra toppings not mentioned\n- If in doubt, choose the smaller estimate\n\nDEFAULT PORTION SIZES:\n- Jacket potato: 1 medium (200g) plain = ~150-180 cal\n- Chicken breast: 150g cooked\n- Rice (cooked): 200g\n- Vegetables: 100g\n- Eggs: 2 large\n- Bread: 2 slices\n\nCRITICAL UK FOOD PORTIONS WITH TYPICAL CALORIE RANGES:\n- Jacket potato (plain): Medium (200g) = ~150-180 cal | with butter add ~70 cal | with cheese add ~100 cal\n  * Jacket potato >600 cal is almost certainly wrong unless massive with lots of toppings\n- UK crisps: Single-serve packet = 25g (~130 cal)\n- Fish & chips: Medium portion = ~600-700 cal total\n- Sandwich: Standard = 250-400 cal depending on fillings\n\nIdentify the food items and provide nutritional estimates.\n\nReturn ONLY a JSON object with this exact structure (no additional text):\n\n{\n  \"confidence\": number (0-100),\n  \"detectedFoods\": [\n    {\n      \"name\": \"Food Name (e.g., 'Baked potato (jacket potato)')\",\n      \"portion\": \"estimated portion size\",\n      \"icon\": \"appropriate icon name from: egg, bacon, bread-slice, apple-alt\"\n    }\n  ]\n}\n\nIMPORTANT: UK food names like \"jacket potato\" are SINGLE items - do NOT split them!`;\n\n      const responseText = await this.queryTextModel(prompt, 500);\n      \n      const cleanedText = responseText\n        .replace(/```json\\s*/g, '')\n        .replace(/```\\s*/g, '')\n        .trim();\n\n      const parsed = JSON.parse(cleanedText);\n      \n      const mockNutritionFoods = parsed.detectedFoods.map((food: any) => ({\n        name: food.name,\n        portion: food.portion,\n        calories: 100,\n        protein: 5,\n        carbs: 10,\n        fat: 3,\n        icon: food.icon\n      }));\n\n      const totalCalories = mockNutritionFoods.reduce((sum: number, food: any) => sum + food.calories, 0);\n      const totalProtein = mockNutritionFoods.reduce((sum: number, food: any) => sum + food.protein, 0);\n      const totalCarbs = mockNutritionFoods.reduce((sum: number, food: any) => sum + food.carbs, 0);\n      const totalFat = mockNutritionFoods.reduce((sum: number, food: any) => sum + food.fat, 0);\n\n      this.recordSuccess();\n      return {\n        imageUrl: '',\n        confidence: Math.round(parsed.confidence || 80),\n        totalCalories,\n        totalProtein,\n        totalCarbs,\n        totalFat,\n        detectedFoods: mockNutritionFoods\n      };\n\n    } catch (error: any) {\n      console.error(\"HuggingFace text analysis error:\", error);\n      const providerError = this.createError('ANALYSIS_ERROR', error.message, false, true);\n      this.recordError(providerError);\n      throw providerError;\n    }\n  }\n\n  async detectFoodNames(imagePath: string): Promise<FoodDetectionResult> {\n    try {\n      if (!this.apiKey) {\n        throw new Error(\"HUGGINGFACE_API_KEY not configured\");\n      }\n\n      const imageBytes = await fs.readFile(imagePath);\n      \n      const caption = await this.queryVisionModel(imageBytes);\n\n      const prompt = `Based on this food image description: \"${caption}\"\n\nList only the food names detected. Return a JSON object:\n\n{\n  \"confidence\": number (0-100),\n  \"detectedFoodNames\": [\"food1\", \"food2\", ...],\n  \"referenceObjects\": [\"plate\", \"fork\", ...]\n}`;\n\n      const responseText = await this.queryTextModel(prompt, 300);\n      const cleanedText = responseText.replace(/```json\\s*/g, '').replace(/```\\s*/g, '').trim();\n      const parsed = JSON.parse(cleanedText);\n\n      this.recordSuccess();\n      return {\n        confidence: parsed.confidence || 70,\n        detectedFoodNames: parsed.detectedFoodNames || [],\n        referenceObjects: parsed.referenceObjects || []\n      };\n\n    } catch (error: any) {\n      console.error(\"HuggingFace food detection error:\", error);\n      const providerError = this.createError('DETECTION_ERROR', error.message, false, true);\n      this.recordError(providerError);\n      throw providerError;\n    }\n  }\n\n  async generateDietAdvice(entries: DiaryEntry[], userProfile?: any): Promise<DietAdviceResult> {\n    try {\n      if (!this.apiKey) {\n        throw new Error(\"HUGGINGFACE_API_KEY not configured\");\n      }\n\n      const prompt = `Based on the user's recent meals, provide personalized diet advice.\n\nUser Profile: ${JSON.stringify(userProfile || {})}\nRecent Entries: ${entries.length} meals logged\n\nReturn ONLY a JSON object:\n\n{\n  \"personalizedAdvice\": [\"tip1\", \"tip2\", \"tip3\"],\n  \"nutritionGoals\": [\"goal1\", \"goal2\"],\n  \"improvements\": [\"improve1\", \"improve2\"],\n  \"generalTips\": [\"tip1\", \"tip2\"],\n  \"mealIdeas\": []\n}`;\n\n      const responseText = await this.queryTextModel(prompt, 1000);\n      const cleanedText = responseText.replace(/```json\\s*/g, '').replace(/```\\s*/g, '').trim();\n      const parsed = JSON.parse(cleanedText);\n\n      this.recordSuccess();\n      return {\n        personalizedAdvice: parsed.personalizedAdvice || [],\n        nutritionGoals: parsed.nutritionGoals || [],\n        improvements: parsed.improvements || [],\n        generalTips: parsed.generalTips || [],\n        mealIdeas: parsed.mealIdeas || []\n      };\n\n    } catch (error: any) {\n      console.error(\"HuggingFace diet advice error:\", error);\n      const providerError = this.createError('ADVICE_ERROR', error.message, false, true);\n      this.recordError(providerError);\n      throw providerError;\n    }\n  }\n\n  async answerNutritionQuestion(\n    question: string,\n    entries: DiaryEntry[],\n    userProfile?: any,\n    nutritionGoals?: any,\n    coachMemory?: any,\n    personality?: any,\n    clientTimeInfo?: { timeString: string, timeOfDay: string, hours: number, minutes: number }\n  ): Promise<string> {\n    try {\n      if (!this.apiKey) {\n        throw new Error(\"HUGGINGFACE_API_KEY not configured\");\n      }\n\n      // Add time context if provided\n      let timeInfo = \"\";\n      if (clientTimeInfo) {\n        timeInfo = `\\nCurrent time for the user: ${clientTimeInfo.timeString} (${clientTimeInfo.timeOfDay})`;\n      }\n\n      const prompt = `You are a nutrition coach. Answer this question: \"${question}\"${timeInfo}\n\nUser context:\n- Profile: ${JSON.stringify(userProfile || {})}\n- Recent meals: ${entries.length} logged\n- Goals: ${JSON.stringify(nutritionGoals || {})}\n\nProvide a helpful, personalized response.`;\n\n      const response = await this.queryTextModel(prompt, 500);\n      \n      this.recordSuccess();\n      return response.trim();\n\n    } catch (error: any) {\n      console.error(\"HuggingFace question answering error:\", error);\n      const providerError = this.createError('QUESTION_ERROR', error.message, false, true);\n      this.recordError(providerError);\n      throw providerError;\n    }\n  }\n\n  async generateDailyCoaching(entries: DiaryEntry[], userProfile?: any): Promise<DailyCoaching> {\n    try {\n      if (!this.apiKey) {\n        throw new Error(\"HUGGINGFACE_API_KEY not configured\");\n      }\n\n      const prompt = `Generate daily coaching message for a nutrition app user.\n\nUser has logged ${entries.length} meals.\n\nReturn ONLY a JSON object:\n\n{\n  \"motivation\": \"motivational message\",\n  \"nutritionTip\": \"nutrition tip\",\n  \"encouragement\": \"encouraging message\",\n  \"todaysFocus\": \"focus for today\",\n  \"streak\": 1,\n  \"achievement\": \"achievement message\"\n}`;\n\n      const responseText = await this.queryTextModel(prompt, 500);\n      const cleanedText = responseText.replace(/```json\\s*/g, '').replace(/```\\s*/g, '').trim();\n      const parsed = JSON.parse(cleanedText);\n\n      this.recordSuccess();\n      return {\n        motivation: parsed.motivation || \"Keep up the great work!\",\n        nutritionTip: parsed.nutritionTip || \"Stay hydrated throughout the day.\",\n        encouragement: parsed.encouragement || \"You're doing amazing!\",\n        todaysFocus: parsed.todaysFocus || \"Focus on balanced meals.\",\n        streak: parsed.streak || 1,\n        achievement: parsed.achievement\n      };\n\n    } catch (error: any) {\n      console.error(\"HuggingFace coaching error:\", error);\n      const providerError = this.createError('COACHING_ERROR', error.message, false, true);\n      this.recordError(providerError);\n      throw providerError;\n    }\n  }\n\n  async generateEducationalTips(category: 'all' | 'nutrition' | 'medication' | 'motivation'): Promise<EducationalTip[]> {\n    try {\n      if (!this.apiKey) {\n        throw new Error(\"HUGGINGFACE_API_KEY not configured\");\n      }\n\n      const prompt = `Generate 3 educational tips for category: ${category}\n\nReturn ONLY a JSON array:\n\n[\n  {\n    \"id\": \"tip1\",\n    \"title\": \"Tip Title\",\n    \"content\": \"Tip content\",\n    \"category\": \"nutrition\",\n    \"importance\": \"high\"\n  }\n]`;\n\n      const responseText = await this.queryTextModel(prompt, 600);\n      const cleanedText = responseText.replace(/```json\\s*/g, '').replace(/```\\s*/g, '').trim();\n      const parsed = JSON.parse(cleanedText);\n\n      this.recordSuccess();\n      return Array.isArray(parsed) ? parsed : [];\n\n    } catch (error: any) {\n      console.error(\"HuggingFace tips generation error:\", error);\n      const providerError = this.createError('TIPS_ERROR', error.message, false, true);\n      this.recordError(providerError);\n      throw providerError;\n    }\n  }\n}\n","size_bytes":19076},"client/src/components/shift-checkin-modal.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Briefcase, X, Clock } from \"lucide-react\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { motion } from \"framer-motion\";\n\ninterface ShiftCheckInModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n}\n\nexport function ShiftCheckInModal({ isOpen, onClose }: ShiftCheckInModalProps) {\n  const [selectedShift, setSelectedShift] = useState<string>(\"\");\n\n  const shiftOptions = [\n    { value: \"day_off\", label: \"Day Off\", emoji: \"ðŸ–ï¸\", description: \"No shift today\" },\n    { value: \"regular\", label: \"Regular Daytime\", emoji: \"â˜€ï¸\", description: \"Standard 9-5 hours\" },\n    { value: \"early_shift\", label: \"Early Shift\", emoji: \"ðŸŒ…\", description: \"6am-2pm\" },\n    { value: \"late_shift\", label: \"Late Shift\", emoji: \"ðŸŒ†\", description: \"2pm-10pm\" },\n    { value: \"night_shift\", label: \"Night Shift\", emoji: \"ðŸŒ™\", description: \"Overnight hours\" },\n    { value: \"long_shift\", label: \"Long Clinical Shift\", emoji: \"ðŸ¥\", description: \"12.5hr NHS/emergency\" },\n    { value: \"custom\", label: \"Custom Hours\", emoji: \"âš™ï¸\", description: \"Use profile custom times\" },\n  ];\n\n  const updateShiftMutation = useMutation({\n    mutationFn: async (shiftType: string) => {\n      const today = new Date().toISOString().split('T')[0];\n      return await apiRequest('POST', '/api/user-profile', {\n        todayShiftType: shiftType,\n        todayShiftDate: today,\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/user-profile\"] });\n      onClose();\n    },\n  });\n\n  const handleConfirm = () => {\n    if (selectedShift) {\n      updateShiftMutation.mutate(selectedShift);\n    }\n  };\n\n  const handleSkip = () => {\n    // Dismiss for today by setting flag in localStorage\n    const today = new Date().toISOString().split('T')[0];\n    localStorage.setItem(`shift-checkin-dismissed-${today}`, \"true\");\n    onClose();\n  };\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-md\">\n        <DialogHeader>\n          <div className=\"flex items-center justify-between mb-2\">\n            <div className=\"flex items-center gap-2\">\n              <Briefcase className=\"h-5 w-5 text-purple-600\" />\n              <DialogTitle>Today's Shift</DialogTitle>\n            </div>\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={onClose}\n              className=\"h-6 w-6 p-0\"\n              data-testid=\"button-close-shift-checkin\"\n            >\n              <X className=\"h-4 w-4\" />\n            </Button>\n          </div>\n          <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n            Help your AI Coach adapt meal planning for today\n          </p>\n        </DialogHeader>\n\n        <div className=\"space-y-2 mt-4\">\n          {shiftOptions.map((shift) => (\n            <motion.button\n              key={shift.value}\n              type=\"button\"\n              onClick={() => setSelectedShift(shift.value)}\n              whileHover={{ scale: 1.02 }}\n              whileTap={{ scale: 0.98 }}\n              className={`w-full p-4 rounded-xl text-left border-2 transition-all ${\n                selectedShift === shift.value\n                  ? \"border-purple-600 bg-purple-50 dark:bg-purple-900/20\"\n                  : \"border-gray-200 dark:border-gray-700 hover:border-purple-300 dark:hover:border-purple-700\"\n              }`}\n              data-testid={`shift-option-${shift.value}`}\n            >\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center gap-3\">\n                  <span className=\"text-2xl\">{shift.emoji}</span>\n                  <div>\n                    <div className=\"font-medium text-sm\">{shift.label}</div>\n                    <div className=\"text-xs text-gray-500 dark:text-gray-400\">\n                      {shift.description}\n                    </div>\n                  </div>\n                </div>\n                {selectedShift === shift.value && (\n                  <Clock className=\"h-4 w-4 text-purple-600\" />\n                )}\n              </div>\n            </motion.button>\n          ))}\n        </div>\n\n        <div className=\"flex gap-2 mt-6\">\n          <Button\n            variant=\"outline\"\n            onClick={handleSkip}\n            className=\"flex-1\"\n            data-testid=\"button-skip-shift\"\n          >\n            Skip for today\n          </Button>\n          <Button\n            onClick={handleConfirm}\n            disabled={!selectedShift || updateShiftMutation.isPending}\n            className=\"flex-1 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white\"\n            data-testid=\"button-confirm-shift\"\n          >\n            {updateShiftMutation.isPending ? \"Saving...\" : \"Confirm\"}\n          </Button>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":5107},"server/services/shift-meal-plan-service.ts":{"content":"import { type ShiftSchedule, type UserProfile } from \"@shared/schema\";\nimport { aiManager } from \"../ai-providers/ai-manager\";\nimport { type IStorage } from \"../storage\";\n\nexport interface MealPlanMeal {\n  mealType: 'breakfast' | 'lunch' | 'dinner' | 'snack' | 'pre-shift' | 'during-shift' | 'post-shift';\n  name: string;\n  description: string;\n  timing: string; // e.g. \"6:30 AM - Before shift starts\"\n  portability: 'home-only' | 'portable' | 'meal-prep-friendly';\n  calories: number;\n  protein: number;\n  carbs: number;\n  fat: number;\n  ingredients: string[];\n  benefits: string;\n  prepTime: string; // e.g. \"15 mins\"\n  tips: string[]; // Shift-specific tips\n}\n\nexport interface DailyMealPlan {\n  date: string;\n  shiftType: string;\n  shiftStart?: string;\n  shiftEnd?: string;\n  breakWindows?: string[];\n  meals: MealPlanMeal[];\n  dailySummary: string;\n  calorieDistribution: {\n    preShift: number;\n    duringShift: number;\n    postShift: number;\n  };\n}\n\nexport interface WeeklyMealPlan {\n  userId: string;\n  startDate: string;\n  endDate: string;\n  dailyPlans: DailyMealPlan[];\n  weeklyNutrition: {\n    totalCalories: number;\n    avgCaloriesPerDay: number;\n    totalProtein: number;\n    totalCarbs: number;\n    totalFat: number;\n  };\n  shoppingList: {\n    ingredient: string;\n    quantity: string;\n    category: string;\n  }[];\n  weeklyTips: string[];\n}\n\nexport class ShiftMealPlanService {\n  constructor(private storage: IStorage) {}\n\n  async generateWeeklyMealPlan(\n    userId: string,\n    shifts: ShiftSchedule[],\n    userProfile?: UserProfile\n  ): Promise<WeeklyMealPlan> {\n    if (shifts.length === 0) {\n      throw new Error(\"No shifts provided for meal plan generation\");\n    }\n\n    // Get user profile if not provided\n    if (!userProfile) {\n      userProfile = await this.storage.getUserProfile(userId) || undefined;\n    }\n\n    // Get nutrition goals for calorie targets\n    const nutritionGoals = await this.storage.getNutritionGoals(userId);\n    const dailyCalorieTarget = nutritionGoals?.dailyCalories || 2000;\n\n    // Build AI prompt with shift schedule and user context\n    const systemPrompt = this.buildSystemPrompt(userProfile, dailyCalorieTarget);\n    const userPrompt = this.buildUserPrompt(shifts, userProfile, dailyCalorieTarget);\n\n    try {\n      // Get first available provider (prefer Gemini for free tier, fallback to OpenAI)\n      const provider = aiManager.getFirstAvailableProvider(['Gemini', 'OpenAI']);\n      \n      if (!provider) {\n        throw new Error(\"No healthy AI providers available for meal plan generation\");\n      }\n\n      // Generate meal plan using the available provider\n      if (provider.name === 'Gemini') {\n        const result = await this.generateWithGemini(provider, systemPrompt, userPrompt, shifts);\n        return result;\n      } else if (provider.name === 'OpenAI') {\n        const result = await this.generateWithOpenAI(provider, systemPrompt, userPrompt, shifts);\n        return result;\n      }\n\n      throw new Error(`Unsupported provider: ${provider.name}`);\n    } catch (error) {\n      console.error(\"Error generating weekly meal plan:\", error);\n      throw error;\n    }\n  }\n\n  private buildSystemPrompt(userProfile?: UserProfile, dailyCalorieTarget?: number): string {\n    let profileContext = \"\";\n    \n    if (userProfile) {\n      profileContext = `\nUser Profile:\n- Age: ${userProfile.age || 'not specified'}\n- Sex: ${userProfile.sex || 'not specified'}\n- Weight: ${userProfile.currentWeightKg ? `${userProfile.currentWeightKg} kg` : 'not specified'}\n- Goal Weight: ${userProfile.goalWeightKg ? `${userProfile.goalWeightKg} kg` : 'not specified'}\n- Height: ${userProfile.heightCm ? `${userProfile.heightCm} cm` : 'not specified'}\n- Activity Level: ${userProfile.activityLevel || 'moderate'}\n- Daily Calorie Target: ${dailyCalorieTarget || 2000} calories\n- Dietary Requirements: ${userProfile.dietaryRequirements?.join(', ') || 'none'}\n- Allergies: ${userProfile.allergies?.join(', ') || 'none'}\n- Medication: ${userProfile.medication || 'none'}`;\n    }\n\n    return `You are a specialized nutrition AI designed to create weekly meal plans optimized for shift workers. Your expertise includes:\n\n1. **Shift Work Nutrition Science**:\n   - Understanding circadian rhythm disruption in shift workers\n   - Optimizing meal timing for different shift types (day, night, long, early, late, custom)\n   - Managing energy levels during irregular work schedules\n   - Preventing shift work sleep disorder through nutrition\n\n2. **Meal Portability & Practicality**:\n   - Designing portable, easy-to-transport meals for shift workers\n   - Meal prep strategies for busy schedules\n   - Quick, no-cook options for break times\n   - Temperature-stable foods that don't require refrigeration\n\n3. **Energy & Alertness Optimization**:\n   - Strategic caffeine timing\n   - Protein distribution for sustained energy\n   - Complex carbs for stable blood sugar\n   - Avoiding post-meal crashes during shifts\n\n4. **Personalization**:\n${profileContext}\n\n**Output Requirements**:\n- Generate a complete weekly meal plan with 3-5 meals per day\n- Each meal must include: name, description, timing, portability level, full nutrition breakdown, ingredients, benefits, prep time, and shift-specific tips\n- Provide strategic calorie distribution (pre-shift, during-shift, post-shift) for each day\n- Generate a consolidated shopping list categorized by food group\n- Include weekly tips for shift work nutrition success\n- All meals must respect dietary restrictions and allergies\n- Prioritize UK-available ingredients and realistic portions\n\n**Shift Type Strategies**:\n- **Day Shift (9am-5pm)**: Normal meal timing, focus on sustained energy\n- **Night Shift (10pm-6am)**: Light pre-shift meal, protein-rich during-shift snacks, avoid heavy carbs late\n- **Long Shift (12+ hours)**: Multiple small meals, high protein, portable options\n- **Early Shift (6am start)**: Quick breakfast, prep-ahead meals\n- **Late Shift (2pm-10pm)**: Strategic lunch timing, avoid late heavy meals\n- **Custom Shifts**: Adapt based on specific times and break windows\n\nReturn a structured JSON response following the schema exactly.`;\n  }\n\n  private buildUserPrompt(shifts: ShiftSchedule[], userProfile?: UserProfile, dailyCalorieTarget?: number): string {\n    const shiftDetails = shifts.map((shift, index) => {\n      let details = `Day ${index + 1} (${shift.shiftDate}): ${shift.shiftType}`;\n      \n      if (shift.shiftType === 'custom' && shift.customShiftStart && shift.customShiftEnd) {\n        details += ` from ${shift.customShiftStart} to ${shift.customShiftEnd}`;\n      }\n      \n      if (shift.breakWindows && shift.breakWindows.length > 0) {\n        details += `, Break windows: ${shift.breakWindows.join(', ')}`;\n      }\n      \n      return details;\n    }).join('\\n');\n\n    return `Create a complete weekly meal plan for a ${userProfile?.sex || 'person'} shift worker with the following schedule:\n\n${shiftDetails}\n\nTarget: ${dailyCalorieTarget || 2000} calories per day (adjust based on shift intensity)\nDietary Requirements: ${userProfile?.dietaryRequirements?.join(', ') || 'none'}\nAllergies: ${userProfile?.allergies?.join(', ') || 'none'}\n\nPlease generate:\n1. A complete daily meal plan for each scheduled shift day\n2. Meals optimized for the specific shift type and timing\n3. Portable, practical options that can be prepared in advance\n4. Strategic calorie distribution to maintain energy throughout each shift\n5. A consolidated weekly shopping list\n6. Practical tips for succeeding with this meal plan during shift work\n\nFocus on realistic, affordable meals using ingredients commonly available in UK supermarkets. Prioritize meal prep efficiency and portability.`;\n  }\n\n  private async generateWithGemini(\n    provider: any,\n    systemPrompt: string,\n    userPrompt: string,\n    shifts: ShiftSchedule[]\n  ): Promise<WeeklyMealPlan> {\n    const client = (provider as any).client;\n    \n    const response = await client.models.generateContent({\n      model: \"gemini-2.5-flash\", // Use flash for cost efficiency\n      config: {\n        systemInstruction: systemPrompt,\n        responseMimeType: \"application/json\",\n        responseSchema: {\n          type: \"object\",\n          properties: {\n            userId: { type: \"string\" },\n            startDate: { type: \"string\" },\n            endDate: { type: \"string\" },\n            dailyPlans: {\n              type: \"array\",\n              items: {\n                type: \"object\",\n                properties: {\n                  date: { type: \"string\" },\n                  shiftType: { type: \"string\" },\n                  shiftStart: { type: \"string\" },\n                  shiftEnd: { type: \"string\" },\n                  breakWindows: { type: \"array\", items: { type: \"string\" } },\n                  meals: {\n                    type: \"array\",\n                    items: {\n                      type: \"object\",\n                      properties: {\n                        mealType: { type: \"string\" },\n                        name: { type: \"string\" },\n                        description: { type: \"string\" },\n                        timing: { type: \"string\" },\n                        portability: { type: \"string\" },\n                        calories: { type: \"number\" },\n                        protein: { type: \"number\" },\n                        carbs: { type: \"number\" },\n                        fat: { type: \"number\" },\n                        ingredients: { type: \"array\", items: { type: \"string\" } },\n                        benefits: { type: \"string\" },\n                        prepTime: { type: \"string\" },\n                        tips: { type: \"array\", items: { type: \"string\" } }\n                      },\n                      required: [\"mealType\", \"name\", \"description\", \"timing\", \"portability\", \"calories\", \"protein\", \"carbs\", \"fat\", \"ingredients\", \"benefits\", \"prepTime\", \"tips\"]\n                    }\n                  },\n                  dailySummary: { type: \"string\" },\n                  calorieDistribution: {\n                    type: \"object\",\n                    properties: {\n                      preShift: { type: \"number\" },\n                      duringShift: { type: \"number\" },\n                      postShift: { type: \"number\" }\n                    },\n                    required: [\"preShift\", \"duringShift\", \"postShift\"]\n                  }\n                },\n                required: [\"date\", \"shiftType\", \"meals\", \"dailySummary\", \"calorieDistribution\"]\n              }\n            },\n            weeklyNutrition: {\n              type: \"object\",\n              properties: {\n                totalCalories: { type: \"number\" },\n                avgCaloriesPerDay: { type: \"number\" },\n                totalProtein: { type: \"number\" },\n                totalCarbs: { type: \"number\" },\n                totalFat: { type: \"number\" }\n              },\n              required: [\"totalCalories\", \"avgCaloriesPerDay\", \"totalProtein\", \"totalCarbs\", \"totalFat\"]\n            },\n            shoppingList: {\n              type: \"array\",\n              items: {\n                type: \"object\",\n                properties: {\n                  ingredient: { type: \"string\" },\n                  quantity: { type: \"string\" },\n                  category: { type: \"string\" }\n                },\n                required: [\"ingredient\", \"quantity\", \"category\"]\n              }\n            },\n            weeklyTips: { type: \"array\", items: { type: \"string\" } }\n          },\n          required: [\"userId\", \"startDate\", \"endDate\", \"dailyPlans\", \"weeklyNutrition\", \"shoppingList\", \"weeklyTips\"]\n        }\n      },\n      contents: [{ role: \"user\", parts: [{ text: userPrompt }] }]\n    });\n\n    const result = response.text;\n    const parsed = JSON.parse(result);\n    \n    // Ensure userId is set correctly\n    parsed.userId = shifts[0].userId;\n    \n    return parsed as WeeklyMealPlan;\n  }\n\n  private async generateWithOpenAI(\n    provider: any,\n    systemPrompt: string,\n    userPrompt: string,\n    shifts: ShiftSchedule[]\n  ): Promise<WeeklyMealPlan> {\n    const client = (provider as any).client;\n    \n    const response = await client.chat.completions.create({\n      model: \"gpt-4o-mini\", // Cost-efficient model for meal planning\n      messages: [\n        { role: \"system\", content: systemPrompt },\n        { role: \"user\", content: userPrompt }\n      ],\n      response_format: { type: \"json_object\" },\n      temperature: 0.7,\n      max_tokens: 4000\n    });\n\n    const responseText = response.choices[0].message.content;\n    if (!responseText) {\n      throw new Error(\"No response from OpenAI\");\n    }\n\n    const parsed = JSON.parse(responseText);\n    \n    // Ensure userId is set correctly\n    parsed.userId = shifts[0].userId;\n    \n    return parsed as WeeklyMealPlan;\n  }\n}\n\n// Export singleton instance\nexport const shiftMealPlanService = new ShiftMealPlanService(\n  {} as IStorage // Will be injected by routes\n);\n","size_bytes":12878},"client/src/pages/ShiftPlannerPage.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Accordion, AccordionContent, AccordionItem, AccordionTrigger } from \"@/components/ui/accordion\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { buildApiUrl } from '@/lib/api-config';\nimport { Link } from \"wouter\";\nimport { Calendar, Clock, Loader2, Sparkles, ChevronLeft, ChevronRight, Trash2, Utensils, ShoppingCart, Truck, Home, Package, LogIn, Plus } from \"lucide-react\";\nimport { format, addDays, startOfWeek, endOfWeek, isSameDay, parseISO } from \"date-fns\";\n\ninterface ShiftSchedule {\n  id: string;\n  userId: string;\n  shiftDate: string;\n  shiftType: string;\n  customShiftStart: string | null;\n  customShiftEnd: string | null;\n  breakWindows: string[] | null;\n  mealPlanGenerated: number | null;\n  mealPlanData: any;\n}\n\nconst SHIFT_TYPES = [\n  { value: \"day_off\", label: \"Day Off\", icon: \"â˜€ï¸\" },\n  { value: \"regular\", label: \"Day Shift (9am-5pm)\", icon: \"ðŸŒ…\" },\n  { value: \"night_shift\", label: \"Night Shift (10pm-6am)\", icon: \"ðŸŒ™\" },\n  { value: \"long_shift\", label: \"Long Shift (12+ hours)\", icon: \"â°\" },\n  { value: \"early_shift\", label: \"Early Shift (6am start)\", icon: \"ðŸŒ„\" },\n  { value: \"late_shift\", label: \"Late Shift (2pm-10pm)\", icon: \"ðŸŒ†\" },\n  { value: \"custom\", label: \"Custom Shift\", icon: \"âš™ï¸\" }\n];\n\nexport default function ShiftPlannerPage() {\n  const { toast } = useToast();\n  const { isAuthenticated, isLoading: authLoading } = useAuth();\n  const [weekStart, setWeekStart] = useState(startOfWeek(new Date(), { weekStartsOn: 1 })); // Monday\n  const [selectedShifts, setSelectedShifts] = useState<Record<string, string>>({});\n  const [hasChanges, setHasChanges] = useState(false);\n\n  // Calculate date range for the week\n  const startDate = format(weekStart, \"yyyy-MM-dd\");\n  const endDate = format(endOfWeek(weekStart, { weekStartsOn: 1 }), \"yyyy-MM-dd\");\n\n  // Fetch existing shift schedules (skip if not authenticated)\n  const { data: schedules, isLoading } = useQuery<ShiftSchedule[]>({\n    queryKey: [\"/api/shift-schedules\", startDate, endDate],\n    queryFn: async () => {\n      const response = await fetch(buildApiUrl(`/api/shift-schedules?startDate=${startDate}&endDate=${endDate}`), {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"auth_token\")}`\n        }\n      });\n      if (!response.ok) throw new Error(\"Failed to fetch schedules\");\n      return response.json();\n    },\n    enabled: isAuthenticated\n  });\n\n  // Initialize selectedShifts from fetched schedules\n  useEffect(() => {\n    if (schedules) {\n      const shiftsMap: Record<string, string> = {};\n      schedules.forEach(schedule => {\n        shiftsMap[schedule.shiftDate] = schedule.shiftType;\n      });\n      setSelectedShifts(shiftsMap);\n      setHasChanges(false);\n    }\n  }, [schedules]);\n\n  // Save shift schedule mutation\n  const saveShiftMutation = useMutation({\n    mutationFn: async (data: { shiftDate: string; shiftType: string }) => {\n      return apiRequest(\"POST\", \"/api/shift-schedules\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/shift-schedules\"] });\n    }\n  });\n\n  // Delete shift schedule mutation\n  const deleteShiftMutation = useMutation({\n    mutationFn: async (date: string) => {\n      return apiRequest(\"DELETE\", `/api/shift-schedules/${date}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/shift-schedules\"] });\n    }\n  });\n\n  // Generate meal plan mutation\n  const generateMealPlanMutation = useMutation({\n    mutationFn: async () => {\n      return apiRequest(\"POST\", \"/api/shift-schedules/generate-meal-plan\", {\n        startDate,\n        endDate\n      });\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Meal Plan Generated! ðŸŽ‰\",\n        description: \"Your personalized weekly meal plan is ready based on your shift schedule.\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/shift-schedules\"] });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Failed to Generate Meal Plan\",\n        description: error.message || \"Please try again\",\n        variant: \"destructive\",\n      });\n    }\n  });\n\n  // Add to shopping list mutation\n  const addToShoppingListMutation = useMutation({\n    mutationFn: async () => {\n      return apiRequest(\"POST\", \"/api/shift-schedules/add-to-shopping-list\", {\n        startDate,\n        endDate\n      });\n    },\n    onSuccess: (response: any) => {\n      toast({\n        title: \"Added to Shopping List! ðŸ›’\",\n        description: `${response.addedCount} new items added, ${response.updatedCount} items updated`,\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Failed to Add to Shopping List\",\n        description: error.message || \"Please try again\",\n        variant: \"destructive\",\n      });\n    }\n  });\n\n  const handleShiftChange = (date: string, shiftType: string) => {\n    console.log(\"ðŸ”„ Shift changed:\", date, shiftType);\n    setSelectedShifts(prev => ({\n      ...prev,\n      [date]: shiftType\n    }));\n    setHasChanges(true);\n  };\n\n  const handleSaveAll = async () => {\n    console.log(\"ðŸ’¾ Save All clicked! Selected shifts:\", selectedShifts);\n    try {\n      // Save all shifts (including day_off)\n      const promises = Object.entries(selectedShifts).map(([date, shiftType]) => {\n        console.log(`ðŸ“… Processing shift for ${date}: ${shiftType}`);\n        console.log(`âœ… Saving shift for ${date}`);\n        return saveShiftMutation.mutateAsync({ shiftDate: date, shiftType });\n      });\n\n      console.log(`ðŸ“¤ Sending ${promises.length} requests...`);\n      await Promise.all(promises);\n      \n      toast({\n        title: \"Shifts Saved!\",\n        description: \"Your shift schedule has been updated.\",\n      });\n      setHasChanges(false);\n    } catch (error) {\n      console.error(\"âŒ Save error:\", error);\n      toast({\n        title: \"Failed to Save\",\n        description: \"Please try again\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const handleGenerateMealPlan = () => {\n    const scheduledShifts = Object.entries(selectedShifts).filter(\n      ([_, shiftType]) => shiftType !== \"day_off\"\n    );\n\n    if (scheduledShifts.length === 0) {\n      toast({\n        title: \"No Shifts Scheduled\",\n        description: \"Please schedule at least one shift before generating a meal plan.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (hasChanges) {\n      toast({\n        title: \"Unsaved Changes\",\n        description: \"Please save your shifts before generating a meal plan.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    generateMealPlanMutation.mutate();\n  };\n\n  const nextWeek = () => {\n    setWeekStart(prev => addDays(prev, 7));\n  };\n\n  const previousWeek = () => {\n    setWeekStart(prev => addDays(prev, -7));\n  };\n\n  const thisWeek = () => {\n    setWeekStart(startOfWeek(new Date(), { weekStartsOn: 1 }));\n  };\n\n  // Generate days for the week\n  const weekDays = Array.from({ length: 7 }, (_, i) => {\n    const date = addDays(weekStart, i);\n    const dateStr = format(date, \"yyyy-MM-dd\");\n    return {\n      date,\n      dateStr,\n      dayName: format(date, \"EEE\"),\n      dayNumber: format(date, \"d\"),\n      shiftType: selectedShifts[dateStr] || \"none\",\n      hasMealPlan: schedules?.find(s => s.shiftDate === dateStr && s.mealPlanGenerated === 1)\n    };\n  });\n\n  const scheduledShiftsCount = Object.values(selectedShifts).filter(\n    type => type !== \"day_off\"\n  ).length;\n\n  const getShiftTypeInfo = (type: string) => {\n    return SHIFT_TYPES.find(st => st.value === type) || SHIFT_TYPES[0];\n  };\n\n  // Show loading while checking auth\n  if (authLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center p-4\" style={{background: 'var(--bg-gradient)'}}>\n        <div className=\"text-white text-center\">\n          <Loader2 className=\"h-8 w-8 animate-spin mx-auto mb-4\" />\n          <p>Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  // Show login prompt if not authenticated\n  if (!isAuthenticated) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center p-4\" style={{background: 'var(--bg-gradient)'}}>\n        <Card className=\"max-w-md w-full\">\n          <CardHeader className=\"text-center\">\n            <div className=\"mx-auto mb-4 h-16 w-16 bg-purple-100 dark:bg-purple-900 rounded-full flex items-center justify-center\">\n              <Calendar className=\"h-8 w-8 text-purple-600\" />\n            </div>\n            <CardTitle className=\"text-2xl\">Login Required</CardTitle>\n            <CardDescription className=\"text-base\">\n              The Weekly Shift Planner helps you schedule your shifts and get personalized meal plans. Please log in to access this feature.\n            </CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg\">\n              <h4 className=\"font-semibold text-sm mb-2\">What you can do:</h4>\n              <ul className=\"space-y-2 text-sm text-gray-600 dark:text-gray-300\">\n                <li className=\"flex items-start gap-2\">\n                  <Sparkles className=\"h-4 w-4 text-purple-600 mt-0.5 flex-shrink-0\" />\n                  <span>Schedule your shifts for the week ahead</span>\n                </li>\n                <li className=\"flex items-start gap-2\">\n                  <Utensils className=\"h-4 w-4 text-purple-600 mt-0.5 flex-shrink-0\" />\n                  <span>Get AI-generated meal plans optimized for your work schedule</span>\n                </li>\n                <li className=\"flex items-start gap-2\">\n                  <Truck className=\"h-4 w-4 text-purple-600 mt-0.5 flex-shrink-0\" />\n                  <span>Receive portable meal suggestions for on-the-go shifts</span>\n                </li>\n              </ul>\n            </div>\n            <Link href=\"/\">\n              <Button className=\"w-full\" size=\"lg\" data-testid=\"button-go-to-login\">\n                <LogIn className=\"mr-2 h-5 w-5\" />\n                Go to Login\n              </Button>\n            </Link>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-purple-50 via-white to-pink-50 dark:from-gray-900 dark:via-gray-800 dark:to-purple-900 flex items-center justify-center\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-purple-600\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-purple-50 via-white to-pink-50 dark:from-gray-900 dark:via-gray-800 dark:to-purple-900 p-4 pb-24\">\n      <div className=\"max-w-4xl mx-auto space-y-6\">\n        {/* Header */}\n        <div className=\"space-y-2\">\n          <Link href=\"/\">\n            <Button variant=\"ghost\" size=\"sm\" className=\"mb-2\" data-testid=\"button-back-home\">\n              <ChevronLeft className=\"h-4 w-4 mr-1\" />\n              Back to Home\n            </Button>\n          </Link>\n          <div className=\"text-center\">\n            <h1 className=\"text-3xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent\">\n              Weekly Shift Planner\n            </h1>\n            <p className=\"text-gray-600 dark:text-gray-300\">\n              Plan your shifts and get AI-powered meal recommendations\n            </p>\n          </div>\n        </div>\n\n        {/* Week Navigation */}\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center justify-between\">\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={previousWeek}\n                data-testid=\"button-previous-week\"\n              >\n                <ChevronLeft className=\"h-4 w-4\" />\n              </Button>\n\n              <div className=\"text-center\">\n                <div className=\"font-semibold text-lg\">\n                  {format(weekStart, \"MMM d\")} - {format(endOfWeek(weekStart, { weekStartsOn: 1 }), \"MMM d, yyyy\")}\n                </div>\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={thisWeek}\n                  className=\"text-sm text-purple-600\"\n                  data-testid=\"button-this-week\"\n                >\n                  Jump to This Week\n                </Button>\n              </div>\n\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={nextWeek}\n                data-testid=\"button-next-week\"\n              >\n                <ChevronRight className=\"h-4 w-4\" />\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Shift Schedule Grid */}\n        <div className=\"grid gap-4\">\n          {weekDays.map((day) => {\n            const shiftInfo = getShiftTypeInfo(day.shiftType);\n            const isToday = isSameDay(day.date, new Date());\n\n            return (\n              <Card key={day.dateStr} className={isToday ? \"border-purple-500 border-2\" : \"\"}>\n                <CardHeader className=\"pb-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center gap-3\">\n                      <div className={`text-center ${isToday ? \"text-purple-600 font-bold\" : \"\"}`}>\n                        <div className=\"text-sm font-medium\">{day.dayName}</div>\n                        <div className=\"text-2xl\">{day.dayNumber}</div>\n                      </div>\n                      <div>\n                        <CardTitle className=\"text-lg\">\n                          {format(day.date, \"MMMM d, yyyy\")}\n                        </CardTitle>\n                        {isToday && (\n                          <CardDescription className=\"text-purple-600 font-medium\">\n                            Today\n                          </CardDescription>\n                        )}\n                      </div>\n                    </div>\n                    {day.hasMealPlan && (\n                      <div className=\"flex items-center gap-1 text-sm text-green-600 font-medium\">\n                        <Sparkles className=\"h-4 w-4\" />\n                        Meal Plan Ready\n                      </div>\n                    )}\n                  </div>\n                </CardHeader>\n                <CardContent>\n                  <Select\n                    value={day.shiftType}\n                    onValueChange={(value) => handleShiftChange(day.dateStr, value)}\n                  >\n                    <SelectTrigger className=\"w-full\" data-testid={`select-shift-${day.dateStr}`}>\n                      <SelectValue>\n                        <div className=\"flex items-center gap-2\">\n                          <span className=\"text-lg\">{shiftInfo.icon}</span>\n                          <span>{shiftInfo.label}</span>\n                        </div>\n                      </SelectValue>\n                    </SelectTrigger>\n                    <SelectContent>\n                      {SHIFT_TYPES.map((type) => (\n                        <SelectItem key={type.value} value={type.value}>\n                          <div className=\"flex items-center gap-2\">\n                            <span className=\"text-lg\">{type.icon}</span>\n                            <span>{type.label}</span>\n                          </div>\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </CardContent>\n              </Card>\n            );\n          })}\n        </div>\n\n        {/* Action Buttons */}\n        <Card className=\"bg-gradient-to-r from-purple-50 to-pink-50 dark:from-gray-800 dark:to-purple-900\">\n          <CardContent className=\"pt-6 space-y-4\">\n            <div className=\"flex items-center justify-between text-sm\">\n              <span className=\"text-gray-600 dark:text-gray-300\">\n                {scheduledShiftsCount} shift{scheduledShiftsCount !== 1 ? \"s\" : \"\"} scheduled this week\n              </span>\n              {hasChanges && (\n                <span className=\"text-orange-600 font-medium\">Unsaved changes</span>\n              )}\n            </div>\n\n            <div className=\"flex gap-3\">\n              <Button\n                onClick={handleSaveAll}\n                disabled={!hasChanges || saveShiftMutation.isPending}\n                className=\"flex-1 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700\"\n                data-testid=\"button-save-shifts\"\n              >\n                {saveShiftMutation.isPending ? (\n                  <>\n                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                    Saving...\n                  </>\n                ) : (\n                  <>\n                    <Calendar className=\"mr-2 h-4 w-4\" />\n                    Save Shifts\n                  </>\n                )}\n              </Button>\n\n              <Button\n                onClick={handleGenerateMealPlan}\n                disabled={\n                  hasChanges ||\n                  scheduledShiftsCount === 0 ||\n                  generateMealPlanMutation.isPending\n                }\n                className=\"flex-1 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700\"\n                data-testid=\"button-generate-meal-plan\"\n              >\n                {generateMealPlanMutation.isPending ? (\n                  <>\n                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                    Generating...\n                  </>\n                ) : (\n                  <>\n                    <Sparkles className=\"mr-2 h-4 w-4\" />\n                    Generate AI Meal Plan\n                  </>\n                )}\n              </Button>\n            </div>\n\n            <p className=\"text-xs text-gray-500 dark:text-gray-400 text-center\">\n              Save your shifts first, then generate a personalized meal plan optimized for your work schedule\n            </p>\n          </CardContent>\n        </Card>\n\n        {/* Weekly Shopping List Section */}\n        {schedules && schedules.some(s => s.mealPlanGenerated === 1 && s.mealPlanData && (s.mealPlanData as any).shoppingList) && (\n          <Card className=\"border-2 border-green-500\">\n            <CardHeader>\n              <CardTitle className=\"text-xl flex items-center gap-2\">\n                <ShoppingCart className=\"h-6 w-6 text-green-600\" />\n                Weekly Shopping List\n              </CardTitle>\n              <CardDescription>\n                Ingredients for your entire week\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              {(() => {\n                // Find first schedule with shopping list\n                const scheduleWithList = schedules.find(\n                  s => s.mealPlanData && (s.mealPlanData as any).shoppingList\n                );\n                const shoppingList = scheduleWithList ? (scheduleWithList.mealPlanData as any).shoppingList : [];\n                \n                // Group by category\n                const groupedItems = shoppingList.reduce((acc: any, item: any) => {\n                  const category = item.category || 'Other';\n                  if (!acc[category]) acc[category] = [];\n                  acc[category].push(item);\n                  return acc;\n                }, {});\n\n                return (\n                  <div className=\"space-y-4\">\n                    {Object.entries(groupedItems).map(([category, items]: [string, any]) => (\n                      <div key={category} className=\"space-y-2\">\n                        <h4 className=\"font-semibold text-sm text-purple-600 dark:text-purple-400 uppercase tracking-wide\">\n                          {category}\n                        </h4>\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-2\">\n                          {items.map((item: any, index: number) => (\n                            <div\n                              key={index}\n                              className=\"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-800 rounded\"\n                              data-testid={`shopping-item-${category}-${index}`}\n                            >\n                              <span className=\"text-sm\" data-testid={`text-ingredient-${category}-${index}`}>\n                                {item.ingredient}\n                              </span>\n                              <span \n                                className=\"text-xs text-gray-600 dark:text-gray-400 font-medium\"\n                                data-testid={`text-quantity-${category}-${index}`}\n                              >\n                                {item.quantity}\n                              </span>\n                            </div>\n                          ))}\n                        </div>\n                      </div>\n                    ))}\n                    \n                    {/* Action Buttons */}\n                    <div className=\"flex gap-2 pt-4 border-t\">\n                      <Button\n                        onClick={() => addToShoppingListMutation.mutate()}\n                        disabled={addToShoppingListMutation.isPending}\n                        className=\"flex-1 bg-gradient-to-br from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white\"\n                        data-testid=\"button-add-to-shopping-list\"\n                      >\n                        {addToShoppingListMutation.isPending ? (\n                          <>\n                            <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                            Adding...\n                          </>\n                        ) : (\n                          <>\n                            <Plus className=\"mr-2 h-4 w-4\" />\n                            Add to My Shopping List\n                          </>\n                        )}\n                      </Button>\n                      <Link href=\"/recipes?view=shopping-list\">\n                        <Button \n                          className=\"flex-1 bg-gradient-to-br from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white shadow-lg\" \n                          data-testid=\"button-view-shopping-list\"\n                        >\n                          <ShoppingCart className=\"mr-2 h-4 w-4\" />\n                          View Shopping List\n                        </Button>\n                      </Link>\n                    </div>\n                  </div>\n                );\n              })()}\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Meal Plans Section */}\n        {schedules && schedules.some(s => s.mealPlanGenerated === 1) && (\n          <Card className=\"border-2 border-green-500\">\n            <CardHeader>\n              <CardTitle className=\"text-xl flex items-center gap-2\">\n                <Sparkles className=\"h-6 w-6 text-green-600\" />\n                Your AI-Generated Meal Plans\n              </CardTitle>\n              <CardDescription>\n                Personalized meals optimized for your shift schedule\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <Accordion type=\"single\" collapsible className=\"w-full space-y-4\">\n                {schedules\n                  .filter(schedule => schedule.mealPlanGenerated === 1 && schedule.mealPlanData)\n                  .map((schedule) => {\n                    const mealPlan = schedule.mealPlanData as any;\n                    const shiftInfo = getShiftTypeInfo(schedule.shiftType);\n                    \n                    return (\n                      <AccordionItem \n                        key={schedule.id} \n                        value={schedule.shiftDate}\n                        className=\"border rounded-lg px-4 bg-gradient-to-r from-green-50 to-emerald-50 dark:from-gray-800 dark:to-green-900\"\n                      >\n                        <AccordionTrigger \n                          className=\"hover:no-underline\"\n                          data-testid={`accordion-meal-plan-${schedule.shiftDate}`}\n                        >\n                          <div className=\"flex items-center justify-between w-full pr-4\">\n                            <div className=\"flex items-center gap-3\">\n                              <span className=\"text-2xl\">{shiftInfo.icon}</span>\n                              <div className=\"text-left\">\n                                <div className=\"font-semibold\" data-testid={`text-meal-plan-date-${schedule.shiftDate}`}>\n                                  {format(parseISO(schedule.shiftDate), \"EEEE, MMMM d\")}\n                                </div>\n                                <div className=\"text-sm text-gray-600 dark:text-gray-300\">\n                                  {shiftInfo.label}\n                                </div>\n                              </div>\n                            </div>\n                            <Badge \n                              variant=\"secondary\" \n                              className=\"bg-green-600 text-white\"\n                              data-testid={`badge-meal-count-${schedule.shiftDate}`}\n                            >\n                              {mealPlan.meals?.length || 0} Meals\n                            </Badge>\n                          </div>\n                        </AccordionTrigger>\n                        <AccordionContent>\n                          <div className=\"space-y-4 pt-4\">\n                            {/* Daily Summary */}\n                            {mealPlan.dailySummary && (\n                              <div className=\"bg-white dark:bg-gray-800 p-4 rounded-lg\" data-testid={`text-daily-summary-${schedule.shiftDate}`}>\n                                <h4 className=\"font-semibold text-sm text-gray-600 dark:text-gray-300 mb-2\">\n                                  Daily Strategy\n                                </h4>\n                                <p className=\"text-sm\">{mealPlan.dailySummary}</p>\n                              </div>\n                            )}\n\n                            {/* Calorie Distribution */}\n                            {mealPlan.calorieDistribution && (\n                              <div className=\"bg-white dark:bg-gray-800 p-4 rounded-lg\" data-testid={`calorie-distribution-${schedule.shiftDate}`}>\n                                <h4 className=\"font-semibold text-sm text-gray-600 dark:text-gray-300 mb-3\">\n                                  Energy Distribution\n                                </h4>\n                                <div className=\"grid grid-cols-3 gap-4 text-center\">\n                                  <div>\n                                    <div className=\"text-2xl font-bold text-blue-600\" data-testid={`text-preshift-calories-${schedule.shiftDate}`}>\n                                      {mealPlan.calorieDistribution.preShift}\n                                    </div>\n                                    <div className=\"text-xs text-gray-600 dark:text-gray-300\">Pre-Shift</div>\n                                  </div>\n                                  <div>\n                                    <div className=\"text-2xl font-bold text-purple-600\" data-testid={`text-duringshift-calories-${schedule.shiftDate}`}>\n                                      {mealPlan.calorieDistribution.duringShift}\n                                    </div>\n                                    <div className=\"text-xs text-gray-600 dark:text-gray-300\">During Shift</div>\n                                  </div>\n                                  <div>\n                                    <div className=\"text-2xl font-bold text-pink-600\" data-testid={`text-postshift-calories-${schedule.shiftDate}`}>\n                                      {mealPlan.calorieDistribution.postShift}\n                                    </div>\n                                    <div className=\"text-xs text-gray-600 dark:text-gray-300\">Post-Shift</div>\n                                  </div>\n                                </div>\n                              </div>\n                            )}\n\n                            {/* Meals */}\n                            <div className=\"space-y-3\">\n                              <h4 className=\"font-semibold text-sm text-gray-600 dark:text-gray-300\">\n                                Meal Plan\n                              </h4>\n                              {mealPlan.meals?.map((meal: any, index: number) => (\n                                <div \n                                  key={index}\n                                  className=\"bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700\"\n                                  data-testid={`meal-card-${schedule.shiftDate}-${index}`}\n                                >\n                                  <div className=\"flex items-start justify-between mb-3\">\n                                    <div className=\"flex-1\">\n                                      <div className=\"flex items-center gap-2 mb-1\">\n                                        <Badge \n                                          variant=\"outline\" \n                                          className=\"text-xs\"\n                                          data-testid={`badge-meal-type-${schedule.shiftDate}-${index}`}\n                                        >\n                                          {meal.mealType}\n                                        </Badge>\n                                        <Badge \n                                          variant=\"outline\" \n                                          className={`text-xs ${\n                                            meal.portability === 'portable' \n                                              ? 'bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300'\n                                              : meal.portability === 'meal-prep-friendly'\n                                              ? 'bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300'\n                                              : 'bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300'\n                                          }`}\n                                          data-testid={`badge-portability-${schedule.shiftDate}-${index}`}\n                                        >\n                                          {meal.portability === 'portable' && <Truck className=\"h-3 w-3 mr-1\" />}\n                                          {meal.portability === 'meal-prep-friendly' && <Package className=\"h-3 w-3 mr-1\" />}\n                                          {meal.portability === 'home-only' && <Home className=\"h-3 w-3 mr-1\" />}\n                                          {meal.portability}\n                                        </Badge>\n                                      </div>\n                                      <h5 className=\"font-bold text-lg\" data-testid={`text-meal-name-${schedule.shiftDate}-${index}`}>{meal.name}</h5>\n                                      <p \n                                        className=\"text-sm text-gray-600 dark:text-gray-300 mt-1\"\n                                        data-testid={`text-meal-description-${schedule.shiftDate}-${index}`}\n                                      >\n                                        {meal.description}\n                                      </p>\n                                      <div className=\"flex items-center gap-4 mt-2 text-xs text-gray-500 dark:text-gray-400\">\n                                        <span \n                                          className=\"flex items-center gap-1\"\n                                          data-testid={`text-meal-timing-${schedule.shiftDate}-${index}`}\n                                        >\n                                          <Clock className=\"h-3 w-3\" />\n                                          {meal.timing}\n                                        </span>\n                                        <span \n                                          className=\"flex items-center gap-1\"\n                                          data-testid={`text-meal-preptime-${schedule.shiftDate}-${index}`}\n                                        >\n                                          <Utensils className=\"h-3 w-3\" />\n                                          {meal.prepTime}\n                                        </span>\n                                      </div>\n                                    </div>\n                                  </div>\n\n                                  {/* Nutrition Info */}\n                                  <div className=\"grid grid-cols-4 gap-2 mb-3 p-3 bg-gray-50 dark:bg-gray-700 rounded\" data-testid={`nutrition-info-${schedule.shiftDate}-${index}`}>\n                                    <div className=\"text-center\">\n                                      <div className=\"text-sm font-bold\" data-testid={`text-calories-${schedule.shiftDate}-${index}`}>{meal.calories}</div>\n                                      <div className=\"text-xs text-gray-600 dark:text-gray-300\">cal</div>\n                                    </div>\n                                    <div className=\"text-center\">\n                                      <div className=\"text-sm font-bold text-red-600\" data-testid={`text-protein-${schedule.shiftDate}-${index}`}>{meal.protein}g</div>\n                                      <div className=\"text-xs text-gray-600 dark:text-gray-300\">protein</div>\n                                    </div>\n                                    <div className=\"text-center\">\n                                      <div className=\"text-sm font-bold text-blue-600\" data-testid={`text-carbs-${schedule.shiftDate}-${index}`}>{meal.carbs}g</div>\n                                      <div className=\"text-xs text-gray-600 dark:text-gray-300\">carbs</div>\n                                    </div>\n                                    <div className=\"text-center\">\n                                      <div className=\"text-sm font-bold text-yellow-600\" data-testid={`text-fat-${schedule.shiftDate}-${index}`}>{meal.fat}g</div>\n                                      <div className=\"text-xs text-gray-600 dark:text-gray-300\">fat</div>\n                                    </div>\n                                  </div>\n\n                                  {/* Benefits */}\n                                  {meal.benefits && (\n                                    <div className=\"mb-3 p-3 bg-green-50 dark:bg-green-900/20 rounded\">\n                                      <div className=\"text-xs font-semibold text-green-700 dark:text-green-300 mb-1\">\n                                        Why This Meal?\n                                      </div>\n                                      <p \n                                        className=\"text-xs text-gray-700 dark:text-gray-300\"\n                                        data-testid={`text-meal-benefits-${schedule.shiftDate}-${index}`}\n                                      >\n                                        {meal.benefits}\n                                      </p>\n                                    </div>\n                                  )}\n\n                                  {/* Ingredients */}\n                                  {meal.ingredients && meal.ingredients.length > 0 && (\n                                    <div className=\"mb-3\">\n                                      <div className=\"text-xs font-semibold text-gray-600 dark:text-gray-300 mb-2\">\n                                        Ingredients:\n                                      </div>\n                                      <div className=\"flex flex-wrap gap-1\">\n                                        {meal.ingredients.map((ingredient: string, i: number) => (\n                                          <Badge \n                                            key={i} \n                                            variant=\"secondary\" \n                                            className=\"text-xs\"\n                                            data-testid={`badge-ingredient-${schedule.shiftDate}-${index}-${i}`}\n                                          >\n                                            {ingredient}\n                                          </Badge>\n                                        ))}\n                                      </div>\n                                    </div>\n                                  )}\n\n                                  {/* Tips */}\n                                  {meal.tips && meal.tips.length > 0 && (\n                                    <div className=\"border-t pt-3 mt-3\">\n                                      <div className=\"text-xs font-semibold text-gray-600 dark:text-gray-300 mb-2\">\n                                        Shift-Specific Tips:\n                                      </div>\n                                      <ul className=\"space-y-1\">\n                                        {meal.tips.map((tip: string, i: number) => (\n                                          <li \n                                            key={i} \n                                            className=\"text-xs text-gray-600 dark:text-gray-300 flex items-start gap-2\"\n                                            data-testid={`text-meal-tip-${schedule.shiftDate}-${index}-${i}`}\n                                          >\n                                            <Sparkles className=\"h-3 w-3 text-purple-600 mt-0.5 flex-shrink-0\" />\n                                            <span>{tip}</span>\n                                          </li>\n                                        ))}\n                                      </ul>\n                                    </div>\n                                  )}\n                                </div>\n                              ))}\n                            </div>\n                          </div>\n                        </AccordionContent>\n                      </AccordionItem>\n                    );\n                  })}\n              </Accordion>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Info Card */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-lg flex items-center gap-2\">\n              <Clock className=\"h-5 w-5 text-purple-600\" />\n              How It Works\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-2 text-sm text-gray-600 dark:text-gray-300\">\n            <div className=\"flex items-start gap-2\">\n              <span className=\"font-semibold text-purple-600\">1.</span>\n              <p>Select your shift type for each day of the week</p>\n            </div>\n            <div className=\"flex items-start gap-2\">\n              <span className=\"font-semibold text-purple-600\">2.</span>\n              <p>Save your shift schedule</p>\n            </div>\n            <div className=\"flex items-start gap-2\">\n              <span className=\"font-semibold text-purple-600\">3.</span>\n              <p>Generate an AI-powered meal plan tailored to your shifts</p>\n            </div>\n            <div className=\"flex items-start gap-2\">\n              <span className=\"font-semibold text-purple-600\">4.</span>\n              <p>Get optimized meal timing, portable food suggestions, and energy management tips</p>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Floating Shopping List Button */}\n      {schedules && schedules.some(s => s.mealPlanGenerated === 1 && s.mealPlanData && (s.mealPlanData as any).shoppingList) && (\n        <div className=\"fixed bottom-24 right-4 z-40\">\n          <Link href=\"/recipes?view=shopping-list\">\n            <Button\n              size=\"lg\"\n              className=\"h-16 w-16 rounded-full shadow-2xl bg-gradient-to-br from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700\"\n              aria-label=\"View shopping list\"\n              data-testid=\"button-fab-shopping-list\"\n            >\n              <ShoppingCart className=\"h-7 w-7\" />\n              <span className=\"sr-only\">Shopping List</span>\n            </Button>\n          </Link>\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":40788},"server/middleware/app-token-middleware.ts":{"content":"import { Request, Response, NextFunction } from \"express\";\nimport path from \"path\";\nimport fs from \"fs\";\n\nexport enum TokenValidationMode {\n  PERMISSIVE = \"permissive\",\n  BLOCKING = \"blocking\",\n  DISABLED = \"disabled\"\n}\n\nlet currentMode: TokenValidationMode = TokenValidationMode.DISABLED;\n\nexport function setTokenValidationMode(mode: TokenValidationMode) {\n  currentMode = mode;\n  console.log(`ðŸ” App token validation mode changed to: ${mode}`);\n}\n\nexport function getTokenValidationMode(): TokenValidationMode {\n  return currentMode;\n}\n\nexport function appTokenMiddleware(req: Request, res: Response, next: NextFunction) {\n  if (currentMode === TokenValidationMode.DISABLED) {\n    return next();\n  }\n\n  // Paths that are always accessible (no token required)\n  const publicPaths = [\n    '/blocked-access.html',\n    '/blocked-access',\n    '/api/health',\n    '/api/token-mode'\n  ];\n\n  // Check if this is a public path\n  if (publicPaths.some(path => req.path.startsWith(path))) {\n    return next();\n  }\n\n  // Check token for ALL other paths\n  const appToken = req.headers['x-app-token'] as string;\n  const expectedToken = process.env.APP_ACCESS_TOKEN;\n\n  if (!expectedToken) {\n    console.warn('âš ï¸ APP_ACCESS_TOKEN not configured');\n    return next();\n  }\n\n  const isValidToken = appToken === expectedToken;\n\n  if (!isValidToken) {\n    const logMessage = `ðŸ”’ Access denied: invalid/missing token - ${req.method} ${req.path}`;\n    \n    if (currentMode === TokenValidationMode.PERMISSIVE) {\n      console.log(`${logMessage} (PERMISSIVE MODE - allowing)`);\n      return next();\n    }\n\n    if (currentMode === TokenValidationMode.BLOCKING) {\n      console.warn(`${logMessage} (BLOCKING MODE - blocking)`);\n      \n      // For API endpoints, return JSON error\n      if (req.path.startsWith('/api/')) {\n        return res.status(403).json({ \n          message: 'Access denied. This service is only accessible through the official PlateMate app.',\n          code: 'INVALID_APP_TOKEN'\n        });\n      }\n      \n      // For all other pages, serve blocked access HTML\n      const htmlPath = path.join(process.cwd(), 'public', 'blocked-access.html');\n      return res.status(403).sendFile(htmlPath);\n    }\n  }\n\n  next();\n}\n","size_bytes":2223},"APP_TOKEN_SECURITY.md":{"content":"# App Token Security Implementation\n\n## Overview\n\nThis implementation locks down your Replit-hosted web app so it can only be accessed through your paid Android app. The system uses a multi-layer approach with a gradual rollout strategy to minimize risk near launch.\n\n## How It Works\n\n### 1. Security Token\n- **Token Value:** Stored securely (do not commit to source control)\n- **Storage:** \n  - Backend: Replit Secrets as `APP_ACCESS_TOKEN`\n  - Android App: Hardcoded in `MainActivity.kt` companion object\n- **Important:** The token value should be kept secret and never committed to the repository\n\n### 2. Request Flow (Backend Exemptions Strategy)\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  Request        â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n         â”‚\n         â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  Is it static/public?               â”‚\nâ”‚  (HTML, CSS, JS, /login, /register) â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n         â”‚\n    YES  â”‚  NO (API endpoint)\n         â”‚            â”‚\n         â–¼            â–¼\n    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n    â”‚ ALLOW  â”‚  â”‚ Check Token  â”‚\n    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜\n                       â”‚\n                  Valid? â”‚\n                       â”œâ”€â”€â”€ YES â†’ Allow\n                       â””â”€â”€â”€ NO  â†’ Block (403)\n```\n\n**Key Design:**\n- Static assets (HTML/CSS/JS) load for everyone\n- API endpoints require valid token\n- Combined with authentication, this effectively locks down the app\n- Android app works 100% normally (has token)\n- Web browsers can't use features (no API access)\n\n### 3. Three Protection Modes\n\n#### **PERMISSIVE** (Current - Default for testing)\n- âœ… All requests allowed\n- ðŸ“Š Invalid/missing tokens are logged to console\n- ðŸŽ¯ Use this to: Test the Android app and verify token is being sent\n\n#### **BLOCKING** (Production mode - when ready)\n- âŒ Requests without valid token are blocked\n- ðŸš« Web users see \"Blocked Access\" page\n- ðŸš« API requests return 403 error\n- ðŸŽ¯ Use this to: Enforce app-only access\n\n#### **DISABLED** (Emergency fallback)\n- âœ… All requests allowed\n- ðŸ“Š No logging\n- ðŸŽ¯ Use this to: Quickly disable protection if something breaks\n\n## Implementation Details\n\n### Backend Files\n\n1. **`server/middleware/app-token-middleware.ts`**\n   - Middleware that checks `X-App-Token` header\n   - Compares against `process.env.APP_ACCESS_TOKEN`\n   - Skips `/blocked-access`, `/api/health`, `/api/token-mode`\n\n2. **`server/index.ts`**\n   - Applies middleware globally (line 15)\n   - Runs on every request before routing\n\n3. **`server/routes.ts`**\n   - GET `/api/token-mode` - Check current mode\n   - POST `/api/token-mode` - Change mode (requires auth)\n\n### Frontend Files\n\n1. **`client/src/pages/BlockedAccess.tsx`**\n   - Beautiful blocked access page with purple gradient\n   - Explains app is Android-only\n   - Link to Google Play Store\n   - Lists app features\n\n2. **`client/src/App.tsx`**\n   - Route added: `/blocked-access`\n\n### Android Files\n\n1. **`android/app/src/main/java/com/platemate/app/MainActivity.kt`**\n   - Token stored in companion object\n   - JavaScript injection on WebView load\n   - Intercepts `fetch()` and `XMLHttpRequest`\n   - Adds `X-App-Token` header to all requests\n\n## Testing Guide\n\n### Phase 1: Verify Token Injection (Current)\n\n1. **Check logs while using the web app directly (no token):**\n   ```\n   Look for: ðŸ”’ Invalid/missing app token from <IP> - GET <path> (PERMISSIVE MODE - allowing)\n   ```\n\n2. **Build Android AAB and install on device:**\n   ```bash\n   npx cap sync android\n   cd android\n   ./gradlew bundleRelease\n   ```\n\n3. **Open app on Android and check logs:**\n   ```\n   Should NOT see: ðŸ”’ Invalid/missing app token\n   ```\n\n4. **Test that app functions normally**\n\n### Phase 2: Switch to Blocking Mode (After testing)\n\n**Option A: Via API (requires authentication)**\n\n```bash\ncurl -X POST https://your-repl-url.replit.dev/api/token-mode \\\n  -H \"Content-Type: application/json\" \\\n  -H \"Cookie: your-session-cookie\" \\\n  -d '{\"mode\": \"blocking\"}'\n```\n\n**Option B: Temporarily edit code**\n\nIn `server/middleware/app-token-middleware.ts`:\n```typescript\nlet currentMode: TokenValidationMode = TokenValidationMode.BLOCKING; // Change from PERMISSIVE\n```\n\n### Phase 3: Verify Blocking Works\n\n1. **Visit web URL directly in browser:**\n   - Should redirect to `/blocked-access`\n   - Should see beautiful purple \"Access Restricted\" page\n\n2. **Test API directly:**\n   ```bash\n   curl https://your-repl-url.replit.dev/api/diary\n   ```\n   - Should return: `{\"message\":\"Access denied...\",\"code\":\"INVALID_APP_TOKEN\"}`\n\n3. **Open Android app:**\n   - Should work normally\n   - No redirect to blocked page\n\n## Switch Between Modes\n\n### Get Current Mode\n```bash\ncurl https://your-repl-url.replit.dev/api/token-mode\n# Returns: {\"mode\":\"permissive\"}\n```\n\n### Change Mode (requires auth)\n```bash\n# Switch to blocking\nPOST /api/token-mode\nBody: {\"mode\": \"blocking\"}\n\n# Switch to permissive  \nPOST /api/token-mode\nBody: {\"mode\": \"permissive\"}\n\n# Emergency disable\nPOST /api/token-mode\nBody: {\"mode\": \"disabled\"}\n```\n\n## Rollback Strategy\n\nIf anything breaks in production:\n\n1. **Immediate fix (< 30 seconds):**\n   ```bash\n   POST /api/token-mode with {\"mode\": \"disabled\"}\n   ```\n\n2. **Alternative: Comment out middleware:**\n   In `server/index.ts`, comment out line 15:\n   ```typescript\n   // app.use(appTokenMiddleware);\n   ```\n\n## Security Considerations\n\n### Current Limitations\nâš ï¸ **The token CAN be extracted by decompiling the Android APK**\n- Provides good protection against casual access\n- NOT cryptographically secure against determined attackers\n\n### Future Improvements (Optional)\n1. **Google Play Integrity API** - Verify app signature\n2. **JWT Tokens** - Short-lived tokens with expiration\n3. **Server-side subscription validation** - Check Google Play billing status\n\n### Current Approach is Good For:\nâœ… Preventing casual web access\nâœ… Ensuring users download the app\nâœ… Separating free (web) vs paid (app) tiers\nâœ… Quick rollout with minimal risk\n\n## Launch Checklist\n\n- [ ] Test Android app with token injection\n- [ ] Verify logs show no \"Invalid/missing app token\" warnings from app\n- [ ] Test web browser shows logged warnings (permissive mode)\n- [ ] Test blocked access page renders correctly\n- [ ] Test switching modes via API\n- [ ] Build final AAB with token embedded\n- [ ] Switch to BLOCKING mode after app launch\n- [ ] Monitor logs for any issues\n- [ ] Keep rollback plan ready\n\n## Token Rotation (Future)\n\nIf you need to change the token:\n\n1. Generate new token:\n   ```bash\n   node -e \"console.log(require('crypto').randomBytes(32).toString('base64url'))\"\n   ```\n\n2. Update Replit secret: `APP_ACCESS_TOKEN`\n\n3. Update Android `MainActivity.kt` companion object\n\n4. Rebuild and release new Android version\n\n5. Old app versions will stop working (forced update)\n\n## Support\n\nCurrent mode: **BLOCKING** (actively blocking unauthorized access)\nToken configured: **âœ… Yes**\nMiddleware active: **âœ… Yes**\nAndroid integration: **âœ… Ready**\nBlocked page: **âœ… Ready**\nProtection level: **FULL** (All routes protected, not just APIs)\n\nThe app is now fully protected! ðŸ”’\n\n### What's Protected:\n- âœ… ALL frontend pages and routes\n- âœ… ALL API endpoints\n- âœ… Static assets (CSS, JS, images, etc.)\n- âœ… Everything except the blocked access page and health checks\n\n### How It Works Now:\n1. Web browser visits site â†’ **Sees blocked access page immediately**\n2. Android app with token â†’ **Full access to everything**\n3. No redirect loops or glitches\n\nEverything is live and protecting your app! ðŸŽ‰\n","size_bytes":7905},"client/src/pages/BlockedAccess.tsx":{"content":"import { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { ShieldAlert, Smartphone, ExternalLink } from \"lucide-react\";\n\nexport default function BlockedAccess() {\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-purple-50 via-white to-purple-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center p-4\">\n      <Card className=\"max-w-2xl w-full shadow-2xl border-purple-200 dark:border-purple-900\" data-testid=\"card-blocked-access\">\n        <CardHeader className=\"text-center space-y-4\">\n          <div className=\"mx-auto w-20 h-20 bg-purple-100 dark:bg-purple-900/30 rounded-full flex items-center justify-center\">\n            <ShieldAlert className=\"w-12 h-12 text-purple-600 dark:text-purple-400\" data-testid=\"icon-shield-alert\" />\n          </div>\n          <CardTitle className=\"text-3xl font-bold text-gray-900 dark:text-white\" data-testid=\"text-blocked-title\">\n            Access Restricted\n          </CardTitle>\n          <CardDescription className=\"text-lg text-gray-600 dark:text-gray-300\" data-testid=\"text-blocked-description\">\n            This web version is only accessible through the official PlateMate Android app\n          </CardDescription>\n        </CardHeader>\n        \n        <CardContent className=\"space-y-6\">\n          <div className=\"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-6 border border-purple-200 dark:border-purple-800\" data-testid=\"container-app-info\">\n            <div className=\"flex items-start space-x-4\">\n              <Smartphone className=\"w-8 h-8 text-purple-600 dark:text-purple-400 flex-shrink-0 mt-1\" data-testid=\"icon-smartphone\" />\n              <div>\n                <h3 className=\"font-semibold text-gray-900 dark:text-white mb-2\" data-testid=\"text-download-title\">\n                  Get the Official App\n                </h3>\n                <p className=\"text-gray-600 dark:text-gray-300 mb-4\" data-testid=\"text-download-description\">\n                  PlateMate is designed as a premium mobile experience with AI-powered food scanning, \n                  personalized nutrition coaching, and comprehensive meal tracking.\n                </p>\n                <Button\n                  className=\"w-full sm:w-auto bg-purple-600 hover:bg-purple-700 dark:bg-purple-500 dark:hover:bg-purple-600\"\n                  onClick={() => window.open('https://play.google.com/store', '_blank')}\n                  data-testid=\"button-download-app\"\n                >\n                  <ExternalLink className=\"w-4 h-4 mr-2\" />\n                  Download from Google Play\n                </Button>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"border-t border-gray-200 dark:border-gray-700 pt-6\" data-testid=\"container-features\">\n            <h4 className=\"font-semibold text-gray-900 dark:text-white mb-3\" data-testid=\"text-features-title\">\n              What you'll get with PlateMate:\n            </h4>\n            <ul className=\"space-y-2 text-gray-600 dark:text-gray-300\" data-testid=\"list-features\">\n              <li className=\"flex items-center\" data-testid=\"feature-ai-scanning\">\n                <span className=\"w-2 h-2 bg-purple-600 dark:bg-purple-400 rounded-full mr-3\"></span>\n                AI-powered food image recognition and nutrition analysis\n              </li>\n              <li className=\"flex items-center\" data-testid=\"feature-ai-coach\">\n                <span className=\"w-2 h-2 bg-purple-600 dark:bg-purple-400 rounded-full mr-3\"></span>\n                Personal AI nutrition coach with multiple personalities\n              </li>\n              <li className=\"flex items-center\" data-testid=\"feature-shift-planner\">\n                <span className=\"w-2 h-2 bg-purple-600 dark:bg-purple-400 rounded-full mr-3\"></span>\n                Weekly shift planner for NHS/frontline workers\n              </li>\n              <li className=\"flex items-center\" data-testid=\"feature-challenges\">\n                <span className=\"w-2 h-2 bg-purple-600 dark:bg-purple-400 rounded-full mr-3\"></span>\n                Gamified challenges and rewards system\n              </li>\n              <li className=\"flex items-center\" data-testid=\"feature-tracking\">\n                <span className=\"w-2 h-2 bg-purple-600 dark:bg-purple-400 rounded-full mr-3\"></span>\n                Comprehensive meal, water, and weight tracking\n              </li>\n            </ul>\n          </div>\n\n          <div className=\"text-center text-sm text-gray-500 dark:text-gray-400\" data-testid=\"text-footer\">\n            <p>Already have the app? Open PlateMate on your Android device to continue.</p>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":4782},"client/src/contexts/SubscriptionContext.tsx":{"content":"import { createContext, useContext, useEffect, useState, ReactNode } from 'react';\nimport Subscription from '@/plugins/subscription';\nimport { App } from '@capacitor/app';\nimport { useToast } from '@/hooks/use-toast';\n\ninterface SubscriptionContextType {\n  isSubscribed: boolean;\n  isLoading: boolean;\n  checkSubscription: () => Promise<void>;\n  launchSubscription: () => Promise<void>;\n}\n\nconst SubscriptionContext = createContext<SubscriptionContextType | undefined>(undefined);\n\nexport function SubscriptionProvider({ children }: { children: ReactNode }) {\n  const [isSubscribed, setIsSubscribed] = useState<boolean>(false);\n  const [isLoading, setIsLoading] = useState<boolean>(true);\n  const { toast } = useToast();\n\n  const checkSubscription = async () => {\n    try {\n      setIsLoading(true);\n      const result = await Subscription.checkSubscriptionStatus();\n      \n      // Log detailed subscription status for debugging\n      console.log('ðŸ“± Subscription Status Check:', {\n        isSubscribed: result.isSubscribed,\n        productId: result.productId,\n        platform: navigator.userAgent.includes('Mobile') ? 'mobile' : 'web'\n      });\n      \n      setIsSubscribed(result.isSubscribed);\n    } catch (error) {\n      console.error('âŒ Error checking subscription:', error);\n      setIsSubscribed(false);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const launchSubscription = async () => {\n    try {\n      await Subscription.launchSubscriptionFlow();\n      // After successful purchase, recheck status\n      await checkSubscription();\n    } catch (error: any) {\n      console.error('Error launching subscription:', error);\n      if (error.message && !error.message.includes('User canceled')) {\n        toast({\n          title: 'Subscription Error',\n          description: error.message || 'Failed to start subscription',\n          variant: 'destructive'\n        });\n      }\n    }\n  };\n\n  useEffect(() => {\n    // Check subscription on mount\n    checkSubscription();\n\n    // Re-check when app comes to foreground\n    const appStateListener = App.addListener('appStateChange', ({ isActive }) => {\n      if (isActive) {\n        checkSubscription();\n      }\n    });\n\n    return () => {\n      appStateListener.then(listener => listener.remove());\n    };\n  }, []);\n\n  return (\n    <SubscriptionContext.Provider\n      value={{\n        isSubscribed,\n        isLoading,\n        checkSubscription,\n        launchSubscription\n      }}\n    >\n      {children}\n    </SubscriptionContext.Provider>\n  );\n}\n\nexport function useSubscription() {\n  const context = useContext(SubscriptionContext);\n  if (!context) {\n    throw new Error('useSubscription must be used within SubscriptionProvider');\n  }\n  return context;\n}\n","size_bytes":2727},"client/src/pages/subscription.tsx":{"content":"import { useSubscription } from '@/contexts/SubscriptionContext';\nimport { Button } from '@/components/ui/button';\nimport { Card } from '@/components/ui/card';\nimport { Check, Sparkles, Camera, BarChart3, Trophy, Brain, Smartphone, AlertCircle } from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport { Capacitor } from '@capacitor/core';\nimport { useState } from 'react';\n\nexport default function SubscriptionPage() {\n  const { launchSubscription, isLoading, isSubscribed } = useSubscription();\n  const [showMobileOnlyMessage, setShowMobileOnlyMessage] = useState(false);\n  const [purchaseError, setPurchaseError] = useState<string | null>(null);\n  \n  // Check if we're on a native platform\n  const isNativePlatform = Capacitor.isNativePlatform();\n  const platform = Capacitor.getPlatform();\n  \n  // Additional check: Android user agent detection for dev mode\n  const isLikelyAndroid = /android/i.test(navigator.userAgent);\n  const shouldShowNativeButton = isNativePlatform || isLikelyAndroid;\n\n  const features = [\n    {\n      icon: <Camera className=\"w-6 h-6\" />,\n      title: 'AI Food Recognition',\n      description: 'Instantly identify foods and get nutritional breakdowns from photos'\n    },\n    {\n      icon: <Brain className=\"w-6 h-6\" />,\n      title: 'Smart Coaching',\n      description: 'Personalized AI coach with multiple personalities to keep you motivated'\n    },\n    {\n      icon: <BarChart3 className=\"w-6 h-6\" />,\n      title: 'Progress Tracking',\n      description: 'Track calories, macros, and see your daily nutrition at a glance'\n    },\n    {\n      icon: <Trophy className=\"w-6 h-6\" />,\n      title: 'Challenges & Rewards',\n      description: 'Complete daily challenges and unlock achievements'\n    }\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-purple-900 via-purple-800 to-indigo-900 flex items-center justify-center p-6\">\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ duration: 0.5 }}\n        className=\"w-full max-w-lg\"\n      >\n        <Card className=\"bg-white/10 backdrop-blur-lg border-white/20 p-8 shadow-2xl\">\n          {/* Header */}\n          <div className=\"text-center mb-8\">\n            <motion.div\n              initial={{ scale: 0 }}\n              animate={{ scale: 1 }}\n              transition={{ delay: 0.2, type: 'spring', stiffness: 200 }}\n              className=\"w-20 h-20 mx-auto mb-4 bg-gradient-to-br from-purple-400 to-pink-400 rounded-full flex items-center justify-center\"\n            >\n              <Sparkles className=\"w-10 h-10 text-white\" />\n            </motion.div>\n            <h1 className=\"text-4xl font-bold text-white mb-2\" data-testid=\"text-subscription-title\">\n              Unlock PlateMate Pro\n            </h1>\n            <p className=\"text-purple-200 text-lg\" data-testid=\"text-subscription-subtitle\">\n              Start your 7-day free trial today\n            </p>\n          </div>\n\n          {/* Features */}\n          <div className=\"space-y-4 mb-8\">\n            {features.map((feature, index) => (\n              <motion.div\n                key={feature.title}\n                initial={{ opacity: 0, x: -20 }}\n                animate={{ opacity: 1, x: 0 }}\n                transition={{ delay: 0.3 + index * 0.1 }}\n                className=\"flex items-start gap-4 p-4 rounded-lg bg-white/5 backdrop-blur-sm\"\n                data-testid={`feature-card-${index}`}\n              >\n                <div className=\"flex-shrink-0 w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center text-white\">\n                  {feature.icon}\n                </div>\n                <div>\n                  <h3 className=\"text-white font-semibold mb-1\">{feature.title}</h3>\n                  <p className=\"text-purple-200 text-sm\">{feature.description}</p>\n                </div>\n              </motion.div>\n            ))}\n          </div>\n\n          {/* Pricing */}\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            transition={{ delay: 0.7 }}\n            className=\"bg-gradient-to-r from-purple-600 to-pink-600 rounded-lg p-6 mb-6 text-center\"\n            data-testid=\"pricing-card\"\n          >\n            <div className=\"text-white mb-2\">\n              <span className=\"text-5xl font-bold\">Â£4.99</span>\n              <span className=\"text-purple-200 text-lg\">/month</span>\n            </div>\n            <p className=\"text-purple-100 text-sm\">After 7-day free trial</p>\n          </motion.div>\n\n          {/* Benefits List */}\n          <div className=\"space-y-2 mb-6\">\n            {[\n              'Full access to all features',\n              'AI-powered nutritional coaching',\n              'Unlimited food scanning',\n              'Advanced progress tracking',\n              'Cancel anytime'\n            ].map((benefit, index) => (\n              <div key={index} className=\"flex items-center gap-3 text-white\" data-testid={`benefit-${index}`}>\n                <div className=\"flex-shrink-0 w-5 h-5 bg-green-500 rounded-full flex items-center justify-center\">\n                  <Check className=\"w-3 h-3\" />\n                </div>\n                <span className=\"text-sm\">{benefit}</span>\n              </div>\n            ))}\n          </div>\n\n          {/* Already Subscribed Message */}\n          {isSubscribed && (\n            <div className=\"mb-4 p-4 bg-green-500/20 border border-green-500/50 rounded-lg\" data-testid=\"info-already-subscribed\">\n              <div className=\"flex items-start gap-3\">\n                <Check className=\"w-5 h-5 text-green-300 flex-shrink-0 mt-0.5\" />\n                <div>\n                  <p className=\"text-green-100 font-semibold text-sm mb-1\">You're Already Subscribed!</p>\n                  <p className=\"text-green-200 text-xs\">\n                    You have full access to all PlateMate Pro features. Manage your subscription in Google Play Store.\n                  </p>\n                </div>\n              </div>\n            </div>\n          )}\n          \n          {/* Purchase Error Message */}\n          {purchaseError && (\n            <div className=\"mb-4 p-4 bg-red-500/20 border border-red-500/50 rounded-lg\" data-testid=\"error-purchase\">\n              <div className=\"flex items-start gap-3\">\n                <AlertCircle className=\"w-5 h-5 text-red-300 flex-shrink-0 mt-0.5\" />\n                <div>\n                  <p className=\"text-red-100 font-semibold text-sm mb-1\">Purchase Failed</p>\n                  <p className=\"text-red-200 text-xs\">{purchaseError}</p>\n                </div>\n              </div>\n            </div>\n          )}\n          \n          {/* Mobile-Only Warning (Web Desktop) */}\n          {!shouldShowNativeButton && (\n            <div className=\"mb-4 p-4 bg-yellow-500/20 border border-yellow-500/50 rounded-lg\" data-testid=\"warning-mobile-only\">\n              <div className=\"flex items-start gap-3\">\n                <AlertCircle className=\"w-5 h-5 text-yellow-300 flex-shrink-0 mt-0.5\" />\n                <div>\n                  <p className=\"text-yellow-100 font-semibold text-sm mb-1\">Mobile App Required</p>\n                  <p className=\"text-yellow-200 text-xs\">\n                    Subscriptions can only be purchased through the PlateMate mobile app on Google Play. \n                    Download the app to subscribe and access all premium features.\n                  </p>\n                </div>\n              </div>\n            </div>\n          )}\n          \n          {/* Dev Mode Warning (Android in development) */}\n          {shouldShowNativeButton && !isNativePlatform && (\n            <div className=\"mb-4 p-4 bg-blue-500/20 border border-blue-500/50 rounded-lg\" data-testid=\"warning-dev-mode\">\n              <div className=\"flex items-start gap-3\">\n                <Smartphone className=\"w-5 h-5 text-blue-300 flex-shrink-0 mt-0.5\" />\n                <div>\n                  <p className=\"text-blue-100 font-semibold text-sm mb-1\">Development Mode Detected</p>\n                  <p className=\"text-blue-200 text-xs\">\n                    You're running in development mode. For billing to work, build a production APK using \n                    \"npm run build\" and \"npx cap sync android\", then install via Android Studio without live reload.\n                  </p>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* CTA Button */}\n          <Button\n            onClick={async () => {\n              if (isSubscribed) {\n                // Already subscribed, nothing to do\n                return;\n              }\n              \n              if (!shouldShowNativeButton) {\n                setShowMobileOnlyMessage(true);\n                return;\n              }\n              \n              try {\n                setPurchaseError(null);\n                await launchSubscription();\n              } catch (error: any) {\n                console.error('Purchase error:', error);\n                \n                // Don't show error if user cancelled\n                if (error?.message?.includes('cancel')) {\n                  return;\n                }\n                \n                // Show helpful error message\n                if (error?.code === 'UNIMPLEMENTED') {\n                  setPurchaseError('Native billing plugin not available. Make sure you\\'re running a production build installed from Google Play.');\n                } else {\n                  setPurchaseError(error?.message || 'An error occurred. Please try again.');\n                }\n              }\n            }}\n            disabled={isLoading || isSubscribed || (!shouldShowNativeButton)}\n            className=\"w-full h-14 text-lg font-bold bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed\"\n            data-testid=\"button-start-trial\"\n          >\n            {isLoading ? 'Loading...' : \n             isSubscribed ? 'Already Subscribed âœ“' :\n             shouldShowNativeButton ? 'Start My Free Trial' : \n             'Download Mobile App to Subscribe'}\n          </Button>\n\n          {showMobileOnlyMessage && !isNativePlatform && (\n            <div className=\"mt-4 p-3 bg-blue-500/20 border border-blue-500/50 rounded-lg\" data-testid=\"info-download-app\">\n              <div className=\"flex items-center gap-2 text-blue-200 text-sm\">\n                <Smartphone className=\"w-4 h-4\" />\n                <p>Please download PlateMate from Google Play Store to subscribe</p>\n              </div>\n            </div>\n          )}\n\n          {/* Fine Print */}\n          <p className=\"text-purple-300 text-xs text-center mt-4\" data-testid=\"text-terms\">\n            Your subscription will automatically renew unless canceled at least 24 hours before the end of the current period. \n            Manage your subscription in Google Play Store.\n          </p>\n        </Card>\n      </motion.div>\n    </div>\n  );\n}\n","size_bytes":11029},"client/src/components/SubscriptionGate.tsx":{"content":"import { useSubscription } from '@/contexts/SubscriptionContext';\nimport { useLocation } from 'wouter';\nimport { useEffect } from 'react';\n\ninterface SubscriptionGateProps {\n  children: React.ReactNode;\n}\n\nexport function SubscriptionGate({ children }: SubscriptionGateProps) {\n  const { isSubscribed, isLoading } = useSubscription();\n  const [location, setLocation] = useLocation();\n\n  // TEMPORARY: Bypass subscription until production build is properly configured\n  const BYPASS_SUBSCRIPTION = true;\n\n  // Paths that don't require subscription\n  const publicPaths = ['/subscription', '/login', '/register', '/forgot-password', '/landing', '/blocked-access'];\n\n  useEffect(() => {\n    // Wait for loading to complete\n    if (isLoading) return;\n\n    // Bypass subscription check until production build is ready\n    if (BYPASS_SUBSCRIPTION) {\n      console.log('ðŸš§ Bypassing subscription check - using free access mode');\n      return;\n    }\n\n    // Check if current path is public\n    const isPublicPath = publicPaths.some(path => location.startsWith(path));\n\n    // If not subscribed and trying to access protected content, redirect to subscription\n    if (!isSubscribed && !isPublicPath) {\n      console.log('ðŸ”’ Redirecting to subscription - not subscribed');\n      setLocation('/subscription');\n    }\n  }, [isSubscribed, isLoading, location]);\n\n  // Show loading while checking subscription\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-900 via-purple-800 to-indigo-900\">\n        <div className=\"text-white text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4\"></div>\n          <p className=\"text-lg\">Loading PlateMate...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return <>{children}</>;\n}\n","size_bytes":1846},"client/src/plugins/subscription.ts":{"content":"import { registerPlugin } from '@capacitor/core';\n\nexport interface SubscriptionPlugin {\n  checkSubscriptionStatus(): Promise<{\n    isSubscribed: boolean;\n    productId?: string;\n    purchaseToken?: string;\n    purchaseTime?: number;\n    isAutoRenewing?: boolean;\n  }>;\n  \n  launchSubscriptionFlow(): Promise<void>;\n}\n\n// Register our custom billing plugin\nconst Billing = registerPlugin<SubscriptionPlugin>('Billing');\n\nclass SubscriptionService implements SubscriptionPlugin {\n  private readonly PRODUCT_ID = 'platemate_pro_monthly';\n  \n  async checkSubscriptionStatus(): Promise<{\n    isSubscribed: boolean;\n    productId?: string;\n    purchaseToken?: string;\n    purchaseTime?: number;\n    isAutoRenewing?: boolean;\n  }> {\n    try {\n      console.log('ðŸ” Checking subscription status via native plugin...');\n      \n      const result = await Billing.checkSubscriptionStatus();\n      \n      console.log('ðŸ“¦ Subscription status:', {\n        isSubscribed: result.isSubscribed,\n        productId: result.productId,\n        hasToken: !!result.purchaseToken\n      });\n      \n      return result;\n    } catch (error) {\n      console.error('âŒ Error checking subscription:', error);\n      \n      // Return not subscribed on error\n      return {\n        isSubscribed: false,\n        productId: this.PRODUCT_ID\n      };\n    }\n  }\n  \n  async launchSubscriptionFlow(): Promise<void> {\n    try {\n      console.log('ðŸš€ Launching subscription flow via native plugin...');\n      \n      await Billing.launchSubscriptionFlow();\n      \n      console.log('âœ… Subscription flow completed - purchase successful');\n    } catch (error: any) {\n      console.error('âŒ Error launching subscription flow:', error);\n      \n      // Check if user cancelled\n      if (error.message?.includes('cancel') || error.message?.includes('cancelled')) {\n        console.log('â„¹ï¸ User cancelled purchase');\n        throw new Error('User cancelled');\n      }\n      \n      throw error instanceof Error ? error : new Error('Failed to launch subscription flow');\n    }\n  }\n}\n\n// Create singleton instance\nconst Subscription = new SubscriptionService();\n\nexport default Subscription;\n","size_bytes":2155},"android/app/src/main/java/com/georgebrennan/platemate3/BillingPlugin.kt":{"content":"package com.georgebrennan.platemate3\n\nimport android.app.Activity\nimport android.util.Log\nimport com.android.billingclient.api.*\nimport com.getcapacitor.JSObject\nimport com.getcapacitor.Plugin\nimport com.getcapacitor.PluginCall\nimport com.getcapacitor.PluginMethod\nimport com.getcapacitor.annotation.CapacitorPlugin\n\n@CapacitorPlugin(name = \"Billing\")\nclass BillingPlugin : Plugin() {\n    \n    companion object {\n        private const val TAG = \"BillingPlugin\"\n        private const val PRODUCT_ID = \"platemate_pro_monthly\"\n    }\n    \n    private var billingClient: BillingClient? = null\n    private var isServiceConnected = false\n    private var purchaseFlowCall: PluginCall? = null\n    \n    override fun load() {\n        super.load()\n        Log.d(TAG, \"========================================\")\n        Log.d(TAG, \"ðŸš€ BILLING PLUGIN LOADED - NATIVE ANDROID\")\n        Log.d(TAG, \"ðŸ“± This message only appears if running as native app\")\n        Log.d(TAG, \"========================================\")\n        initializeBillingClient()\n    }\n    \n    private fun initializeBillingClient() {\n        Log.d(TAG, \"ðŸ“¦ Initializing BillingClient...\")\n        \n        val purchasesUpdatedListener = PurchasesUpdatedListener { billingResult, purchases ->\n            handlePurchasesUpdate(billingResult, purchases)\n        }\n        \n        billingClient = BillingClient.newBuilder(context)\n            .setListener(purchasesUpdatedListener)\n            .enablePendingPurchases()\n            .enableAutoServiceReconnection()\n            .build()\n        \n        startConnection()\n    }\n    \n    private fun startConnection() {\n        billingClient?.startConnection(object : BillingClientStateListener {\n            override fun onBillingSetupFinished(billingResult: BillingResult) {\n                if (billingResult.responseCode == BillingClient.BillingResponseCode.OK) {\n                    isServiceConnected = true\n                    Log.d(TAG, \"âœ… BillingClient connected successfully\")\n                } else {\n                    isServiceConnected = false\n                    Log.e(TAG, \"âŒ BillingClient connection failed: ${billingResult.debugMessage}\")\n                }\n            }\n            \n            override fun onBillingServiceDisconnected() {\n                isServiceConnected = false\n                Log.w(TAG, \"âš ï¸ BillingClient disconnected\")\n            }\n        })\n    }\n    \n    @PluginMethod\n    fun checkSubscriptionStatus(call: PluginCall) {\n        Log.d(TAG, \"ðŸ” Checking subscription status...\")\n        \n        if (!isServiceConnected) {\n            Log.w(TAG, \"âš ï¸ BillingClient not connected, attempting reconnection...\")\n            startConnection()\n            call.reject(\"BillingClient not connected. Please try again.\")\n            return\n        }\n        \n        // Query active subscriptions\n        val params = QueryPurchasesParams.newBuilder()\n            .setProductType(BillingClient.ProductType.SUBS)\n            .build()\n        \n        billingClient?.queryPurchasesAsync(params) { billingResult, purchases ->\n            if (billingResult.responseCode == BillingClient.BillingResponseCode.OK) {\n                val activePurchase = purchases.find { purchase ->\n                    purchase.products.contains(PRODUCT_ID) && \n                    purchase.purchaseState == Purchase.PurchaseState.PURCHASED\n                }\n                \n                val result = JSObject()\n                if (activePurchase != null) {\n                    Log.d(TAG, \"âœ… Active subscription found: $PRODUCT_ID\")\n                    result.put(\"isSubscribed\", true)\n                    result.put(\"productId\", PRODUCT_ID)\n                    result.put(\"purchaseToken\", activePurchase.purchaseToken)\n                    result.put(\"purchaseTime\", activePurchase.purchaseTime)\n                    result.put(\"isAutoRenewing\", activePurchase.isAutoRenewing)\n                } else {\n                    Log.d(TAG, \"â„¹ï¸ No active subscription found\")\n                    result.put(\"isSubscribed\", false)\n                    result.put(\"productId\", PRODUCT_ID)\n                }\n                call.resolve(result)\n            } else {\n                Log.e(TAG, \"âŒ Failed to query purchases: ${billingResult.debugMessage}\")\n                call.reject(\"Failed to check subscription status: ${billingResult.debugMessage}\")\n            }\n        }\n    }\n    \n    @PluginMethod\n    fun launchSubscriptionFlow(call: PluginCall) {\n        Log.d(TAG, \"ðŸ”„ Launching subscription flow...\")\n        \n        if (!isServiceConnected) {\n            Log.w(TAG, \"âš ï¸ BillingClient not connected\")\n            call.reject(\"BillingClient not connected. Please try again.\")\n            return\n        }\n        \n        // Query product details\n        val productList = listOf(\n            QueryProductDetailsParams.Product.newBuilder()\n                .setProductId(PRODUCT_ID)\n                .setProductType(BillingClient.ProductType.SUBS)\n                .build()\n        )\n        \n        val params = QueryProductDetailsParams.newBuilder()\n            .setProductList(productList)\n            .build()\n        \n        billingClient?.queryProductDetailsAsync(params) { billingResult, productDetailsList ->\n            if (billingResult.responseCode == BillingClient.BillingResponseCode.OK && productDetailsList.isNotEmpty()) {\n                val productDetails = productDetailsList[0]\n                val offerToken = productDetails.subscriptionOfferDetails?.get(0)?.offerToken\n                \n                if (offerToken != null) {\n                    Log.d(TAG, \"ðŸš€ Launching purchase flow for $PRODUCT_ID\")\n                    launchPurchaseFlow(productDetails, offerToken, call)\n                } else {\n                    Log.e(TAG, \"âŒ No subscription offers available\")\n                    call.reject(\"No subscription offers available\")\n                }\n            } else {\n                Log.e(TAG, \"âŒ Failed to query product details: ${billingResult.debugMessage}\")\n                call.reject(\"Failed to load subscription details: ${billingResult.debugMessage}\")\n            }\n        }\n    }\n    \n    private fun launchPurchaseFlow(\n        productDetails: ProductDetails,\n        offerToken: String,\n        call: PluginCall\n    ) {\n        val productDetailsParamsList = listOf(\n            BillingFlowParams.ProductDetailsParams.newBuilder()\n                .setProductDetails(productDetails)\n                .setOfferToken(offerToken)\n                .build()\n        )\n        \n        val billingFlowParams = BillingFlowParams.newBuilder()\n            .setProductDetailsParamsList(productDetailsParamsList)\n            .build()\n        \n        val activity: Activity = activity ?: run {\n            Log.e(TAG, \"âŒ No activity available for purchase flow\")\n            call.reject(\"No activity available\")\n            return\n        }\n        \n        val billingResult = billingClient?.launchBillingFlow(activity, billingFlowParams)\n        \n        if (billingResult?.responseCode == BillingClient.BillingResponseCode.OK) {\n            Log.d(TAG, \"âœ… Purchase flow launched successfully\")\n            // Cache the call to resolve it when purchase completes\n            purchaseFlowCall = call\n        } else {\n            Log.e(TAG, \"âŒ Failed to launch purchase flow: ${billingResult?.debugMessage}\")\n            call.reject(\"Failed to launch purchase flow: ${billingResult?.debugMessage}\")\n        }\n    }\n    \n    private fun handlePurchasesUpdate(billingResult: BillingResult, purchases: List<Purchase>?) {\n        val call = purchaseFlowCall\n        \n        when (billingResult.responseCode) {\n            BillingClient.BillingResponseCode.OK -> {\n                if (purchases.isNullOrEmpty()) {\n                    Log.w(TAG, \"âš ï¸ Purchase update returned OK but with no purchases\")\n                    call?.reject(\"No purchase data received\")\n                    purchaseFlowCall = null\n                    return\n                }\n                \n                var hasPurchased = false\n                var hasPending = false\n                \n                for (purchase in purchases) {\n                    when (purchase.purchaseState) {\n                        Purchase.PurchaseState.PURCHASED -> {\n                            if (!purchase.isAcknowledged) {\n                                acknowledgePurchase(purchase)\n                            }\n                            Log.d(TAG, \"âœ… Purchase successful: ${purchase.products}\")\n                            hasPurchased = true\n                        }\n                        Purchase.PurchaseState.PENDING -> {\n                            Log.d(TAG, \"â³ Purchase pending: ${purchase.products}\")\n                            hasPending = true\n                        }\n                        else -> {\n                            Log.w(TAG, \"âš ï¸ Unknown purchase state: ${purchase.purchaseState}\")\n                        }\n                    }\n                }\n                \n                // Always clear the cached call\n                if (call != null) {\n                    if (hasPurchased) {\n                        val result = JSObject()\n                        result.put(\"success\", true)\n                        result.put(\"message\", \"Purchase completed successfully\")\n                        call.resolve(result)\n                    } else if (hasPending) {\n                        call.reject(\"Purchase is pending. Please check back later.\")\n                    } else {\n                        call.reject(\"Purchase completed but not in purchased state\")\n                    }\n                    purchaseFlowCall = null\n                }\n            }\n            \n            BillingClient.BillingResponseCode.USER_CANCELED -> {\n                Log.d(TAG, \"â„¹ï¸ User cancelled purchase\")\n                call?.reject(\"User cancelled purchase\")\n                purchaseFlowCall = null\n            }\n            \n            else -> {\n                Log.e(TAG, \"âŒ Purchase failed: ${billingResult.debugMessage}\")\n                call?.reject(\"Purchase failed: ${billingResult.debugMessage}\")\n                purchaseFlowCall = null\n            }\n        }\n    }\n    \n    private fun acknowledgePurchase(purchase: Purchase) {\n        val params = AcknowledgePurchaseParams.newBuilder()\n            .setPurchaseToken(purchase.purchaseToken)\n            .build()\n        \n        billingClient?.acknowledgePurchase(params) { billingResult ->\n            if (billingResult.responseCode == BillingClient.BillingResponseCode.OK) {\n                Log.d(TAG, \"âœ… Purchase acknowledged\")\n            } else {\n                Log.e(TAG, \"âŒ Failed to acknowledge purchase: ${billingResult.debugMessage}\")\n            }\n        }\n    }\n}\n","size_bytes":10841},"android/app/src/main/java/com/georgebrennan/platemate3/MainActivity.kt":{"content":"package com.georgebrennan.platemate3\n\nimport android.animation.ObjectAnimator\nimport android.animation.PropertyValuesHolder\nimport android.animation.ValueAnimator\nimport android.os.Bundle\nimport android.view.View\nimport android.view.animation.LinearInterpolator\nimport android.webkit.WebResourceRequest\nimport android.webkit.WebResourceResponse\nimport android.webkit.WebView\nimport android.webkit.WebViewClient\nimport android.widget.FrameLayout\nimport android.widget.ImageView\nimport com.getcapacitor.BridgeActivity\nimport java.io.IOException\nimport java.net.HttpURLConnection\nimport java.net.URL\n\nclass MainActivity : BridgeActivity() {\n    \n    companion object {\n        // This token must match APP_ACCESS_TOKEN in your Replit secrets\n        private const val APP_ACCESS_TOKEN = \"i9wD15teB7oYJLsRzaMBhpAIZG8yUWJnAo0phKwRdn4\"\n    }\n    \n    override fun onCreate(savedInstanceState: Bundle?) {\n        super.onCreate(savedInstanceState)\n        \n        android.util.Log.e(\"PLATEMATE\", \"========================================\")\n        android.util.Log.e(\"PLATEMATE\", \"ðŸš€ PLATEMATE APP STARTING - NATIVE ANDROID\")\n        android.util.Log.e(\"PLATEMATE\", \"ðŸ“± Package: com.georgebrennan.platemate3\")\n        android.util.Log.e(\"PLATEMATE\", \"========================================\")\n        \n        // Register our custom billing plugin AFTER super.onCreate()\n        registerPlugin(BillingPlugin::class.java)\n        android.util.Log.e(\"PLATEMATE\", \"âœ… BillingPlugin registered\")\n        \n        // Inject custom header into all WebView requests\n        setupWebViewHeaderInjection()\n        \n        // Add mic icon animation\n        val micIcon: ImageView = findViewById(R.id.micIcon)\n        val scaleUp = ObjectAnimator.ofPropertyValuesHolder(\n            micIcon,\n            PropertyValuesHolder.ofFloat(View.SCALE_X, 1.2f),\n            PropertyValuesHolder.ofFloat(View.SCALE_Y, 1.2f)\n        )\n        scaleUp.duration = 800\n        scaleUp.repeatCount = ValueAnimator.INFINITE\n        scaleUp.repeatMode = ValueAnimator.REVERSE\n        scaleUp.start()\n\n        // Add barcode scan line animation\n        val scanLine: View = findViewById(R.id.scanLine)\n        val barcodeButton: FrameLayout = findViewById(R.id.barcodeButton)\n\n        barcodeButton.post {\n            val height = barcodeButton.height - scanLine.height\n\n            val animator = ObjectAnimator.ofFloat(scanLine, \"translationY\", 0f, height.toFloat())\n            animator.duration = 1500\n            animator.repeatCount = ValueAnimator.INFINITE\n            animator.repeatMode = ValueAnimator.REVERSE\n            animator.interpolator = LinearInterpolator()\n            animator.start()\n        }\n    }\n    \n    private fun setupWebViewHeaderInjection() {\n        try {\n            bridge.webView.webViewClient = object : WebViewClient() {\n                \n                override fun onPageStarted(view: WebView?, url: String?, favicon: android.graphics.Bitmap?) {\n                    super.onPageStarted(view, url, favicon)\n                    android.util.Log.e(\"PLATEMATE\", \"ðŸ“„ WebView loading URL: $url\")\n                    \n                    if (url?.contains(\"replit\") == true) {\n                        android.util.Log.e(\"PLATEMATE\", \"âŒ WARNING: Loading from REPLIT SERVER (should be capacitor://localhost)\")\n                    } else if (url?.startsWith(\"capacitor://\") == true) {\n                        android.util.Log.e(\"PLATEMATE\", \"âœ… Loading from LOCAL FILES (correct!)\")\n                    }\n                }\n                \n                override fun shouldInterceptRequest(\n                    view: WebView?,\n                    request: WebResourceRequest?\n                ): WebResourceResponse? {\n                    request?.let {\n                        // Only intercept requests to our own server\n                        val urlString = it.url.toString()\n                        if (shouldAddToken(urlString)) {\n                            return try {\n                                makeRequestWithToken(urlString, it.method, it.requestHeaders)\n                            } catch (e: Exception) {\n                                android.util.Log.e(\"MainActivity\", \"Error intercepting request: $urlString\", e)\n                                null\n                            }\n                        }\n                    }\n                    return super.shouldInterceptRequest(view, request)\n                }\n\n                override fun onPageFinished(view: WebView?, url: String?) {\n                    super.onPageFinished(view, url)\n                    android.util.Log.e(\"PLATEMATE\", \"âœ… WebView finished loading: $url\")\n                    // Also inject JavaScript as a fallback for fetch/XHR\n                    injectHeaderScript(view)\n                }\n            }\n            \n        } catch (e: Exception) {\n            android.util.Log.e(\"MainActivity\", \"Failed to setup WebView header injection\", e)\n        }\n    }\n    \n    private fun shouldAddToken(url: String): Boolean {\n        // Only add token to requests to our Replit server\n        // Avoid intercepting third-party resources\n        return url.contains(\".replit.dev\") || url.contains(\"replit.app\")\n    }\n    \n    private fun makeRequestWithToken(\n        urlString: String,\n        method: String,\n        originalHeaders: Map<String, String>\n    ): WebResourceResponse? {\n        return try {\n            val url = URL(urlString)\n            val connection = url.openConnection() as HttpURLConnection\n            \n            // Set method\n            connection.requestMethod = method\n            \n            // Copy original headers\n            originalHeaders.forEach { (key, value) ->\n                connection.setRequestProperty(key, value)\n            }\n            \n            // Add our custom token header\n            connection.setRequestProperty(\"X-App-Token\", APP_ACCESS_TOKEN)\n            \n            // Connect and get response\n            connection.connect()\n            \n            val responseCode = connection.responseCode\n            val mimeType = connection.contentType?.split(\";\")?.get(0) ?: \"text/html\"\n            val encoding = connection.contentEncoding ?: \"UTF-8\"\n            val inputStream = if (responseCode >= 400) {\n                connection.errorStream\n            } else {\n                connection.inputStream\n            }\n            \n            // Build response headers\n            val responseHeaders = mutableMapOf<String, String>()\n            connection.headerFields.forEach { (key, values) ->\n                key?.let {\n                    responseHeaders[it] = values.joinToString(\", \")\n                }\n            }\n            \n            WebResourceResponse(mimeType, encoding, responseCode, \"OK\", responseHeaders, inputStream)\n            \n        } catch (e: IOException) {\n            android.util.Log.e(\"MainActivity\", \"Failed to make request with token: $urlString\", e)\n            null\n        }\n    }\n    \n    private fun injectHeaderScript(view: WebView?) {\n        view?.evaluateJavascript(\"\"\"\n                (function() {\n                    const token = '$APP_ACCESS_TOKEN';\n                    \n                    // Intercept fetch API\n                    const originalFetch = window.fetch;\n                    window.fetch = function(...args) {\n                        if (args[1]) {\n                            args[1].headers = args[1].headers || {};\n                            if (args[1].headers instanceof Headers) {\n                                args[1].headers.append('X-App-Token', token);\n                            } else {\n                                args[1].headers['X-App-Token'] = token;\n                            }\n                        } else {\n                            args[1] = { headers: { 'X-App-Token': token } };\n                        }\n                        return originalFetch.apply(this, args);\n                    };\n                    \n                    // Intercept XMLHttpRequest\n                    const originalOpen = XMLHttpRequest.prototype.open;\n                    const originalSend = XMLHttpRequest.prototype.send;\n                    XMLHttpRequest.prototype.open = function(...args) {\n                        this._url = args[1];\n                        return originalOpen.apply(this, args);\n                    };\n                    XMLHttpRequest.prototype.send = function(...args) {\n                        this.setRequestHeader('X-App-Token', token);\n                        return originalSend.apply(this, args);\n                    };\n                    \n                    console.log('ðŸ” App token injection initialized');\n                })();\n            \"\"\".trimIndent(), null)\n    }\n}\n","size_bytes":8768},"client/src/components/profile-reminder-banner.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { Link } from 'wouter';\nimport { X, User, AlertCircle } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\n\ninterface ProfileReminderBannerProps {\n  userProfile: any;\n}\n\nexport function ProfileReminderBanner({ userProfile }: ProfileReminderBannerProps) {\n  const [isDismissed, setIsDismissed] = useState(false);\n  const [isVisible, setIsVisible] = useState(false);\n\n  useEffect(() => {\n    // Check if profile is incomplete\n    const isIncomplete = !userProfile?.name || \n                        !userProfile?.nickname || \n                        (!userProfile?.dietaryRequirements || userProfile.dietaryRequirements.length === 0);\n\n    // Check if user has already dismissed the reminder\n    const dismissed = localStorage.getItem('profile-reminder-dismissed');\n    \n    // If profile becomes complete, clear the dismissal so it shows again if profile becomes incomplete later\n    if (!isIncomplete) {\n      localStorage.removeItem('profile-reminder-dismissed');\n      setIsDismissed(false);\n      setIsVisible(false);\n      return;\n    }\n\n    // Show banner if profile is incomplete and not dismissed\n    if (isIncomplete && dismissed !== 'true') {\n      setIsVisible(true);\n      setIsDismissed(false);\n    } else if (dismissed === 'true') {\n      setIsDismissed(true);\n      setIsVisible(false);\n    }\n  }, [userProfile]);\n\n  const handleDismiss = () => {\n    localStorage.setItem('profile-reminder-dismissed', 'true');\n    setIsDismissed(true);\n  };\n\n  if (isDismissed || !isVisible) {\n    return null;\n  }\n\n  return (\n    <AnimatePresence>\n      <motion.div\n        initial={{ opacity: 0, y: -20 }}\n        animate={{ opacity: 1, y: 0 }}\n        exit={{ opacity: 0, y: -20 }}\n        transition={{ duration: 0.3 }}\n        className=\"mx-4 mt-4\"\n        data-testid=\"banner-profile-reminder\"\n      >\n        <div className=\"bg-gradient-to-r from-purple-500 to-indigo-600 rounded-2xl p-4 shadow-lg relative overflow-hidden\">\n          {/* Background pattern */}\n          <div className=\"absolute inset-0 opacity-10\">\n            <div className=\"absolute inset-0\" style={{\n              backgroundImage: `radial-gradient(circle at 2px 2px, white 1px, transparent 0)`,\n              backgroundSize: '32px 32px'\n            }} />\n          </div>\n\n          {/* Content */}\n          <div className=\"relative flex items-start gap-3\">\n            <div className=\"flex-shrink-0 bg-white/20 rounded-full p-2\">\n              <User className=\"h-5 w-5 text-white\" />\n            </div>\n            \n            <div className=\"flex-1 min-w-0\">\n              <h3 className=\"text-white font-semibold text-sm mb-1 flex items-center gap-2\">\n                <AlertCircle className=\"h-4 w-4\" />\n                Complete Your Profile\n              </h3>\n              <p className=\"text-white/90 text-sm mb-3\">\n                Help your AI Coach give you personalized nutrition advice by completing your profile with dietary preferences and allergies.\n              </p>\n              <Link href=\"/profile\">\n                <button\n                  className=\"bg-white text-purple-600 px-4 py-2 rounded-full text-sm font-medium hover:bg-purple-50 transition-colors shadow-md\"\n                  data-testid=\"button-complete-profile\"\n                >\n                  Complete Profile\n                </button>\n              </Link>\n            </div>\n\n            <button\n              onClick={handleDismiss}\n              className=\"flex-shrink-0 text-white/80 hover:text-white transition-colors p-1\"\n              data-testid=\"button-dismiss-profile-reminder\"\n              aria-label=\"Dismiss reminder\"\n            >\n              <X className=\"h-5 w-5\" />\n            </button>\n          </div>\n        </div>\n      </motion.div>\n    </AnimatePresence>\n  );\n}\n","size_bytes":3835},"client/src/components/water-tracker.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Droplets, Trash2, Edit, Coffee, Wine, Beer, GlassWater } from \"lucide-react\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport type { WaterIntake, InsertWaterIntake, NutritionGoals, UserProfile } from \"@shared/schema\";\nimport { format } from \"date-fns\";\n\ninterface WaterTrackerProps {\n  selectedDate?: Date;\n}\n\nexport function WaterTracker({ selectedDate = new Date() }: WaterTrackerProps) {\n  const { toast } = useToast();\n  const [customAmount, setCustomAmount] = useState(\"\");\n  const [customDrinkType, setCustomDrinkType] = useState<\"water\" | \"coffee\" | \"tea\" | \"wine\" | \"beer\" | \"custom\">(\"water\");\n  const [isEditingGoal, setIsEditingGoal] = useState(false);\n  const [editedGoal, setEditedGoal] = useState(\"\");\n\n  const dateStr = format(selectedDate, \"yyyy-MM-dd\");\n\n  // Fetch user's water goal\n  const { data: nutritionGoals } = useQuery<NutritionGoals>({\n    queryKey: [\"/api/nutrition-goals\"],\n  });\n\n  // Fetch user profile for health condition-based adjustments\n  const { data: userProfile } = useQuery<UserProfile>({\n    queryKey: [\"/api/profile\"],\n  });\n\n  // Fetch water entries for selected date\n  const { data: waterEntriesData, isLoading } = useQuery<WaterIntake[]>({\n    queryKey: [`/api/water/${dateStr}`],\n  });\n\n  // Ensure waterEntries is always an array\n  const waterEntries = Array.isArray(waterEntriesData) ? waterEntriesData : [];\n\n  // Calculate total consumed\n  const totalConsumed = waterEntries.reduce((sum, entry) => sum + entry.amountMl, 0);\n\n  // Calculate daily goal with medical condition adjustments\n  const calculateDailyGoal = (): number => {\n    const baseGoal = nutritionGoals?.dailyWater || 2500;\n    \n    // Check for medical conditions that restrict fluid intake\n    const healthConditions = userProfile?.healthConditions?.toLowerCase() || \"\";\n    const restrictiveConditions = [\n      \"kidney disease\",\n      \"kidney failure\",\n      \"renal\",\n      \"heart failure\",\n      \"cardiac\",\n      \"fluid retention\",\n      \"edema\",\n      \"oedema\",\n      \"hyponatremia\"\n    ];\n    \n    const hasRestrictiveCondition = restrictiveConditions.some(condition => \n      healthConditions.includes(condition)\n    );\n    \n    if (hasRestrictiveCondition && baseGoal > 2000) {\n      // Suggest lower goal for people with fluid restrictions\n      return 1500;\n    }\n    \n    return baseGoal;\n  };\n\n  const dailyGoal = calculateDailyGoal();\n  const remaining = Math.max(0, dailyGoal - totalConsumed);\n  const percentComplete = Math.min(100, (totalConsumed / dailyGoal) * 100);\n\n  // Add water mutation\n  const addWaterMutation = useMutation({\n    mutationFn: async (data: { amountMl: number; drinkType: \"water\" | \"coffee\" | \"tea\" | \"wine\" | \"beer\" | \"custom\"; drinkName: string }) => {\n      const entry: InsertWaterIntake = {\n        userId: \"\", // Will be set by backend\n        amountMl: data.amountMl,\n        drinkType: data.drinkType,\n        drinkName: data.drinkName,\n        loggedAt: new Date().toISOString(),\n        loggedDate: dateStr,\n      };\n      const res = await apiRequest(\"POST\", \"/api/water\", entry);\n      return res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [`/api/water/${dateStr}`] });\n      setCustomAmount(\"\");\n      toast({\n        title: \"Fluid logged\",\n        description: \"Your fluid intake has been recorded.\",\n      });\n    },\n    onError: (error) => {\n      console.error(\"Failed to log water:\", error);\n      toast({\n        title: \"Error\",\n        description: \"Failed to log fluid intake.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Delete water mutation\n  const deleteWaterMutation = useMutation({\n    mutationFn: async (id: string) => {\n      const res = await apiRequest(\"DELETE\", `/api/water/${id}`);\n      return res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [`/api/water/${dateStr}`] });\n      toast({\n        title: \"Entry deleted\",\n        description: \"Fluid entry has been removed.\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to delete entry.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Update water goal mutation\n  const updateGoalMutation = useMutation({\n    mutationFn: async (newGoal: number) => {\n      const res = await apiRequest(\"POST\", \"/api/nutrition-goals\", {\n        userId: \"\", // Will be set by backend\n        dailyWater: newGoal,\n      });\n      return res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/nutrition-goals\"] });\n      setIsEditingGoal(false);\n      setEditedGoal(\"\");\n      toast({\n        title: \"Goal updated\",\n        description: \"Your daily water goal has been updated.\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to update water goal.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleQuickAdd = (amount: number, drinkType: \"water\" | \"coffee\" | \"tea\" | \"wine\" | \"beer\" | \"custom\", drinkName: string) => {\n    addWaterMutation.mutate({ amountMl: amount, drinkType, drinkName });\n  };\n\n  const handleCustomAdd = () => {\n    const amount = parseInt(customAmount);\n    if (amount && amount > 0 && amount <= 5000) {\n      const drinkNames = {\n        water: \"Water\",\n        coffee: \"Coffee\",\n        tea: \"Tea\",\n        wine: \"Wine\",\n        beer: \"Beer\",\n        custom: \"Custom Drink\"\n      };\n      \n      addWaterMutation.mutate({ \n        amountMl: amount, \n        drinkType: customDrinkType, \n        drinkName: drinkNames[customDrinkType] \n      });\n    } else {\n      toast({\n        title: \"Invalid amount\",\n        description: \"Please enter a value between 1 and 5000 ml.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const handleDelete = (id: string) => {\n    deleteWaterMutation.mutate(id);\n  };\n\n  const handleSaveGoal = () => {\n    const newGoal = parseInt(editedGoal);\n    if (newGoal && newGoal > 0 && newGoal <= 10000) {\n      updateGoalMutation.mutate(newGoal);\n    } else {\n      toast({\n        title: \"Invalid goal\",\n        description: \"Please enter a goal between 1 and 10000 ml.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  return (\n    <div className=\"relative overflow-hidden rounded-2xl bg-gradient-to-br from-blue-500 via-blue-600 to-cyan-600 p-4 text-white\">\n      {/* Floating particles effect */}\n      <div className=\"absolute inset-0 overflow-hidden pointer-events-none\">\n        <div className=\"absolute w-1.5 h-1.5 bg-white/30 rounded-full top-[10%] left-[15%] animate-float-slow\"></div>\n        <div className=\"absolute w-1 h-1 bg-white/20 rounded-full top-[25%] right-[20%] animate-float-medium\"></div>\n        <div className=\"absolute w-2 h-2 bg-white/25 rounded-full top-[60%] left-[25%] animate-float-fast\"></div>\n        <div className=\"absolute w-1 h-1 bg-white/30 rounded-full top-[80%] right-[30%] animate-float-slow\"></div>\n        <div className=\"absolute w-1.5 h-1.5 bg-white/20 rounded-full top-[40%] right-[10%] animate-float-medium\"></div>\n        <div className=\"absolute w-1 h-1 bg-white/25 rounded-full bottom-[15%] left-[40%] animate-float-fast\"></div>\n      </div>\n\n      <div className=\"relative z-10 space-y-3\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between\">\n          <h2 className=\"text-2xl font-bold\">Fluid Intake</h2>\n          {selectedDate.toDateString() === new Date().toDateString() && (\n            <span className=\"bg-cyan-400 text-blue-900 px-3 py-1 rounded-full text-xs font-semibold\">\n              Today\n            </span>\n          )}\n        </div>\n\n        {/* Main Display Area */}\n        <div className=\"flex items-center justify-between gap-4\">\n          {/* Water Droplet */}\n          <div className=\"relative\">\n            <div className=\"w-24 h-24 relative\">\n              {/* Glossy water droplet effect */}\n              <div className=\"absolute inset-0 rounded-[50%] bg-gradient-to-br from-cyan-300 via-blue-400 to-blue-500 opacity-90\"\n                   style={{ borderRadius: '50% 50% 50% 0%', transform: 'rotate(45deg)' }}>\n                <div className=\"absolute top-3 left-3 w-6 h-6 bg-white/40 rounded-full blur-sm\"></div>\n              </div>\n              {/* Water level inside droplet */}\n              <div className=\"absolute inset-0 overflow-hidden\"\n                   style={{ borderRadius: '50% 50% 50% 0%', transform: 'rotate(45deg)' }}>\n                <div \n                  className=\"absolute bottom-0 left-0 right-0 bg-blue-400/50 transition-all duration-500\"\n                  style={{ height: `${percentComplete}%` }}\n                ></div>\n              </div>\n            </div>\n          </div>\n\n          {/* Percentage and Progress */}\n          <div className=\"flex-1 space-y-2\">\n            <div className=\"text-5xl font-black\" data-testid=\"text-water-percentage\">\n              {Math.round(percentComplete)}%\n            </div>\n            \n            {/* Gradient Progress Bar */}\n            <div className=\"relative h-3 bg-white/20 rounded-full overflow-hidden backdrop-blur-sm\">\n              <div \n                className=\"absolute inset-y-0 left-0 bg-gradient-to-r from-purple-500 via-pink-500 to-pink-400 rounded-full transition-all duration-500\"\n                style={{ width: `${percentComplete}%` }}\n                data-testid=\"progress-water\"\n              ></div>\n            </div>\n\n            {/* Stats Row */}\n            <div className=\"flex justify-between text-base\">\n              <div>\n                <p className=\"font-bold\" data-testid=\"text-water-consumed\">{totalConsumed}ml</p>\n                <p className=\"text-sm text-white/80\">\n                  of{\" \"}\n                  {isEditingGoal ? (\n                    <span className=\"inline-flex items-center gap-1\">\n                      <input\n                        type=\"number\"\n                        value={editedGoal}\n                        onChange={(e) => setEditedGoal(e.target.value)}\n                        className=\"w-20 h-6 text-sm inline-block bg-white/20 rounded px-2 text-white\"\n                        placeholder={dailyGoal.toString()}\n                        data-testid=\"input-water-goal\"\n                      />\n                      <button\n                        className=\"text-xs bg-white/20 hover:bg-white/30 px-2 py-1 rounded\"\n                        onClick={handleSaveGoal}\n                        data-testid=\"button-save-water-goal\"\n                      >\n                        Save\n                      </button>\n                    </span>\n                  ) : (\n                    <span\n                      className=\"cursor-pointer hover:text-white inline-flex items-center gap-1\"\n                      onClick={() => {\n                        setIsEditingGoal(true);\n                        setEditedGoal(dailyGoal.toString());\n                      }}\n                      data-testid=\"button-edit-water-goal\"\n                    >\n                      {dailyGoal}ml <Edit className=\"h-3 w-3\" />\n                    </span>\n                  )}\n                  {\" \"}goal\n                </p>\n              </div>\n              <div className=\"text-right\">\n                <p className=\"font-bold\" data-testid=\"text-water-remaining\">{remaining}ml</p>\n                <p className=\"text-sm text-white/80\">remaining</p>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Motivational Text */}\n        <div className=\"text-center text-white/90 text-xs\">\n          Let's get started! Your cells are waiting ðŸ’§\n        </div>\n\n        {/* Quick Add Buttons - 2x2 Grid */}\n        <div className=\"grid grid-cols-2 gap-2\">\n          {/* Water - Blue */}\n          <button\n            onClick={() => handleQuickAdd(250, \"water\", \"Water\")}\n            disabled={addWaterMutation.isPending}\n            className=\"bg-gradient-to-br from-blue-400 to-cyan-400 hover:from-blue-500 hover:to-cyan-500 rounded-xl p-3 flex items-center gap-2 transition-all duration-200 hover:scale-105 disabled:opacity-50\"\n            data-testid=\"button-add-water-250\"\n          >\n            <GlassWater className=\"h-7 w-7\" />\n            <div className=\"text-left\">\n              <p className=\"font-bold text-base\">Water</p>\n              <p className=\"text-xs opacity-90\">250ml</p>\n            </div>\n          </button>\n\n          {/* Coffee - Orange */}\n          <button\n            onClick={() => handleQuickAdd(240, \"coffee\", \"Coffee\")}\n            disabled={addWaterMutation.isPending}\n            className=\"bg-gradient-to-br from-orange-400 to-amber-400 hover:from-orange-500 hover:to-amber-500 rounded-xl p-3 flex items-center gap-2 transition-all duration-200 hover:scale-105 disabled:opacity-50\"\n            data-testid=\"button-add-coffee-240\"\n          >\n            <Coffee className=\"h-7 w-7\" />\n            <div className=\"text-left\">\n              <p className=\"font-bold text-base\">Coffee</p>\n              <p className=\"text-xs opacity-90\">240ml</p>\n            </div>\n          </button>\n\n          {/* Tea - Green */}\n          <button\n            onClick={() => handleQuickAdd(200, \"tea\", \"Tea\")}\n            disabled={addWaterMutation.isPending}\n            className=\"bg-gradient-to-br from-emerald-400 to-green-400 hover:from-emerald-500 hover:to-green-500 rounded-xl p-3 flex items-center gap-2 transition-all duration-200 hover:scale-105 disabled:opacity-50\"\n            data-testid=\"button-add-tea-200\"\n          >\n            <Coffee className=\"h-7 w-7\" />\n            <div className=\"text-left\">\n              <p className=\"font-bold text-base\">Tea</p>\n              <p className=\"text-xs opacity-90\">200ml</p>\n            </div>\n          </button>\n\n          {/* Wine - Pink/Red */}\n          <button\n            onClick={() => handleQuickAdd(150, \"wine\", \"Wine\")}\n            disabled={addWaterMutation.isPending}\n            className=\"bg-gradient-to-br from-pink-400 to-rose-400 hover:from-pink-500 hover:to-rose-500 rounded-xl p-3 flex items-center gap-2 transition-all duration-200 hover:scale-105 disabled:opacity-50\"\n            data-testid=\"button-add-wine-150\"\n          >\n            <Wine className=\"h-7 w-7\" />\n            <div className=\"text-left\">\n              <p className=\"font-bold text-base\">Wine</p>\n              <p className=\"text-xs opacity-90\">150ml</p>\n            </div>\n          </button>\n        </div>\n\n        {/* Custom Amount Section */}\n        <div className=\"bg-white/10 backdrop-blur-sm rounded-xl p-2.5 flex items-center gap-2\">\n          <div className=\"flex-1\">\n            <p className=\"text-sm font-semibold mb-1.5\">Custom amount</p>\n            <Select value={customDrinkType} onValueChange={(value: any) => setCustomDrinkType(value)}>\n              <SelectTrigger className=\"bg-white/20 border-white/30 text-white text-sm h-8\" data-testid=\"select-custom-drink-type\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"water\">Water</SelectItem>\n                <SelectItem value=\"coffee\">Coffee</SelectItem>\n                <SelectItem value=\"tea\">Tea</SelectItem>\n                <SelectItem value=\"wine\">Wine</SelectItem>\n                <SelectItem value=\"beer\">Beer</SelectItem>\n                <SelectItem value=\"custom\">Custom</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n          <div className=\"flex gap-1.5\">\n            <Input\n              type=\"number\"\n              placeholder=\"ml\"\n              value={customAmount}\n              onChange={(e) => setCustomAmount(e.target.value)}\n              onKeyDown={(e) => {\n                if (e.key === \"Enter\") {\n                  handleCustomAdd();\n                }\n              }}\n              className=\"w-20 h-8 text-sm bg-white/20 border-white/30 text-white placeholder:text-white/50\"\n              data-testid=\"input-custom-water\"\n            />\n            <Button\n              onClick={handleCustomAdd}\n              disabled={addWaterMutation.isPending || !customAmount}\n              className=\"bg-cyan-400 hover:bg-cyan-500 text-blue-900 font-bold text-sm h-8 px-4\"\n              data-testid=\"button-add-custom-water\"\n            >\n              Enter\n            </Button>\n          </div>\n        </div>\n\n        {/* Today's Log */}\n        {waterEntries.length > 0 && (\n          <div className=\"space-y-2 pt-2 border-t border-white/20\">\n            <p className=\"text-sm font-medium\">Today's Log</p>\n            <div className=\"space-y-1 max-h-48 overflow-y-auto\">\n              {waterEntries.map((entry, index) => {\n                // Get icon and color based on drink type (with defensive fallback for legacy types)\n                const getDrinkIcon = () => {\n                  const drinkType = entry.drinkType || \"water\";\n                  switch (drinkType) {\n                    case \"water\": return <GlassWater className=\"h-4 w-4\" />;\n                    case \"coffee\": return <Coffee className=\"h-4 w-4\" />;\n                    case \"tea\": return <Coffee className=\"h-4 w-4\" />;\n                    case \"wine\": return <Wine className=\"h-4 w-4\" />;\n                    case \"beer\": return <Beer className=\"h-4 w-4\" />;\n                    case \"custom\": return <Droplets className=\"h-4 w-4\" />;\n                    default: return <Droplets className=\"h-4 w-4\" />; // Fallback for legacy types\n                  }\n                };\n                \n                return (\n                  <div\n                    key={entry.id}\n                    className=\"flex items-center justify-between bg-white/10 backdrop-blur-sm rounded-lg p-2 text-sm\"\n                    data-testid={`water-entry-${index}`}\n                  >\n                    <div className=\"flex items-center gap-2\">\n                      {getDrinkIcon()}\n                      <span className=\"text-xs text-white/80\">\n                        {entry.drinkName || \"Drink\"}\n                      </span>\n                      <span className=\"font-medium\" data-testid={`text-water-amount-${index}`}>\n                        {entry.amountMl}ml\n                      </span>\n                      <span className=\"text-xs text-white/70\">\n                        {format(new Date(entry.loggedAt), \"HH:mm\")}\n                      </span>\n                    </div>\n                    <button\n                      onClick={() => handleDelete(entry.id)}\n                      disabled={deleteWaterMutation.isPending}\n                      className=\"h-7 w-7 p-0 text-white/60 hover:text-red-300 transition-colors\"\n                      data-testid={`button-delete-water-${index}`}\n                    >\n                      <Trash2 className=\"h-4 w-4\" />\n                    </button>\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n        )}\n\n        {isLoading && (\n          <p className=\"text-center text-sm text-white/70\">\n            Loading fluid intake...\n          </p>\n        )}\n      </div>\n    </div>\n  );\n}\n","size_bytes":19437},"client/src/lib/portionHelpers.ts":{"content":"/**\n * Generate appropriate portion size options based on food name and type\n */\nexport function getPortionOptions(foodName: string, currentPortion: string): string[] {\n  const nameLower = foodName.toLowerCase();\n  const portionLower = currentPortion.toLowerCase();\n  \n  // Extract current quantity if present\n  const quantityMatch = portionLower.match(/^(\\d+(?:\\.\\d+)?)\\s*/);\n  const currentQuantity = quantityMatch ? parseFloat(quantityMatch[1]) : 1;\n  \n  // Whole potatoes (jacket, baked, roasted, boiled)\n  if ((nameLower.includes('potato') || portionLower.includes('potato')) && \n      !nameLower.includes('chip') && !nameLower.includes('fries') && \n      !nameLower.includes('mashed') && !nameLower.includes('salad') && \n      !nameLower.includes('sweet')) {\n    return [\n      '1 small (150g)',\n      '1 medium (200g)',\n      '1 large (300g)',\n      '2 small (300g)',\n      '2 medium (400g)',\n      '2 large (600g)'\n    ];\n  }\n  \n  // Eggs\n  if (nameLower.includes('egg') && !nameLower.includes('plant') && !nameLower.includes('salad')) {\n    return [\n      '1 egg (50g)',\n      '2 eggs (100g)',\n      '3 eggs (150g)',\n      '4 eggs (200g)'\n    ];\n  }\n  \n  // Chicken breast\n  if (nameLower.includes('chicken') && nameLower.includes('breast')) {\n    return [\n      '1 small breast (100g)',\n      '1 medium breast (150g)',\n      '1 large breast (200g)',\n      '2 small breasts (200g)',\n      '2 medium breasts (300g)'\n    ];\n  }\n  \n  // General meat/fish (steak, salmon, etc.)\n  if (nameLower.match(/steak|salmon|cod|tuna|pork|beef|lamb|fish/)) {\n    return [\n      '100g',\n      '150g',\n      '200g',\n      '250g',\n      '300g'\n    ];\n  }\n  \n  // Bread and toast\n  if (nameLower.includes('bread') || nameLower.includes('toast')) {\n    return [\n      '1 slice (30g)',\n      '2 slices (60g)',\n      '3 slices (90g)',\n      '4 slices (120g)'\n    ];\n  }\n  \n  // Rice and pasta\n  if (nameLower.match(/rice|pasta|noodle/)) {\n    return [\n      '100g cooked',\n      '150g cooked',\n      '200g cooked',\n      '250g cooked',\n      '300g cooked'\n    ];\n  }\n  \n  // Drinks (water, juice, milk, coffee, tea)\n  if (nameLower.match(/water|juice|milk|coffee|tea|drink|beverage|soda|cola/)) {\n    return [\n      '100ml',\n      '200ml',\n      '250ml',\n      '330ml',\n      '500ml',\n      '1 cup (240ml)',\n      '1 glass (250ml)'\n    ];\n  }\n  \n  // Soup\n  if (nameLower.includes('soup')) {\n    return [\n      '1 cup (240ml)',\n      '1 bowl (300ml)',\n      '1 large bowl (400ml)'\n    ];\n  }\n  \n  // Fruit (apple, banana, orange, etc.)\n  if (nameLower.match(/apple|banana|orange|pear|peach|plum/)) {\n    return [\n      '1 small (80g)',\n      '1 medium (120g)',\n      '1 large (180g)',\n      '2 small (160g)',\n      '2 medium (240g)'\n    ];\n  }\n  \n  // Berries\n  if (nameLower.match(/berr|strawberr|blueberr|raspberr/)) {\n    return [\n      '50g (handful)',\n      '100g',\n      '150g',\n      '200g',\n      '1 cup (150g)'\n    ];\n  }\n  \n  // Nuts\n  if (nameLower.match(/nut|almond|walnut|cashew|peanut/)) {\n    return [\n      '25g (small handful)',\n      '50g (handful)',\n      '75g',\n      '100g'\n    ];\n  }\n  \n  // Cheese\n  if (nameLower.includes('cheese')) {\n    return [\n      '25g',\n      '50g',\n      '75g',\n      '100g',\n      '1 slice (30g)'\n    ];\n  }\n  \n  // Yogurt\n  if (nameLower.includes('yogurt') || nameLower.includes('yoghurt')) {\n    return [\n      '100g (small pot)',\n      '150g (standard pot)',\n      '200g',\n      '1 cup (240g)'\n    ];\n  }\n  \n  // Generic fallback - weight-based options\n  return [\n    '50g',\n    '100g',\n    '150g',\n    '200g',\n    '250g',\n    '300g'\n  ];\n}\n\n/**\n * Convert a portion string to grams for nutrition calculation\n * This mirrors the server-side logic in ai-manager.ts\n */\nexport function portionToGrams(portion: string): number {\n  const portionLower = portion.toLowerCase().trim();\n  \n  // Direct gram/kg measurements\n  const kgMatch = portionLower.match(/(\\d+(?:\\.\\d+)?)\\s*kg/);\n  if (kgMatch) return parseFloat(kgMatch[1]) * 1000;\n  \n  const gMatch = portionLower.match(/(\\d+(?:\\.\\d+)?)\\s*g\\b/);\n  if (gMatch) return parseFloat(gMatch[1]);\n  \n  // Volume to weight conversions (ml)\n  const mlMatch = portionLower.match(/(\\d+(?:\\.\\d+)?)\\s*ml/);\n  if (mlMatch) return parseFloat(mlMatch[1]); // 1ml â‰ˆ 1g for water-based liquids\n  \n  // Common portion descriptions\n  if (portionLower.includes('small')) {\n    if (portionLower.includes('potato')) return 150;\n    if (portionLower.includes('breast')) return 100;\n    if (portionLower.includes('handful')) return 25;\n    return 80;\n  }\n  \n  if (portionLower.includes('medium')) {\n    if (portionLower.includes('potato')) return 200;\n    if (portionLower.includes('breast')) return 150;\n    return 120;\n  }\n  \n  if (portionLower.includes('large')) {\n    if (portionLower.includes('potato')) return 300;\n    if (portionLower.includes('breast')) return 200;\n    return 180;\n  }\n  \n  // Count-based items\n  const eggMatch = portionLower.match(/(\\d+)\\s*eggs?/);\n  if (eggMatch) return parseInt(eggMatch[1]) * 50;\n  \n  const sliceMatch = portionLower.match(/(\\d+)\\s*slices?/);\n  if (sliceMatch) return parseInt(sliceMatch[1]) * 30;\n  \n  // Cup/bowl measurements\n  if (portionLower.includes('cup')) return 240;\n  if (portionLower.includes('bowl')) {\n    if (portionLower.includes('large')) return 400;\n    return 300;\n  }\n  if (portionLower.includes('glass')) return 250;\n  if (portionLower.includes('handful')) return 50;\n  \n  // Extract any leading number and use it as a multiplier\n  const numMatch = portionLower.match(/^(\\d+(?:\\.\\d+)?)/);\n  if (numMatch) {\n    const num = parseFloat(numMatch[1]);\n    // If just a number, assume it's grams\n    if (/^\\d+(?:\\.\\d+)?$/.test(portionLower.trim())) {\n      return num;\n    }\n    // Otherwise use as multiplier (e.g., \"2 potatoes\" = 2 * 200g)\n    return num * 100;\n  }\n  \n  // Default fallback\n  return 100;\n}\n","size_bytes":5837},"client/src/lib/api-config.ts":{"content":"import { Capacitor } from '@capacitor/core';\n\n/**\n * API Configuration for Mobile and Web\n * \n * In browser: Uses relative URLs (e.g., '/api/...')\n * In mobile production: Uses full backend URL from environment variable\n */\n\n/**\n * Get the base URL for API requests\n * - In browser/development: returns empty string (uses relative URLs)\n * - In Capacitor (mobile): returns the full backend URL from environment variable\n */\nexport function getApiBaseUrl(): string {\n  // Check if running in Capacitor (mobile app)\n  if (Capacitor.isNativePlatform()) {\n    // Use the backend URL from environment variable\n    const backendUrl = import.meta.env.VITE_API_BASE_URL;\n    \n    if (!backendUrl) {\n      console.error('âŒ VITE_API_BASE_URL not configured for mobile app!');\n      console.error('Mobile app cannot reach backend API without this configuration.');\n      throw new Error('Backend API URL not configured. Please set VITE_API_BASE_URL environment variable.');\n    }\n    \n    console.log('ðŸ“± Mobile mode: Using backend URL:', backendUrl);\n    return backendUrl;\n  }\n  \n  // In browser, use relative URLs\n  return '';\n}\n\n/**\n * Build a full API URL\n * - In browser: returns '/api/path'\n * - In mobile: returns 'https://your-replit-url.repl.co/api/path'\n */\nexport function buildApiUrl(path: string): string {\n  const baseUrl = getApiBaseUrl();\n  \n  // Ensure path starts with /\n  const normalizedPath = path.startsWith('/') ? path : `/${path}`;\n  \n  // If no base URL (browser mode), return the path as-is\n  if (!baseUrl) {\n    return normalizedPath;\n  }\n  \n  // Combine base URL with path (remove trailing slash from base if present)\n  const cleanBaseUrl = baseUrl.endsWith('/') ? baseUrl.slice(0, -1) : baseUrl;\n  return `${cleanBaseUrl}${normalizedPath}`;\n}\n\n/**\n * Check if running in native mobile app\n */\nexport function isNativeApp(): boolean {\n  return Capacitor.isNativePlatform();\n}\n\n/**\n * Get platform name\n */\nexport function getPlatformName(): string {\n  return Capacitor.getPlatform();\n}\n","size_bytes":2008}},"version":2}